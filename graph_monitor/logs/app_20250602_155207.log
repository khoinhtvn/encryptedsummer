2025-06-02 15:52:07,593 - INFO - Application logging to file: logs/app_20250602_155207.log
2025-06-02 15:52:07,593 - INFO - Starting to monitor directory: /home/lu/Desktop/output/ with log level: DEBUG
2025-06-02 15:52:07,593 - INFO - Starting processing of existing directory: /home/lu/Desktop/output/, Train Mode: train
2025-06-02 15:52:07,593 - INFO - 
--- Processing file: nw_graph_encoded_1748869125.dot (Timestamp: 2025-06-02 14:58:45) ---
2025-06-02 15:52:07,593 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869125.dot
2025-06-02 15:52:07,594 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869125.dot
2025-06-02 15:52:07,594 - INFO - Parsed 7 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869125.dot'.
2025-06-02 15:52:07,594 - INFO - Parsed 5 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869125.dot'.
2025-06-02 15:52:07,594 - DEBUG - Initial graph - Nodes: 7, Edges: 5
2025-06-02 15:52:07,594 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:52:07,594 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:52:07,594 - DEBUG - Initial node features tensor shape: torch.Size([7, 30])
2025-06-02 15:52:07,595 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:52:07,596 - DEBUG - Node features tensor shape after scaling: torch.Size([7, 30])
2025-06-02 15:52:07,596 - DEBUG - Edge index tensor shape: torch.Size([2, 5])
2025-06-02 15:52:07,596 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:52:07,596 - DEBUG - Initial edge attributes tensor shape: torch.Size([5, 10])
2025-06-02 15:52:07,597 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:52:07,597 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([5, 10])
2025-06-02 15:52:07,597 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:52:07,597 - DEBUG - Type of pytorch_data (initial): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:52:07,597 - INFO - Initialized main graph with 7 nodes and 5 edges.
2025-06-02 15:52:07,597 - INFO - Initializing HybridGNNAnomalyDetector with node_dim=30, edge_dim=10, hidden_dim=64, embedding_dim=32, heads=4
2025-06-02 15:52:07,597 - INFO - Initializing GraphAutoencoder with node_dim=30, edge_dim=10, hidden_dim=64, embedding_dim=32
2025-06-02 15:52:07,636 - DEBUG - Encoder GATConv layers initialized: conv1 out_channels=256, conv2 out_channels=32
2025-06-02 15:52:07,636 - DEBUG - Decoder MLP layers initialized.
2025-06-02 15:52:07,637 - DEBUG - Anomaly scoring MLPs initialized.
2025-06-02 15:52:07,637 - INFO - Optimizer and scheduler initialized.
2025-06-02 15:52:07,637 - INFO - Replay buffer initialized with maxlen=1000, batch_size=32
2025-06-02 15:52:07,637 - INFO - RunningStats initialized.
2025-06-02 15:52:07,637 - INFO - RunningStats initialized.
2025-06-02 15:52:07,637 - INFO - Statistical controls initialized: drift_threshold=0.15
2025-06-02 15:52:07,637 - INFO - Embedding export will occur every 5 updates, saving to vis
2025-06-02 15:52:07,638 - INFO - Using device: cpu
2025-06-02 15:52:07,638 - INFO - Initialized Hybrid GNN (node_dim=30, edge_dim=10)
2025-06-02 15:52:07,638 - INFO - Performing initial training for 100 epochs...
2025-06-02 15:52:07,643 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,643 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,643 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,647 - INFO - Epoch 1/100, Loss: 6.3317
2025-06-02 15:52:07,649 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,649 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,649 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,652 - INFO - Epoch 2/100, Loss: 6.0961
2025-06-02 15:52:07,653 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,653 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,653 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,655 - INFO - Epoch 3/100, Loss: 5.8810
2025-06-02 15:52:07,657 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,657 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,657 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,659 - INFO - Epoch 4/100, Loss: 5.7538
2025-06-02 15:52:07,660 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,661 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,661 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,663 - INFO - Epoch 5/100, Loss: 5.6515
2025-06-02 15:52:07,664 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,665 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,665 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,667 - INFO - Epoch 6/100, Loss: 5.5169
2025-06-02 15:52:07,669 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,669 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,669 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,672 - INFO - Epoch 7/100, Loss: 5.3503
2025-06-02 15:52:07,673 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,673 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,673 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,677 - INFO - Epoch 8/100, Loss: 5.1583
2025-06-02 15:52:07,679 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,679 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,683 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,686 - INFO - Epoch 9/100, Loss: 4.9428
2025-06-02 15:52:07,690 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,690 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,691 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,694 - INFO - Epoch 10/100, Loss: 4.7529
2025-06-02 15:52:07,695 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,696 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,696 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,699 - INFO - Epoch 11/100, Loss: 4.5573
2025-06-02 15:52:07,700 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,701 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,701 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,704 - INFO - Epoch 12/100, Loss: 4.3318
2025-06-02 15:52:07,706 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,707 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,707 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,710 - INFO - Epoch 13/100, Loss: 4.0898
2025-06-02 15:52:07,713 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,713 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,714 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,717 - INFO - Epoch 14/100, Loss: 3.8239
2025-06-02 15:52:07,719 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,719 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,720 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,723 - INFO - Epoch 15/100, Loss: 3.5405
2025-06-02 15:52:07,726 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,726 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,727 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,732 - INFO - Epoch 16/100, Loss: 3.2808
2025-06-02 15:52:07,734 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,735 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,735 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,739 - INFO - Epoch 17/100, Loss: 3.0150
2025-06-02 15:52:07,742 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,742 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,742 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,747 - INFO - Epoch 18/100, Loss: 2.7384
2025-06-02 15:52:07,750 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,750 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,750 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,754 - INFO - Epoch 19/100, Loss: 2.4626
2025-06-02 15:52:07,757 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,757 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,757 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,761 - INFO - Epoch 20/100, Loss: 2.1876
2025-06-02 15:52:07,764 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,764 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,764 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,769 - INFO - Epoch 21/100, Loss: 1.9386
2025-06-02 15:52:07,772 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,772 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,773 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,778 - INFO - Epoch 22/100, Loss: 1.7465
2025-06-02 15:52:07,781 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,781 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,781 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,786 - INFO - Epoch 23/100, Loss: 1.5778
2025-06-02 15:52:07,789 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,789 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,789 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,794 - INFO - Epoch 24/100, Loss: 1.4433
2025-06-02 15:52:07,797 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,798 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,798 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,803 - INFO - Epoch 25/100, Loss: 1.3602
2025-06-02 15:52:07,812 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,812 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,816 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,834 - INFO - Epoch 26/100, Loss: 1.3262
2025-06-02 15:52:07,848 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,850 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,852 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,873 - INFO - Epoch 27/100, Loss: 1.3146
2025-06-02 15:52:07,881 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,882 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,882 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,894 - INFO - Epoch 28/100, Loss: 1.3053
2025-06-02 15:52:07,912 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,912 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,913 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,927 - INFO - Epoch 29/100, Loss: 1.2994
2025-06-02 15:52:07,930 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,930 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,930 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,935 - INFO - Epoch 30/100, Loss: 1.2929
2025-06-02 15:52:07,937 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,938 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,938 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,942 - INFO - Epoch 31/100, Loss: 1.2651
2025-06-02 15:52:07,944 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,945 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,947 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,954 - INFO - Epoch 32/100, Loss: 1.2302
2025-06-02 15:52:07,957 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,957 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,958 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,962 - INFO - Epoch 33/100, Loss: 1.1848
2025-06-02 15:52:07,965 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,965 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,966 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,970 - INFO - Epoch 34/100, Loss: 1.1277
2025-06-02 15:52:07,974 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,974 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,974 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,980 - INFO - Epoch 35/100, Loss: 1.0958
2025-06-02 15:52:07,983 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,984 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,984 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,988 - INFO - Epoch 36/100, Loss: 1.0623
2025-06-02 15:52:07,991 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,992 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,992 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:07,996 - INFO - Epoch 37/100, Loss: 1.0292
2025-06-02 15:52:07,998 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:07,998 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:07,999 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,002 - INFO - Epoch 38/100, Loss: 1.0278
2025-06-02 15:52:08,004 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,004 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,005 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,018 - INFO - Epoch 39/100, Loss: 1.0291
2025-06-02 15:52:08,033 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,034 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,037 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,045 - INFO - Epoch 40/100, Loss: 1.0233
2025-06-02 15:52:08,049 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,049 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,050 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,065 - INFO - Epoch 41/100, Loss: 1.0230
2025-06-02 15:52:08,074 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,074 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,075 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,081 - INFO - Epoch 42/100, Loss: 1.0300
2025-06-02 15:52:08,087 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,087 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,088 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,100 - INFO - Epoch 43/100, Loss: 1.0278
2025-06-02 15:52:08,107 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,107 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,108 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,115 - INFO - Epoch 44/100, Loss: 1.0330
2025-06-02 15:52:08,118 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,119 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,119 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,123 - INFO - Epoch 45/100, Loss: 1.0272
2025-06-02 15:52:08,125 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,125 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,125 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,129 - INFO - Epoch 46/100, Loss: 1.0126
2025-06-02 15:52:08,131 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,131 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,131 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,134 - INFO - Epoch 47/100, Loss: 1.0105
2025-06-02 15:52:08,136 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,136 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,137 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,140 - INFO - Epoch 48/100, Loss: 0.9977
2025-06-02 15:52:08,142 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,142 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,143 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,147 - INFO - Epoch 49/100, Loss: 0.9763
2025-06-02 15:52:08,149 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,150 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,150 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,153 - INFO - Epoch 50/100, Loss: 0.9587
2025-06-02 15:52:08,155 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,156 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,156 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,159 - INFO - Epoch 51/100, Loss: 0.9468
2025-06-02 15:52:08,161 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,162 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,162 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,165 - INFO - Epoch 52/100, Loss: 0.9261
2025-06-02 15:52:08,167 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,167 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,168 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,171 - INFO - Epoch 53/100, Loss: 0.9197
2025-06-02 15:52:08,173 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,173 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,174 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,177 - INFO - Epoch 54/100, Loss: 0.9122
2025-06-02 15:52:08,179 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,179 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,180 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,183 - INFO - Epoch 55/100, Loss: 0.9004
2025-06-02 15:52:08,185 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,185 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,185 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,188 - INFO - Epoch 56/100, Loss: 0.9034
2025-06-02 15:52:08,190 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,191 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,191 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,194 - INFO - Epoch 57/100, Loss: 0.9033
2025-06-02 15:52:08,196 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,196 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,196 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,199 - INFO - Epoch 58/100, Loss: 0.8926
2025-06-02 15:52:08,201 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,202 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,202 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,205 - INFO - Epoch 59/100, Loss: 0.8868
2025-06-02 15:52:08,207 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,207 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,212 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,215 - INFO - Epoch 60/100, Loss: 0.8847
2025-06-02 15:52:08,217 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,218 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,218 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,224 - INFO - Epoch 61/100, Loss: 0.8712
2025-06-02 15:52:08,226 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,226 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,227 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,233 - INFO - Epoch 62/100, Loss: 0.8687
2025-06-02 15:52:08,236 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,237 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,237 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,243 - INFO - Epoch 63/100, Loss: 0.8629
2025-06-02 15:52:08,251 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,252 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,253 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,261 - INFO - Epoch 64/100, Loss: 0.8504
2025-06-02 15:52:08,266 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,267 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,270 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,293 - INFO - Epoch 65/100, Loss: 0.8482
2025-06-02 15:52:08,313 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,315 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,321 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,332 - INFO - Epoch 66/100, Loss: 0.8434
2025-06-02 15:52:08,335 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,335 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,335 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,339 - INFO - Epoch 67/100, Loss: 0.8320
2025-06-02 15:52:08,342 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,343 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,343 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,348 - INFO - Epoch 68/100, Loss: 0.8305
2025-06-02 15:52:08,353 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,354 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,356 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,364 - INFO - Epoch 69/100, Loss: 0.8264
2025-06-02 15:52:08,369 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,370 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,372 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,385 - INFO - Epoch 70/100, Loss: 0.8129
2025-06-02 15:52:08,388 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,389 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,389 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,398 - INFO - Epoch 71/100, Loss: 0.8146
2025-06-02 15:52:08,401 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,401 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,402 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,407 - INFO - Epoch 72/100, Loss: 0.8167
2025-06-02 15:52:08,425 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,425 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,426 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,435 - INFO - Epoch 73/100, Loss: 0.8069
2025-06-02 15:52:08,442 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,442 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,443 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,453 - INFO - Epoch 74/100, Loss: 0.7860
2025-06-02 15:52:08,464 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,465 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,466 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,485 - INFO - Epoch 75/100, Loss: 0.7948
2025-06-02 15:52:08,503 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,504 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,504 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,531 - INFO - Epoch 76/100, Loss: 0.7978
2025-06-02 15:52:08,534 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,535 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,535 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,540 - INFO - Epoch 77/100, Loss: 0.7878
2025-06-02 15:52:08,543 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,543 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,544 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,548 - INFO - Epoch 78/100, Loss: 0.7661
2025-06-02 15:52:08,551 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,552 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,552 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,558 - INFO - Epoch 79/100, Loss: 0.7613
2025-06-02 15:52:08,562 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,563 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,563 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,567 - INFO - Epoch 80/100, Loss: 0.7656
2025-06-02 15:52:08,570 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,570 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,571 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,574 - INFO - Epoch 81/100, Loss: 0.7566
2025-06-02 15:52:08,577 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,577 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,578 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,582 - INFO - Epoch 82/100, Loss: 0.7368
2025-06-02 15:52:08,584 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,584 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,584 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,589 - INFO - Epoch 83/100, Loss: 0.7418
2025-06-02 15:52:08,591 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,591 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,592 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,595 - INFO - Epoch 84/100, Loss: 0.7448
2025-06-02 15:52:08,598 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,598 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,598 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,602 - INFO - Epoch 85/100, Loss: 0.7354
2025-06-02 15:52:08,604 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,604 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,604 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,608 - INFO - Epoch 86/100, Loss: 0.7188
2025-06-02 15:52:08,611 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,611 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,611 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,615 - INFO - Epoch 87/100, Loss: 0.7054
2025-06-02 15:52:08,617 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,617 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,617 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,621 - INFO - Epoch 88/100, Loss: 0.7063
2025-06-02 15:52:08,623 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,623 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,624 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,628 - INFO - Epoch 89/100, Loss: 0.6962
2025-06-02 15:52:08,637 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,637 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,638 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,647 - INFO - Epoch 90/100, Loss: 0.6875
2025-06-02 15:52:08,663 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,664 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,664 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,678 - INFO - Epoch 91/100, Loss: 0.6871
2025-06-02 15:52:08,710 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,711 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,726 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,743 - INFO - Epoch 92/100, Loss: 0.6755
2025-06-02 15:52:08,747 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,747 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,748 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,754 - INFO - Epoch 93/100, Loss: 0.6773
2025-06-02 15:52:08,756 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,756 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,757 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,761 - INFO - Epoch 94/100, Loss: 0.6772
2025-06-02 15:52:08,763 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,764 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,764 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,767 - INFO - Epoch 95/100, Loss: 0.6650
2025-06-02 15:52:08,769 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,769 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,770 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,773 - INFO - Epoch 96/100, Loss: 0.6578
2025-06-02 15:52:08,775 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,775 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,775 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,779 - INFO - Epoch 97/100, Loss: 0.6579
2025-06-02 15:52:08,781 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,781 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,781 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,785 - INFO - Epoch 98/100, Loss: 0.6468
2025-06-02 15:52:08,787 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,787 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,787 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,790 - INFO - Epoch 99/100, Loss: 0.6511
2025-06-02 15:52:08,792 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:52:08,792 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:52:08,793 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:08,796 - INFO - Epoch 100/100, Loss: 0.6519
2025-06-02 15:52:08,796 - INFO - Initial training complete.
2025-06-02 15:52:08,804 - INFO - Checkpoint loaded from model_checkpoints/latest_checkpoint.pth at epoch 60
2025-06-02 15:52:08,804 - INFO - Starting or resuming online updates from step: 60
2025-06-02 15:52:08,804 - INFO - Running statistics loaded from stats/running_stats.pkl
2025-06-02 15:52:08,804 - INFO - Running anomaly detection...
2025-06-02 15:52:08,804 - INFO - Starting anomaly detection.
2025-06-02 15:52:08,807 - DEBUG - Node reconstruction errors: [0.3121542  1.1875073  1.3932741  0.3181457  0.3181458  0.34238008
 0.45985654]
2025-06-02 15:52:08,807 - DEBUG - Edge reconstruction errors: [ 7.2954245 43.98708   44.206543  44.889122   5.821832 ]
2025-06-02 15:52:08,808 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155208_update_1.json
2025-06-02 15:52:08,808 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:52:08,817 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155208_update_1.pth and as latest_checkpoint.pth
2025-06-02 15:52:08,817 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869125.dot): 0.6502
2025-06-02 15:52:08,818 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-02 15:52:08,818 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-02 15:52:08,821 - DEBUG - Embedding standard deviations before t-SNE: [1.058149   0.         1.139067   0.260395   0.722705   0.
 0.67440176 0.83649963 1.3344901  0.4764993  1.0389699  0.
 0.9576118  0.40215287 0.99035287 0.7350059  0.         0.5366549
 0.         0.68235224 1.5475409  1.8903475  0.         1.2014276
 0.7699284  0.20885304 0.         0.74682975 1.1393023  0.
 0.72208    0.38355806]
2025-06-02 15:52:08,995 - DEBUG - Loaded backend module://backend_interagg version unknown.
2025-06-02 15:52:09,088 - INFO - Embeddings visualization saved to vis/embeddings_1_updates_20250602_155208.png
2025-06-02 15:52:09,088 - INFO - Performing visualization of node and edge features.
2025-06-02 15:52:09,088 - INFO - Starting visualization of node features.
2025-06-02 15:52:09,088 - INFO - Graph has 7 nodes and 30 features.
2025-06-02 15:52:09,088 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:52:09,088 - INFO - Calculating feature statistics:
2025-06-02 15:52:09,088 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:09,088 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:09,089 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:09,089 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:09,089 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:09,089 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:09,089 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:09,089 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:09,089 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:09,089 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 2, 'mean': np.float32(3.40598e-08), 'std': np.float32(1.0), 'min': np.float32(-1.5811388), 'max': np.float32(0.6324556)}
2025-06-02 15:52:09,089 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:09,089 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:09,089 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 2, 'mean': np.float32(2.5714285), 'std': np.float32(0.9035079), 'min': np.float32(2.0), 'max': np.float32(4.0)}
2025-06-02 15:52:09,089 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.4285715), 'std': np.float32(0.9035078), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:52:09,089 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 2, 'mean': np.float32(0.2857143), 'std': np.float32(0.45175397), 'min': np.float32(0.0), 'max': np.float32(1.0)}
2025-06-02 15:52:09,089 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 1, 'mean': np.float32(5.0), 'std': np.float32(0.0), 'min': np.float32(5.0), 'max': np.float32(5.0)}
2025-06-02 15:52:09,089 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 2, 'mean': np.float32(-3.40598e-08), 'std': np.float32(1.0), 'min': np.float32(-0.6324556), 'max': np.float32(1.5811388)}
2025-06-02 15:52:09,089 - INFO - - service_1: {'name': 'service_1', 'unique': 3, 'mean': np.float32(2.0), 'std': np.float32(0.75592893), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:52:09,090 - INFO - - service_2: {'name': 'service_2', 'unique': 2, 'mean': np.float32(7.142857), 'std': np.float32(2.0995626), 'min': np.float32(2.0), 'max': np.float32(8.0)}
2025-06-02 15:52:09,090 - INFO - - service_3: {'name': 'service_3', 'unique': 1, 'mean': np.float32(8.0), 'std': np.float32(0.0), 'min': np.float32(8.0), 'max': np.float32(8.0)}
2025-06-02 15:52:09,090 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 2, 'mean': np.float32(0.2857143), 'std': np.float32(0.45175397), 'min': np.float32(0.0), 'max': np.float32(1.0)}
2025-06-02 15:52:09,090 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 2, 'mean': np.float32(6.0), 'std': np.float32(3.1622777), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:52:09,090 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 2, 'mean': np.float32(-3.40598e-08), 'std': np.float32(1.0), 'min': np.float32(-0.6324556), 'max': np.float32(1.5811388)}
2025-06-02 15:52:09,090 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(-3.40598e-08), 'std': np.float32(1.0), 'min': np.float32(-0.6324556), 'max': np.float32(1.5811388)}
2025-06-02 15:52:09,090 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:09,090 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:09,090 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:09,090 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:09,090 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:09,090 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:09,103 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x72fda7893f50>
2025-06-02 15:52:09,221 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:52:09,293 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:52:09,331 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:52:10,744 - INFO - Node feature visualization saved to vis/node_features_20250602_155209.png
2025-06-02 15:52:10,745 - INFO - Finished visualization of node features.
2025-06-02 15:52:10,745 - INFO - Performing additional feature analysis:
2025-06-02 15:52:10,745 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:52:10,746 - INFO - Starting visualization of edge features.
2025-06-02 15:52:10,746 - INFO - Graph has 5 edges and 10 edge features.
2025-06-02 15:52:10,746 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:52:10,746 - INFO - Calculating edge feature statistics:
2025-06-02 15:52:10,746 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:52:10,747 - INFO - - count: {'name': 'count', 'unique': 2, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.5), 'max': np.float32(2.0)}
2025-06-02 15:52:10,747 - INFO - - dst_port: {'name': 'dst_port', 'unique': 3, 'mean': np.float32(292.4), 'std': np.float32(184.64409), 'min': np.float32(53.0), 'max': np.float32(443.0)}
2025-06-02 15:52:10,747 - INFO - - protocol: {'name': 'protocol', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:10,747 - INFO - - service: {'name': 'service', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:10,747 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 5, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.9816251), 'max': np.float32(0.66214883)}
2025-06-02 15:52:10,747 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 5, 'mean': np.float32(-2.3841858e-08), 'std': np.float32(1.0), 'min': np.float32(-1.3328124), 'max': np.float32(1.2915914)}
2025-06-02 15:52:10,747 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 5, 'mean': np.float32(2.3841858e-08), 'std': np.float32(1.0), 'min': np.float32(-0.94280905), 'max': np.float32(1.8856181)}
2025-06-02 15:52:10,747 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 5, 'mean': np.float32(-1.1920929e-08), 'std': np.float32(1.0), 'min': np.float32(-0.9906747), 'max': np.float32(1.7452797)}
2025-06-02 15:52:10,747 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 5, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.9290494), 'max': np.float32(1.7669864)}
2025-06-02 15:52:10,747 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 4, 'mean': np.float32(4.7683717e-08), 'std': np.float32(1.0), 'min': np.float32(-1.0758876), 'max': np.float32(1.2000285)}
2025-06-02 15:52:10,767 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x72fda498d4c0>
2025-06-02 15:52:10,841 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:52:10,858 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x72fda5587380>
2025-06-02 15:52:10,922 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:52:11,101 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:52:11,208 - DEBUG - Plotted boxplots of the first 8 non-constant edge features.
2025-06-02 15:52:11,231 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:52:11,240 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:52:12,962 - INFO - Edge feature visualization saved to vis/edge_features_20250602_155211.png
2025-06-02 15:52:12,962 - INFO - Finished visualization of edge features.
2025-06-02 15:52:12,962 - INFO - Performing additional edge feature analysis:
2025-06-02 15:52:12,962 - INFO - - 2 out of 10 edge features are constant.
2025-06-02 15:52:12,963 - INFO - - Highest correlation (1.00) between features: 'total_resp_ip_bytes' and 'total_resp_bytes'.
2025-06-02 15:52:12,963 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:52:12,963 - INFO - Graph has 5 edges and 10 edge features.
2025-06-02 15:52:12,963 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:52:13,450 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_155212_summary.png
2025-06-02 15:52:13,811 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_155212_pca_3d.png
2025-06-02 15:52:14,020 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_155212_pca_variance.png
2025-06-02 15:52:14,020 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:52:14,020 - INFO - 
--- Processing file: nw_graph_encoded_1748869155.dot (Timestamp: 2025-06-02 14:59:15) ---
2025-06-02 15:52:14,020 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869155.dot
2025-06-02 15:52:14,020 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869155.dot'.
2025-06-02 15:52:14,021 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869155.dot
2025-06-02 15:52:14,021 - INFO - Parsed 19 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869155.dot'.
2025-06-02 15:52:14,021 - INFO - Parsed 26 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869155.dot'.
2025-06-02 15:52:14,021 - INFO - Processing node updates/additions.
2025-06-02 15:52:14,022 - INFO - Processing edge updates/additions.
2025-06-02 15:52:14,022 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:52:14,022 - INFO - Finished updating NetworkX graph.
2025-06-02 15:52:14,022 - DEBUG - Updated graph - Nodes: 19, Edges: 26
2025-06-02 15:52:14,022 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:52:14,022 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:52:14,022 - DEBUG - Initial node features tensor shape: torch.Size([19, 30])
2025-06-02 15:52:14,023 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:52:14,023 - DEBUG - Node features tensor shape after scaling: torch.Size([19, 30])
2025-06-02 15:52:14,023 - DEBUG - Edge index tensor shape: torch.Size([2, 26])
2025-06-02 15:52:14,023 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:52:14,023 - DEBUG - Initial edge attributes tensor shape: torch.Size([26, 10])
2025-06-02 15:52:14,024 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:52:14,024 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([26, 10])
2025-06-02 15:52:14,024 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:52:14,024 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:52:14,024 - INFO - Updated main graph to 19 nodes and 26 edges.
2025-06-02 15:52:14,024 - INFO - Performing online update...
2025-06-02 15:52:14,024 - INFO - Starting online update for 50 steps.
2025-06-02 15:52:14,025 - DEBUG - Updated RunningStats: new_mean=0.9453654939680765, new_var=35400000000164.47, new_n=3570
2025-06-02 15:52:14,025 - DEBUG - Updated RunningStats: new_mean=0.9431565309855564, new_var=35700000000013.53, new_n=3600
2025-06-02 15:52:14,025 - DEBUG - Updated RunningStats: new_mean=44.67764791116799, new_var=11800000088560.363, new_n=1190
2025-06-02 15:52:14,025 - DEBUG - Updated RunningStats: new_mean=44.48869090961222, new_var=11900000045586.602, new_n=1200
2025-06-02 15:52:14,025 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:52:14,025 - DEBUG - Online update step: 1/50
2025-06-02 15:52:14,025 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,025 - DEBUG - Online update step: 2/50
2025-06-02 15:52:14,025 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,025 - DEBUG - Online update step: 3/50
2025-06-02 15:52:14,025 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,025 - DEBUG - Online update step: 4/50
2025-06-02 15:52:14,025 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,025 - DEBUG - Online update step: 5/50
2025-06-02 15:52:14,025 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,025 - DEBUG - Online update step: 6/50
2025-06-02 15:52:14,025 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,025 - DEBUG - Online update step: 7/50
2025-06-02 15:52:14,025 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,025 - DEBUG - Online update step: 8/50
2025-06-02 15:52:14,025 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,025 - DEBUG - Online update step: 9/50
2025-06-02 15:52:14,025 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,025 - DEBUG - Online update step: 10/50
2025-06-02 15:52:14,025 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,025 - DEBUG - Online update step: 11/50
2025-06-02 15:52:14,025 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,026 - DEBUG - Online update step: 12/50
2025-06-02 15:52:14,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,026 - DEBUG - Online update step: 13/50
2025-06-02 15:52:14,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,026 - DEBUG - Online update step: 14/50
2025-06-02 15:52:14,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,026 - DEBUG - Online update step: 15/50
2025-06-02 15:52:14,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,026 - DEBUG - Online update step: 16/50
2025-06-02 15:52:14,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,026 - DEBUG - Online update step: 17/50
2025-06-02 15:52:14,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,026 - DEBUG - Online update step: 18/50
2025-06-02 15:52:14,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,026 - DEBUG - Online update step: 19/50
2025-06-02 15:52:14,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,026 - DEBUG - Online update step: 20/50
2025-06-02 15:52:14,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,026 - DEBUG - Online update step: 21/50
2025-06-02 15:52:14,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,026 - DEBUG - Online update step: 22/50
2025-06-02 15:52:14,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,026 - DEBUG - Online update step: 23/50
2025-06-02 15:52:14,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,026 - DEBUG - Online update step: 24/50
2025-06-02 15:52:14,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,026 - DEBUG - Online update step: 25/50
2025-06-02 15:52:14,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,026 - DEBUG - Online update step: 26/50
2025-06-02 15:52:14,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,026 - DEBUG - Online update step: 27/50
2025-06-02 15:52:14,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,026 - DEBUG - Online update step: 28/50
2025-06-02 15:52:14,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,026 - DEBUG - Online update step: 29/50
2025-06-02 15:52:14,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,026 - DEBUG - Online update step: 30/50
2025-06-02 15:52:14,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,026 - DEBUG - Online update step: 31/50
2025-06-02 15:52:14,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,026 - DEBUG - Online update step: 32/50
2025-06-02 15:52:14,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,026 - DEBUG - Online update step: 33/50
2025-06-02 15:52:14,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,026 - DEBUG - Online update step: 34/50
2025-06-02 15:52:14,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,026 - DEBUG - Online update step: 35/50
2025-06-02 15:52:14,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,026 - DEBUG - Online update step: 36/50
2025-06-02 15:52:14,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,027 - DEBUG - Online update step: 37/50
2025-06-02 15:52:14,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,027 - DEBUG - Online update step: 38/50
2025-06-02 15:52:14,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,027 - DEBUG - Online update step: 39/50
2025-06-02 15:52:14,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,027 - DEBUG - Online update step: 40/50
2025-06-02 15:52:14,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,027 - DEBUG - Online update step: 41/50
2025-06-02 15:52:14,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,027 - DEBUG - Online update step: 42/50
2025-06-02 15:52:14,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,027 - DEBUG - Online update step: 43/50
2025-06-02 15:52:14,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,027 - DEBUG - Online update step: 44/50
2025-06-02 15:52:14,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,027 - DEBUG - Online update step: 45/50
2025-06-02 15:52:14,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,027 - DEBUG - Online update step: 46/50
2025-06-02 15:52:14,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,027 - DEBUG - Online update step: 47/50
2025-06-02 15:52:14,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,027 - DEBUG - Online update step: 48/50
2025-06-02 15:52:14,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,027 - DEBUG - Online update step: 49/50
2025-06-02 15:52:14,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,027 - DEBUG - Online update step: 50/50
2025-06-02 15:52:14,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,027 - WARNING - No successful steps during online update.
2025-06-02 15:52:14,027 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -9.4112593e-09 -1.5685433e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.2741732e-09  1.2548346e-08  0.0000000e+00  3.7645037e-08
  2.5263157e+00  2.5789473e+00  2.1052632e-01  4.3157897e+00
 -1.2548346e-08  1.5789474e+00  7.3684211e+00  7.0000000e+00
  2.1052632e-01  8.0000000e+00  1.2548346e-08  1.2548346e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.8822519e-08  1.8822519e-08], current edge mean: [-3.2094810e-08  3.1034616e+02  0.0000000e+00  0.0000000e+00
 -1.3754918e-08 -1.1462432e-08 -9.1699457e-09 -1.3754918e-08
 -6.8774590e-09  9.1699457e-09]
2025-06-02 15:52:14,028 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -9.4112593e-09 -1.5685433e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.2741732e-09  1.2548346e-08  0.0000000e+00  3.7645037e-08
  2.5263157e+00  2.5789473e+00  2.1052632e-01  4.3157897e+00
 -1.2548346e-08  1.5789474e+00  7.3684211e+00  7.0000000e+00
  2.1052632e-01  8.0000000e+00  1.2548346e-08  1.2548346e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.8822519e-08  1.8822519e-08], edge=[-3.2094810e-08  3.1034616e+02  0.0000000e+00  0.0000000e+00
 -1.3754918e-08 -1.1462432e-08 -9.1699457e-09 -1.3754918e-08
 -6.8774590e-09  9.1699457e-09]
2025-06-02 15:52:14,028 - DEBUG - Updated reference std: node=[0.         0.         1.0274023  1.0274024  0.         0.
 0.         0.         1.0274024  1.0274024  1.0274023  1.0274024
 1.1239029  0.8377078  0.4188539  0.88522637 1.0274024  1.1212983
 1.9209524  2.3804762  0.4188539  0.         1.0274024  1.0274024
 0.         0.         0.         0.         1.0274024  1.0274024 ], edge=[  1.0198039 212.88945     0.          0.          1.0198039   1.0198039
   1.0198039   1.0198039   1.0198039   1.0198039]
2025-06-02 15:52:14,028 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:52:14,028 - INFO - Running anomaly detection...
2025-06-02 15:52:14,028 - INFO - Starting anomaly detection.
2025-06-02 15:52:14,030 - DEBUG - Node reconstruction errors: [0.12647636 1.8987937  0.29186103 0.11773321 0.11773332 0.1438237
 0.26670364 0.08184527 0.08184527 0.08115314 0.08184537 0.09901211
 0.34598178 0.09606717 0.19440569 0.09901214 0.08019121 0.0990121
 0.22426602]
2025-06-02 15:52:14,030 - DEBUG - Edge reconstruction errors: [ 5.250762   7.607572  44.159256   2.0672116 44.051464  44.166912
 44.453865   5.1389747  2.0672133 58.819874  58.819874   5.5764003
  7.1900587  7.4593687 43.759995   8.277984  58.249367   2.0493548
 46.247307  43.766228  43.759365  45.690456  44.64783   45.032375
 44.39883   44.1921   ]
2025-06-02 15:52:14,031 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155214_update_2.json
2025-06-02 15:52:14,031 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:52:14,038 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155214_update_2.pth and as latest_checkpoint.pth
2025-06-02 15:52:14,038 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869155.dot): 0.7726
2025-06-02 15:52:14,038 - WARNING - Detected 1 anomalous nodes (reconstruction-based):
2025-06-02 15:52:14,038 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.8988, MLP Score: 0.5419
2025-06-02 15:52:14,038 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-02 15:52:14,038 - INFO - 
--- Processing file: nw_graph_encoded_1748869185.dot (Timestamp: 2025-06-02 14:59:45) ---
2025-06-02 15:52:14,038 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869185.dot
2025-06-02 15:52:14,038 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869185.dot'.
2025-06-02 15:52:14,038 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869185.dot
2025-06-02 15:52:14,039 - INFO - Parsed 32 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869185.dot'.
2025-06-02 15:52:14,040 - INFO - Parsed 45 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869185.dot'.
2025-06-02 15:52:14,040 - INFO - Processing node updates/additions.
2025-06-02 15:52:14,040 - INFO - Processing edge updates/additions.
2025-06-02 15:52:14,040 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:52:14,040 - INFO - Finished updating NetworkX graph.
2025-06-02 15:52:14,040 - DEBUG - Updated graph - Nodes: 32, Edges: 45
2025-06-02 15:52:14,040 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:52:14,040 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:52:14,041 - DEBUG - Initial node features tensor shape: torch.Size([32, 30])
2025-06-02 15:52:14,042 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:52:14,042 - DEBUG - Node features tensor shape after scaling: torch.Size([32, 30])
2025-06-02 15:52:14,042 - DEBUG - Edge index tensor shape: torch.Size([2, 45])
2025-06-02 15:52:14,042 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:52:14,042 - DEBUG - Initial edge attributes tensor shape: torch.Size([45, 10])
2025-06-02 15:52:14,043 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:52:14,043 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([45, 10])
2025-06-02 15:52:14,043 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:52:14,043 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:52:14,043 - INFO - Updated main graph to 32 nodes and 45 edges.
2025-06-02 15:52:14,044 - INFO - Performing online update...
2025-06-02 15:52:14,044 - INFO - Starting online update for 50 steps.
2025-06-02 15:52:14,044 - DEBUG - Updated RunningStats: new_mean=0.9448057194429216, new_var=36000000000172.766, new_n=3630
2025-06-02 15:52:14,044 - DEBUG - Updated RunningStats: new_mean=0.942257291506212, new_var=36300000000012.336, new_n=3660
2025-06-02 15:52:14,044 - DEBUG - Updated RunningStats: new_mean=44.397030474995375, new_var=12000000101606.96, new_n=1210
2025-06-02 15:52:14,044 - DEBUG - Updated RunningStats: new_mean=44.19540396212905, new_var=12100000038533.977, new_n=1220
2025-06-02 15:52:14,044 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:52:14,044 - DEBUG - Online update step: 1/50
2025-06-02 15:52:14,044 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,045 - DEBUG - Online update step: 2/50
2025-06-02 15:52:14,045 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,045 - DEBUG - Online update step: 3/50
2025-06-02 15:52:14,045 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,045 - DEBUG - Online update step: 4/50
2025-06-02 15:52:14,045 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,045 - DEBUG - Online update step: 5/50
2025-06-02 15:52:14,045 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,045 - DEBUG - Online update step: 6/50
2025-06-02 15:52:14,045 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,045 - DEBUG - Online update step: 7/50
2025-06-02 15:52:14,045 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,045 - DEBUG - Online update step: 8/50
2025-06-02 15:52:14,045 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,045 - DEBUG - Online update step: 9/50
2025-06-02 15:52:14,045 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,045 - DEBUG - Online update step: 10/50
2025-06-02 15:52:14,045 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,045 - DEBUG - Online update step: 11/50
2025-06-02 15:52:14,045 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,045 - DEBUG - Online update step: 12/50
2025-06-02 15:52:14,045 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,045 - DEBUG - Online update step: 13/50
2025-06-02 15:52:14,045 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,045 - DEBUG - Online update step: 14/50
2025-06-02 15:52:14,045 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,045 - DEBUG - Online update step: 15/50
2025-06-02 15:52:14,045 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,045 - DEBUG - Online update step: 16/50
2025-06-02 15:52:14,045 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,045 - DEBUG - Online update step: 17/50
2025-06-02 15:52:14,045 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,045 - DEBUG - Online update step: 18/50
2025-06-02 15:52:14,045 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,045 - DEBUG - Online update step: 19/50
2025-06-02 15:52:14,045 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,045 - DEBUG - Online update step: 20/50
2025-06-02 15:52:14,045 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,046 - DEBUG - Online update step: 21/50
2025-06-02 15:52:14,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,046 - DEBUG - Online update step: 22/50
2025-06-02 15:52:14,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,046 - DEBUG - Online update step: 23/50
2025-06-02 15:52:14,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,046 - DEBUG - Online update step: 24/50
2025-06-02 15:52:14,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,046 - DEBUG - Online update step: 25/50
2025-06-02 15:52:14,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,046 - DEBUG - Online update step: 26/50
2025-06-02 15:52:14,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,046 - DEBUG - Online update step: 27/50
2025-06-02 15:52:14,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,046 - DEBUG - Online update step: 28/50
2025-06-02 15:52:14,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,046 - DEBUG - Online update step: 29/50
2025-06-02 15:52:14,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,046 - DEBUG - Online update step: 30/50
2025-06-02 15:52:14,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,046 - DEBUG - Online update step: 31/50
2025-06-02 15:52:14,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,046 - DEBUG - Online update step: 32/50
2025-06-02 15:52:14,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,046 - DEBUG - Online update step: 33/50
2025-06-02 15:52:14,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,046 - DEBUG - Online update step: 34/50
2025-06-02 15:52:14,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,046 - DEBUG - Online update step: 35/50
2025-06-02 15:52:14,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,046 - DEBUG - Online update step: 36/50
2025-06-02 15:52:14,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,046 - DEBUG - Online update step: 37/50
2025-06-02 15:52:14,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,046 - DEBUG - Online update step: 38/50
2025-06-02 15:52:14,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,046 - DEBUG - Online update step: 39/50
2025-06-02 15:52:14,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,046 - DEBUG - Online update step: 40/50
2025-06-02 15:52:14,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,047 - DEBUG - Online update step: 41/50
2025-06-02 15:52:14,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,047 - DEBUG - Online update step: 42/50
2025-06-02 15:52:14,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,047 - DEBUG - Online update step: 43/50
2025-06-02 15:52:14,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,047 - DEBUG - Online update step: 44/50
2025-06-02 15:52:14,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,047 - DEBUG - Online update step: 45/50
2025-06-02 15:52:14,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,047 - DEBUG - Online update step: 46/50
2025-06-02 15:52:14,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,047 - DEBUG - Online update step: 47/50
2025-06-02 15:52:14,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,047 - DEBUG - Online update step: 48/50
2025-06-02 15:52:14,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,047 - DEBUG - Online update step: 49/50
2025-06-02 15:52:14,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,047 - DEBUG - Online update step: 50/50
2025-06-02 15:52:14,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,047 - WARNING - No successful steps during online update.
2025-06-02 15:52:14,048 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -7.4505806e-09  7.4505806e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.9802322e-08  0.0000000e+00  2.9802322e-08 -2.9802322e-08
  2.5000000e+00  2.6875000e+00  1.2500000e-01  4.3125000e+00
  0.0000000e+00  1.5625000e+00  7.1875000e+00  7.7812500e+00
  1.2500000e-01  8.0000000e+00 -3.7252903e-08  4.4703484e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -7.4505806e-09  0.0000000e+00], current edge mean: [ 2.1192763e-08  3.3397778e+02  0.0000000e+00  0.0000000e+00
 -1.3245477e-08 -5.2981908e-09  0.0000000e+00  2.6490954e-09
  1.3245477e-09  0.0000000e+00]
2025-06-02 15:52:14,048 - DEBUG - Node drift difference: 0.3282, Edge drift difference: 0.1110
2025-06-02 15:52:14,048 - WARNING - Feature drift detected (1 consecutive)
2025-06-02 15:52:14,048 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -7.4505806e-09  7.4505806e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.9802322e-08  0.0000000e+00  2.9802322e-08 -2.9802322e-08
  2.5000000e+00  2.6875000e+00  1.2500000e-01  4.3125000e+00
  0.0000000e+00  1.5625000e+00  7.1875000e+00  7.7812500e+00
  1.2500000e-01  8.0000000e+00 -3.7252903e-08  4.4703484e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -7.4505806e-09  0.0000000e+00], edge=[ 2.1192763e-08  3.3397778e+02  0.0000000e+00  0.0000000e+00
 -1.3245477e-08 -5.2981908e-09  0.0000000e+00  2.6490954e-09
  1.3245477e-09  0.0000000e+00]
2025-06-02 15:52:14,049 - DEBUG - Updated reference std: node=[0.         0.         1.016001   1.016001   0.         0.
 0.         0.         1.016001   1.016001   1.016001   1.016001
 1.016001   0.73780406 0.33601075 0.89577866 1.016001   1.0757593
 2.206113   1.2374369  0.33601075 0.         1.016001   1.016001
 0.         0.         0.         0.         1.016001   1.016001  ], edge=[  1.0112998 190.90686     0.          0.          1.0112997   1.0112998
   1.0112997   1.0112998   1.0112998   1.0112998]
2025-06-02 15:52:14,049 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:52:14,049 - INFO - Running anomaly detection...
2025-06-02 15:52:14,049 - INFO - Starting anomaly detection.
2025-06-02 15:52:14,051 - DEBUG - Node reconstruction errors: [0.17884073 0.26972464 0.31572762 0.14051685 0.14051685 0.16339092
 0.35710993 0.06903534 0.06903534 0.0599952  0.06903534 0.07801207
 0.4084482  0.13899808 0.06192268 0.0783281  0.06138568 0.07801207
 0.19657105 0.08738877 0.06486201 0.06192268 0.07550135 0.08738874
 0.06192268 0.13500066 0.06192274 0.15898237 0.06486201 0.06192263
 0.08746479 0.07550135]
2025-06-02 15:52:14,051 - DEBUG - Edge reconstruction errors: [ 5.2321906  7.7941103 44.125893   2.292472   5.071058  44.105556
 44.119164  44.154144   5.171228   2.292472  58.564857  58.564857
 46.34927    7.7917814 44.11757   44.27825    5.609862   7.018899
  7.772013  44.072075   7.893328  58.48987    2.289871  46.312164
  7.7915926 44.118996  44.074654  44.07201   44.3086    44.15405
 44.221165  44.12675   44.113716  46.23307   44.433647  44.23547
 44.145535  44.115383  44.123173  44.107338  10.000067  44.11975
 44.122047  44.716366  44.08366  ]
2025-06-02 15:52:14,052 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155214_update_3.json
2025-06-02 15:52:14,053 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:52:14,060 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155214_update_3.pth and as latest_checkpoint.pth
2025-06-02 15:52:14,060 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869185.dot): 0.8206
2025-06-02 15:52:14,060 - WARNING - Detected 2 anomalous nodes (reconstruction-based):
2025-06-02 15:52:14,060 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.3571, MLP Score: 0.5172
2025-06-02 15:52:14,060 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.4084, MLP Score: 0.5095
2025-06-02 15:52:14,060 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-02 15:52:14,060 - INFO - 
--- Processing file: nw_graph_encoded_1748869215.dot (Timestamp: 2025-06-02 15:00:15) ---
2025-06-02 15:52:14,060 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869215.dot
2025-06-02 15:52:14,060 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869215.dot'.
2025-06-02 15:52:14,060 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869215.dot
2025-06-02 15:52:14,062 - INFO - Parsed 49 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869215.dot'.
2025-06-02 15:52:14,063 - INFO - Parsed 66 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869215.dot'.
2025-06-02 15:52:14,063 - INFO - Processing node updates/additions.
2025-06-02 15:52:14,063 - INFO - Processing edge updates/additions.
2025-06-02 15:52:14,064 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:52:14,064 - INFO - Finished updating NetworkX graph.
2025-06-02 15:52:14,064 - DEBUG - Updated graph - Nodes: 49, Edges: 66
2025-06-02 15:52:14,064 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:52:14,064 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:52:14,065 - DEBUG - Initial node features tensor shape: torch.Size([49, 30])
2025-06-02 15:52:14,066 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:52:14,066 - DEBUG - Node features tensor shape after scaling: torch.Size([49, 30])
2025-06-02 15:52:14,066 - DEBUG - Edge index tensor shape: torch.Size([2, 66])
2025-06-02 15:52:14,066 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:52:14,066 - DEBUG - Initial edge attributes tensor shape: torch.Size([66, 10])
2025-06-02 15:52:14,067 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:52:14,067 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([66, 10])
2025-06-02 15:52:14,067 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:52:14,068 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:52:14,068 - INFO - Updated main graph to 49 nodes and 66 edges.
2025-06-02 15:52:14,068 - INFO - Performing online update...
2025-06-02 15:52:14,068 - INFO - Starting online update for 50 steps.
2025-06-02 15:52:14,068 - DEBUG - Updated RunningStats: new_mean=0.9440043286040288, new_var=36600000000176.625, new_n=3690
2025-06-02 15:52:14,068 - DEBUG - Updated RunningStats: new_mean=0.9418004296105139, new_var=36900000000011.54, new_n=3720
2025-06-02 15:52:14,069 - DEBUG - Updated RunningStats: new_mean=44.12312054833447, new_var=12200000112961.021, new_n=1230
2025-06-02 15:52:14,069 - DEBUG - Updated RunningStats: new_mean=43.913051028844734, new_var=12300000033639.506, new_n=1240
2025-06-02 15:52:14,069 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:52:14,069 - DEBUG - Online update step: 1/50
2025-06-02 15:52:14,069 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,069 - DEBUG - Online update step: 2/50
2025-06-02 15:52:14,069 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,069 - DEBUG - Online update step: 3/50
2025-06-02 15:52:14,069 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,069 - DEBUG - Online update step: 4/50
2025-06-02 15:52:14,069 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,069 - DEBUG - Online update step: 5/50
2025-06-02 15:52:14,069 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,069 - DEBUG - Online update step: 6/50
2025-06-02 15:52:14,069 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,069 - DEBUG - Online update step: 7/50
2025-06-02 15:52:14,069 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,069 - DEBUG - Online update step: 8/50
2025-06-02 15:52:14,069 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,069 - DEBUG - Online update step: 9/50
2025-06-02 15:52:14,069 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,069 - DEBUG - Online update step: 10/50
2025-06-02 15:52:14,069 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,069 - DEBUG - Online update step: 11/50
2025-06-02 15:52:14,069 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,069 - DEBUG - Online update step: 12/50
2025-06-02 15:52:14,069 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,069 - DEBUG - Online update step: 13/50
2025-06-02 15:52:14,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,070 - DEBUG - Online update step: 14/50
2025-06-02 15:52:14,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,070 - DEBUG - Online update step: 15/50
2025-06-02 15:52:14,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,070 - DEBUG - Online update step: 16/50
2025-06-02 15:52:14,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,070 - DEBUG - Online update step: 17/50
2025-06-02 15:52:14,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,070 - DEBUG - Online update step: 18/50
2025-06-02 15:52:14,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,070 - DEBUG - Online update step: 19/50
2025-06-02 15:52:14,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,070 - DEBUG - Online update step: 20/50
2025-06-02 15:52:14,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,070 - DEBUG - Online update step: 21/50
2025-06-02 15:52:14,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,070 - DEBUG - Online update step: 22/50
2025-06-02 15:52:14,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,070 - DEBUG - Online update step: 23/50
2025-06-02 15:52:14,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,070 - DEBUG - Online update step: 24/50
2025-06-02 15:52:14,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,070 - DEBUG - Online update step: 25/50
2025-06-02 15:52:14,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,070 - DEBUG - Online update step: 26/50
2025-06-02 15:52:14,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,070 - DEBUG - Online update step: 27/50
2025-06-02 15:52:14,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,070 - DEBUG - Online update step: 28/50
2025-06-02 15:52:14,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,070 - DEBUG - Online update step: 29/50
2025-06-02 15:52:14,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,071 - DEBUG - Online update step: 30/50
2025-06-02 15:52:14,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,071 - DEBUG - Online update step: 31/50
2025-06-02 15:52:14,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,071 - DEBUG - Online update step: 32/50
2025-06-02 15:52:14,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,071 - DEBUG - Online update step: 33/50
2025-06-02 15:52:14,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,071 - DEBUG - Online update step: 34/50
2025-06-02 15:52:14,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,071 - DEBUG - Online update step: 35/50
2025-06-02 15:52:14,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,071 - DEBUG - Online update step: 36/50
2025-06-02 15:52:14,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,071 - DEBUG - Online update step: 37/50
2025-06-02 15:52:14,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,071 - DEBUG - Online update step: 38/50
2025-06-02 15:52:14,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,071 - DEBUG - Online update step: 39/50
2025-06-02 15:52:14,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,071 - DEBUG - Online update step: 40/50
2025-06-02 15:52:14,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,071 - DEBUG - Online update step: 41/50
2025-06-02 15:52:14,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,071 - DEBUG - Online update step: 42/50
2025-06-02 15:52:14,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,071 - DEBUG - Online update step: 43/50
2025-06-02 15:52:14,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,071 - DEBUG - Online update step: 44/50
2025-06-02 15:52:14,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,071 - DEBUG - Online update step: 45/50
2025-06-02 15:52:14,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,071 - DEBUG - Online update step: 46/50
2025-06-02 15:52:14,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,072 - DEBUG - Online update step: 47/50
2025-06-02 15:52:14,072 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,072 - DEBUG - Online update step: 48/50
2025-06-02 15:52:14,072 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,072 - DEBUG - Online update step: 49/50
2025-06-02 15:52:14,072 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,072 - DEBUG - Online update step: 50/50
2025-06-02 15:52:14,072 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,072 - WARNING - No successful steps during online update.
2025-06-02 15:52:14,072 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  1.3380634e-08  1.5813477e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -4.8656852e-09 -2.4328427e-08 -9.7313704e-09  3.8925482e-08
  2.7959185e+00  2.7959185e+00  1.0204082e-01  4.4489794e+00
  2.9194112e-08  1.3673469e+00  7.3673468e+00  7.7346940e+00
  1.0204082e-01  8.0000000e+00  9.7313704e-09 -4.8656855e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -4.8656852e-09  2.4328427e-08], current edge mean: [-1.4449611e-08  3.5304544e+02  0.0000000e+00  0.0000000e+00
  3.6124028e-09 -3.6124028e-09  9.0310071e-09 -7.2248056e-09
 -7.2248056e-09  0.0000000e+00]
2025-06-02 15:52:14,073 - DEBUG - Node drift difference: 0.2913, Edge drift difference: 0.0999
2025-06-02 15:52:14,073 - WARNING - Feature drift detected (2 consecutive)
2025-06-02 15:52:14,073 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  1.3380634e-08  1.5813477e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -4.8656852e-09 -2.4328427e-08 -9.7313704e-09  3.8925482e-08
  2.7959185e+00  2.7959185e+00  1.0204082e-01  4.4489794e+00
  2.9194112e-08  1.3673469e+00  7.3673468e+00  7.7346940e+00
  1.0204082e-01  8.0000000e+00  9.7313704e-09 -4.8656855e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -4.8656852e-09  2.4328427e-08], edge=[-1.4449611e-08  3.5304544e+02  0.0000000e+00  0.0000000e+00
  3.6124028e-09 -3.6124028e-09  9.0310071e-09 -7.2248056e-09
 -7.2248056e-09  0.0000000e+00]
2025-06-02 15:52:14,074 - DEBUG - Updated reference std: node=[0.         0.         1.010363   1.010363   0.         0.
 0.         1.010363   1.010363   1.010363   1.010363   1.010363
 1.6953317  0.61167777 0.30583888 0.81805724 1.010363   1.0346875
 1.9223887  1.3034492  0.30583888 0.         1.010363   1.010363
 0.         0.         0.         0.         1.010363   1.010363  ], edge=[  1.007663  173.69136     0.          0.          1.007663    1.007663
   1.0076629   1.0076629   1.007663    1.007663 ]
2025-06-02 15:52:14,074 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:52:14,074 - INFO - Running anomaly detection...
2025-06-02 15:52:14,074 - INFO - Starting anomaly detection.
2025-06-02 15:52:14,076 - DEBUG - Node reconstruction errors: [0.13699614 0.30323184 0.45121086 0.13792859 0.13792859 0.15622297
 0.47757688 0.03423966 0.03423966 0.03345681 0.03423966 0.0342411
 0.4557392  0.31115383 0.01909179 0.03435567 0.02711072 0.0342411
 0.10745856 0.03675451 0.02540863 0.01909179 0.03368581 0.03675451
 0.02016383 0.139651   0.02016385 0.1156762  0.02540863 0.02016381
 0.03693557 0.03368581 0.04837559 0.10449198 0.11865479 0.02259355
 0.13243361 0.03675451 0.02212984 0.16621113 0.02443632 0.0225936
 0.03675451 0.01450552 0.01609343 0.02259355 0.04292877 0.12116311
 0.03388811]
2025-06-02 15:52:14,077 - DEBUG - Edge reconstruction errors: [ 5.228144   7.8398895 44.15513    2.3393335  5.23755   44.142467
 44.182304  44.14397   44.142395  44.146614  44.158154   5.286314
  2.3393335 58.57589   58.57589   46.36811    7.865438  44.201237
 44.211533   5.52687    6.785712  44.141144   7.8285027 44.12852
  7.8982773 58.537792   2.3377907 46.348408   7.838389  44.282722
 44.131355  44.1285    44.24311   44.16738   44.184544  44.156235
 44.14857   46.46783   44.31689   44.289158  44.16592   44.303673
 44.303673  44.141144  44.279842  44.151485  44.195576   8.639876
 44.15219   44.15155   44.423683  44.136005  10.821379  13.627287
  7.842897  44.12747   44.1285    44.12852   44.13077   44.17232
 44.21737   44.149956  44.161457  44.151543  44.238262  44.130234 ]
2025-06-02 15:52:14,078 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155214_update_4.json
2025-06-02 15:52:14,078 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:52:14,085 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155214_update_4.pth and as latest_checkpoint.pth
2025-06-02 15:52:14,086 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869215.dot): 0.8120
2025-06-02 15:52:14,086 - WARNING - Detected 3 anomalous nodes (reconstruction-based):
2025-06-02 15:52:14,086 - WARNING -   Node ID: 192.168.27.13, Recon Error: 0.4512, MLP Score: 0.5032
2025-06-02 15:52:14,086 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.4776, MLP Score: 0.5346
2025-06-02 15:52:14,086 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.4557, MLP Score: 0.5128
2025-06-02 15:52:14,086 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-02 15:52:14,086 - INFO - 
--- Processing file: nw_graph_encoded_1748869245.dot (Timestamp: 2025-06-02 15:00:45) ---
2025-06-02 15:52:14,086 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869245.dot
2025-06-02 15:52:14,086 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869245.dot'.
2025-06-02 15:52:14,086 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869245.dot
2025-06-02 15:52:14,088 - INFO - Parsed 54 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869245.dot'.
2025-06-02 15:52:14,089 - INFO - Parsed 71 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869245.dot'.
2025-06-02 15:52:14,089 - INFO - Processing node updates/additions.
2025-06-02 15:52:14,090 - INFO - Processing edge updates/additions.
2025-06-02 15:52:14,090 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:52:14,090 - INFO - Finished updating NetworkX graph.
2025-06-02 15:52:14,090 - DEBUG - Updated graph - Nodes: 54, Edges: 71
2025-06-02 15:52:14,090 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:52:14,091 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:52:14,091 - DEBUG - Initial node features tensor shape: torch.Size([54, 30])
2025-06-02 15:52:14,092 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:52:14,093 - DEBUG - Node features tensor shape after scaling: torch.Size([54, 30])
2025-06-02 15:52:14,093 - DEBUG - Edge index tensor shape: torch.Size([2, 71])
2025-06-02 15:52:14,093 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:52:14,093 - DEBUG - Initial edge attributes tensor shape: torch.Size([71, 10])
2025-06-02 15:52:14,094 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:52:14,094 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([71, 10])
2025-06-02 15:52:14,094 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:52:14,094 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:52:14,094 - INFO - Updated main graph to 54 nodes and 71 edges.
2025-06-02 15:52:14,094 - INFO - Performing online update...
2025-06-02 15:52:14,095 - INFO - Starting online update for 50 steps.
2025-06-02 15:52:14,095 - DEBUG - Updated RunningStats: new_mean=0.9435894829658137, new_var=37200000000176.38, new_n=3750
2025-06-02 15:52:14,095 - DEBUG - Updated RunningStats: new_mean=0.9415226766107837, new_var=37500000000011.445, new_n=3780
2025-06-02 15:52:14,095 - DEBUG - Updated RunningStats: new_mean=43.83758888134542, new_var=12400000107882.742, new_n=1250
2025-06-02 15:52:14,095 - DEBUG - Updated RunningStats: new_mean=43.63498435043688, new_var=12500000034111.521, new_n=1260
2025-06-02 15:52:14,096 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:52:14,096 - DEBUG - Online update step: 1/50
2025-06-02 15:52:14,096 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,096 - DEBUG - Online update step: 2/50
2025-06-02 15:52:14,096 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,096 - DEBUG - Online update step: 3/50
2025-06-02 15:52:14,096 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,096 - DEBUG - Online update step: 4/50
2025-06-02 15:52:14,096 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,096 - DEBUG - Online update step: 5/50
2025-06-02 15:52:14,096 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,096 - DEBUG - Online update step: 6/50
2025-06-02 15:52:14,096 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,096 - DEBUG - Online update step: 7/50
2025-06-02 15:52:14,096 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,096 - DEBUG - Online update step: 8/50
2025-06-02 15:52:14,096 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,096 - DEBUG - Online update step: 9/50
2025-06-02 15:52:14,096 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,096 - DEBUG - Online update step: 10/50
2025-06-02 15:52:14,096 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,096 - DEBUG - Online update step: 11/50
2025-06-02 15:52:14,096 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,096 - DEBUG - Online update step: 12/50
2025-06-02 15:52:14,096 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,096 - DEBUG - Online update step: 13/50
2025-06-02 15:52:14,096 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,096 - DEBUG - Online update step: 14/50
2025-06-02 15:52:14,096 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,097 - DEBUG - Online update step: 15/50
2025-06-02 15:52:14,097 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,097 - DEBUG - Online update step: 16/50
2025-06-02 15:52:14,097 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,097 - DEBUG - Online update step: 17/50
2025-06-02 15:52:14,097 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,097 - DEBUG - Online update step: 18/50
2025-06-02 15:52:14,097 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,097 - DEBUG - Online update step: 19/50
2025-06-02 15:52:14,097 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,097 - DEBUG - Online update step: 20/50
2025-06-02 15:52:14,097 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,097 - DEBUG - Online update step: 21/50
2025-06-02 15:52:14,097 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,097 - DEBUG - Online update step: 22/50
2025-06-02 15:52:14,097 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,097 - DEBUG - Online update step: 23/50
2025-06-02 15:52:14,097 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,097 - DEBUG - Online update step: 24/50
2025-06-02 15:52:14,097 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,097 - DEBUG - Online update step: 25/50
2025-06-02 15:52:14,097 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,097 - DEBUG - Online update step: 26/50
2025-06-02 15:52:14,097 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,097 - DEBUG - Online update step: 27/50
2025-06-02 15:52:14,097 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,097 - DEBUG - Online update step: 28/50
2025-06-02 15:52:14,097 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,097 - DEBUG - Online update step: 29/50
2025-06-02 15:52:14,097 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,097 - DEBUG - Online update step: 30/50
2025-06-02 15:52:14,098 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,098 - DEBUG - Online update step: 31/50
2025-06-02 15:52:14,098 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,098 - DEBUG - Online update step: 32/50
2025-06-02 15:52:14,098 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,098 - DEBUG - Online update step: 33/50
2025-06-02 15:52:14,098 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,098 - DEBUG - Online update step: 34/50
2025-06-02 15:52:14,098 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,098 - DEBUG - Online update step: 35/50
2025-06-02 15:52:14,098 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,098 - DEBUG - Online update step: 36/50
2025-06-02 15:52:14,098 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,098 - DEBUG - Online update step: 37/50
2025-06-02 15:52:14,098 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,098 - DEBUG - Online update step: 38/50
2025-06-02 15:52:14,098 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,098 - DEBUG - Online update step: 39/50
2025-06-02 15:52:14,098 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,098 - DEBUG - Online update step: 40/50
2025-06-02 15:52:14,098 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,098 - DEBUG - Online update step: 41/50
2025-06-02 15:52:14,098 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,098 - DEBUG - Online update step: 42/50
2025-06-02 15:52:14,098 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,098 - DEBUG - Online update step: 43/50
2025-06-02 15:52:14,098 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,098 - DEBUG - Online update step: 44/50
2025-06-02 15:52:14,098 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,098 - DEBUG - Online update step: 45/50
2025-06-02 15:52:14,098 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,098 - DEBUG - Online update step: 46/50
2025-06-02 15:52:14,099 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,099 - DEBUG - Online update step: 47/50
2025-06-02 15:52:14,099 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,099 - DEBUG - Online update step: 48/50
2025-06-02 15:52:14,099 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,099 - DEBUG - Online update step: 49/50
2025-06-02 15:52:14,099 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,099 - DEBUG - Online update step: 50/50
2025-06-02 15:52:14,099 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,099 - WARNING - No successful steps during online update.
2025-06-02 15:52:14,100 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  4.8566747e-08 -6.6227384e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.3245477e-08
  0.0000000e+00 -2.6490953e-08  2.6490953e-08 -8.8303178e-09
  2.9444444e+00  2.8148148e+00  1.8518518e-01  4.4444447e+00
  2.6490953e-08  1.3333334e+00  7.2962961e+00  7.7592592e+00
  1.8518518e-01  8.0000000e+00  3.9736431e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -7.0642542e-08], current edge mean: [ 0.0000000e+00  3.4480283e+02  0.0000000e+00  0.0000000e+00
 -6.7160162e-09  1.0074024e-08  0.0000000e+00 -1.0074024e-08
 -6.7160162e-09  0.0000000e+00]
2025-06-02 15:52:14,100 - DEBUG - Node drift difference: 0.2719, Edge drift difference: 0.0475
2025-06-02 15:52:14,100 - WARNING - Feature drift detected (3 consecutive)
2025-06-02 15:52:14,100 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-02 15:52:14,100 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-02 15:52:14,100 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-02 15:52:14,100 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-02 15:52:14,100 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-02 15:52:14,101 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-02 15:52:14,101 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-02 15:52:14,101 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-02 15:52:14,101 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-02 15:52:14,101 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-02 15:52:14,101 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-02 15:52:14,101 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-02 15:52:14,101 - INFO - Optimizer and scheduler reset.
2025-06-02 15:52:14,102 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  4.8566747e-08 -6.6227384e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.3245477e-08
  0.0000000e+00 -2.6490953e-08  2.6490953e-08 -8.8303178e-09
  2.9444444e+00  2.8148148e+00  1.8518518e-01  4.4444447e+00
  2.6490953e-08  1.3333334e+00  7.2962961e+00  7.7592592e+00
  1.8518518e-01  8.0000000e+00  3.9736431e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -7.0642542e-08], edge=[ 0.0000000e+00  3.4480283e+02  0.0000000e+00  0.0000000e+00
 -6.7160162e-09  1.0074024e-08  0.0000000e+00 -1.0074024e-08
 -6.7160162e-09  0.0000000e+00]
2025-06-02 15:52:14,102 - DEBUG - Updated reference std: node=[0.         0.         1.0093899  1.0093899  0.         0.
 0.         1.0093899  1.0093899  1.0093899  1.0093899  1.0093899
 1.7420079  0.58516484 0.47875917 0.7930516  1.0093899  1.0279124
 2.0339537  1.2428693  0.47875917 0.         1.0093899  1.0093899
 0.         0.         0.         0.         1.0093899  1.0093899 ], edge=[  1.0071175 176.04436     0.          0.          1.0071175   1.0071175
   1.0071175   1.0071175   1.0071175   1.0071175]
2025-06-02 15:52:14,103 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:52:14,103 - INFO - Running anomaly detection...
2025-06-02 15:52:14,103 - INFO - Starting anomaly detection.
2025-06-02 15:52:14,106 - DEBUG - Node reconstruction errors: [13.223681 10.482775 11.345683 14.175372 14.175373 13.636566 11.389856
 12.374741 12.374742 12.672845 12.374742 12.885825 13.056506  9.818531
 13.51636  12.884774 13.911845 12.885825 12.6555   12.842944 12.348394
 13.51636  12.484208 12.842944 13.510129 13.01476  13.510129  8.336759
 12.348393 13.510128  9.858296 12.484208 13.391907 14.166685 13.094543
 14.005674 12.923604 12.842944 13.143221 12.437139 14.639138 14.005672
 12.842944 13.849329 13.44479  13.373644 14.814145 16.180096 12.806235
 14.094327 14.858676 13.447032 13.485289 13.677065]
2025-06-02 15:52:14,106 - DEBUG - Edge reconstruction errors: [ 5.204664   7.8302407 44.200138   2.2625785  5.2028294 44.133514
 44.172997  44.135014  44.133434  44.13773   44.149437   5.309285
  2.2673953 58.566673  58.566673  46.358963   7.8551173 44.19161
 44.20235   44.150635   6.2970457  6.6164546 44.131416   7.818474
 44.119473   7.8850923 58.528645   2.2427356 46.339302   7.8289413
 44.272003  44.121773  44.119453  44.233025  44.15865   44.17606
 44.147457  44.139675  46.50967   44.308556  44.279865  44.156483
 44.295506  44.295506  44.131416  44.270535  44.142548  44.18615
  8.638065   8.287049  44.14338   44.142693  44.4202    44.126373
 10.838201  13.618245   7.833365  44.11843   44.119453  44.119473
 44.12124   44.163567  44.293346  44.141136  44.152718  44.194458
 44.23091   44.121147  44.144108   7.8240275 13.220075 ]
2025-06-02 15:52:14,107 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155214_update_5.json
2025-06-02 15:52:14,108 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:52:14,111 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155214_update_5.pth and as latest_checkpoint.pth
2025-06-02 15:52:14,112 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869245.dot): 0.2600
2025-06-02 15:52:14,112 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-02 15:52:14,112 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-02 15:52:14,112 - INFO - 
--- Processing file: nw_graph_encoded_1748869275.dot (Timestamp: 2025-06-02 15:01:15) ---
2025-06-02 15:52:14,112 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869275.dot
2025-06-02 15:52:14,112 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869275.dot'.
2025-06-02 15:52:14,112 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869275.dot
2025-06-02 15:52:14,114 - INFO - Parsed 62 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869275.dot'.
2025-06-02 15:52:14,116 - INFO - Parsed 86 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869275.dot'.
2025-06-02 15:52:14,116 - INFO - Processing node updates/additions.
2025-06-02 15:52:14,116 - INFO - Processing edge updates/additions.
2025-06-02 15:52:14,117 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:52:14,117 - INFO - Finished updating NetworkX graph.
2025-06-02 15:52:14,118 - DEBUG - Updated graph - Nodes: 62, Edges: 86
2025-06-02 15:52:14,118 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:52:14,118 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:52:14,119 - DEBUG - Initial node features tensor shape: torch.Size([62, 30])
2025-06-02 15:52:14,121 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:52:14,121 - DEBUG - Node features tensor shape after scaling: torch.Size([62, 30])
2025-06-02 15:52:14,122 - DEBUG - Edge index tensor shape: torch.Size([2, 86])
2025-06-02 15:52:14,122 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:52:14,122 - DEBUG - Initial edge attributes tensor shape: torch.Size([86, 10])
2025-06-02 15:52:14,123 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:52:14,124 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([86, 10])
2025-06-02 15:52:14,124 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:52:14,124 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:52:14,124 - INFO - Updated main graph to 62 nodes and 86 edges.
2025-06-02 15:52:14,124 - INFO - Performing online update...
2025-06-02 15:52:14,124 - INFO - Starting online update for 50 steps.
2025-06-02 15:52:14,125 - DEBUG - Updated RunningStats: new_mean=0.9431726969968776, new_var=37800000000173.09, new_n=3810
2025-06-02 15:52:14,125 - DEBUG - Updated RunningStats: new_mean=0.9412165107413665, new_var=38100000000011.79, new_n=3840
2025-06-02 15:52:14,125 - DEBUG - Updated RunningStats: new_mean=43.560281123733645, new_var=12600000105838.734, new_n=1270
2025-06-02 15:52:14,125 - DEBUG - Updated RunningStats: new_mean=43.365570950353266, new_var=12700000034856.775, new_n=1280
2025-06-02 15:52:14,125 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:52:14,126 - DEBUG - Online update step: 1/50
2025-06-02 15:52:14,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,126 - DEBUG - Online update step: 2/50
2025-06-02 15:52:14,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,126 - DEBUG - Online update step: 3/50
2025-06-02 15:52:14,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,126 - DEBUG - Online update step: 4/50
2025-06-02 15:52:14,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,126 - DEBUG - Online update step: 5/50
2025-06-02 15:52:14,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,126 - DEBUG - Online update step: 6/50
2025-06-02 15:52:14,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,126 - DEBUG - Online update step: 7/50
2025-06-02 15:52:14,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,126 - DEBUG - Online update step: 8/50
2025-06-02 15:52:14,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,126 - DEBUG - Online update step: 9/50
2025-06-02 15:52:14,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,126 - DEBUG - Online update step: 10/50
2025-06-02 15:52:14,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,126 - DEBUG - Online update step: 11/50
2025-06-02 15:52:14,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,126 - DEBUG - Online update step: 12/50
2025-06-02 15:52:14,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,126 - DEBUG - Online update step: 13/50
2025-06-02 15:52:14,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,126 - DEBUG - Online update step: 14/50
2025-06-02 15:52:14,127 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,127 - DEBUG - Online update step: 15/50
2025-06-02 15:52:14,127 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,127 - DEBUG - Online update step: 16/50
2025-06-02 15:52:14,127 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,127 - DEBUG - Online update step: 17/50
2025-06-02 15:52:14,127 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,127 - DEBUG - Online update step: 18/50
2025-06-02 15:52:14,127 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,127 - DEBUG - Online update step: 19/50
2025-06-02 15:52:14,127 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,127 - DEBUG - Online update step: 20/50
2025-06-02 15:52:14,127 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,127 - DEBUG - Online update step: 21/50
2025-06-02 15:52:14,127 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,127 - DEBUG - Online update step: 22/50
2025-06-02 15:52:14,127 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,127 - DEBUG - Online update step: 23/50
2025-06-02 15:52:14,127 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,127 - DEBUG - Online update step: 24/50
2025-06-02 15:52:14,127 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,127 - DEBUG - Online update step: 25/50
2025-06-02 15:52:14,127 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,127 - DEBUG - Online update step: 26/50
2025-06-02 15:52:14,127 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,127 - DEBUG - Online update step: 27/50
2025-06-02 15:52:14,127 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,127 - DEBUG - Online update step: 28/50
2025-06-02 15:52:14,127 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,128 - DEBUG - Online update step: 29/50
2025-06-02 15:52:14,128 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,128 - DEBUG - Online update step: 30/50
2025-06-02 15:52:14,128 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,128 - DEBUG - Online update step: 31/50
2025-06-02 15:52:14,128 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,128 - DEBUG - Online update step: 32/50
2025-06-02 15:52:14,128 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,128 - DEBUG - Online update step: 33/50
2025-06-02 15:52:14,128 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,128 - DEBUG - Online update step: 34/50
2025-06-02 15:52:14,128 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,128 - DEBUG - Online update step: 35/50
2025-06-02 15:52:14,128 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,128 - DEBUG - Online update step: 36/50
2025-06-02 15:52:14,128 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,128 - DEBUG - Online update step: 37/50
2025-06-02 15:52:14,128 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,128 - DEBUG - Online update step: 38/50
2025-06-02 15:52:14,128 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,128 - DEBUG - Online update step: 39/50
2025-06-02 15:52:14,128 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,128 - DEBUG - Online update step: 40/50
2025-06-02 15:52:14,128 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,128 - DEBUG - Online update step: 41/50
2025-06-02 15:52:14,128 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,128 - DEBUG - Online update step: 42/50
2025-06-02 15:52:14,128 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,128 - DEBUG - Online update step: 43/50
2025-06-02 15:52:14,129 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,129 - DEBUG - Online update step: 44/50
2025-06-02 15:52:14,129 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,129 - DEBUG - Online update step: 45/50
2025-06-02 15:52:14,129 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,129 - DEBUG - Online update step: 46/50
2025-06-02 15:52:14,129 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,129 - DEBUG - Online update step: 47/50
2025-06-02 15:52:14,129 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,129 - DEBUG - Online update step: 48/50
2025-06-02 15:52:14,129 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,129 - DEBUG - Online update step: 49/50
2025-06-02 15:52:14,129 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,129 - DEBUG - Online update step: 50/50
2025-06-02 15:52:14,129 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:14,129 - WARNING - No successful steps during online update.
2025-06-02 15:52:14,130 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00  4.03773406e-08  8.65228742e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00 -4.61455301e-08
 -1.53818434e-08  3.07636867e-08 -1.73045738e-08 -1.92273042e-08
  2.98387098e+00  2.74193549e+00  1.45161286e-01  4.45161295e+00
 -3.07636867e-08  1.25806451e+00  7.22580624e+00  7.58064508e+00
  1.45161286e-01  8.00000000e+00  3.84546084e-08  1.15363825e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  7.69092168e-09  5.76819126e-08], current edge mean: [-1.6633855e-08  3.4147675e+02  0.0000000e+00  0.0000000e+00
  4.1584638e-09 -4.1584638e-09  8.3169276e-09  7.6238500e-09
 -7.9703888e-09 -5.5446181e-09]
2025-06-02 15:52:14,130 - DEBUG - Node drift difference: 0.1437, Edge drift difference: 0.0189
2025-06-02 15:52:14,131 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00  4.03773406e-08  8.65228742e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00 -4.61455301e-08
 -1.53818434e-08  3.07636867e-08 -1.73045738e-08 -1.92273042e-08
  2.98387098e+00  2.74193549e+00  1.45161286e-01  4.45161295e+00
 -3.07636867e-08  1.25806451e+00  7.22580624e+00  7.58064508e+00
  1.45161286e-01  8.00000000e+00  3.84546084e-08  1.15363825e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  7.69092168e-09  5.76819126e-08], edge=[-1.6633855e-08  3.4147675e+02  0.0000000e+00  0.0000000e+00
  4.1584638e-09 -4.1584638e-09  8.3169276e-09  7.6238500e-09
 -7.9703888e-09 -5.5446181e-09]
2025-06-02 15:52:14,131 - DEBUG - Updated reference std: node=[0.         0.         1.0081633  1.0081635  0.         0.
 0.         1.0081633  1.0081635  1.0081635  1.0081635  1.0081635
 1.6936907  0.6759446  0.43783274 0.78254354 1.0081635  0.9907024
 2.051943   1.6149749  0.43783274 0.         1.0081635  1.0081633
 0.         0.         0.         0.         1.0081635  1.0081635 ], edge=[  1.0058651 179.33273     0.          0.          1.0058652   1.0058652
   1.0058652   1.0058652   1.0058651   1.0058651]
2025-06-02 15:52:14,131 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:52:14,131 - INFO - Running anomaly detection...
2025-06-02 15:52:14,132 - INFO - Starting anomaly detection.
2025-06-02 15:52:14,135 - DEBUG - Node reconstruction errors: [13.224535   8.720447  11.446451  13.520932  13.520932  13.079349
  8.820759  12.345083  12.345083  12.611485  12.345083  10.409034
 12.036061   9.894986  13.5266    12.888626  13.870103  12.889118
 12.466422  12.7998    12.301711  13.526599  12.429751  12.7998
 13.401373  12.382781  13.401373   8.699634  12.301715  13.401374
  9.719771  12.42975   13.035425  14.054657  12.907246  13.710001
 12.701274  12.7998    13.131495  12.351981  14.272668  13.710003
 12.7998    13.837575  13.433529  13.049865  14.743764  15.969583
 12.486448  13.698575  14.145831  13.1184435 12.562027  13.346691
 12.453557  14.2394     8.832732  13.67329   12.6958475 13.260865
  9.715373  14.817724 ]
2025-06-02 15:52:14,136 - DEBUG - Edge reconstruction errors: [ 5.342731   7.8297687 44.287804   2.2603397  5.2330813 44.1342
 44.17655   44.13582    7.8230543 44.134117  44.13878   44.15148
  5.3498116  2.2554703 58.569542  58.569542  46.36133    7.8971415
 44.38584   44.208183  44.152763   7.8223    44.13243   44.125065
 44.18415   44.139397   6.578543   6.6824875 44.131626   7.8179493
 44.119064   7.8886056 58.52883    2.20521   46.34029    7.828196
 44.281986  44.121387  44.192585  44.56428   44.24063   44.161293
 44.18023   44.149246  44.14083   46.71198   44.32263   44.291332
 44.1587    44.461063  44.461063  44.131626  44.281307  44.143894
 44.190517   8.703809   8.325187  44.144844  44.144096  44.445194
 44.12629   11.085052  13.617762   7.8339    44.11796   44.119045
 44.119064  44.120842  44.166588  44.30593   44.14249   44.15493
 44.19966   44.239555  44.120846  44.145695   7.8237953 44.119095
 44.172447  13.219678   2.0002098 58.522938   1.9850881 46.329697
 44.13199    7.817961 ]
2025-06-02 15:52:14,137 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155214_update_6.json
2025-06-02 15:52:14,138 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:52:14,141 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155214_update_6.pth and as latest_checkpoint.pth
2025-06-02 15:52:14,142 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869275.dot): 0.2729
2025-06-02 15:52:14,142 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-02 15:52:14,142 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-02 15:52:14,145 - DEBUG - Embedding standard deviations before t-SNE: [1.0830809  0.3978304  1.348974   1.0387974  1.5644978  0.
 0.7300247  1.3272773  1.9034121  1.0619857  0.6669105  0.
 1.8038956  0.81664443 1.3433009  1.3990982  0.         0.46300763
 0.         0.24952587 1.2869505  0.84877384 0.         1.7006949
 0.87036526 1.075816   0.         0.78050375 1.1941704  0.
 1.3491744  0.37871137]
2025-06-02 15:52:14,591 - INFO - Embeddings visualization saved to vis/embeddings_6_updates_20250602_155214.png
2025-06-02 15:52:14,592 - INFO - Performing visualization of node and edge features.
2025-06-02 15:52:14,592 - INFO - Starting visualization of node features.
2025-06-02 15:52:14,592 - INFO - Graph has 62 nodes and 30 features.
2025-06-02 15:52:14,592 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:52:14,592 - INFO - Calculating feature statistics:
2025-06-02 15:52:14,593 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:14,593 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:14,593 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 4, 'mean': np.float32(1.9227304e-08), 'std': np.float32(1.0), 'min': np.float32(-1.1658509), 'max': np.float32(1.8922695)}
2025-06-02 15:52:14,593 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 4, 'mean': np.float32(3.845461e-09), 'std': np.float32(0.99999994), 'min': np.float32(-1.8845364), 'max': np.float32(1.1707802)}
2025-06-02 15:52:14,593 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:14,593 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:14,593 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:14,593 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(-1.2978431e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.18257418), 'max': np.float32(5.4772253)}
2025-06-02 15:52:14,594 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(-2.4995495e-08), 'std': np.float32(1.0), 'min': np.float32(-0.7679477), 'max': np.float32(1.3021721)}
2025-06-02 15:52:14,594 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 3, 'mean': np.float32(-1.15363825e-08), 'std': np.float32(1.0000001), 'min': np.float32(-3.3477669), 'max': np.float32(0.3117721)}
2025-06-02 15:52:14,594 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 4, 'mean': np.float32(-1.15363825e-08), 'std': np.float32(1.0), 'min': np.float32(-1.5117006), 'max': np.float32(1.3328699)}
2025-06-02 15:52:14,594 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 4, 'mean': np.float32(-3.0763687e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.3289211), 'max': np.float32(1.5174078)}
2025-06-02 15:52:14,594 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 7, 'mean': np.float32(2.983871), 'std': np.float32(1.6799763), 'min': np.float32(0.0), 'max': np.float32(10.0)}
2025-06-02 15:52:14,594 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.7419355), 'std': np.float32(0.67047125), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:52:14,594 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.14516129), 'std': np.float32(0.43428746), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:52:14,594 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.451613), 'std': np.float32(0.776207), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:52:14,595 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 3, 'mean': np.float32(7.690922e-09), 'std': np.float32(1.0000001), 'min': np.float32(-0.3117721), 'max': np.float32(3.3477669)}
2025-06-02 15:52:14,595 - INFO - - service_1: {'name': 'service_1', 'unique': 4, 'mean': np.float32(1.2580645), 'std': np.float32(0.98268044), 'min': np.float32(0.0), 'max': np.float32(3.0)}
2025-06-02 15:52:14,595 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(7.225806), 'std': np.float32(2.0353281), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:52:14,595 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.580645), 'std': np.float32(1.6018978), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:52:14,595 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.14516129), 'std': np.float32(0.43428746), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:52:14,595 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 1, 'mean': np.float32(8.0), 'std': np.float32(0.0), 'min': np.float32(8.0), 'max': np.float32(8.0)}
2025-06-02 15:52:14,595 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 3, 'mean': np.float32(-5.7681913e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.3601238), 'max': np.float32(3.699454)}
2025-06-02 15:52:14,595 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(4.806826e-09), 'std': np.float32(1.0), 'min': np.float32(-0.38490018), 'max': np.float32(2.598076)}
2025-06-02 15:52:14,595 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:14,596 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:14,596 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:14,596 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:14,596 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(6.7295565e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.6187041), 'max': np.float32(4.672282)}
2025-06-02 15:52:14,596 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 3, 'mean': np.float32(5.864328e-08), 'std': np.float32(1.0), 'min': np.float32(-0.72994643), 'max': np.float32(2.890588)}
2025-06-02 15:52:14,618 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x72fda5761c40>
2025-06-02 15:52:14,841 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:52:14,956 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:52:15,007 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:52:16,492 - INFO - Node feature visualization saved to vis/node_features_20250602_155215.png
2025-06-02 15:52:16,492 - INFO - Finished visualization of node features.
2025-06-02 15:52:16,492 - INFO - Performing additional feature analysis:
2025-06-02 15:52:16,492 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:52:16,492 - INFO - Starting visualization of edge features.
2025-06-02 15:52:16,492 - INFO - Graph has 86 edges and 10 edge features.
2025-06-02 15:52:16,492 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:52:16,492 - INFO - Calculating edge feature statistics:
2025-06-02 15:52:16,492 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:52:16,493 - INFO - - count: {'name': 'count', 'unique': 9, 'mean': np.float32(4.505002e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.19846956), 'max': np.float32(6.581114)}
2025-06-02 15:52:16,493 - INFO - - dst_port: {'name': 'dst_port', 'unique': 8, 'mean': np.float32(341.47675), 'std': np.float32(178.28705), 'min': np.float32(25.0), 'max': np.float32(587.0)}
2025-06-02 15:52:16,493 - INFO - - protocol: {'name': 'protocol', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:16,493 - INFO - - service: {'name': 'service', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:16,493 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 67, 'mean': np.float32(8.316928e-09), 'std': np.float32(1.0), 'min': np.float32(-0.19461668), 'max': np.float32(9.082401)}
2025-06-02 15:52:16,493 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 76, 'mean': np.float32(-2.5990397e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.22627027), 'max': np.float32(9.036156)}
2025-06-02 15:52:16,493 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 48, 'mean': np.float32(9.010004e-09), 'std': np.float32(1.0), 'min': np.float32(-0.4426339), 'max': np.float32(5.668144)}
2025-06-02 15:52:16,493 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 64, 'mean': np.float32(-1.039616e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.19641176), 'max': np.float32(8.896037)}
2025-06-02 15:52:16,493 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 76, 'mean': np.float32(4.3317328e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.2043706), 'max': np.float32(8.886798)}
2025-06-02 15:52:16,493 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 51, 'mean': np.float32(-3.4653864e-09), 'std': np.float32(1.0), 'min': np.float32(-0.3688732), 'max': np.float32(7.6698503)}
2025-06-02 15:52:16,503 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x72fda4856360>
2025-06-02 15:52:16,560 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:52:16,570 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x72fda47acda0>
2025-06-02 15:52:16,632 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:52:16,718 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:52:16,859 - DEBUG - Plotted boxplots of the first 8 non-constant edge features.
2025-06-02 15:52:16,884 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:52:16,895 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:52:18,495 - INFO - Edge feature visualization saved to vis/edge_features_20250602_155217.png
2025-06-02 15:52:18,495 - INFO - Finished visualization of edge features.
2025-06-02 15:52:18,496 - INFO - Performing additional edge feature analysis:
2025-06-02 15:52:18,496 - INFO - - 2 out of 10 edge features are constant.
2025-06-02 15:52:18,496 - INFO - - Highest correlation (1.00) between features: 'total_resp_ip_bytes' and 'total_resp_bytes'.
2025-06-02 15:52:18,496 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:52:18,496 - INFO - Graph has 86 edges and 10 edge features.
2025-06-02 15:52:18,496 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:52:18,938 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_155218_summary.png
2025-06-02 15:52:19,122 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_155218_pca_3d.png
2025-06-02 15:52:19,305 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_155218_pca_variance.png
2025-06-02 15:52:19,305 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:52:19,306 - INFO - 
--- Processing file: nw_graph_encoded_1748869305.dot (Timestamp: 2025-06-02 15:01:45) ---
2025-06-02 15:52:19,306 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869305.dot
2025-06-02 15:52:19,306 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869305.dot'.
2025-06-02 15:52:19,306 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869305.dot
2025-06-02 15:52:19,307 - INFO - Parsed 70 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869305.dot'.
2025-06-02 15:52:19,308 - INFO - Parsed 95 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869305.dot'.
2025-06-02 15:52:19,308 - INFO - Processing node updates/additions.
2025-06-02 15:52:19,309 - INFO - Processing edge updates/additions.
2025-06-02 15:52:19,309 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:52:19,309 - INFO - Finished updating NetworkX graph.
2025-06-02 15:52:19,309 - DEBUG - Updated graph - Nodes: 70, Edges: 95
2025-06-02 15:52:19,309 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:52:19,309 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:52:19,310 - DEBUG - Initial node features tensor shape: torch.Size([70, 30])
2025-06-02 15:52:19,311 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:52:19,311 - DEBUG - Node features tensor shape after scaling: torch.Size([70, 30])
2025-06-02 15:52:19,311 - DEBUG - Edge index tensor shape: torch.Size([2, 95])
2025-06-02 15:52:19,311 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:52:19,312 - DEBUG - Initial edge attributes tensor shape: torch.Size([95, 10])
2025-06-02 15:52:19,312 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:52:19,312 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([95, 10])
2025-06-02 15:52:19,312 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:52:19,312 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:52:19,312 - INFO - Updated main graph to 70 nodes and 95 edges.
2025-06-02 15:52:19,312 - INFO - Performing online update...
2025-06-02 15:52:19,313 - INFO - Starting online update for 50 steps.
2025-06-02 15:52:19,313 - DEBUG - Updated RunningStats: new_mean=0.942846061600507, new_var=38400000000173.42, new_n=3870
2025-06-02 15:52:19,313 - DEBUG - Updated RunningStats: new_mean=0.9408637825946825, new_var=38700000000011.58, new_n=3900
2025-06-02 15:52:19,313 - DEBUG - Updated RunningStats: new_mean=43.30157018840195, new_var=12800000111617.104, new_n=1290
2025-06-02 15:52:19,313 - DEBUG - Updated RunningStats: new_mean=43.107072198807025, new_var=12900000033079.42, new_n=1300
2025-06-02 15:52:19,313 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:52:19,313 - DEBUG - Online update step: 1/50
2025-06-02 15:52:19,313 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,313 - DEBUG - Online update step: 2/50
2025-06-02 15:52:19,313 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,313 - DEBUG - Online update step: 3/50
2025-06-02 15:52:19,313 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,313 - DEBUG - Online update step: 4/50
2025-06-02 15:52:19,313 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,313 - DEBUG - Online update step: 5/50
2025-06-02 15:52:19,313 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,313 - DEBUG - Online update step: 6/50
2025-06-02 15:52:19,313 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,313 - DEBUG - Online update step: 7/50
2025-06-02 15:52:19,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,314 - DEBUG - Online update step: 8/50
2025-06-02 15:52:19,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,314 - DEBUG - Online update step: 9/50
2025-06-02 15:52:19,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,314 - DEBUG - Online update step: 10/50
2025-06-02 15:52:19,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,314 - DEBUG - Online update step: 11/50
2025-06-02 15:52:19,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,314 - DEBUG - Online update step: 12/50
2025-06-02 15:52:19,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,314 - DEBUG - Online update step: 13/50
2025-06-02 15:52:19,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,314 - DEBUG - Online update step: 14/50
2025-06-02 15:52:19,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,314 - DEBUG - Online update step: 15/50
2025-06-02 15:52:19,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,314 - DEBUG - Online update step: 16/50
2025-06-02 15:52:19,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,314 - DEBUG - Online update step: 17/50
2025-06-02 15:52:19,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,314 - DEBUG - Online update step: 18/50
2025-06-02 15:52:19,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,314 - DEBUG - Online update step: 19/50
2025-06-02 15:52:19,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,314 - DEBUG - Online update step: 20/50
2025-06-02 15:52:19,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,314 - DEBUG - Online update step: 21/50
2025-06-02 15:52:19,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,314 - DEBUG - Online update step: 22/50
2025-06-02 15:52:19,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,314 - DEBUG - Online update step: 23/50
2025-06-02 15:52:19,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,314 - DEBUG - Online update step: 24/50
2025-06-02 15:52:19,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,314 - DEBUG - Online update step: 25/50
2025-06-02 15:52:19,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,314 - DEBUG - Online update step: 26/50
2025-06-02 15:52:19,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,314 - DEBUG - Online update step: 27/50
2025-06-02 15:52:19,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,314 - DEBUG - Online update step: 28/50
2025-06-02 15:52:19,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,314 - DEBUG - Online update step: 29/50
2025-06-02 15:52:19,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,314 - DEBUG - Online update step: 30/50
2025-06-02 15:52:19,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,314 - DEBUG - Online update step: 31/50
2025-06-02 15:52:19,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,314 - DEBUG - Online update step: 32/50
2025-06-02 15:52:19,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,315 - DEBUG - Online update step: 33/50
2025-06-02 15:52:19,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,315 - DEBUG - Online update step: 34/50
2025-06-02 15:52:19,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,315 - DEBUG - Online update step: 35/50
2025-06-02 15:52:19,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,315 - DEBUG - Online update step: 36/50
2025-06-02 15:52:19,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,315 - DEBUG - Online update step: 37/50
2025-06-02 15:52:19,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,315 - DEBUG - Online update step: 38/50
2025-06-02 15:52:19,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,315 - DEBUG - Online update step: 39/50
2025-06-02 15:52:19,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,315 - DEBUG - Online update step: 40/50
2025-06-02 15:52:19,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,315 - DEBUG - Online update step: 41/50
2025-06-02 15:52:19,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,315 - DEBUG - Online update step: 42/50
2025-06-02 15:52:19,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,315 - DEBUG - Online update step: 43/50
2025-06-02 15:52:19,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,315 - DEBUG - Online update step: 44/50
2025-06-02 15:52:19,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,315 - DEBUG - Online update step: 45/50
2025-06-02 15:52:19,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,315 - DEBUG - Online update step: 46/50
2025-06-02 15:52:19,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,315 - DEBUG - Online update step: 47/50
2025-06-02 15:52:19,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,315 - DEBUG - Online update step: 48/50
2025-06-02 15:52:19,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,315 - DEBUG - Online update step: 49/50
2025-06-02 15:52:19,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,315 - DEBUG - Online update step: 50/50
2025-06-02 15:52:19,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,315 - WARNING - No successful steps during online update.
2025-06-02 15:52:19,316 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -4.0871758e-08 -6.8119597e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.3623919e-08
 -6.4713618e-08  5.4495676e-08  3.2356809e-08 -1.7029899e-08
  2.8714285e+00  2.7714286e+00  1.4285715e-01  4.4428573e+00
 -5.4495676e-08  1.3142858e+00  7.2285714e+00  7.6285715e+00
  1.4285715e-01  8.0000000e+00 -4.4277737e-08  3.4059799e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.4713618e-08 -5.4495676e-08], current edge mean: [ 2.5096694e-09  3.5109473e+02  0.0000000e+00  0.0000000e+00
  1.1293512e-08  1.2548347e-09  0.0000000e+00  8.7838421e-09
 -2.5096694e-09  2.5096694e-09]
2025-06-02 15:52:19,316 - DEBUG - Node drift difference: 0.0664, Edge drift difference: 0.0536
2025-06-02 15:52:19,316 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -4.0871758e-08 -6.8119597e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.3623919e-08
 -6.4713618e-08  5.4495676e-08  3.2356809e-08 -1.7029899e-08
  2.8714285e+00  2.7714286e+00  1.4285715e-01  4.4428573e+00
 -5.4495676e-08  1.3142858e+00  7.2285714e+00  7.6285715e+00
  1.4285715e-01  8.0000000e+00 -4.4277737e-08  3.4059799e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.4713618e-08 -5.4495676e-08], edge=[ 2.5096694e-09  3.5109473e+02  0.0000000e+00  0.0000000e+00
  1.1293512e-08  1.2548347e-09  0.0000000e+00  8.7838421e-09
 -2.5096694e-09  2.5096694e-09]
2025-06-02 15:52:19,316 - DEBUG - Updated reference std: node=[0.        0.        1.0072203 1.0072203 0.        0.        0.
 1.0072203 1.0072203 1.0072203 1.0072203 1.0072203 1.6233927 0.6409103
 0.4268426 0.8100047 1.0072203 0.9712215 2.0442314 1.5244046 0.4268426
 0.        1.0072203 1.0072203 0.        0.        0.        0.
 1.0072203 1.0072203], edge=[  1.0053052 173.13118     0.          0.          1.005305    1.005305
   1.005305    1.0053052   1.005305    1.005305 ]
2025-06-02 15:52:19,316 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:52:19,316 - INFO - Running anomaly detection...
2025-06-02 15:52:19,317 - INFO - Starting anomaly detection.
2025-06-02 15:52:19,319 - DEBUG - Node reconstruction errors: [12.740317   8.936473  11.742763  13.562356  13.562356  13.124192
  9.144055  12.412553  12.412554  12.686904  12.412553  10.4124975
 12.654887   9.894353  13.548765  12.951967  13.928918  12.952676
 12.576349  12.818573  12.323371  13.548761  12.469556  10.001044
 13.397261  12.42492   13.397261   8.794042  12.323373  13.397261
  9.833964  12.469558  12.961872  14.026265  12.885809  13.662333
 12.675933  12.818574  13.165799  12.328018  14.21417   13.662336
 12.818574  13.877713  13.455604  12.999012  14.767283  15.959987
 12.442448  13.580861  14.177102  13.066962  12.50211   13.272625
 12.2600975 13.934037   8.9032    13.391206  12.49585   12.9934
  9.190933  14.597257  14.033082  13.391205  13.6566105 12.2600975
 13.934038  12.2600975 14.033086  14.033082 ]
2025-06-02 15:52:19,319 - DEBUG - Edge reconstruction errors: [ 5.252633   7.826014  44.240986   2.2499235  5.179053  44.131126
 44.163597  44.13244    7.821515  44.131046  44.135094  44.145836
  7.897804   2.2399814 58.555504  58.555504  46.35003    7.871099
 44.313717  44.188553  44.146706   7.820951  44.12887   44.1222
 44.27485   44.135445  44.134422  44.129696  44.241295  44.12915
  6.157669   6.464166  44.12647    7.817851  44.118988   7.864601
 58.525482   2.187797  46.334446   7.8250265 44.236446  44.119827
 44.182083  44.497047  44.209923  44.15382   44.16924   44.144127
 44.136696  46.53057   44.28721   44.25521   44.149303  44.405758
 44.405758  44.12647   44.247505  44.138695  44.173855   8.543505
  9.179613  44.140423  44.139427  44.411606  44.12309   44.133274
 10.532406  13.618177   7.8305206 44.118263  44.11897   44.118988
 44.11961   44.157482  44.266785  44.138313  44.148582  44.183613
 44.224792  44.120117  44.14089    7.8222604 44.119015  44.16626
 44.163506  44.156456  44.54973   44.160946  13.222659   1.9942093
 58.521606   1.985425  46.326958  44.12886    7.8164053]
2025-06-02 15:52:19,320 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155219_update_7.json
2025-06-02 15:52:19,320 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:52:19,322 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155219_update_7.pth and as latest_checkpoint.pth
2025-06-02 15:52:19,322 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869305.dot): 0.2658
2025-06-02 15:52:19,322 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-02 15:52:19,322 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-02 15:52:19,322 - INFO - 
--- Processing file: nw_graph_encoded_1748869335.dot (Timestamp: 2025-06-02 15:02:15) ---
2025-06-02 15:52:19,322 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869335.dot
2025-06-02 15:52:19,322 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869335.dot'.
2025-06-02 15:52:19,322 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869335.dot
2025-06-02 15:52:19,324 - INFO - Parsed 77 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869335.dot'.
2025-06-02 15:52:19,325 - INFO - Parsed 106 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869335.dot'.
2025-06-02 15:52:19,325 - INFO - Processing node updates/additions.
2025-06-02 15:52:19,326 - INFO - Processing edge updates/additions.
2025-06-02 15:52:19,326 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:52:19,326 - INFO - Finished updating NetworkX graph.
2025-06-02 15:52:19,327 - DEBUG - Updated graph - Nodes: 77, Edges: 106
2025-06-02 15:52:19,327 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:52:19,327 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:52:19,328 - DEBUG - Initial node features tensor shape: torch.Size([77, 30])
2025-06-02 15:52:19,328 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:52:19,329 - DEBUG - Node features tensor shape after scaling: torch.Size([77, 30])
2025-06-02 15:52:19,329 - DEBUG - Edge index tensor shape: torch.Size([2, 106])
2025-06-02 15:52:19,329 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:52:19,329 - DEBUG - Initial edge attributes tensor shape: torch.Size([106, 10])
2025-06-02 15:52:19,330 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:52:19,330 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([106, 10])
2025-06-02 15:52:19,330 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:52:19,330 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:52:19,330 - INFO - Updated main graph to 77 nodes and 106 edges.
2025-06-02 15:52:19,330 - INFO - Performing online update...
2025-06-02 15:52:19,331 - INFO - Starting online update for 50 steps.
2025-06-02 15:52:19,331 - DEBUG - Updated RunningStats: new_mean=0.9425048541210918, new_var=39000000000172.94, new_n=3930
2025-06-02 15:52:19,331 - DEBUG - Updated RunningStats: new_mean=0.940636943585456, new_var=39300000000011.93, new_n=3960
2025-06-02 15:52:19,331 - DEBUG - Updated RunningStats: new_mean=43.05049364753777, new_var=13000000115218.936, new_n=1310
2025-06-02 15:52:19,331 - DEBUG - Updated RunningStats: new_mean=42.85746373331427, new_var=13100000031813.229, new_n=1320
2025-06-02 15:52:19,331 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:52:19,331 - DEBUG - Online update step: 1/50
2025-06-02 15:52:19,331 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,331 - DEBUG - Online update step: 2/50
2025-06-02 15:52:19,331 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,331 - DEBUG - Online update step: 3/50
2025-06-02 15:52:19,331 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,331 - DEBUG - Online update step: 4/50
2025-06-02 15:52:19,331 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,331 - DEBUG - Online update step: 5/50
2025-06-02 15:52:19,331 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,332 - DEBUG - Online update step: 6/50
2025-06-02 15:52:19,332 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,332 - DEBUG - Online update step: 7/50
2025-06-02 15:52:19,332 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,332 - DEBUG - Online update step: 8/50
2025-06-02 15:52:19,332 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,332 - DEBUG - Online update step: 9/50
2025-06-02 15:52:19,332 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,332 - DEBUG - Online update step: 10/50
2025-06-02 15:52:19,332 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,332 - DEBUG - Online update step: 11/50
2025-06-02 15:52:19,332 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,332 - DEBUG - Online update step: 12/50
2025-06-02 15:52:19,332 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,332 - DEBUG - Online update step: 13/50
2025-06-02 15:52:19,332 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,332 - DEBUG - Online update step: 14/50
2025-06-02 15:52:19,332 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,332 - DEBUG - Online update step: 15/50
2025-06-02 15:52:19,332 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,332 - DEBUG - Online update step: 16/50
2025-06-02 15:52:19,332 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,332 - DEBUG - Online update step: 17/50
2025-06-02 15:52:19,332 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,332 - DEBUG - Online update step: 18/50
2025-06-02 15:52:19,332 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,332 - DEBUG - Online update step: 19/50
2025-06-02 15:52:19,332 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,332 - DEBUG - Online update step: 20/50
2025-06-02 15:52:19,332 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,332 - DEBUG - Online update step: 21/50
2025-06-02 15:52:19,332 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,332 - DEBUG - Online update step: 22/50
2025-06-02 15:52:19,332 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,332 - DEBUG - Online update step: 23/50
2025-06-02 15:52:19,332 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,332 - DEBUG - Online update step: 24/50
2025-06-02 15:52:19,332 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,332 - DEBUG - Online update step: 25/50
2025-06-02 15:52:19,332 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,332 - DEBUG - Online update step: 26/50
2025-06-02 15:52:19,333 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,333 - DEBUG - Online update step: 27/50
2025-06-02 15:52:19,333 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,333 - DEBUG - Online update step: 28/50
2025-06-02 15:52:19,333 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,333 - DEBUG - Online update step: 29/50
2025-06-02 15:52:19,333 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,333 - DEBUG - Online update step: 30/50
2025-06-02 15:52:19,333 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,333 - DEBUG - Online update step: 31/50
2025-06-02 15:52:19,333 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,333 - DEBUG - Online update step: 32/50
2025-06-02 15:52:19,333 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,333 - DEBUG - Online update step: 33/50
2025-06-02 15:52:19,333 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,333 - DEBUG - Online update step: 34/50
2025-06-02 15:52:19,333 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,333 - DEBUG - Online update step: 35/50
2025-06-02 15:52:19,333 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,333 - DEBUG - Online update step: 36/50
2025-06-02 15:52:19,333 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,333 - DEBUG - Online update step: 37/50
2025-06-02 15:52:19,333 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,333 - DEBUG - Online update step: 38/50
2025-06-02 15:52:19,333 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,333 - DEBUG - Online update step: 39/50
2025-06-02 15:52:19,333 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,333 - DEBUG - Online update step: 40/50
2025-06-02 15:52:19,333 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,333 - DEBUG - Online update step: 41/50
2025-06-02 15:52:19,333 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,333 - DEBUG - Online update step: 42/50
2025-06-02 15:52:19,333 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,333 - DEBUG - Online update step: 43/50
2025-06-02 15:52:19,333 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,333 - DEBUG - Online update step: 44/50
2025-06-02 15:52:19,333 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,333 - DEBUG - Online update step: 45/50
2025-06-02 15:52:19,333 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,333 - DEBUG - Online update step: 46/50
2025-06-02 15:52:19,333 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,333 - DEBUG - Online update step: 47/50
2025-06-02 15:52:19,334 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,334 - DEBUG - Online update step: 48/50
2025-06-02 15:52:19,334 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,334 - DEBUG - Online update step: 49/50
2025-06-02 15:52:19,334 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,334 - DEBUG - Online update step: 50/50
2025-06-02 15:52:19,334 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,334 - WARNING - No successful steps during online update.
2025-06-02 15:52:19,334 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00 -4.02524876e-08 -9.28903532e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00 -4.33488339e-08
 -2.01262438e-08  2.47707614e-08  1.08372085e-08  1.54817259e-09
  2.87012982e+00  2.79220772e+00  1.29870132e-01  4.41558456e+00
 -2.47707614e-08  1.53246748e+00  7.14285707e+00  7.66233778e+00
  1.29870132e-01  8.00000000e+00  1.23853807e-08 -2.78671060e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  6.19269036e-09 -2.16744169e-08], current edge mean: [-7.87231169e-09  3.56952820e+02  0.00000000e+00  0.00000000e+00
 -2.24923191e-09  4.49846382e-09 -1.34953915e-08 -8.99692765e-09
  1.57446234e-08  1.34953915e-08]
2025-06-02 15:52:19,334 - DEBUG - Node drift difference: 0.2246, Edge drift difference: 0.0338
2025-06-02 15:52:19,334 - WARNING - Feature drift detected (1 consecutive)
2025-06-02 15:52:19,335 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00 -4.02524876e-08 -9.28903532e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00 -4.33488339e-08
 -2.01262438e-08  2.47707614e-08  1.08372085e-08  1.54817259e-09
  2.87012982e+00  2.79220772e+00  1.29870132e-01  4.41558456e+00
 -2.47707614e-08  1.53246748e+00  7.14285707e+00  7.66233778e+00
  1.29870132e-01  8.00000000e+00  1.23853807e-08 -2.78671060e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  6.19269036e-09 -2.16744169e-08], edge=[-7.87231169e-09  3.56952820e+02  0.00000000e+00  0.00000000e+00
 -2.24923191e-09  4.49846382e-09 -1.34953915e-08 -8.99692765e-09
  1.57446234e-08  1.34953915e-08]
2025-06-02 15:52:19,335 - DEBUG - Updated reference std: node=[0.        0.        1.0065575 1.0065575 0.        0.        0.
 1.0065575 1.0065575 1.0065575 1.0065575 1.0065575 1.5757258 0.6142531
 0.408806  0.7838946 1.0065575 1.4196405 2.131927  1.4564773 0.408806
 0.        1.0065575 1.0065575 0.        0.        0.        0.
 1.0065575 1.0065575], edge=[  1.0047506 168.6722      0.          0.          1.0047506   1.0047506
   1.0047506   1.0047506   1.0047506   1.0047506]
2025-06-02 15:52:19,335 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:52:19,335 - INFO - Running anomaly detection...
2025-06-02 15:52:19,335 - INFO - Starting anomaly detection.
2025-06-02 15:52:19,338 - DEBUG - Node reconstruction errors: [12.810775   9.202235  11.938251  13.557845  13.557842  13.108405
  9.479263  12.298896  12.298896  12.591138  12.298896  10.3126545
 12.721635   9.589529  13.470717  12.887208  13.938168  12.887205
 12.548339  12.786473  12.188513  13.470719  12.389226   9.844097
 13.351259  12.408341  13.351259   8.357831  12.188513  13.351259
  9.862599  12.389226  12.886985  14.069738  12.890442  13.553443
 12.657786  12.786474  13.109368  12.276565  14.172684  13.553442
 12.786471  13.8509    13.44151   12.820151  14.793139  16.004951
 12.2680855 13.517119  14.128262  12.932569  12.445828  13.1957445
 12.074382  14.142237   8.975919  13.201219  12.347698  12.86553
  9.305109  14.45644   13.836971  13.201223  13.475011  12.074382
 13.774463  12.074382  13.836972  13.836972  12.563616  14.362817
 12.705594  12.611402  14.719452  12.680634  14.345051 ]
2025-06-02 15:52:19,338 - DEBUG - Edge reconstruction errors: [ 5.223785   7.8495846 44.217358   2.2634273  5.1692457 44.154026
 44.17408   44.154858   7.847318  44.153954  44.15658   44.163383
  9.502773   2.2595437 58.608856  58.608856  46.36457    7.873526
 44.318737  44.18908   44.163795   7.8468437 44.15203   44.147713
 44.393833  44.157402  44.165497  44.165497  44.15676   44.152542
 44.22396   44.15223   44.15855   44.186565  44.186302   5.2615914
 44.207626  44.151985   5.664569   5.8195825 44.149742   7.845031
 44.14624    7.8706512 58.5494     2.2277982 46.35513    7.849059
 44.26014   44.146538  44.19242   44.551704  44.201912  44.17057
 44.178368  44.164215  44.15834   46.144287  44.267033  44.237404
 44.16599   44.473747  44.473747  44.149742  44.232826  44.159046
 44.181725   8.301481  10.158121  44.161446  44.16009   44.369503
 44.14813   44.154964   9.541816  13.645934   7.8532    44.145893
 44.146225  44.14624   44.146446  44.171608  44.243538  44.15866
 44.16645   44.190453  44.22785   44.146782  44.160255   7.847937
 44.14626   44.18287   44.173603  44.174034  44.408314  44.171555
 44.162457  44.162457  44.15456   13.247968   1.9843907 58.547558
  1.9799707 46.351128  44.152428   7.842708 ]
2025-06-02 15:52:19,339 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155219_update_8.json
2025-06-02 15:52:19,339 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:52:19,342 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155219_update_8.pth and as latest_checkpoint.pth
2025-06-02 15:52:19,342 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869335.dot): 0.2603
2025-06-02 15:52:19,342 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-02 15:52:19,342 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-02 15:52:19,342 - INFO - 
--- Processing file: nw_graph_encoded_1748869365.dot (Timestamp: 2025-06-02 15:02:45) ---
2025-06-02 15:52:19,342 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869365.dot
2025-06-02 15:52:19,342 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869365.dot'.
2025-06-02 15:52:19,342 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869365.dot
2025-06-02 15:52:19,344 - INFO - Parsed 89 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869365.dot'.
2025-06-02 15:52:19,346 - INFO - Parsed 133 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869365.dot'.
2025-06-02 15:52:19,346 - INFO - Processing node updates/additions.
2025-06-02 15:52:19,347 - INFO - Processing edge updates/additions.
2025-06-02 15:52:19,348 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:52:19,348 - INFO - Finished updating NetworkX graph.
2025-06-02 15:52:19,348 - DEBUG - Updated graph - Nodes: 89, Edges: 133
2025-06-02 15:52:19,348 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:52:19,348 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:52:19,349 - DEBUG - Initial node features tensor shape: torch.Size([89, 30])
2025-06-02 15:52:19,350 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:52:19,350 - DEBUG - Node features tensor shape after scaling: torch.Size([89, 30])
2025-06-02 15:52:19,351 - DEBUG - Edge index tensor shape: torch.Size([2, 133])
2025-06-02 15:52:19,351 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:52:19,351 - DEBUG - Initial edge attributes tensor shape: torch.Size([133, 10])
2025-06-02 15:52:19,352 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:52:19,352 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([133, 10])
2025-06-02 15:52:19,352 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:52:19,352 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:52:19,353 - INFO - Updated main graph to 89 nodes and 133 edges.
2025-06-02 15:52:19,353 - INFO - Performing online update...
2025-06-02 15:52:19,353 - INFO - Starting online update for 50 steps.
2025-06-02 15:52:19,353 - DEBUG - Updated RunningStats: new_mean=0.9422660143893729, new_var=39600000000166.984, new_n=3990
2025-06-02 15:52:19,353 - DEBUG - Updated RunningStats: new_mean=0.9407371282718338, new_var=39900000000014.266, new_n=4020
2025-06-02 15:52:19,353 - DEBUG - Updated RunningStats: new_mean=42.81248987020239, new_var=13200000122740.24, new_n=1330
2025-06-02 15:52:19,353 - DEBUG - Updated RunningStats: new_mean=42.61664209493784, new_var=13300000029271.404, new_n=1340
2025-06-02 15:52:19,354 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:52:19,354 - DEBUG - Online update step: 1/50
2025-06-02 15:52:19,354 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,354 - DEBUG - Online update step: 2/50
2025-06-02 15:52:19,354 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,354 - DEBUG - Online update step: 3/50
2025-06-02 15:52:19,354 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,354 - DEBUG - Online update step: 4/50
2025-06-02 15:52:19,354 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,354 - DEBUG - Online update step: 5/50
2025-06-02 15:52:19,354 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,354 - DEBUG - Online update step: 6/50
2025-06-02 15:52:19,354 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,354 - DEBUG - Online update step: 7/50
2025-06-02 15:52:19,354 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,354 - DEBUG - Online update step: 8/50
2025-06-02 15:52:19,354 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,354 - DEBUG - Online update step: 9/50
2025-06-02 15:52:19,354 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,354 - DEBUG - Online update step: 10/50
2025-06-02 15:52:19,354 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,354 - DEBUG - Online update step: 11/50
2025-06-02 15:52:19,354 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,354 - DEBUG - Online update step: 12/50
2025-06-02 15:52:19,354 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,354 - DEBUG - Online update step: 13/50
2025-06-02 15:52:19,354 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,354 - DEBUG - Online update step: 14/50
2025-06-02 15:52:19,354 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,354 - DEBUG - Online update step: 15/50
2025-06-02 15:52:19,354 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,354 - DEBUG - Online update step: 16/50
2025-06-02 15:52:19,354 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,354 - DEBUG - Online update step: 17/50
2025-06-02 15:52:19,354 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,355 - DEBUG - Online update step: 18/50
2025-06-02 15:52:19,355 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,355 - DEBUG - Online update step: 19/50
2025-06-02 15:52:19,355 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,355 - DEBUG - Online update step: 20/50
2025-06-02 15:52:19,355 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,355 - DEBUG - Online update step: 21/50
2025-06-02 15:52:19,355 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,355 - DEBUG - Online update step: 22/50
2025-06-02 15:52:19,355 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,355 - DEBUG - Online update step: 23/50
2025-06-02 15:52:19,355 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,355 - DEBUG - Online update step: 24/50
2025-06-02 15:52:19,355 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,355 - DEBUG - Online update step: 25/50
2025-06-02 15:52:19,355 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,355 - DEBUG - Online update step: 26/50
2025-06-02 15:52:19,355 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,355 - DEBUG - Online update step: 27/50
2025-06-02 15:52:19,355 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,355 - DEBUG - Online update step: 28/50
2025-06-02 15:52:19,355 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,355 - DEBUG - Online update step: 29/50
2025-06-02 15:52:19,355 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,355 - DEBUG - Online update step: 30/50
2025-06-02 15:52:19,355 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,355 - DEBUG - Online update step: 31/50
2025-06-02 15:52:19,355 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,355 - DEBUG - Online update step: 32/50
2025-06-02 15:52:19,355 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,355 - DEBUG - Online update step: 33/50
2025-06-02 15:52:19,355 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,355 - DEBUG - Online update step: 34/50
2025-06-02 15:52:19,355 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,355 - DEBUG - Online update step: 35/50
2025-06-02 15:52:19,355 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,355 - DEBUG - Online update step: 36/50
2025-06-02 15:52:19,356 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,356 - DEBUG - Online update step: 37/50
2025-06-02 15:52:19,356 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,356 - DEBUG - Online update step: 38/50
2025-06-02 15:52:19,356 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,356 - DEBUG - Online update step: 39/50
2025-06-02 15:52:19,356 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,356 - DEBUG - Online update step: 40/50
2025-06-02 15:52:19,356 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,356 - DEBUG - Online update step: 41/50
2025-06-02 15:52:19,356 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,356 - DEBUG - Online update step: 42/50
2025-06-02 15:52:19,356 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,356 - DEBUG - Online update step: 43/50
2025-06-02 15:52:19,356 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,356 - DEBUG - Online update step: 44/50
2025-06-02 15:52:19,356 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,356 - DEBUG - Online update step: 45/50
2025-06-02 15:52:19,356 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,356 - DEBUG - Online update step: 46/50
2025-06-02 15:52:19,356 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,356 - DEBUG - Online update step: 47/50
2025-06-02 15:52:19,356 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,356 - DEBUG - Online update step: 48/50
2025-06-02 15:52:19,356 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,356 - DEBUG - Online update step: 49/50
2025-06-02 15:52:19,356 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,356 - DEBUG - Online update step: 50/50
2025-06-02 15:52:19,356 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,356 - WARNING - No successful steps during online update.
2025-06-02 15:52:19,357 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -7.9026385e-08  4.6880057e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.2770314e-08
 -2.1430884e-08  3.2146325e-08  3.0806895e-08  6.8310939e-08
  2.7977529e+00  2.8202248e+00  2.1348314e-01  4.4044943e+00
 -3.2146325e-08  1.9662921e+00  6.7415729e+00  7.5617976e+00
  2.1348314e-01  8.0000000e+00 -3.7504048e-08 -5.3577209e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.6788605e-08  5.3577209e-09], current edge mean: [-1.43409675e-08  3.68759399e+02  0.00000000e+00  0.00000000e+00
 -8.96310404e-09  0.00000000e+00  0.00000000e+00 -3.58524188e-09
  0.00000000e+00  7.17048376e-09]
2025-06-02 15:52:19,357 - DEBUG - Node drift difference: 0.3056, Edge drift difference: 0.0700
2025-06-02 15:52:19,357 - WARNING - Feature drift detected (2 consecutive)
2025-06-02 15:52:19,358 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -7.9026385e-08  4.6880057e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.2770314e-08
 -2.1430884e-08  3.2146325e-08  3.0806895e-08  6.8310939e-08
  2.7977529e+00  2.8202248e+00  2.1348314e-01  4.4044943e+00
 -3.2146325e-08  1.9662921e+00  6.7415729e+00  7.5617976e+00
  2.1348314e-01  8.0000000e+00 -3.7504048e-08 -5.3577209e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.6788605e-08  5.3577209e-09], edge=[-1.43409675e-08  3.68759399e+02  0.00000000e+00  0.00000000e+00
 -8.96310404e-09  0.00000000e+00  0.00000000e+00 -3.58524188e-09
  0.00000000e+00  7.17048376e-09]
2025-06-02 15:52:19,358 - DEBUG - Updated reference std: node=[0.         0.         1.0056658  1.0056658  0.         0.
 0.         1.0056658  1.0056658  1.0056657  1.0056658  1.0056658
 1.5013614  0.5752825  0.46397272 0.7342142  1.0056657  2.2281742
 2.4426517  1.6442397  0.46397272 0.         1.0056658  1.0056658
 0.         0.         0.         0.         1.0056658  1.0056658 ], edge=[  1.0037808 158.66241     0.          0.          1.0037807   1.0037807
   1.0037808   1.0037807   1.0037807   1.0037807]
2025-06-02 15:52:19,358 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:52:19,358 - INFO - Running anomaly detection...
2025-06-02 15:52:19,358 - INFO - Starting anomaly detection.
2025-06-02 15:52:19,361 - DEBUG - Node reconstruction errors: [12.834238   9.497543   9.450389  13.780613  14.075192  13.326386
 10.909734  12.36905   12.36905   12.672796  12.36905   10.372229
 13.094527   9.49364   13.5640955 12.999998  14.083765  13.000756
 12.755228  12.868626  12.221605  13.5640955 12.45616    9.813455
 13.415538  12.559647  13.415536   8.50586   12.221605  13.415539
  9.795896  12.45616   12.903173  13.35111   12.242038  13.568349
 12.062534  12.868623  13.196665  12.300696  14.202053  13.56835
 12.868623  13.963245  13.550411  12.79611   14.923171  16.106789
 12.240021  13.442328  14.22504   12.940125  12.514017  13.2039585
 12.014092   8.1763315  9.337034  13.083075  12.327576  12.182393
  9.396519  14.355261  13.743308  10.309677  13.460307  12.014091
 12.613514  12.014092  13.743311  13.74331   12.346978  14.153035
 12.657684  12.561478  15.029932  12.561873  14.087219  14.240308
 14.240304  14.240304  13.92041   14.240307  13.061582  13.369882
 13.566464  13.36325   14.854514  14.240306  14.240304 ]
2025-06-02 15:52:19,361 - DEBUG - Edge reconstruction errors: [ 5.2507     7.8543687 44.21972    2.2564836  6.0680294 44.15948
 44.179626  44.160355   7.851892  44.1515    44.18524   44.16207
 44.234745  44.15292   44.162754   5.403134   7.854479  44.19087
 44.159412  44.162205  44.191124  44.191124  44.169334  10.347753
  2.263961  58.669624  58.669624  46.369072   7.8771143 44.383553
 44.195023  44.169724   7.8520517 44.15727   44.15292   44.393513
 44.16276   44.17122   44.17122   44.162086  44.15781   44.232246
 44.157486  44.163963  44.19201   44.191338   5.25445   44.213192
 44.17036   44.164528  44.164528  44.16774   44.16774   44.175987
 44.175987  44.17548   44.17548   44.168533  44.168533  44.161415
 44.161415  44.226547  44.226547   5.722796   6.1071157 44.15473
  7.850292  44.151627   7.8740797 58.554474   2.214476  46.360085
  7.854304  44.260536  44.151867  44.19858   44.56325   44.206078
 44.176064  44.184563  44.169563  44.163677  46.17704   44.27213
 44.242004  44.17109   44.48056   44.48056   44.15473   44.237373
 44.164417  44.186665   8.319636  10.251466  44.166817  44.165493
 44.379787  44.153297  44.160313   9.618044  13.651369   7.8584867
 44.151314  44.15161   44.151627  44.151787  44.1773    44.248558
 44.164356  44.17198   44.19552   44.233738  44.152107  44.166042
  7.853105  44.15165   44.18861   44.178215  44.179287  44.165184
 44.411232  44.176723  44.168053  44.168053  44.159832  44.158154
 13.253134   2.0321894 58.55282    2.0264773 46.35637   44.157692
  7.8478656]
2025-06-02 15:52:19,362 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155219_update_9.json
2025-06-02 15:52:19,362 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:52:19,365 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155219_update_9.pth and as latest_checkpoint.pth
2025-06-02 15:52:19,365 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869365.dot): 0.2616
2025-06-02 15:52:19,365 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-02 15:52:19,365 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-02 15:52:19,365 - INFO - 
--- Processing file: nw_graph_encoded_1748869395.dot (Timestamp: 2025-06-02 15:03:15) ---
2025-06-02 15:52:19,365 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869395.dot
2025-06-02 15:52:19,365 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869395.dot'.
2025-06-02 15:52:19,366 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869395.dot
2025-06-02 15:52:19,369 - INFO - Parsed 129 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869395.dot'.
2025-06-02 15:52:19,373 - INFO - Parsed 186 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869395.dot'.
2025-06-02 15:52:19,373 - INFO - Processing node updates/additions.
2025-06-02 15:52:19,374 - INFO - Processing edge updates/additions.
2025-06-02 15:52:19,375 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:52:19,375 - INFO - Finished updating NetworkX graph.
2025-06-02 15:52:19,376 - DEBUG - Updated graph - Nodes: 129, Edges: 186
2025-06-02 15:52:19,376 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:52:19,376 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:52:19,377 - DEBUG - Initial node features tensor shape: torch.Size([129, 30])
2025-06-02 15:52:19,378 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:52:19,379 - DEBUG - Node features tensor shape after scaling: torch.Size([129, 30])
2025-06-02 15:52:19,379 - DEBUG - Edge index tensor shape: torch.Size([2, 186])
2025-06-02 15:52:19,379 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:52:19,380 - DEBUG - Initial edge attributes tensor shape: torch.Size([186, 10])
2025-06-02 15:52:19,381 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:52:19,381 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([186, 10])
2025-06-02 15:52:19,381 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:52:19,381 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:52:19,381 - INFO - Updated main graph to 129 nodes and 186 edges.
2025-06-02 15:52:19,381 - INFO - Performing online update...
2025-06-02 15:52:19,381 - INFO - Starting online update for 50 steps.
2025-06-02 15:52:19,382 - DEBUG - Updated RunningStats: new_mean=0.9423704851582401, new_var=40200000000168.164, new_n=4050
2025-06-02 15:52:19,382 - DEBUG - Updated RunningStats: new_mean=0.9407714055547904, new_var=40500000000014.45, new_n=4080
2025-06-02 15:52:19,382 - DEBUG - Updated RunningStats: new_mean=42.62745071395035, new_var=13400000174862.033, new_n=1350
2025-06-02 15:52:19,382 - DEBUG - Updated RunningStats: new_mean=42.71051377322542, new_var=13500000255455.365, new_n=1360
2025-06-02 15:52:19,382 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:52:19,382 - DEBUG - Online update step: 1/50
2025-06-02 15:52:19,382 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,382 - DEBUG - Online update step: 2/50
2025-06-02 15:52:19,382 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,382 - DEBUG - Online update step: 3/50
2025-06-02 15:52:19,382 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,382 - DEBUG - Online update step: 4/50
2025-06-02 15:52:19,382 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,382 - DEBUG - Online update step: 5/50
2025-06-02 15:52:19,383 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,383 - DEBUG - Online update step: 6/50
2025-06-02 15:52:19,383 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,383 - DEBUG - Online update step: 7/50
2025-06-02 15:52:19,383 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,383 - DEBUG - Online update step: 8/50
2025-06-02 15:52:19,383 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,383 - DEBUG - Online update step: 9/50
2025-06-02 15:52:19,383 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,383 - DEBUG - Online update step: 10/50
2025-06-02 15:52:19,383 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,383 - DEBUG - Online update step: 11/50
2025-06-02 15:52:19,383 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,383 - DEBUG - Online update step: 12/50
2025-06-02 15:52:19,383 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,383 - DEBUG - Online update step: 13/50
2025-06-02 15:52:19,383 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,383 - DEBUG - Online update step: 14/50
2025-06-02 15:52:19,383 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,383 - DEBUG - Online update step: 15/50
2025-06-02 15:52:19,383 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,383 - DEBUG - Online update step: 16/50
2025-06-02 15:52:19,383 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,383 - DEBUG - Online update step: 17/50
2025-06-02 15:52:19,383 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,383 - DEBUG - Online update step: 18/50
2025-06-02 15:52:19,383 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,383 - DEBUG - Online update step: 19/50
2025-06-02 15:52:19,383 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,383 - DEBUG - Online update step: 20/50
2025-06-02 15:52:19,383 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,383 - DEBUG - Online update step: 21/50
2025-06-02 15:52:19,383 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,383 - DEBUG - Online update step: 22/50
2025-06-02 15:52:19,384 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,384 - DEBUG - Online update step: 23/50
2025-06-02 15:52:19,384 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,384 - DEBUG - Online update step: 24/50
2025-06-02 15:52:19,384 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,384 - DEBUG - Online update step: 25/50
2025-06-02 15:52:19,384 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,384 - DEBUG - Online update step: 26/50
2025-06-02 15:52:19,384 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,384 - DEBUG - Online update step: 27/50
2025-06-02 15:52:19,384 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,384 - DEBUG - Online update step: 28/50
2025-06-02 15:52:19,384 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,384 - DEBUG - Online update step: 29/50
2025-06-02 15:52:19,384 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,384 - DEBUG - Online update step: 30/50
2025-06-02 15:52:19,384 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,384 - DEBUG - Online update step: 31/50
2025-06-02 15:52:19,384 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,384 - DEBUG - Online update step: 32/50
2025-06-02 15:52:19,384 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,384 - DEBUG - Online update step: 33/50
2025-06-02 15:52:19,384 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,384 - DEBUG - Online update step: 34/50
2025-06-02 15:52:19,384 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,384 - DEBUG - Online update step: 35/50
2025-06-02 15:52:19,384 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,384 - DEBUG - Online update step: 36/50
2025-06-02 15:52:19,384 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,384 - DEBUG - Online update step: 37/50
2025-06-02 15:52:19,384 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,384 - DEBUG - Online update step: 38/50
2025-06-02 15:52:19,384 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,384 - DEBUG - Online update step: 39/50
2025-06-02 15:52:19,384 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,384 - DEBUG - Online update step: 40/50
2025-06-02 15:52:19,385 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,385 - DEBUG - Online update step: 41/50
2025-06-02 15:52:19,385 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,385 - DEBUG - Online update step: 42/50
2025-06-02 15:52:19,385 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,385 - DEBUG - Online update step: 43/50
2025-06-02 15:52:19,385 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,385 - DEBUG - Online update step: 44/50
2025-06-02 15:52:19,385 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,385 - DEBUG - Online update step: 45/50
2025-06-02 15:52:19,385 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,385 - DEBUG - Online update step: 46/50
2025-06-02 15:52:19,385 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,385 - DEBUG - Online update step: 47/50
2025-06-02 15:52:19,385 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,385 - DEBUG - Online update step: 48/50
2025-06-02 15:52:19,385 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,385 - DEBUG - Online update step: 49/50
2025-06-02 15:52:19,385 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,385 - DEBUG - Online update step: 50/50
2025-06-02 15:52:19,385 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,385 - WARNING - No successful steps during online update.
2025-06-02 15:52:19,386 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -3.6964121e-09 -2.2178472e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  6.3763110e-08
  3.3267710e-08  1.2937442e-08  4.6205151e-09 -3.4191810e-08
  2.6744187e+00  2.8759689e+00  2.0155039e-01  4.4263568e+00
 -1.2937442e-08  2.0930233e+00  6.6666665e+00  7.6976743e+00
  2.0155039e-01  8.0000000e+00 -1.4785648e-08  4.0660534e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -6.7459517e-08 -4.6205152e-08], current edge mean: [ 2.5636406e-09  4.4075806e+02  0.0000000e+00  0.0000000e+00
 -6.4091017e-09 -1.4100023e-08 -2.5636406e-09  2.5636406e-09
  2.5636406e-09 -8.9727425e-09]
2025-06-02 15:52:19,386 - DEBUG - Node drift difference: 0.0969, Edge drift difference: 0.4538
2025-06-02 15:52:19,386 - WARNING - Feature drift detected (3 consecutive)
2025-06-02 15:52:19,386 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-02 15:52:19,386 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-02 15:52:19,386 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-02 15:52:19,386 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-02 15:52:19,386 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-02 15:52:19,386 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-02 15:52:19,386 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-02 15:52:19,387 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-02 15:52:19,387 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-02 15:52:19,387 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-02 15:52:19,387 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-02 15:52:19,387 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-02 15:52:19,387 - INFO - Optimizer and scheduler reset.
2025-06-02 15:52:19,388 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -3.6964121e-09 -2.2178472e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  6.3763110e-08
  3.3267710e-08  1.2937442e-08  4.6205151e-09 -3.4191810e-08
  2.6744187e+00  2.8759689e+00  2.0155039e-01  4.4263568e+00
 -1.2937442e-08  2.0930233e+00  6.6666665e+00  7.6976743e+00
  2.0155039e-01  8.0000000e+00 -1.4785648e-08  4.0660534e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -6.7459517e-08 -4.6205152e-08], edge=[ 2.5636406e-09  4.4075806e+02  0.0000000e+00  0.0000000e+00
 -6.4091017e-09 -1.4100023e-08 -2.5636406e-09  2.5636406e-09
  2.5636406e-09 -8.9727425e-09]
2025-06-02 15:52:19,388 - DEBUG - Updated reference std: node=[0.         0.         1.0038986  1.0038986  0.         0.
 0.         1.0038986  1.0038987  1.0038986  1.0038986  1.0038986
 1.4040276  0.484248   0.43981254 0.7156203  1.0038986  2.3433478
 2.4947863  1.3784312  0.43981254 0.         1.0038986  1.0038986
 0.         0.         0.         0.         1.0038986  1.0038986 ], edge=[  1.002699  532.2214      0.          0.          1.002699    1.002699
   1.002699    1.0026991   1.002699    1.002699 ]
2025-06-02 15:52:19,388 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:52:19,388 - INFO - Running anomaly detection...
2025-06-02 15:52:19,388 - INFO - Starting anomaly detection.
2025-06-02 15:52:19,391 - DEBUG - Node reconstruction errors: [13.929523   6.7738705  7.4712477 13.903258   7.996203  13.3557
  9.53782   10.785682  10.785682  11.248587  10.785682   9.403005
  7.8308916  9.701575  13.179065  14.30084   15.490751  14.309461
 13.814473  14.043699  10.509039  13.179065  10.993958   8.711953
 13.320984  11.080622  13.320985   7.344892  10.509039  13.320983
  8.475239  10.993958  13.896709  13.601689  11.132703  13.010071
 10.661167  14.043699  13.609058  13.935495  13.898059  13.010071
 14.043699  13.728392  14.088645  10.651696  16.258081  17.237558
 10.369296  15.148103  16.5613    11.11608   10.952967  13.444182
 10.181937   9.052497  11.552968  13.87425   13.458667  13.165311
  6.6600666 13.891383  12.973712   8.546101  12.900876  10.181937
 11.077597  10.215232  12.973713  12.973715  10.259923   7.51282
 10.959298   7.53746    6.5047536  7.537462  13.018805   7.237261
  7.237261   7.237261  13.442632   7.237261  13.801461  11.151617
  9.017424  14.118993   7.53621    7.237261   7.237261  13.053937
 12.932791  14.000925  14.000925  10.7559595 10.7559595 16.138504
 13.44002   10.755958  13.12116   10.373197  10.755958  13.44002
 13.032972   7.237261  13.672573  10.418958  13.163271   6.745626
 14.118993  12.893609  12.43357   13.442632   8.61759   14.118993
 12.932792  13.032971  13.032974   7.482613  10.743098  10.755958
 13.423905  14.000925  14.000925  14.000925   7.4826126 10.7559595
  8.44211    7.1257906 10.7559595]
2025-06-02 15:52:19,392 - DEBUG - Edge reconstruction errors: [  4.5177994   6.9921894  43.58458     1.5456814  11.3279915  43.932228
  43.994663   43.929527    7.0048084  43.90474    44.068584   43.98416
  43.835278   43.806477   43.812885    5.651946    7.080586   43.938335
  44.0918     45.14725    43.90474    44.019947   44.19671    43.988773
  44.02018    43.90474    43.820927   43.951344   43.82126    43.93684
  43.856415   43.805805   43.880733   44.8598     43.804832    7.086486
  43.86042    43.935974   44.537445   44.537445   43.933258    8.704256
   1.4906837  58.080257   58.080257   45.73982     6.990164   43.65844
  43.991238   43.962326    6.9789953  43.892384   44.036304   44.190826
  43.78617    43.791595   43.791595   43.96683    43.8928     43.867706
  43.916477   43.900158   43.909637   43.909637   43.964542   43.917576
  43.909054   43.909054    4.650474   43.91255    43.8825     43.8825
  43.886395   43.84817    43.84817    43.850452   43.850452   43.855824
  43.855824   43.85547    43.85547    43.850903   43.850903   43.840656
  43.840656   43.88925    43.88925    44.096504   44.096504   44.034477
  44.034477   43.849976   43.857708   43.86261    43.87321    44.06584
  43.873608   43.87321    43.873608   43.82804    43.82804    43.86209
  43.994648   44.00236    43.87321    43.989285   43.99577    43.9015
  43.886166   43.90736    43.932625   43.784477   43.87718     4.94276
   5.3220024  44.025475    7.082384   43.89498     7.0210257  58.027355
   1.5381234  45.750526    6.9876733  43.598255   43.99085    44.107975
  44.360416   43.97009    44.001392   43.959064   43.946453   43.856182
  45.087254   43.998055   43.923557   43.54083    43.733047   43.733047
  43.530457   43.92024    43.98142    43.99542     7.580894    9.309651
  43.858063   43.931816   44.029106   44.021996   44.027115    8.665585
  12.962075    7.0706224  44.016193   43.88075    43.88076    44.053474
  43.929546   43.96621    43.934864   43.8461     43.937454   43.882973
  43.8659     43.965504    7.061155   43.84989    43.935715   43.833366
  44.00846    44.000317   43.988758   43.833588   43.74917    43.74917
  43.80529    43.937458  535.15155    43.80295    12.411707    1.5646312
  58.30615     1.5608671  46.042744   43.8308      7.11341   535.1516   ]
2025-06-02 15:52:19,393 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155219_update_10.json
2025-06-02 15:52:19,393 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:52:19,396 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155219_update_10.pth and as latest_checkpoint.pth
2025-06-02 15:52:19,396 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869395.dot): 0.4686
2025-06-02 15:52:19,396 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-02 15:52:19,396 - WARNING - Detected 2 anomalous edges (reconstruction-based):
2025-06-02 15:52:19,396 - WARNING -   Source: 192.168.27.10, Target: 224.0.0.251, Recon Error: 535.1516, MLP Score: 0.0000
2025-06-02 15:52:19,396 - WARNING -   Source: fe80::eb4e:a54d:8c61:6ce1, Target: ff02::fb, Recon Error: 535.1516, MLP Score: 0.0000
2025-06-02 15:52:19,396 - INFO - 
--- Processing file: nw_graph_encoded_1748869425.dot (Timestamp: 2025-06-02 15:03:45) ---
2025-06-02 15:52:19,396 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869425.dot
2025-06-02 15:52:19,396 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869425.dot'.
2025-06-02 15:52:19,396 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869425.dot
2025-06-02 15:52:19,401 - INFO - Parsed 177 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869425.dot'.
2025-06-02 15:52:19,405 - INFO - Parsed 256 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869425.dot'.
2025-06-02 15:52:19,405 - INFO - Processing node updates/additions.
2025-06-02 15:52:19,406 - INFO - Processing edge updates/additions.
2025-06-02 15:52:19,407 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:52:19,408 - INFO - Finished updating NetworkX graph.
2025-06-02 15:52:19,408 - DEBUG - Updated graph - Nodes: 177, Edges: 256
2025-06-02 15:52:19,408 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:52:19,408 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:52:19,410 - DEBUG - Initial node features tensor shape: torch.Size([177, 30])
2025-06-02 15:52:19,411 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:52:19,412 - DEBUG - Node features tensor shape after scaling: torch.Size([177, 30])
2025-06-02 15:52:19,412 - DEBUG - Edge index tensor shape: torch.Size([2, 256])
2025-06-02 15:52:19,412 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:52:19,413 - DEBUG - Initial edge attributes tensor shape: torch.Size([256, 10])
2025-06-02 15:52:19,414 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:52:19,414 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([256, 10])
2025-06-02 15:52:19,414 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:52:19,414 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:52:19,414 - INFO - Updated main graph to 177 nodes and 256 edges.
2025-06-02 15:52:19,414 - INFO - Performing online update...
2025-06-02 15:52:19,414 - INFO - Starting online update for 50 steps.
2025-06-02 15:52:19,415 - DEBUG - Updated RunningStats: new_mean=0.9423859103877618, new_var=40800000000168.82, new_n=4110
2025-06-02 15:52:19,415 - DEBUG - Updated RunningStats: new_mean=0.9407029217835933, new_var=41100000000014.13, new_n=4140
2025-06-02 15:52:19,415 - DEBUG - Updated RunningStats: new_mean=42.76580028311958, new_var=13600000228139.695, new_n=1370
2025-06-02 15:52:19,415 - DEBUG - Updated RunningStats: new_mean=43.03279149484716, new_var=13700000572772.025, new_n=1380
2025-06-02 15:52:19,415 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:52:19,415 - DEBUG - Online update step: 1/50
2025-06-02 15:52:19,415 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,415 - DEBUG - Online update step: 2/50
2025-06-02 15:52:19,415 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,415 - DEBUG - Online update step: 3/50
2025-06-02 15:52:19,415 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,415 - DEBUG - Online update step: 4/50
2025-06-02 15:52:19,415 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,415 - DEBUG - Online update step: 5/50
2025-06-02 15:52:19,415 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,416 - DEBUG - Online update step: 6/50
2025-06-02 15:52:19,416 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,416 - DEBUG - Online update step: 7/50
2025-06-02 15:52:19,416 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,416 - DEBUG - Online update step: 8/50
2025-06-02 15:52:19,416 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,416 - DEBUG - Online update step: 9/50
2025-06-02 15:52:19,416 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,416 - DEBUG - Online update step: 10/50
2025-06-02 15:52:19,416 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,416 - DEBUG - Online update step: 11/50
2025-06-02 15:52:19,416 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,416 - DEBUG - Online update step: 12/50
2025-06-02 15:52:19,416 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,416 - DEBUG - Online update step: 13/50
2025-06-02 15:52:19,416 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,416 - DEBUG - Online update step: 14/50
2025-06-02 15:52:19,416 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,416 - DEBUG - Online update step: 15/50
2025-06-02 15:52:19,416 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,416 - DEBUG - Online update step: 16/50
2025-06-02 15:52:19,416 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,416 - DEBUG - Online update step: 17/50
2025-06-02 15:52:19,416 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,416 - DEBUG - Online update step: 18/50
2025-06-02 15:52:19,416 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,416 - DEBUG - Online update step: 19/50
2025-06-02 15:52:19,416 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,416 - DEBUG - Online update step: 20/50
2025-06-02 15:52:19,416 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,416 - DEBUG - Online update step: 21/50
2025-06-02 15:52:19,416 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,416 - DEBUG - Online update step: 22/50
2025-06-02 15:52:19,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,417 - DEBUG - Online update step: 23/50
2025-06-02 15:52:19,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,417 - DEBUG - Online update step: 24/50
2025-06-02 15:52:19,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,417 - DEBUG - Online update step: 25/50
2025-06-02 15:52:19,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,417 - DEBUG - Online update step: 26/50
2025-06-02 15:52:19,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,417 - DEBUG - Online update step: 27/50
2025-06-02 15:52:19,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,417 - DEBUG - Online update step: 28/50
2025-06-02 15:52:19,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,417 - DEBUG - Online update step: 29/50
2025-06-02 15:52:19,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,417 - DEBUG - Online update step: 30/50
2025-06-02 15:52:19,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,417 - DEBUG - Online update step: 31/50
2025-06-02 15:52:19,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,417 - DEBUG - Online update step: 32/50
2025-06-02 15:52:19,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,417 - DEBUG - Online update step: 33/50
2025-06-02 15:52:19,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,417 - DEBUG - Online update step: 34/50
2025-06-02 15:52:19,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,417 - DEBUG - Online update step: 35/50
2025-06-02 15:52:19,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,417 - DEBUG - Online update step: 36/50
2025-06-02 15:52:19,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,417 - DEBUG - Online update step: 37/50
2025-06-02 15:52:19,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,417 - DEBUG - Online update step: 38/50
2025-06-02 15:52:19,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,417 - DEBUG - Online update step: 39/50
2025-06-02 15:52:19,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,418 - DEBUG - Online update step: 40/50
2025-06-02 15:52:19,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,418 - DEBUG - Online update step: 41/50
2025-06-02 15:52:19,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,418 - DEBUG - Online update step: 42/50
2025-06-02 15:52:19,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,418 - DEBUG - Online update step: 43/50
2025-06-02 15:52:19,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,418 - DEBUG - Online update step: 44/50
2025-06-02 15:52:19,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,418 - DEBUG - Online update step: 45/50
2025-06-02 15:52:19,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,418 - DEBUG - Online update step: 46/50
2025-06-02 15:52:19,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,418 - DEBUG - Online update step: 47/50
2025-06-02 15:52:19,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,418 - DEBUG - Online update step: 48/50
2025-06-02 15:52:19,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,418 - DEBUG - Online update step: 49/50
2025-06-02 15:52:19,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,418 - DEBUG - Online update step: 50/50
2025-06-02 15:52:19,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:19,418 - WARNING - No successful steps during online update.
2025-06-02 15:52:19,419 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -5.2869655e-08  1.3806725e-07
  0.0000000e+00  0.0000000e+00  0.0000000e+00  4.8491913e-08
  2.6939952e-09  2.6939952e-09 -3.1654444e-08  1.4816973e-08
  2.6610169e+00  2.9096045e+00  1.8079096e-01  4.3785310e+00
  2.6939952e-09  2.1186440e+00  6.7175140e+00  7.7118645e+00
  1.8079096e-01  8.0000000e+00 -2.4245956e-08  5.3879905e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -4.0409930e-08  1.6163971e-08], current edge mean: [ 9.3132257e-09  5.0284766e+02  0.0000000e+00  0.0000000e+00
  1.3969839e-08  4.6566129e-09  4.1909516e-09 -3.7252903e-09
  9.3132257e-09 -4.6566129e-10]
2025-06-02 15:52:19,419 - DEBUG - Node drift difference: 0.0695, Edge drift difference: 0.1167
2025-06-02 15:52:19,419 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -5.2869655e-08  1.3806725e-07
  0.0000000e+00  0.0000000e+00  0.0000000e+00  4.8491913e-08
  2.6939952e-09  2.6939952e-09 -3.1654444e-08  1.4816973e-08
  2.6610169e+00  2.9096045e+00  1.8079096e-01  4.3785310e+00
  2.6939952e-09  2.1186440e+00  6.7175140e+00  7.7118645e+00
  1.8079096e-01  8.0000000e+00 -2.4245956e-08  5.3879905e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -4.0409930e-08  1.6163971e-08], edge=[ 9.3132257e-09  5.0284766e+02  0.0000000e+00  0.0000000e+00
  1.3969839e-08  4.6566129e-09  4.1909516e-09 -3.7252903e-09
  9.3132257e-09 -4.6566129e-10]
2025-06-02 15:52:19,420 - DEBUG - Updated reference std: node=[0.         0.         1.002837   1.0028368  0.         0.
 0.         1.002837   1.002837   1.0028368  1.002837   1.0028368
 1.3349775  0.4166538  0.41433606 0.65556365 1.0028368  2.234172
 2.4678338  1.3320888  0.41433606 0.         1.0028368  1.002837
 0.         0.         0.         0.         1.002837   1.002837  ], edge=[  1.0019588 789.09216     0.          0.          1.0019588   1.0019588
   1.0019588   1.0019588   1.0019588   1.0019588]
2025-06-02 15:52:19,420 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:52:19,420 - INFO - Running anomaly detection...
2025-06-02 15:52:19,420 - INFO - Starting anomaly detection.
2025-06-02 15:52:19,423 - DEBUG - Node reconstruction errors: [14.494337   7.6764402  8.660162  14.62013    8.661862  14.977083
  9.665279  11.121686  11.121686  11.5970335 11.121686   9.802043
  8.917059  10.142243  13.656823  14.785134  16.029905  14.794857
 14.558197  14.495053  10.825144  13.656823  11.284336   9.076102
 13.796679  11.540939  13.796679   7.827332  10.825144  13.796679
  8.782292  11.284336  14.288621  14.116047  11.439906  13.432787
 10.984772  14.495053   9.180015  14.390958  14.290559  13.432787
 14.495053  14.921327  14.562854  10.865616  16.735723  17.851866
 10.597502  15.500395  17.338142  11.337002  11.345882  13.850459
 10.528004   9.392969  12.253847  14.201277  13.910889  13.745228
  6.80722   14.19185   13.325281   9.053035  13.352444  10.528004
 11.366577  10.588682  13.325281  13.325281  10.565469   7.983164
 11.261029   8.066902   6.5044565  8.066904  14.194107   7.6853933
  7.6853933  7.6853943 13.808371   7.8306785 14.122787  11.32552
  9.2294445 14.504776   7.9709477  7.6853943  7.6853933 10.950054
 13.490461  14.543386  14.543387  10.844995  10.950054  16.89236
 13.833539  10.950054  13.407168  10.608968  10.950054  13.833543
 13.320355   7.6853933 14.038609  10.605148  13.490463   6.758189
 14.504776  13.3275385 12.859599  13.808371   8.828247  14.504776
 13.224837  13.320355  13.320355   8.538617  10.89117   10.950054
 13.6993265 14.543387  14.543387  14.543387   7.7702546 10.950054
  8.78108    7.114535  10.950054  13.833539  11.392944  10.891171
 14.038651   7.0987844 10.891171  10.541424  14.047455  13.407168
 10.89117   10.89117   10.89117   13.6993265 13.320355  10.891171
 11.670526  10.89117   10.89117   10.89117   10.969848  10.891171
 12.125297   8.227454   6.732842  10.891171   6.782771   7.165884
 10.950054  10.89117   13.431533  13.956602  10.891171   7.0988
 10.950054  11.392944   7.7702546  8.6718445  7.6990194 13.833539
  7.0987782 10.891171  10.950054  10.950054  13.320355  16.944769
 10.950052   8.825979  10.8911705]
2025-06-02 15:52:19,424 - DEBUG - Edge reconstruction errors: [  4.511767    6.958144   43.43382     1.4590194  12.119723   43.921844
  43.984955   43.91759     6.9960837  43.893833   44.06966    43.98122
  43.808376   43.818283   43.82283    43.823765   43.823765    9.656067
   7.078418   43.914238   44.086094   44.934906   43.893833   44.013187
  44.104954   43.985874   44.008446   43.893833   43.804573   44.047646
  43.85101    43.934254   43.832096   43.790382   43.870823   44.69272
  43.78964     7.078624   43.891266   44.557808   43.870792   43.790382
 535.16547     7.1207933   7.1175013  43.95421    44.0041     44.048164
 808.87164    43.425316   44.046528   44.149208   43.952644   43.96804
  44.08068    43.885864   11.340937   43.99423    44.24013    43.960644
  43.89111    43.79013    43.859592   44.012527   43.88093    43.882244
  43.887924   43.871418   44.044884   44.115482    7.069857   43.950714
  44.04531    44.049583   43.870556   43.870617   43.881115   43.881115
  43.951      43.95996    44.44777    44.44777    43.929478    9.270908
   1.4588101  57.91307    57.91307    45.610382    6.959556   43.488647
  43.98935    43.964745    6.9842105  43.895306   44.048065   44.155327
  43.80636    43.81021    43.81021    43.969955   43.895668   43.854126
  43.921185   43.923737   43.93042    43.93042    43.96206    43.93583
  43.9299     43.9299      5.1597075  43.9273     43.90449    43.90449
  43.887695   43.867756   43.867756   43.872734   43.872734   43.876575
  43.876575   43.876324   43.876324   43.872997   43.872997   43.864986
  43.864986   43.90111    43.90111    44.07748    44.07748    43.985065
  43.985065   43.615265   43.85021    43.85671    43.863712   43.87076
  44.037376   43.87147    43.87076    43.87147    43.8521     43.8521
  43.863377   44.00066    44.01875    43.87076    44.00306    44.007557
  43.89032    43.880116   44.013477   43.911476   43.891666   43.889065
  43.79691    43.87583    43.947895   44.042603   44.11962    43.863564
  43.687283   43.687283   43.86194    43.86194    43.863197   11.325593
  43.862938   43.851257   43.86426     4.924667    5.1196003  44.040195
   7.093289   43.89287     7.015558   57.884464    1.4575903  45.62036
   6.9606605  43.45051    43.99539    44.106846   44.290176   43.959923
  44.0031     43.954655   43.943066   43.849552   44.64454    43.97567
  43.903065   43.55419    43.68408    43.68408    43.54696    43.9004
  43.98401    43.993477    7.5240355   9.000385   43.850723   43.932133
  43.98315    44.028526   44.032536    8.449319   12.954855    7.087546
  43.816032   43.816032   44.024006   43.87854    43.878548   44.060097
  43.99868    43.95106    43.935173   43.840023   43.932213   43.863068
  43.864445   43.968895    7.070986   43.849747   43.929028   43.82684
  44.02097    44.029655   43.942295   43.82817    43.79514    43.79514
  43.92346    43.941593  535.16565    43.79895    43.85188    43.85188
  43.874638   43.874638   43.790764   43.90504    43.871864   43.94296
  43.934044   12.416106    1.4674505  58.171013    1.4652876  45.892178
  43.678066    7.02114   535.1657    535.16547  ]
2025-06-02 15:52:19,425 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155219_update_11.json
2025-06-02 15:52:19,425 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:52:19,428 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155219_update_11.pth and as latest_checkpoint.pth
2025-06-02 15:52:19,428 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869425.dot): 0.4702
2025-06-02 15:52:19,428 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-02 15:52:19,428 - WARNING - Detected 5 anomalous edges (reconstruction-based):
2025-06-02 15:52:19,428 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.1655, MLP Score: 0.0000
2025-06-02 15:52:19,429 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.8716, MLP Score: 0.0000
2025-06-02 15:52:19,429 - WARNING -   Source: 192.168.27.10, Target: 224.0.0.251, Recon Error: 535.1656, MLP Score: 0.0000
2025-06-02 15:52:19,429 - WARNING -   Source: fe80::eb4e:a54d:8c61:6ce1, Target: ff02::fb, Recon Error: 535.1657, MLP Score: 0.0000
2025-06-02 15:52:19,429 - WARNING -   Source: fe80::3674:28:2588:1274, Target: ff02::fb, Recon Error: 535.1655, MLP Score: 0.0000
2025-06-02 15:52:19,431 - DEBUG - Embedding standard deviations before t-SNE: [1.1949136  0.20118827 1.3569659  1.1085205  1.7855278  0.
 0.8254002  1.152635   2.0117903  1.0621775  0.7667329  0.
 1.77463    0.72385865 1.2267295  1.2710681  0.         0.5018675
 0.         0.12062731 2.2967422  0.71397084 0.         1.5531716
 0.9753008  1.0421553  0.         0.8829613  1.7238939  0.
 1.1977253  0.42402035]
2025-06-02 15:52:19,684 - INFO - Embeddings visualization saved to vis/embeddings_11_updates_20250602_155219.png
2025-06-02 15:52:19,684 - INFO - Performing visualization of node and edge features.
2025-06-02 15:52:19,684 - INFO - Starting visualization of node features.
2025-06-02 15:52:19,684 - INFO - Graph has 177 nodes and 30 features.
2025-06-02 15:52:19,685 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:52:19,685 - INFO - Calculating feature statistics:
2025-06-02 15:52:19,685 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:19,685 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:19,685 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 6, 'mean': np.float32(-4.3103924e-08), 'std': np.float32(1.0), 'min': np.float32(-1.8533714), 'max': np.float32(0.91034335)}
2025-06-02 15:52:19,685 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 6, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.90634286), 'max': np.float32(1.8645692)}
2025-06-02 15:52:19,685 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:19,685 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:19,685 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:19,685 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(5.3879905e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.21757132), 'max': np.float32(4.5961943)}
2025-06-02 15:52:19,685 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(8.081986e-09), 'std': np.float32(1.0), 'min': np.float32(-1.064204), 'max': np.float32(0.9396695)}
2025-06-02 15:52:19,686 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 3, 'mean': np.float32(5.3879905e-09), 'std': np.float32(0.9999999), 'min': np.float32(-4.897244), 'max': np.float32(0.21041438)}
2025-06-02 15:52:19,686 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 6, 'mean': np.float32(-4.3103924e-08), 'std': np.float32(1.0), 'min': np.float32(-2.4087965), 'max': np.float32(0.73897755)}
2025-06-02 15:52:19,686 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 6, 'mean': np.float32(4.3103924e-08), 'std': np.float32(1.0), 'min': np.float32(-0.73631406), 'max': np.float32(2.423313)}
2025-06-02 15:52:19,686 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 7, 'mean': np.float32(2.661017), 'std': np.float32(1.3312011), 'min': np.float32(0.0), 'max': np.float32(10.0)}
2025-06-02 15:52:19,686 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.9096045), 'std': np.float32(0.4154752), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:52:19,686 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.18079096), 'std': np.float32(0.41316396), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:52:19,686 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.378531), 'std': np.float32(0.6537092), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:52:19,686 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 3, 'mean': np.float32(-5.3879905e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.21041438), 'max': np.float32(4.897244)}
2025-06-02 15:52:19,686 - INFO - - service_1: {'name': 'service_1', 'unique': 5, 'mean': np.float32(2.118644), 'std': np.float32(2.227852), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 15:52:19,686 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(6.717514), 'std': np.float32(2.4608526), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:52:19,686 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.7118645), 'std': np.float32(1.3283206), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:52:19,686 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.18079096), 'std': np.float32(0.41316396), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:52:19,686 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 1, 'mean': np.float32(8.0), 'std': np.float32(0.0), 'min': np.float32(8.0), 'max': np.float32(8.0)}
2025-06-02 15:52:19,687 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 3, 'mean': np.float32(-4.3103924e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.2046888), 'max': np.float32(6.382569)}
2025-06-02 15:52:19,687 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(5.3879905e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.21757132), 'max': np.float32(4.5961943)}
2025-06-02 15:52:19,687 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:19,687 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:19,687 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:19,687 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:19,687 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(-2.3572458e-08), 'std': np.float32(1.0), 'min': np.float32(-0.8935937), 'max': np.float32(5.248779)}
2025-06-02 15:52:19,687 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(-8.081986e-09), 'std': np.float32(1.0), 'min': np.float32(-0.99771225), 'max': np.float32(4.353653)}
2025-06-02 15:52:19,702 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x72fda512c950>
2025-06-02 15:52:19,836 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:52:19,885 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:52:19,912 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:52:21,233 - INFO - Node feature visualization saved to vis/node_features_20250602_155220.png
2025-06-02 15:52:21,234 - INFO - Finished visualization of node features.
2025-06-02 15:52:21,234 - INFO - Performing additional feature analysis:
2025-06-02 15:52:21,234 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:52:21,234 - INFO - Starting visualization of edge features.
2025-06-02 15:52:21,234 - INFO - Graph has 256 edges and 10 edge features.
2025-06-02 15:52:21,234 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:52:21,234 - INFO - Calculating edge feature statistics:
2025-06-02 15:52:21,235 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:52:21,235 - INFO - - count: {'name': 'count', 'unique': 17, 'mean': np.float32(1.4901161e-08), 'std': np.float32(1.0000001), 'min': np.float32(-0.11696286), 'max': np.float32(11.802426)}
2025-06-02 15:52:21,235 - INFO - - dst_port: {'name': 'dst_port', 'unique': 11, 'mean': np.float32(502.84766), 'std': np.float32(787.54944), 'min': np.float32(25.0), 'max': np.float32(8090.0)}
2025-06-02 15:52:21,235 - INFO - - protocol: {'name': 'protocol', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:21,235 - INFO - - service: {'name': 'service', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:21,235 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 175, 'mean': np.float32(1.1175871e-08), 'std': np.float32(1.0), 'min': np.float32(-0.20738153), 'max': np.float32(10.820693)}
2025-06-02 15:52:21,235 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 204, 'mean': np.float32(3.7252903e-09), 'std': np.float32(1.0), 'min': np.float32(-0.18580021), 'max': np.float32(11.406377)}
2025-06-02 15:52:21,235 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 100, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.14294389), 'max': np.float32(11.675713)}
2025-06-02 15:52:21,235 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 180, 'mean': np.float32(-1.1175871e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.26953164), 'max': np.float32(7.8537865)}
2025-06-02 15:52:21,235 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 197, 'mean': np.float32(5.5879354e-09), 'std': np.float32(1.0), 'min': np.float32(-0.2646618), 'max': np.float32(8.580755)}
2025-06-02 15:52:21,235 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 104, 'mean': np.float32(-7.450581e-09), 'std': np.float32(1.0), 'min': np.float32(-0.15828094), 'max': np.float32(11.456623)}
2025-06-02 15:52:21,245 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x72fda574ba10>
2025-06-02 15:52:21,313 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:52:21,322 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x72fda4b7faa0>
2025-06-02 15:52:21,391 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:52:21,474 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:52:21,596 - DEBUG - Plotted boxplots of the first 8 non-constant edge features.
2025-06-02 15:52:21,618 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:52:21,627 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:52:22,865 - INFO - Edge feature visualization saved to vis/edge_features_20250602_155221.png
2025-06-02 15:52:22,865 - INFO - Finished visualization of edge features.
2025-06-02 15:52:22,865 - INFO - Performing additional edge feature analysis:
2025-06-02 15:52:22,865 - INFO - - 2 out of 10 edge features are constant.
2025-06-02 15:52:22,865 - INFO - - Highest correlation (1.00) between features: 'count' and 'total_orig_pkts'.
2025-06-02 15:52:22,866 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:52:22,866 - INFO - Graph has 256 edges and 10 edge features.
2025-06-02 15:52:22,866 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:52:23,408 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_155222_summary.png
2025-06-02 15:52:23,602 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_155222_pca_3d.png
2025-06-02 15:52:23,780 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_155222_pca_variance.png
2025-06-02 15:52:23,780 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:52:23,781 - INFO - 
--- Processing file: nw_graph_encoded_1748869455.dot (Timestamp: 2025-06-02 15:04:15) ---
2025-06-02 15:52:23,781 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869455.dot
2025-06-02 15:52:23,781 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869455.dot'.
2025-06-02 15:52:23,781 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869455.dot
2025-06-02 15:52:23,785 - INFO - Parsed 256 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869455.dot'.
2025-06-02 15:52:23,789 - INFO - Parsed 395 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869455.dot'.
2025-06-02 15:52:23,789 - INFO - Processing node updates/additions.
2025-06-02 15:52:23,790 - INFO - Processing edge updates/additions.
2025-06-02 15:52:23,791 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:52:23,792 - INFO - Finished updating NetworkX graph.
2025-06-02 15:52:23,792 - DEBUG - Updated graph - Nodes: 256, Edges: 395
2025-06-02 15:52:23,792 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:52:23,792 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:52:23,794 - DEBUG - Initial node features tensor shape: torch.Size([256, 30])
2025-06-02 15:52:23,796 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:52:23,796 - DEBUG - Node features tensor shape after scaling: torch.Size([256, 30])
2025-06-02 15:52:23,797 - DEBUG - Edge index tensor shape: torch.Size([2, 395])
2025-06-02 15:52:23,797 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:52:23,797 - DEBUG - Initial edge attributes tensor shape: torch.Size([395, 10])
2025-06-02 15:52:23,798 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:52:23,798 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([395, 10])
2025-06-02 15:52:23,798 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:52:23,798 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:52:23,798 - INFO - Updated main graph to 256 nodes and 395 edges.
2025-06-02 15:52:23,798 - INFO - Performing online update...
2025-06-02 15:52:23,799 - INFO - Starting online update for 50 steps.
2025-06-02 15:52:23,799 - DEBUG - Updated RunningStats: new_mean=0.9423163824784749, new_var=41400000000166.07, new_n=4170
2025-06-02 15:52:23,799 - DEBUG - Updated RunningStats: new_mean=0.9407590702442975, new_var=41700000000015.84, new_n=4200
2025-06-02 15:52:23,799 - DEBUG - Updated RunningStats: new_mean=43.06804232483132, new_var=13800000207016.922, new_n=1390
2025-06-02 15:52:23,799 - DEBUG - Updated RunningStats: new_mean=43.22004826262013, new_var=13900000368202.244, new_n=1400
2025-06-02 15:52:23,799 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:52:23,799 - DEBUG - Online update step: 1/50
2025-06-02 15:52:23,799 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,799 - DEBUG - Online update step: 2/50
2025-06-02 15:52:23,799 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,799 - DEBUG - Online update step: 3/50
2025-06-02 15:52:23,799 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,799 - DEBUG - Online update step: 4/50
2025-06-02 15:52:23,799 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,799 - DEBUG - Online update step: 5/50
2025-06-02 15:52:23,799 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,799 - DEBUG - Online update step: 6/50
2025-06-02 15:52:23,799 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,799 - DEBUG - Online update step: 7/50
2025-06-02 15:52:23,799 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,799 - DEBUG - Online update step: 8/50
2025-06-02 15:52:23,800 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,800 - DEBUG - Online update step: 9/50
2025-06-02 15:52:23,800 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,800 - DEBUG - Online update step: 10/50
2025-06-02 15:52:23,800 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,800 - DEBUG - Online update step: 11/50
2025-06-02 15:52:23,800 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,800 - DEBUG - Online update step: 12/50
2025-06-02 15:52:23,800 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,800 - DEBUG - Online update step: 13/50
2025-06-02 15:52:23,800 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,800 - DEBUG - Online update step: 14/50
2025-06-02 15:52:23,800 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,800 - DEBUG - Online update step: 15/50
2025-06-02 15:52:23,800 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,800 - DEBUG - Online update step: 16/50
2025-06-02 15:52:23,800 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,800 - DEBUG - Online update step: 17/50
2025-06-02 15:52:23,800 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,800 - DEBUG - Online update step: 18/50
2025-06-02 15:52:23,800 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,800 - DEBUG - Online update step: 19/50
2025-06-02 15:52:23,800 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,800 - DEBUG - Online update step: 20/50
2025-06-02 15:52:23,800 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,800 - DEBUG - Online update step: 21/50
2025-06-02 15:52:23,800 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,800 - DEBUG - Online update step: 22/50
2025-06-02 15:52:23,800 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,800 - DEBUG - Online update step: 23/50
2025-06-02 15:52:23,800 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,800 - DEBUG - Online update step: 24/50
2025-06-02 15:52:23,800 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,800 - DEBUG - Online update step: 25/50
2025-06-02 15:52:23,800 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,800 - DEBUG - Online update step: 26/50
2025-06-02 15:52:23,800 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,800 - DEBUG - Online update step: 27/50
2025-06-02 15:52:23,800 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,800 - DEBUG - Online update step: 28/50
2025-06-02 15:52:23,800 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,800 - DEBUG - Online update step: 29/50
2025-06-02 15:52:23,800 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,800 - DEBUG - Online update step: 30/50
2025-06-02 15:52:23,800 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,800 - DEBUG - Online update step: 31/50
2025-06-02 15:52:23,800 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,800 - DEBUG - Online update step: 32/50
2025-06-02 15:52:23,800 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,800 - DEBUG - Online update step: 33/50
2025-06-02 15:52:23,800 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,800 - DEBUG - Online update step: 34/50
2025-06-02 15:52:23,800 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,801 - DEBUG - Online update step: 35/50
2025-06-02 15:52:23,801 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,801 - DEBUG - Online update step: 36/50
2025-06-02 15:52:23,801 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,801 - DEBUG - Online update step: 37/50
2025-06-02 15:52:23,801 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,801 - DEBUG - Online update step: 38/50
2025-06-02 15:52:23,801 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,801 - DEBUG - Online update step: 39/50
2025-06-02 15:52:23,801 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,801 - DEBUG - Online update step: 40/50
2025-06-02 15:52:23,801 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,801 - DEBUG - Online update step: 41/50
2025-06-02 15:52:23,801 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,801 - DEBUG - Online update step: 42/50
2025-06-02 15:52:23,801 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,801 - DEBUG - Online update step: 43/50
2025-06-02 15:52:23,801 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,801 - DEBUG - Online update step: 44/50
2025-06-02 15:52:23,801 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,801 - DEBUG - Online update step: 45/50
2025-06-02 15:52:23,801 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,801 - DEBUG - Online update step: 46/50
2025-06-02 15:52:23,801 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,801 - DEBUG - Online update step: 47/50
2025-06-02 15:52:23,801 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,801 - DEBUG - Online update step: 48/50
2025-06-02 15:52:23,801 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,801 - DEBUG - Online update step: 49/50
2025-06-02 15:52:23,801 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,801 - DEBUG - Online update step: 50/50
2025-06-02 15:52:23,801 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,801 - WARNING - No successful steps during online update.
2025-06-02 15:52:23,801 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -6.7055225e-08  7.4505806e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.6763806e-08
  1.8626451e-08  3.7252903e-09 -1.1175871e-08 -5.5879354e-09
  2.6054688e+00  2.9296875e+00  1.8750000e-01  4.3476562e+00
 -3.7252903e-09  2.5742188e+00  6.4804688e+00  7.6367188e+00
  1.8750000e-01  8.0000000e+00  4.4703484e-08 -2.4214387e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  3.2829121e-08  2.2351742e-08], current edge mean: [ 1.3279010e-08  4.7932657e+02  0.0000000e+00  0.0000000e+00
  2.4143654e-09 -3.6215480e-09  9.6574615e-09  6.0359135e-09
  0.0000000e+00 -4.8287307e-09]
2025-06-02 15:52:23,802 - DEBUG - Node drift difference: 0.2039, Edge drift difference: 0.0298
2025-06-02 15:52:23,802 - WARNING - Feature drift detected (1 consecutive)
2025-06-02 15:52:23,802 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -6.7055225e-08  7.4505806e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.6763806e-08
  1.8626451e-08  3.7252903e-09 -1.1175871e-08 -5.5879354e-09
  2.6054688e+00  2.9296875e+00  1.8750000e-01  4.3476562e+00
 -3.7252903e-09  2.5742188e+00  6.4804688e+00  7.6367188e+00
  1.8750000e-01  8.0000000e+00  4.4703484e-08 -2.4214387e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  3.2829121e-08  2.2351742e-08], edge=[ 1.3279010e-08  4.7932657e+02  0.0000000e+00  0.0000000e+00
  2.4143654e-09 -3.6215480e-09  9.6574615e-09  6.0359135e-09
  0.0000000e+00 -4.8287307e-09]
2025-06-02 15:52:23,802 - DEBUG - Updated reference std: node=[0.         0.         1.0019588  1.0019588  0.         0.
 0.         1.0019588  1.0019588  1.0019588  1.0019588  1.0019588
 1.209687   0.36907077 0.41064274 0.6137592  1.0019588  2.614132
 2.6151161  1.4622234  0.41064274 0.         1.0019588  1.0019588
 0.         0.         0.         0.         1.0019588  1.0019588 ], edge=[  1.0012683 636.47986     0.          0.          1.0012683   1.0012683
   1.0012683   1.0012683   1.0012681   1.0012683]
2025-06-02 15:52:23,802 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:52:23,802 - INFO - Running anomaly detection...
2025-06-02 15:52:23,802 - INFO - Starting anomaly detection.
2025-06-02 15:52:23,805 - DEBUG - Node reconstruction errors: [15.333217   8.997083  10.442019  15.230241   8.888568  15.354962
 11.489345  11.620923  11.620922  12.0984    11.620922  10.294786
 13.409713   8.874387  14.200708  15.4156065 16.729252  15.426725
 15.511644  15.010649  11.216083  14.200707  11.6742     9.468082
 14.316692  11.879139  14.316695   8.266928  11.216083  14.316695
  9.1275625 11.6742     9.828403  14.601986  11.749795  13.90664
 11.291464  15.010649   9.789433  15.838207  14.742349  13.90664
 15.010649  15.354244  15.134445  11.190645  17.361937  18.647058
 10.94202   16.018013  18.717607  11.647494  11.625648  15.280679
 10.733394   9.799152  14.182714  14.577201  14.488653  14.282736
  7.205142  14.541503  13.713418   9.263241  13.712808  11.238309
 11.482752  10.720496  13.713418  13.713418  10.680194   8.093549
 11.455108   8.197431   6.638304   8.197427  14.617667   7.8249
  7.8249025  6.806747  13.993933   7.936955  14.309021  11.444427
  9.473541   9.248644   8.102991   7.824902   7.824902   8.232724
 13.692882   8.879416  14.886143   8.248984  11.04674   18.618961
 14.153096  11.04674   13.64148   10.710624   8.232726  14.1531
 13.460511   7.8249025 14.328505  10.748395  13.957767   6.805914
 14.7668915 13.742571  13.174723  13.993933   9.040701   9.292145
  7.866722   8.172757   8.035021   7.356462   6.8839397 11.04674
 13.979996  14.886143   9.156328  14.886143   7.7962823 11.04674
  8.948776   7.0440927  8.232725  14.1531    11.537051  10.948156
 14.328532   7.0354934 10.948156  10.648006  14.416357  13.64148
 10.948154  10.948156  10.948154  13.979996  13.460511  10.948156
 11.75422   10.948156  10.948156  10.948156  11.073257  10.948156
 12.343691   8.243226   6.743993  10.948154   6.7215853  9.199784
 11.04674    8.172312  13.618567  14.229254  10.948156   7.035493
 11.04674   11.537051   7.7962823  8.821254   7.810561  14.1531
  7.2291055 10.948156  11.04674   11.04674   13.460512  18.707743
 11.04674    9.171941  10.948154   7.8340917 13.738043  11.184453
 10.841578  14.747641  14.115553   7.319859  14.747644   7.8340917
 13.56457   11.5622    13.56457   11.184453  13.738043   7.834091
 11.5622    11.219803  13.460512  11.5622    14.068402  13.460511
  9.081983  14.153096  13.64148   11.04674    8.8415985 14.1531
  7.728177  14.886143  11.243809   8.948775  13.64148   13.64148
 14.0494375 11.092261  11.184453   7.7281775  7.8340917 13.618567
  7.8340917  7.728177  11.184453  11.04674   14.747644  13.564569
 13.56457   11.184453  11.04674    6.8950396  7.8340917 11.04674
 11.184453  14.676284  14.886143  13.738043  13.98       7.728179
  7.728177  11.5622     6.84746   13.564569  11.04674   14.199971
 14.747644  13.64148   11.092261  10.948156  11.184453  10.948156
 11.184453   7.8340917 11.092261  11.134872  13.460511  13.618567
 11.184453  11.04674    7.728177   7.728177 ]
2025-06-02 15:52:23,806 - DEBUG - Edge reconstruction errors: [  4.498855    4.6507564   6.9863305  43.411438    1.4889835  11.860307
  43.932343   43.997665   43.92663     7.0167313  44.06181    44.101433
  43.996452   43.794827   43.839825   43.84162    43.841953   43.841953
   8.940303    7.097393   43.889507   44.108246   44.44497    43.903183
  43.97561    43.957336   43.70803    43.71629    43.73507    43.73507
  43.75097    43.771626   43.771626   43.88611    43.88855    43.88855
  43.946335   43.835392   43.94627    43.921013   44.019333   44.019333
  43.900063   43.899784   43.899784   43.73171    43.731674   43.731674
  44.080013   43.788265    7.0961523  43.896503   44.160645   43.909138
  43.91049    43.91049    43.788452  535.2165      7.1453476   7.1440587
  43.93393    44.023884   44.035946  808.9189     43.424503   44.078194
  44.120716   43.912167   43.918457   43.963783   43.883842   11.359549
  43.982674   44.018578   43.97477    43.884697   43.788437   43.862103
  43.935665   43.881897   43.91092    43.889244   43.87786    44.077396
  44.10762     7.091968   43.909916   44.050934   44.062897   43.882202
  43.882103   43.890404   43.890404   43.87834    43.88227    43.867764
  43.88815    43.86699    43.86699    43.86682    43.86682    43.90743
  43.87962    43.87962    43.866966   43.866966   43.789852   43.866966
  43.866966   43.742985   43.742985   43.874405   43.874405   43.788273
  43.872406   43.872406   43.788795   43.851826   43.851826   43.84777
  43.84777    43.686733   43.686733   43.68711    43.68711    43.849426
  43.849426   43.772438   43.77295    43.77272    43.868412   43.88922
  43.88922    43.863377   43.863434   43.850582   43.850582   43.847992
  43.847992   43.874435   43.874435   43.772575   43.77302    43.96115
  43.97855    44.122917   44.122917   43.934242   11.788548    1.4944046
  57.876423   57.876423   45.604843    6.9929442  43.445232   43.996174
  43.976963    7.008046   43.90814    44.088913   44.143913   43.8322
  43.82911    43.82911    43.985985   43.960377   43.824444   43.93435
  43.94218    43.944958   43.944958   43.96854    43.947063   43.944786
  43.944786    6.5351624  43.92564    43.918095   43.918095   43.895416
  43.87784    43.87784    43.74097    43.74097    43.7402     43.887894
  43.887894   43.887764   43.887764   43.88653    43.88653    43.881832
  43.881832   43.89695    43.89695    43.94282    43.94282    43.73205
  43.73205    43.53932    43.545326   43.85431    43.85601    43.871845
  43.634445   43.646393   43.646393   44.009422   43.936905   43.936905
  43.879616   43.73538    43.74536    43.74536    43.879616   43.865723
  43.865723   43.871708   44.020897   44.027824   43.87927    44.033367
  44.035225   43.919823   43.908993   43.908993   43.878387   43.937706
  43.928814   43.911686   43.911686   43.919853   43.913986   43.913986
  43.882236   43.78687    43.876537   43.895176   43.72644    43.756954
  43.871784   43.692974   43.692974   43.86967    43.86967    43.871685
  11.348539   43.871605   43.854996   43.859875   44.023415   44.026733
  43.87927    43.870403   43.66632    43.675854   43.871704   43.875637
  43.85508    43.88216    43.871796   44.033882   44.04063     7.0759845
  43.78073    43.871674   43.87176    43.782738   43.871704   43.879482
  43.900608   43.94547    43.92761    43.927578   43.76572    43.857147
  43.90051    43.864647   43.772694   44.05618    43.864647   43.686943
  43.686943   43.864647   43.986103    7.079756   44.06254    43.864647
  43.860706   43.86439    43.862694   43.86249    43.770954   43.934937
  43.857132   43.85718    43.839344   44.013924   44.055172   43.85732
   4.763698    4.975197   44.098698   44.102604   44.102604    7.158426
  43.938065    7.057423   57.884113    1.506732   45.625893    7.002391
  43.43318    44.045254   44.141693   44.211597   43.995712   44.04756
  43.99187    43.989502   43.89294    44.2989     43.99772    43.92668
  43.651585   43.761784   43.761784   43.64863    43.925915   44.032658
  44.036682    7.3651023   7.735675   43.893543   43.97772    43.967064
  44.081173   44.082455    7.543458   13.036296    7.169957   43.88518
  43.88518    44.074924   43.92463    43.924625   44.109695   44.02376
  43.974335   43.978622   43.878944   43.972435   43.890736   43.83027
  43.83308    43.83308    44.01305    11.873684   43.894314   43.96747
  43.864613   44.06666    44.069054   43.90444    43.864227   43.823696
  43.823696   43.96462    43.989082  535.2166     43.83532    43.85441
  43.85441    43.92816    43.92816    43.831963   43.94014    43.91895
  43.98211    43.97864    43.831768   43.831768   43.98953    43.832355
  43.831852   12.430846    1.4578396  58.06874     1.4568657  45.788002
  43.57456     6.9933133  58.06807   535.2166    535.2165   ]
2025-06-02 15:52:23,807 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155223_update_12.json
2025-06-02 15:52:23,807 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:52:23,810 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155223_update_12.pth and as latest_checkpoint.pth
2025-06-02 15:52:23,810 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869455.dot): 0.4606
2025-06-02 15:52:23,810 - WARNING - Detected 4 anomalous nodes (reconstruction-based):
2025-06-02 15:52:23,810 - WARNING -   Node ID: 150.171.28.10, Recon Error: 18.6471, MLP Score: 0.7934
2025-06-02 15:52:23,810 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 18.7176, MLP Score: 0.9341
2025-06-02 15:52:23,810 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 18.6190, MLP Score: 0.9433
2025-06-02 15:52:23,810 - WARNING -   Node ID: fe80::3674:28:2588:1274, Recon Error: 18.7077, MLP Score: 0.9323
2025-06-02 15:52:23,810 - WARNING - Detected 5 anomalous edges (reconstruction-based):
2025-06-02 15:52:23,810 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2165, MLP Score: 0.0000
2025-06-02 15:52:23,810 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9189, MLP Score: 0.0000
2025-06-02 15:52:23,810 - WARNING -   Source: 192.168.27.10, Target: 224.0.0.251, Recon Error: 535.2166, MLP Score: 0.0000
2025-06-02 15:52:23,810 - WARNING -   Source: fe80::eb4e:a54d:8c61:6ce1, Target: ff02::fb, Recon Error: 535.2166, MLP Score: 0.0000
2025-06-02 15:52:23,810 - WARNING -   Source: fe80::3674:28:2588:1274, Target: ff02::fb, Recon Error: 535.2165, MLP Score: 0.0000
2025-06-02 15:52:23,810 - INFO - 
--- Processing file: nw_graph_encoded_1748869485.dot (Timestamp: 2025-06-02 15:04:45) ---
2025-06-02 15:52:23,810 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869485.dot
2025-06-02 15:52:23,810 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869485.dot'.
2025-06-02 15:52:23,810 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869485.dot
2025-06-02 15:52:23,817 - INFO - Parsed 300 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869485.dot'.
2025-06-02 15:52:23,823 - INFO - Parsed 503 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869485.dot'.
2025-06-02 15:52:23,823 - INFO - Processing node updates/additions.
2025-06-02 15:52:23,825 - INFO - Processing edge updates/additions.
2025-06-02 15:52:23,828 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:52:23,828 - INFO - Finished updating NetworkX graph.
2025-06-02 15:52:23,828 - DEBUG - Updated graph - Nodes: 300, Edges: 503
2025-06-02 15:52:23,828 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:52:23,829 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:52:23,832 - DEBUG - Initial node features tensor shape: torch.Size([300, 30])
2025-06-02 15:52:23,833 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:52:23,833 - DEBUG - Node features tensor shape after scaling: torch.Size([300, 30])
2025-06-02 15:52:23,833 - DEBUG - Edge index tensor shape: torch.Size([2, 503])
2025-06-02 15:52:23,834 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:52:23,835 - DEBUG - Initial edge attributes tensor shape: torch.Size([503, 10])
2025-06-02 15:52:23,836 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:52:23,836 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([503, 10])
2025-06-02 15:52:23,836 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:52:23,836 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:52:23,836 - INFO - Updated main graph to 300 nodes and 503 edges.
2025-06-02 15:52:23,836 - INFO - Performing online update...
2025-06-02 15:52:23,836 - INFO - Starting online update for 50 steps.
2025-06-02 15:52:23,837 - DEBUG - Updated RunningStats: new_mean=0.9423510074586436, new_var=42000000000164.72, new_n=4230
2025-06-02 15:52:23,837 - DEBUG - Updated RunningStats: new_mean=0.9408669121639535, new_var=42300000000016.96, new_n=4260
2025-06-02 15:52:23,837 - DEBUG - Updated RunningStats: new_mean=43.24486835144643, new_var=14000000196567.178, new_n=1410
2025-06-02 15:52:23,837 - DEBUG - Updated RunningStats: new_mean=43.34361833172494, new_var=14100000289142.76, new_n=1420
2025-06-02 15:52:23,837 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:52:23,837 - DEBUG - Online update step: 1/50
2025-06-02 15:52:23,837 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,837 - DEBUG - Online update step: 2/50
2025-06-02 15:52:23,837 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,837 - DEBUG - Online update step: 3/50
2025-06-02 15:52:23,837 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,837 - DEBUG - Online update step: 4/50
2025-06-02 15:52:23,837 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,837 - DEBUG - Online update step: 5/50
2025-06-02 15:52:23,837 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,837 - DEBUG - Online update step: 6/50
2025-06-02 15:52:23,837 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,837 - DEBUG - Online update step: 7/50
2025-06-02 15:52:23,838 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,838 - DEBUG - Online update step: 8/50
2025-06-02 15:52:23,838 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,838 - DEBUG - Online update step: 9/50
2025-06-02 15:52:23,838 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,838 - DEBUG - Online update step: 10/50
2025-06-02 15:52:23,838 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,838 - DEBUG - Online update step: 11/50
2025-06-02 15:52:23,838 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,838 - DEBUG - Online update step: 12/50
2025-06-02 15:52:23,838 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,838 - DEBUG - Online update step: 13/50
2025-06-02 15:52:23,838 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,838 - DEBUG - Online update step: 14/50
2025-06-02 15:52:23,838 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,838 - DEBUG - Online update step: 15/50
2025-06-02 15:52:23,838 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,838 - DEBUG - Online update step: 16/50
2025-06-02 15:52:23,838 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,838 - DEBUG - Online update step: 17/50
2025-06-02 15:52:23,838 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,838 - DEBUG - Online update step: 18/50
2025-06-02 15:52:23,838 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,838 - DEBUG - Online update step: 19/50
2025-06-02 15:52:23,838 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,838 - DEBUG - Online update step: 20/50
2025-06-02 15:52:23,838 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,838 - DEBUG - Online update step: 21/50
2025-06-02 15:52:23,838 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,838 - DEBUG - Online update step: 22/50
2025-06-02 15:52:23,838 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,838 - DEBUG - Online update step: 23/50
2025-06-02 15:52:23,838 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,838 - DEBUG - Online update step: 24/50
2025-06-02 15:52:23,838 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,838 - DEBUG - Online update step: 25/50
2025-06-02 15:52:23,838 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,838 - DEBUG - Online update step: 26/50
2025-06-02 15:52:23,838 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,839 - DEBUG - Online update step: 27/50
2025-06-02 15:52:23,839 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,839 - DEBUG - Online update step: 28/50
2025-06-02 15:52:23,839 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,839 - DEBUG - Online update step: 29/50
2025-06-02 15:52:23,839 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,839 - DEBUG - Online update step: 30/50
2025-06-02 15:52:23,839 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,839 - DEBUG - Online update step: 31/50
2025-06-02 15:52:23,839 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,839 - DEBUG - Online update step: 32/50
2025-06-02 15:52:23,839 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,839 - DEBUG - Online update step: 33/50
2025-06-02 15:52:23,839 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,839 - DEBUG - Online update step: 34/50
2025-06-02 15:52:23,839 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,839 - DEBUG - Online update step: 35/50
2025-06-02 15:52:23,839 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,839 - DEBUG - Online update step: 36/50
2025-06-02 15:52:23,839 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,839 - DEBUG - Online update step: 37/50
2025-06-02 15:52:23,839 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,839 - DEBUG - Online update step: 38/50
2025-06-02 15:52:23,839 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,839 - DEBUG - Online update step: 39/50
2025-06-02 15:52:23,839 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,839 - DEBUG - Online update step: 40/50
2025-06-02 15:52:23,839 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,839 - DEBUG - Online update step: 41/50
2025-06-02 15:52:23,839 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,839 - DEBUG - Online update step: 42/50
2025-06-02 15:52:23,839 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,839 - DEBUG - Online update step: 43/50
2025-06-02 15:52:23,839 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,839 - DEBUG - Online update step: 44/50
2025-06-02 15:52:23,839 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,840 - DEBUG - Online update step: 45/50
2025-06-02 15:52:23,840 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,840 - DEBUG - Online update step: 46/50
2025-06-02 15:52:23,840 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,840 - DEBUG - Online update step: 47/50
2025-06-02 15:52:23,840 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,840 - DEBUG - Online update step: 48/50
2025-06-02 15:52:23,840 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,840 - DEBUG - Online update step: 49/50
2025-06-02 15:52:23,840 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,840 - DEBUG - Online update step: 50/50
2025-06-02 15:52:23,840 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,840 - WARNING - No successful steps during online update.
2025-06-02 15:52:23,840 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -4.4504802e-08  8.2651773e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.7815501e-08
  2.7020773e-08 -7.9472864e-09  2.2252401e-08  1.5894572e-09
  2.6233332e+00  2.9400001e+00  1.6666667e-01  4.3433332e+00
  9.5367430e-09  2.8033333e+00  6.3033333e+00  7.6100001e+00
  1.6666667e-01  8.0000000e+00 -4.1325887e-08 -7.9472864e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -1.5894573e-08 -3.2583873e-08], current edge mean: [ 1.1849830e-08  4.6719681e+02  0.0000000e+00  0.0000000e+00
  5.6879186e-09 -4.7399318e-10 -3.3179524e-09 -2.8439593e-09
  1.8959727e-09 -2.8439593e-09]
2025-06-02 15:52:23,840 - DEBUG - Node drift difference: 0.0876, Edge drift difference: 0.0191
2025-06-02 15:52:23,841 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -4.4504802e-08  8.2651773e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.7815501e-08
  2.7020773e-08 -7.9472864e-09  2.2252401e-08  1.5894572e-09
  2.6233332e+00  2.9400001e+00  1.6666667e-01  4.3433332e+00
  9.5367430e-09  2.8033333e+00  6.3033333e+00  7.6100001e+00
  1.6666667e-01  8.0000000e+00 -4.1325887e-08 -7.9472864e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -1.5894573e-08 -3.2583873e-08], edge=[ 1.1849830e-08  4.6719681e+02  0.0000000e+00  0.0000000e+00
  5.6879186e-09 -4.7399318e-10 -3.3179524e-09 -2.8439593e-09
  1.8959727e-09 -2.8439593e-09]
2025-06-02 15:52:23,841 - DEBUG - Updated reference std: node=[0.         0.         1.0016708  1.0016708  0.         0.
 0.         1.0016708  1.0016708  1.0016708  1.0016708  1.0016708
 1.1858089  0.34174448 0.39080855 0.5999907  1.0016708  2.8067029
 2.7072284  1.5051417  0.39080855 0.         1.0016708  1.0016708
 0.         0.         0.         0.         1.0016708  1.0016708 ], edge=[  1.0009955 565.6667      0.          0.          1.0009955   1.0009955
   1.0009955   1.0009954   1.0009955   1.0009955]
2025-06-02 15:52:23,841 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:52:23,841 - INFO - Running anomaly detection...
2025-06-02 15:52:23,842 - INFO - Starting anomaly detection.
2025-06-02 15:52:23,845 - DEBUG - Node reconstruction errors: [15.536438   9.344281  12.646884  15.453878  10.936634   7.8035583
 12.646884  11.969788  11.969788  12.430882  11.969788  10.569425
 16.383877   7.868151  14.494324  15.765502  17.120522  15.776913
 16.152971  15.300988  11.493383  14.494322  12.452947   9.68099
 14.58913   12.056756  14.58913    8.851772  11.493383  14.58913
  9.350723  11.946401  10.100194  14.930597  12.056756  14.137555
 11.629011  15.300984  10.48741   16.154995  14.976182  14.137555
 15.300984  15.5895405 15.426454  11.436541  17.684196  19.08909
 11.197378  16.139076  19.506157  11.854765  11.748002  15.815546
 11.282085  10.089179  15.209298  14.781299  14.818223  14.818223
  7.2119393 14.721258  13.929757   9.409839  13.803634  11.282085
 11.574252  11.265527  13.929757  13.929757  10.743201   8.091158
 11.560345   8.525239   6.786047   8.175003  14.826291   8.000433
  8.332648   6.946071  14.179524   8.159608  14.539793  11.954456
  9.810171   9.387512   8.657016   8.332652   8.091493   8.225419
 13.9464445  7.54526   14.964515   6.9842024 11.073445  19.524315
 14.202205   8.225418  13.822406  10.867524   8.225421  14.202205
 13.674713   7.8978934 14.5739355 10.779231  14.204705   6.962835
 14.977697  13.870259  13.396527  14.179524   9.2881975  9.602018
  7.993085   8.225773   8.1083555  7.622494   6.956995  11.073446
 14.202205  14.964515   9.362574  14.964515   7.8192983 11.073445
  9.001798   7.235463   8.225421  14.298469  11.61121   11.073445
 14.573955   9.383132   8.225418  10.779231  14.611167  13.822406
 11.073446   8.225421  11.073445  14.202205  13.674715  11.073445
 11.860163  11.073446   8.225421  11.073446  11.167729  11.073445
 12.471096   8.62296    7.0240107 11.073446   6.731947   7.626691
 11.073445   7.996283   8.225418  14.492942  11.073445   7.1611085
 11.073445  11.61121    7.8192983  9.40647    8.285627   6.956996
  7.2630663 11.073445   6.956999  11.073446  13.674715  19.579414
  8.225419   9.75731    8.225423   7.9010005 13.749782  11.236348
 10.936071   8.976827  14.193597   7.266132  14.824007   7.9010005
 13.749782  11.700541  13.749782  11.236348  13.749782   8.21984
 11.700541  11.292014  13.674715  11.700541  14.118527  13.674713
  9.124658  14.202205  13.822408  11.073445   9.017701  11.754473
  8.033625  14.964515  11.326695   9.701825  13.822406   6.8106155
 14.112443  11.236348  11.700541   7.8192983  7.9010005 13.674715
  7.9010005  7.8192983 11.236348  11.292012  14.824009  13.749782
 13.749782  11.700541  11.073445   6.8508544  7.9009995 11.073445
 11.236348  14.964515   9.124656  13.749782   8.225422   7.8192983
  7.8192983 11.700541   6.8508544 13.749782  11.073445  14.298469
 14.824007  13.822408  11.236348  11.073446  11.236348   8.225419
 11.236348   7.9010005 11.236348  11.267246  13.674715  13.674713
 11.236348  11.073445   7.8192983  7.8192983 11.236348  13.886998
 13.749782  11.236348   8.036977  14.817541  14.817541  11.236348
 11.236348  11.236348   7.956313  14.817541   7.956313  11.700541
 14.824007  14.824007   6.850853  14.508741   7.9563127 11.700541
 13.749782  11.700541  10.936071  11.236348   6.8508544 13.749782
 14.112443  14.508741  11.236348  14.252018   7.900999   7.3071814
  8.976826  14.193595  11.700541  14.112442  11.670817  11.236348
 14.193606  13.886998  11.236348  13.749782  11.700541  14.497262 ]
2025-06-02 15:52:23,847 - DEBUG - Edge reconstruction errors: [  4.4938564   4.6108894   6.9849114  43.405624    1.4822664  11.6377945
  44.03022    43.988518   43.913292    7.0050764  44.056076   44.096275
  43.961655   43.8182     43.82918    43.830967   43.8313     43.8313
   9.055399    7.087135   43.878944   44.10554    44.439686   43.891705
  43.964134   43.94731    43.701984   43.710247   43.730125   43.730125
  43.740475   43.762344   43.762344   43.884533   43.886993   43.886993
  43.937283   43.82348    43.965122   43.918636   44.02115    44.02115
  43.898083   43.897816   43.897816   43.746548   43.746513   43.746513
  44.083286   43.775944    7.0867996  43.88611    44.144794   43.865574
  43.8729     43.8729     43.776142  535.2207      7.15766     7.150647
  43.76124    43.792862   43.792862   43.739464   43.7517     43.740913
  43.740913  808.92316    43.427395   44.077755   44.119705   43.89955
  43.90577    43.950626   43.9122     43.907692   43.907692   11.348188
  43.880928   43.87063    43.87063    44.006153   43.964386   43.872757
  43.776123   43.85107    43.922897   43.910267   43.906647   43.906647
  43.89828    43.87764    43.906292   43.908043   43.908043   43.803215
  43.831955   43.80654    43.80654     7.082787   43.9381     43.905735
  43.905735   44.048973   44.06076    43.870087   43.869995   43.888554
  43.888554   43.90674    43.90562    43.90562    43.87018    43.911633
  43.905857   43.905857   43.876144   43.863472   43.863472   43.863304
  43.863304   43.921566   43.87605    43.87605    43.86344    43.86344
  43.777508   43.863907   43.863907   43.567665   43.567665   43.87094
  43.87094    43.77594    43.868893   43.868893   43.77648    43.848076
  43.848076   43.84401    43.84401    43.672867   43.672867   43.697296
  43.697296   43.884296   43.884296   43.76013    43.760628   43.760403
  43.855583   43.88782    43.88782    43.854984   43.85504    43.84673
  43.84673    43.84421    43.84421    43.87228    43.87228    43.760277
  43.760727    7.07531     7.08078    43.545856   43.545856   43.8618
  43.8618     43.835583   43.69432    43.69432    43.707306   43.707306
  43.870564   43.837624   43.980125   43.980125   43.831375   43.927704
  12.6692295   1.4822664  57.867077   57.867077   45.598225    6.999075
  43.45324    43.991257   43.972973    7.0050516  43.957      44.090355
  44.186855   43.835587   43.832542   43.832542   43.977962   43.95574
  43.817142   43.96865    43.962234   43.95989    43.95989    43.963627
  43.947372   43.94511    43.94511    10.328442   43.92406    43.91636
  43.91636    43.88967    43.889244   43.889244   43.88914    43.768955
  43.768955   43.77273    43.933937   43.933937   43.931786   43.933804
  43.933804   43.97563    43.90177    43.90177    43.927845   43.927845
  43.928497   43.902805   43.902805   43.892338   43.942993   43.942993
  43.749363   43.749363   43.551846   43.557686   43.85053    43.85235
  43.865826   43.530293   43.54235    43.54235    43.851658   43.777576
  43.777576   43.876266   43.727467   43.737274   43.737274   43.876266
  43.86414    43.86414    43.865692   44.019413   44.026318   43.875935
  44.04362    44.04954    43.91718    43.906513   43.906513   43.912785
  43.908      43.908      43.931324   43.926018   43.909126   43.909126
  43.917282   43.91141    43.91141    43.876083   43.91234    43.90753
  43.90753    43.87049    43.771046   43.757965   43.757965   43.565987
  43.59631    43.60026    43.60026    43.865757   43.70692    43.70692
  43.868057   43.868057   43.910107   43.906364   43.906364   11.348188
  43.865578   43.87249    43.768238   43.746387   43.746387   43.729958
  43.733032   43.732014   43.732014   43.875935   44.02157    43.667347
  43.676945   43.86566    43.869534   43.85125    43.906445   43.86577
  44.03315    44.039856    7.073904   43.776      43.865635   43.89863
  43.778084   43.865665   44.03335    44.036037   43.90308    43.949944
  43.92153    43.921497   43.761204   43.850655   43.893513   43.861526
  43.768692   44.058376   43.861526   43.699524   43.699524   43.861526
  43.984528    7.076868   44.068714   44.00797    44.010384   43.859962
  43.858383   43.85617    43.85596    43.766487   43.928898   43.925903
  43.92602    43.83558    44.01478    44.056202   43.86276    43.909924
  43.88243    44.00797    44.010307   43.855278   44.06341    44.064613
  43.852974   43.782707   43.8559     43.76094    43.85493    43.86941
  43.935753   43.760513   43.928883   43.861526   43.861526   43.947952
  43.839905    7.1279383  44.03661    43.85517    43.852802   43.850784
  43.921654    7.1279383   7.1279383   7.0784645  43.855625   43.92173
  43.76603    43.864914   43.864914   43.85076     4.7995234   4.9496346
  44.027977   44.03863    44.03863     7.136562   43.9202      7.0364685
  57.86274     1.4913273  45.60874     6.997052   43.416576   44.03612
  44.139606   44.209423   43.98015    44.036606   43.976578   43.973923
  43.87424    44.26892    43.97976    43.91073    43.672134   43.78015
  43.78015    43.669212   43.909935   44.085407   44.026688    7.3501196
   7.748969   43.874813   43.960342   43.94951    44.076748   44.078056
   7.5471597  13.009984    7.1771116  43.913406   43.913406   43.9405
  44.068554   43.907597   43.907597   44.10616    44.014965   43.959324
  43.968277   43.86022    43.95595    43.87154    43.819046   43.821827
  43.821827   44.002644   12.189169   43.878582   43.956306   43.84743
  44.06227    44.064796   43.88778    43.84717    43.838398   43.838398
  43.952362   44.09539   535.2208     43.819103   43.911987   43.911987
  43.95897    43.965126   43.965126   43.970455   43.815784   43.92696
  43.903584   43.969326   43.96588    43.77106    43.811207   43.811207
  43.81558    43.97763    43.81614    43.815674   43.90831    43.908546
  43.882282   43.899075   43.899075   43.904778   43.904778   43.89793
  43.89793    43.949795   43.949795   43.90022    43.875324   43.80213
  43.80593    12.427278    1.4544674  58.06904     1.4535352  45.788578
  43.575195    6.993315   58.068394  535.2208    535.2207   ]
2025-06-02 15:52:23,848 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155223_update_13.json
2025-06-02 15:52:23,848 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:52:23,851 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155223_update_13.pth and as latest_checkpoint.pth
2025-06-02 15:52:23,851 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869485.dot): 0.4488
2025-06-02 15:52:23,851 - WARNING - Detected 4 anomalous nodes (reconstruction-based):
2025-06-02 15:52:23,851 - WARNING -   Node ID: 150.171.28.10, Recon Error: 19.0891, MLP Score: 0.7831
2025-06-02 15:52:23,851 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 19.5062, MLP Score: 0.9397
2025-06-02 15:52:23,851 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 19.5243, MLP Score: 0.9533
2025-06-02 15:52:23,851 - WARNING -   Node ID: fe80::3674:28:2588:1274, Recon Error: 19.5794, MLP Score: 0.9419
2025-06-02 15:52:23,851 - WARNING - Detected 5 anomalous edges (reconstruction-based):
2025-06-02 15:52:23,851 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2207, MLP Score: 0.0000
2025-06-02 15:52:23,851 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9232, MLP Score: 0.0000
2025-06-02 15:52:23,851 - WARNING -   Source: 192.168.27.10, Target: 224.0.0.251, Recon Error: 535.2208, MLP Score: 0.0000
2025-06-02 15:52:23,851 - WARNING -   Source: fe80::eb4e:a54d:8c61:6ce1, Target: ff02::fb, Recon Error: 535.2208, MLP Score: 0.0000
2025-06-02 15:52:23,851 - WARNING -   Source: fe80::3674:28:2588:1274, Target: ff02::fb, Recon Error: 535.2207, MLP Score: 0.0000
2025-06-02 15:52:23,851 - INFO - 
--- Processing file: nw_graph_encoded_1748869515.dot (Timestamp: 2025-06-02 15:05:15) ---
2025-06-02 15:52:23,852 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869515.dot
2025-06-02 15:52:23,852 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869515.dot'.
2025-06-02 15:52:23,852 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869515.dot
2025-06-02 15:52:23,861 - INFO - Parsed 366 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869515.dot'.
2025-06-02 15:52:23,870 - INFO - Parsed 657 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869515.dot'.
2025-06-02 15:52:23,870 - INFO - Processing node updates/additions.
2025-06-02 15:52:23,872 - INFO - Processing edge updates/additions.
2025-06-02 15:52:23,876 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:52:23,876 - INFO - Finished updating NetworkX graph.
2025-06-02 15:52:23,877 - DEBUG - Updated graph - Nodes: 366, Edges: 657
2025-06-02 15:52:23,877 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:52:23,877 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:52:23,882 - DEBUG - Initial node features tensor shape: torch.Size([366, 30])
2025-06-02 15:52:23,883 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:52:23,883 - DEBUG - Node features tensor shape after scaling: torch.Size([366, 30])
2025-06-02 15:52:23,884 - DEBUG - Edge index tensor shape: torch.Size([2, 657])
2025-06-02 15:52:23,884 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:52:23,886 - DEBUG - Initial edge attributes tensor shape: torch.Size([657, 10])
2025-06-02 15:52:23,887 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:52:23,887 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([657, 10])
2025-06-02 15:52:23,887 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:52:23,887 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:52:23,888 - INFO - Updated main graph to 366 nodes and 657 edges.
2025-06-02 15:52:23,888 - INFO - Performing online update...
2025-06-02 15:52:23,888 - INFO - Starting online update for 50 steps.
2025-06-02 15:52:23,888 - DEBUG - Updated RunningStats: new_mean=0.9424338305680161, new_var=42600000000163.555, new_n=4290
2025-06-02 15:52:23,888 - DEBUG - Updated RunningStats: new_mean=0.9409942846955065, new_var=42900000000017.9, new_n=4320
2025-06-02 15:52:23,889 - DEBUG - Updated RunningStats: new_mean=43.36058933075282, new_var=14200000188602.727, new_n=1430
2025-06-02 15:52:23,889 - DEBUG - Updated RunningStats: new_mean=43.40911077210265, new_var=14300000221626.814, new_n=1440
2025-06-02 15:52:23,889 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:52:23,889 - DEBUG - Online update step: 1/50
2025-06-02 15:52:23,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,889 - DEBUG - Online update step: 2/50
2025-06-02 15:52:23,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,889 - DEBUG - Online update step: 3/50
2025-06-02 15:52:23,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,889 - DEBUG - Online update step: 4/50
2025-06-02 15:52:23,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,889 - DEBUG - Online update step: 5/50
2025-06-02 15:52:23,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,889 - DEBUG - Online update step: 6/50
2025-06-02 15:52:23,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,889 - DEBUG - Online update step: 7/50
2025-06-02 15:52:23,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,889 - DEBUG - Online update step: 8/50
2025-06-02 15:52:23,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,889 - DEBUG - Online update step: 9/50
2025-06-02 15:52:23,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,889 - DEBUG - Online update step: 10/50
2025-06-02 15:52:23,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,889 - DEBUG - Online update step: 11/50
2025-06-02 15:52:23,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,889 - DEBUG - Online update step: 12/50
2025-06-02 15:52:23,890 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,890 - DEBUG - Online update step: 13/50
2025-06-02 15:52:23,890 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,890 - DEBUG - Online update step: 14/50
2025-06-02 15:52:23,890 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,890 - DEBUG - Online update step: 15/50
2025-06-02 15:52:23,890 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,890 - DEBUG - Online update step: 16/50
2025-06-02 15:52:23,890 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,890 - DEBUG - Online update step: 17/50
2025-06-02 15:52:23,890 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,890 - DEBUG - Online update step: 18/50
2025-06-02 15:52:23,890 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,890 - DEBUG - Online update step: 19/50
2025-06-02 15:52:23,890 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,890 - DEBUG - Online update step: 20/50
2025-06-02 15:52:23,890 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,890 - DEBUG - Online update step: 21/50
2025-06-02 15:52:23,890 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,890 - DEBUG - Online update step: 22/50
2025-06-02 15:52:23,890 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,890 - DEBUG - Online update step: 23/50
2025-06-02 15:52:23,890 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,890 - DEBUG - Online update step: 24/50
2025-06-02 15:52:23,890 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,890 - DEBUG - Online update step: 25/50
2025-06-02 15:52:23,890 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,890 - DEBUG - Online update step: 26/50
2025-06-02 15:52:23,890 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,890 - DEBUG - Online update step: 27/50
2025-06-02 15:52:23,890 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,890 - DEBUG - Online update step: 28/50
2025-06-02 15:52:23,890 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,890 - DEBUG - Online update step: 29/50
2025-06-02 15:52:23,890 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,890 - DEBUG - Online update step: 30/50
2025-06-02 15:52:23,891 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,891 - DEBUG - Online update step: 31/50
2025-06-02 15:52:23,891 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,891 - DEBUG - Online update step: 32/50
2025-06-02 15:52:23,891 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,891 - DEBUG - Online update step: 33/50
2025-06-02 15:52:23,891 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,891 - DEBUG - Online update step: 34/50
2025-06-02 15:52:23,891 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,891 - DEBUG - Online update step: 35/50
2025-06-02 15:52:23,891 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,891 - DEBUG - Online update step: 36/50
2025-06-02 15:52:23,891 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,891 - DEBUG - Online update step: 37/50
2025-06-02 15:52:23,891 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,891 - DEBUG - Online update step: 38/50
2025-06-02 15:52:23,891 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,891 - DEBUG - Online update step: 39/50
2025-06-02 15:52:23,891 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,891 - DEBUG - Online update step: 40/50
2025-06-02 15:52:23,891 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,891 - DEBUG - Online update step: 41/50
2025-06-02 15:52:23,891 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,891 - DEBUG - Online update step: 42/50
2025-06-02 15:52:23,891 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,891 - DEBUG - Online update step: 43/50
2025-06-02 15:52:23,891 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,891 - DEBUG - Online update step: 44/50
2025-06-02 15:52:23,891 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,891 - DEBUG - Online update step: 45/50
2025-06-02 15:52:23,891 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,891 - DEBUG - Online update step: 46/50
2025-06-02 15:52:23,891 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,891 - DEBUG - Online update step: 47/50
2025-06-02 15:52:23,891 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,891 - DEBUG - Online update step: 48/50
2025-06-02 15:52:23,892 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,892 - DEBUG - Online update step: 49/50
2025-06-02 15:52:23,892 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,892 - DEBUG - Online update step: 50/50
2025-06-02 15:52:23,892 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,892 - WARNING - No successful steps during online update.
2025-06-02 15:52:23,892 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -1.7588256e-08  5.6021850e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.4753842e-08
 -3.9085013e-08 -2.6056675e-09  2.6056675e-08 -5.3090474e-08
  2.5655737e+00  2.9508197e+00  1.4480874e-01  4.3879781e+00
  2.6056675e-09  3.0710382e+00  6.0846996e+00  7.5983605e+00
  1.4480874e-01  8.0000000e+00  5.2113349e-09 -1.0422670e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.5176512e-08  1.6936839e-08], current edge mean: [ 2.1773385e-09  4.5770471e+02  0.0000000e+00  0.0000000e+00
  4.3546771e-09  7.2577953e-09  5.0804569e-09 -1.0160914e-08
  0.0000000e+00  4.3546771e-09]
2025-06-02 15:52:23,892 - DEBUG - Node drift difference: 0.0954, Edge drift difference: 0.0168
2025-06-02 15:52:23,893 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -1.7588256e-08  5.6021850e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.4753842e-08
 -3.9085013e-08 -2.6056675e-09  2.6056675e-08 -5.3090474e-08
  2.5655737e+00  2.9508197e+00  1.4480874e-01  4.3879781e+00
  2.6056675e-09  3.0710382e+00  6.0846996e+00  7.5983605e+00
  1.4480874e-01  8.0000000e+00  5.2113349e-09 -1.0422670e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.5176512e-08  1.6936839e-08], edge=[ 2.1773385e-09  4.5770471e+02  0.0000000e+00  0.0000000e+00
  4.3546771e-09  7.2577953e-09  5.0804569e-09 -1.0160914e-08
  0.0000000e+00  4.3546771e-09]
2025-06-02 15:52:23,893 - DEBUG - Updated reference std: node=[0.         0.         1.0013689  1.0013689  0.         0.
 0.         1.0013689  1.001369   1.0013689  1.001369   1.0013689
 1.1053125  0.31016898 0.38222542 0.589653   1.0013689  2.9452322
 2.8023348  1.5205975  0.38222542 0.         1.001369   1.001369
 0.         0.         0.         0.         1.0013689  1.0013689 ], edge=[  1.0007619 496.47144     0.          0.          1.0007619   1.0007619
   1.000762    1.0007619   1.0007619   1.000762 ]
2025-06-02 15:52:23,893 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:52:23,893 - INFO - Running anomaly detection...
2025-06-02 15:52:23,894 - INFO - Starting anomaly detection.
2025-06-02 15:52:23,898 - DEBUG - Node reconstruction errors: [15.896859  10.134559  14.118525  15.673013   9.676304   8.0281
 14.118525  12.154521  12.15452   12.614302  12.15452   10.686005
 18.356693   8.26109   14.601773  15.903882  11.435491  15.915695
 16.731081  15.386367  12.004868  14.601773  12.968409  10.754599
 14.67311   12.248902  14.67311    9.201024  11.637745  14.67311
  9.340318  12.092182  10.117639  15.11026   12.248902  15.668926
 11.64602   15.386367  11.472469  16.148514  15.063872  14.207437
 15.386367  16.292767  15.531261  12.653899  17.776854  10.907719
 11.27776   15.872964  19.88233   11.942316  11.885625  16.196835
 11.270502  10.349223  15.92981   14.810958  15.327231  15.32723
  7.435334  15.384004  13.953109   9.390525  13.866818  11.270502
 11.56012   11.263511  13.953108  13.953108  10.816783   8.080722
 11.663973   7.1893225  6.9300675  8.19437   14.773927   8.051932
  6.8565116  7.0596952 14.212516   8.199481  14.559798  11.8646755
 10.033346   9.677914   8.647584   7.059695   6.856512   8.391534
 13.924628   7.8677626 14.973687   7.0609565 11.4993105 19.963295
 14.171592   8.222243  14.016249  10.885212   8.222245  14.171592
 14.692821   7.992514   8.871503  10.783168  14.483398   7.0351806
 15.001386  13.146981  13.398297  14.660877   9.428503   9.7556095
  8.073157   8.222398   8.139805   7.9225054  7.0238557 11.063547
 14.183578  14.973687   9.581722   9.196759   6.7844844 11.063546
  9.003775   7.1819553  8.222245  14.398526  11.966354  11.063546
 14.528996   9.62636    8.222245  10.783168  14.763571  13.756134
 11.063546   8.222246  11.063546   8.66321   13.673051  11.063547
 11.839594   8.222276   8.222246  11.063544  11.533376   7.0238547
 12.547482   8.871505   7.020258  11.063546   6.82962    7.927031
 11.063546   8.009761   8.222245  14.490571  11.063547   7.1896834
 11.063547  11.966354   7.876407   9.627461   8.217924   7.0238557
  7.2063518  8.222249   7.0238576 11.233241  13.673051  15.245706
  8.222247  10.168686   8.222245   7.875218   8.310444   8.310441
 10.887429   8.995841  14.21482    9.067337  14.90693    7.875219
 13.6787615  8.3905525 13.6787615 11.183217  11.412003   6.9528375
 11.61762   11.23324   13.673051  11.61762   14.092449  13.673052
  7.8684063 14.171592  13.756135  11.063546   9.141406   7.0238795
  8.04639   14.973687  11.607351   9.953687  14.295619   7.074716
  8.574176   8.310441  11.61762    8.222248   7.875219  13.673051
  7.875219   7.87641    8.217919  11.23324    9.059859  13.678761
 13.67876   11.61762   11.063546   6.8554363  7.875218  11.063546
  7.122925  14.973688   9.196759   8.310445   8.222245   7.87641
  7.87641   11.61762    6.8554354 13.67876   11.063546  14.398526
  7.686359   8.360424  11.183215   8.36318   11.183217   8.222245
  8.310672   7.875218  11.183217  11.47975   13.673051  13.673051
  8.217917   7.0238547  7.87641    7.876407  11.183217  13.780125
 13.678761  11.183217   8.315491  14.900526  14.900526  11.183217
 11.183215  11.407379   8.315493  14.900526   8.315492  11.61762
 14.906931  14.906931   7.0986023 14.550904   8.315493  11.617621
 13.67876   11.617621  10.887425  11.183217   6.8554363 13.67876
 14.204177  14.487577  11.183217  14.253458   9.26848    7.2210236
  8.995841  14.133166  11.4075165 14.204177  11.822504  11.183217
 14.133181  13.780127  11.183217  13.67876   11.61762   14.552896
 11.784114  13.89139   13.89139   13.89139   13.89139   13.89139
 13.89139   13.89139   13.89139   13.89139   13.89139   13.89139
 13.89139   11.784114  14.523538  11.352037   8.513969  14.788019
 11.784114  11.822651  13.780127  13.780127   6.8554363 13.89139
 13.67876    7.1574    14.069323  13.89139    8.174898   8.315492
  8.770137  11.784114  13.891391   8.315491  13.89139   13.89139
 11.407622  13.67876   14.069323  14.069323  13.89139   14.133198
 14.069323   8.315494  13.89139    8.315496  13.89139   14.319129
  6.8360677 14.204177  13.89139   11.412003  14.906928   8.02299
 14.140864  11.61762   13.89139   13.89139   13.780125  13.780125
  7.875218  13.891388  14.069323  13.891388  13.891388  19.056622 ]
2025-06-02 15:52:23,902 - DEBUG - Edge reconstruction errors: [4.50441599e+00 4.63649988e+00 6.97675896e+00 4.33748741e+01
 1.47324979e+00 1.12014532e+01 4.40221748e+01 4.39801140e+01
 4.39017601e+01 6.99917030e+00 4.40329018e+01 4.40350533e+01
 4.41026688e+01 4.39522018e+01 4.38181572e+01 4.38361816e+01
 4.38420105e+01 4.38380775e+01 4.38380775e+01 8.75246906e+00
 7.08661556e+00 4.38670807e+01 4.41022873e+01 4.44018745e+01
 4.38828506e+01 4.39492569e+01 4.39899025e+01 4.36895981e+01
 4.36969185e+01 4.37125092e+01 4.37125092e+01 4.37299271e+01
 4.37470474e+01 4.37470474e+01 4.38798866e+01 4.38820343e+01
 4.38820343e+01 4.39582100e+01 4.38109207e+01 4.39559174e+01
 4.39097061e+01 4.39924774e+01 4.39924774e+01 4.38939438e+01
 4.38936768e+01 4.38936768e+01 4.37542076e+01 4.37541847e+01
 4.37541847e+01 4.44441605e+01 4.39133377e+01 7.16830826e+00
 7.16489410e+00 4.38778610e+01 4.41098099e+01 4.38613091e+01
 4.38675156e+01 4.38675156e+01 4.37644844e+01 5.35225952e+02
 7.17668629e+00 7.16440916e+00 4.37630310e+01 4.37874298e+01
 4.37874298e+01 4.37273636e+01 4.37370529e+01 4.37285919e+01
 4.37285919e+01 8.08928101e+02 4.34104614e+01 4.40762939e+01
 4.41144180e+01 4.37850494e+01 4.37552147e+01 4.37552147e+01
 4.38930054e+01 4.39771957e+01 4.39014244e+01 4.39014244e+01
 4.39053535e+01 4.39012451e+01 4.39012451e+01 1.13406487e+01
 4.38873711e+01 4.38787155e+01 4.38787155e+01 4.40249290e+01
 4.39031181e+01 4.39031181e+01 4.39564667e+01 4.38624916e+01
 4.37644844e+01 4.39726906e+01 4.39759712e+01 4.39759712e+01
 4.39082756e+01 4.39036064e+01 4.39003067e+01 4.39003067e+01
 4.38863029e+01 4.38683739e+01 4.38999710e+01 4.39015465e+01
 4.39015465e+01 4.37927246e+01 4.38191643e+01 4.37958641e+01
 4.37958641e+01 7.08327341e+00 4.39286880e+01 4.38994560e+01
 4.38994560e+01 4.40454903e+01 4.40562325e+01 4.38604698e+01
 4.38603745e+01 4.38825760e+01 4.38825760e+01 4.39004173e+01
 4.38993530e+01 4.38993530e+01 4.39140396e+01 4.39098511e+01
 4.39098511e+01 4.39047585e+01 4.38995323e+01 4.38995323e+01
 4.38671761e+01 4.38577347e+01 4.38577347e+01 4.38575783e+01
 4.38575783e+01 4.39292145e+01 4.38689270e+01 4.38689270e+01
 4.38993950e+01 4.38993950e+01 4.37657471e+01 4.38594589e+01
 4.38594589e+01 4.35717506e+01 4.35717506e+01 4.38642349e+01
 4.38642349e+01 4.37643433e+01 4.38625221e+01 4.38625221e+01
 4.37647896e+01 4.38437080e+01 4.38437080e+01 4.38401146e+01
 4.38401146e+01 4.36612587e+01 4.36612587e+01 4.37059059e+01
 4.37059059e+01 4.37054367e+01 4.37054367e+01 4.37491875e+01
 4.37496414e+01 4.37494354e+01 4.38903465e+01 4.38855209e+01
 4.38855209e+01 4.38744736e+01 4.38744736e+01 4.38455505e+01
 4.38456078e+01 4.38427048e+01 4.38427048e+01 4.38403549e+01
 4.38403549e+01 4.38621521e+01 4.38621521e+01 4.37492905e+01
 4.37496872e+01 7.07386589e+00 7.07887268e+00 4.35457649e+01
 4.35457649e+01 4.37086296e+01 4.37086296e+01 6.86635315e-01
 4.38269424e+01 4.37035675e+01 4.37035675e+01 4.37653198e+01
 4.37653198e+01 4.37495384e+01 4.38844872e+01 4.38844872e+01
 4.37465782e+01 4.37465782e+01 7.09213829e+00 4.38785553e+01
 4.36893463e+01 4.39272995e+01 4.39272995e+01 4.36839905e+01
 4.39147835e+01 1.42411613e+01 1.47324979e+00 5.78268394e+01
 5.78268394e+01 4.55675240e+01 6.98979902e+00 4.34497833e+01
 4.39822350e+01 4.39649773e+01 6.99914694e+00 4.39470673e+01
 4.40912323e+01 4.41743355e+01 4.38419876e+01 4.38392181e+01
 4.38392181e+01 4.39654922e+01 4.39459877e+01 4.37990303e+01
 4.39590492e+01 4.38139915e+01 4.38212814e+01 4.38212814e+01
 4.39554710e+01 4.39435844e+01 4.39415665e+01 4.39415665e+01
 1.15026045e+01 4.39199600e+01 4.39134407e+01 4.39134407e+01
 4.38804970e+01 4.38832054e+01 4.38832054e+01 4.38831482e+01
 4.37866211e+01 4.37866211e+01 4.37844467e+01 4.37451248e+01
 4.37451248e+01 4.37362366e+01 4.37890968e+01 4.37890968e+01
 4.38197937e+01 4.38963661e+01 4.38963661e+01 4.39216843e+01
 4.39216843e+01 4.39221535e+01 4.37561188e+01 4.37561188e+01
 4.37368050e+01 4.39236412e+01 4.39236412e+01 4.37216911e+01
 4.37216911e+01 4.35558586e+01 4.35613289e+01 4.38415184e+01
 4.38429184e+01 4.38565483e+01 4.35330811e+01 4.35438728e+01
 4.35438728e+01 4.38372536e+01 4.38063011e+01 4.38063011e+01
 4.38672943e+01 4.37154884e+01 4.37245178e+01 4.37245178e+01
 4.40292435e+01 4.40307465e+01 4.37249718e+01 4.37249718e+01
 4.38564186e+01 4.40150604e+01 4.40212021e+01 4.38669777e+01
 4.40403252e+01 4.40457153e+01 4.39098854e+01 4.39001503e+01
 4.39001503e+01 4.39058189e+01 4.39015045e+01 4.39015045e+01
 4.39169807e+01 4.39179764e+01 4.39026222e+01 4.39026222e+01
 4.39261932e+01 4.39210091e+01 4.39210091e+01 4.39246521e+01
 4.39052505e+01 4.39011040e+01 4.39011040e+01 4.38606949e+01
 4.37736053e+01 4.37633972e+01 4.37633972e+01 4.35702744e+01
 4.35978508e+01 4.35979156e+01 4.35979156e+01 4.38564758e+01
 4.37203865e+01 4.37203865e+01 4.38618584e+01 4.38618584e+01
 4.39100990e+01 4.39000320e+01 4.39000320e+01 1.13406487e+01
 4.38783264e+01 4.38628426e+01 4.37735748e+01 4.37594986e+01
 4.37594986e+01 4.37184753e+01 4.37211761e+01 4.37203903e+01
 4.37203903e+01 4.38669777e+01 4.38102989e+01 4.37692642e+01
 4.37692642e+01 4.36561546e+01 4.36645470e+01 4.38564148e+01
 4.38599663e+01 4.38422394e+01 4.38917809e+01 4.37542839e+01
 4.37550163e+01 4.37550163e+01 4.35631104e+01 4.35690079e+01
 4.36304893e+01 4.36304893e+01 7.07427931e+00 4.37644043e+01
 4.38563995e+01 4.38878822e+01 4.37661095e+01 4.38564148e+01
 4.40291252e+01 4.40315971e+01 4.38919373e+01 4.39385185e+01
 4.39125938e+01 4.39125595e+01 4.38740883e+01 4.38415871e+01
 4.39410515e+01 4.39040451e+01 4.39040451e+01 4.36479836e+01
 4.36514320e+01 4.36514320e+01 4.38925018e+01 4.38922195e+01
 4.38922195e+01 4.40349998e+01 4.38517609e+01 4.37083549e+01
 4.37083549e+01 4.35150871e+01 4.35239449e+01 4.35239449e+01
 4.39954338e+01 4.38871384e+01 4.38871384e+01 7.09211254e+00
 4.40634804e+01 4.40034752e+01 4.40056725e+01 4.38502235e+01
 4.38496017e+01 4.39070282e+01 4.39031906e+01 4.39031906e+01
 4.38906403e+01 4.38861580e+01 4.38861580e+01 4.38913841e+01
 4.38867073e+01 4.38867073e+01 4.38909683e+01 4.38855858e+01
 4.38855858e+01 4.39165802e+01 4.39166985e+01 4.39636192e+01
 4.39717369e+01 4.39717369e+01 4.36429176e+01 4.36784668e+01
 4.36452332e+01 4.36452332e+01 4.37558746e+01 4.37449150e+01
 4.37449150e+01 4.39255371e+01 4.37036972e+01 4.37141838e+01
 4.37141838e+01 4.40034752e+01 4.40056038e+01 4.38458290e+01
 4.40628128e+01 4.40638504e+01 4.38434639e+01 4.37870255e+01
 4.38463516e+01 4.37499428e+01 4.38454437e+01 4.38595886e+01
 4.39252167e+01 4.37495003e+01 4.39189835e+01 4.38517609e+01
 4.38517609e+01 4.39335594e+01 4.38308144e+01 7.12795830e+00
 4.40279503e+01 4.38937988e+01 4.38432999e+01 4.38416824e+01
 4.39126701e+01 7.12795830e+00 7.12795830e+00 7.07861233e+00
 4.38460999e+01 4.38839912e+01 4.37546310e+01 4.38603745e+01
 4.38603745e+01 4.38416595e+01 4.39039726e+01 7.07139874e+00
 4.40138092e+01 4.40389023e+01 7.86474800e+00 4.39168396e+01
 4.37497711e+01 4.38663902e+01 4.37223358e+01 4.37223358e+01
 4.38446655e+01 4.38446655e+01 4.38519554e+01 4.39346733e+01
 4.38464584e+01 4.40889740e+01 4.39027863e+01 4.38376007e+01
 4.39055710e+01 4.39018517e+01 4.38590546e+01 4.38312302e+01
 4.38217735e+01 4.38217735e+01 4.39019623e+01 5.08219481e+00
 5.04928827e+00 4.40557899e+01 4.40655823e+01 4.40655823e+01
 4.40566940e+01 7.14044571e+00 4.39157410e+01 7.03039789e+00
 5.78366776e+01 1.48306036e+00 4.55881844e+01 6.99073839e+00
 4.33954735e+01 4.41576996e+01 4.41597939e+01 4.41401672e+01
 4.42019691e+01 4.39761505e+01 4.40346260e+01 4.39724808e+01
 4.39706917e+01 4.38673058e+01 4.42454643e+01 4.39741745e+01
 4.39037437e+01 4.36887665e+01 4.37884445e+01 4.37884445e+01
 4.36861267e+01 4.39031029e+01 4.42763786e+01 4.40247765e+01
 7.34320641e+00 7.64612436e+00 4.38678551e+01 4.40460854e+01
 4.39411774e+01 4.41072044e+01 4.41111031e+01 7.45375633e+00
 1.29953585e+01 7.29782248e+00 4.40264587e+01 4.40264587e+01
 4.41834068e+01 4.40702667e+01 4.39033585e+01 4.39033585e+01
 4.41461830e+01 4.41673431e+01 4.40678177e+01 4.40986481e+01
 4.39650154e+01 4.38545914e+01 4.39491234e+01 4.40452347e+01
 4.38267708e+01 4.38364410e+01 4.38364410e+01 4.38309288e+01
 4.40018082e+01 1.10052395e+01 4.38768120e+01 4.40191536e+01
 4.38399200e+01 4.40627937e+01 4.40647736e+01 4.38745346e+01
 4.38394508e+01 4.39225197e+01 4.39225197e+01 4.39506187e+01
 4.40741386e+01 5.35226013e+02 4.38418655e+01 4.39089775e+01
 4.39089775e+01 4.39433365e+01 4.39682884e+01 4.39682884e+01
 4.39723587e+01 4.38121071e+01 4.39703598e+01 4.41297531e+01
 4.40233841e+01 4.40455818e+01 4.38490982e+01 4.38775787e+01
 4.38775787e+01 4.38644981e+01 4.40261345e+01 4.38124771e+01
 4.39768219e+01 4.39758720e+01 4.39758720e+01 4.39076538e+01
 4.39357948e+01 4.39041824e+01 4.39523849e+01 4.39523849e+01
 4.39519272e+01 4.39571953e+01 4.39571953e+01 4.39599419e+01
 4.39514389e+01 4.39514389e+01 4.39576263e+01 4.39906120e+01
 4.39906120e+01 4.40013390e+01 4.38736038e+01 4.37988434e+01
 4.38022690e+01 4.39915962e+01 4.39915962e+01 4.39803543e+01
 4.39539146e+01 4.39539146e+01 4.39696312e+01 4.39523048e+01
 4.39523048e+01 4.39558830e+01 4.39528084e+01 4.39528084e+01
 4.39546471e+01 4.39458771e+01 4.39458771e+01 4.39467354e+01
 4.38384628e+01 4.39555435e+01 4.39555435e+01 4.39613190e+01
 4.37976608e+01 4.38440323e+01 4.37974739e+01 4.37995377e+01
 4.38239212e+01 4.39600258e+01 4.38234444e+01 4.38241196e+01
 4.38300667e+01 4.38931313e+01 4.37772217e+01 4.37772217e+01
 4.38192368e+01 4.37860909e+01 4.37893715e+01 4.37852364e+01
 4.37861786e+01 4.38017426e+01 4.39686737e+01 4.37915916e+01
 4.37850647e+01 4.37866669e+01 4.38037987e+01 4.39375000e+01
 4.37830315e+01 4.37836876e+01 4.37831764e+01 4.37856140e+01
 4.38702087e+01 4.37830086e+01 4.39546242e+01 4.38962288e+01
 4.37839928e+01 4.36959610e+01 4.37827415e+01 4.82958717e+01
 4.37842102e+01 4.39335823e+01 4.37836418e+01 4.37857399e+01
 4.37830353e+01 4.37832184e+01 4.37829590e+01 4.37833328e+01
 4.37942924e+01 1.24703789e+01 1.45234525e+00 5.80318336e+01
 1.45147943e+00 4.57545280e+01 4.35418434e+01 6.98820448e+00
 5.80312386e+01 5.35226074e+02 5.35225952e+02 1.24860458e+01
 1.25447922e+01]
2025-06-02 15:52:23,904 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155223_update_14.json
2025-06-02 15:52:23,904 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:52:23,907 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155223_update_14.pth and as latest_checkpoint.pth
2025-06-02 15:52:23,907 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869515.dot): 0.4403
2025-06-02 15:52:23,907 - WARNING - Detected 3 anomalous nodes (reconstruction-based):
2025-06-02 15:52:23,908 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 19.8823, MLP Score: 0.9431
2025-06-02 15:52:23,908 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 19.9633, MLP Score: 0.9626
2025-06-02 15:52:23,908 - WARNING -   Node ID: fe80::a425:e54:93a8:261c, Recon Error: 19.0566, MLP Score: 0.9454
2025-06-02 15:52:23,908 - WARNING - Detected 5 anomalous edges (reconstruction-based):
2025-06-02 15:52:23,908 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2260, MLP Score: 0.0000
2025-06-02 15:52:23,908 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9281, MLP Score: 0.0000
2025-06-02 15:52:23,908 - WARNING -   Source: 192.168.27.10, Target: 224.0.0.251, Recon Error: 535.2260, MLP Score: 0.0000
2025-06-02 15:52:23,908 - WARNING -   Source: fe80::eb4e:a54d:8c61:6ce1, Target: ff02::fb, Recon Error: 535.2261, MLP Score: 0.0000
2025-06-02 15:52:23,908 - WARNING -   Source: fe80::3674:28:2588:1274, Target: ff02::fb, Recon Error: 535.2260, MLP Score: 0.0000
2025-06-02 15:52:23,908 - INFO - 
--- Processing file: nw_graph_encoded_1748869545.dot (Timestamp: 2025-06-02 15:05:45) ---
2025-06-02 15:52:23,908 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869545.dot
2025-06-02 15:52:23,908 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869545.dot'.
2025-06-02 15:52:23,908 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869545.dot
2025-06-02 15:52:23,919 - INFO - Parsed 392 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869545.dot'.
2025-06-02 15:52:23,929 - INFO - Parsed 753 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869545.dot'.
2025-06-02 15:52:23,929 - INFO - Processing node updates/additions.
2025-06-02 15:52:23,932 - INFO - Processing edge updates/additions.
2025-06-02 15:52:23,937 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:52:23,937 - INFO - Finished updating NetworkX graph.
2025-06-02 15:52:23,938 - DEBUG - Updated graph - Nodes: 392, Edges: 753
2025-06-02 15:52:23,938 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:52:23,938 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:52:23,943 - DEBUG - Initial node features tensor shape: torch.Size([392, 30])
2025-06-02 15:52:23,944 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:52:23,944 - DEBUG - Node features tensor shape after scaling: torch.Size([392, 30])
2025-06-02 15:52:23,945 - DEBUG - Edge index tensor shape: torch.Size([2, 753])
2025-06-02 15:52:23,946 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:52:23,947 - DEBUG - Initial edge attributes tensor shape: torch.Size([753, 10])
2025-06-02 15:52:23,948 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:52:23,948 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([753, 10])
2025-06-02 15:52:23,949 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:52:23,949 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:52:23,949 - INFO - Updated main graph to 392 nodes and 753 edges.
2025-06-02 15:52:23,949 - INFO - Performing online update...
2025-06-02 15:52:23,949 - INFO - Starting online update for 50 steps.
2025-06-02 15:52:23,950 - DEBUG - Updated RunningStats: new_mean=0.9425025577425866, new_var=43200000000161.42, new_n=4350
2025-06-02 15:52:23,950 - DEBUG - Updated RunningStats: new_mean=0.9411129229393906, new_var=43500000000018.71, new_n=4380
2025-06-02 15:52:23,950 - DEBUG - Updated RunningStats: new_mean=43.4306571416007, new_var=14400000194978.545, new_n=1450
2025-06-02 15:52:23,950 - DEBUG - Updated RunningStats: new_mean=43.51664206351064, new_var=14500000275861.56, new_n=1460
2025-06-02 15:52:23,950 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:52:23,950 - DEBUG - Online update step: 1/50
2025-06-02 15:52:23,950 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,950 - DEBUG - Online update step: 2/50
2025-06-02 15:52:23,950 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,950 - DEBUG - Online update step: 3/50
2025-06-02 15:52:23,950 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,950 - DEBUG - Online update step: 4/50
2025-06-02 15:52:23,950 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,950 - DEBUG - Online update step: 5/50
2025-06-02 15:52:23,950 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,950 - DEBUG - Online update step: 6/50
2025-06-02 15:52:23,951 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,951 - DEBUG - Online update step: 7/50
2025-06-02 15:52:23,951 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,951 - DEBUG - Online update step: 8/50
2025-06-02 15:52:23,951 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,951 - DEBUG - Online update step: 9/50
2025-06-02 15:52:23,951 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,951 - DEBUG - Online update step: 10/50
2025-06-02 15:52:23,951 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,951 - DEBUG - Online update step: 11/50
2025-06-02 15:52:23,951 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,951 - DEBUG - Online update step: 12/50
2025-06-02 15:52:23,951 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,951 - DEBUG - Online update step: 13/50
2025-06-02 15:52:23,951 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,951 - DEBUG - Online update step: 14/50
2025-06-02 15:52:23,951 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,951 - DEBUG - Online update step: 15/50
2025-06-02 15:52:23,951 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,951 - DEBUG - Online update step: 16/50
2025-06-02 15:52:23,951 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,951 - DEBUG - Online update step: 17/50
2025-06-02 15:52:23,951 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,951 - DEBUG - Online update step: 18/50
2025-06-02 15:52:23,951 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,951 - DEBUG - Online update step: 19/50
2025-06-02 15:52:23,951 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,951 - DEBUG - Online update step: 20/50
2025-06-02 15:52:23,951 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,951 - DEBUG - Online update step: 21/50
2025-06-02 15:52:23,951 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,951 - DEBUG - Online update step: 22/50
2025-06-02 15:52:23,951 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,951 - DEBUG - Online update step: 23/50
2025-06-02 15:52:23,951 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,951 - DEBUG - Online update step: 24/50
2025-06-02 15:52:23,952 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,952 - DEBUG - Online update step: 25/50
2025-06-02 15:52:23,952 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,952 - DEBUG - Online update step: 26/50
2025-06-02 15:52:23,952 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,952 - DEBUG - Online update step: 27/50
2025-06-02 15:52:23,952 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,952 - DEBUG - Online update step: 28/50
2025-06-02 15:52:23,952 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,952 - DEBUG - Online update step: 29/50
2025-06-02 15:52:23,952 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,952 - DEBUG - Online update step: 30/50
2025-06-02 15:52:23,952 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,952 - DEBUG - Online update step: 31/50
2025-06-02 15:52:23,952 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,952 - DEBUG - Online update step: 32/50
2025-06-02 15:52:23,952 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,952 - DEBUG - Online update step: 33/50
2025-06-02 15:52:23,952 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,952 - DEBUG - Online update step: 34/50
2025-06-02 15:52:23,952 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,952 - DEBUG - Online update step: 35/50
2025-06-02 15:52:23,952 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,952 - DEBUG - Online update step: 36/50
2025-06-02 15:52:23,952 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,952 - DEBUG - Online update step: 37/50
2025-06-02 15:52:23,952 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,952 - DEBUG - Online update step: 38/50
2025-06-02 15:52:23,952 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,952 - DEBUG - Online update step: 39/50
2025-06-02 15:52:23,952 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,952 - DEBUG - Online update step: 40/50
2025-06-02 15:52:23,952 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,952 - DEBUG - Online update step: 41/50
2025-06-02 15:52:23,952 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,952 - DEBUG - Online update step: 42/50
2025-06-02 15:52:23,953 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,953 - DEBUG - Online update step: 43/50
2025-06-02 15:52:23,953 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,953 - DEBUG - Online update step: 44/50
2025-06-02 15:52:23,953 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,953 - DEBUG - Online update step: 45/50
2025-06-02 15:52:23,953 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,953 - DEBUG - Online update step: 46/50
2025-06-02 15:52:23,953 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,953 - DEBUG - Online update step: 47/50
2025-06-02 15:52:23,953 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,953 - DEBUG - Online update step: 48/50
2025-06-02 15:52:23,953 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,953 - DEBUG - Online update step: 49/50
2025-06-02 15:52:23,953 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,953 - DEBUG - Online update step: 50/50
2025-06-02 15:52:23,953 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:23,953 - WARNING - No successful steps during online update.
2025-06-02 15:52:23,953 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -3.1626954e-08  4.8656852e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.1626954e-08
 -3.8925482e-08  2.0679163e-08  4.8656852e-09 -2.7369479e-08
  2.4974489e+00  2.9540815e+00  1.3775510e-01  4.3596940e+00
  1.2164213e-09  3.2857144e+00  5.8392859e+00  7.5790815e+00
  1.3775510e-01  8.0000000e+00 -7.2985280e-09 -3.1626954e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.1556002e-08 -5.3218434e-09], current edge mean: [-6.3324990e-09  4.6533334e+02  0.0000000e+00  0.0000000e+00
 -2.5329996e-09 -1.2664998e-09 -4.4327493e-09  1.2664998e-09
 -5.0659992e-09  5.6992491e-09]
2025-06-02 15:52:23,954 - DEBUG - Node drift difference: 0.0876, Edge drift difference: 0.0154
2025-06-02 15:52:23,954 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -3.1626954e-08  4.8656852e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.1626954e-08
 -3.8925482e-08  2.0679163e-08  4.8656852e-09 -2.7369479e-08
  2.4974489e+00  2.9540815e+00  1.3775510e-01  4.3596940e+00
  1.2164213e-09  3.2857144e+00  5.8392859e+00  7.5790815e+00
  1.3775510e-01  8.0000000e+00 -7.2985280e-09 -3.1626954e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.1556002e-08 -5.3218434e-09], edge=[-6.3324990e-09  4.6533334e+02  0.0000000e+00  0.0000000e+00
 -2.5329996e-09 -1.2664998e-09 -4.4327493e-09  1.2664998e-09
 -5.0659992e-09  5.6992491e-09]
2025-06-02 15:52:23,955 - DEBUG - Updated reference std: node=[0.         0.         1.0012779  1.0012779  0.         0.
 0.         1.001278   1.0012779  1.0012779  1.0012779  1.0012779
 1.0559748  0.29992953 0.37355423 0.58165294 1.0012779  3.045268
 2.8914173  1.55179    0.37355423 0.         1.0012779  1.0012779
 0.         0.         0.         0.         1.0012779  1.0012779 ], edge=[  1.0006646 552.8399      0.          0.          1.0006647   1.0006647
   1.0006647   1.0006646   1.0006646   1.0006647]
2025-06-02 15:52:23,955 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:52:23,955 - INFO - Running anomaly detection...
2025-06-02 15:52:23,955 - INFO - Starting anomaly detection.
2025-06-02 15:52:23,959 - DEBUG - Node reconstruction errors: [16.060677  10.42193   14.877854  15.870126  10.087513   8.269965
 14.877854  12.284425  12.284425  12.741941  12.284425  10.862956
 19.410177   8.54787   14.791522  16.116615  11.581767  16.128504
 17.093761  15.5761    12.073314  14.791522  12.3256035 10.866687
 14.861742  12.360834  14.861742   9.481755  11.749271  14.861742
  9.455432  12.199665  10.235086  15.297292  12.360834  15.798846
  9.085844  15.5761    10.837577  16.30135   15.249821  14.384536
 15.5761    16.469687  15.726626  12.696625  17.994377  11.03377
 11.36917   16.002401  20.3764    12.037558  11.979751  16.481339
 11.317837  10.48683   16.508686  14.964308  15.643915  15.643915
  7.437268  15.541409  14.111256  10.074129  14.023373  11.5678835
 11.872797  11.316669  14.1112585 14.1112585 10.885249   8.098214
 11.741548   7.3479667  7.0786815  8.208469  14.900311   8.114595
  7.32215    7.188189  14.354885   8.635359   9.172533  11.900411
 10.246378   9.763247   8.653776   7.2891593  7.003934   8.492281
 14.070994   8.102924  15.086622   7.178324  11.501742  20.545149
 14.284994   8.251811  14.156328  10.948139   8.251811  14.284995
 14.8290615  8.026262   8.922557  10.832282  14.627101   7.0926814
  9.739313  13.338932  13.563997  14.764469   9.69452    9.702622
  8.528868   8.251911   8.146482   8.056931   7.114357  11.103607
 14.315915  15.086622   9.681296   9.288656   6.900321  11.103607
  9.071269   7.214455   8.251811  14.50579   12.002773  11.103607
 14.64752    9.734874   8.25181   10.832282  14.901701  13.8874035
 11.483075   8.25181   11.103607   8.633971  13.804858  11.483075
 11.483076   8.25184    8.385102  11.103607  11.539166   7.1143556
 12.710432   8.922559   7.1121063 11.103607   6.92632    8.107503
 11.103607   8.229766   8.251811  14.602888  11.103607   7.2397704
 11.103608  12.002773   8.385104   9.723097   8.233966   7.197648
  7.2387614  8.251816   7.1143575 11.257638  13.804858  15.735231
  7.197647  10.301824   7.1976504  7.896813   8.31442    8.314418
 10.9015255  9.062144  14.3408     9.166505   9.484752   8.314461
 13.801717   8.402506  13.801717  11.192016   7.2263308  7.0462503
 11.626206  11.257638  14.315915  11.626206  14.216799  13.804857
  8.095252  14.284995  13.8874035 11.103607   9.426406   7.1976514
  8.084568  15.086622  11.677789  10.063187  14.436385   7.1912484
  8.573578   8.314418  11.626206   7.248201   8.31442   13.804858
  7.896813   7.9243183  8.240658  11.257636   9.161814  14.073169
 13.801717  11.626208  11.103607   6.933188   8.314437  11.103607
  7.203405  15.086622   9.288656   8.31442    8.25181    8.385101
  7.9243207 11.626206   6.933188  13.801717  11.103607  14.50579
  7.968981   7.191251  11.192017   8.385103  11.192017   8.251811
  8.314642   7.8968096 11.192017  11.482337  13.804858  13.804858
  8.240655   7.1143556  7.9243207  7.9243207 11.192017  13.901407
 13.801717   8.314419   7.208368  15.035023  15.035023  11.192017
  7.2034044 11.45941    6.9817533 15.035023   6.9817514  8.3144245
  9.769483   9.484747   7.1784163 14.672476   8.318158   8.314418
 13.801718   7.476707  10.9015255  8.314419   7.015673  14.025178
  7.203422  14.630762  11.192016  14.398443   9.404641   7.2379303
  9.062144   9.371415  11.459525  14.323661  11.855506  11.192016
 14.243829  13.901407   8.314421   8.31837   11.626206  14.665615
 11.427526  14.011087  14.011087  14.011087  14.011087  14.011087
 14.011087  14.011087  14.011087  14.011087  14.011087   8.344216
 14.011087  11.847658   9.166678  11.433612   8.492808  14.910385
 11.847658  11.865931  13.901407  13.901407   6.9506707 14.011087
 13.801718   7.1568055 14.184444   8.34422    7.208359   7.208359
  7.283563  11.847656  14.011087   8.318158  14.011087   8.344218
 11.427526  13.801718  14.184443  14.184444  14.011087  14.243842
 14.184444   7.208358  14.011087   8.31816   14.011087  14.460065
  6.9094305 14.323661  14.011087  11.441935  15.041194   8.022948
 14.252267  11.626206  14.011083  14.011087  13.901407  13.901407
  7.896813  14.011087  14.184443  14.011083  14.011087  19.549175
 13.921019   8.02295   11.427526  13.92102    9.951237  11.427526
 11.427526  11.427526   9.951237  14.011087  13.921022  11.898068
  7.061688  14.011087  11.469654  11.427526  11.427526  14.238809
 11.427526   8.02295   11.128296   8.610149   7.987367  14.011087
 12.116647   8.022951 ]
2025-06-02 15:52:23,963 - DEBUG - Edge reconstruction errors: [4.49453974e+00 4.64753723e+00 6.97592640e+00 4.33753777e+01
 1.46795654e+00 1.40577221e+01 4.39894600e+01 4.39765244e+01
 4.38959084e+01 6.99407291e+00 4.40289955e+01 4.40307693e+01
 4.40997925e+01 4.39730263e+01 4.38317223e+01 4.38330498e+01
 4.38379211e+01 4.38346519e+01 4.38346519e+01 1.07626715e+01
 7.18549824e+00 7.18947029e+00 4.38615990e+01 4.40980835e+01
 4.43507843e+01 4.40604935e+01 4.40624390e+01 4.39375954e+01
 4.39718704e+01 4.37075768e+01 4.37205124e+01 4.37285767e+01
 4.37285767e+01 4.37221832e+01 4.37384148e+01 4.37384148e+01
 4.37270889e+01 4.39382515e+01 4.39367256e+01 4.39367256e+01
 4.39378281e+01 4.38039398e+01 4.39527473e+01 4.39093971e+01
 4.39857407e+01 4.39857407e+01 4.38941765e+01 4.38939743e+01
 4.38939743e+01 4.37706528e+01 4.37706146e+01 4.37706146e+01
 4.44152565e+01 4.39075127e+01 7.16613293e+00 7.16902828e+00
 4.38731270e+01 4.40649757e+01 4.38697777e+01 4.38714676e+01
 4.38714676e+01 4.37590332e+01 5.35226013e+02 7.19553471e+00
 7.16299677e+00 4.37791634e+01 4.38026199e+01 4.38026199e+01
 4.37239685e+01 4.37330666e+01 4.37250595e+01 4.37250595e+01
 8.08927856e+02 4.34075394e+01 4.40750694e+01 4.41068802e+01
 4.37962608e+01 4.37714195e+01 4.37714195e+01 4.38837357e+01
 4.39648094e+01 4.39014587e+01 4.39014587e+01 4.39136963e+01
 4.39147491e+01 4.39147491e+01 1.13377333e+01 4.39042969e+01
 4.38965530e+01 4.38965530e+01 4.40066528e+01 4.39028015e+01
 4.39028015e+01 4.38971138e+01 4.39027596e+01 4.37590179e+01
 4.39720078e+01 4.39745674e+01 4.39745674e+01 4.38966904e+01
 4.39032593e+01 4.39005051e+01 4.39005051e+01 4.39262047e+01
 4.38648605e+01 4.39002419e+01 4.39015656e+01 4.39015656e+01
 4.37926941e+01 4.38145409e+01 4.37952271e+01 4.37952271e+01
 7.07835388e+00 4.38140945e+01 4.37796440e+01 4.37796440e+01
 4.40445900e+01 4.40535240e+01 4.38566666e+01 4.38565941e+01
 4.39316788e+01 4.39316788e+01 4.39321480e+01 4.39005852e+01
 4.38997269e+01 4.38997269e+01 4.39125175e+01 4.39090385e+01
 4.39090385e+01 4.39042854e+01 4.38999062e+01 4.38999062e+01
 4.38622551e+01 4.38548889e+01 4.38548889e+01 4.38547630e+01
 4.38547630e+01 4.39222336e+01 4.39182777e+01 4.39182777e+01
 4.39093857e+01 4.37769966e+01 4.37769966e+01 4.37600708e+01
 4.38595276e+01 4.38595276e+01 4.35898438e+01 4.35898438e+01
 4.38605156e+01 4.38605156e+01 4.37588882e+01 4.38589821e+01
 4.38589821e+01 4.38064041e+01 4.38421135e+01 4.38421135e+01
 4.38390427e+01 4.38390427e+01 4.37020340e+01 4.37020340e+01
 4.36978378e+01 4.37189522e+01 4.37189522e+01 4.37165184e+01
 4.37165184e+01 4.37154083e+01 4.37685776e+01 4.37445183e+01
 4.37443466e+01 4.38889160e+01 4.38849182e+01 4.38849182e+01
 4.39180870e+01 4.39180870e+01 4.38895493e+01 4.38421364e+01
 4.38421783e+01 4.38874855e+01 4.38874855e+01 4.38857841e+01
 4.38391991e+01 4.38391991e+01 4.39064713e+01 4.39064713e+01
 4.38854866e+01 4.37442474e+01 4.37445869e+01 7.06861973e+00
 7.16147709e+00 4.40140686e+01 4.35527420e+01 4.35527420e+01
 4.37068901e+01 4.37068901e+01 6.93911493e-01 4.37830772e+01
 4.37556953e+01 4.37556953e+01 4.37149315e+01 4.37149315e+01
 4.37766609e+01 4.37766609e+01 4.37444382e+01 4.38839645e+01
 4.38839645e+01 4.37451248e+01 4.37451248e+01 7.08522129e+00
 8.68733582e+02 7.12235689e+00 7.11984682e+00 4.37137032e+01
 4.38243256e+01 4.35674667e+01 4.38065796e+01 4.38343697e+01
 4.38849640e+01 4.38363266e+01 4.38245049e+01 4.37224617e+01
 4.36634369e+01 4.37345161e+01 4.38247070e+01 4.38357086e+01
 4.38243408e+01 4.38243752e+01 4.37843704e+01 4.39694252e+01
 4.38044853e+01 4.37292595e+01 4.39347916e+01 4.38964920e+01
 4.36692352e+01 4.41306190e+01 4.41306190e+01 4.36645508e+01
 4.39076843e+01 1.35870838e+01 1.46795654e+00 5.78187790e+01
 5.78187790e+01 4.55631943e+01 6.98668814e+00 4.34311104e+01
 4.39785461e+01 4.39619865e+01 6.99405622e+00 4.39429817e+01
 4.40902977e+01 4.41628876e+01 4.38379021e+01 4.38356018e+01
 4.38356018e+01 4.39771271e+01 4.39714241e+01 4.37924576e+01
 4.39554100e+01 4.38307724e+01 4.38367653e+01 4.38367653e+01
 4.39518776e+01 4.39426689e+01 4.39409599e+01 4.39409599e+01
 1.04988365e+01 4.39192886e+01 4.39135056e+01 4.39135056e+01
 4.38754578e+01 4.39322052e+01 4.39322052e+01 4.39321289e+01
 4.38033028e+01 4.38033028e+01 4.38013496e+01 4.38142509e+01
 4.38142509e+01 4.38066025e+01 4.38748627e+01 4.38748627e+01
 4.38415756e+01 4.38955536e+01 4.38955536e+01 4.39212723e+01
 4.39212723e+01 4.39217606e+01 4.37714767e+01 4.37714767e+01
 4.37550507e+01 4.39183846e+01 4.39183846e+01 4.42357750e+01
 4.42357750e+01 4.35408974e+01 4.35453606e+01 4.38365364e+01
 4.38378792e+01 4.38534241e+01 4.35411339e+01 4.35502625e+01
 4.35502625e+01 4.38467484e+01 4.38198166e+01 4.38198166e+01
 4.38623505e+01 4.37116623e+01 4.37191200e+01 4.37191200e+01
 4.40259895e+01 4.40272598e+01 4.37403755e+01 4.37403755e+01
 4.38533211e+01 4.40118484e+01 4.40170708e+01 4.38620987e+01
 4.40394478e+01 4.40439377e+01 4.39085007e+01 4.39004021e+01
 4.39004021e+01 4.39051514e+01 4.39015350e+01 4.39015350e+01
 4.39055519e+01 4.39152107e+01 4.39023933e+01 4.39023933e+01
 4.39293671e+01 4.39249268e+01 4.39249268e+01 4.39195175e+01
 4.39047890e+01 4.39011803e+01 4.39011803e+01 4.38569527e+01
 4.37888641e+01 4.37791595e+01 4.37791595e+01 4.35885773e+01
 4.36115646e+01 4.36296043e+01 4.36296043e+01 4.38533745e+01
 4.37360153e+01 4.37360153e+01 4.39122429e+01 4.39122429e+01
 4.39094086e+01 4.37883911e+01 4.37883224e+01 4.37883224e+01
 1.13377333e+01 4.38744316e+01 4.38564377e+01 4.37963791e+01
 4.37926521e+01 4.37926521e+01 4.37156715e+01 4.37179947e+01
 4.37172432e+01 4.37172432e+01 4.38620987e+01 4.38316765e+01
 4.38352280e+01 4.38352280e+01 4.36978378e+01 4.37050667e+01
 4.38075867e+01 4.38075867e+01 4.38533058e+01 4.38562393e+01
 4.38370972e+01 4.38819160e+01 4.37707024e+01 4.37713242e+01
 4.37713242e+01 4.35725479e+01 4.35775185e+01 4.36352844e+01
 4.36352844e+01 7.06961060e+00 4.37589340e+01 4.38532867e+01
 4.38823929e+01 4.37604866e+01 4.38533058e+01 4.40258942e+01
 4.40279236e+01 4.38857765e+01 4.39307747e+01 4.39092255e+01
 4.39092026e+01 4.37659416e+01 4.37576027e+01 4.37576027e+01
 4.38388443e+01 4.39348488e+01 4.39038849e+01 4.39038849e+01
 4.36558571e+01 4.36587906e+01 4.36587906e+01 4.38914986e+01
 4.38905716e+01 4.38905716e+01 4.40307312e+01 4.37057495e+01
 4.37158127e+01 4.37158127e+01 4.37206993e+01 4.37206993e+01
 4.35582428e+01 4.35654526e+01 4.35654526e+01 4.39854546e+01
 4.38863297e+01 4.38863297e+01 7.08520031e+00 4.40595627e+01
 4.40003510e+01 4.40021744e+01 4.38459282e+01 4.38467216e+01
 4.39063911e+01 4.39031410e+01 4.39031410e+01 4.38891945e+01
 4.38854446e+01 4.38854446e+01 4.38899231e+01 4.38858604e+01
 4.38858604e+01 4.38895264e+01 4.38848686e+01 4.38848686e+01
 4.39125404e+01 4.39126358e+01 4.39622803e+01 4.39691887e+01
 4.39691887e+01 4.36408348e+01 4.36713562e+01 4.36427994e+01
 4.36427994e+01 4.37655487e+01 4.37563515e+01 4.37563515e+01
 4.39288368e+01 4.37151031e+01 4.37244949e+01 4.37244949e+01
 4.40003510e+01 4.40021172e+01 4.38423500e+01 4.40627365e+01
 4.40636330e+01 4.38405762e+01 4.39183197e+01 4.42734337e+01
 4.42734337e+01 4.38891602e+01 4.38857346e+01 4.38857346e+01
 4.37844505e+01 4.38884163e+01 4.38871078e+01 4.38871078e+01
 4.38550835e+01 4.38562508e+01 4.38455238e+01 4.38455238e+01
 4.37444305e+01 4.38906441e+01 4.38866730e+01 4.38866730e+01
 4.37057457e+01 4.37214050e+01 4.37214050e+01 4.36921654e+01
 4.36936378e+01 4.36936378e+01 4.39046669e+01 4.38957024e+01
 4.38957024e+01 4.38248787e+01 7.12128162e+00 4.39942627e+01
 4.39917717e+01 4.39917717e+01 4.38888092e+01 4.37579956e+01
 4.37563286e+01 4.37563286e+01 4.38389435e+01 4.39093132e+01
 7.12128162e+00 7.12128162e+00 7.07385635e+00 4.38889465e+01
 4.38859787e+01 4.38859787e+01 4.38844147e+01 4.37486343e+01
 4.38602982e+01 4.38602982e+01 4.38389206e+01 4.37806511e+01
 4.37794800e+01 4.37794800e+01 7.06661701e+00 4.40146408e+01
 4.40371933e+01 7.83848953e+00 4.39128494e+01 4.37446365e+01
 4.38618050e+01 4.37501221e+01 4.37501221e+01 4.38431435e+01
 4.38431435e+01 4.38470306e+01 4.39304123e+01 4.38392258e+01
 4.40793495e+01 4.38994751e+01 4.38325157e+01 4.38333244e+01
 4.38984528e+01 4.38553276e+01 4.38272781e+01 4.38216438e+01
 4.38216438e+01 4.38985634e+01 4.38391418e+01 4.38391418e+01
 4.37058449e+01 4.37058449e+01 4.38214378e+01 4.38214378e+01
 4.38684540e+01 4.38684540e+01 4.38289452e+01 4.38289452e+01
 4.37157516e+01 4.37157516e+01 4.99145412e+00 5.06729698e+00
 4.40702782e+01 4.40857391e+01 4.40857391e+01 4.40710640e+01
 7.13495541e+00 4.39123077e+01 7.02380371e+00 5.78332253e+01
 1.47707427e+00 4.55852394e+01 6.98997593e+00 4.33901634e+01
 4.41559296e+01 4.41577110e+01 4.41372643e+01 4.41899948e+01
 4.39736404e+01 4.40330887e+01 4.39708748e+01 4.39689445e+01
 4.38629417e+01 4.41720848e+01 4.39691124e+01 4.38981857e+01
 4.37200279e+01 4.38278313e+01 4.38278313e+01 4.37178154e+01
 4.38975830e+01 4.44823532e+01 4.40227737e+01 7.33668232e+00
 7.63118458e+00 4.38633804e+01 4.40423546e+01 4.39315834e+01
 4.41063156e+01 4.41097565e+01 7.43999195e+00 1.29909210e+01
 7.20330811e+00 4.39246521e+01 4.39246521e+01 4.42560120e+01
 4.40675850e+01 4.38998528e+01 4.38998528e+01 4.41448212e+01
 4.42833099e+01 4.40624847e+01 4.40933876e+01 4.39627075e+01
 4.38510361e+01 4.39461555e+01 4.40365868e+01 4.38264656e+01
 4.38345146e+01 4.38345146e+01 4.38299789e+01 4.40007744e+01
 1.08814545e+01 4.38734818e+01 4.40130310e+01 4.38358765e+01
 4.40831757e+01 4.40919800e+01 4.38661995e+01 4.38356476e+01
 4.39280281e+01 4.39280281e+01 4.39476318e+01 4.40696945e+01
 5.35226135e+02 4.38376770e+01 4.39220848e+01 4.39220848e+01
 4.39567070e+01 4.39703407e+01 4.39703407e+01 4.39742851e+01
 4.38092384e+01 4.39839821e+01 4.41182899e+01 4.40191231e+01
 4.40414581e+01 4.38645897e+01 4.38878365e+01 4.38878365e+01
 4.38602600e+01 4.40208626e+01 4.38095055e+01 4.38608246e+01
 4.38672295e+01 4.38672295e+01 4.39049797e+01 4.39402962e+01
 4.39018517e+01 4.39542313e+01 4.39542313e+01 4.39537697e+01
 4.38206520e+01 4.38206520e+01 4.38038445e+01 4.37994804e+01
 4.37994804e+01 4.38012810e+01 4.39080925e+01 4.39080925e+01
 4.38808174e+01 4.38708649e+01 4.37960243e+01 4.37989044e+01
 4.38770065e+01 4.38770065e+01 4.38557625e+01 4.38427544e+01
 4.38427544e+01 4.38500786e+01 4.39540939e+01 4.39540939e+01
 4.39571419e+01 4.38416786e+01 4.38416786e+01 4.38373756e+01
 4.38430481e+01 4.38430481e+01 4.38376999e+01 4.38319664e+01
 4.39567223e+01 4.39567223e+01 4.39628792e+01 4.37950859e+01
 4.38394203e+01 4.37949104e+01 4.37967491e+01 4.38201981e+01
 4.39654083e+01 4.39617920e+01 4.39617920e+01 4.38198051e+01
 4.38204689e+01 4.38262367e+01 4.38894119e+01 4.37923317e+01
 4.37923317e+01 4.39871902e+01 4.39877586e+01 4.37832451e+01
 4.37864342e+01 4.39339066e+01 4.39329872e+01 4.39329872e+01
 4.37830849e+01 4.38156509e+01 4.39286270e+01 4.37988701e+01
 4.37820663e+01 4.37836456e+01 4.37996750e+01 4.39344482e+01
 4.37804489e+01 4.37851830e+01 4.37805824e+01 4.37828407e+01
 4.39581108e+01 4.37804298e+01 4.39530334e+01 4.38954964e+01
 4.39328499e+01 4.39323578e+01 4.39323578e+01 4.37060966e+01
 4.37801514e+01 4.81635475e+01 4.37814636e+01 4.39308815e+01
 4.37809525e+01 4.37906456e+01 4.37804489e+01 4.37806244e+01
 4.37803879e+01 4.39323158e+01 4.39361801e+01 4.39361801e+01
 4.38180389e+01 4.37809944e+01 4.40657196e+01 4.37804604e+01
 4.38023071e+01 4.37723999e+01 4.38735847e+01 4.38934021e+01
 4.38934021e+01 1.24666901e+01 1.44908047e+00 5.80275917e+01
 1.44837618e+00 4.57508965e+01 4.35382614e+01 6.98700523e+00
 5.80271072e+01 5.35226135e+02 5.35226013e+02 1.24814014e+01
 1.25376587e+01]
2025-06-02 15:52:23,965 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155223_update_15.json
2025-06-02 15:52:23,965 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:52:23,969 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155223_update_15.pth and as latest_checkpoint.pth
2025-06-02 15:52:23,969 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869545.dot): 0.4418
2025-06-02 15:52:23,969 - WARNING - Detected 4 anomalous nodes (reconstruction-based):
2025-06-02 15:52:23,970 - WARNING -   Node ID: 192.168.27.10, Recon Error: 19.4102, MLP Score: 0.9313
2025-06-02 15:52:23,970 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 20.3764, MLP Score: 0.9480
2025-06-02 15:52:23,970 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 20.5451, MLP Score: 0.9669
2025-06-02 15:52:23,970 - WARNING -   Node ID: fe80::a425:e54:93a8:261c, Recon Error: 19.5492, MLP Score: 0.9504
2025-06-02 15:52:23,970 - WARNING - Detected 6 anomalous edges (reconstruction-based):
2025-06-02 15:52:23,970 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2260, MLP Score: 0.0000
2025-06-02 15:52:23,970 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9279, MLP Score: 0.0000
2025-06-02 15:52:23,970 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7336, MLP Score: 0.0000
2025-06-02 15:52:23,970 - WARNING -   Source: 192.168.27.10, Target: 224.0.0.251, Recon Error: 535.2261, MLP Score: 0.0000
2025-06-02 15:52:23,970 - WARNING -   Source: fe80::eb4e:a54d:8c61:6ce1, Target: ff02::fb, Recon Error: 535.2261, MLP Score: 0.0000
2025-06-02 15:52:23,970 - INFO - 
--- Processing file: nw_graph_encoded_1748869575.dot (Timestamp: 2025-06-02 15:06:15) ---
2025-06-02 15:52:23,970 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869575.dot
2025-06-02 15:52:23,970 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869575.dot'.
2025-06-02 15:52:23,970 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869575.dot
2025-06-02 15:52:23,983 - INFO - Parsed 419 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869575.dot'.
2025-06-02 15:52:23,997 - INFO - Parsed 833 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869575.dot'.
2025-06-02 15:52:23,997 - INFO - Processing node updates/additions.
2025-06-02 15:52:24,000 - INFO - Processing edge updates/additions.
2025-06-02 15:52:24,007 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:52:24,008 - INFO - Finished updating NetworkX graph.
2025-06-02 15:52:24,008 - DEBUG - Updated graph - Nodes: 419, Edges: 833
2025-06-02 15:52:24,009 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:52:24,010 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:52:24,016 - DEBUG - Initial node features tensor shape: torch.Size([419, 30])
2025-06-02 15:52:24,020 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:52:24,021 - DEBUG - Node features tensor shape after scaling: torch.Size([419, 30])
2025-06-02 15:52:24,022 - DEBUG - Edge index tensor shape: torch.Size([2, 833])
2025-06-02 15:52:24,023 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:52:24,026 - DEBUG - Initial edge attributes tensor shape: torch.Size([833, 10])
2025-06-02 15:52:24,028 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:52:24,028 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([833, 10])
2025-06-02 15:52:24,029 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:52:24,029 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:52:24,029 - INFO - Updated main graph to 419 nodes and 833 edges.
2025-06-02 15:52:24,029 - INFO - Performing online update...
2025-06-02 15:52:24,030 - INFO - Starting online update for 50 steps.
2025-06-02 15:52:24,030 - DEBUG - Updated RunningStats: new_mean=0.942592642323526, new_var=43800000000160.59, new_n=4410
2025-06-02 15:52:24,030 - DEBUG - Updated RunningStats: new_mean=0.941236176694861, new_var=44100000000019.16, new_n=4440
2025-06-02 15:52:24,031 - DEBUG - Updated RunningStats: new_mean=43.53422246651454, new_var=14600000191343.209, new_n=1470
2025-06-02 15:52:24,031 - DEBUG - Updated RunningStats: new_mean=43.600522849196025, new_var=14700000249667.518, new_n=1480
2025-06-02 15:52:24,031 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:52:24,031 - DEBUG - Online update step: 1/50
2025-06-02 15:52:24,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,031 - DEBUG - Online update step: 2/50
2025-06-02 15:52:24,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,031 - DEBUG - Online update step: 3/50
2025-06-02 15:52:24,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,031 - DEBUG - Online update step: 4/50
2025-06-02 15:52:24,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,031 - DEBUG - Online update step: 5/50
2025-06-02 15:52:24,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,031 - DEBUG - Online update step: 6/50
2025-06-02 15:52:24,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,031 - DEBUG - Online update step: 7/50
2025-06-02 15:52:24,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,032 - DEBUG - Online update step: 8/50
2025-06-02 15:52:24,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,032 - DEBUG - Online update step: 9/50
2025-06-02 15:52:24,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,032 - DEBUG - Online update step: 10/50
2025-06-02 15:52:24,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,032 - DEBUG - Online update step: 11/50
2025-06-02 15:52:24,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,032 - DEBUG - Online update step: 12/50
2025-06-02 15:52:24,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,032 - DEBUG - Online update step: 13/50
2025-06-02 15:52:24,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,032 - DEBUG - Online update step: 14/50
2025-06-02 15:52:24,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,032 - DEBUG - Online update step: 15/50
2025-06-02 15:52:24,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,032 - DEBUG - Online update step: 16/50
2025-06-02 15:52:24,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,032 - DEBUG - Online update step: 17/50
2025-06-02 15:52:24,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,032 - DEBUG - Online update step: 18/50
2025-06-02 15:52:24,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,032 - DEBUG - Online update step: 19/50
2025-06-02 15:52:24,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,032 - DEBUG - Online update step: 20/50
2025-06-02 15:52:24,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,032 - DEBUG - Online update step: 21/50
2025-06-02 15:52:24,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,032 - DEBUG - Online update step: 22/50
2025-06-02 15:52:24,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,033 - DEBUG - Online update step: 23/50
2025-06-02 15:52:24,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,033 - DEBUG - Online update step: 24/50
2025-06-02 15:52:24,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,033 - DEBUG - Online update step: 25/50
2025-06-02 15:52:24,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,033 - DEBUG - Online update step: 26/50
2025-06-02 15:52:24,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,033 - DEBUG - Online update step: 27/50
2025-06-02 15:52:24,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,033 - DEBUG - Online update step: 28/50
2025-06-02 15:52:24,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,033 - DEBUG - Online update step: 29/50
2025-06-02 15:52:24,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,033 - DEBUG - Online update step: 30/50
2025-06-02 15:52:24,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,033 - DEBUG - Online update step: 31/50
2025-06-02 15:52:24,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,033 - DEBUG - Online update step: 32/50
2025-06-02 15:52:24,034 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,034 - DEBUG - Online update step: 33/50
2025-06-02 15:52:24,034 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,034 - DEBUG - Online update step: 34/50
2025-06-02 15:52:24,034 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,034 - DEBUG - Online update step: 35/50
2025-06-02 15:52:24,034 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,034 - DEBUG - Online update step: 36/50
2025-06-02 15:52:24,034 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,034 - DEBUG - Online update step: 37/50
2025-06-02 15:52:24,035 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,035 - DEBUG - Online update step: 38/50
2025-06-02 15:52:24,035 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,035 - DEBUG - Online update step: 39/50
2025-06-02 15:52:24,035 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,035 - DEBUG - Online update step: 40/50
2025-06-02 15:52:24,035 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,035 - DEBUG - Online update step: 41/50
2025-06-02 15:52:24,036 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,036 - DEBUG - Online update step: 42/50
2025-06-02 15:52:24,036 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,036 - DEBUG - Online update step: 43/50
2025-06-02 15:52:24,036 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,036 - DEBUG - Online update step: 44/50
2025-06-02 15:52:24,036 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,036 - DEBUG - Online update step: 45/50
2025-06-02 15:52:24,036 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,037 - DEBUG - Online update step: 46/50
2025-06-02 15:52:24,037 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,038 - DEBUG - Online update step: 47/50
2025-06-02 15:52:24,038 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,038 - DEBUG - Online update step: 48/50
2025-06-02 15:52:24,038 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,038 - DEBUG - Online update step: 49/50
2025-06-02 15:52:24,038 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,038 - DEBUG - Online update step: 50/50
2025-06-02 15:52:24,038 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:24,039 - WARNING - No successful steps during online update.
2025-06-02 15:52:24,041 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -6.9420210e-08  4.7797521e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.8693230e-08
  9.1042898e-09 -1.5932507e-08  9.1042898e-09 -1.8208580e-08
  2.4582338e+00  2.9427207e+00  1.4081146e-01  4.3436756e+00
  1.5932507e-08  3.4797137e+00  5.6467781e+00  7.6062055e+00
  1.4081146e-01  8.0000000e+00 -2.2760724e-09  2.0484650e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.6174831e-08 -2.2760723e-08], current edge mean: [ 6.8692025e-09  4.6100961e+02  0.0000000e+00  0.0000000e+00
 -5.7243355e-10  2.2897342e-09 -2.2897342e-09  8.0140703e-09
  0.0000000e+00 -5.7243355e-10]
2025-06-02 15:52:24,041 - DEBUG - Node drift difference: 0.0666, Edge drift difference: 0.0078
2025-06-02 15:52:24,045 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -6.9420210e-08  4.7797521e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.8693230e-08
  9.1042898e-09 -1.5932507e-08  9.1042898e-09 -1.8208580e-08
  2.4582338e+00  2.9427207e+00  1.4081146e-01  4.3436756e+00
  1.5932507e-08  3.4797137e+00  5.6467781e+00  7.6062055e+00
  1.4081146e-01  8.0000000e+00 -2.2760724e-09  2.0484650e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.6174831e-08 -2.2760723e-08], edge=[ 6.8692025e-09  4.6100961e+02  0.0000000e+00  0.0000000e+00
 -5.7243355e-10  2.2897342e-09 -2.2897342e-09  8.0140703e-09
  0.0000000e+00 -5.7243355e-10]
2025-06-02 15:52:24,046 - DEBUG - Updated reference std: node=[0.        0.        1.0011954 1.0011954 0.        0.        0.
 1.0011954 1.0011954 1.0011954 1.0011954 1.0011954 1.0142751 0.3339817
 0.3747156 0.5714724 1.0011954 3.1244435 2.942724  1.5043986 0.3747156
 0.        1.0011954 1.0011955 0.        0.        0.        0.
 1.0011954 1.0011955], edge=[  1.0006008 526.4626      0.          0.          1.0006008   1.0006007
   1.0006008   1.0006008   1.0006008   1.0006008]
2025-06-02 15:52:24,046 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:52:24,047 - INFO - Running anomaly detection...
2025-06-02 15:52:24,048 - INFO - Starting anomaly detection.
2025-06-02 15:52:24,063 - DEBUG - Node reconstruction errors: [16.21927   10.003611  14.9694    15.916549  10.11553    8.202987
 14.9694    12.269364  12.269364  12.732248  12.269364  10.840667
 19.48922    8.588314  14.839992  16.154997  11.519511  16.167261
 16.754667  15.625225  11.980783  14.839988  12.20008   10.725938
 14.89543   12.364782  14.89543    9.514444  11.746131  14.89543
 10.375667  12.200019   8.98619   15.361297  12.364779  15.7530575
  8.948202  15.625228  10.730524  16.274708  15.316854  14.431858
 15.625228  16.456385  15.775972  12.569189  17.774405   8.70097
 11.366242  16.074657  20.822302  12.042175  11.986738  16.194542
 11.447176  10.461566  16.614067  14.997458  15.291962  15.291963
  7.34462   15.547468  14.14963    9.955827  14.073258  11.447176
 11.748428  11.447177  14.149632  14.149632  11.215313   8.043578
 11.735866   7.3022833  7.0850596  8.162146  14.911383   8.065498
  7.236386   7.1360044 14.393504   8.517297   9.056613  11.827633
 10.252387   9.993876   8.574443   7.206596   6.9541626  8.543133
 14.083346   8.096366   9.584925   7.0992837 11.66219   21.117716
 14.289276   8.168552  14.129444  10.926547   8.168551  14.289274
 14.880061   8.002323   8.811565  10.802891  14.871602   7.0607023
  9.721658  13.441186  13.597882  14.728862   9.671132   9.6750965
  8.425695   8.168581   8.284245   8.074724   7.119276  11.64125
 14.301409   9.584925   9.516093   9.584925   6.8468413 12.07819
  9.707979   7.5158343  8.1685505 14.485164  11.888174  11.37796
 14.657073   9.735943   8.168552  10.802891  14.942367  13.889904
 11.37796    8.1685505 11.065094   8.518953  13.8167925 11.37796
 11.37796    8.168554   8.284245  11.065094  11.431036   7.05066
 12.755762   8.811573   7.0358863 11.37796    6.8981543  8.127499
 11.64125    8.526095   8.1685505 14.613339  11.065094   7.193797
 11.64125   11.888174   8.284244   9.720078   8.124278   7.1192775
  7.170015   8.168551   7.050659  11.18886   13.8167925 16.179518
  7.1192765 10.274802   7.119277   8.353422   8.197122   8.197125
 10.834988   9.055806  14.335786   9.126558   9.532347   8.197136
 14.046248   8.270173  14.046248  11.112747   7.220523   6.9498625
 11.549916  11.18886   14.301409  11.549916  14.230565  14.573434
  8.126726  14.289274  13.889904  11.065094   9.399084   7.119276
  8.092707  15.094404  11.592961  10.059428  14.426862   7.1046677
  8.427759   8.197124  11.549917   7.1819143  8.1971245 13.8167925
  8.197126   8.2842455  8.143467  11.18886    9.121851  14.304137
 13.820922  11.549916  11.065094   6.9816203  8.19713   11.065094
  7.123316  15.094404   9.23898    8.197124   8.1685505  8.284245
  8.284245  11.549917   7.1233163 13.820922  11.065094  14.485164
  7.9898005  7.1046677 11.112747   8.2842455 11.112745   8.168551
  8.197188   7.825837  11.112747  11.357802  13.8167925 13.8167925
  8.143468   7.05066    8.0543     8.0543    11.112747  13.910875
 13.820922   8.197123   7.11201    8.63309   15.089559  11.112747
  7.123317  11.298072   6.886398  15.089559   6.886399   8.1971245
  9.813512   9.532347   7.0055947 14.72622    8.1834545  8.197124
 13.820922   7.395127  10.834988   8.197124   6.9266276 13.983942
  7.1233225 14.679205  11.112747  14.384246   9.363139   7.1957626
  9.055806   9.230362  11.298162  14.317555  11.715729  11.112747
 14.255141  13.910875   8.1971245  8.198459  11.549916  14.682236
  8.351269  13.977443   8.343584  13.977443  13.977443  13.977443
 13.977443   8.189936  13.977443  13.977443  13.977443   8.189939
 13.977443  11.924511   9.07579    7.265558   8.344714  14.967217
 11.7127075 11.744188   7.183515  13.910875   6.87494    8.343581
 13.820922   7.0767055 14.163596   8.189935   7.1120086  7.1120086
  7.196599  11.712708  13.977443   8.183454  13.977443   8.189935
 11.297291  13.820922  14.163596  14.163596  13.977443  14.255157
 14.163596   7.1120086  8.343584   6.8864     8.343583  14.5115795
  6.8412824  8.6123495 13.977443   8.197123  15.098619   7.890132
 14.494125  11.549916  13.977443  13.977443  13.910875  13.910875
  7.825837  13.977443  14.163596  13.977443  13.977443  20.028984
 14.102065   7.890132  11.297291  13.886187   9.947711  11.297291
 11.297291  11.297291   7.2430058 13.977443  13.886202  11.333364
  6.977037  13.977443  11.3333645 11.297291  11.297291  14.276983
 11.297291   7.890132  11.001986   8.500903   7.8471494 13.977443
 12.058602   7.89013   13.961834  11.54718    8.082869   8.082871
  8.082869  15.470608  14.032896  15.470608  11.54718   11.917705
  8.082869  14.032897  13.961835  11.54718    6.9963384 11.281966
 11.917705  13.886187   8.082871  11.54718   14.032897   8.082871
  8.082869  14.262441  14.3199835  8.082869  13.8861885]
2025-06-02 15:52:24,070 - DEBUG - Edge reconstruction errors: [4.49251175e+00 4.64594603e+00 6.98795080e+00 4.33994942e+01
 1.48104274e+00 1.32548151e+01 4.39912987e+01 4.39789200e+01
 4.38970146e+01 6.99858809e+00 4.40389328e+01 4.40404778e+01
 4.41015778e+01 4.39704590e+01 4.38239479e+01 4.38305511e+01
 4.38347015e+01 4.38318901e+01 4.38318901e+01 1.01237335e+01
 7.18219709e+00 7.18566227e+00 4.38606987e+01 4.41004791e+01
 4.43130836e+01 4.40613060e+01 4.40629578e+01 4.39334602e+01
 4.39525299e+01 4.37065315e+01 4.37172470e+01 4.37219238e+01
 4.37219238e+01 4.37206573e+01 4.37318878e+01 4.37318878e+01
 4.37243423e+01 4.39404297e+01 4.39390450e+01 4.39390450e+01
 4.39529953e+01 4.38018875e+01 4.39701004e+01 4.39112091e+01
 4.39666405e+01 4.39666405e+01 4.39158897e+01 4.39121208e+01
 4.39121208e+01 4.37861481e+01 4.37832489e+01 4.37832489e+01
 4.42120972e+01 4.39064865e+01 7.16381025e+00 7.17085171e+00
 4.38747940e+01 4.40376320e+01 4.39351616e+01 4.39248810e+01
 4.39248810e+01 4.37593803e+01 5.35230530e+02 7.18890285e+00
 7.16097736e+00 4.37797432e+01 4.37956085e+01 4.37956085e+01
 4.37254486e+01 4.37318420e+01 4.37262955e+01 4.37262955e+01
 8.08932068e+02 4.34229889e+01 4.40791588e+01 4.41063881e+01
 4.37986908e+01 4.37773399e+01 4.37773399e+01 4.38829308e+01
 4.39599342e+01 4.39058304e+01 4.39058304e+01 4.39161606e+01
 4.39169235e+01 4.39169235e+01 1.13455429e+01 4.39046516e+01
 4.38987274e+01 4.38987274e+01 4.39929810e+01 4.39070816e+01
 4.39070816e+01 4.38975029e+01 4.39016647e+01 4.37593880e+01
 4.39764977e+01 4.39789429e+01 4.39789429e+01 4.38937263e+01
 4.39074020e+01 4.39050407e+01 4.39050407e+01 4.39352570e+01
 4.38678818e+01 4.39047928e+01 4.39059219e+01 4.39059219e+01
 4.37959900e+01 4.38149986e+01 4.37982864e+01 4.37982864e+01
 7.07421350e+00 4.38123131e+01 4.37829781e+01 4.37829781e+01
 4.40486145e+01 4.40562973e+01 4.38993073e+01 4.38991470e+01
 4.39334412e+01 4.39334412e+01 4.39338760e+01 4.39051285e+01
 4.39043541e+01 4.39043541e+01 4.39151649e+01 4.39121590e+01
 4.39121590e+01 4.39081955e+01 4.39044724e+01 4.39044724e+01
 4.38640366e+01 4.39119263e+01 4.39119263e+01 4.39171219e+01
 4.39118080e+01 4.39118080e+01 4.39151230e+01 4.39210434e+01
 4.39198380e+01 4.39198380e+01 4.39125061e+01 4.37786789e+01
 4.37786789e+01 4.37795906e+01 4.37602882e+01 4.38703651e+01
 4.38703651e+01 4.36052742e+01 4.36052742e+01 4.38762474e+01
 4.38762474e+01 4.38726463e+01 4.38326035e+01 4.38750725e+01
 4.38750725e+01 4.38724785e+01 4.38087807e+01 4.38493729e+01
 4.38493729e+01 4.38891563e+01 4.38891563e+01 4.38898773e+01
 4.37061996e+01 4.37061996e+01 4.37025261e+01 4.37040901e+01
 4.37608833e+01 4.37608833e+01 4.37602005e+01 4.37191162e+01
 4.37191162e+01 4.37181244e+01 4.37976875e+01 4.37688980e+01
 4.37685204e+01 4.38922043e+01 4.38887558e+01 4.38887558e+01
 4.39118195e+01 4.39118195e+01 4.38927803e+01 4.38455200e+01
 4.38455620e+01 4.38910561e+01 4.38910561e+01 4.38895149e+01
 4.38993835e+01 4.38993835e+01 4.38993759e+01 4.39036407e+01
 4.39036407e+01 4.38892937e+01 4.37453346e+01 4.37456093e+01
 7.06481791e+00 7.15466261e+00 4.40155373e+01 4.35767670e+01
 4.35767670e+01 4.36996613e+01 4.36996613e+01 6.88382626e-01
 4.37784996e+01 4.37592812e+01 4.37592812e+01 4.37188530e+01
 4.37188530e+01 4.37533646e+01 4.37533646e+01 4.37455177e+01
 4.38869514e+01 4.38869514e+01 4.37534523e+01 4.37534523e+01
 7.07987642e+00 8.68737000e+02 7.12328911e+00 7.12109327e+00
 4.37733688e+01 4.38284454e+01 4.35703735e+01 4.38077621e+01
 4.38357468e+01 4.38624725e+01 4.38380623e+01 4.38285828e+01
 4.37267761e+01 4.36629295e+01 4.37341728e+01 4.38287849e+01
 4.38391762e+01 4.38284607e+01 4.38284874e+01 4.37841110e+01
 4.39687500e+01 4.38108177e+01 4.37535095e+01 4.39375305e+01
 4.39695587e+01 4.38482590e+01 4.39592323e+01 4.37318001e+01
 4.37311974e+01 7.05916405e+00 4.39126244e+01 6.99479342e+00
 4.38985672e+01 4.36653290e+01 4.42091599e+01 4.42091599e+01
 4.36616096e+01 4.39068947e+01 1.49196129e+01 1.48104274e+00
 5.78509750e+01 5.78509750e+01 4.55911446e+01 7.00060749e+00
 4.34598656e+01 4.39803123e+01 4.39649811e+01 6.99857092e+00
 4.39711075e+01 4.40933914e+01 4.41510735e+01 4.38346863e+01
 4.38327103e+01 4.38327103e+01 4.39732513e+01 4.39703560e+01
 4.37914047e+01 4.39703178e+01 4.38348961e+01 4.38401756e+01
 4.38401756e+01 4.39547653e+01 4.39464226e+01 4.39450035e+01
 4.39450035e+01 1.00683270e+01 4.39231415e+01 4.39186630e+01
 4.39186630e+01 4.39425621e+01 4.39338989e+01 4.39338989e+01
 4.39338570e+01 4.38075638e+01 4.38075638e+01 4.38060722e+01
 4.38150940e+01 4.38150940e+01 4.38088379e+01 4.38626747e+01
 4.38626747e+01 4.38392982e+01 4.39002876e+01 4.39002876e+01
 4.39264107e+01 4.39264107e+01 4.39267044e+01 4.37734718e+01
 4.37734718e+01 4.37598190e+01 4.39123611e+01 4.39123611e+01
 4.40623856e+01 4.40623856e+01 4.35548401e+01 4.35636292e+01
 4.38372612e+01 4.38381729e+01 4.39138908e+01 4.35682678e+01
 4.35758820e+01 4.35758820e+01 4.35742073e+01 4.38298836e+01
 4.38083496e+01 4.38083496e+01 4.40522804e+01 4.40546913e+01
 4.36936264e+01 4.36999855e+01 4.36999855e+01 4.36978836e+01
 4.40522804e+01 4.40636330e+01 4.37465515e+01 4.37465515e+01
 4.39774475e+01 4.40099945e+01 4.40263138e+01 4.40520515e+01
 4.40541077e+01 4.40594521e+01 4.40677757e+01 4.39118919e+01
 4.39049187e+01 4.39049187e+01 4.39089622e+01 4.39058914e+01
 4.39058914e+01 4.39025345e+01 4.39176826e+01 4.39067192e+01
 4.39067192e+01 4.39457817e+01 4.39362106e+01 4.39362106e+01
 4.39428368e+01 4.39084930e+01 4.39056091e+01 4.39056091e+01
 4.39184151e+01 4.37894058e+01 4.37827110e+01 4.37827110e+01
 4.36042366e+01 4.36320763e+01 4.36342354e+01 4.36342354e+01
 4.39164391e+01 4.37442169e+01 4.37442169e+01 4.39148827e+01
 4.39148827e+01 4.39125214e+01 4.37905769e+01 4.37903786e+01
 4.37903786e+01 1.13455429e+01 4.38766327e+01 4.38559570e+01
 4.37969780e+01 4.38043480e+01 4.38043480e+01 4.37168121e+01
 4.37187195e+01 4.37182007e+01 4.37182007e+01 4.38638878e+01
 4.38208313e+01 4.38223228e+01 4.38223228e+01 4.37025261e+01
 4.37083969e+01 4.37799683e+01 4.37799683e+01 4.38567505e+01
 4.38592873e+01 4.38378067e+01 4.38759270e+01 4.37766342e+01
 4.37771645e+01 4.37771645e+01 4.35752525e+01 4.35794373e+01
 4.36199493e+01 4.36199493e+01 7.06603384e+00 4.37593346e+01
 4.38567314e+01 4.38834648e+01 4.37604866e+01 4.38567505e+01
 4.40278969e+01 4.40296631e+01 4.38863792e+01 4.39312096e+01
 4.39126511e+01 4.39126282e+01 4.37781181e+01 4.37759018e+01
 4.37759018e+01 4.38426933e+01 4.39357681e+01 4.39093704e+01
 4.39093704e+01 4.36567192e+01 4.36591530e+01 4.36591530e+01
 4.38933334e+01 4.38935051e+01 4.38935051e+01 4.40430984e+01
 4.37056541e+01 4.37130699e+01 4.37130699e+01 4.37299423e+01
 4.37299423e+01 4.37273560e+01 4.35623283e+01 4.35686836e+01
 4.35686836e+01 4.39627113e+01 4.38898582e+01 4.38898582e+01
 7.07985735e+00 4.40614929e+01 4.40029449e+01 4.40045319e+01
 4.38489227e+01 4.38505821e+01 4.39114914e+01 4.39087753e+01
 4.39087753e+01 4.38924026e+01 4.38892097e+01 4.38892097e+01
 4.38928757e+01 4.38896217e+01 4.38896217e+01 4.38915024e+01
 4.38877487e+01 4.38877487e+01 4.39155083e+01 4.39155922e+01
 4.39656143e+01 4.39713440e+01 4.39713440e+01 4.36424904e+01
 4.36674500e+01 4.36441345e+01 4.36441345e+01 4.37676544e+01
 4.37598534e+01 4.37598534e+01 4.39257126e+01 4.37178459e+01
 4.37250099e+01 4.37250099e+01 4.40029449e+01 4.40044785e+01
 4.38457260e+01 4.40684395e+01 4.40691643e+01 4.38439369e+01
 4.39155922e+01 4.41650696e+01 4.41650696e+01 4.38924370e+01
 4.38894539e+01 4.38894539e+01 4.37841873e+01 4.38917770e+01
 4.38907242e+01 4.38907242e+01 4.38577080e+01 4.38609695e+01
 4.38520699e+01 4.38520699e+01 4.37454758e+01 4.38934402e+01
 4.38901939e+01 4.38901939e+01 4.37056541e+01 4.37166710e+01
 4.37166710e+01 4.36935425e+01 4.36948891e+01 4.36948891e+01
 4.39028358e+01 4.38968620e+01 4.38968620e+01 4.38256912e+01
 7.11716843e+00 4.39953957e+01 4.39933014e+01 4.39933014e+01
 4.38892822e+01 4.37610245e+01 4.37598343e+01 4.37598343e+01
 4.38427467e+01 4.39126930e+01 7.11716843e+00 7.17567062e+00
 7.17602587e+00 7.07053852e+00 4.38922577e+01 4.38896942e+01
 4.38896942e+01 4.38855515e+01 4.37491875e+01 4.39270668e+01
 4.39270668e+01 4.38427315e+01 4.37820053e+01 4.37810287e+01
 4.37810287e+01 7.06303453e+00 4.40211525e+01 4.40382614e+01
 7.84942389e+00 4.39156494e+01 4.37456779e+01 4.38926239e+01
 4.38900986e+01 4.38900986e+01 4.37489281e+01 4.37489281e+01
 4.38499451e+01 4.38499451e+01 4.38483543e+01 4.39320717e+01
 4.39893837e+01 4.39865494e+01 4.39865494e+01 4.40727844e+01
 4.39019165e+01 4.38344536e+01 4.38838234e+01 4.38804016e+01
 4.38804016e+01 4.39219208e+01 4.37660942e+01 4.37613945e+01
 4.37613945e+01 4.38309975e+01 4.38287430e+01 4.38287430e+01
 4.39014397e+01 4.38432083e+01 4.38432083e+01 4.37246590e+01
 4.37246590e+01 4.38283806e+01 4.38283806e+01 4.39226913e+01
 4.39226913e+01 4.38335724e+01 4.38335724e+01 4.37195320e+01
 4.37195320e+01 7.06089020e+00 4.38480148e+01 4.39184952e+01
 4.37203026e+01 4.38155518e+01 6.99479342e+00 4.38946915e+01
 4.38183823e+01 4.38183594e+01 4.37199059e+01 4.94369221e+00
 5.02976894e+00 4.40732727e+01 4.40865860e+01 4.40865860e+01
 4.40739212e+01 7.12268162e+00 4.39051743e+01 7.02353621e+00
 5.78640976e+01 1.48712015e+00 4.56111984e+01 7.00141335e+00
 4.34134064e+01 4.41560059e+01 4.41574898e+01 4.41342316e+01
 4.41777077e+01 4.39692345e+01 4.40306969e+01 4.39664536e+01
 4.39654083e+01 4.38554878e+01 4.41379280e+01 4.39637375e+01
 4.38881073e+01 4.37077560e+01 4.38267632e+01 4.38267632e+01
 4.37058678e+01 4.38876801e+01 4.44780426e+01 4.40201035e+01
 7.16721869e+00 1.08681335e+01 4.38558922e+01 4.40347862e+01
 4.39198341e+01 4.41039963e+01 4.41066856e+01 7.33246183e+00
 1.29873657e+01 7.18309212e+00 4.39107475e+01 4.39107475e+01
 4.42262306e+01 4.41026917e+01 4.38929443e+01 4.38929482e+01
 4.41637192e+01 4.43487434e+01 4.40524750e+01 4.40844536e+01
 4.39586067e+01 4.38431320e+01 4.39420013e+01 4.40269966e+01
 4.37266808e+01 4.37418633e+01 4.37418633e+01 4.37296219e+01
 4.39982376e+01 1.29070044e+01 4.38667488e+01 4.40044632e+01
 4.38291702e+01 4.40791168e+01 4.40863075e+01 4.38531342e+01
 4.38287506e+01 4.40068855e+01 4.40068855e+01 4.39425354e+01
 4.40446587e+01 5.35230652e+02 4.38290443e+01 4.38967972e+01
 4.38967972e+01 4.39183121e+01 4.39660988e+01 4.39660988e+01
 4.39687195e+01 4.38018227e+01 4.39723244e+01 4.40553970e+01
 4.40089302e+01 4.40227890e+01 4.38573074e+01 4.38779831e+01
 4.38779831e+01 4.38501701e+01 4.40145645e+01 4.38021049e+01
 4.38543968e+01 4.38602219e+01 4.38602219e+01 4.39003372e+01
 4.39317131e+01 4.38966255e+01 4.39495544e+01 4.39495544e+01
 4.39492760e+01 4.38104935e+01 4.38104935e+01 4.37970352e+01
 4.37938385e+01 4.37938385e+01 4.37956848e+01 4.38802338e+01
 4.38802338e+01 4.38612404e+01 4.38653870e+01 4.37890739e+01
 4.37915001e+01 4.38707771e+01 4.38707771e+01 4.38520355e+01
 4.38357964e+01 4.38357964e+01 4.38413696e+01 4.39495354e+01
 4.39495354e+01 4.39520607e+01 4.38347015e+01 4.38347015e+01
 4.38309631e+01 4.38357811e+01 4.38357811e+01 4.38311005e+01
 4.38228416e+01 4.38030319e+01 4.38030319e+01 4.37975426e+01
 4.37882004e+01 4.38681183e+01 4.38625870e+01 4.38625870e+01
 4.37880821e+01 4.37895012e+01 4.38122597e+01 4.39690208e+01
 4.39659576e+01 4.39659576e+01 4.38119240e+01 4.38123550e+01
 4.38161888e+01 4.38828697e+01 4.37898674e+01 4.37898674e+01
 4.39833946e+01 4.39838028e+01 4.37761841e+01 4.37782898e+01
 4.39304504e+01 4.39296303e+01 4.39296303e+01 4.39387436e+01
 4.39389305e+01 4.39389305e+01 4.37868729e+01 4.37883682e+01
 4.37883682e+01 4.39102974e+01 4.37902603e+01 4.37756081e+01
 4.37766457e+01 4.37879715e+01 4.39267960e+01 4.39364700e+01
 4.39382286e+01 4.39382286e+01 4.37906075e+01 4.37742195e+01
 4.39382172e+01 4.39378853e+01 4.39378853e+01 4.38954086e+01
 4.39288254e+01 4.39311295e+01 4.39311295e+01 4.39632301e+01
 4.38019676e+01 4.39295387e+01 4.39290810e+01 4.39290810e+01
 4.36976776e+01 4.37739525e+01 4.66632996e+01 4.37749443e+01
 4.39241486e+01 4.37745628e+01 4.37834587e+01 4.37741241e+01
 4.37742424e+01 4.39364243e+01 4.39381561e+01 4.39381561e+01
 4.39290657e+01 4.39325562e+01 4.39325562e+01 4.38026390e+01
 4.37746429e+01 4.41127510e+01 4.37741394e+01 4.37935410e+01
 4.37618408e+01 4.38699226e+01 4.38907509e+01 4.38907509e+01
 4.37677193e+01 4.37677193e+01 4.37839127e+01 4.37839127e+01
 4.38150597e+01 4.38150597e+01 4.37644463e+01 4.39286232e+01
 4.39286232e+01 4.38785248e+01 4.38785248e+01 4.37975044e+01
 4.39043694e+01 4.39043694e+01 4.37801704e+01 4.38810806e+01
 4.38810806e+01 4.39311447e+01 4.39311447e+01 4.39090500e+01
 4.39090500e+01 4.39203377e+01 4.39203377e+01 4.39571609e+01
 4.39571609e+01 1.24679260e+01 1.45654464e+00 5.80685692e+01
 1.45591402e+00 4.57892113e+01 4.35773277e+01 6.99596596e+00
 5.80681381e+01 5.35230652e+02 5.35230530e+02 1.24801359e+01
 1.25332556e+01]
2025-06-02 15:52:24,087 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155224_update_16.json
2025-06-02 15:52:24,088 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:52:24,098 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155224_update_16.pth and as latest_checkpoint.pth
2025-06-02 15:52:24,099 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869575.dot): 0.4472
2025-06-02 15:52:24,099 - WARNING - Detected 4 anomalous nodes (reconstruction-based):
2025-06-02 15:52:24,099 - WARNING -   Node ID: 192.168.27.10, Recon Error: 19.4892, MLP Score: 0.9330
2025-06-02 15:52:24,099 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 20.8223, MLP Score: 0.9535
2025-06-02 15:52:24,100 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 21.1177, MLP Score: 0.9717
2025-06-02 15:52:24,100 - WARNING -   Node ID: fe80::a425:e54:93a8:261c, Recon Error: 20.0290, MLP Score: 0.9556
2025-06-02 15:52:24,100 - WARNING - Detected 6 anomalous edges (reconstruction-based):
2025-06-02 15:52:24,100 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2305, MLP Score: 0.0000
2025-06-02 15:52:24,101 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9321, MLP Score: 0.0000
2025-06-02 15:52:24,101 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7370, MLP Score: 0.0000
2025-06-02 15:52:24,101 - WARNING -   Source: 192.168.27.10, Target: 224.0.0.251, Recon Error: 535.2307, MLP Score: 0.0000
2025-06-02 15:52:24,102 - WARNING -   Source: fe80::eb4e:a54d:8c61:6ce1, Target: ff02::fb, Recon Error: 535.2307, MLP Score: 0.0000
2025-06-02 15:52:24,128 - DEBUG - Embedding standard deviations before t-SNE: [1.1199471  0.10649051 1.3020964  1.1027286  2.1051428  0.
 0.78001964 0.9060765  2.3208995  1.1460127  0.7575458  0.
 1.6928964  0.7107142  1.1471353  1.1674907  0.         0.5231519
 0.         0.10493842 3.0520012  0.6763826  0.         1.2486452
 0.94996375 0.9569193  0.         0.9165219  2.2784724  0.
 1.2525858  0.5140633 ]
2025-06-02 15:52:24,738 - INFO - Embeddings visualization saved to vis/embeddings_16_updates_20250602_155224.png
2025-06-02 15:52:24,738 - INFO - Performing visualization of node and edge features.
2025-06-02 15:52:24,739 - INFO - Starting visualization of node features.
2025-06-02 15:52:24,739 - INFO - Graph has 419 nodes and 30 features.
2025-06-02 15:52:24,739 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:52:24,739 - INFO - Calculating feature statistics:
2025-06-02 15:52:24,739 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:24,739 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:24,739 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 9, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.551785), 'max': np.float32(1.4956648)}
2025-06-02 15:52:24,739 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 9, 'mean': np.float32(-3.641716e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.4676753), 'max': np.float32(2.5807602)}
2025-06-02 15:52:24,740 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:24,740 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:24,740 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:24,740 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(-3.4141085e-08), 'std': np.float32(1.0), 'min': np.float32(-0.41278455), 'max': np.float32(2.4225714)}
2025-06-02 15:52:24,740 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(1.13803615e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.2852621), 'max': np.float32(0.77805144)}
2025-06-02 15:52:24,740 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 3, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-7.1329055), 'max': np.float32(0.14374286)}
2025-06-02 15:52:24,740 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 9, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-3.6133795), 'max': np.float32(1.0095472)}
2025-06-02 15:52:24,740 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 9, 'mean': np.float32(1.820858e-08), 'std': np.float32(1.0), 'min': np.float32(-0.9946777), 'max': np.float32(3.6515121)}
2025-06-02 15:52:24,740 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 6, 'mean': np.float32(2.4582338), 'std': np.float32(1.0130639), 'min': np.float32(0.0), 'max': np.float32(7.0)}
2025-06-02 15:52:24,740 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.9427207), 'std': np.float32(0.3335829), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:52:24,740 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.14081146), 'std': np.float32(0.37426817), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:52:24,740 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.3436756), 'std': np.float32(0.5707901), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:52:24,740 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 3, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.14374286), 'max': np.float32(7.1329055)}
2025-06-02 15:52:24,741 - INFO - - service_1: {'name': 'service_1', 'unique': 5, 'mean': np.float32(3.4797137), 'std': np.float32(3.120713), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 15:52:24,741 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.646778), 'std': np.float32(2.9392102), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:52:24,741 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.6062055), 'std': np.float32(1.5026023), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:52:24,741 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.14081146), 'std': np.float32(0.37426817), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:52:24,741 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 1, 'mean': np.float32(8.0), 'std': np.float32(0.0), 'min': np.float32(8.0), 'max': np.float32(8.0)}
2025-06-02 15:52:24,741 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(4.09693e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.15512793), 'max': np.float32(12.03211)}
2025-06-02 15:52:24,741 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(1.3656434e-08), 'std': np.float32(1.0000001), 'min': np.float32(-0.17170915), 'max': np.float32(5.823802)}
2025-06-02 15:52:24,741 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:24,741 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:24,741 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:24,741 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:24,741 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(-3.1865014e-08), 'std': np.float32(1.0), 'min': np.float32(-1.0751959), 'max': np.float32(8.647978)}
2025-06-02 15:52:24,741 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(-1.9346615e-08), 'std': np.float32(1.0), 'min': np.float32(-1.2040381), 'max': np.float32(4.401428)}
2025-06-02 15:52:24,753 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x72fda42e43b0>
2025-06-02 15:52:24,881 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:52:24,933 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:52:24,958 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:52:26,382 - INFO - Node feature visualization saved to vis/node_features_20250602_155225.png
2025-06-02 15:52:26,383 - INFO - Finished visualization of node features.
2025-06-02 15:52:26,383 - INFO - Performing additional feature analysis:
2025-06-02 15:52:26,383 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:52:26,383 - INFO - Starting visualization of edge features.
2025-06-02 15:52:26,383 - INFO - Graph has 833 edges and 10 edge features.
2025-06-02 15:52:26,383 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:52:26,383 - INFO - Calculating edge feature statistics:
2025-06-02 15:52:26,384 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:52:26,384 - INFO - - count: {'name': 'count', 'unique': 21, 'mean': np.float32(9.158937e-09), 'std': np.float32(1.0), 'min': np.float32(-0.068577066), 'max': np.float32(19.334204)}
2025-06-02 15:52:26,384 - INFO - - dst_port: {'name': 'dst_port', 'unique': 13, 'mean': np.float32(461.0096), 'std': np.float32(526.1465), 'min': np.float32(3.0), 'max': np.float32(8688.0)}
2025-06-02 15:52:26,384 - INFO - - protocol: {'name': 'protocol', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:26,384 - INFO - - service: {'name': 'service', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:26,384 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 558, 'mean': np.float32(4.5794684e-09), 'std': np.float32(1.0), 'min': np.float32(-0.113668054), 'max': np.float32(19.650415)}
2025-06-02 15:52:26,384 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 595, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.103927135), 'max': np.float32(19.133986)}
2025-06-02 15:52:26,384 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 206, 'mean': np.float32(6.8692025e-09), 'std': np.float32(1.0), 'min': np.float32(-0.087794885), 'max': np.float32(19.02295)}
2025-06-02 15:52:26,384 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 570, 'mean': np.float32(2.2897342e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.10684508), 'max': np.float32(21.271181)}
2025-06-02 15:52:26,384 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 590, 'mean': np.float32(4.5794684e-09), 'std': np.float32(1.0), 'min': np.float32(-0.109008655), 'max': np.float32(21.061152)}
2025-06-02 15:52:26,384 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 222, 'mean': np.float32(-4.5794684e-09), 'std': np.float32(1.0), 'min': np.float32(-0.10469742), 'max': np.float32(18.49781)}
2025-06-02 15:52:26,395 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x72fda4f672c0>
2025-06-02 15:52:26,478 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:52:26,489 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x72fda56d86b0>
2025-06-02 15:52:26,567 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:52:26,729 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:52:26,861 - DEBUG - Plotted boxplots of the first 8 non-constant edge features.
2025-06-02 15:52:26,883 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:52:26,892 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:52:28,323 - INFO - Edge feature visualization saved to vis/edge_features_20250602_155226.png
2025-06-02 15:52:28,323 - INFO - Finished visualization of edge features.
2025-06-02 15:52:28,323 - INFO - Performing additional edge feature analysis:
2025-06-02 15:52:28,324 - INFO - - 2 out of 10 edge features are constant.
2025-06-02 15:52:28,324 - INFO - - Highest correlation (1.00) between features: 'total_resp_bytes' and 'total_resp_ip_bytes'.
2025-06-02 15:52:28,325 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:52:28,325 - INFO - Graph has 833 edges and 10 edge features.
2025-06-02 15:52:28,325 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:52:28,799 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_155228_summary.png
2025-06-02 15:52:29,043 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_155228_pca_3d.png
2025-06-02 15:52:29,234 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_155228_pca_variance.png
2025-06-02 15:52:29,234 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:52:29,234 - INFO - 
--- Processing file: nw_graph_encoded_1748869605.dot (Timestamp: 2025-06-02 15:06:45) ---
2025-06-02 15:52:29,234 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869605.dot
2025-06-02 15:52:29,234 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869605.dot'.
2025-06-02 15:52:29,234 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869605.dot
2025-06-02 15:52:29,243 - INFO - Parsed 439 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869605.dot'.
2025-06-02 15:52:29,253 - INFO - Parsed 919 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869605.dot'.
2025-06-02 15:52:29,253 - INFO - Processing node updates/additions.
2025-06-02 15:52:29,256 - INFO - Processing edge updates/additions.
2025-06-02 15:52:29,262 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:52:29,262 - INFO - Finished updating NetworkX graph.
2025-06-02 15:52:29,263 - DEBUG - Updated graph - Nodes: 439, Edges: 919
2025-06-02 15:52:29,263 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:52:29,263 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:52:29,268 - DEBUG - Initial node features tensor shape: torch.Size([439, 30])
2025-06-02 15:52:29,271 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:52:29,271 - DEBUG - Node features tensor shape after scaling: torch.Size([439, 30])
2025-06-02 15:52:29,272 - DEBUG - Edge index tensor shape: torch.Size([2, 919])
2025-06-02 15:52:29,273 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:52:29,275 - DEBUG - Initial edge attributes tensor shape: torch.Size([919, 10])
2025-06-02 15:52:29,276 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:52:29,276 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([919, 10])
2025-06-02 15:52:29,276 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:52:29,276 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:52:29,276 - INFO - Updated main graph to 439 nodes and 919 edges.
2025-06-02 15:52:29,276 - INFO - Performing online update...
2025-06-02 15:52:29,276 - INFO - Starting online update for 50 steps.
2025-06-02 15:52:29,277 - DEBUG - Updated RunningStats: new_mean=0.9426874715704161, new_var=44400000000159.195, new_n=4470
2025-06-02 15:52:29,277 - DEBUG - Updated RunningStats: new_mean=0.9413837589847692, new_var=44700000000019.62, new_n=4500
2025-06-02 15:52:29,277 - DEBUG - Updated RunningStats: new_mean=43.622799896224194, new_var=14800000198241.549, new_n=1490
2025-06-02 15:52:29,277 - DEBUG - Updated RunningStats: new_mean=43.7040079413954, new_var=14900000273981.016, new_n=1500
2025-06-02 15:52:29,277 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:52:29,277 - DEBUG - Online update step: 1/50
2025-06-02 15:52:29,277 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,277 - DEBUG - Online update step: 2/50
2025-06-02 15:52:29,277 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,277 - DEBUG - Online update step: 3/50
2025-06-02 15:52:29,277 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,277 - DEBUG - Online update step: 4/50
2025-06-02 15:52:29,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,278 - DEBUG - Online update step: 5/50
2025-06-02 15:52:29,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,278 - DEBUG - Online update step: 6/50
2025-06-02 15:52:29,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,278 - DEBUG - Online update step: 7/50
2025-06-02 15:52:29,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,278 - DEBUG - Online update step: 8/50
2025-06-02 15:52:29,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,278 - DEBUG - Online update step: 9/50
2025-06-02 15:52:29,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,278 - DEBUG - Online update step: 10/50
2025-06-02 15:52:29,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,278 - DEBUG - Online update step: 11/50
2025-06-02 15:52:29,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,278 - DEBUG - Online update step: 12/50
2025-06-02 15:52:29,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,278 - DEBUG - Online update step: 13/50
2025-06-02 15:52:29,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,278 - DEBUG - Online update step: 14/50
2025-06-02 15:52:29,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,278 - DEBUG - Online update step: 15/50
2025-06-02 15:52:29,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,278 - DEBUG - Online update step: 16/50
2025-06-02 15:52:29,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,278 - DEBUG - Online update step: 17/50
2025-06-02 15:52:29,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,278 - DEBUG - Online update step: 18/50
2025-06-02 15:52:29,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,278 - DEBUG - Online update step: 19/50
2025-06-02 15:52:29,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,278 - DEBUG - Online update step: 20/50
2025-06-02 15:52:29,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,278 - DEBUG - Online update step: 21/50
2025-06-02 15:52:29,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,278 - DEBUG - Online update step: 22/50
2025-06-02 15:52:29,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,278 - DEBUG - Online update step: 23/50
2025-06-02 15:52:29,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,279 - DEBUG - Online update step: 24/50
2025-06-02 15:52:29,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,279 - DEBUG - Online update step: 25/50
2025-06-02 15:52:29,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,279 - DEBUG - Online update step: 26/50
2025-06-02 15:52:29,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,279 - DEBUG - Online update step: 27/50
2025-06-02 15:52:29,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,279 - DEBUG - Online update step: 28/50
2025-06-02 15:52:29,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,279 - DEBUG - Online update step: 29/50
2025-06-02 15:52:29,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,279 - DEBUG - Online update step: 30/50
2025-06-02 15:52:29,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,279 - DEBUG - Online update step: 31/50
2025-06-02 15:52:29,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,279 - DEBUG - Online update step: 32/50
2025-06-02 15:52:29,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,279 - DEBUG - Online update step: 33/50
2025-06-02 15:52:29,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,279 - DEBUG - Online update step: 34/50
2025-06-02 15:52:29,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,279 - DEBUG - Online update step: 35/50
2025-06-02 15:52:29,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,279 - DEBUG - Online update step: 36/50
2025-06-02 15:52:29,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,279 - DEBUG - Online update step: 37/50
2025-06-02 15:52:29,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,279 - DEBUG - Online update step: 38/50
2025-06-02 15:52:29,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,279 - DEBUG - Online update step: 39/50
2025-06-02 15:52:29,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,279 - DEBUG - Online update step: 40/50
2025-06-02 15:52:29,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,279 - DEBUG - Online update step: 41/50
2025-06-02 15:52:29,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,279 - DEBUG - Online update step: 42/50
2025-06-02 15:52:29,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,279 - DEBUG - Online update step: 43/50
2025-06-02 15:52:29,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,279 - DEBUG - Online update step: 44/50
2025-06-02 15:52:29,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,280 - DEBUG - Online update step: 45/50
2025-06-02 15:52:29,280 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,280 - DEBUG - Online update step: 46/50
2025-06-02 15:52:29,280 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,280 - DEBUG - Online update step: 47/50
2025-06-02 15:52:29,280 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,280 - DEBUG - Online update step: 48/50
2025-06-02 15:52:29,280 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,280 - DEBUG - Online update step: 49/50
2025-06-02 15:52:29,280 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,280 - DEBUG - Online update step: 50/50
2025-06-02 15:52:29,280 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,280 - WARNING - No successful steps during online update.
2025-06-02 15:52:29,280 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -2.3896167e-08 -2.8240924e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.6068546e-08
 -4.3447579e-09  1.1948083e-08 -2.0637598e-08 -3.2585682e-08
  2.4510250e+00  2.9453304e+00  1.6400911e-01  4.3280182e+00
 -2.0637598e-08  3.6173120e+00  5.4715261e+00  7.5831437e+00
  1.6400911e-01  8.0000000e+00 -1.3034273e-08 -2.4982358e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -6.7886838e-09 -2.4982358e-08], current edge mean: [ 1.0377305e-09  4.6919803e+02  0.0000000e+00  0.0000000e+00
 -3.1131915e-09  5.1886526e-09  5.1886523e-10  7.2641133e-09
 -8.3018437e-09 -3.1131915e-09]
2025-06-02 15:52:29,281 - DEBUG - Node drift difference: 0.0619, Edge drift difference: 0.0156
2025-06-02 15:52:29,281 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -2.3896167e-08 -2.8240924e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.6068546e-08
 -4.3447579e-09  1.1948083e-08 -2.0637598e-08 -3.2585682e-08
  2.4510250e+00  2.9453304e+00  1.6400911e-01  4.3280182e+00
 -2.0637598e-08  3.6173120e+00  5.4715261e+00  7.5831437e+00
  1.6400911e-01  8.0000000e+00 -1.3034273e-08 -2.4982358e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -6.7886838e-09 -2.4982358e-08], edge=[ 1.0377305e-09  4.6919803e+02  0.0000000e+00  0.0000000e+00
 -3.1131915e-09  5.1886526e-09  5.1886523e-10  7.2641133e-09
 -8.3018437e-09 -3.1131915e-09]
2025-06-02 15:52:29,282 - DEBUG - Updated reference std: node=[0.         0.         1.0011408  1.0011408  0.         0.
 0.         1.0011408  1.001141   1.001141   1.0011408  1.001141
 1.003074   0.3264865  0.39457318 0.56690574 1.001141   3.2002099
 2.9714756  1.5429286  0.39457318 0.         1.001141   1.0011408
 0.         0.         0.         0.         1.001141   1.001141  ], edge=[  1.0005445 551.03625     0.          0.          1.0005445   1.0005445
   1.0005445   1.0005445   1.0005445   1.0005445]
2025-06-02 15:52:29,282 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:52:29,282 - INFO - Running anomaly detection...
2025-06-02 15:52:29,282 - INFO - Starting anomaly detection.
2025-06-02 15:52:29,289 - DEBUG - Node reconstruction errors: [16.218966  10.245639  15.354379  15.986448  10.191553   8.427074
 15.354379  12.380692  12.380692  12.844602  12.380692  10.950603
 20.180807   8.694506  14.986578  16.314642  11.594123  16.32575
 17.007853  15.784982  12.032842  14.986578  12.219932  10.747488
 15.033786  12.405599  15.033785   9.724821  11.859512  15.033785
 10.525704  12.315751   9.276426  15.441195  12.405599  15.827105
  9.201244  15.784982  11.095059  11.99996   15.474264  14.57546
 15.784986  16.534985  15.945062  12.374577  17.905245   8.755458
 11.472708  16.125463  21.18991   12.146515  12.028229  16.402212
 11.42532   10.488226  17.223478  15.125864  15.453347  15.45335
  7.32012   15.685748  14.2773075 10.296335  14.151317  11.425321
 11.72345   11.425322  14.2773075 14.2773075 11.191067   8.070362
 11.769147   7.3747168  7.1934495  8.185725  15.018179   8.111567
  7.2805767  7.199487  14.459089   8.502531   9.035861  11.878705
 10.489343   9.966066   8.565385   7.249175   7.0155063  8.580356
 14.142465   8.2206745  9.608752   7.3142467 11.630301  21.547838
 14.337787   8.160778  14.198396  10.957112   8.160777  14.337787
 14.936461   8.024191   8.788648  10.822586  14.878183   7.081246
  9.736572  13.29791   14.271624  14.759675   9.68082    9.909628
  8.406374   8.16081    8.29114    8.181179   7.1480927 11.575888
 14.330731   9.608756   9.539025   9.608755   6.9034824 12.036991
  9.673463   7.461975   8.16078   14.832324  11.898089  11.34965
 14.698572   9.806299   8.427215  11.2734    15.068177  13.988263
 11.349647   8.568704  11.575888   8.861747  14.578535  11.349647
 11.349647   8.160788   8.29114   11.080889  11.451407   7.2464185
 12.857148   8.788657   7.1480722 11.349649   6.966401   8.2268915
 11.575888   8.5116625  8.160779  14.667661  11.080889   7.1997976
 11.575888  11.898095   8.291141   8.206011   8.172184   7.2464175
  7.1551876  7.246417   7.0978317 11.575888  13.868867  16.514683
  7.2464175 10.182036   7.246416   8.333767   8.203192   8.203189
 10.831496   9.069962  14.358166   9.16439    9.5944805  8.203202
 14.070653   8.2796135 14.070653  11.101401   7.3134494  6.9871316
 11.53874   11.182311  14.330733  11.538742  14.282258  14.578535
  8.185156  14.832324  13.988263  11.080889   9.440738   7.1480937
  8.1158495  9.608756  11.606949  10.21471   14.487595   7.1921067
  8.381728   8.203187  11.538742   7.2160115  8.20319   13.868867
  8.203191   8.2911415  8.144362  11.182312   9.361678  14.329862
 13.867722  11.53874   11.080889   6.9914727  8.2031975 11.080889
  7.1334596 15.136458   9.256391   8.203186   7.2464166  8.2911415
  8.291141  11.538742   7.133461  13.867722  11.080889  14.515676
  8.046044   7.109616  11.101404   7.246416  11.101404   8.181103
  8.380094   7.8475733 11.101401  11.33027   13.868867  13.868867
  8.1443615  7.097831   8.427216   8.076041  11.101401  13.9776
 13.867722   8.203188   7.181931   8.658437  15.132334  11.101403
  7.1334615 11.289527   6.989462  15.132336   6.9894643  8.20319
  9.880046   9.594481   7.073755  14.875713   8.250142   8.20319
 14.290205   7.4092617 10.831493   8.203189   7.245538  14.005891
  6.991518  14.770117  11.101401  14.4358425  8.327071   7.2056246
  9.069963   9.207572  11.544085  14.335525  11.723735  11.101401
 14.2759075 13.9776     8.20319    8.2045555 11.538742  14.696285
  8.307484  14.030935   8.36236    8.362357  14.030935  14.030935
 14.030941   8.239547  14.030935  14.030935  14.030935   8.239544
 14.030935  11.901914   9.359551   7.290733   8.340041  15.021376
 11.66408   11.69769    7.04271   13.9776     6.90684    8.362357
 14.329862   9.293154  14.24147    8.239543   7.1819296  7.181932
  7.2806582 11.66408   14.030935   8.250143  14.030935   8.239543
 11.472711  13.867722  14.24147   14.24147   14.030939  14.275927
 14.24147    7.04271    8.362355   6.9894595  8.362358  14.653617
  6.9277997  8.563391  14.030942   8.333774  15.143585   7.8870664
 14.507704  11.53874   14.030935  14.030935  13.9776    13.9776
  7.8475733 14.030935  14.24147    8.362611   8.362397  16.602459
 14.146132   7.8870664  8.307483   8.078596   7.2636533  8.307485
  7.0452986  9.100768   7.298869   8.108948  13.896536  11.336569
  7.036169  14.030935   8.362356  11.258648  11.472711   7.538307
 11.258648   8.307484  10.97       8.470107   7.9027357 14.030935
  8.739663   8.307485  13.998282  11.495217   8.0845375  8.0845375
  8.0845375 15.507619  14.147386  15.507619  11.495217  11.906165
  8.084539  14.147386  13.998282  11.495217   7.0468206 11.234387
 11.906164  13.896528   8.0845375 11.495217  14.147386   8.0845375
  8.0845375 14.322422  14.322253   8.0845375 13.896525  13.998282
 13.998282  11.495217  13.998282  11.495217   9.152874  11.906116
 11.495217  14.286722   7.5519977 14.941005   7.184836  11.194444
  8.084539   8.067371   8.0845375  8.0845375 11.495217   8.067369
 14.941005 ]
2025-06-02 15:52:29,294 - DEBUG - Edge reconstruction errors: [4.48603106e+00 4.65957451e+00 6.98864222e+00 4.33965034e+01
 1.47933483e+00 1.34932156e+01 4.40053291e+01 4.39783058e+01
 4.38948708e+01 6.99759483e+00 4.40367546e+01 4.40382309e+01
 4.41016121e+01 4.39674263e+01 4.38714638e+01 4.38274879e+01
 4.38314629e+01 4.38287849e+01 4.38287849e+01 1.03176947e+01
 7.18070030e+00 7.18400478e+00 4.38587379e+01 4.40995293e+01
 4.43037033e+01 4.40591850e+01 4.40607605e+01 4.39311943e+01
 4.39481392e+01 4.37051315e+01 4.37154617e+01 4.37203751e+01
 4.37203751e+01 4.37675056e+01 4.37787895e+01 4.37787895e+01
 4.37711334e+01 4.39412918e+01 4.39399834e+01 4.39399834e+01
 4.39453697e+01 4.37984276e+01 4.39674873e+01 4.39138069e+01
 4.39688568e+01 4.39688568e+01 4.39173279e+01 4.39137306e+01
 4.39137306e+01 4.37929268e+01 4.37901573e+01 4.37901573e+01
 4.42133598e+01 4.39037323e+01 7.16257429e+00 7.16931725e+00
 4.38749313e+01 4.40297775e+01 4.39360504e+01 4.39316826e+01
 4.39316826e+01 4.37558594e+01 5.35231201e+02 7.18661594e+00
 7.15989494e+00 4.38045387e+01 4.38472786e+01 4.38472786e+01
 4.35908165e+01 4.35972633e+01 4.35933609e+01 4.35933609e+01
 8.08936279e+02 4.34220543e+01 4.40793114e+01 4.41053772e+01
 4.38204231e+01 4.38048897e+01 4.38048897e+01 4.38816147e+01
 4.38664474e+01 4.38108673e+01 4.38108673e+01 4.39175987e+01
 4.39183540e+01 4.39183540e+01 1.13442440e+01 4.39180679e+01
 4.39149132e+01 4.39149132e+01 4.39923859e+01 4.39095459e+01
 4.39095459e+01 4.38952599e+01 4.38993759e+01 4.38197517e+01
 4.39989243e+01 4.39983025e+01 4.39983025e+01 4.39536819e+01
 4.36677856e+01 4.36699181e+01 4.36699181e+01 6.76700950e-01
 4.39313164e+01 4.39193649e+01 4.39268761e+01 4.39249573e+01
 4.39249573e+01 4.38206482e+01 4.38483925e+01 4.38228226e+01
 4.38228226e+01 7.07299614e+00 4.38271523e+01 4.38015671e+01
 4.38015671e+01 4.40491982e+01 4.40565453e+01 4.38969727e+01
 4.38968163e+01 4.39345779e+01 4.39345779e+01 4.39349899e+01
 4.38815117e+01 4.38835564e+01 4.38835564e+01 4.38020821e+01
 4.38017235e+01 4.38017235e+01 4.38026237e+01 4.38011818e+01
 4.38011818e+01 4.38626976e+01 4.39135399e+01 4.39135399e+01
 4.39186172e+01 4.39134331e+01 4.39134331e+01 4.39166031e+01
 4.39185371e+01 4.39211617e+01 4.39211617e+01 4.39140930e+01
 4.37857552e+01 4.37857552e+01 4.37866173e+01 4.37567329e+01
 4.38732376e+01 4.38732376e+01 4.36076546e+01 4.36076546e+01
 4.38790092e+01 4.38790092e+01 4.38755150e+01 4.38278580e+01
 4.39267731e+01 4.39267731e+01 4.39314957e+01 4.38048172e+01
 4.38500557e+01 4.38500557e+01 4.38913689e+01 4.38913689e+01
 4.38920403e+01 4.37057419e+01 4.37057419e+01 4.37022400e+01
 4.37037430e+01 4.37677994e+01 4.37677994e+01 4.37670822e+01
 4.37253113e+01 4.37253113e+01 4.37243652e+01 4.37935257e+01
 4.37663193e+01 4.37659454e+01 4.38942757e+01 4.38909836e+01
 4.38909836e+01 4.39141273e+01 4.39141273e+01 4.38948288e+01
 4.38450851e+01 4.38451233e+01 4.38931618e+01 4.38931618e+01
 4.38917046e+01 4.39007759e+01 4.39007759e+01 4.39007645e+01
 4.39059448e+01 4.39059448e+01 4.38914871e+01 4.37438431e+01
 4.37441139e+01 7.06360674e+00 7.15310669e+00 4.40145073e+01
 4.36033974e+01 4.36033974e+01 4.35780182e+01 4.36475677e+01
 4.36475677e+01 6.87198758e-01 4.36082382e+01 4.37516785e+01
 4.37905350e+01 4.37905350e+01 4.37863655e+01 4.37863655e+01
 4.37680206e+01 4.37680206e+01 4.37855949e+01 4.38893814e+01
 4.38893814e+01 4.37585335e+01 4.37585335e+01 7.07748985e+00
 8.68737427e+02 7.12315512e+00 7.12106228e+00 4.37913628e+01
 4.37177582e+01 4.37209854e+01 4.37209854e+01 4.35964088e+01
 4.35894051e+01 4.35894051e+01 4.38488426e+01 4.38478508e+01
 4.38478508e+01 4.36558075e+01 4.36295738e+01 4.36295738e+01
 4.36285667e+01 4.38689232e+01 4.38874512e+01 4.38810997e+01
 4.38810997e+01 4.38489151e+01 4.37648392e+01 4.37585144e+01
 4.37585144e+01 4.37182274e+01 4.37137032e+01 4.37137032e+01
 4.38379822e+01 4.38358345e+01 4.38358345e+01 4.38784142e+01
 4.38778076e+01 4.38778076e+01 4.38388100e+01 4.38282471e+01
 4.38282700e+01 4.37811699e+01 4.39661865e+01 4.38255577e+01
 4.37848320e+01 4.37848320e+01 4.37505951e+01 4.39900894e+01
 4.39891701e+01 4.39891701e+01 4.39669800e+01 4.38480148e+01
 4.39563751e+01 4.37303734e+01 4.37297974e+01 7.05735588e+00
 4.39106445e+01 6.99371386e+00 4.37860222e+01 4.37860222e+01
 4.39077911e+01 4.39403191e+01 4.39403191e+01 4.36860962e+01
 4.39008026e+01 4.38204613e+01 4.38147545e+01 4.38147545e+01
 4.37241058e+01 4.37155647e+01 4.38021584e+01 4.39121246e+01
 4.36869049e+01 4.42233391e+01 4.42233391e+01 4.36832848e+01
 4.39046173e+01 1.51920500e+01 1.47933483e+00 5.78473053e+01
 5.78473053e+01 4.55886955e+01 7.00071716e+00 4.34543610e+01
 4.39796944e+01 4.39643898e+01 6.99758005e+00 4.39684753e+01
 4.40937843e+01 4.41498795e+01 4.38314514e+01 4.38295631e+01
 4.38295631e+01 4.39702415e+01 4.39677391e+01 4.37896385e+01
 4.39676933e+01 4.38424568e+01 4.38474846e+01 4.38474846e+01
 4.39540672e+01 4.39489479e+01 4.39475784e+01 4.39475784e+01
 1.16385765e+01 4.39263992e+01 4.39220161e+01 4.39220161e+01
 4.39406700e+01 4.39350166e+01 4.39350166e+01 4.39349709e+01
 4.38153343e+01 4.38153343e+01 4.38138771e+01 4.38209534e+01
 4.38209534e+01 4.38148956e+01 4.38675117e+01 4.38675117e+01
 4.38441048e+01 4.39027214e+01 4.39027214e+01 4.39286919e+01
 4.39286919e+01 4.39289932e+01 4.37802048e+01 4.37802048e+01
 4.37670517e+01 4.39118423e+01 4.39118423e+01 4.40602303e+01
 4.40602303e+01 4.35575943e+01 4.35659447e+01 4.38360710e+01
 4.38369904e+01 4.39102516e+01 4.35765190e+01 4.35838280e+01
 4.35838280e+01 4.35824165e+01 4.38540955e+01 4.38331833e+01
 4.38331833e+01 4.40501442e+01 4.40525055e+01 4.36915054e+01
 4.36975746e+01 4.36975746e+01 4.36955910e+01 4.40501442e+01
 4.40611420e+01 4.37544556e+01 4.37544556e+01 4.39744759e+01
 4.40073357e+01 4.40230293e+01 4.40499306e+01 4.40519104e+01
 4.40596848e+01 4.40676422e+01 4.39141693e+01 4.39074974e+01
 4.39074974e+01 4.39113770e+01 4.39084282e+01 4.39084282e+01
 4.39003067e+01 4.39197083e+01 4.39092102e+01 4.39092102e+01
 4.39705238e+01 4.39457626e+01 4.39457626e+01 4.39473572e+01
 4.39109612e+01 4.39081535e+01 4.39081535e+01 4.39146156e+01
 4.37974129e+01 4.37906876e+01 4.37906876e+01 4.36066589e+01
 4.36332893e+01 4.36363754e+01 4.36363754e+01 4.39128685e+01
 4.37527084e+01 4.37527084e+01 4.39163780e+01 4.39163780e+01
 4.39141083e+01 4.38127289e+01 4.38061256e+01 4.38061256e+01
 1.13442440e+01 4.39134865e+01 4.38900452e+01 4.38208809e+01
 4.38194351e+01 4.38194351e+01 4.37522278e+01 4.37661896e+01
 4.37535477e+01 4.37535477e+01 4.40499306e+01 4.40516014e+01
 4.38274765e+01 4.38292122e+01 4.38292122e+01 4.37022400e+01
 4.37079201e+01 4.37796555e+01 4.37796555e+01 4.38565865e+01
 4.38590164e+01 4.38862762e+01 4.38734474e+01 4.37846375e+01
 4.37851410e+01 4.37851410e+01 4.35782471e+01 4.35822639e+01
 4.36228104e+01 4.36228104e+01 7.06492567e+00 4.37558060e+01
 4.38565674e+01 4.38820305e+01 4.37569427e+01 4.38565865e+01
 4.40266647e+01 4.40283508e+01 4.38848190e+01 4.39300919e+01
 4.39123573e+01 4.39123268e+01 4.37941856e+01 4.37920036e+01
 4.37920036e+01 4.38423729e+01 4.39382439e+01 4.39129448e+01
 4.39129448e+01 4.37122345e+01 4.37145767e+01 4.37145767e+01
 4.38955765e+01 4.38955460e+01 4.38955460e+01 4.40407219e+01
 4.37041283e+01 4.37114601e+01 4.37114601e+01 4.37357826e+01
 4.37357826e+01 4.37333221e+01 4.35887566e+01 4.35947838e+01
 4.35947838e+01 4.39728508e+01 4.39006577e+01 4.39006577e+01
 7.07747173e+00 4.40615082e+01 4.40019684e+01 4.40034790e+01
 4.38483086e+01 4.38504562e+01 4.39149818e+01 4.39123650e+01
 4.39123650e+01 4.38944778e+01 4.38914146e+01 4.38914146e+01
 4.38949585e+01 4.38917961e+01 4.38917961e+01 4.38937836e+01
 4.38901367e+01 4.38901367e+01 4.39150848e+01 4.39151611e+01
 4.39674797e+01 4.39730072e+01 4.39730072e+01 4.36428261e+01
 4.36669540e+01 4.36444092e+01 4.36444092e+01 4.37742233e+01
 4.37667389e+01 4.37667389e+01 4.39231987e+01 4.37241096e+01
 4.37311363e+01 4.37311363e+01 4.40019684e+01 4.40034294e+01
 4.38452797e+01 4.40697212e+01 4.40704269e+01 4.38436203e+01
 4.39170074e+01 4.41667557e+01 4.41667557e+01 4.38944931e+01
 4.38916512e+01 4.38916512e+01 4.37812386e+01 4.38938713e+01
 4.38928490e+01 4.38928490e+01 4.38572807e+01 4.38692856e+01
 4.38607101e+01 4.38607101e+01 4.38018646e+01 4.38955154e+01
 4.38923721e+01 4.38923721e+01 4.37041321e+01 4.37151527e+01
 4.37151527e+01 4.36925125e+01 4.36937752e+01 4.36937752e+01
 4.39050255e+01 4.38989716e+01 4.38989716e+01 4.38241463e+01
 7.11480141e+00 4.40092583e+01 4.40072441e+01 4.40072441e+01
 4.38969421e+01 4.37679062e+01 4.37667274e+01 4.37667274e+01
 4.38424377e+01 4.39123955e+01 7.11480141e+00 7.17510891e+00
 7.17544746e+00 7.06951761e+00 4.38943176e+01 4.38918724e+01
 4.38918724e+01 4.39199066e+01 4.37475166e+01 4.39298019e+01
 4.39298019e+01 4.38424225e+01 4.37888985e+01 4.37879601e+01
 4.37879601e+01 7.06191492e+00 4.36599884e+01 4.36764412e+01
 4.38662834e+01 4.38662834e+01 7.85867310e+00 4.39152374e+01
 4.37441711e+01 4.39124718e+01 4.39015274e+01 4.39015274e+01
 4.37547493e+01 4.37547493e+01 4.38506699e+01 4.38506699e+01
 4.38466682e+01 4.39303055e+01 4.39897995e+01 4.39871063e+01
 4.39871063e+01 4.40992661e+01 4.39008865e+01 4.38325577e+01
 4.38856010e+01 4.38873978e+01 4.38873978e+01 4.39197884e+01
 4.37756500e+01 4.37710648e+01 4.37710648e+01 4.38512917e+01
 4.38324127e+01 4.38324127e+01 4.39003677e+01 4.38933220e+01
 4.38933220e+01 4.38783188e+01 4.37398186e+01 4.37398186e+01
 4.38789978e+01 4.38789978e+01 4.38786736e+01 4.39241257e+01
 4.39241257e+01 4.38373146e+01 4.38373146e+01 4.37952538e+01
 4.37952538e+01 7.05868626e+00 4.38477745e+01 4.39177780e+01
 4.37185822e+01 4.38144913e+01 6.99371433e+00 4.38930511e+01
 4.38172150e+01 4.38171959e+01 4.37182121e+01 1.30110950e+01
 4.37929916e+01 4.40368996e+01 4.40405045e+01 4.38145905e+01
 4.38144455e+01 4.38185310e+01 4.39214134e+01 4.39257851e+01
 4.39094429e+01 4.38185310e+01 4.38241386e+01 5.35231445e+02
 4.38258324e+01 4.37153053e+01 4.93622017e+00 5.08237267e+00
 4.40906334e+01 4.41034241e+01 4.41034241e+01 4.40912590e+01
 7.12948179e+00 4.39161072e+01 7.02855396e+00 5.78612595e+01
 1.48612094e+00 4.56089401e+01 7.00345230e+00 4.34108124e+01
 4.41589928e+01 4.41604156e+01 4.41377106e+01 4.41796837e+01
 4.39802437e+01 4.40398102e+01 4.39776802e+01 4.39765472e+01
 4.38678360e+01 4.41351204e+01 4.39750214e+01 4.38987808e+01
 4.37385025e+01 4.38800468e+01 4.38800468e+01 4.37366943e+01
 4.38983498e+01 4.44781303e+01 4.40295601e+01 7.17314339e+00
 1.09187689e+01 4.38682175e+01 4.40416336e+01 4.39298592e+01
 4.41083908e+01 4.41110153e+01 7.34262180e+00 1.31302042e+01
 7.20238638e+00 4.39732819e+01 4.39732819e+01 4.42406235e+01
 4.41051903e+01 4.39040375e+01 4.39040375e+01 4.41666870e+01
 4.43517609e+01 4.40572853e+01 4.40546608e+01 4.39695663e+01
 4.38555031e+01 4.39540939e+01 4.40328140e+01 4.37102509e+01
 4.37355423e+01 4.37355423e+01 4.37130775e+01 4.40088997e+01
 1.29913607e+01 4.38783913e+01 4.40112534e+01 4.38425102e+01
 4.40914154e+01 4.41056252e+01 4.38658447e+01 4.38421478e+01
 4.40181923e+01 4.40181923e+01 4.39537086e+01 4.40535698e+01
 5.35231262e+02 4.38400917e+01 4.39172478e+01 4.39172478e+01
 4.39394836e+01 4.39771118e+01 4.39771118e+01 4.39797745e+01
 4.38139610e+01 4.39804001e+01 4.40673485e+01 4.40166626e+01
 4.40309906e+01 4.38764877e+01 4.38961563e+01 4.38961563e+01
 4.38603287e+01 4.40220795e+01 4.38142204e+01 4.38275108e+01
 4.38330002e+01 4.38330002e+01 4.39116859e+01 4.39423752e+01
 4.39084549e+01 4.39611320e+01 4.39611320e+01 4.39608345e+01
 4.38293610e+01 4.38293610e+01 4.38162804e+01 4.38131218e+01
 4.38131218e+01 4.38148193e+01 4.39000549e+01 4.39000549e+01
 4.38809776e+01 4.38768539e+01 4.38015327e+01 4.38038750e+01
 4.38883133e+01 4.38883133e+01 4.38704491e+01 4.38551750e+01
 4.38551750e+01 4.38606529e+01 4.39610901e+01 4.39610901e+01
 4.39635201e+01 4.38362160e+01 4.38362160e+01 4.38186226e+01
 4.38552094e+01 4.38552094e+01 4.38507385e+01 4.38339081e+01
 4.38218498e+01 4.38218498e+01 4.38169937e+01 4.38007164e+01
 4.38467751e+01 4.38728027e+01 4.38728027e+01 4.38005905e+01
 4.38019829e+01 4.38238754e+01 4.39787254e+01 4.39757805e+01
 4.39757805e+01 4.38235588e+01 4.38239975e+01 4.38278770e+01
 4.38941841e+01 4.38095322e+01 4.38095322e+01 4.40078888e+01
 4.40124283e+01 4.37888985e+01 4.37910461e+01 4.39439583e+01
 4.39431839e+01 4.39431839e+01 4.39505234e+01 4.39506760e+01
 4.39506760e+01 4.38023148e+01 4.38037338e+01 4.38037338e+01
 4.39153938e+01 4.38022461e+01 4.37882729e+01 4.37893219e+01
 4.38006477e+01 4.39348869e+01 4.39483376e+01 4.39500160e+01
 4.39500160e+01 4.38025436e+01 4.39484367e+01 4.40082436e+01
 4.40082436e+01 4.39500847e+01 4.39496918e+01 4.39496918e+01
 4.39091301e+01 4.39424171e+01 4.39446297e+01 4.39446297e+01
 4.39687576e+01 4.38124733e+01 4.39430809e+01 4.39426613e+01
 4.39426613e+01 4.37546349e+01 4.37637367e+01 4.37637367e+01
 4.37866821e+01 4.67138634e+01 4.37876663e+01 4.39479446e+01
 4.37872887e+01 4.37956810e+01 4.39483414e+01 4.39501648e+01
 4.39501648e+01 4.39484673e+01 4.41927795e+01 4.41927795e+01
 4.39482918e+01 4.39499397e+01 4.39499397e+01 4.39426422e+01
 4.39459534e+01 4.39459534e+01 4.38148994e+01 4.37873421e+01
 4.41138458e+01 4.39083099e+01 4.39158669e+01 4.39158669e+01
 4.38053169e+01 4.38091507e+01 4.38118782e+01 4.38118782e+01
 4.39485321e+01 4.39490089e+01 4.39490089e+01 4.39049339e+01
 4.39049339e+01 4.37836571e+01 4.37836571e+01 4.38023987e+01
 4.38023987e+01 4.38304405e+01 4.38304405e+01 4.37771873e+01
 4.39446907e+01 4.39446907e+01 4.38937340e+01 4.38937340e+01
 4.38331375e+01 4.39200325e+01 4.39200325e+01 4.37921791e+01
 4.38962250e+01 4.38962250e+01 4.39470673e+01 4.39470673e+01
 4.39245872e+01 4.39245872e+01 4.39361916e+01 4.39361916e+01
 4.39735107e+01 4.39735107e+01 4.40395775e+01 4.40395775e+01
 4.39385452e+01 4.39385452e+01 4.40359344e+01 4.40359344e+01
 4.38906059e+01 4.38906059e+01 4.38291206e+01 4.38291206e+01
 4.37913322e+01 4.37913322e+01 1.24705019e+01 1.45867133e+00
 5.80400658e+01 1.45787644e+00 4.57629089e+01 4.35514717e+01
 6.99174500e+00 5.80396576e+01 5.35231262e+02 5.35231201e+02
 1.24835749e+01 1.24842701e+01 5.35231506e+02]
2025-06-02 15:52:29,297 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155229_update_17.json
2025-06-02 15:52:29,298 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:52:29,301 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155229_update_17.pth and as latest_checkpoint.pth
2025-06-02 15:52:29,301 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869605.dot): 0.4528
2025-06-02 15:52:29,301 - WARNING - Detected 3 anomalous nodes (reconstruction-based):
2025-06-02 15:52:29,301 - WARNING -   Node ID: 192.168.27.10, Recon Error: 20.1808, MLP Score: 0.9319
2025-06-02 15:52:29,301 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 21.1899, MLP Score: 0.9572
2025-06-02 15:52:29,301 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 21.5478, MLP Score: 0.9745
2025-06-02 15:52:29,301 - WARNING - Detected 8 anomalous edges (reconstruction-based):
2025-06-02 15:52:29,301 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2312, MLP Score: 0.0000
2025-06-02 15:52:29,301 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9363, MLP Score: 0.0000
2025-06-02 15:52:29,301 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7374, MLP Score: 0.0000
2025-06-02 15:52:29,301 - WARNING -   Source: 192.168.27.12, Target: 224.0.0.251, Recon Error: 535.2314, MLP Score: 0.0000
2025-06-02 15:52:29,301 - WARNING -   Source: 192.168.27.10, Target: 224.0.0.251, Recon Error: 535.2313, MLP Score: 0.0000
2025-06-02 15:52:29,301 - INFO - 
--- Processing file: nw_graph_encoded_1748869635.dot (Timestamp: 2025-06-02 15:07:15) ---
2025-06-02 15:52:29,301 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869635.dot
2025-06-02 15:52:29,301 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869635.dot'.
2025-06-02 15:52:29,301 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869635.dot
2025-06-02 15:52:29,316 - INFO - Parsed 511 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869635.dot'.
2025-06-02 15:52:29,331 - INFO - Parsed 1044 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869635.dot'.
2025-06-02 15:52:29,332 - INFO - Processing node updates/additions.
2025-06-02 15:52:29,336 - INFO - Processing edge updates/additions.
2025-06-02 15:52:29,343 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:52:29,344 - INFO - Finished updating NetworkX graph.
2025-06-02 15:52:29,344 - DEBUG - Updated graph - Nodes: 511, Edges: 1044
2025-06-02 15:52:29,344 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:52:29,345 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:52:29,351 - DEBUG - Initial node features tensor shape: torch.Size([511, 30])
2025-06-02 15:52:29,355 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:52:29,361 - DEBUG - Node features tensor shape after scaling: torch.Size([511, 30])
2025-06-02 15:52:29,362 - DEBUG - Edge index tensor shape: torch.Size([2, 1044])
2025-06-02 15:52:29,363 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:52:29,366 - DEBUG - Initial edge attributes tensor shape: torch.Size([1044, 10])
2025-06-02 15:52:29,369 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:52:29,371 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1044, 10])
2025-06-02 15:52:29,371 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:52:29,371 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:52:29,372 - INFO - Updated main graph to 511 nodes and 1044 edges.
2025-06-02 15:52:29,372 - INFO - Performing online update...
2025-06-02 15:52:29,372 - INFO - Starting online update for 50 steps.
2025-06-02 15:52:29,373 - DEBUG - Updated RunningStats: new_mean=0.9427810914453236, new_var=45000000000159.5, new_n=4530
2025-06-02 15:52:29,373 - DEBUG - Updated RunningStats: new_mean=0.9414364305096705, new_var=45300000000019.22, new_n=4560
2025-06-02 15:52:29,373 - DEBUG - Updated RunningStats: new_mean=43.72761819265955, new_var=15000000201219.84, new_n=1510
2025-06-02 15:52:29,373 - DEBUG - Updated RunningStats: new_mean=43.818622935740024, new_var=15100000292081.936, new_n=1520
2025-06-02 15:52:29,373 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:52:29,374 - DEBUG - Online update step: 1/50
2025-06-02 15:52:29,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,374 - DEBUG - Online update step: 2/50
2025-06-02 15:52:29,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,374 - DEBUG - Online update step: 3/50
2025-06-02 15:52:29,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,374 - DEBUG - Online update step: 4/50
2025-06-02 15:52:29,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,374 - DEBUG - Online update step: 5/50
2025-06-02 15:52:29,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,374 - DEBUG - Online update step: 6/50
2025-06-02 15:52:29,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,374 - DEBUG - Online update step: 7/50
2025-06-02 15:52:29,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,374 - DEBUG - Online update step: 8/50
2025-06-02 15:52:29,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,374 - DEBUG - Online update step: 9/50
2025-06-02 15:52:29,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,374 - DEBUG - Online update step: 10/50
2025-06-02 15:52:29,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,374 - DEBUG - Online update step: 11/50
2025-06-02 15:52:29,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,374 - DEBUG - Online update step: 12/50
2025-06-02 15:52:29,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,374 - DEBUG - Online update step: 13/50
2025-06-02 15:52:29,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,374 - DEBUG - Online update step: 14/50
2025-06-02 15:52:29,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,374 - DEBUG - Online update step: 15/50
2025-06-02 15:52:29,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,374 - DEBUG - Online update step: 16/50
2025-06-02 15:52:29,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,375 - DEBUG - Online update step: 17/50
2025-06-02 15:52:29,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,375 - DEBUG - Online update step: 18/50
2025-06-02 15:52:29,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,375 - DEBUG - Online update step: 19/50
2025-06-02 15:52:29,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,375 - DEBUG - Online update step: 20/50
2025-06-02 15:52:29,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,375 - DEBUG - Online update step: 21/50
2025-06-02 15:52:29,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,375 - DEBUG - Online update step: 22/50
2025-06-02 15:52:29,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,375 - DEBUG - Online update step: 23/50
2025-06-02 15:52:29,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,375 - DEBUG - Online update step: 24/50
2025-06-02 15:52:29,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,375 - DEBUG - Online update step: 25/50
2025-06-02 15:52:29,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,375 - DEBUG - Online update step: 26/50
2025-06-02 15:52:29,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,375 - DEBUG - Online update step: 27/50
2025-06-02 15:52:29,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,375 - DEBUG - Online update step: 28/50
2025-06-02 15:52:29,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,375 - DEBUG - Online update step: 29/50
2025-06-02 15:52:29,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,375 - DEBUG - Online update step: 30/50
2025-06-02 15:52:29,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,375 - DEBUG - Online update step: 31/50
2025-06-02 15:52:29,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,375 - DEBUG - Online update step: 32/50
2025-06-02 15:52:29,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,375 - DEBUG - Online update step: 33/50
2025-06-02 15:52:29,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,376 - DEBUG - Online update step: 34/50
2025-06-02 15:52:29,376 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,376 - DEBUG - Online update step: 35/50
2025-06-02 15:52:29,376 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,376 - DEBUG - Online update step: 36/50
2025-06-02 15:52:29,376 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,376 - DEBUG - Online update step: 37/50
2025-06-02 15:52:29,376 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,376 - DEBUG - Online update step: 38/50
2025-06-02 15:52:29,376 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,376 - DEBUG - Online update step: 39/50
2025-06-02 15:52:29,376 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,376 - DEBUG - Online update step: 40/50
2025-06-02 15:52:29,376 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,376 - DEBUG - Online update step: 41/50
2025-06-02 15:52:29,376 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,376 - DEBUG - Online update step: 42/50
2025-06-02 15:52:29,376 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,376 - DEBUG - Online update step: 43/50
2025-06-02 15:52:29,376 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,376 - DEBUG - Online update step: 44/50
2025-06-02 15:52:29,376 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,376 - DEBUG - Online update step: 45/50
2025-06-02 15:52:29,376 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,376 - DEBUG - Online update step: 46/50
2025-06-02 15:52:29,376 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,376 - DEBUG - Online update step: 47/50
2025-06-02 15:52:29,376 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,376 - DEBUG - Online update step: 48/50
2025-06-02 15:52:29,376 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,376 - DEBUG - Online update step: 49/50
2025-06-02 15:52:29,376 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,376 - DEBUG - Online update step: 50/50
2025-06-02 15:52:29,376 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,377 - WARNING - No successful steps during online update.
2025-06-02 15:52:29,377 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -2.4261773e-08  4.2924675e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.3593224e-08
  4.2924675e-08  1.3064032e-08  6.5320158e-09  1.8662902e-09
  2.4637964e+00  2.9491193e+00  1.2915851e-01  4.3170257e+00
 -1.3064032e-08  3.3874755e+00  5.5890412e+00  7.6066537e+00
  1.2915851e-01  8.0000000e+00  2.9860644e-08 -1.4930322e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.7994354e-09 -4.3857820e-08], current edge mean: [-4.5674056e-09  4.7269156e+02  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -2.2837028e-09 -4.5674056e-10 -7.3078490e-09
 -1.8269622e-09  1.3702217e-09]
2025-06-02 15:52:29,377 - DEBUG - Node drift difference: 0.0883, Edge drift difference: 0.0063
2025-06-02 15:52:29,378 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -2.4261773e-08  4.2924675e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.3593224e-08
  4.2924675e-08  1.3064032e-08  6.5320158e-09  1.8662902e-09
  2.4637964e+00  2.9491193e+00  1.2915851e-01  4.3170257e+00
 -1.3064032e-08  3.3874755e+00  5.5890412e+00  7.6066537e+00
  1.2915851e-01  8.0000000e+00  2.9860644e-08 -1.4930322e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.7994354e-09 -4.3857820e-08], edge=[-4.5674056e-09  4.7269156e+02  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -2.2837028e-09 -4.5674056e-10 -7.3078490e-09
 -1.8269622e-09  1.3702217e-09]
2025-06-02 15:52:29,378 - DEBUG - Updated reference std: node=[0.         0.         1.0009799  1.0009799  0.         0.
 0.         1.0009799  1.0009799  1.0009799  1.0009799  1.0009799
 0.99121654 0.31522512 0.3527915  0.5612344  1.0009799  3.1126812
 2.953794   1.5002859  0.3527915  0.         1.0009799  1.0009799
 0.         0.         0.         0.         1.0009799  1.0009799 ], edge=[  1.0004792 568.60004     0.          0.          1.0004793   1.0004792
   1.0004793   1.0004792   1.0004792   1.0004792]
2025-06-02 15:52:29,378 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:52:29,379 - INFO - Running anomaly detection...
2025-06-02 15:52:29,379 - INFO - Starting anomaly detection.
2025-06-02 15:52:29,384 - DEBUG - Node reconstruction errors: [16.470888  10.936077  18.256813  16.012774  10.208716   8.311033
 16.828001  12.441939  12.441939  12.9092455 12.441939  10.977573
 22.011217   8.764339  15.053588  16.342176  11.534158  16.353495
 17.203709  15.841707  12.033014  15.053589  12.179607  10.954806
 15.081563  12.486734  15.081563   9.813567  11.947266  15.081563
 10.625229  12.404239   9.38455   15.61356   12.565984  15.834643
  7.972128  15.841707  11.288297  11.909683  15.571232  14.65654
 15.841707  16.446558  16.01019   12.315662  17.934767   8.870886
 11.569808  16.080486  22.33998   12.245209  12.118949  16.582651
 11.470668  10.429239  18.418745  15.188595  15.695494  15.856943
  7.366747  15.683041  14.359728  10.20991   14.230591  11.470694
 11.766639  11.47061   14.359728  14.359728  11.241285   8.145294
 11.918477   7.43349    7.2327304  8.266423  15.086729   8.156168
  7.485652   7.2593756 14.637639   8.506046   7.33867   11.925082
 10.641567   9.920091   8.560841   7.2791595  7.080729   8.5784
 14.303489   8.359618   9.665848   7.274884  11.59282   22.863848
 14.398426   8.15868   14.232105  11.487777   8.158681  14.398426
 15.130934   8.118106   8.782699  11.228311  15.205371   7.1812463
  9.746822  13.620392  14.295323  14.897471   9.751151   9.971308
  8.386217   8.379831   8.277415   8.292954   7.0953884 11.525229
 14.447507   9.665847   9.601987   9.665848   6.9639826 11.985547
  9.621496   7.4260616  8.158682  14.936662  11.886747  11.434698
 14.867883   9.618666   8.37982   11.318082  15.15492   14.049841
  7.6679006  8.710697  11.613369   8.78774   14.675699  11.855042
 11.434701   8.143773   8.277414  11.237228  11.453123   7.1661844
 13.028278   9.367415   7.1990924 11.434701   7.044874   8.346422
 11.525229   8.488162   8.15868   14.82936   11.237228   7.659132
 11.525229  11.886746   8.286433   8.288644   8.158436   7.230799
  7.6960163  7.166186   7.1497626 11.525229  14.037466  17.660975
  7.336899  10.924661   7.166184   8.259875   8.219883   8.219881
 11.359292   9.092805  14.4382305  9.251734   9.3532715  8.170671
 14.414292   8.283851  14.655422  11.662466   7.280679   7.2978954
 11.554286  11.213968   9.954004  12.097587   9.663556  14.905676
  8.325469  14.936662  14.932103  11.525229   9.535639   7.1605678
  8.126832   9.665849  11.607251  10.337052  14.473387   7.2037187
  8.326742   8.170667  11.554286   7.1928873  8.170668  14.795817
  8.170667   8.277414   8.165365  11.213969   9.462006  14.414292
 13.99723   11.554286  11.525229   6.9752765  9.339079  11.141394
  7.1187186 15.305102   9.2903     8.497198   7.166188   8.277413
  8.2774105 12.097587   6.980472  13.99723   11.525229  14.546282
  8.166276   7.1095533 11.208395   7.166185  11.116797   8.379819
  8.351504   8.0390625 11.208395  11.375659  14.037465  13.927893
  8.165365   7.2308     8.37982    8.064534  11.1168    14.003826
 13.8864155  8.219881   7.1652956  8.693409  15.139004  11.1168
  7.1187196 11.282041   6.973328  15.139004   6.973327   8.219881
 10.0003195  9.670231   7.3657804 14.970816   8.242901   8.21988
 14.328755   7.397728  10.852987   8.219881   7.2080636 14.080148
  6.9157505 14.787217  11.116797  14.462275   8.462972   7.22626
  9.092806   9.307066  11.468457  14.351045  11.699308  11.116797
  9.144355  14.003826   8.219882   8.220346  11.554286  14.716071
  6.987164  14.046628   8.320112   8.320111  14.046628  14.046628
 14.046628   8.234746  14.276504  14.046628  14.046628   8.499661
 14.046628  11.798026   9.304338   7.228827   8.59503    9.352948
 11.617077  11.8711605  7.023511  11.724335   6.9074297  8.320112
 11.206808   9.353271  14.227923   8.234748   7.1652927  7.165295
  7.2737646 11.617077  14.046628   8.2429    14.046628   8.234746
 11.370549  13.8864155 14.227924  14.227924  14.046628  14.30111
 14.227923   7.023511   8.32011    6.9733267  8.32011   14.6588955
  6.952963   7.181833  14.046628   8.326741  15.149434   8.407558
 14.509875  11.554286  14.046628  14.046628  14.003826  14.003826
  8.326745  14.046628  14.227924   8.320243   8.320126  17.353857
 14.211051   9.526475   8.201728   7.9843264  7.145292   8.201727
  6.9333277  9.131378   7.21568    8.074754  13.994199  11.283018
  7.008116  14.046628   8.320112   7.364189  11.471057   7.4098434
  7.5699897  8.268404  10.998721   8.4395895  7.89706   14.046628
  8.61056    8.268406   8.422202   8.422204   7.983688   7.983688
  7.983688  15.557271  14.115671  15.717646  11.388312   8.571231
  7.983688  14.115671   8.277185   8.4222555  6.9880724 11.195255
  8.422205   7.26604    7.983688   8.422205  14.115671   7.983688
  7.983688  14.490447  14.3302145  7.983688  13.994223  14.069214
 11.599447  11.388312  14.069212  11.45364    9.131063  11.858553
 11.388312  14.334026   7.3859196 15.01618    7.0732927 11.093585
  7.983688   7.9096923  7.983688   7.983688  11.388312   7.909692
 15.01618   14.122083  14.122085  12.088924  14.41617   14.41617
 14.41617    7.7025366 12.040941  12.040941  12.040941  11.679206
  7.2318997 14.122085  11.679208  14.1946745 14.122085  11.686735
 11.663119  11.45364   14.4230995 11.45364   11.45364   11.663119
 11.45364   14.659216  11.663119  11.663119  13.972884  11.868386
  7.4308443 11.868384  13.972884  11.453642  11.663119   7.430843
 12.040941  11.45364   11.453642  11.45364   14.122085  11.679208
 14.4230995  7.7314672 14.069212  11.679208   7.6334505 14.039834
 14.122085   7.430844  15.065014  11.868384  11.45364   14.122085
 11.679208  14.069212  11.679208  11.663119  11.679206  15.666341
 14.1946745 11.679208  11.679208  14.252316  11.679206  14.148946
 14.039831  15.065014  14.1946745 10.178345  12.336444  14.122085
 15.065013 ]
2025-06-02 15:52:29,384 - DEBUG - Edge reconstruction errors: [  4.481762    4.6788163   6.9866343 ...  12.468406   12.722382
 535.24255  ]
2025-06-02 15:52:29,386 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155229_update_18.json
2025-06-02 15:52:29,386 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:52:29,390 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155229_update_18.pth and as latest_checkpoint.pth
2025-06-02 15:52:29,390 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869635.dot): 0.4545
2025-06-02 15:52:29,390 - WARNING - Detected 3 anomalous nodes (reconstruction-based):
2025-06-02 15:52:29,390 - WARNING -   Node ID: 192.168.27.10, Recon Error: 22.0112, MLP Score: 0.9395
2025-06-02 15:52:29,390 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 22.3400, MLP Score: 0.9640
2025-06-02 15:52:29,390 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 22.8638, MLP Score: 0.9792
2025-06-02 15:52:29,390 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-02 15:52:29,390 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2423, MLP Score: 0.0000
2025-06-02 15:52:29,390 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9448, MLP Score: 0.0000
2025-06-02 15:52:29,390 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0429, MLP Score: 0.0000
2025-06-02 15:52:29,390 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7453, MLP Score: 0.0000
2025-06-02 15:52:29,390 - WARNING -   Source: 192.168.27.12, Target: 224.0.0.251, Recon Error: 535.2425, MLP Score: 0.0000
2025-06-02 15:52:29,390 - INFO - 
--- Processing file: nw_graph_encoded_1748869665.dot (Timestamp: 2025-06-02 15:07:45) ---
2025-06-02 15:52:29,391 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869665.dot
2025-06-02 15:52:29,391 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869665.dot'.
2025-06-02 15:52:29,391 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869665.dot
2025-06-02 15:52:29,406 - INFO - Parsed 547 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869665.dot'.
2025-06-02 15:52:29,422 - INFO - Parsed 1118 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869665.dot'.
2025-06-02 15:52:29,422 - INFO - Processing node updates/additions.
2025-06-02 15:52:29,425 - INFO - Processing edge updates/additions.
2025-06-02 15:52:29,431 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:52:29,432 - INFO - Finished updating NetworkX graph.
2025-06-02 15:52:29,432 - DEBUG - Updated graph - Nodes: 547, Edges: 1118
2025-06-02 15:52:29,432 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:52:29,433 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:52:29,438 - DEBUG - Initial node features tensor shape: torch.Size([547, 30])
2025-06-02 15:52:29,439 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:52:29,439 - DEBUG - Node features tensor shape after scaling: torch.Size([547, 30])
2025-06-02 15:52:29,440 - DEBUG - Edge index tensor shape: torch.Size([2, 1118])
2025-06-02 15:52:29,441 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:52:29,443 - DEBUG - Initial edge attributes tensor shape: torch.Size([1118, 10])
2025-06-02 15:52:29,444 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:52:29,444 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1118, 10])
2025-06-02 15:52:29,444 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:52:29,444 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:52:29,445 - INFO - Updated main graph to 547 nodes and 1118 edges.
2025-06-02 15:52:29,445 - INFO - Performing online update...
2025-06-02 15:52:29,445 - INFO - Starting online update for 50 steps.
2025-06-02 15:52:29,445 - DEBUG - Updated RunningStats: new_mean=0.9428189081406742, new_var=45600000000160.15, new_n=4590
2025-06-02 15:52:29,445 - DEBUG - Updated RunningStats: new_mean=0.9414850456282373, new_var=45900000000018.984, new_n=4620
2025-06-02 15:52:29,445 - DEBUG - Updated RunningStats: new_mean=43.83989094781255, new_var=15200000199530.107, new_n=1530
2025-06-02 15:52:29,446 - DEBUG - Updated RunningStats: new_mean=43.91657704777844, new_var=15300000272365.771, new_n=1540
2025-06-02 15:52:29,446 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:52:29,446 - DEBUG - Online update step: 1/50
2025-06-02 15:52:29,446 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,446 - DEBUG - Online update step: 2/50
2025-06-02 15:52:29,446 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,446 - DEBUG - Online update step: 3/50
2025-06-02 15:52:29,446 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,446 - DEBUG - Online update step: 4/50
2025-06-02 15:52:29,446 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,446 - DEBUG - Online update step: 5/50
2025-06-02 15:52:29,446 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,446 - DEBUG - Online update step: 6/50
2025-06-02 15:52:29,446 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,446 - DEBUG - Online update step: 7/50
2025-06-02 15:52:29,446 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,446 - DEBUG - Online update step: 8/50
2025-06-02 15:52:29,446 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,446 - DEBUG - Online update step: 9/50
2025-06-02 15:52:29,446 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,446 - DEBUG - Online update step: 10/50
2025-06-02 15:52:29,446 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,446 - DEBUG - Online update step: 11/50
2025-06-02 15:52:29,446 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,446 - DEBUG - Online update step: 12/50
2025-06-02 15:52:29,446 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,446 - DEBUG - Online update step: 13/50
2025-06-02 15:52:29,446 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,446 - DEBUG - Online update step: 14/50
2025-06-02 15:52:29,446 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,446 - DEBUG - Online update step: 15/50
2025-06-02 15:52:29,446 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,446 - DEBUG - Online update step: 16/50
2025-06-02 15:52:29,446 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,446 - DEBUG - Online update step: 17/50
2025-06-02 15:52:29,446 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,446 - DEBUG - Online update step: 18/50
2025-06-02 15:52:29,447 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,447 - DEBUG - Online update step: 19/50
2025-06-02 15:52:29,447 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,447 - DEBUG - Online update step: 20/50
2025-06-02 15:52:29,447 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,447 - DEBUG - Online update step: 21/50
2025-06-02 15:52:29,447 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,447 - DEBUG - Online update step: 22/50
2025-06-02 15:52:29,447 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,447 - DEBUG - Online update step: 23/50
2025-06-02 15:52:29,447 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,447 - DEBUG - Online update step: 24/50
2025-06-02 15:52:29,447 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,447 - DEBUG - Online update step: 25/50
2025-06-02 15:52:29,447 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,447 - DEBUG - Online update step: 26/50
2025-06-02 15:52:29,447 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,447 - DEBUG - Online update step: 27/50
2025-06-02 15:52:29,447 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,447 - DEBUG - Online update step: 28/50
2025-06-02 15:52:29,447 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,447 - DEBUG - Online update step: 29/50
2025-06-02 15:52:29,447 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,447 - DEBUG - Online update step: 30/50
2025-06-02 15:52:29,447 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,447 - DEBUG - Online update step: 31/50
2025-06-02 15:52:29,447 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,447 - DEBUG - Online update step: 32/50
2025-06-02 15:52:29,447 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,447 - DEBUG - Online update step: 33/50
2025-06-02 15:52:29,447 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,447 - DEBUG - Online update step: 34/50
2025-06-02 15:52:29,447 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,447 - DEBUG - Online update step: 35/50
2025-06-02 15:52:29,447 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,447 - DEBUG - Online update step: 36/50
2025-06-02 15:52:29,447 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,447 - DEBUG - Online update step: 37/50
2025-06-02 15:52:29,447 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,447 - DEBUG - Online update step: 38/50
2025-06-02 15:52:29,447 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,447 - DEBUG - Online update step: 39/50
2025-06-02 15:52:29,448 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,448 - DEBUG - Online update step: 40/50
2025-06-02 15:52:29,448 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,448 - DEBUG - Online update step: 41/50
2025-06-02 15:52:29,448 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,448 - DEBUG - Online update step: 42/50
2025-06-02 15:52:29,448 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,448 - DEBUG - Online update step: 43/50
2025-06-02 15:52:29,448 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,448 - DEBUG - Online update step: 44/50
2025-06-02 15:52:29,448 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,448 - DEBUG - Online update step: 45/50
2025-06-02 15:52:29,448 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,448 - DEBUG - Online update step: 46/50
2025-06-02 15:52:29,448 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,448 - DEBUG - Online update step: 47/50
2025-06-02 15:52:29,448 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,448 - DEBUG - Online update step: 48/50
2025-06-02 15:52:29,448 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,448 - DEBUG - Online update step: 49/50
2025-06-02 15:52:29,448 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,448 - DEBUG - Online update step: 50/50
2025-06-02 15:52:29,448 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,448 - WARNING - No successful steps during online update.
2025-06-02 15:52:29,449 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -4.7073502e-08 -9.5890469e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.3947705e-08
  2.2665020e-08  4.3586578e-08 -1.7761531e-08  2.0485691e-08
  2.4442413e+00  2.9524679e+00  1.2065814e-01  4.3254113e+00
 -4.3586578e-08  3.3436928e+00  5.6709323e+00  7.6106033e+00
  1.2065814e-01  8.0000000e+00 -1.7434632e-08  2.7895410e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.1793289e-08  6.7995060e-08], current edge mean: [ 1.2795273e-09  4.7072629e+02  0.0000000e+00  0.0000000e+00
 -2.7723090e-09 -1.2795273e-09 -4.2650909e-09 -8.5301816e-10
 -4.2650908e-10 -5.1181090e-09]
2025-06-02 15:52:29,449 - DEBUG - Node drift difference: 0.0277, Edge drift difference: 0.0035
2025-06-02 15:52:29,449 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -4.7073502e-08 -9.5890469e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.3947705e-08
  2.2665020e-08  4.3586578e-08 -1.7761531e-08  2.0485691e-08
  2.4442413e+00  2.9524679e+00  1.2065814e-01  4.3254113e+00
 -4.3586578e-08  3.3436928e+00  5.6709323e+00  7.6106033e+00
  1.2065814e-01  8.0000000e+00 -1.7434632e-08  2.7895410e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.1793289e-08  6.7995060e-08], edge=[ 1.2795273e-09  4.7072629e+02  0.0000000e+00  0.0000000e+00
 -2.7723090e-09 -1.2795273e-09 -4.2650909e-09 -8.5301816e-10
 -4.2650908e-10 -5.1181090e-09]
2025-06-02 15:52:29,450 - DEBUG - Updated reference std: node=[0.         0.         1.0009154  1.0009153  0.         0.
 0.         1.0009153  1.0009153  1.0009153  1.0009153  1.0009153
 1.0682304  0.30491748 0.34246618 0.56139016 1.0009153  3.063846
 2.9354372  1.4923851  0.34246618 0.         1.0009153  1.0009153
 0.         0.         0.         0.         1.0009153  1.0009153 ], edge=[  1.0004476 549.4924      0.          0.          1.0004475   1.0004475
   1.0004475   1.0004476   1.0004475   1.0004475]
2025-06-02 15:52:29,450 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:52:29,450 - INFO - Running anomaly detection...
2025-06-02 15:52:29,450 - INFO - Starting anomaly detection.
2025-06-02 15:52:29,455 - DEBUG - Node reconstruction errors: [16.400103  11.336291  18.98941   16.00305   10.264651   8.415108
 17.52484   12.3703165 12.3703165 12.833309  12.3703165 10.934951
 22.818483   8.673559  14.984104  16.235792  11.467545  16.24755
 17.256012  15.74632   11.949451  14.984104  12.492481  10.827634
 15.003479  12.501012  15.003479   9.701283  11.886548  15.003479
 10.639989  12.3362665  9.259379  15.623304  12.589407  15.744182
  7.9665923 15.74632   11.068176  11.816936  15.501356  14.591741
 15.74632   16.70609   15.90421   12.466366  17.823153   8.580088
 11.513006  16.093725  22.924671  12.194727  12.1367445 16.589727
 11.463895  10.76964   19.056677  15.097397  15.851353  16.024954
  7.3786807 15.568729  14.297416  10.110429  14.232387  11.463923
 11.755555  11.463843  14.297416  14.297416  11.236834   8.183991
 11.86476    7.485275   7.325052   8.309808  15.022952   8.166493
  7.5130687  7.3236833 14.647739   8.5147915  7.2717896 10.876248
 10.660668   9.878699   8.554762   7.5065403  7.148473   8.696147
 14.296977   8.439306   9.68075    7.299787  11.507762  23.496868
 14.39082    8.615535  14.153711  11.4527855  8.163348  14.39082
 15.100935   8.923381   8.75614   11.179418  15.154126   7.1963134
  9.733624  13.702226  14.479481  14.8854885  9.746892   9.904718
  8.386555   8.406168   8.271342   8.371363   7.1303835 11.477687
 14.408537   9.680751   9.590739   9.804679   7.0233417 11.929544
  9.575822   7.554315   8.163346  15.006483  11.803843  11.417145
 14.86145    9.6508875  8.406161  11.280914  15.251508  13.981207
  7.61299    8.772666  11.5773535  8.739585  14.643795  11.79074
 11.417145   8.138937   8.271341  11.251219  11.369449   7.1827803
 13.045895   9.315415   7.2001295 11.417145   7.108233   8.378675
 11.477687   8.686395   8.163347  14.8357525 11.251219   7.635499
 11.477687  11.80384    8.286044   8.319341   8.10737    7.341657
  7.6417227  7.182782   7.2111964 11.693131  14.035186  18.229906
  7.3562665 11.085909   7.18278    8.274421   8.2242565  8.2242565
 11.2682905  9.089528  14.426615   9.244664   8.1621     8.20139
 14.6111555  8.284534  11.373262  11.569766   7.2798204  7.3065844
 11.539834  11.207457   7.6129885 12.029587   9.633175  14.857924
  8.343922  14.934549  14.845639  11.477687   9.81212    7.1999197
  8.164756   9.680751  11.528803  10.371033  14.375226   7.1853995
  8.329184   8.201386  11.539834   7.407293   8.201388  14.735027
  8.201388   8.271343   8.178631  11.207456   9.435785  14.611158
 13.977639  11.539834  11.477688   6.997397   9.367387  11.143498
  7.145831  15.298237   9.289786   8.554697   7.270479   8.271342
  8.271342  12.029587   7.004671  13.977639  11.477687  14.523978
  8.19784    7.392388  11.205013   7.1827793 11.1032915  8.406159
  8.553813   8.049024  11.205012  11.758422  14.035186  13.914719
  8.178631   7.2502837  8.4061575  8.098321  11.569766  14.620133
 13.856101   8.2242565  7.2548385  8.676398  15.101408  11.569767
  7.1458306 11.600281   6.954854  15.101408   6.954852   8.224257
  9.851014   9.491481   7.3214035 14.620133   8.169699   8.224257
 14.295327   7.430677  11.2682905  8.459201   7.4326935 14.062806
  6.936659  14.709768  11.1032915 14.387964   8.543696   7.4809003
  9.089528   9.882343  12.363886  14.749799  11.607944  11.103291
  9.092013  13.919303   7.2659726  8.22466   12.029587  14.681494
  6.9928465 13.9475     8.257395   8.257394  13.9475    13.9475
 13.9475     8.167253  14.155153  13.9475    13.947504   7.3028736
 13.9475    11.7291     9.46454    7.208002   8.587413   9.341468
 11.576803  12.029587   6.9753385 11.624198   6.941148   8.257395
 11.16632    9.367535  14.12891    8.167254   7.140224   7.1402254
  7.2301173 11.576804  13.9475     8.169699  13.947504   8.167254
 11.532537  13.8561    14.128911  14.128911  13.9475    14.275004
 14.128911   6.975339   7.079783   6.9548535  8.257397  14.566885
  6.946276   7.190088  13.9475     8.494993   9.686196   8.394162
 14.465183  11.569766  14.409306  13.9475    13.919303  13.919303
  8.329185  13.9475    14.128911   8.257532   8.257413  18.041557
 14.16778    9.31105    8.205825   8.323537   7.2310824  8.205827
  6.93553    9.277755   7.165112   8.003261  13.976804  11.189848
  6.9976225 13.947503   8.257398   7.3026147 11.400814   7.400849
  7.506541   8.276373  10.974842   8.410902   7.835559  13.947504
  8.568525   8.276376   8.381019   8.381018   7.891203   7.891203
  7.891203  15.646997  13.990553  15.819682  11.312335   8.546947
  7.891203  13.990553   8.415185   8.38106    6.9243593 11.167652
  8.381015   7.190375   7.891203   8.381016  13.990553   7.891203
  7.891203  14.444941  14.301471   7.891203  13.976809  14.01751
 11.578145  11.312335  14.01751   11.41282    9.14117   11.7672825
 11.519793   8.615918   7.3117843 15.018231   6.9933724 11.022177
  7.891203   8.094607   7.891203   7.891205  11.312335   7.889681
  9.392474  14.117147  14.117147  11.565247  14.402509  14.402509
 14.402509   7.579291  12.012314  12.012316  12.012316  11.616716
  7.1795797 14.117147  11.616716  14.091922  14.117147  11.644469
 11.594478  11.41282   14.436481  11.412818  11.412816  11.594478
 11.412816  17.622934  11.594476  11.594476  13.906736  11.795984
  7.3583403 11.795983  13.906736  11.412816  11.594478   7.3583393
 12.012316  11.412816  11.412816  11.412816  14.117147  11.616716
 14.504094   7.6168947 14.01751   11.616716   7.5402555 14.018797
 14.117147   7.35834   15.072512  11.795983  11.412816  14.117147
 11.616716  14.01751   11.616718  11.594478  11.616716  15.687475
 14.091923  11.616716  11.616716  14.253642  11.616716  14.151978
 14.018797  15.072512  14.091922  10.128398  12.31775   14.117147
 15.072512  14.091922  11.565245  14.117147  14.091922  14.117147
 14.091922  14.091922  14.117147  11.565245  14.091922  11.974767
 14.091922  12.012316  14.018797  14.117147  11.565245   9.230233
 14.091922   7.179579  14.117147  14.091922  14.091922  11.616716
 11.616716   8.123757  10.083499  11.616716  14.091922   8.1237545
 14.091922   8.123757  14.117147  14.091922  11.565245  11.565244
 14.091922 ]
2025-06-02 15:52:29,455 - DEBUG - Edge reconstruction errors: [  4.4807305   4.673925    6.9869847 ...  12.464873   12.690727
 535.24524  ]
2025-06-02 15:52:29,456 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155229_update_19.json
2025-06-02 15:52:29,456 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:52:29,459 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155229_update_19.pth and as latest_checkpoint.pth
2025-06-02 15:52:29,459 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869665.dot): 0.4483
2025-06-02 15:52:29,459 - WARNING - Detected 5 anomalous nodes (reconstruction-based):
2025-06-02 15:52:29,459 - WARNING -   Node ID: 192.168.27.13, Recon Error: 18.9894, MLP Score: 0.9346
2025-06-02 15:52:29,459 - WARNING -   Node ID: 192.168.27.10, Recon Error: 22.8185, MLP Score: 0.9412
2025-06-02 15:52:29,459 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 22.9247, MLP Score: 0.9669
2025-06-02 15:52:29,459 - WARNING -   Node ID: 192.168.209.130, Recon Error: 19.0567, MLP Score: 0.6871
2025-06-02 15:52:29,459 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 23.4969, MLP Score: 0.9809
2025-06-02 15:52:29,459 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-02 15:52:29,460 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2449, MLP Score: 0.0000
2025-06-02 15:52:29,460 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9471, MLP Score: 0.0000
2025-06-02 15:52:29,460 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0455, MLP Score: 0.0000
2025-06-02 15:52:29,460 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7474, MLP Score: 0.0000
2025-06-02 15:52:29,460 - WARNING -   Source: 192.168.27.12, Target: 224.0.0.251, Recon Error: 535.2452, MLP Score: 0.0000
2025-06-02 15:52:29,460 - INFO - 
--- Processing file: nw_graph_encoded_1748869695.dot (Timestamp: 2025-06-02 15:08:15) ---
2025-06-02 15:52:29,460 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869695.dot
2025-06-02 15:52:29,460 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869695.dot'.
2025-06-02 15:52:29,460 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869695.dot
2025-06-02 15:52:29,477 - INFO - Parsed 640 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869695.dot'.
2025-06-02 15:52:29,496 - INFO - Parsed 1300 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869695.dot'.
2025-06-02 15:52:29,496 - INFO - Processing node updates/additions.
2025-06-02 15:52:29,502 - INFO - Processing edge updates/additions.
2025-06-02 15:52:29,513 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:52:29,514 - INFO - Finished updating NetworkX graph.
2025-06-02 15:52:29,514 - DEBUG - Updated graph - Nodes: 640, Edges: 1300
2025-06-02 15:52:29,515 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:52:29,516 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:52:29,525 - DEBUG - Initial node features tensor shape: torch.Size([640, 30])
2025-06-02 15:52:29,527 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:52:29,527 - DEBUG - Node features tensor shape after scaling: torch.Size([640, 30])
2025-06-02 15:52:29,529 - DEBUG - Edge index tensor shape: torch.Size([2, 1300])
2025-06-02 15:52:29,530 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:52:29,534 - DEBUG - Initial edge attributes tensor shape: torch.Size([1300, 10])
2025-06-02 15:52:29,537 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:52:29,540 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1300, 10])
2025-06-02 15:52:29,540 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:52:29,540 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:52:29,541 - INFO - Updated main graph to 640 nodes and 1300 edges.
2025-06-02 15:52:29,541 - INFO - Performing online update...
2025-06-02 15:52:29,542 - INFO - Starting online update for 50 steps.
2025-06-02 15:52:29,542 - DEBUG - Updated RunningStats: new_mean=0.9428753302005451, new_var=46200000000161.19, new_n=4650
2025-06-02 15:52:29,542 - DEBUG - Updated RunningStats: new_mean=0.9415500396042208, new_var=46500000000018.836, new_n=4680
2025-06-02 15:52:29,543 - DEBUG - Updated RunningStats: new_mean=43.93385570737614, new_var=15400000195467.791, new_n=1550
2025-06-02 15:52:29,543 - DEBUG - Updated RunningStats: new_mean=43.98365551260028, new_var=15500000233999.092, new_n=1560
2025-06-02 15:52:29,543 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:52:29,543 - DEBUG - Online update step: 1/50
2025-06-02 15:52:29,543 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,543 - DEBUG - Online update step: 2/50
2025-06-02 15:52:29,543 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,543 - DEBUG - Online update step: 3/50
2025-06-02 15:52:29,543 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,543 - DEBUG - Online update step: 4/50
2025-06-02 15:52:29,543 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,543 - DEBUG - Online update step: 5/50
2025-06-02 15:52:29,543 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,543 - DEBUG - Online update step: 6/50
2025-06-02 15:52:29,543 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,543 - DEBUG - Online update step: 7/50
2025-06-02 15:52:29,543 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,543 - DEBUG - Online update step: 8/50
2025-06-02 15:52:29,544 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,544 - DEBUG - Online update step: 9/50
2025-06-02 15:52:29,544 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,544 - DEBUG - Online update step: 10/50
2025-06-02 15:52:29,544 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,544 - DEBUG - Online update step: 11/50
2025-06-02 15:52:29,544 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,544 - DEBUG - Online update step: 12/50
2025-06-02 15:52:29,544 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,544 - DEBUG - Online update step: 13/50
2025-06-02 15:52:29,544 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,544 - DEBUG - Online update step: 14/50
2025-06-02 15:52:29,544 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,544 - DEBUG - Online update step: 15/50
2025-06-02 15:52:29,544 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,544 - DEBUG - Online update step: 16/50
2025-06-02 15:52:29,544 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,544 - DEBUG - Online update step: 17/50
2025-06-02 15:52:29,544 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,544 - DEBUG - Online update step: 18/50
2025-06-02 15:52:29,544 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,544 - DEBUG - Online update step: 19/50
2025-06-02 15:52:29,544 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,544 - DEBUG - Online update step: 20/50
2025-06-02 15:52:29,544 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,544 - DEBUG - Online update step: 21/50
2025-06-02 15:52:29,544 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,544 - DEBUG - Online update step: 22/50
2025-06-02 15:52:29,544 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,544 - DEBUG - Online update step: 23/50
2025-06-02 15:52:29,544 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,545 - DEBUG - Online update step: 24/50
2025-06-02 15:52:29,545 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,545 - DEBUG - Online update step: 25/50
2025-06-02 15:52:29,545 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,545 - DEBUG - Online update step: 26/50
2025-06-02 15:52:29,545 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,545 - DEBUG - Online update step: 27/50
2025-06-02 15:52:29,545 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,545 - DEBUG - Online update step: 28/50
2025-06-02 15:52:29,545 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,545 - DEBUG - Online update step: 29/50
2025-06-02 15:52:29,545 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,545 - DEBUG - Online update step: 30/50
2025-06-02 15:52:29,545 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,545 - DEBUG - Online update step: 31/50
2025-06-02 15:52:29,545 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,545 - DEBUG - Online update step: 32/50
2025-06-02 15:52:29,545 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,545 - DEBUG - Online update step: 33/50
2025-06-02 15:52:29,545 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,545 - DEBUG - Online update step: 34/50
2025-06-02 15:52:29,545 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,545 - DEBUG - Online update step: 35/50
2025-06-02 15:52:29,545 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,545 - DEBUG - Online update step: 36/50
2025-06-02 15:52:29,545 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,545 - DEBUG - Online update step: 37/50
2025-06-02 15:52:29,546 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,546 - DEBUG - Online update step: 38/50
2025-06-02 15:52:29,546 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,546 - DEBUG - Online update step: 39/50
2025-06-02 15:52:29,546 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,546 - DEBUG - Online update step: 40/50
2025-06-02 15:52:29,546 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,546 - DEBUG - Online update step: 41/50
2025-06-02 15:52:29,546 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,546 - DEBUG - Online update step: 42/50
2025-06-02 15:52:29,546 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,546 - DEBUG - Online update step: 43/50
2025-06-02 15:52:29,546 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,546 - DEBUG - Online update step: 44/50
2025-06-02 15:52:29,546 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,546 - DEBUG - Online update step: 45/50
2025-06-02 15:52:29,546 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,546 - DEBUG - Online update step: 46/50
2025-06-02 15:52:29,546 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,546 - DEBUG - Online update step: 47/50
2025-06-02 15:52:29,546 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,546 - DEBUG - Online update step: 48/50
2025-06-02 15:52:29,546 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,546 - DEBUG - Online update step: 49/50
2025-06-02 15:52:29,546 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,546 - DEBUG - Online update step: 50/50
2025-06-02 15:52:29,546 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,546 - WARNING - No successful steps during online update.
2025-06-02 15:52:29,547 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -8.9406971e-09 -2.9802323e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.7136335e-08
  4.4703484e-08  5.9604646e-09 -2.9802323e-09  2.9802323e-09
  2.3671875e+00  2.9562500e+00  1.2968750e-01  4.3890624e+00
 -5.9604646e-09  3.3890624e+00  5.7390623e+00  7.6093750e+00
  1.2968750e-01  8.0000000e+00  2.9057265e-08 -3.3527612e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -5.2154064e-08  2.9802322e-08], current edge mean: [-9.5367430e-09  4.6594769e+02  0.0000000e+00  0.0000000e+00
 -1.4671913e-09  2.9343825e-09  1.4671913e-09 -1.0270338e-08
  1.4671913e-09 -1.4671913e-09]
2025-06-02 15:52:29,548 - DEBUG - Node drift difference: 0.1134, Edge drift difference: 0.0087
2025-06-02 15:52:29,548 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -8.9406971e-09 -2.9802323e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.7136335e-08
  4.4703484e-08  5.9604646e-09 -2.9802323e-09  2.9802323e-09
  2.3671875e+00  2.9562500e+00  1.2968750e-01  4.3890624e+00
 -5.9604646e-09  3.3890624e+00  5.7390623e+00  7.6093750e+00
  1.2968750e-01  8.0000000e+00  2.9057265e-08 -3.3527612e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -5.2154064e-08  2.9802322e-08], edge=[-9.5367430e-09  4.6594769e+02  0.0000000e+00  0.0000000e+00
 -1.4671913e-09  2.9343825e-09  1.4671913e-09 -1.0270338e-08
  1.4671913e-09 -1.4671913e-09]
2025-06-02 15:52:29,549 - DEBUG - Updated reference std: node=[0.         0.         1.0007821  1.0007823  0.         0.
 0.         1.0007821  1.0007821  1.0007821  1.0007821  1.0007821
 1.0366606  0.29277956 0.3543513  0.5707029  1.0007821  3.053545
 2.915992   1.4961315  0.3543513  0.         1.0007821  1.0007821
 0.         0.         0.         0.         1.0007821  1.0007821 ], edge=[  1.0003848 510.02356     0.          0.          1.0003848   1.0003848
   1.0003848   1.0003848   1.0003848   1.0003848]
2025-06-02 15:52:29,549 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:52:29,549 - INFO - Running anomaly detection...
2025-06-02 15:52:29,549 - INFO - Starting anomaly detection.
2025-06-02 15:52:29,565 - DEBUG - Node reconstruction errors: [16.296474  12.475286  20.885906  15.868936  10.282111   8.483361
 19.408077  12.359379  12.35938   12.819029  12.359379  10.824083
 25.273273   8.653998  14.867664  16.088142  11.307019  16.098307
 17.406101  15.631823  11.904288  14.867664  12.560953  10.598978
 14.878173  12.503043  14.878176   9.726624  11.90192   14.878176
 10.739789  12.346679   9.381226  15.527009  12.6028385 15.578497
  7.9451313 15.631823  11.041227  11.586323  15.394526  14.49062
 15.631823  16.540234  15.79224   12.554577  17.679108   8.663895
 11.541515  16.11853   24.234806  12.209684  12.148013  16.729328
 11.441057  10.794138  20.463264  14.999267  16.039753  16.22826
  7.429132  15.510364  14.198934   9.929676  14.133771  11.441084
 11.715145  11.441001  14.198934  14.1989355 11.215899   8.245852
 11.771465   7.570712   7.354539   8.376195  14.903235   8.204722
  7.5244837  7.407665  14.573075   8.501284   7.1800084 10.903798
 10.679351   9.716446   8.553349   7.5242357  7.2466917  8.7378645
 14.182678   8.569065   9.52804    7.3387933 11.425635  24.830462
 14.295062   8.553815  14.010085  11.38647    8.173316  14.295058
 14.955195   9.009772   8.68074   11.10027   15.184355   7.230779
  9.636184  13.668082  14.281923  14.769227   9.751387   9.909251
  8.359959   8.376822   8.243793   8.467259   7.1945825 11.837355
 14.23677    9.528041   9.571194   9.993037   7.1248064 11.837341
  9.423273   7.4759965  8.722013  14.964569  11.753827  11.379285
 14.765411   9.72663    8.376817  11.216389  15.183807  13.86463
  7.5313277  8.902928  11.505336   9.038686  14.462454  11.674509
 11.379285   8.149918   8.2437935 11.261719  11.320882   7.217157
 13.007296   9.423189   7.2891083 11.379285   7.205625   8.443399
 11.391553   8.642843   8.173315  14.729263  11.261719   7.5763025
 11.391553  11.753827   8.270301   8.393114   8.128556   7.348758
  7.552002   7.2795305  7.298029  11.562657  13.931429  19.491825
  7.4736075 11.541368   7.3349996  8.293038   8.208906   8.208903
 11.142787   9.045199  14.296195   9.258427   8.280664   8.179341
 14.419053   8.277546  11.255932  11.435081   7.304102   7.306922
 11.510306  11.191768   7.531328  11.88727    9.634538  14.676458
  8.401     14.726698  14.653615  11.391553   9.839536   7.266101
  8.224396   9.528041  11.488842  10.373202  14.186682   7.254831
  8.302271   8.1793375 11.510308   7.539694   8.179337  14.538304
  8.57355    8.243792   8.180067  11.191768   9.475252  14.419053
 13.84844   11.510308  11.391553   7.0298676  8.263617  11.144911
  7.1917243 15.203528   9.229425   7.1550345  7.343379   8.243793
  8.243793  11.88727    7.0377245 13.84844   11.391553  14.400193
  8.274775   7.4162965 11.195006   7.217155  11.079824   7.1129117
  8.542437   8.143268  11.195006  11.646292  13.931427  13.794271
  8.180068   7.2868276  8.376814   8.156079  11.43508   14.413183
 13.715659   8.208904   7.315878   8.60013   14.965521  11.435081
  7.1917233 11.469186   7.0131207 10.032858   7.0131216  8.208906
  9.840252   9.4788     7.323898  14.640399   8.142384   8.208904
 14.142268   7.4778214 11.142783   8.422814   8.140331  13.933728
  6.9676347 14.56995   11.696291  14.257268   8.457616   7.4038067
  9.045199   9.722322  11.696192  14.699882  11.544141  11.079824
  8.942747  13.779996   7.2661543  8.209298  11.88727   14.546962
  7.2810106 13.767517   8.227038   8.227036  13.767515  13.767517
 13.767517   8.133427  13.978211  13.767517  13.767517   7.3458276
 13.767517  11.6223755  9.321839   7.196797   8.592085   9.282904
 11.507198  11.887271   7.0096145 11.491225   6.9988513  8.227037
 11.474818   9.359763  13.954398   8.133429   7.1910067  7.191005
  7.3095703 11.961731  13.767515   8.142388  13.767517   8.133428
 11.63972   13.715659  13.954398  13.954398  13.767517  14.138743
 13.954398   7.009613   7.0569816  7.0131207  8.227035  14.405213
  7.02014    7.2030864 13.767515   8.677602   9.809875   8.515882
 14.299155  11.435081  14.424223  13.767515  13.779998  13.779996
  8.302271  11.653921  10.248012   7.057825   8.227049  19.295725
 14.001989   8.121386   8.204294   8.4060545  7.204579   7.1628237
  7.0509634  9.403626   7.150695   8.004505  13.837122  11.1279
  7.0274673 13.767517   8.227037   7.217014  11.712614   7.3968377
  7.3927665  8.262546  10.929175   8.332926   7.862979  13.767515
  8.474231   8.262544   8.318122   8.31812    7.858617   7.858618
  7.858617  15.745391  13.799632  15.933263  11.163332   8.471775
  7.858618  13.799632   8.35441    8.318158   6.926613  11.116529
  8.31812    7.062146   7.858617   8.318119  13.799628   7.858618
  7.858618  14.302641  14.130668   7.858617  13.837116  14.269674
 11.433063  11.163332   8.37636   11.280931   9.109907  11.6467495
 11.352859   8.5043     7.198352  14.990703   6.977683  10.879071
  7.858617   8.02257    7.858618   7.858617  11.163332   6.9466815
  9.509341  14.043616  14.126085  11.402621  14.329102  14.329102
 14.329102   7.3847733  8.587674  11.871431  11.87143   11.463237
  7.08927   13.921858  11.463237  13.891093  13.921858  11.536464
 11.468266  11.66014   14.350659   8.376357   8.249437  11.468265
 11.280931   9.266537  11.660138  11.468266  13.70682    8.376357
  7.2536216 11.684587  13.70682    8.249442   7.2411222  9.247703
  7.1175     8.377918   8.24944    8.249435  14.126085  11.463237
 14.435674   8.776753  13.838151  11.463237   9.123997  13.793573
 13.921858   7.5536547 15.022099   8.595249   8.376359  14.126085
  7.3252163 13.838151   8.403379  11.660138   8.403376  15.801996
 13.891093  11.463237  11.463237  14.269674  11.463237  13.947742
 13.793573  15.022099  14.098054   7.9849844 12.146265  13.921858
 15.022099  11.595683  11.595683  13.921854   8.460383  13.921858
 14.098051  13.891093  13.921854   7.3002105 13.891093  11.402621
 14.098051  11.871431  13.793573  13.921858  11.957363   9.12456
 13.891093   7.0892696 13.921858  13.891093  13.891093  11.463237
  8.403379   8.02152   10.003775   7.3252034 13.891093   8.02152
 13.891093   8.02152   14.048616  13.891093  11.595683  11.595683
 11.595683  13.982991  10.624364  13.982991  13.982991  13.982991
 13.982991  13.982991  13.982991  13.982993  13.982993  11.61636
 14.975169  13.982991  13.982991  13.982991  13.982993  13.982991
 13.982991  13.982993  13.982991  13.982991  13.982991  13.982991
 13.982991  13.982991  13.982993  13.921858  13.471249  13.891093
 14.436329   8.077564  17.010351  17.010351   7.0404973 14.436329
 13.891093  14.098051  14.098051  13.891093  14.098051  13.891093
 13.891093  13.982991  11.402621  13.891093  11.595683  13.891093
 13.891093  14.098051  13.891093  14.098051  13.891093  13.891093
 14.098051  14.098051  13.891093  14.098051  13.891093  13.891093
 13.891093   7.0612187  7.9616303  7.9616303 13.982991  11.25738
 13.768225  13.891093  14.098051  13.982993  13.982991  14.098051
  7.2231355 13.891093  13.891093  13.891093  14.015279   7.232358
  7.9616303 13.891093  13.982991  14.098051  14.098054   9.319053
 13.982991  14.098051  13.891093  13.982991  13.982991  13.982991
 13.891093  13.891093   9.765955   7.9616284]
2025-06-02 15:52:29,566 - DEBUG - Edge reconstruction errors: [  4.4806366   4.6607203  43.899353  ...  12.45782    12.673528
 535.24567  ]
2025-06-02 15:52:29,575 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155229_update_20.json
2025-06-02 15:52:29,576 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:52:29,579 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155229_update_20.pth and as latest_checkpoint.pth
2025-06-02 15:52:29,579 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869695.dot): 0.4447
2025-06-02 15:52:29,580 - WARNING - Detected 8 anomalous nodes (reconstruction-based):
2025-06-02 15:52:29,580 - WARNING -   Node ID: 192.168.27.13, Recon Error: 20.8859, MLP Score: 0.9421
2025-06-02 15:52:29,580 - WARNING -   Node ID: 192.168.27.12, Recon Error: 19.4081, MLP Score: 0.9375
2025-06-02 15:52:29,580 - WARNING -   Node ID: 192.168.27.10, Recon Error: 25.2733, MLP Score: 0.9458
2025-06-02 15:52:29,580 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 24.2348, MLP Score: 0.9704
2025-06-02 15:52:29,580 - WARNING -   Node ID: 192.168.209.130, Recon Error: 20.4633, MLP Score: 0.7087
2025-06-02 15:52:29,580 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-02 15:52:29,580 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2452, MLP Score: 0.0000
2025-06-02 15:52:29,580 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9476, MLP Score: 0.0000
2025-06-02 15:52:29,580 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0460, MLP Score: 0.0000
2025-06-02 15:52:29,580 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7479, MLP Score: 0.0000
2025-06-02 15:52:29,580 - WARNING -   Source: 192.168.27.12, Target: 224.0.0.251, Recon Error: 535.2457, MLP Score: 0.0000
2025-06-02 15:52:29,580 - INFO - 
--- Processing file: nw_graph_encoded_1748869725.dot (Timestamp: 2025-06-02 15:08:45) ---
2025-06-02 15:52:29,580 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869725.dot
2025-06-02 15:52:29,581 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869725.dot'.
2025-06-02 15:52:29,581 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869725.dot
2025-06-02 15:52:29,600 - INFO - Parsed 653 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869725.dot'.
2025-06-02 15:52:29,619 - INFO - Parsed 1355 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869725.dot'.
2025-06-02 15:52:29,619 - INFO - Processing node updates/additions.
2025-06-02 15:52:29,623 - INFO - Processing edge updates/additions.
2025-06-02 15:52:29,631 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:52:29,632 - INFO - Finished updating NetworkX graph.
2025-06-02 15:52:29,632 - DEBUG - Updated graph - Nodes: 653, Edges: 1355
2025-06-02 15:52:29,632 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:52:29,633 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:52:29,640 - DEBUG - Initial node features tensor shape: torch.Size([653, 30])
2025-06-02 15:52:29,641 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:52:29,641 - DEBUG - Node features tensor shape after scaling: torch.Size([653, 30])
2025-06-02 15:52:29,643 - DEBUG - Edge index tensor shape: torch.Size([2, 1355])
2025-06-02 15:52:29,644 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:52:29,647 - DEBUG - Initial edge attributes tensor shape: torch.Size([1355, 10])
2025-06-02 15:52:29,648 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:52:29,648 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1355, 10])
2025-06-02 15:52:29,648 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:52:29,648 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:52:29,649 - INFO - Updated main graph to 653 nodes and 1355 edges.
2025-06-02 15:52:29,649 - INFO - Performing online update...
2025-06-02 15:52:29,649 - INFO - Starting online update for 50 steps.
2025-06-02 15:52:29,649 - DEBUG - Updated RunningStats: new_mean=0.9429227778261812, new_var=46800000000160.6, new_n=4710
2025-06-02 15:52:29,650 - DEBUG - Updated RunningStats: new_mean=0.9416310689082805, new_var=47100000000019.1, new_n=4740
2025-06-02 15:52:29,650 - DEBUG - Updated RunningStats: new_mean=43.99890240100227, new_var=15600000193634.768, new_n=1570
2025-06-02 15:52:29,650 - DEBUG - Updated RunningStats: new_mean=44.0414158276711, new_var=15700000224891.875, new_n=1580
2025-06-02 15:52:29,650 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:52:29,650 - DEBUG - Online update step: 1/50
2025-06-02 15:52:29,650 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,650 - DEBUG - Online update step: 2/50
2025-06-02 15:52:29,650 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,650 - DEBUG - Online update step: 3/50
2025-06-02 15:52:29,650 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,650 - DEBUG - Online update step: 4/50
2025-06-02 15:52:29,650 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,650 - DEBUG - Online update step: 5/50
2025-06-02 15:52:29,650 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,650 - DEBUG - Online update step: 6/50
2025-06-02 15:52:29,650 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,650 - DEBUG - Online update step: 7/50
2025-06-02 15:52:29,650 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,650 - DEBUG - Online update step: 8/50
2025-06-02 15:52:29,651 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,651 - DEBUG - Online update step: 9/50
2025-06-02 15:52:29,651 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,651 - DEBUG - Online update step: 10/50
2025-06-02 15:52:29,651 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,651 - DEBUG - Online update step: 11/50
2025-06-02 15:52:29,651 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,651 - DEBUG - Online update step: 12/50
2025-06-02 15:52:29,651 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,651 - DEBUG - Online update step: 13/50
2025-06-02 15:52:29,651 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,651 - DEBUG - Online update step: 14/50
2025-06-02 15:52:29,651 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,651 - DEBUG - Online update step: 15/50
2025-06-02 15:52:29,651 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,651 - DEBUG - Online update step: 16/50
2025-06-02 15:52:29,651 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,651 - DEBUG - Online update step: 17/50
2025-06-02 15:52:29,651 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,651 - DEBUG - Online update step: 18/50
2025-06-02 15:52:29,651 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,651 - DEBUG - Online update step: 19/50
2025-06-02 15:52:29,651 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,651 - DEBUG - Online update step: 20/50
2025-06-02 15:52:29,651 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,651 - DEBUG - Online update step: 21/50
2025-06-02 15:52:29,651 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,651 - DEBUG - Online update step: 22/50
2025-06-02 15:52:29,651 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,651 - DEBUG - Online update step: 23/50
2025-06-02 15:52:29,651 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,651 - DEBUG - Online update step: 24/50
2025-06-02 15:52:29,651 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,651 - DEBUG - Online update step: 25/50
2025-06-02 15:52:29,651 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,651 - DEBUG - Online update step: 26/50
2025-06-02 15:52:29,651 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,651 - DEBUG - Online update step: 27/50
2025-06-02 15:52:29,651 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,652 - DEBUG - Online update step: 28/50
2025-06-02 15:52:29,652 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,652 - DEBUG - Online update step: 29/50
2025-06-02 15:52:29,652 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,652 - DEBUG - Online update step: 30/50
2025-06-02 15:52:29,652 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,652 - DEBUG - Online update step: 31/50
2025-06-02 15:52:29,652 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,652 - DEBUG - Online update step: 32/50
2025-06-02 15:52:29,652 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,652 - DEBUG - Online update step: 33/50
2025-06-02 15:52:29,652 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,652 - DEBUG - Online update step: 34/50
2025-06-02 15:52:29,652 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,652 - DEBUG - Online update step: 35/50
2025-06-02 15:52:29,652 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,652 - DEBUG - Online update step: 36/50
2025-06-02 15:52:29,652 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,652 - DEBUG - Online update step: 37/50
2025-06-02 15:52:29,652 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,652 - DEBUG - Online update step: 38/50
2025-06-02 15:52:29,652 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,652 - DEBUG - Online update step: 39/50
2025-06-02 15:52:29,652 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,652 - DEBUG - Online update step: 40/50
2025-06-02 15:52:29,652 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,652 - DEBUG - Online update step: 41/50
2025-06-02 15:52:29,652 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,652 - DEBUG - Online update step: 42/50
2025-06-02 15:52:29,652 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,652 - DEBUG - Online update step: 43/50
2025-06-02 15:52:29,652 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,652 - DEBUG - Online update step: 44/50
2025-06-02 15:52:29,652 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,652 - DEBUG - Online update step: 45/50
2025-06-02 15:52:29,652 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,652 - DEBUG - Online update step: 46/50
2025-06-02 15:52:29,652 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,652 - DEBUG - Online update step: 47/50
2025-06-02 15:52:29,653 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,653 - DEBUG - Online update step: 48/50
2025-06-02 15:52:29,653 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,653 - DEBUG - Online update step: 49/50
2025-06-02 15:52:29,653 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,653 - DEBUG - Online update step: 50/50
2025-06-02 15:52:29,653 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:29,653 - WARNING - No successful steps during online update.
2025-06-02 15:52:29,653 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -2.4827662e-08 -3.1399690e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.0223155e-08
  4.5273971e-08  5.8418030e-09  6.2069154e-09 -2.8478789e-08
  2.3614089e+00  2.9571209e+00  1.3935682e-01  4.3767228e+00
 -5.8418030e-09  3.4747319e+00  5.6738133e+00  7.5895867e+00
  1.3935682e-01  8.0000000e+00  2.5557888e-08  3.6511267e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.8843901e-08 -4.3813522e-08], current edge mean: [-4.9267306e-09  4.6377417e+02  0.0000000e+00  0.0000000e+00
  3.5190935e-09  1.0557281e-09 -1.4076373e-09  2.8152747e-09
  0.0000000e+00 -5.8065042e-09]
2025-06-02 15:52:29,653 - DEBUG - Node drift difference: 0.0281, Edge drift difference: 0.0043
2025-06-02 15:52:29,654 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -2.4827662e-08 -3.1399690e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.0223155e-08
  4.5273971e-08  5.8418030e-09  6.2069154e-09 -2.8478789e-08
  2.3614089e+00  2.9571209e+00  1.3935682e-01  4.3767228e+00
 -5.8418030e-09  3.4747319e+00  5.6738133e+00  7.5895867e+00
  1.3935682e-01  8.0000000e+00  2.5557888e-08  3.6511267e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.8843901e-08 -4.3813522e-08], edge=[-4.9267306e-09  4.6377417e+02  0.0000000e+00  0.0000000e+00
  3.5190935e-09  1.0557281e-09 -1.4076373e-09  2.8152747e-09
  0.0000000e+00 -5.8065042e-09]
2025-06-02 15:52:29,654 - DEBUG - Updated reference std: node=[0.         0.         1.0007665  1.0007666  0.         0.
 0.         1.0007665  1.0007665  1.0007665  1.0007665  1.0007666
 1.0142448  0.28991058 0.3638549  0.56661487 1.0007665  3.0958197
 2.9316137  1.5298709  0.3638549  0.         1.0007666  1.0007666
 0.         0.         0.         0.         1.0007666  1.0007665 ], edge=[  1.0003692 500.15765     0.          0.          1.0003692   1.0003692
   1.0003692   1.0003692   1.0003692   1.0003692]
2025-06-02 15:52:29,654 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:52:29,655 - INFO - Running anomaly detection...
2025-06-02 15:52:29,655 - INFO - Starting anomaly detection.
2025-06-02 15:52:29,660 - DEBUG - Node reconstruction errors: [16.324642  12.991428  21.16282   15.910294  10.294259   8.49143
 19.659369  12.376263  12.376263  12.835433  12.376265  10.867827
 25.633152   8.665567  14.919962  16.135605  11.349742  16.145649
 17.497288  15.6835575 11.923535  14.919962  12.6451025 10.622345
 14.929682  12.521644  14.929683   9.749654  11.923248  14.929682
 10.814025  12.367052   9.371658  15.576766  12.624615  15.871153
  7.960371  15.6835575 11.303589  11.61529   15.450468  14.544894
 15.6835575 16.572113  15.843201  12.550014  17.731876   8.666321
 11.564317  16.121899  24.466278  12.232695  12.169251  16.812048
 11.461683  10.80435   21.146544  15.050116  16.136084  16.32949
  7.442118  15.537685  14.252299  10.482159  14.18487   11.461712
 11.735969  11.461621  14.252299  14.252299  11.236408   8.26178
 11.781327   7.597571   7.370572   8.39404   15.600581   8.214748
  7.5396266  7.43243   14.625365   8.508592   7.1893845 10.9288435
 10.69849    9.747005   8.562439   7.5396338  7.2713532  8.756768
 14.234311   8.600039   9.557699   7.3582225 11.437188  25.076262
 14.339132   8.771827  14.057408  11.39992    8.181769  14.339132
 14.998972   8.990876   8.705342  11.1090975 15.213006   7.246394
  9.671423  13.755356  14.549395  14.819468   9.760457   9.925037
  8.364598   8.38159    8.245111   8.483978   7.2153497 11.833134
 14.280484   9.557698   9.584341  10.006481   7.1439166 11.8330965
  9.44968    7.486502   8.71841   14.996234  11.771486  11.395975
 14.813743   9.73353    8.38158   11.229477  15.221801  13.915575
  7.5417757  8.934485  11.517859   9.04665   14.502795  11.679437
 11.893426   8.158648   8.245112  11.282292  11.336703   7.232806
 13.053701   9.436906   7.3142486 11.395975   7.2281604  8.5710745
 11.400115   8.647386   8.18177   14.779833  11.2822895  7.590112
 11.400115  11.771486   8.274245   8.4165745  8.142747   7.3606067
  7.562903   7.289397   7.3208203 11.563577  13.983937  19.716217
  7.489929  11.60755    7.346482   8.294244   8.2112     8.211199
 11.142563   9.0742035 14.338608   9.274528   8.294928   8.182154
 14.457775   8.286366  11.2598095 11.434973   7.320395   7.325541
 11.525849  11.209429   7.541775  11.886069   9.972113  14.715942
  8.420607  14.757497  14.691266  11.400115   9.849223   7.28665
  8.244838   9.557698  11.506751  10.385947  14.230501   7.279177
  8.308031   8.182149  11.525845   7.5542126  8.182152  14.573025
  8.581176   8.2451105  8.184583  11.209429   9.48891   14.457775
 13.896702  11.525845  11.400115   7.04589    8.291394  11.161927
  7.2108135 15.252443   9.264852   7.168227   7.126411   8.245113
  8.245116  11.886069   7.0577946 13.8967    11.400115  14.443866
  8.295719   7.437957  11.214098   7.2328057 11.093644   7.12641
  8.547416   8.153063  11.214097  11.652604  13.983937  13.842646
  8.184581   7.3043776  8.381582   8.171387  11.434974  14.452677
 13.760761   8.211199   7.3304353  8.625045  15.007108  11.434973
  7.2108164 11.470874   7.033722  10.09007    7.033721   8.211199
  9.86178    9.499053   7.342497  14.658264   8.147946   8.211197
 14.183607   7.4977612 11.142563   8.422919   8.158338  13.978216
  7.263621  14.618764  11.6880455 14.300772   8.487366   7.4140506
  9.074203   9.745265  11.687918  14.742648  11.5586    11.093644
  8.957202  13.827326   7.2749033  8.211626  11.886069  14.587834
  7.289309  13.807606   8.22843    8.22843   13.807606  13.807606
 13.807606   8.139046  14.016774  13.807606  13.807606   7.354813
 13.807606  11.625921   9.589273   7.2068276  8.601975   9.3138895
 11.516281  11.886069   7.028898  11.49368    7.017139   8.22843
 11.464358   9.371866  13.999277   8.139044   7.2109146  7.210912
  7.327802  11.973299  13.807606   8.14795   13.807606   8.139044
 11.625133  13.760761  13.999277  13.999277  13.807606  14.181032
 13.999277   7.0288954  7.1527433  7.0337224  8.228429  14.446407
  7.0365415  7.2168255 13.807606   8.687308   9.677048   8.520247
 14.341102  11.434973  14.454144  13.807606  13.827326  13.827326
  8.308031  11.63501   10.2648325  7.116448   8.22844   19.620361
 14.04314    8.144948   8.215005   8.408111   7.3549733  7.1724777
  7.270851   9.420487   7.159106   8.019607  13.879569  11.139666
  7.0430193 13.807606   8.228428   7.2204833 11.711593   7.4068046
  7.3924766  8.265856  10.943609   8.353593   7.8812256 13.807606
  8.466689   8.265856   8.324067   8.32407    7.866592   7.8665895
  7.8665895 15.807609  13.836575  16.000135  11.162303   8.472556
  7.866592  13.836575   8.36054    8.324107   6.935174  11.129166
  8.32407    7.0562363  7.8665895  8.324068  13.836575   7.8665895
  7.8665895 14.341022  14.169456   7.8665895 13.879571  14.294977
 11.422955  11.162303   8.36639   11.277693   9.12343   11.64978
 11.336415   8.491552   7.2005296 15.033349   6.98549   10.881328
  7.866592   8.024783   7.8665895  7.8665895 11.162303   6.94927
  9.528746  14.079273  14.162916  11.402173  14.364899  14.364899
 14.364899   7.368221   8.587386  11.853354  11.853354  11.462952
  7.087026  13.95141   11.644946  13.916929  13.95141   11.538653
 11.46773   11.655895  14.384387   8.366392   8.252935  11.46773
 11.277693   9.298563  11.655897  11.467731  13.741637   8.366391
  7.2539587 11.687793  13.741637   8.25294    7.239821   9.803081
  7.1084666  8.367917   8.252935   8.252936  14.162916  11.462952
 14.474738   8.761827  13.877032  11.462952   9.141041  13.818804
 13.95141    7.537568  15.060034   9.811674   8.366392  14.162916
  7.317446  14.29498    8.39744   11.655895   8.397437  15.870921
 13.916931  11.462952  11.462952  14.29498   11.462952  13.980546
 13.818804  15.060034  14.135191   8.151635  11.644946  13.95141
 15.060034  11.586001  11.586     13.95141    8.457398  13.951413
 14.135191   8.457396  13.95141    7.2977076  8.457396  11.402172
 14.135191  11.853357  13.818807   8.397438  11.970017   9.1294365
  8.457395   7.0870256 13.951413  13.916929  13.916931  11.462952
  8.397435   8.0121     7.391336   7.1084433 13.916929   8.012104
 13.916929   8.0121    14.09033    8.457396  11.586     11.586
 11.586001  14.015608  10.645296  14.015609  14.015609  14.015609
 14.015608  14.015608  14.015609  14.015609  14.015608  11.611401
 15.015695  14.015608  14.015609  14.015608  14.015609  14.015609
 14.015609  14.015609  14.015608  14.015609  14.015608  14.015609
 14.015609   8.527709  14.015609  13.95141   13.50777   13.916929
 14.468985   8.071289  17.024525  17.024525   7.036899  14.468985
 13.916929  14.13519   14.135191  13.916929  14.135191  13.916931
 14.08176   14.015608  11.402173  13.916929  11.586     13.916929
 13.916931  14.135191  13.916931  14.13519   13.916929  13.916931
 14.135191  14.13519   13.916929  14.135191  13.916929  13.916931
 13.916931   7.0950713  7.950638   7.950638  14.015609  11.268499
 13.802722  13.916929  14.13519   14.015608  14.015609  14.13519
  7.200415  13.916929  13.916931  13.916931  14.050595   7.218203
  7.950638  13.916931   8.527708  14.135191  14.135191   9.326132
 14.015609  14.135191   8.457393  14.015609  14.015609  14.015609
 13.916931  13.916931   9.772497   7.9506397 14.015609   7.2182035
 14.232442   8.138622   8.138622  13.466399  14.050595  14.015609
 14.015609   8.138622   7.2182035  8.188253  14.050595 ]
2025-06-02 15:52:29,660 - DEBUG - Edge reconstruction errors: [  4.46692     4.644676   43.893948  ...  12.4556055  12.651876
 535.2456   ]
2025-06-02 15:52:29,662 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155229_update_21.json
2025-06-02 15:52:29,662 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:52:29,665 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155229_update_21.pth and as latest_checkpoint.pth
2025-06-02 15:52:29,665 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869725.dot): 0.4416
2025-06-02 15:52:29,665 - WARNING - Detected 8 anomalous nodes (reconstruction-based):
2025-06-02 15:52:29,665 - WARNING -   Node ID: 192.168.27.13, Recon Error: 21.1628, MLP Score: 0.9430
2025-06-02 15:52:29,665 - WARNING -   Node ID: 192.168.27.12, Recon Error: 19.6594, MLP Score: 0.9385
2025-06-02 15:52:29,665 - WARNING -   Node ID: 192.168.27.10, Recon Error: 25.6332, MLP Score: 0.9461
2025-06-02 15:52:29,665 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 24.4663, MLP Score: 0.9713
2025-06-02 15:52:29,665 - WARNING -   Node ID: 192.168.209.130, Recon Error: 21.1465, MLP Score: 0.7305
2025-06-02 15:52:29,665 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-02 15:52:29,665 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2450, MLP Score: 0.0000
2025-06-02 15:52:29,666 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9474, MLP Score: 0.0000
2025-06-02 15:52:29,666 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0457, MLP Score: 0.0000
2025-06-02 15:52:29,666 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7479, MLP Score: 0.0000
2025-06-02 15:52:29,666 - WARNING -   Source: 192.168.27.12, Target: 224.0.0.251, Recon Error: 535.2455, MLP Score: 0.0000
2025-06-02 15:52:29,674 - DEBUG - Embedding standard deviations before t-SNE: [1.216438   0.09414574 1.3006494  1.1017836  2.0729172  0.
 0.7893842  0.8699604  2.2077532  1.2448606  0.7577899  0.
 1.6653433  0.67331094 1.0674748  1.1848832  0.         0.5006871
 0.         0.07829096 3.1936696  0.6772786  0.         1.2513934
 0.9146126  0.96235996 0.         0.91657543 2.1717296  0.
 1.1890366  0.5000716 ]
2025-06-02 15:52:30,310 - INFO - Embeddings visualization saved to vis/embeddings_21_updates_20250602_155229.png
2025-06-02 15:52:30,311 - INFO - Performing visualization of node and edge features.
2025-06-02 15:52:30,311 - INFO - Starting visualization of node features.
2025-06-02 15:52:30,312 - INFO - Graph has 653 nodes and 30 features.
2025-06-02 15:52:30,312 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:52:30,312 - INFO - Calculating feature statistics:
2025-06-02 15:52:30,312 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:30,312 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:30,312 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 11, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.5793545), 'max': np.float32(1.4206686)}
2025-06-02 15:52:30,312 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 11, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.3954121), 'max': np.float32(2.629857)}
2025-06-02 15:52:30,312 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:30,312 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:30,312 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:30,312 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(-1.1683606e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.4277511), 'max': np.float32(2.337808)}
2025-06-02 15:52:30,313 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(4.6734424e-08), 'std': np.float32(1.0), 'min': np.float32(-1.1985687), 'max': np.float32(0.8343284)}
2025-06-02 15:52:30,313 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 3, 'mean': np.float32(-2.9209015e-09), 'std': np.float32(0.9999999), 'min': np.float32(-8.865789), 'max': np.float32(0.11624347)}
2025-06-02 15:52:30,313 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 11, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-3.7988932), 'max': np.float32(0.8994265)}
2025-06-02 15:52:30,313 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 11, 'mean': np.float32(-2.3367212e-08), 'std': np.float32(1.0), 'min': np.float32(-0.88663286), 'max': np.float32(3.8624964)}
2025-06-02 15:52:30,313 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 8, 'mean': np.float32(2.361409), 'std': np.float32(1.0134679), 'min': np.float32(0.0), 'max': np.float32(11.0)}
2025-06-02 15:52:30,313 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.957121), 'std': np.float32(0.28968853), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:52:30,313 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.13935682), 'std': np.float32(0.36357617), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:52:30,313 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.376723), 'std': np.float32(0.5661809), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:52:30,313 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 3, 'mean': np.float32(2.9209015e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.11624347), 'max': np.float32(8.865789)}
2025-06-02 15:52:30,313 - INFO - - service_1: {'name': 'service_1', 'unique': 5, 'mean': np.float32(3.474732), 'std': np.float32(3.0934484), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 15:52:30,313 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.6738133), 'std': np.float32(2.9293683), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:52:30,313 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.5895867), 'std': np.float32(1.528699), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:52:30,313 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.13935682), 'std': np.float32(0.36357617), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:52:30,314 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 1, 'mean': np.float32(8.0), 'std': np.float32(0.0), 'min': np.float32(8.0), 'max': np.float32(8.0)}
2025-06-02 15:52:30,314 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(-2.9209015e-09), 'std': np.float32(1.0), 'min': np.float32(-0.1343134), 'max': np.float32(14.483462)}
2025-06-02 15:52:30,314 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(5.841803e-09), 'std': np.float32(1.0), 'min': np.float32(-0.14801767), 'max': np.float32(6.75595)}
2025-06-02 15:52:30,314 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:30,314 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:30,314 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:30,314 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:30,314 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(-1.1683606e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.0165796), 'max': np.float32(8.674318)}
2025-06-02 15:52:30,314 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(-5.8418028e-08), 'std': np.float32(1.0), 'min': np.float32(-1.1326946), 'max': np.float32(4.414677)}
2025-06-02 15:52:30,327 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x72fda41da0c0>
2025-06-02 15:52:30,459 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:52:30,516 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:52:30,548 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:52:31,994 - INFO - Node feature visualization saved to vis/node_features_20250602_155230.png
2025-06-02 15:52:31,994 - INFO - Finished visualization of node features.
2025-06-02 15:52:31,994 - INFO - Performing additional feature analysis:
2025-06-02 15:52:31,994 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:52:31,995 - INFO - Starting visualization of edge features.
2025-06-02 15:52:31,996 - INFO - Graph has 1355 edges and 10 edge features.
2025-06-02 15:52:31,996 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:52:31,996 - INFO - Calculating edge feature statistics:
2025-06-02 15:52:31,996 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:52:31,996 - INFO - - count: {'name': 'count', 'unique': 24, 'mean': np.float32(-4.2229122e-09), 'std': np.float32(1.0), 'min': np.float32(-0.047597624), 'max': np.float32(27.940474)}
2025-06-02 15:52:31,996 - INFO - - dst_port: {'name': 'dst_port', 'unique': 15, 'mean': np.float32(463.77417), 'std': np.float32(499.97305), 'min': np.float32(3.0), 'max': np.float32(8688.0)}
2025-06-02 15:52:31,996 - INFO - - protocol: {'name': 'protocol', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:31,996 - INFO - - service: {'name': 'service', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:31,996 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 904, 'mean': np.float32(-1.4076373e-09), 'std': np.float32(1.0), 'min': np.float32(-0.07276706), 'max': np.float32(27.607315)}
2025-06-02 15:52:31,996 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 960, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.06579117), 'max': np.float32(27.892584)}
2025-06-02 15:52:31,996 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 316, 'mean': np.float32(1.4076373e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.056002725), 'max': np.float32(27.88871)}
2025-06-02 15:52:31,996 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 937, 'mean': np.float32(2.1114561e-09), 'std': np.float32(1.0), 'min': np.float32(-0.12164314), 'max': np.float32(19.201406)}
2025-06-02 15:52:31,996 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 955, 'mean': np.float32(2.8152747e-09), 'std': np.float32(1.0), 'min': np.float32(-0.11973842), 'max': np.float32(18.085634)}
2025-06-02 15:52:31,996 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 353, 'mean': np.float32(-1.4076373e-09), 'std': np.float32(1.0), 'min': np.float32(-0.06595535), 'max': np.float32(27.347694)}
2025-06-02 15:52:32,007 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x72fda54ddcd0>
2025-06-02 15:52:32,089 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:52:32,099 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x72fd95b37d70>
2025-06-02 15:52:32,177 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:52:32,481 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:52:32,594 - DEBUG - Plotted boxplots of the first 8 non-constant edge features.
2025-06-02 15:52:32,608 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:52:32,613 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:52:33,829 - INFO - Edge feature visualization saved to vis/edge_features_20250602_155232.png
2025-06-02 15:52:33,829 - INFO - Finished visualization of edge features.
2025-06-02 15:52:33,829 - INFO - Performing additional edge feature analysis:
2025-06-02 15:52:33,829 - INFO - - 2 out of 10 edge features are constant.
2025-06-02 15:52:33,829 - INFO - - Highest correlation (1.00) between features: 'total_orig_bytes' and 'total_orig_ip_bytes'.
2025-06-02 15:52:33,830 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:52:33,830 - INFO - Graph has 1355 edges and 10 edge features.
2025-06-02 15:52:33,830 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:52:34,305 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_155233_summary.png
2025-06-02 15:52:34,678 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_155233_pca_3d.png
2025-06-02 15:52:34,885 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_155233_pca_variance.png
2025-06-02 15:52:34,886 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:52:34,886 - INFO - 
--- Processing file: nw_graph_encoded_1748869755.dot (Timestamp: 2025-06-02 15:09:15) ---
2025-06-02 15:52:34,886 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869755.dot
2025-06-02 15:52:34,886 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869755.dot'.
2025-06-02 15:52:34,886 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869755.dot
2025-06-02 15:52:34,899 - INFO - Parsed 693 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869755.dot'.
2025-06-02 15:52:34,915 - INFO - Parsed 1448 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869755.dot'.
2025-06-02 15:52:34,915 - INFO - Processing node updates/additions.
2025-06-02 15:52:34,919 - INFO - Processing edge updates/additions.
2025-06-02 15:52:34,928 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:52:34,929 - INFO - Finished updating NetworkX graph.
2025-06-02 15:52:34,929 - DEBUG - Updated graph - Nodes: 693, Edges: 1448
2025-06-02 15:52:34,929 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:52:34,930 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:52:34,937 - DEBUG - Initial node features tensor shape: torch.Size([693, 30])
2025-06-02 15:52:34,939 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:52:34,939 - DEBUG - Node features tensor shape after scaling: torch.Size([693, 30])
2025-06-02 15:52:34,940 - DEBUG - Edge index tensor shape: torch.Size([2, 1448])
2025-06-02 15:52:34,941 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:52:34,944 - DEBUG - Initial edge attributes tensor shape: torch.Size([1448, 10])
2025-06-02 15:52:34,945 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:52:34,945 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1448, 10])
2025-06-02 15:52:34,945 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:52:34,946 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:52:34,946 - INFO - Updated main graph to 693 nodes and 1448 edges.
2025-06-02 15:52:34,946 - INFO - Performing online update...
2025-06-02 15:52:34,946 - INFO - Starting online update for 50 steps.
2025-06-02 15:52:34,947 - DEBUG - Updated RunningStats: new_mean=0.9429985895606033, new_var=47400000000161.31, new_n=4770
2025-06-02 15:52:34,947 - DEBUG - Updated RunningStats: new_mean=0.9417012168041693, new_var=47700000000018.99, new_n=4800
2025-06-02 15:52:34,947 - DEBUG - Updated RunningStats: new_mean=44.054962731492175, new_var=15800000192107.232, new_n=1590
2025-06-02 15:52:34,947 - DEBUG - Updated RunningStats: new_mean=44.08652858946207, new_var=15900000210453.89, new_n=1600
2025-06-02 15:52:34,948 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:52:34,948 - DEBUG - Online update step: 1/50
2025-06-02 15:52:34,948 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,948 - DEBUG - Online update step: 2/50
2025-06-02 15:52:34,948 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,948 - DEBUG - Online update step: 3/50
2025-06-02 15:52:34,948 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,948 - DEBUG - Online update step: 4/50
2025-06-02 15:52:34,948 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,948 - DEBUG - Online update step: 5/50
2025-06-02 15:52:34,948 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,948 - DEBUG - Online update step: 6/50
2025-06-02 15:52:34,948 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,948 - DEBUG - Online update step: 7/50
2025-06-02 15:52:34,948 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,948 - DEBUG - Online update step: 8/50
2025-06-02 15:52:34,948 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,948 - DEBUG - Online update step: 9/50
2025-06-02 15:52:34,948 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,948 - DEBUG - Online update step: 10/50
2025-06-02 15:52:34,948 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,948 - DEBUG - Online update step: 11/50
2025-06-02 15:52:34,948 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,948 - DEBUG - Online update step: 12/50
2025-06-02 15:52:34,948 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,948 - DEBUG - Online update step: 13/50
2025-06-02 15:52:34,948 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,948 - DEBUG - Online update step: 14/50
2025-06-02 15:52:34,948 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,948 - DEBUG - Online update step: 15/50
2025-06-02 15:52:34,948 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,948 - DEBUG - Online update step: 16/50
2025-06-02 15:52:34,948 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,948 - DEBUG - Online update step: 17/50
2025-06-02 15:52:34,948 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,948 - DEBUG - Online update step: 18/50
2025-06-02 15:52:34,948 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,949 - DEBUG - Online update step: 19/50
2025-06-02 15:52:34,949 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,949 - DEBUG - Online update step: 20/50
2025-06-02 15:52:34,949 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,949 - DEBUG - Online update step: 21/50
2025-06-02 15:52:34,949 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,949 - DEBUG - Online update step: 22/50
2025-06-02 15:52:34,949 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,949 - DEBUG - Online update step: 23/50
2025-06-02 15:52:34,949 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,949 - DEBUG - Online update step: 24/50
2025-06-02 15:52:34,949 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,949 - DEBUG - Online update step: 25/50
2025-06-02 15:52:34,949 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,949 - DEBUG - Online update step: 26/50
2025-06-02 15:52:34,949 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,949 - DEBUG - Online update step: 27/50
2025-06-02 15:52:34,949 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,949 - DEBUG - Online update step: 28/50
2025-06-02 15:52:34,949 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,949 - DEBUG - Online update step: 29/50
2025-06-02 15:52:34,949 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,949 - DEBUG - Online update step: 30/50
2025-06-02 15:52:34,949 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,949 - DEBUG - Online update step: 31/50
2025-06-02 15:52:34,949 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,949 - DEBUG - Online update step: 32/50
2025-06-02 15:52:34,949 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,949 - DEBUG - Online update step: 33/50
2025-06-02 15:52:34,949 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,949 - DEBUG - Online update step: 34/50
2025-06-02 15:52:34,949 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,949 - DEBUG - Online update step: 35/50
2025-06-02 15:52:34,949 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,949 - DEBUG - Online update step: 36/50
2025-06-02 15:52:34,949 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,949 - DEBUG - Online update step: 37/50
2025-06-02 15:52:34,949 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,949 - DEBUG - Online update step: 38/50
2025-06-02 15:52:34,949 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,950 - DEBUG - Online update step: 39/50
2025-06-02 15:52:34,950 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,950 - DEBUG - Online update step: 40/50
2025-06-02 15:52:34,950 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,950 - DEBUG - Online update step: 41/50
2025-06-02 15:52:34,950 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,950 - DEBUG - Online update step: 42/50
2025-06-02 15:52:34,950 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,950 - DEBUG - Online update step: 43/50
2025-06-02 15:52:34,950 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,950 - DEBUG - Online update step: 44/50
2025-06-02 15:52:34,950 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,950 - DEBUG - Online update step: 45/50
2025-06-02 15:52:34,950 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,950 - DEBUG - Online update step: 46/50
2025-06-02 15:52:34,950 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,950 - DEBUG - Online update step: 47/50
2025-06-02 15:52:34,950 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,950 - DEBUG - Online update step: 48/50
2025-06-02 15:52:34,950 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,950 - DEBUG - Online update step: 49/50
2025-06-02 15:52:34,950 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,950 - DEBUG - Online update step: 50/50
2025-06-02 15:52:34,950 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:34,950 - WARNING - No successful steps during online update.
2025-06-02 15:52:34,951 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -4.7133256e-08  3.0619415e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -5.0229598e-08
  4.1284602e-09  5.5046137e-09  3.0275377e-08 -3.0275377e-08
  2.3362193e+00  2.9595959e+00  1.3708514e-01  4.3939395e+00
 -5.5046137e-09  3.4992785e+00  5.6955266e+00  7.6132755e+00
  1.3708514e-01  8.0000000e+00 -3.3027682e-08  1.6513841e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.4403836e-08  1.5137688e-08], current edge mean: [-1.3172298e-09  4.6195374e+02  0.0000000e+00  0.0000000e+00
 -1.3172298e-09  4.9396114e-09 -1.3172298e-09  2.6344595e-09
 -3.9516892e-09  9.8792230e-10]
2025-06-02 15:52:34,951 - DEBUG - Node drift difference: 0.0304, Edge drift difference: 0.0036
2025-06-02 15:52:34,952 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -4.7133256e-08  3.0619415e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -5.0229598e-08
  4.1284602e-09  5.5046137e-09  3.0275377e-08 -3.0275377e-08
  2.3362193e+00  2.9595959e+00  1.3708514e-01  4.3939395e+00
 -5.5046137e-09  3.4992785e+00  5.6955266e+00  7.6132755e+00
  1.3708514e-01  8.0000000e+00 -3.3027682e-08  1.6513841e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.4403836e-08  1.5137688e-08], edge=[-1.3172298e-09  4.6195374e+02  0.0000000e+00  0.0000000e+00
 -1.3172298e-09  4.9396114e-09 -1.3172298e-09  2.6344595e-09
 -3.9516892e-09  9.8792230e-10]
2025-06-02 15:52:34,952 - DEBUG - Updated reference std: node=[0.         0.         1.0007223  1.0007223  0.         0.
 0.         1.0007223  1.0007223  1.0007224  1.0007223  1.0007223
 0.98739225 0.28158483 0.36058903 0.565704   1.0007224  3.083906
 2.926053   1.4880826  0.36058903 0.         1.0007223  1.0007223
 0.         0.         0.         0.         1.0007223  1.0007223 ], edge=[  1.0003455 484.05258     0.          0.          1.0003455   1.0003455
   1.0003455   1.0003455   1.0003455   1.0003455]
2025-06-02 15:52:34,952 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:52:34,952 - INFO - Running anomaly detection...
2025-06-02 15:52:34,952 - INFO - Starting anomaly detection.
2025-06-02 15:52:34,958 - DEBUG - Node reconstruction errors: [16.44845   13.433518  22.27931   15.888388  10.250397   8.435303
 20.732998  12.373931  12.373931  12.830326  12.37393   10.849795
 27.087793   8.607543  14.918503  16.105461  11.307486  16.115429
 17.668734  15.683478  11.924349  14.918504  12.565334  10.556866
 14.927755  12.53729   14.927758   9.74409   11.941823  14.927755
 10.932177  12.384766   9.382741  15.57929   12.644684  16.026487
  7.943977  15.683478  11.289157  11.553812  15.459554  14.557364
 15.683478  16.482851  15.841135  12.478141  17.731504   8.841662
 11.596861  16.14326   25.082464  12.261149  12.19507   16.959995
 11.474177  10.694804  21.832394  15.070283  16.351976  16.552626
  7.473841  15.67909   14.271621  10.382445  14.203629  11.474221
 11.74315   11.474082  14.271621  14.271621  11.253824   8.302108
 11.76837    7.622049   7.372693   8.433328  15.602778   8.2400465
  7.5336127  7.460942  14.65347    8.504128   7.498727  10.966711
 10.708713   9.713575   8.577528   7.5325546  7.302856   8.788287
 14.248562   8.664899   9.5341     7.369242  11.434448  25.733852
 14.356869   8.730259  14.059491  11.403757   8.198461  14.356871
 14.999334   9.016699   9.612052  11.108865  15.373845   7.28255
  9.664695  13.746409  14.489556  14.833426  10.15839    9.935642
  8.361846   8.375323   8.248907   8.495452   7.242741  11.782493
 14.271063  10.128247   9.853967   9.917333   7.151776  11.782465
  9.419684   7.4761643  8.769818  15.020812  11.784742  11.413924
 14.837521   9.762552   8.375316  11.23588   15.238937  13.930226
  7.533769   8.994716  11.519643   9.003389  14.472427  11.661005
 11.848145   8.180242   8.248906  11.321679  11.3490925  7.2445955
 13.08293    9.612054   7.342961  11.413924   7.266288   8.6194725
 11.396175   9.012778   8.198459  14.798786  11.321679   7.584623
 11.396175  11.784742   8.275254   8.449861   8.158781   7.3563547
  7.5538607  7.2840557  7.3486633 12.014776  14.003879  20.3404
  7.4761205 11.934705   7.340136   8.291398   8.214245   8.214248
 11.120801   9.092134  14.333815   9.292911   8.3132105  8.182366
 14.425067   8.288228  11.244103  11.412545   7.3291497  7.3260274
 12.170105  11.237377   7.5337677 11.856137   9.915172  14.871959
  8.443699  14.72664   14.647723  11.396177   9.848002   7.310057
  8.25525    9.534099  11.524476  10.395512  14.218549   7.3085856
  8.3116865  8.182368  11.5495     7.542134   8.182367  14.529875
  8.781725   8.248907   8.1942425 11.237377   9.511469  14.425068
 13.907575  11.5495    11.396175   7.057121   8.351885  11.196197
  7.2343664 15.275697  10.032933   7.153501   7.4707575  8.248906
  8.248908  11.856137   7.372958  13.907575  11.396177  15.111592
  8.330092   7.4409375 11.246302   7.2445955 11.1189165  7.1199827
  8.524429   8.158138  11.246302  11.629121  14.00388   13.857736
  8.19424    7.5106974  8.375318   8.203806  11.412545  14.412904
 14.69575    8.214248   7.3198423  8.630919  15.014249  11.63798
  7.3619556 11.446631   7.0631194 10.218676   7.0631175  8.724909
  9.857775   9.496946   7.344081  14.59576    8.149248   8.214247
 14.162148   7.515588  11.120801   8.402296   8.234716  13.96977
  7.250468  14.627294   8.723003  14.311392   8.589487   7.4058933
  9.092134  10.310344  11.852834  14.716951  11.569525  11.1189165
  8.912057  13.834065   7.1488442  8.214642  11.856137  14.593247
  7.268526  13.797502   8.218524   8.21852   13.797503  13.797502
 13.797503   8.131848  13.982127  13.797503  13.797502   7.409319
 13.797502  11.501771   9.527467   7.2064843  8.631796   9.326212
 11.524011  12.041019   7.0396166 11.471659   7.0470996  8.218523
 11.420159   9.384441  13.988719   8.131851   7.235292   7.235292
  7.373116  11.949258  13.797503   8.149246  13.797502   8.131851
 11.772622  13.767939  13.988719  13.988722  13.797502  14.188925
 13.988719   7.1482024  7.131496   7.063117   8.218526  14.442248
  7.0660152  7.2256575 13.797503   8.668446   9.699064   8.493338
 14.336865  11.412545  14.39203   13.797503  13.834065  13.834065
  8.311687  11.556262  10.277277   7.0949125  8.218533  20.217901
 14.029126   8.2081785  8.226359   8.383041   7.331474   7.1618776
  7.4092407  9.421893   7.158705   8.034279  13.875311  11.150721
  7.0613675 13.797502   8.21852    7.2083583 11.638135   7.4060354
  7.3711567  8.259321  10.96283    9.228963   7.909228  13.797502
  8.444712   8.259323   8.310765   8.521336   7.8720307  7.8720307
  7.8720345 15.960021  13.8183    16.159744  11.679225   8.447448
  7.8720345 13.8183     8.345611   8.3108     6.946329  11.14073
  8.310764   7.0247517  7.8720345  8.310763  13.8183     7.8720345
  7.8720345 14.672594  14.163735   7.8720345 13.875314  14.231652
 11.370088  11.150664   8.332927  11.27069    9.132334  11.632783
 11.281783   8.455043   7.195206  15.05076    6.9831553 10.87297
  8.401752   8.015183   7.8720307  7.8720307 11.150664   6.934835
  9.550036  14.027515  14.106083  11.352533  14.389567  14.389567
 14.389567   7.309636   8.55286   11.79725   11.79725   11.4279375
  7.062115  13.906769  11.583858  13.861897  13.906769  11.510412
 11.416234  11.60423   14.3729315  8.332926   8.239547  11.416234
 11.27069    9.31786   11.60423   11.416234  13.723102   8.332928
  7.2448955 11.677771  13.723102   8.239555   7.2076783  9.835387
  7.061795   8.334242   8.239548   8.239548  14.106083  11.427937
 14.505493   7.7907453 13.864025  11.427937   9.155606  13.767351
 13.906769   7.4809866 15.096378   9.892034   8.526925  14.106083
  7.2715707 14.231652   8.334829  11.604231   8.334826  16.03748
 13.861897  11.427937  11.427937  14.231652  11.4279375 13.940641
 13.767351  15.096378  14.075427   8.225597  11.583858  13.906769
 15.096377  11.519507  11.519507  13.906769   8.398733  13.906769
 14.075427   8.398728  14.737212   7.3747945  8.398732  11.352533
 14.075427  11.79725   13.767351   8.334828  11.911155   9.094223
  8.39873    7.062115  13.906769  13.861897  13.861897  11.427937
  8.3348255  8.398572   7.3482614  7.061773  13.861897   7.985314
 13.861897   7.985314  14.2058735  8.398732  11.519507  11.519507
 11.519507  13.9817705 10.737729  13.9817705 13.9817705 13.9817705
 13.9817705 13.9817705 13.9817705 13.9817705  8.45979   11.532735
 15.036771  13.9817705 13.9817705 13.9817705 13.9817705 13.9817705
 13.9817705 13.9817705 13.9817705 13.9817705  8.582639  13.9817705
 13.9817705  8.459788  13.9817705 13.906769  13.515915  13.861897
 14.489619   8.029377  17.011625  17.011625   7.013841  14.489619
 13.861897  14.075427  14.075427  13.861897  14.075427  13.861897
 11.684282  13.9817705 11.352533  13.861897  11.519511  13.861897
 13.861897  14.075427  13.861897  14.075427  13.861897  13.861897
  8.398727  14.075427  13.861897  14.075427  13.861897  13.861897
 13.861897   7.052015   7.918187   7.918187  13.9817705 11.227322
 13.829436  13.861897  14.075427   7.2994647 13.9817705 14.075427
  7.1384034 14.238422  13.861897  13.861897   8.399621   7.1601586
  7.918187  13.861897   8.459789  14.075427  14.075427   9.277148
 13.9817705 14.075427   8.398733  13.9817705 13.9817705  8.45979
 13.861897  13.861897   9.762012   7.918187  13.9817705  7.1601586
 14.227859   8.077817   8.077817  13.478143  14.012964  13.9817705
 13.9817705  8.077817   7.1601586  8.129699  14.012964  14.0595255
 14.020509  14.020509  14.02051   14.02051   14.02051   14.02051
 14.02051   14.02051   14.02051   13.9817705 13.9817705 13.9817705
  8.077817   7.220305   8.077817  14.440158   8.077817  13.9817705
 13.9817705 13.9817705 13.9817705 13.9817705  8.07782   13.877498
 14.116396  14.116395  14.020509  13.877498   8.129699  14.373365
 13.9817705 13.9817705 14.02051   14.0595255 14.116396  14.116395
 14.059528  13.947543  14.020511 ]
2025-06-02 15:52:34,958 - DEBUG - Edge reconstruction errors: [  4.4728327   4.6370564  43.891922  ...  12.4534855  12.645021
 535.2458   ]
2025-06-02 15:52:34,960 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155234_update_22.json
2025-06-02 15:52:34,960 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:52:34,963 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155234_update_22.pth and as latest_checkpoint.pth
2025-06-02 15:52:34,963 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869755.dot): 0.4393
2025-06-02 15:52:34,963 - WARNING - Detected 8 anomalous nodes (reconstruction-based):
2025-06-02 15:52:34,963 - WARNING -   Node ID: 192.168.27.13, Recon Error: 22.2793, MLP Score: 0.9473
2025-06-02 15:52:34,963 - WARNING -   Node ID: 192.168.27.12, Recon Error: 20.7330, MLP Score: 0.9439
2025-06-02 15:52:34,963 - WARNING -   Node ID: 192.168.27.10, Recon Error: 27.0878, MLP Score: 0.9494
2025-06-02 15:52:34,963 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 25.0825, MLP Score: 0.9732
2025-06-02 15:52:34,964 - WARNING -   Node ID: 192.168.209.130, Recon Error: 21.8324, MLP Score: 0.7375
2025-06-02 15:52:34,964 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-02 15:52:34,964 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2452, MLP Score: 0.0000
2025-06-02 15:52:34,964 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9476, MLP Score: 0.0000
2025-06-02 15:52:34,964 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0458, MLP Score: 0.0000
2025-06-02 15:52:34,964 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7480, MLP Score: 0.0000
2025-06-02 15:52:34,964 - WARNING -   Source: 192.168.27.12, Target: 224.0.0.251, Recon Error: 535.2457, MLP Score: 0.0000
2025-06-02 15:52:34,964 - INFO - 
--- Processing file: nw_graph_encoded_1748869785.dot (Timestamp: 2025-06-02 15:09:45) ---
2025-06-02 15:52:34,964 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869785.dot
2025-06-02 15:52:34,964 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869785.dot'.
2025-06-02 15:52:34,964 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869785.dot
2025-06-02 15:52:34,983 - INFO - Parsed 700 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869785.dot'.
2025-06-02 15:52:35,001 - INFO - Parsed 1476 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869785.dot'.
2025-06-02 15:52:35,001 - INFO - Processing node updates/additions.
2025-06-02 15:52:35,005 - INFO - Processing edge updates/additions.
2025-06-02 15:52:35,013 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:52:35,014 - INFO - Finished updating NetworkX graph.
2025-06-02 15:52:35,014 - DEBUG - Updated graph - Nodes: 700, Edges: 1476
2025-06-02 15:52:35,014 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:52:35,015 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:52:35,022 - DEBUG - Initial node features tensor shape: torch.Size([700, 30])
2025-06-02 15:52:35,023 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:52:35,023 - DEBUG - Node features tensor shape after scaling: torch.Size([700, 30])
2025-06-02 15:52:35,024 - DEBUG - Edge index tensor shape: torch.Size([2, 1476])
2025-06-02 15:52:35,025 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:52:35,028 - DEBUG - Initial edge attributes tensor shape: torch.Size([1476, 10])
2025-06-02 15:52:35,029 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:52:35,029 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1476, 10])
2025-06-02 15:52:35,029 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:52:35,029 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:52:35,030 - INFO - Updated main graph to 700 nodes and 1476 edges.
2025-06-02 15:52:35,030 - INFO - Performing online update...
2025-06-02 15:52:35,030 - INFO - Starting online update for 50 steps.
2025-06-02 15:52:35,030 - DEBUG - Updated RunningStats: new_mean=0.9430479409392194, new_var=48000000000160.93, new_n=4830
2025-06-02 15:52:35,031 - DEBUG - Updated RunningStats: new_mean=0.9417785875268545, new_var=48300000000019.09, new_n=4860
2025-06-02 15:52:35,031 - DEBUG - Updated RunningStats: new_mean=44.09921852463995, new_var=16000000191556.15, new_n=1610
2025-06-02 15:52:35,031 - DEBUG - Updated RunningStats: new_mean=44.12736770910717, new_var=16100000206544.312, new_n=1620
2025-06-02 15:52:35,031 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:52:35,031 - DEBUG - Online update step: 1/50
2025-06-02 15:52:35,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,031 - DEBUG - Online update step: 2/50
2025-06-02 15:52:35,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,031 - DEBUG - Online update step: 3/50
2025-06-02 15:52:35,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,031 - DEBUG - Online update step: 4/50
2025-06-02 15:52:35,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,031 - DEBUG - Online update step: 5/50
2025-06-02 15:52:35,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,031 - DEBUG - Online update step: 6/50
2025-06-02 15:52:35,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,031 - DEBUG - Online update step: 7/50
2025-06-02 15:52:35,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,031 - DEBUG - Online update step: 8/50
2025-06-02 15:52:35,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,031 - DEBUG - Online update step: 9/50
2025-06-02 15:52:35,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,031 - DEBUG - Online update step: 10/50
2025-06-02 15:52:35,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,032 - DEBUG - Online update step: 11/50
2025-06-02 15:52:35,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,032 - DEBUG - Online update step: 12/50
2025-06-02 15:52:35,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,032 - DEBUG - Online update step: 13/50
2025-06-02 15:52:35,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,032 - DEBUG - Online update step: 14/50
2025-06-02 15:52:35,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,032 - DEBUG - Online update step: 15/50
2025-06-02 15:52:35,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,032 - DEBUG - Online update step: 16/50
2025-06-02 15:52:35,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,032 - DEBUG - Online update step: 17/50
2025-06-02 15:52:35,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,032 - DEBUG - Online update step: 18/50
2025-06-02 15:52:35,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,032 - DEBUG - Online update step: 19/50
2025-06-02 15:52:35,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,032 - DEBUG - Online update step: 20/50
2025-06-02 15:52:35,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,032 - DEBUG - Online update step: 21/50
2025-06-02 15:52:35,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,032 - DEBUG - Online update step: 22/50
2025-06-02 15:52:35,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,032 - DEBUG - Online update step: 23/50
2025-06-02 15:52:35,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,032 - DEBUG - Online update step: 24/50
2025-06-02 15:52:35,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,032 - DEBUG - Online update step: 25/50
2025-06-02 15:52:35,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,032 - DEBUG - Online update step: 26/50
2025-06-02 15:52:35,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,032 - DEBUG - Online update step: 27/50
2025-06-02 15:52:35,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,032 - DEBUG - Online update step: 28/50
2025-06-02 15:52:35,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,032 - DEBUG - Online update step: 29/50
2025-06-02 15:52:35,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,032 - DEBUG - Online update step: 30/50
2025-06-02 15:52:35,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,033 - DEBUG - Online update step: 31/50
2025-06-02 15:52:35,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,033 - DEBUG - Online update step: 32/50
2025-06-02 15:52:35,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,033 - DEBUG - Online update step: 33/50
2025-06-02 15:52:35,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,033 - DEBUG - Online update step: 34/50
2025-06-02 15:52:35,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,033 - DEBUG - Online update step: 35/50
2025-06-02 15:52:35,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,033 - DEBUG - Online update step: 36/50
2025-06-02 15:52:35,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,033 - DEBUG - Online update step: 37/50
2025-06-02 15:52:35,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,033 - DEBUG - Online update step: 38/50
2025-06-02 15:52:35,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,033 - DEBUG - Online update step: 39/50
2025-06-02 15:52:35,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,033 - DEBUG - Online update step: 40/50
2025-06-02 15:52:35,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,033 - DEBUG - Online update step: 41/50
2025-06-02 15:52:35,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,033 - DEBUG - Online update step: 42/50
2025-06-02 15:52:35,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,033 - DEBUG - Online update step: 43/50
2025-06-02 15:52:35,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,033 - DEBUG - Online update step: 44/50
2025-06-02 15:52:35,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,033 - DEBUG - Online update step: 45/50
2025-06-02 15:52:35,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,033 - DEBUG - Online update step: 46/50
2025-06-02 15:52:35,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,033 - DEBUG - Online update step: 47/50
2025-06-02 15:52:35,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,033 - DEBUG - Online update step: 48/50
2025-06-02 15:52:35,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,033 - DEBUG - Online update step: 49/50
2025-06-02 15:52:35,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,033 - DEBUG - Online update step: 50/50
2025-06-02 15:52:35,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,033 - WARNING - No successful steps during online update.
2025-06-02 15:52:35,034 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -2.1798270e-08  5.1770890e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.8392290e-08
  4.7683717e-08 -2.4523054e-08 -8.1743510e-09 -1.2261527e-08
  2.3414285e+00  2.9600000e+00  1.4000000e-01  4.3857141e+00
  2.4523054e-08  3.5214286e+00  5.6671429e+00  7.5999999e+00
  1.4000000e-01  8.0000000e+00 -1.8392290e-08  5.3133284e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.7683715e-09 -8.1743510e-09], current edge mean: [-3.8767247e-09  4.6129608e+02  0.0000000e+00  0.0000000e+00
 -4.5228457e-09 -1.9383624e-09  6.4612082e-10  2.5844833e-09
 -2.5844833e-09 -2.2614228e-09]
2025-06-02 15:52:35,034 - DEBUG - Node drift difference: 0.0145, Edge drift difference: 0.0014
2025-06-02 15:52:35,035 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -2.1798270e-08  5.1770890e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.8392290e-08
  4.7683717e-08 -2.4523054e-08 -8.1743510e-09 -1.2261527e-08
  2.3414285e+00  2.9600000e+00  1.4000000e-01  4.3857141e+00
  2.4523054e-08  3.5214286e+00  5.6671429e+00  7.5999999e+00
  1.4000000e-01  8.0000000e+00 -1.8392290e-08  5.3133284e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.7683715e-09 -8.1743510e-09], edge=[-3.8767247e-09  4.6129608e+02  0.0000000e+00  0.0000000e+00
 -4.5228457e-09 -1.9383624e-09  6.4612082e-10  2.5844833e-09
 -2.5844833e-09 -2.2614228e-09]
2025-06-02 15:52:35,035 - DEBUG - Updated reference std: node=[0.         0.         1.000715   1.000715   0.         0.
 0.         1.0007151  1.000715   1.000715   1.000715   1.0007151
 0.9945478  0.2802002  0.36725795 0.5633757  1.000715   3.0975275
 2.9325864  1.5110466  0.36725795 0.         1.000715   1.000715
 0.         0.         0.         0.         1.000715   1.000715  ], edge=[  1.0003389 479.5915      0.          0.          1.0003389   1.0003389
   1.0003389   1.0003389   1.0003389   1.0003389]
2025-06-02 15:52:35,035 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:52:35,035 - INFO - Running anomaly detection...
2025-06-02 15:52:35,035 - INFO - Starting anomaly detection.
2025-06-02 15:52:35,041 - DEBUG - Node reconstruction errors: [16.423971  13.53024   22.37917   15.898988  10.318548   8.430798
 20.817263  12.364283  12.364283  12.8187475 12.364283  10.870135
 27.221748   8.700894  14.941927  16.122822  11.326345  16.13269
 17.697865  15.708876  11.926821  14.941927  12.760509  10.557165
 14.952884  12.5346775 14.952884   9.752222  11.941491  14.952883
 10.966913  12.382643   9.39519   15.600673  12.64447   16.006098
  7.945338  15.708876  11.262282  11.553821  15.486051  14.585248
 15.708876  16.470308  15.8644    12.44466   17.754854   8.809254
 11.601074  16.284819  25.249487  12.265958  12.198201  16.992321
 11.474438  10.6589775 21.91766   15.09856   16.397387  16.601484
  7.4764524 15.660873  14.301149  10.362613  14.23148   11.474469
 11.743737  11.474343  14.301152  14.301149  11.868757   8.308515
 11.759562   7.640102   7.379387   8.440934  15.609943   8.244855
  7.5393605  7.4783726 14.681486   8.502046   7.4797416 10.982146
 10.711048   9.716947   9.243504   7.538304   7.3202877  8.877722
 14.2732525  8.673937   9.541168   7.38062   11.428704  25.86812
 14.379022   8.7139015 14.081412  11.398935   8.202435  14.379022
 15.018125   9.02506    9.58615   11.102038  15.356257   7.2884946
  9.674227  13.768429  14.480517  14.857932  10.142841   9.933035
  8.357187   8.368206   8.246952   8.4948015  7.2583914 11.753837
 14.290597  10.115787   9.8366     9.89711    7.163194  11.753805
  9.426617   7.472553   8.7537565 15.0165205 11.788556  11.416402
 14.859953   9.757721   8.368201  11.232439  15.250397  13.956321
  7.5301     9.004556  11.5151415  8.985406  14.48066   11.64836
 11.82113    8.1853485  8.246953  11.328979  11.352395   7.253831
 13.105281   9.586152   7.3610873 11.416401   7.280635   8.630755
 11.388734   8.99447    8.2024355 14.825441  11.328979   7.582902
 11.388733  11.788557   8.271537   8.457414   8.167451   7.360848
  7.5494623  7.408817   7.366023  11.975081  14.031391  20.467106
  7.4833155 11.952685   7.3444233  8.447083   8.212827   8.212827
 11.1034155  9.104098  14.350026   9.286762   8.350752   8.181531
 14.431306   8.287284  11.230245  11.3965435  7.3393784  7.3312
 12.156428  11.242066   7.5300975 11.83716    7.095045  14.869181
  8.449414  14.728241  14.652074  11.388734   9.835611   7.3265967
  8.254978   9.541168  11.52885   10.391964  14.237157   7.3262253
  8.311953   8.181529  11.552871   7.6220927  7.0912013 14.534356
  8.782369   8.246951   8.19006   11.242067   9.51018   14.431308
 13.9312105 11.552871  11.388734   7.067024   8.367473  11.200945
  7.2506814 15.29926   10.020894   7.158396   7.46863    8.246951
  8.246952  11.83716    7.3783383 13.9312105 11.388733  15.135895
  8.339559   7.5589986 11.251666   7.2538304 11.121316   7.125318
  8.516507   8.158723  11.251666  11.614425  14.031391  13.882376
  8.19006    7.510028   8.730298   8.213575  11.3965435 14.415479
 14.676128   8.212826   7.327088   8.638536  15.031007  11.609271
  7.3674808 11.432035   7.080727  10.241788   7.0807257  8.714984
  9.848585   9.486988   7.35436   14.81619    8.152848   8.212827
 14.171543   7.531431  11.1034155  8.394034   8.2398    13.984173
  7.254859  14.65249    8.725359  14.333317   8.60437    7.40582
  9.104098  10.274688  11.826328  14.715607  11.5715275 11.121316
  8.90322   13.857023   7.4442844  8.213216  11.83716   14.609353
  7.271928  13.8127165  8.214249   8.214248  13.8127165 13.8127165
 13.8127165  8.132571  13.988931  13.8127165 13.8127165  7.4029813
 13.8127165 11.471187   7.584902   7.2147627  8.63741    9.33871
 11.522493  12.012716   7.050543  11.456713   7.063043   8.21425
 11.394229   9.381506  14.004913   8.132576   7.252372   7.252372
  7.388041  11.923949  13.8127165  8.152847  13.8127165  8.132573
 11.7487545 13.788808  14.004913  14.004913  13.8127165 14.207947
 14.004913   7.145911   7.133464   7.080725   8.2142515 14.458531
  7.0779624  7.2345624 13.8127165  8.782828   9.694949   8.486814
 14.352868  11.3965435 14.388534  13.8127165 13.857023  13.857023
  8.311953  11.523411  10.279879   7.192324   8.214262  20.323608
 14.042759   8.222849   8.227982   8.376046   7.334557   7.1609836
  7.4029446  9.589792   7.16731    8.04303   13.892279  11.151414
  7.075627  13.8127165  8.214248   7.1927686 11.599961   7.4143963
  7.3687406  8.257063  10.966325   9.198136   7.9185166 13.8127165
  8.431853   8.566904   8.313085   8.507051   7.878125   7.8781214
  7.878125  15.983405  13.831919  16.186922  11.66825    8.428261
  7.8781214 13.831919   8.34458    8.313121   6.9579997 11.792659
  8.3130865  7.0091405  7.878125   8.313084  13.831919   7.878125
  7.8781214 14.734569  14.178082   7.878125  13.892279  14.224384
 11.343402  11.140997   8.324231  11.771791   9.133225  12.083349
 11.262783   8.716635   7.1953473 15.048842   6.9905596 11.314039
  8.393309   8.012154   7.878125   7.878125  11.66825    6.9402566
  9.637445  14.015523  14.099658  11.323515  14.410146  14.410146
 14.410146   7.2851543  8.5362425 11.778322  11.778322  11.415602
  7.0666413 13.906707  11.560542  13.859036  13.906704  11.493201
 11.390903  11.58289   14.385009   8.324235   8.237088  11.390903
 11.263693   9.334127  11.582889  11.390903  13.7366495  8.324235
  7.609058  12.124419  13.7366495  8.237089   7.205501   9.949768
  7.0552244  8.325535   8.237086   8.237087  14.099657  11.4156
 14.512938   7.7898035 13.880007  11.415602   9.159135  13.767186
 13.906707   7.45727   15.11331    9.890609   8.51198   14.099657
  7.267115  14.224384   8.316259  11.582889   8.316252  16.067213
 13.859036  11.415602  11.415602  14.224384  11.415602  13.9414835
 13.767185   9.327165  14.065347   8.232198  11.560542  13.906707
 15.11331   11.495794  11.495794  13.906707   8.385404  13.906704
 14.065347   8.385402  14.742644   7.372061   8.385406  11.323515
 14.065347  11.778322  13.767185   8.316257  11.889815   9.081135
  8.385406   7.0666413 13.906704  13.859036  13.859036  11.415602
  8.316255   8.388526   7.3461847  7.055202  13.859036   7.977996
 13.859036   7.977996  14.217971   8.3854065 11.495793  11.495793
 11.495794  13.96964   10.759106  13.969638  13.96964   13.969638
 13.96964   13.96964   13.96964   13.969638   8.432663  11.505595
 15.044163  13.969638  13.969638  13.96964   13.969638  13.969638
 13.969638  13.96964   13.96964   13.969638   8.561075  13.96964
 13.969638   8.43266   13.96964   13.906707  13.524077  13.859036
 14.496185   8.0128145 17.00634   17.00634    7.0176477 14.496185
 13.859036  14.065349  14.065347  13.859036  14.065347  13.859036
 11.68596   13.969638  11.323515  13.859036  11.495793  13.859036
 13.859036  14.065347  13.859036  14.065347  13.859036  13.859036
  8.385405  14.065347  13.859036  14.065347  13.859036  13.859036
 13.859036   7.047684   8.444598   7.910031  13.969638  11.203449
 13.8454    13.859036  14.065347   7.2734995 13.96964   14.065347
  7.1289115 14.247138  13.859036  13.859036   8.373856   7.1517854
  7.910031  13.859036   8.432656  14.065347  14.065347   9.25677
 13.969638  14.065347   8.38541   13.969638  13.969638   8.432665
 13.859036  13.859036   9.767826   7.910031   8.561076   7.1517854
 14.237333   8.05984    8.059845  13.493532  14.003912  13.969638
 11.663346   8.05984    7.1517854  8.115811  14.003912  14.062974
 14.021079  14.021079  14.021079  14.021079  14.021079  14.021079
  8.654103  14.021079  14.021079  13.969638  13.969638  13.96964
  8.05984    7.198193   8.059845  14.440397   8.05984    8.561078
  8.561076  13.969638   8.561074  13.96964    8.05984   13.864889
 14.119603  14.119603  14.021079  13.864892   8.115809  14.3871355
 13.96964   13.969638  14.021079  14.062974  14.119603  14.119603
 14.062974  13.947384  14.021079  10.708005  14.255879  14.521441
 11.599828  14.062974  11.599828  13.947384 ]
2025-06-02 15:52:35,041 - DEBUG - Edge reconstruction errors: [  4.4701023   4.649985   43.89149   ...  12.470819   12.682883
 535.2446   ]
2025-06-02 15:52:35,043 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155235_update_23.json
2025-06-02 15:52:35,043 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:52:35,046 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155235_update_23.pth and as latest_checkpoint.pth
2025-06-02 15:52:35,046 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869785.dot): 0.4390
2025-06-02 15:52:35,046 - WARNING - Detected 8 anomalous nodes (reconstruction-based):
2025-06-02 15:52:35,046 - WARNING -   Node ID: 192.168.27.13, Recon Error: 22.3792, MLP Score: 0.9474
2025-06-02 15:52:35,046 - WARNING -   Node ID: 192.168.27.12, Recon Error: 20.8173, MLP Score: 0.9441
2025-06-02 15:52:35,046 - WARNING -   Node ID: 192.168.27.10, Recon Error: 27.2217, MLP Score: 0.9492
2025-06-02 15:52:35,046 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 25.2495, MLP Score: 0.9652
2025-06-02 15:52:35,046 - WARNING -   Node ID: 192.168.209.130, Recon Error: 21.9177, MLP Score: 0.7377
2025-06-02 15:52:35,046 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-02 15:52:35,046 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2440, MLP Score: 0.0000
2025-06-02 15:52:35,046 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9466, MLP Score: 0.0000
2025-06-02 15:52:35,046 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0448, MLP Score: 0.0000
2025-06-02 15:52:35,046 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7469, MLP Score: 0.0000
2025-06-02 15:52:35,046 - WARNING -   Source: 192.168.27.12, Target: 224.0.0.251, Recon Error: 535.2446, MLP Score: 0.0000
2025-06-02 15:52:35,046 - INFO - 
--- Processing file: nw_graph_encoded_1748869815.dot (Timestamp: 2025-06-02 15:10:15) ---
2025-06-02 15:52:35,047 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869815.dot
2025-06-02 15:52:35,047 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869815.dot'.
2025-06-02 15:52:35,047 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869815.dot
2025-06-02 15:52:35,065 - INFO - Parsed 715 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869815.dot'.
2025-06-02 15:52:35,083 - INFO - Parsed 1521 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869815.dot'.
2025-06-02 15:52:35,083 - INFO - Processing node updates/additions.
2025-06-02 15:52:35,087 - INFO - Processing edge updates/additions.
2025-06-02 15:52:35,095 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:52:35,096 - INFO - Finished updating NetworkX graph.
2025-06-02 15:52:35,096 - DEBUG - Updated graph - Nodes: 715, Edges: 1521
2025-06-02 15:52:35,096 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:52:35,097 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:52:35,104 - DEBUG - Initial node features tensor shape: torch.Size([715, 30])
2025-06-02 15:52:35,106 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:52:35,106 - DEBUG - Node features tensor shape after scaling: torch.Size([715, 30])
2025-06-02 15:52:35,107 - DEBUG - Edge index tensor shape: torch.Size([2, 1521])
2025-06-02 15:52:35,108 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:52:35,111 - DEBUG - Initial edge attributes tensor shape: torch.Size([1521, 10])
2025-06-02 15:52:35,112 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:52:35,112 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1521, 10])
2025-06-02 15:52:35,112 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:52:35,112 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:52:35,113 - INFO - Updated main graph to 715 nodes and 1521 edges.
2025-06-02 15:52:35,113 - INFO - Performing online update...
2025-06-02 15:52:35,113 - INFO - Starting online update for 50 steps.
2025-06-02 15:52:35,113 - DEBUG - Updated RunningStats: new_mean=0.9431042125435413, new_var=48600000000160.92, new_n=4890
2025-06-02 15:52:35,114 - DEBUG - Updated RunningStats: new_mean=0.9418498105814507, new_var=48900000000019.07, new_n=4920
2025-06-02 15:52:35,114 - DEBUG - Updated RunningStats: new_mean=44.139172884690886, new_var=16200000190904.383, new_n=1630
2025-06-02 15:52:35,114 - DEBUG - Updated RunningStats: new_mean=44.162441389332365, new_var=16300000200458.006, new_n=1640
2025-06-02 15:52:35,114 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:52:35,114 - DEBUG - Online update step: 1/50
2025-06-02 15:52:35,114 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,114 - DEBUG - Online update step: 2/50
2025-06-02 15:52:35,114 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,114 - DEBUG - Online update step: 3/50
2025-06-02 15:52:35,114 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,114 - DEBUG - Online update step: 4/50
2025-06-02 15:52:35,114 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,114 - DEBUG - Online update step: 5/50
2025-06-02 15:52:35,114 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,114 - DEBUG - Online update step: 6/50
2025-06-02 15:52:35,114 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,114 - DEBUG - Online update step: 7/50
2025-06-02 15:52:35,114 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,114 - DEBUG - Online update step: 8/50
2025-06-02 15:52:35,114 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,114 - DEBUG - Online update step: 9/50
2025-06-02 15:52:35,114 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,115 - DEBUG - Online update step: 10/50
2025-06-02 15:52:35,115 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,115 - DEBUG - Online update step: 11/50
2025-06-02 15:52:35,115 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,115 - DEBUG - Online update step: 12/50
2025-06-02 15:52:35,115 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,115 - DEBUG - Online update step: 13/50
2025-06-02 15:52:35,115 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,115 - DEBUG - Online update step: 14/50
2025-06-02 15:52:35,115 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,115 - DEBUG - Online update step: 15/50
2025-06-02 15:52:35,115 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,115 - DEBUG - Online update step: 16/50
2025-06-02 15:52:35,115 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,115 - DEBUG - Online update step: 17/50
2025-06-02 15:52:35,115 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,115 - DEBUG - Online update step: 18/50
2025-06-02 15:52:35,115 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,115 - DEBUG - Online update step: 19/50
2025-06-02 15:52:35,115 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,115 - DEBUG - Online update step: 20/50
2025-06-02 15:52:35,115 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,115 - DEBUG - Online update step: 21/50
2025-06-02 15:52:35,115 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,115 - DEBUG - Online update step: 22/50
2025-06-02 15:52:35,115 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,115 - DEBUG - Online update step: 23/50
2025-06-02 15:52:35,115 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,115 - DEBUG - Online update step: 24/50
2025-06-02 15:52:35,115 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,115 - DEBUG - Online update step: 25/50
2025-06-02 15:52:35,115 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,115 - DEBUG - Online update step: 26/50
2025-06-02 15:52:35,115 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,115 - DEBUG - Online update step: 27/50
2025-06-02 15:52:35,115 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,115 - DEBUG - Online update step: 28/50
2025-06-02 15:52:35,115 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,115 - DEBUG - Online update step: 29/50
2025-06-02 15:52:35,116 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,116 - DEBUG - Online update step: 30/50
2025-06-02 15:52:35,116 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,116 - DEBUG - Online update step: 31/50
2025-06-02 15:52:35,116 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,116 - DEBUG - Online update step: 32/50
2025-06-02 15:52:35,116 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,116 - DEBUG - Online update step: 33/50
2025-06-02 15:52:35,116 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,116 - DEBUG - Online update step: 34/50
2025-06-02 15:52:35,116 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,116 - DEBUG - Online update step: 35/50
2025-06-02 15:52:35,116 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,116 - DEBUG - Online update step: 36/50
2025-06-02 15:52:35,116 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,116 - DEBUG - Online update step: 37/50
2025-06-02 15:52:35,116 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,116 - DEBUG - Online update step: 38/50
2025-06-02 15:52:35,116 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,116 - DEBUG - Online update step: 39/50
2025-06-02 15:52:35,116 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,116 - DEBUG - Online update step: 40/50
2025-06-02 15:52:35,116 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,116 - DEBUG - Online update step: 41/50
2025-06-02 15:52:35,116 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,116 - DEBUG - Online update step: 42/50
2025-06-02 15:52:35,116 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,116 - DEBUG - Online update step: 43/50
2025-06-02 15:52:35,116 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,116 - DEBUG - Online update step: 44/50
2025-06-02 15:52:35,116 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,116 - DEBUG - Online update step: 45/50
2025-06-02 15:52:35,116 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,116 - DEBUG - Online update step: 46/50
2025-06-02 15:52:35,116 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,116 - DEBUG - Online update step: 47/50
2025-06-02 15:52:35,116 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,116 - DEBUG - Online update step: 48/50
2025-06-02 15:52:35,116 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,116 - DEBUG - Online update step: 49/50
2025-06-02 15:52:35,117 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,117 - DEBUG - Online update step: 50/50
2025-06-02 15:52:35,117 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,117 - WARNING - No successful steps during online update.
2025-06-02 15:52:35,117 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00  2.00071533e-08 -1.09705894e-07
  0.00000000e+00  0.00000000e+00  0.00000000e+00 -2.00071537e-09
 -2.13409646e-08 -1.20042918e-08 -2.93438251e-08 -2.66762057e-09
  2.31608391e+00  2.96083927e+00  1.39860138e-01  4.39300680e+00
  1.20042918e-08  3.52027965e+00  5.65734243e+00  7.60839176e+00
  1.39860138e-01  8.00000000e+00 -1.80064390e-08  2.66762057e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  3.96808559e-08 -2.13409646e-08], current edge mean: [ 8.7780672e-09  4.6051611e+02  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.2540097e-09  2.5080193e-09  1.2540097e-09
  0.0000000e+00  0.0000000e+00]
2025-06-02 15:52:35,117 - DEBUG - Node drift difference: 0.0255, Edge drift difference: 0.0016
2025-06-02 15:52:35,118 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00  2.00071533e-08 -1.09705894e-07
  0.00000000e+00  0.00000000e+00  0.00000000e+00 -2.00071537e-09
 -2.13409646e-08 -1.20042918e-08 -2.93438251e-08 -2.66762057e-09
  2.31608391e+00  2.96083927e+00  1.39860138e-01  4.39300680e+00
  1.20042918e-08  3.52027965e+00  5.65734243e+00  7.60839176e+00
  1.39860138e-01  8.00000000e+00 -1.80064390e-08  2.66762057e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  3.96808559e-08 -2.13409646e-08], edge=[ 8.7780672e-09  4.6051611e+02  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.2540097e-09  2.5080193e-09  1.2540097e-09
  0.0000000e+00  0.0000000e+00]
2025-06-02 15:52:35,118 - DEBUG - Updated reference std: node=[0.         0.         1.0007     1.0007     0.         0.
 0.         1.0007     1.0007     1.0007001  1.0007     1.0007
 1.017057   0.27730066 0.3667061  0.56330985 1.0007001  3.0911584
 2.9346402  1.4961902  0.3667061  0.         1.0007001  1.0007
 0.         0.         0.         0.         1.0007     1.0007    ], edge=[  1.0003289 472.54977     0.          0.          1.0003289   1.0003289
   1.0003289   1.0003289   1.0003289   1.0003289]
2025-06-02 15:52:35,118 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:52:35,118 - INFO - Running anomaly detection...
2025-06-02 15:52:35,119 - INFO - Starting anomaly detection.
2025-06-02 15:52:35,124 - DEBUG - Node reconstruction errors: [16.524174  13.596137  22.856457  15.877094  10.335704   8.388519
 21.29687   12.349042  12.349042  12.80111   12.349043  10.850362
 27.844631   8.754697  14.934039  16.096745  11.288397  16.106983
 17.74171   15.700347  11.924175  14.934039  12.6601515 10.4959755
 14.947232  12.538141  14.947232   9.75323   11.9448    14.947232
 10.999122  13.122164   9.434128  15.595433  12.649455  15.901443
  8.035963  15.700347  11.227128  11.494842  15.486206  14.588126
 15.700347  16.390614  15.857803  12.377389  17.747179   8.727916
 11.615614  16.252626  25.448128  12.280182  12.211537  17.040869
 11.476227  10.764176  22.135637  15.107982  16.48211   16.68716
  7.490211  15.575408  14.3090515 10.264058  14.2397175 11.476269
 11.743063  11.476137  14.3090515 14.3090515 11.8118305  8.322575
 11.744334   7.6512747  7.456763   8.453154  15.588294   8.250882
  7.531021   7.4935193 14.692366   8.480597   7.5793386 11.007018
 10.720474   9.673196   9.17258    7.5287104  7.337024   8.860783
 14.271784   8.683164   9.510822   7.383359  11.420488  26.127079
 14.386044   7.6324186 14.073933  11.392431   8.203858  14.386044
 15.009296   9.023487   9.489024  11.097607  15.481857   7.3041763
  9.652928  13.76196   14.412365  14.857983  10.2719     9.932272
  8.33848    8.685994   8.239612   8.504548   7.275879  11.703203
 14.273734  10.052421   9.810329   9.805239   7.166881  11.703168
  9.39556    7.447865   8.702432  14.93536   11.796027  11.428057
 14.865464   9.381053   8.340338  11.229916  15.224658  13.955736
  7.502274   9.0334215 12.182997   8.934133  14.441552  11.625919
 11.96333    8.1869335  8.239613  11.351647  11.36168    7.2604914
 13.116246   9.532667   7.3801136 11.428055   7.248177   8.635219
 11.38206    8.940522   8.203857  14.832535  11.963329   7.7573137
 11.382058  11.796027   8.260746   8.479259   8.166016   7.355012
  7.9986057  7.3879375  7.3852015 11.898868  14.03731   20.715696
  7.523689  12.076788   7.33658    8.421475   8.204146   8.204147
 11.084542   9.103864  14.337434   9.293589   8.391067   8.1704235
 14.387195   8.276553  11.212638  11.375052   7.3399153  7.3193545
 12.126633  11.258388   7.5022736 11.8094     7.037884  14.809407
  8.469934  14.958756  14.604787  11.382058   9.820744   7.3400865
  8.251878   9.510821  11.539292   8.90469   14.214983   7.3356843
  8.297591   8.170422  11.567938   7.5931673  7.0711827 14.488141
  8.752864   8.239613   8.180736  11.258388   9.517529  14.387195
 13.929716  11.567938  11.382058   7.0740504  8.384996  11.222936
  7.268695  10.163467   9.964118   7.147512   7.611975   8.239613
  8.2396145 11.8094     7.366901  13.929716  11.382058  15.134917
  8.453344   7.5325303 11.268851   7.2604904 11.138393   7.227654
  8.482699   8.151081  11.268851  11.589857  14.03731   13.888031
  8.180731   7.4865856  8.685989   8.214632  11.37505   14.35507
 14.595852   8.204147   7.3177295  8.625928  15.027587  11.560727
  7.3573513 11.408525   7.100068  10.275804   7.100067   8.752619
  9.837      9.476263   7.34565   14.731919   8.1435795  8.204146
 14.142176   7.5443287 11.084543   7.45502    8.288087  13.9672575
  7.24617   14.653836   8.668071  14.334028   8.633558   7.398413
  9.103864  10.168305  11.75246   14.669932  11.576537  11.138393
  9.284567  14.73767    7.417338   8.204509  11.8094    14.604735
  7.262075  13.796142   8.1933975  8.193399  13.796143  13.796143
 13.796143   8.120737  13.956376  13.796142  13.796143   7.371964
 13.796143  11.427231   7.517144   7.216337   8.652326   9.305036
 11.529507  11.967096   7.056849  11.957445   7.084503   8.193399
 11.353384   9.385638  13.9869585  8.120739   7.270278   7.270278
  7.414613  11.876176  13.796142   8.143581  13.796143   8.120735
 11.862909  13.786896  13.9869585 13.9869585 13.796142  14.2062235
 13.9869585  7.1254964  7.120069   7.100066   8.193402  14.446269
  7.096571   7.2383957 13.796142   8.740358   9.681937   8.444074
 14.340937  11.375054  14.328386  13.796142  13.853333  12.8398905
  8.297589  11.4769125 10.293084   7.162163   8.193412  20.543436
 14.02617    8.28627    8.2121315  8.346453   7.3721557  7.1212707
  7.371927   9.559851   7.1743984  8.041944  13.879031  11.158092
  7.089633  13.796143   8.193398   7.773143  11.550522   7.2332025
  7.7731442  8.241116  10.977956   9.102579   7.9261456 13.796143
  8.408048   8.516539   8.296521   8.460051   7.8818426  7.8818426
  7.8818426 16.037085  13.802977  16.241858  11.598422   8.392964
  7.8818426 13.802977   8.321524   8.296554   6.9704547 11.728593
  8.296523   6.983096   7.8818426  8.296521  13.802977   7.8818426
  7.8818426 14.759006  14.1663065  7.8818426 13.87903   14.164228
 11.686885  11.134762   8.289826  11.704159   9.42604   11.687264
 11.598422   8.655948   7.194449  15.01294    6.995714  11.279632
  8.188558   7.995707   7.8818426  7.8818426 11.598422   6.9470987
  9.6753645 13.949862  14.0387535 11.275012  14.575238  14.342663
 14.342663   7.5725803  8.594562  11.750144  11.750147  11.676228
  7.0660334 13.863016  11.515801  13.811938  13.863016  11.44332
 11.704159  11.523836  14.699624   8.289825   8.218443  11.36276
 11.845721   9.337655  11.523836  11.36276   13.716129   8.289827
  7.718297  12.0713    13.716129   8.218449   7.1910524  9.9454775
  7.278216   8.290997   8.387689   8.218443  14.0387535 11.370174
 14.482738   7.8213916 14.496105  11.370174   9.337862  13.724454
 13.863016   7.413785  15.129089   9.880209   8.681102  14.0387535
  7.2489543 14.16423    8.389871  11.523837   8.277088  16.127186
 13.811938  11.370174  11.370174  14.164228  11.7742195 13.898851
 13.724454   9.279538  13.999041   8.362592  11.515802  13.863016
  9.432774  11.4481    11.4481    13.863016   8.179935  13.863016
 13.99904    8.342263  14.727695   7.406575   8.342263  11.275012
 13.99904   11.750147  13.724454   8.277087  11.822775   9.03924
  8.342259   7.0660334 13.863016  13.811938  13.811938  11.370174
  8.277088   8.348871   7.3284116  7.0376563 13.811936   7.957626
 13.811938   7.957626  14.177343   8.342258  11.4481    11.4481
 11.4481    13.900953  10.823016  13.900953  13.900953  13.900953
 13.900953  13.900953  13.900953  13.900953   8.37402   11.451649
 15.044058  13.900953  13.900953  13.900953  13.900953  13.900953
 13.900953  13.900953  13.900953  13.900953   8.502398  13.900953
 13.900953   8.374021  13.900953  13.863016  13.47103   13.811938
 14.503279   8.503146  17.002104  17.002104   7.016667  14.503279
 13.811936  13.99904   13.99904   13.811936  13.99904   13.811938
 11.668345  13.900953  11.275012  13.811938  11.4481    13.811938
 13.811938  13.99904   13.811936  13.99904   13.811938  13.811936
  8.34226   13.99904   13.811938  13.99904   13.811938  13.811938
 13.811936   7.032871   8.389869   8.389869  13.900953  11.156584
 13.848187  13.811938  13.999041   7.2255864 13.900953  13.99904
  7.1051545 14.204585  13.811938  13.811938   8.31504    7.1280465
  7.8908477 13.811938   8.3740225 13.999041  13.99904    9.192852
 13.900953  13.99904    8.342263  13.900953  13.900953   8.3740225
 13.811938  13.811936   9.782792   7.8908477  8.342952   7.1280465
 14.239805   8.002111   8.002111  13.488294  13.940919  13.900953
 11.613673   8.23775    7.1280465  8.068394  13.940919  14.043539
 13.996713  13.996713  13.996713  13.996713  13.996713   8.699839
  8.288813  13.996713  13.996713  13.900953  13.900953  13.900953
  8.002111   7.1568284  8.002111  14.388082   8.002111   8.502399
  8.5023985 13.900953   8.5023985 13.900953   8.002111  13.800665
 14.09699   14.09699   13.996713  13.800665   8.068394  14.39975
 13.900953  13.900953  13.996713  14.043539  14.09699   14.09699
 14.04354   13.924347   8.699836  10.717132  14.019903  14.534778
 11.5688505 14.04354   11.5688505 13.924347  14.102184  14.102184
  8.426225  14.039114   8.186475  14.043539  14.04354   14.043539
 14.134349  14.043539  14.043539  14.102184  14.043539  14.043539
 14.043539 ]
2025-06-02 15:52:35,124 - DEBUG - Edge reconstruction errors: [  4.4748993   4.655549   43.884407  ...  12.469419   12.681866
 535.2436   ]
2025-06-02 15:52:35,130 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155235_update_24.json
2025-06-02 15:52:35,131 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:52:35,134 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155235_update_24.pth and as latest_checkpoint.pth
2025-06-02 15:52:35,134 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869815.dot): 0.4377
2025-06-02 15:52:35,134 - WARNING - Detected 8 anomalous nodes (reconstruction-based):
2025-06-02 15:52:35,134 - WARNING -   Node ID: 192.168.27.13, Recon Error: 22.8565, MLP Score: 0.9491
2025-06-02 15:52:35,134 - WARNING -   Node ID: 192.168.27.12, Recon Error: 21.2969, MLP Score: 0.9465
2025-06-02 15:52:35,134 - WARNING -   Node ID: 192.168.27.10, Recon Error: 27.8446, MLP Score: 0.9508
2025-06-02 15:52:35,134 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 25.4481, MLP Score: 0.9668
2025-06-02 15:52:35,134 - WARNING -   Node ID: 192.168.209.130, Recon Error: 22.1356, MLP Score: 0.7375
2025-06-02 15:52:35,134 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-02 15:52:35,134 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2430, MLP Score: 0.0000
2025-06-02 15:52:35,134 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9481, MLP Score: 0.0000
2025-06-02 15:52:35,134 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0468, MLP Score: 0.0000
2025-06-02 15:52:35,135 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7458, MLP Score: 0.0000
2025-06-02 15:52:35,135 - WARNING -   Source: 192.168.27.12, Target: 224.0.0.251, Recon Error: 535.2436, MLP Score: 0.0000
2025-06-02 15:52:35,135 - INFO - 
--- Processing file: nw_graph_encoded_1748869845.dot (Timestamp: 2025-06-02 15:10:45) ---
2025-06-02 15:52:35,135 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869845.dot
2025-06-02 15:52:35,135 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869845.dot'.
2025-06-02 15:52:35,135 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869845.dot
2025-06-02 15:52:35,154 - INFO - Parsed 723 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869845.dot'.
2025-06-02 15:52:35,174 - INFO - Parsed 1547 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869845.dot'.
2025-06-02 15:52:35,174 - INFO - Processing node updates/additions.
2025-06-02 15:52:35,178 - INFO - Processing edge updates/additions.
2025-06-02 15:52:35,187 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:52:35,188 - INFO - Finished updating NetworkX graph.
2025-06-02 15:52:35,188 - DEBUG - Updated graph - Nodes: 723, Edges: 1547
2025-06-02 15:52:35,188 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:52:35,189 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:52:35,196 - DEBUG - Initial node features tensor shape: torch.Size([723, 30])
2025-06-02 15:52:35,198 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:52:35,198 - DEBUG - Node features tensor shape after scaling: torch.Size([723, 30])
2025-06-02 15:52:35,199 - DEBUG - Edge index tensor shape: torch.Size([2, 1547])
2025-06-02 15:52:35,200 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:52:35,203 - DEBUG - Initial edge attributes tensor shape: torch.Size([1547, 10])
2025-06-02 15:52:35,204 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:52:35,204 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1547, 10])
2025-06-02 15:52:35,204 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:52:35,204 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:52:35,205 - INFO - Updated main graph to 723 nodes and 1547 edges.
2025-06-02 15:52:35,205 - INFO - Performing online update...
2025-06-02 15:52:35,205 - INFO - Starting online update for 50 steps.
2025-06-02 15:52:35,206 - DEBUG - Updated RunningStats: new_mean=0.9431609237447988, new_var=49200000000160.766, new_n=4950
2025-06-02 15:52:35,206 - DEBUG - Updated RunningStats: new_mean=0.9419263689226988, new_var=49500000000019.13, new_n=4980
2025-06-02 15:52:35,206 - DEBUG - Updated RunningStats: new_mean=44.17357026608481, new_var=16400000190462.8, new_n=1650
2025-06-02 15:52:35,206 - DEBUG - Updated RunningStats: new_mean=44.19401052948638, new_var=16500000197141.78, new_n=1660
2025-06-02 15:52:35,206 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:52:35,206 - DEBUG - Online update step: 1/50
2025-06-02 15:52:35,206 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,206 - DEBUG - Online update step: 2/50
2025-06-02 15:52:35,206 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,206 - DEBUG - Online update step: 3/50
2025-06-02 15:52:35,206 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,206 - DEBUG - Online update step: 4/50
2025-06-02 15:52:35,207 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,207 - DEBUG - Online update step: 5/50
2025-06-02 15:52:35,207 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,207 - DEBUG - Online update step: 6/50
2025-06-02 15:52:35,207 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,207 - DEBUG - Online update step: 7/50
2025-06-02 15:52:35,207 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,207 - DEBUG - Online update step: 8/50
2025-06-02 15:52:35,207 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,207 - DEBUG - Online update step: 9/50
2025-06-02 15:52:35,207 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,207 - DEBUG - Online update step: 10/50
2025-06-02 15:52:35,207 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,207 - DEBUG - Online update step: 11/50
2025-06-02 15:52:35,207 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,207 - DEBUG - Online update step: 12/50
2025-06-02 15:52:35,207 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,207 - DEBUG - Online update step: 13/50
2025-06-02 15:52:35,207 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,207 - DEBUG - Online update step: 14/50
2025-06-02 15:52:35,207 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,207 - DEBUG - Online update step: 15/50
2025-06-02 15:52:35,207 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,207 - DEBUG - Online update step: 16/50
2025-06-02 15:52:35,207 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,207 - DEBUG - Online update step: 17/50
2025-06-02 15:52:35,207 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,207 - DEBUG - Online update step: 18/50
2025-06-02 15:52:35,207 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,207 - DEBUG - Online update step: 19/50
2025-06-02 15:52:35,207 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,207 - DEBUG - Online update step: 20/50
2025-06-02 15:52:35,207 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,207 - DEBUG - Online update step: 21/50
2025-06-02 15:52:35,207 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,207 - DEBUG - Online update step: 22/50
2025-06-02 15:52:35,207 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,207 - DEBUG - Online update step: 23/50
2025-06-02 15:52:35,207 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,208 - DEBUG - Online update step: 24/50
2025-06-02 15:52:35,208 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,208 - DEBUG - Online update step: 25/50
2025-06-02 15:52:35,208 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,208 - DEBUG - Online update step: 26/50
2025-06-02 15:52:35,208 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,208 - DEBUG - Online update step: 27/50
2025-06-02 15:52:35,208 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,208 - DEBUG - Online update step: 28/50
2025-06-02 15:52:35,208 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,208 - DEBUG - Online update step: 29/50
2025-06-02 15:52:35,208 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,208 - DEBUG - Online update step: 30/50
2025-06-02 15:52:35,208 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,208 - DEBUG - Online update step: 31/50
2025-06-02 15:52:35,208 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,208 - DEBUG - Online update step: 32/50
2025-06-02 15:52:35,208 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,208 - DEBUG - Online update step: 33/50
2025-06-02 15:52:35,208 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,208 - DEBUG - Online update step: 34/50
2025-06-02 15:52:35,208 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,208 - DEBUG - Online update step: 35/50
2025-06-02 15:52:35,208 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,208 - DEBUG - Online update step: 36/50
2025-06-02 15:52:35,208 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,208 - DEBUG - Online update step: 37/50
2025-06-02 15:52:35,208 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,208 - DEBUG - Online update step: 38/50
2025-06-02 15:52:35,208 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,208 - DEBUG - Online update step: 39/50
2025-06-02 15:52:35,208 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,208 - DEBUG - Online update step: 40/50
2025-06-02 15:52:35,208 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,208 - DEBUG - Online update step: 41/50
2025-06-02 15:52:35,208 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,208 - DEBUG - Online update step: 42/50
2025-06-02 15:52:35,208 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,208 - DEBUG - Online update step: 43/50
2025-06-02 15:52:35,208 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,209 - DEBUG - Online update step: 44/50
2025-06-02 15:52:35,209 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,209 - DEBUG - Online update step: 45/50
2025-06-02 15:52:35,209 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,209 - DEBUG - Online update step: 46/50
2025-06-02 15:52:35,209 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,209 - DEBUG - Online update step: 47/50
2025-06-02 15:52:35,209 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,209 - DEBUG - Online update step: 48/50
2025-06-02 15:52:35,209 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,209 - DEBUG - Online update step: 49/50
2025-06-02 15:52:35,209 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,209 - DEBUG - Online update step: 50/50
2025-06-02 15:52:35,209 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,209 - WARNING - No successful steps during online update.
2025-06-02 15:52:35,209 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  2.9019136e-08  3.4295343e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.1871465e-08
  1.8466723e-08 -6.5952581e-09 -1.3190516e-09  2.9019136e-08
  2.3098202e+00  2.9612725e+00  1.4661135e-01  4.3900414e+00
  6.5952581e-09  3.5532503e+00  5.6334715e+00  7.6044259e+00
  1.4661135e-01  8.0000000e+00  0.0000000e+00 -3.2976292e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.9678662e-09 -1.8466723e-08], current edge mean: [-8.6305372e-09  4.5998706e+02  0.0000000e+00  0.0000000e+00
  0.0000000e+00  2.4658677e-09 -2.4658677e-09 -1.5411673e-09
 -4.3152686e-09  2.4658677e-09]
2025-06-02 15:52:35,210 - DEBUG - Node drift difference: 0.0184, Edge drift difference: 0.0011
2025-06-02 15:52:35,210 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  2.9019136e-08  3.4295343e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.1871465e-08
  1.8466723e-08 -6.5952581e-09 -1.3190516e-09  2.9019136e-08
  2.3098202e+00  2.9612725e+00  1.4661135e-01  4.3900414e+00
  6.5952581e-09  3.5532503e+00  5.6334715e+00  7.6044259e+00
  1.4661135e-01  8.0000000e+00  0.0000000e+00 -3.2976292e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.9678662e-09 -1.8466723e-08], edge=[-8.6305372e-09  4.5998706e+02  0.0000000e+00  0.0000000e+00
  0.0000000e+00  2.4658677e-09 -2.4658677e-09 -1.5411673e-09
 -4.3152686e-09  2.4658677e-09]
2025-06-02 15:52:35,210 - DEBUG - Updated reference std: node=[0.         0.         1.0006922  1.0006922  0.         0.
 0.         1.0006924  1.0006922  1.0006924  1.0006922  1.0006922
 1.0100604  0.27579054 0.37301496 0.5619617  1.0006924  3.101849
 2.9398093  1.5029361  0.37301496 0.         1.0006922  1.0006924
 0.         0.         0.         0.         1.0006922  1.0006924 ], edge=[  1.0003234 468.66428     0.          0.          1.0003234   1.0003233
   1.0003234   1.0003234   1.0003234   1.0003234]
2025-06-02 15:52:35,211 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:52:35,211 - INFO - Running anomaly detection...
2025-06-02 15:52:35,211 - INFO - Starting anomaly detection.
2025-06-02 15:52:35,216 - DEBUG - Node reconstruction errors: [16.49184   13.946305  23.018589  15.86742   10.341336   8.391049
 21.449585  12.332944  12.332943  12.783478  12.332944  10.8464
 28.055885   8.743573  14.935886  16.089727  11.283857  16.099785
 17.765285  15.702307  11.920594  14.935885  12.849385  10.486971
 14.949768  12.529376  14.949768   9.762097  11.937539  14.94977
 11.028528  13.101815   9.456432  15.594742  12.641565  15.879347
  8.033677  15.702311  11.20902   11.486652  15.492524  14.596204
 15.702311  16.372765  15.858667  12.356501  17.750055   8.705203
 11.614154  16.185368  25.576326  12.278321  12.208949  17.075016
 11.476139  10.7508545 22.6954    15.119546  16.524218  16.73149
  7.4932504 15.565964  14.321338  10.750474  14.251182  11.476181
 11.742786  11.476048  14.321339  14.321339  11.795025   8.3267565
 11.738397   7.6709547  7.4705462  8.456525  15.592012   8.254751
  7.5468516  7.5138483 14.706056   8.480948   7.562531  11.013328
 10.734788   9.675874   9.160293   7.545604   7.3571396  8.865973
 14.28412    8.697693   9.517573   7.4032984 11.420112  26.285767
 14.39851    7.6408505 14.08753   11.391183   8.2097    14.39851
 15.020353   9.032088   9.478158  11.096102  15.466742   7.726292
  9.658483  13.879675  14.819913  14.870436  10.262028   9.935319
  8.337274   8.686692   8.241125   8.518182   7.2949758 11.691318
 14.285916  10.051391   9.805167   9.797827   7.1824107 11.691283
  9.401794   7.441327   8.697809  14.929851  11.800116  11.432316
 14.878923   9.380585   8.335605  11.230337  15.221724  13.970158
  7.496857   9.057085  12.156991   8.928302  14.447801  11.621398
 11.944758   8.19208    8.241125  11.357249  11.366492   7.2778788
 13.130833   9.517337   7.4014955 11.432317   7.2614717  8.649967
 11.379945   8.928814   8.209701  14.847395  11.944758   7.7428465
 11.379945  11.800117   8.262191   8.496572   8.174342   7.3709216
  7.9764776  7.4006557  7.4059706 11.879716  14.053202  20.86453
  7.5377    12.1054945  7.352818   8.425775   8.20528    8.205279
 11.079246   9.114374  14.34986    9.296948   8.4124565  8.797324
 14.394912   8.278834  11.209277  11.369017   7.3588214  7.3345795
 12.1235    11.261354   7.4968557 11.801544   7.033607  14.812292
  8.486061  14.952792  14.605805  11.379945   9.820478   7.3597736
  8.25624    9.517573  11.543891   8.921206  14.224814   7.3562274
  8.293839   8.17255   11.570792   7.6057506  7.081845  14.488255
  8.752562   8.241122   8.182025  11.261356   9.525321  14.394912
 13.945304  11.570792  11.379945   7.091708   8.398931  11.226904
  7.288058  10.158972   9.966358   7.163623   7.6203265  8.241123
  8.241122  11.801544   7.3840714 13.945304  11.379945  15.145913
  8.480081   7.5465155 11.273493   7.27788   11.14176    7.233628
  8.481796   8.156724  11.273493  11.584927  14.053202  13.902373
  8.182025   7.500466   8.686685   8.217314  11.369017  14.357527
 14.592043   8.205281   7.3284507  8.63175   15.039843  11.54948
  7.3743997 11.404028   7.1204467 10.308989   7.1204457  8.741015
  9.838727   9.477726   7.3602567 14.916075   8.148571   8.205281
 14.153246   7.5644403 11.079246   7.4619923  8.309306  13.98136
  7.254755  14.668203   8.657293  14.348234   8.660405   7.401134
  9.114374  10.150335  11.7340975 14.667878  11.58037   11.14176
  9.277165  14.736173   7.4303865  8.205644  11.801544  15.33984
  7.2752805 13.808712   8.193828   8.193831  13.808712  13.808712
 13.808712   8.123006  13.965824  13.808712  13.808712   7.3822756
 13.808712  11.415451   7.685368   7.231424   8.644442   9.312906
 11.530564  11.954652   7.0758953 11.942112   7.103318   8.19383
 11.343624   9.390828  13.999274   8.123007   7.2907314  7.290733
  7.432776  11.8619795 13.808712   8.148578  13.808712   8.123011
 11.847555  13.800704  13.999273  13.999274  13.808712  14.217127
 13.999274   7.198321   7.1332335  7.1204505  8.193828  14.457538
  7.110698   7.255011  13.808712   8.74085    9.690351   8.437329
 14.351466  11.369017  14.333157  13.808712  13.868351  12.834772
  8.2938385 11.467047  10.312383   7.1712437  8.193844  20.935688
 14.0376005  8.307621   8.212678   8.35006    7.3824635  7.130631
  7.3822336  9.564141   7.1889467  8.437684  13.891977  11.161143
  7.1834493 13.808712   8.193829   7.7469954 11.540641   7.2418737
  7.7469964  8.24216   10.980757   9.093146   7.9359436 13.808712
  8.400981   8.5151415  8.294042   8.456139   7.8894567  7.889456
  7.889456  16.072502  13.810253  16.27948   11.568863   8.384442
  7.8894567 13.810253   8.315893   8.294066   6.985303  11.703152
  8.294044   6.976804   7.8894567  8.294044  13.810253   7.889456
  7.889456  14.766378  14.17609    7.889456  13.891981  14.168917
 11.672477  11.130873   8.290425  11.691192   9.436538  11.672848
 11.568863   8.636909   7.196401  15.015961   7.0052114 11.265413
  8.185976   7.9984064  7.889456   7.889456  11.568863   6.957663
  9.693278  13.951745  14.041104  11.2587385 14.583184  14.351835
 14.351835   7.5477996  8.592101  11.740312  11.740312  11.6603985
  7.0719886 13.870352  11.507793  13.818922  13.870352  11.445188
 11.691192  11.50579   14.713792   8.290427   8.221494  11.355996
 11.849664   9.352792  11.50579   11.355994  13.727025   8.290426
  7.689336  12.062381  13.727025   8.221494   7.197761   9.948965
  7.276656   8.291591   8.383597   8.221494  14.041107  11.353832
 14.490132   7.833365  14.507341  11.353832   9.342009  13.730162
 13.870353   7.402501  15.147715   9.890376   8.672003  14.041104
  7.250532  14.168917   8.375532  11.505792   8.273628  16.166239
 13.818922  11.353831  11.353832  14.168917  11.775968  13.905715
 13.730162   9.279398  14.000581   8.382385  11.507793  13.870353
  9.422528  11.428309  11.428309  13.870352   8.172761  13.870353
 14.000582   8.338024  14.737181   7.4075866  8.338022  11.2587385
 14.000582  11.740312  13.730162   8.273633  11.805924   9.037489
  8.338025   7.07199   13.870352  13.818922  13.818922  11.353832
  8.273629   8.346898   7.331988   7.0394087 13.818922   7.958287
 13.818922   7.9582853 14.303671   8.338022  11.428309  11.428309
 11.428309  13.899584  10.849275  13.899584  13.899584  13.899584
 13.899584  13.899584  13.899584  13.899584   8.365216  11.440144
 15.056108  13.899584  13.899584  13.899584  13.899584  13.899584
 13.899584  13.899584  13.899584  13.899584   8.490432  13.899584
 13.899584   8.365216  13.899584  13.870352  13.477     13.818922
 14.517882   8.49121   17.01303   17.01303    7.021651  14.517882
 13.818922  14.000583  14.000582  13.818922  14.000582  13.818922
 11.677976  13.899584  11.2587385 13.818922  11.4283085 13.818922
 13.818922  14.000582  13.818922  14.000582  13.818922  13.818922
  8.338021  14.000581  13.818922  14.000581  13.818922  13.818922
 13.818922   7.035439   8.375535   8.375534  13.899584  11.138508
 13.85928   13.818922  14.000582   7.2176614 13.899584  14.000582
  7.101454  14.199465  13.818922  13.818922   8.655294   7.1243415
  7.889871  13.818922   8.365216  14.000582  14.000582   9.185305
 13.899584  14.000581   8.338023  13.899584  13.899584   8.365212
 13.818922  13.818922   9.801589   7.8898697  8.324444   7.1243405
 14.248668   7.989492   7.989492  13.502508  13.941616  13.899584
 11.594419   8.220025   7.1243415  8.592899  13.941616  14.0472975
 14.005924  14.005923  14.005925  14.005923  14.005924   8.678133
  8.268404  14.005924  14.005924  13.899584  13.899584  13.899584
  7.989492   7.1485915  7.9894896 14.387234   7.9894896  8.490436
  8.490436  13.899584   8.490432  13.899584   7.989492  13.799144
 14.097118  14.097118  14.005924  13.799144   7.2886863 14.414581
 13.899584  13.899584  14.005923  14.0472975 14.097118  14.097118
 14.0472975 13.918001   8.678132  10.722662  14.022112   7.9062195
  8.418312  14.0472975 11.566219  13.918001  14.09071   14.09071
  8.394179  14.027522   8.16628   14.0472975 14.0472975 14.0472975
 14.13919   14.0472975 14.0472975 14.09071   14.0472975 14.0472975
 14.0472975  8.440348  13.959454   7.5562396  7.556241   8.440348
 11.784971  14.09071    8.440349 ]
2025-06-02 15:52:35,217 - DEBUG - Edge reconstruction errors: [  4.4629836   4.6407976  43.882107  ...  12.466669   12.646721
 535.2442   ]
2025-06-02 15:52:35,218 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155235_update_25.json
2025-06-02 15:52:35,218 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:52:35,221 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155235_update_25.pth and as latest_checkpoint.pth
2025-06-02 15:52:35,221 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869845.dot): 0.4377
2025-06-02 15:52:35,221 - WARNING - Detected 8 anomalous nodes (reconstruction-based):
2025-06-02 15:52:35,222 - WARNING -   Node ID: 192.168.27.13, Recon Error: 23.0186, MLP Score: 0.9492
2025-06-02 15:52:35,222 - WARNING -   Node ID: 192.168.27.12, Recon Error: 21.4496, MLP Score: 0.9468
2025-06-02 15:52:35,222 - WARNING -   Node ID: 192.168.27.10, Recon Error: 28.0559, MLP Score: 0.9507
2025-06-02 15:52:35,222 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 25.5763, MLP Score: 0.9675
2025-06-02 15:52:35,222 - WARNING -   Node ID: 192.168.209.130, Recon Error: 22.6954, MLP Score: 0.7627
2025-06-02 15:52:35,222 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-02 15:52:35,222 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2434, MLP Score: 0.0000
2025-06-02 15:52:35,222 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9484, MLP Score: 0.0000
2025-06-02 15:52:35,222 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0472, MLP Score: 0.0000
2025-06-02 15:52:35,222 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7462, MLP Score: 0.0000
2025-06-02 15:52:35,222 - WARNING -   Source: 192.168.27.12, Target: 224.0.0.251, Recon Error: 535.2442, MLP Score: 0.0000
2025-06-02 15:52:35,222 - INFO - 
--- Processing file: nw_graph_encoded_1748869875.dot (Timestamp: 2025-06-02 15:11:15) ---
2025-06-02 15:52:35,222 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869875.dot
2025-06-02 15:52:35,222 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869875.dot'.
2025-06-02 15:52:35,222 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869875.dot
2025-06-02 15:52:35,241 - INFO - Parsed 730 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869875.dot'.
2025-06-02 15:52:35,259 - INFO - Parsed 1559 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869875.dot'.
2025-06-02 15:52:35,259 - INFO - Processing node updates/additions.
2025-06-02 15:52:35,263 - INFO - Processing edge updates/additions.
2025-06-02 15:52:35,272 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:52:35,273 - INFO - Finished updating NetworkX graph.
2025-06-02 15:52:35,273 - DEBUG - Updated graph - Nodes: 730, Edges: 1559
2025-06-02 15:52:35,273 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:52:35,274 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:52:35,281 - DEBUG - Initial node features tensor shape: torch.Size([730, 30])
2025-06-02 15:52:35,282 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:52:35,283 - DEBUG - Node features tensor shape after scaling: torch.Size([730, 30])
2025-06-02 15:52:35,284 - DEBUG - Edge index tensor shape: torch.Size([2, 1559])
2025-06-02 15:52:35,284 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:52:35,287 - DEBUG - Initial edge attributes tensor shape: torch.Size([1559, 10])
2025-06-02 15:52:35,288 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:52:35,289 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1559, 10])
2025-06-02 15:52:35,289 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:52:35,289 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:52:35,289 - INFO - Updated main graph to 730 nodes and 1559 edges.
2025-06-02 15:52:35,289 - INFO - Performing online update...
2025-06-02 15:52:35,290 - INFO - Starting online update for 50 steps.
2025-06-02 15:52:35,290 - DEBUG - Updated RunningStats: new_mean=0.9432185277595393, new_var=49800000000160.77, new_n=5010
2025-06-02 15:52:35,290 - DEBUG - Updated RunningStats: new_mean=0.9419978408689675, new_var=50100000000019.08, new_n=5040
2025-06-02 15:52:35,290 - DEBUG - Updated RunningStats: new_mean=44.2078468819841, new_var=16600000194694.758, new_n=1670
2025-06-02 15:52:35,290 - DEBUG - Updated RunningStats: new_mean=44.25455131661098, new_var=16700000237245.598, new_n=1680
2025-06-02 15:52:35,291 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:52:35,291 - DEBUG - Online update step: 1/50
2025-06-02 15:52:35,291 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,291 - DEBUG - Online update step: 2/50
2025-06-02 15:52:35,291 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,291 - DEBUG - Online update step: 3/50
2025-06-02 15:52:35,291 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,291 - DEBUG - Online update step: 4/50
2025-06-02 15:52:35,291 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,291 - DEBUG - Online update step: 5/50
2025-06-02 15:52:35,291 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,291 - DEBUG - Online update step: 6/50
2025-06-02 15:52:35,291 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,291 - DEBUG - Online update step: 7/50
2025-06-02 15:52:35,291 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,291 - DEBUG - Online update step: 8/50
2025-06-02 15:52:35,291 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,291 - DEBUG - Online update step: 9/50
2025-06-02 15:52:35,291 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,291 - DEBUG - Online update step: 10/50
2025-06-02 15:52:35,291 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,291 - DEBUG - Online update step: 11/50
2025-06-02 15:52:35,291 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,291 - DEBUG - Online update step: 12/50
2025-06-02 15:52:35,291 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,291 - DEBUG - Online update step: 13/50
2025-06-02 15:52:35,291 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,291 - DEBUG - Online update step: 14/50
2025-06-02 15:52:35,291 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,291 - DEBUG - Online update step: 15/50
2025-06-02 15:52:35,291 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,291 - DEBUG - Online update step: 16/50
2025-06-02 15:52:35,291 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,291 - DEBUG - Online update step: 17/50
2025-06-02 15:52:35,291 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,291 - DEBUG - Online update step: 18/50
2025-06-02 15:52:35,291 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,291 - DEBUG - Online update step: 19/50
2025-06-02 15:52:35,292 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,292 - DEBUG - Online update step: 20/50
2025-06-02 15:52:35,292 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,292 - DEBUG - Online update step: 21/50
2025-06-02 15:52:35,292 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,292 - DEBUG - Online update step: 22/50
2025-06-02 15:52:35,292 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,292 - DEBUG - Online update step: 23/50
2025-06-02 15:52:35,292 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,292 - DEBUG - Online update step: 24/50
2025-06-02 15:52:35,292 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,292 - DEBUG - Online update step: 25/50
2025-06-02 15:52:35,292 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,292 - DEBUG - Online update step: 26/50
2025-06-02 15:52:35,292 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,292 - DEBUG - Online update step: 27/50
2025-06-02 15:52:35,292 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,292 - DEBUG - Online update step: 28/50
2025-06-02 15:52:35,292 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,292 - DEBUG - Online update step: 29/50
2025-06-02 15:52:35,292 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,292 - DEBUG - Online update step: 30/50
2025-06-02 15:52:35,292 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,292 - DEBUG - Online update step: 31/50
2025-06-02 15:52:35,292 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,292 - DEBUG - Online update step: 32/50
2025-06-02 15:52:35,292 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,292 - DEBUG - Online update step: 33/50
2025-06-02 15:52:35,292 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,292 - DEBUG - Online update step: 34/50
2025-06-02 15:52:35,292 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,292 - DEBUG - Online update step: 35/50
2025-06-02 15:52:35,292 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,292 - DEBUG - Online update step: 36/50
2025-06-02 15:52:35,292 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,292 - DEBUG - Online update step: 37/50
2025-06-02 15:52:35,292 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,292 - DEBUG - Online update step: 38/50
2025-06-02 15:52:35,292 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,292 - DEBUG - Online update step: 39/50
2025-06-02 15:52:35,292 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,293 - DEBUG - Online update step: 40/50
2025-06-02 15:52:35,293 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,293 - DEBUG - Online update step: 41/50
2025-06-02 15:52:35,293 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,293 - DEBUG - Online update step: 42/50
2025-06-02 15:52:35,293 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,293 - DEBUG - Online update step: 43/50
2025-06-02 15:52:35,293 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,293 - DEBUG - Online update step: 44/50
2025-06-02 15:52:35,293 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,293 - DEBUG - Online update step: 45/50
2025-06-02 15:52:35,293 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,293 - DEBUG - Online update step: 46/50
2025-06-02 15:52:35,293 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,293 - DEBUG - Online update step: 47/50
2025-06-02 15:52:35,293 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,293 - DEBUG - Online update step: 48/50
2025-06-02 15:52:35,293 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,293 - DEBUG - Online update step: 49/50
2025-06-02 15:52:35,293 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,293 - DEBUG - Online update step: 50/50
2025-06-02 15:52:35,293 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:35,293 - WARNING - No successful steps during online update.
2025-06-02 15:52:35,293 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -6.5320158e-08  1.1757629e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  6.2054153e-09
 -4.1804903e-08 -3.9192094e-09 -7.8384188e-09  6.5320158e-09
  2.3013699e+00  2.9589040e+00  1.4657535e-01  4.3876715e+00
  3.9192094e-09  3.5342467e+00  5.6561642e+00  7.5999999e+00
  1.4657535e-01  8.0000000e+00  1.1104427e-08  2.4168459e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.1151701e-08  0.0000000e+00], current edge mean: [ 1.2234437e-09  4.6504681e+02  0.0000000e+00  0.0000000e+00
  3.6703309e-09 -4.8937747e-09  1.2234437e-09 -4.8937747e-09
  4.8937747e-09  0.0000000e+00]
2025-06-02 15:52:35,294 - DEBUG - Node drift difference: 0.0086, Edge drift difference: 0.0108
2025-06-02 15:52:35,294 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -6.5320158e-08  1.1757629e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  6.2054153e-09
 -4.1804903e-08 -3.9192094e-09 -7.8384188e-09  6.5320158e-09
  2.3013699e+00  2.9589040e+00  1.4657535e-01  4.3876715e+00
  3.9192094e-09  3.5342467e+00  5.6561642e+00  7.5999999e+00
  1.4657535e-01  8.0000000e+00  1.1104427e-08  2.4168459e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.1151701e-08  0.0000000e+00], edge=[ 1.2234437e-09  4.6504681e+02  0.0000000e+00  0.0000000e+00
  3.6703309e-09 -4.8937747e-09  1.2234437e-09 -4.8937747e-09
  4.8937747e-09  0.0000000e+00]
2025-06-02 15:52:35,295 - DEBUG - Updated reference std: node=[0.         0.         1.0006856  1.0006857  0.         0.
 0.         1.0006856  1.0006857  1.0006857  1.0006856  1.0006856
 1.0018492  0.28392488 0.37280026 0.56569636 1.0006857  3.0937886
 2.9347494  1.5104574  0.37280026 0.         1.0006857  1.0006857
 0.         0.         0.         0.         1.0006856  1.0006856 ], edge=[  1.0003209 513.5397      0.          0.          1.0003209   1.0003209
   1.0003208   1.0003208   1.0003209   1.0003209]
2025-06-02 15:52:35,295 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:52:35,295 - INFO - Running anomaly detection...
2025-06-02 15:52:35,295 - INFO - Starting anomaly detection.
2025-06-02 15:52:35,301 - DEBUG - Node reconstruction errors: [16.619772  13.660098  23.058279  15.843995  10.322833   8.337867
 21.528082  12.305285  12.305285  12.75555   12.305285  10.806661
 28.033712   8.813218  14.918966  16.06065   11.230671  16.07091
 17.574883  15.689099  11.907075  14.918966  12.780183  10.437231
 14.934894  12.517495  14.934894   9.740022  11.923674  14.934894
 10.8753195  9.230027   9.454082  15.57809   12.630736  15.826276
  7.97896   15.689099  11.17669   11.445303  15.485402  14.589793
 15.689099  16.334639  15.842535  12.32076   17.738827   8.657538
 11.610899  16.174244  25.671722  12.275094  12.20813   16.926517
 11.469328  10.717485  22.59858   15.124936  16.373867  17.45057
  7.486597  15.526399  14.322828  10.672807  14.253107  11.46936
 11.735857  11.469228  14.322828  14.322828  11.760828   8.308638
 11.732241   7.641939   7.439061   8.434628  15.5825205  8.242934
  7.5133395  7.48809   14.708564   8.449605   7.5351424 11.019106
 10.734983  10.726851   9.116759   7.510794   7.332114   8.825651
 14.283583   8.698797   9.496458   7.3728366 11.415113  26.403263
 14.406245   7.5919485 14.08835   11.387197   8.1884575 14.406245
 15.017365   8.998778   9.422467  11.098523  15.581684   7.6822157
  9.640819  13.865704  14.769723  14.867094  10.247348   9.937436
  8.314984   8.64249    8.219383   8.52528    7.2731705 11.671132
 14.279435  10.014942   9.800123   9.750006   7.154106  11.671099
  9.380134   7.42514    8.653045  14.898807  11.803896  11.43546
 14.888538   9.369431   8.311013  11.229674  15.205668  13.974748
  7.4788613  9.045808  12.118955   8.888923  14.432795  11.613734
 11.917962   8.173472   8.219383  11.365528  11.368901   7.256652
 13.137758   9.456574   7.3720865 11.43546    8.644567   8.645968
 11.381312   8.877685   8.188456  14.85265   11.917956   7.7111616
 11.381312  11.803896   8.2383995  8.503457   8.146139   7.344165
  7.9309826  7.372527   7.381034  11.848942  14.056749  20.981
  7.4985623 12.086387   7.322888   8.38698    8.182221   8.18222
 11.077604   9.112356  14.345587   9.303602   8.429011   8.74661
 14.382647   8.250688  11.204823  11.366126   7.3256574  7.3004007
 12.110303  11.2706995  7.4788623 11.79848    6.9942474 14.789753
  8.495998  14.922036  14.582535  11.381312   9.817556   7.334488
  8.235304   8.01971   11.548464   8.72113   14.2204275  7.3261724
  8.265357   8.148753  11.579629   7.565475   7.193387  14.469538
  8.695406   8.219383   8.158125  11.2706995  9.532464  14.382647
 13.947764  11.579629  11.381312   7.0690627  8.401178  11.237954
  7.2652106 10.121936   9.9375     7.1318803  7.572576   8.219383
  8.219384  11.79848    7.351773  13.947764  11.381312  15.15123
  8.492405   7.506698  11.281419   7.2566514 11.152681   7.1985574
  8.449548   8.133254  11.281419  11.57375   14.056749  13.909251
  8.158125   7.466273   8.642485   8.203514  11.366128  14.339126
 14.567547   8.182221   7.289742   8.620611  15.049428  11.531686
  7.3409023 11.394671   7.0929494 10.164344   7.092947   8.687175
  9.842595   9.481877   7.325861  14.891868   8.118669   8.1822195
 14.145005   7.541243  11.077602   7.4212117  8.321231  13.97624
  7.224286  14.676431   8.604478  14.355056   8.659302   7.394709
  9.112356  10.091228  11.705771  14.654608  11.583054  11.152681
  9.232153  14.706747   7.3933325  8.1825075 11.79848   15.346254
  7.243665  13.809521   8.160633   8.160634  13.809521  13.80952
 13.809521   8.092479  13.958982  13.809521  13.809521   7.3418164
 13.809521  11.405827   7.6427236  7.2032804  8.601047   9.294708
 11.536894  11.944898   7.046806  11.90787    7.0844927  8.160631
 11.330911   9.4002285 13.997681   8.092478   7.2623105  7.2623086
  7.414639  11.851553  13.80952    8.118667  13.809521   8.092478
 11.814056  13.806377  13.997681  13.997681  13.809521  14.226444
 13.997681   7.1570024  7.1007047  7.092949   8.160633  14.458159
  7.094121   7.2319226 13.809521   8.683613   9.680937   8.398576
 14.353112  11.366128  14.316843  13.809521  13.872571  12.816897
  8.265356  11.454219  10.318516   7.132719   8.160649  21.016727
 14.029979   8.31796    8.19051    8.314823   7.3420043  7.093789
  7.3417835  9.546775   7.162492   8.382498  13.891859  11.16498
  7.1407857 13.809521   8.160633   7.7058125 11.528143   7.2128763
  7.705814   8.311293  10.987355   9.049699   7.9127574 13.809521
  8.378666   8.468515   8.260898   8.40737    7.8657613  7.8657613
  7.8657613 15.931921  13.805754  16.134611  11.53855    8.358672
  7.8657603 13.805754   8.283398   8.260917   6.9624586 11.668596
  8.260899   6.965733   7.8657603  8.2609005 13.805754   7.8657603
  7.8657613 14.761797  14.181436   7.8657613 13.891859  14.154878
 11.636719  11.132911   8.25084   11.660137   9.500498  11.637081
 11.53855    8.586938   7.19732   15.016331   6.979413  11.243727
  8.143269   7.9711566  7.8657613  7.8657613 11.538548   6.9383826
  9.500498  13.936303  14.026859  11.245463  14.579566  14.346029
 14.346029   7.513952   8.54089   11.730822  12.134626  11.627582
  7.0467467 13.863932  11.485614  13.814305  13.863927  11.428996
 11.660137  11.484601  14.710491   8.250841   8.191962  11.349894
 11.827932   9.34799   11.827931  11.349894  13.732889   8.25084
  7.6478796 12.056386  13.732889   8.191965   7.1722083 10.130281
  7.2426434  8.25184    8.336431   8.191961  14.026859  11.337483
 14.48554    7.8299546 14.50138   11.337483   9.328861  13.727921
 13.863927   7.385634  15.169162   9.863525   8.613417  14.026859
  7.2219    14.154878   8.320891  11.484601   8.232069  16.021187
 13.814305  11.337483  10.301982  14.154878  11.764528  13.897332
 13.727921   9.260744  13.986659   8.379675  11.485614  13.863927
  9.389535  11.403889  11.403889  13.863927   8.126432  13.863927
 13.986659   8.291322  14.737253   7.3615065  8.291318  11.245463
 13.986659  11.730822  13.727918   8.232071  11.7892065  9.020938
  8.291318   7.0467467 13.863927  13.814305  13.814305  11.337483
  8.23207    8.301999   7.2964334  7.011551  13.814305   7.931196
 13.814305   7.931196  14.369138   8.291318  11.403889  11.403889
 11.403889  13.883795  10.846335  13.883795  13.883795  13.883795
 13.883795  13.883795  13.883795  13.883795   8.315447  11.41356
 15.070724  13.883793  13.883795  13.883795  13.883795  13.883795
 13.883795  13.883795  13.883795  13.883795   8.427012  13.883795
 13.883795   8.315449  13.883793  13.863927  13.437862  13.814305
 14.493845   8.439455  16.984003  16.984003   6.99837   14.493845
 13.814305  13.986661  13.986659  13.814305  13.986659  13.814305
 11.8237295 13.883795  11.245463  13.814305  11.403889  13.814305
 13.814305  13.986659  13.814305  13.986659  13.814305  13.814305
  8.291321  13.986659  13.814305  13.986659  13.814305  13.814305
 13.814305   7.0059576  8.320891   8.32089   13.883795  11.116172
 13.829362  13.814305  13.986659   7.1709476 13.883795  13.986659
  7.0704756 14.175935  13.814305  13.814305   8.5898     7.089836
  7.8650265 13.814305   8.31545   13.986659  13.986659   9.160264
 13.883795  13.986659   8.29132   13.883795  13.883795   8.315447
 13.814305  13.814305   9.8139105  7.8650265  8.264074   7.0898366
 14.258091   7.939742   7.9397464 13.4723    13.925694  13.883795
 11.557455   8.161585   7.089836   8.534962  13.925694  14.022235
 13.987299  13.987299  13.987299  13.987299  13.987298   8.610429
  8.21023   13.987298  13.987299  13.883795  13.883795  13.883795
  7.939742   7.108084   7.9397464 14.373794   7.939742   8.699957
  8.42701   13.883795   8.4270115 13.883795   7.939742  13.786722
 14.073266  14.073266  13.987299  13.786724   7.2356744 14.425108
 13.883795  13.883793  13.987299  14.022235  14.073266  14.073266
 14.022235  13.893704   8.610428  10.71203   14.0156     7.9149027
  8.355267  14.022235  11.549442  13.893704  14.066502  14.066502
  8.325022  14.017252   8.111204  14.022235  14.022235  14.022233
 14.132605  14.022233  14.022233  14.066502  14.022235  14.022233
 14.022235   8.373574  13.951933   7.490544   7.596701   8.373574
 11.759698  14.066502   7.596702  16.983564  14.197109  14.082609
 14.19711   11.552108  11.552108  14.066502 ]
2025-06-02 15:52:35,301 - DEBUG - Edge reconstruction errors: [  4.4707284   4.6492357  43.87425   ...  12.467287   12.648542
 535.24536  ]
2025-06-02 15:52:35,304 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155235_update_26.json
2025-06-02 15:52:35,304 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:52:35,307 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155235_update_26.pth and as latest_checkpoint.pth
2025-06-02 15:52:35,307 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869875.dot): 0.4387
2025-06-02 15:52:35,308 - WARNING - Detected 8 anomalous nodes (reconstruction-based):
2025-06-02 15:52:35,308 - WARNING -   Node ID: 192.168.27.13, Recon Error: 23.0583, MLP Score: 0.9504
2025-06-02 15:52:35,308 - WARNING -   Node ID: 192.168.27.12, Recon Error: 21.5281, MLP Score: 0.9481
2025-06-02 15:52:35,308 - WARNING -   Node ID: 192.168.27.10, Recon Error: 28.0337, MLP Score: 0.9520
2025-06-02 15:52:35,308 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 25.6717, MLP Score: 0.9681
2025-06-02 15:52:35,308 - WARNING -   Node ID: 192.168.209.130, Recon Error: 22.5986, MLP Score: 0.7585
2025-06-02 15:52:35,308 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 15:52:35,308 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2447, MLP Score: 0.0000
2025-06-02 15:52:35,308 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9493, MLP Score: 0.0000
2025-06-02 15:52:35,308 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0482, MLP Score: 0.0000
2025-06-02 15:52:35,308 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7473, MLP Score: 0.0000
2025-06-02 15:52:35,308 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7456, MLP Score: 0.0000
2025-06-02 15:52:35,313 - DEBUG - Embedding standard deviations before t-SNE: [1.2112296  0.08928066 1.3047657  1.1003971  2.081542   0.
 0.7907527  0.8386921  2.2134526  1.2490969  0.76611423 0.
 1.6882567  0.67008096 1.0694501  1.1867062  0.         0.49328586
 0.         0.08139347 3.210982   0.6650299  0.         1.2389024
 0.89827234 0.96491647 0.         0.92348516 2.149113   0.
 1.1827435  0.46535423]
2025-06-02 15:52:35,924 - INFO - Embeddings visualization saved to vis/embeddings_26_updates_20250602_155235.png
2025-06-02 15:52:35,924 - INFO - Performing visualization of node and edge features.
2025-06-02 15:52:35,925 - INFO - Starting visualization of node features.
2025-06-02 15:52:35,925 - INFO - Graph has 730 nodes and 30 features.
2025-06-02 15:52:35,925 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:52:35,926 - INFO - Calculating feature statistics:
2025-06-02 15:52:35,926 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:35,926 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:35,926 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 14, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.5024931), 'max': np.float32(2.2060432)}
2025-06-02 15:52:35,926 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 14, 'mean': np.float32(-4.1804903e-08), 'std': np.float32(0.99999994), 'min': np.float32(-2.137797), 'max': np.float32(2.5623133)}
2025-06-02 15:52:35,926 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:35,926 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:35,926 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:35,926 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(-5.225613e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.43019173), 'max': np.float32(2.3245447)}
2025-06-02 15:52:35,926 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(-4.7030515e-08), 'std': np.float32(1.0), 'min': np.float32(-1.1705256), 'max': np.float32(0.8543171)}
2025-06-02 15:52:35,926 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 3, 'mean': np.float32(1.0451226e-08), 'std': np.float32(1.0), 'min': np.float32(-9.39341), 'max': np.float32(0.10967602)}
2025-06-02 15:52:35,926 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 14, 'mean': np.float32(2.0902451e-08), 'std': np.float32(0.99999994), 'min': np.float32(-3.5601614), 'max': np.float32(1.563953)}
2025-06-02 15:52:35,927 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 14, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.5274093), 'max': np.float32(3.6428556)}
2025-06-02 15:52:35,927 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 8, 'mean': np.float32(2.30137), 'std': np.float32(1.0011629), 'min': np.float32(0.0), 'max': np.float32(11.0)}
2025-06-02 15:52:35,927 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.958904), 'std': np.float32(0.28373036), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:52:35,927 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.14657535), 'std': np.float32(0.37254483), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:52:35,927 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.3876715), 'std': np.float32(0.56530875), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:52:35,927 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 3, 'mean': np.float32(-1.0451226e-08), 'std': np.float32(1.0), 'min': np.float32(-0.10967602), 'max': np.float32(9.39341)}
2025-06-02 15:52:35,927 - INFO - - service_1: {'name': 'service_1', 'unique': 5, 'mean': np.float32(3.5342467), 'std': np.float32(3.091669), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 15:52:35,927 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.656164), 'std': np.float32(2.9327388), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:52:35,927 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.6), 'std': np.float32(1.5094225), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:52:35,927 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.14657535), 'std': np.float32(0.37254483), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:52:35,927 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 1, 'mean': np.float32(8.0), 'std': np.float32(0.0), 'min': np.float32(8.0), 'max': np.float32(8.0)}
2025-06-02 15:52:35,927 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(-7.838419e-09), 'std': np.float32(1.0), 'min': np.float32(-0.13171281), 'max': np.float32(15.049921)}
2025-06-02 15:52:35,927 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(2.874087e-08), 'std': np.float32(1.0), 'min': np.float32(-0.14484136), 'max': np.float32(6.904105)}
2025-06-02 15:52:35,927 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:35,928 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:35,928 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:35,928 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:35,928 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(3.6579287e-08), 'std': np.float32(0.9999999), 'min': np.float32(-1.0050753), 'max': np.float32(8.777658)}
2025-06-02 15:52:35,928 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(5.225613e-09), 'std': np.float32(1.0), 'min': np.float32(-1.108116), 'max': np.float32(4.419843)}
2025-06-02 15:52:35,939 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x72fda78927b0>
2025-06-02 15:52:36,066 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:52:36,116 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:52:36,141 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:52:37,454 - INFO - Node feature visualization saved to vis/node_features_20250602_155236.png
2025-06-02 15:52:37,454 - INFO - Finished visualization of node features.
2025-06-02 15:52:37,455 - INFO - Performing additional feature analysis:
2025-06-02 15:52:37,455 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:52:37,456 - INFO - Starting visualization of edge features.
2025-06-02 15:52:37,456 - INFO - Graph has 1559 edges and 10 edge features.
2025-06-02 15:52:37,456 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:52:37,456 - INFO - Calculating edge feature statistics:
2025-06-02 15:52:37,456 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:52:37,456 - INFO - - count: {'name': 'count', 'unique': 25, 'mean': np.float32(2.4468874e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.045147676), 'max': np.float32(30.35215)}
2025-06-02 15:52:37,456 - INFO - - dst_port: {'name': 'dst_port', 'unique': 16, 'mean': np.float32(465.0468), 'std': np.float32(513.37494), 'min': np.float32(3.0), 'max': np.float32(8898.0)}
2025-06-02 15:52:37,456 - INFO - - protocol: {'name': 'protocol', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:37,456 - INFO - - service: {'name': 'service', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:37,456 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 1049, 'mean': np.float32(2.4468874e-09), 'std': np.float32(1.0), 'min': np.float32(-0.0737332), 'max': np.float32(29.76732)}
2025-06-02 15:52:37,456 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 1107, 'mean': np.float32(-2.4468874e-09), 'std': np.float32(1.0), 'min': np.float32(-0.06559564), 'max': np.float32(30.237577)}
2025-06-02 15:52:37,457 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 347, 'mean': np.float32(-2.4468874e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.053769764), 'max': np.float32(30.348267)}
2025-06-02 15:52:37,457 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 1081, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.12731944), 'max': np.float32(19.250559)}
2025-06-02 15:52:37,457 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 1095, 'mean': np.float32(1.2234437e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.124131665), 'max': np.float32(20.257381)}
2025-06-02 15:52:37,457 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 404, 'mean': np.float32(-2.4468874e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.06376676), 'max': np.float32(29.849796)}
2025-06-02 15:52:37,467 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x72fda4162db0>
2025-06-02 15:52:37,549 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:52:37,559 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x72fda419df10>
2025-06-02 15:52:37,635 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:52:37,777 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:52:37,906 - DEBUG - Plotted boxplots of the first 8 non-constant edge features.
2025-06-02 15:52:37,924 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:52:37,930 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:52:39,352 - INFO - Edge feature visualization saved to vis/edge_features_20250602_155238.png
2025-06-02 15:52:39,352 - INFO - Finished visualization of edge features.
2025-06-02 15:52:39,352 - INFO - Performing additional edge feature analysis:
2025-06-02 15:52:39,352 - INFO - - 2 out of 10 edge features are constant.
2025-06-02 15:52:39,352 - INFO - - Highest correlation (1.00) between features: 'count' and 'total_orig_pkts'.
2025-06-02 15:52:39,354 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:52:39,354 - INFO - Graph has 1559 edges and 10 edge features.
2025-06-02 15:52:39,354 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:52:39,646 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_155239_summary.png
2025-06-02 15:52:39,880 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_155239_pca_3d.png
2025-06-02 15:52:40,059 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_155239_pca_variance.png
2025-06-02 15:52:40,059 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:52:40,059 - INFO - 
--- Processing file: nw_graph_encoded_1748869905.dot (Timestamp: 2025-06-02 15:11:45) ---
2025-06-02 15:52:40,059 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869905.dot
2025-06-02 15:52:40,059 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869905.dot'.
2025-06-02 15:52:40,059 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869905.dot
2025-06-02 15:52:40,073 - INFO - Parsed 736 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869905.dot'.
2025-06-02 15:52:40,087 - INFO - Parsed 1571 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869905.dot'.
2025-06-02 15:52:40,088 - INFO - Processing node updates/additions.
2025-06-02 15:52:40,092 - INFO - Processing edge updates/additions.
2025-06-02 15:52:40,101 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:52:40,102 - INFO - Finished updating NetworkX graph.
2025-06-02 15:52:40,102 - DEBUG - Updated graph - Nodes: 736, Edges: 1571
2025-06-02 15:52:40,102 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:52:40,103 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:52:40,110 - DEBUG - Initial node features tensor shape: torch.Size([736, 30])
2025-06-02 15:52:40,112 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:52:40,112 - DEBUG - Node features tensor shape after scaling: torch.Size([736, 30])
2025-06-02 15:52:40,113 - DEBUG - Edge index tensor shape: torch.Size([2, 1571])
2025-06-02 15:52:40,114 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:52:40,117 - DEBUG - Initial edge attributes tensor shape: torch.Size([1571, 10])
2025-06-02 15:52:40,122 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:52:40,122 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1571, 10])
2025-06-02 15:52:40,122 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:52:40,123 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:52:40,123 - INFO - Updated main graph to 736 nodes and 1571 edges.
2025-06-02 15:52:40,123 - INFO - Performing online update...
2025-06-02 15:52:40,123 - INFO - Starting online update for 50 steps.
2025-06-02 15:52:40,124 - DEBUG - Updated RunningStats: new_mean=0.9432704288415455, new_var=50400000000160.72, new_n=5070
2025-06-02 15:52:40,124 - DEBUG - Updated RunningStats: new_mean=0.9420603980224775, new_var=50700000000019.05, new_n=5100
2025-06-02 15:52:40,124 - DEBUG - Updated RunningStats: new_mean=44.267766053176636, new_var=16800000194550.33, new_n=1690
2025-06-02 15:52:40,124 - DEBUG - Updated RunningStats: new_mean=44.312413996199446, new_var=16900000235398.244, new_n=1700
2025-06-02 15:52:40,124 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:52:40,125 - DEBUG - Online update step: 1/50
2025-06-02 15:52:40,125 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,125 - DEBUG - Online update step: 2/50
2025-06-02 15:52:40,125 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,125 - DEBUG - Online update step: 3/50
2025-06-02 15:52:40,125 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,125 - DEBUG - Online update step: 4/50
2025-06-02 15:52:40,125 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,125 - DEBUG - Online update step: 5/50
2025-06-02 15:52:40,125 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,125 - DEBUG - Online update step: 6/50
2025-06-02 15:52:40,125 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,125 - DEBUG - Online update step: 7/50
2025-06-02 15:52:40,125 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,125 - DEBUG - Online update step: 8/50
2025-06-02 15:52:40,125 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,125 - DEBUG - Online update step: 9/50
2025-06-02 15:52:40,125 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,125 - DEBUG - Online update step: 10/50
2025-06-02 15:52:40,125 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,125 - DEBUG - Online update step: 11/50
2025-06-02 15:52:40,125 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,125 - DEBUG - Online update step: 12/50
2025-06-02 15:52:40,125 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,125 - DEBUG - Online update step: 13/50
2025-06-02 15:52:40,125 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,125 - DEBUG - Online update step: 14/50
2025-06-02 15:52:40,125 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,125 - DEBUG - Online update step: 15/50
2025-06-02 15:52:40,125 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,125 - DEBUG - Online update step: 16/50
2025-06-02 15:52:40,125 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,125 - DEBUG - Online update step: 17/50
2025-06-02 15:52:40,125 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,125 - DEBUG - Online update step: 18/50
2025-06-02 15:52:40,125 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,125 - DEBUG - Online update step: 19/50
2025-06-02 15:52:40,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,126 - DEBUG - Online update step: 20/50
2025-06-02 15:52:40,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,126 - DEBUG - Online update step: 21/50
2025-06-02 15:52:40,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,126 - DEBUG - Online update step: 22/50
2025-06-02 15:52:40,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,126 - DEBUG - Online update step: 23/50
2025-06-02 15:52:40,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,126 - DEBUG - Online update step: 24/50
2025-06-02 15:52:40,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,126 - DEBUG - Online update step: 25/50
2025-06-02 15:52:40,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,126 - DEBUG - Online update step: 26/50
2025-06-02 15:52:40,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,126 - DEBUG - Online update step: 27/50
2025-06-02 15:52:40,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,126 - DEBUG - Online update step: 28/50
2025-06-02 15:52:40,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,126 - DEBUG - Online update step: 29/50
2025-06-02 15:52:40,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,126 - DEBUG - Online update step: 30/50
2025-06-02 15:52:40,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,126 - DEBUG - Online update step: 31/50
2025-06-02 15:52:40,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,126 - DEBUG - Online update step: 32/50
2025-06-02 15:52:40,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,126 - DEBUG - Online update step: 33/50
2025-06-02 15:52:40,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,126 - DEBUG - Online update step: 34/50
2025-06-02 15:52:40,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,126 - DEBUG - Online update step: 35/50
2025-06-02 15:52:40,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,126 - DEBUG - Online update step: 36/50
2025-06-02 15:52:40,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,126 - DEBUG - Online update step: 37/50
2025-06-02 15:52:40,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,126 - DEBUG - Online update step: 38/50
2025-06-02 15:52:40,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,126 - DEBUG - Online update step: 39/50
2025-06-02 15:52:40,127 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,127 - DEBUG - Online update step: 40/50
2025-06-02 15:52:40,127 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,127 - DEBUG - Online update step: 41/50
2025-06-02 15:52:40,127 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,127 - DEBUG - Online update step: 42/50
2025-06-02 15:52:40,127 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,127 - DEBUG - Online update step: 43/50
2025-06-02 15:52:40,127 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,127 - DEBUG - Online update step: 44/50
2025-06-02 15:52:40,127 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,127 - DEBUG - Online update step: 45/50
2025-06-02 15:52:40,127 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,127 - DEBUG - Online update step: 46/50
2025-06-02 15:52:40,127 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,127 - DEBUG - Online update step: 47/50
2025-06-02 15:52:40,127 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,127 - DEBUG - Online update step: 48/50
2025-06-02 15:52:40,127 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,127 - DEBUG - Online update step: 49/50
2025-06-02 15:52:40,127 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,127 - DEBUG - Online update step: 50/50
2025-06-02 15:52:40,127 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,127 - WARNING - No successful steps during online update.
2025-06-02 15:52:40,128 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  4.7942866e-08 -1.6844790e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.1266424e-09
  2.9802322e-08 -9.0702716e-09  1.1661778e-08  2.5915063e-09
  2.2975543e+00  2.9592392e+00  1.4673913e-01  4.3885870e+00
  9.0702716e-09  3.5027175e+00  5.6752715e+00  7.5951085e+00
  1.4673913e-01  8.0000000e+00  2.4619309e-08 -8.4223952e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.4985334e-08 -6.4787656e-08], current edge mean: [-6.6775412e-09  4.6487842e+02  0.0000000e+00  0.0000000e+00
 -3.0352461e-09  1.2140984e-09 -2.4281968e-09 -3.0352461e-09
  2.4281968e-09  4.8563935e-09]
2025-06-02 15:52:40,128 - DEBUG - Node drift difference: 0.0102, Edge drift difference: 0.0003
2025-06-02 15:52:40,129 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  4.7942866e-08 -1.6844790e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.1266424e-09
  2.9802322e-08 -9.0702716e-09  1.1661778e-08  2.5915063e-09
  2.2975543e+00  2.9592392e+00  1.4673913e-01  4.3885870e+00
  9.0702716e-09  3.5027175e+00  5.6752715e+00  7.5951085e+00
  1.4673913e-01  8.0000000e+00  2.4619309e-08 -8.4223952e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.4985334e-08 -6.4787656e-08], edge=[-6.6775412e-09  4.6487842e+02  0.0000000e+00  0.0000000e+00
 -3.0352461e-09  1.2140984e-09 -2.4281968e-09 -3.0352461e-09
  2.4281968e-09  4.8563935e-09]
2025-06-02 15:52:40,129 - DEBUG - Updated reference std: node=[0.         0.         1.0006801  1.0006801  0.         0.
 0.         1.00068    1.00068    1.0006801  1.00068    1.0006801
 0.9868769  0.2827878  0.37280363 0.5652814  1.0006801  3.0891504
 2.9303455  1.5187457  0.37280363 0.         1.0006801  1.0006801
 0.         0.         0.         0.         1.0006801  1.0006801 ], edge=[  1.0003184 511.57693     0.          0.          1.0003184   1.0003184
   1.0003184   1.0003184   1.0003184   1.0003184]
2025-06-02 15:52:40,129 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:52:40,129 - INFO - Running anomaly detection...
2025-06-02 15:52:40,129 - INFO - Starting anomaly detection.
2025-06-02 15:52:40,140 - DEBUG - Node reconstruction errors: [16.537207  13.831502  23.162992  15.812249  10.30348    8.340005
 21.631153  12.268718  12.268718  12.716034  12.268718  10.785853
 28.175776   8.779699  14.9000025 16.03279   11.210491  16.042898
 17.560007  15.67322   11.894315  14.900004  12.730137  10.415392
 14.919617  12.492566  14.919617   9.740878  11.900466  14.919617
 10.885267   9.207518   9.468279  15.555467  12.607172  15.783964
  7.9789114 15.67322   11.147893  11.423818  15.471174  14.580581
 15.67322   16.299538  15.824571  12.290654  17.720158   8.6260805
 11.597489  16.172285  25.775757  12.260749  12.19286   16.938414
 11.462093  10.688721  22.90825   15.125454  16.389675  17.437073
  7.4849696 15.49018   14.320182  10.628522  14.249341  11.462131
 11.728418  11.462007  14.320182  14.320182  11.734991   8.308602
 11.7193     7.657539   7.4452558  8.43249   15.569097   8.244007
  7.52898    7.5050917 14.70762    8.4499855  7.5051093 10.323475
 10.738937  10.682468   9.100575   7.527732   7.347958   8.943409
 14.283774   8.71034    9.493245   7.392107  11.408784  26.521496
 14.406282   7.598939  14.089068  11.379174   8.191957  14.406282
 15.0138645  9.003528   9.397307  11.091598  15.572056   7.844618
  9.636914  13.861268  14.735026  14.863827  10.22969    9.934417
  8.313043   8.632936   8.220363   8.535815   7.29093   11.651775
 14.276933  10.00533    9.78887    9.733348   7.169366  11.65174
  9.376203   7.416108   8.646275  14.876171  11.801074  11.43271
 14.892164   9.364986   8.306955  11.223749  15.1885    13.978041
  7.4705763  9.064243  12.08159    8.881186  14.424434  11.602305
 11.890295   8.176554   8.220362  11.363865  11.366901   7.2742863
 13.140389   9.427997   7.3893757 11.43271    8.660342   8.656399
 11.37355    8.863892   8.191958  14.852472  11.890294   7.6909633
 11.37355   11.801074   8.239483   8.516802   8.15232    7.36023
  7.901605   7.385124   7.397713  11.820779  14.05951   21.09888
  7.660783  12.097196   7.3396144  8.381533   8.183133   8.18313
 11.066775   9.11616   14.345621   9.305161   8.447554   7.295404
 14.37647    8.25333   11.195597  11.354609   7.615591   7.3165755
 12.083227  11.267468   7.4705744 11.78514    6.982906  14.776235
  8.508539  14.89911   14.567277  11.37355    9.812024   7.3532476
  8.2382765  7.9794264 11.54595    8.73473   14.217082   7.34551
  8.263801   8.151221  11.577015   7.579741   7.1900697 14.454358
  8.685169   8.220363   8.160443  11.267467   9.535356  14.376469
 13.950254  11.577015  11.37355    7.0861692  8.410464  11.235216
  7.28266   10.103918   9.927484   7.1477633  7.579888   8.220363
  8.220363  11.785141   7.3675256 13.950253  11.37355   15.147845
  8.5163     7.520562  11.279972   7.2742867 11.150397   7.2047014
  8.447928   8.1366415 11.279972  11.562041  14.05951   13.91058
  8.160448   7.479783   8.632933   8.204949  11.354608  14.326516
 14.547198   8.183132   7.3015904  8.621257  15.051078  11.513775
  7.352951  11.384268   7.1107855 10.179594   7.110788   8.67306
  9.839331   9.478549   7.3413863 14.87259    8.123257   8.183129
 14.138666   7.5595264 11.066775   7.427787   8.35276   13.976876
  7.234515  14.676091   8.891494  14.356034   8.684865   7.3926787
  9.11616   10.058219  11.679063  14.6391115 11.581142  11.150397
  9.211416  14.688274   7.4062414  8.183407  11.785141  15.345036
  7.252595  13.81016    8.15903    8.159032  13.81016   13.81016
 13.81016    8.09502   13.955328  13.810157  13.81016    8.329128
 13.81016   11.388324   7.8119526  7.2184606  8.59398    9.29364
 11.532978  11.925385   7.06491   11.881962   7.100467   8.159034
 11.314303   9.400909  13.997198   8.095019   7.279491   7.2794924
  7.430016  11.831603  13.810157   8.123257  13.81016    8.095016
 11.954846  13.807728  13.997198  13.997198  13.810157  14.226322
 13.997198   7.1639066  7.114789   7.1107874  8.159034  14.4562645
  7.1046185  7.249423  13.810157   8.677955   9.682499   8.391807
 14.350361  11.354609  14.306139  13.81016   13.87533   12.799485
  8.263798  11.438329  10.338485   7.141945   8.15904   21.106876
 14.026224   8.338424   8.189599   8.317185   7.3526793  7.103613
  7.3524675  9.754761   7.177012   8.374601  13.892119  11.162921
  7.1442413 13.810157   8.15903    7.6758504 11.511907   7.2221036
  7.6758504  8.303982  10.984654   9.03055    7.9198985 13.810157
  8.372409   8.464661   8.258698   8.403038   7.871485   7.871485
  7.871485  15.951745  13.80126   16.155827  11.5044985  8.348244
  7.8714843 13.80126    8.278522   8.258718   6.9769235 11.637221
  8.258699   6.9580445  7.871485   8.258699  13.80126    7.871485
  7.8714843 14.753229  14.179377   7.871485  13.892116  14.144823
 11.604046  11.125126   8.251137  11.640841   9.49385   11.604403
 11.5044985  8.567716   7.1949487 15.008854   6.989302  11.210925
  8.1393585  7.9730744  7.871485   7.871485  11.5044985  6.949834
  9.493849  13.925175  14.015461  11.232662  10.290345  14.341586
 14.341583   7.486364   7.372588  11.837956  12.12089   11.6064005
  7.054011  13.859219  11.473157  13.810177  13.859219  11.414308
 11.640841  11.462747  14.7055025  8.251136   8.193621  11.338485
 11.8107605  9.3537    11.810762  11.338485  13.732352   8.251138
  7.619385  12.040946  13.732352   8.193622   7.181599  10.126216
  7.2435246  8.252101   8.331227   8.19362   14.015462  11.319929
 14.480915   7.8303995 14.497847  12.199559   9.326791  13.72206
 13.859219   7.37148   15.174694   9.867414   8.601239  14.015462
  7.225763  14.144826   8.307965  11.462743   8.229245  16.044086
 13.810178  11.319929  10.290345  14.144826  11.759138  13.891983
 13.72206    9.25272   13.973019   8.401941  11.473157  13.859219
  9.526333  11.379767  11.379767  14.4267025  8.1181965 13.859218
 13.973019   8.286854  14.73038    7.364807   8.286854  11.232662
 13.973019  11.717107  13.72206    8.229248  11.767996   9.013839
  8.286853   7.054011  13.859218  13.810178  13.810178  11.319929
  8.229247   8.3001995  7.301673   7.01573   13.810178   7.9313507
 13.810177   7.9313507 14.363643   8.286854  11.379767  11.379767
 11.379767  13.868261  10.866748  13.868261  13.868261  13.868261
 13.868261  13.868261  13.868261  13.868261   8.30745   11.398886
 15.071173  13.868261  13.868261  13.868261  13.868261  13.868261
 13.868261  13.868261  13.868261  13.868261   8.40848   13.868261
 13.868261   8.307449  13.868261  13.859219  13.446538  13.810178
 14.527768   8.426418  17.022     17.022      7.0049577 14.527768
 13.810177  13.973019  13.973019  13.810177  13.973019  13.810178
 11.810628  13.868261  11.232659  13.810176  11.379769  13.810177
 13.810177  13.973019  13.810178  13.973019  13.810177  13.810178
  8.286851  13.973019  13.810178  13.973019  13.810178  13.810178
 13.810177   7.010439   8.307967   8.307966  13.868261  11.0932255
 13.845488  13.810178  13.973019   7.167626  13.868261  13.973019
  7.069858  14.156128  13.810178  13.810178   8.572672   7.088908
  7.864477  13.810178   8.307449  13.973019  13.973019   9.14658
 13.868261  13.973019   8.286855  13.868261  13.868261   8.307449
 13.810177  13.810178   9.828921   7.864477   8.24355    7.0889106
 14.404749   7.9294586  7.9294558 13.493455  13.91332   13.868261
 11.5348835  8.142379   7.08891    8.517733  13.913317  14.001471
 13.966432  13.966432  13.966432  13.966432  13.966432   8.587483
  8.190558  13.966432  13.966432  13.868261  13.868261  13.868261
  7.9294558  7.104427   7.9294558 14.361256   7.9294558  8.675396
  8.408478  13.868261   8.408476  13.868261   7.9294558 13.77326
 14.051387  14.051387  13.966432  13.77326    7.221359  14.429547
 13.868261  13.868261  13.966432  14.001471  14.051387  14.051387
 14.001471  13.870755   8.587483  10.72536   14.004781   7.925796
  8.3318815 14.001471  11.529832  13.870755  14.05435   14.05435
  8.292781  14.006064   8.091924  14.001471  14.001471  14.001471
 14.124661  14.001471  14.001471  14.05435   14.001471  14.001471
 14.001471   8.343968  13.939167   7.4617405  7.5584574  8.343968
 11.742168  14.05435    7.5584574 16.947577  14.182623  14.053044
 14.182627  11.518881  11.518881  14.054346   7.1438923 10.493939
 14.182627  14.116884  15.066081  14.933302 ]
2025-06-02 15:52:40,140 - DEBUG - Edge reconstruction errors: [  4.463293    4.6384716  43.879738  ...  12.466486   12.648697
 535.2455   ]
2025-06-02 15:52:40,142 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155240_update_27.json
2025-06-02 15:52:40,143 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:52:40,146 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155240_update_27.pth and as latest_checkpoint.pth
2025-06-02 15:52:40,146 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869905.dot): 0.4387
2025-06-02 15:52:40,146 - WARNING - Detected 8 anomalous nodes (reconstruction-based):
2025-06-02 15:52:40,146 - WARNING -   Node ID: 192.168.27.13, Recon Error: 23.1630, MLP Score: 0.9504
2025-06-02 15:52:40,146 - WARNING -   Node ID: 192.168.27.12, Recon Error: 21.6312, MLP Score: 0.9481
2025-06-02 15:52:40,146 - WARNING -   Node ID: 192.168.27.10, Recon Error: 28.1758, MLP Score: 0.9517
2025-06-02 15:52:40,146 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 25.7758, MLP Score: 0.9687
2025-06-02 15:52:40,146 - WARNING -   Node ID: 192.168.209.130, Recon Error: 22.9083, MLP Score: 0.7716
2025-06-02 15:52:40,146 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 15:52:40,147 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2449, MLP Score: 0.0000
2025-06-02 15:52:40,147 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9493, MLP Score: 0.0000
2025-06-02 15:52:40,147 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0483, MLP Score: 0.0000
2025-06-02 15:52:40,147 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7474, MLP Score: 0.0000
2025-06-02 15:52:40,147 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7457, MLP Score: 0.0000
2025-06-02 15:52:40,147 - INFO - 
--- Processing file: nw_graph_encoded_1748869935.dot (Timestamp: 2025-06-02 15:12:15) ---
2025-06-02 15:52:40,147 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869935.dot
2025-06-02 15:52:40,147 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869935.dot'.
2025-06-02 15:52:40,147 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869935.dot
2025-06-02 15:52:40,168 - INFO - Parsed 762 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869935.dot'.
2025-06-02 15:52:40,187 - INFO - Parsed 1619 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869935.dot'.
2025-06-02 15:52:40,187 - INFO - Processing node updates/additions.
2025-06-02 15:52:40,192 - INFO - Processing edge updates/additions.
2025-06-02 15:52:40,201 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:52:40,202 - INFO - Finished updating NetworkX graph.
2025-06-02 15:52:40,202 - DEBUG - Updated graph - Nodes: 762, Edges: 1619
2025-06-02 15:52:40,202 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:52:40,203 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:52:40,211 - DEBUG - Initial node features tensor shape: torch.Size([762, 30])
2025-06-02 15:52:40,212 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:52:40,212 - DEBUG - Node features tensor shape after scaling: torch.Size([762, 30])
2025-06-02 15:52:40,213 - DEBUG - Edge index tensor shape: torch.Size([2, 1619])
2025-06-02 15:52:40,214 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:52:40,217 - DEBUG - Initial edge attributes tensor shape: torch.Size([1619, 10])
2025-06-02 15:52:40,218 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:52:40,219 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1619, 10])
2025-06-02 15:52:40,219 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:52:40,219 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:52:40,219 - INFO - Updated main graph to 762 nodes and 1619 edges.
2025-06-02 15:52:40,220 - INFO - Performing online update...
2025-06-02 15:52:40,220 - INFO - Starting online update for 50 steps.
2025-06-02 15:52:40,220 - DEBUG - Updated RunningStats: new_mean=0.9433114659046152, new_var=51000000000160.77, new_n=5130
2025-06-02 15:52:40,220 - DEBUG - Updated RunningStats: new_mean=0.9421014807509638, new_var=51300000000018.93, new_n=5160
2025-06-02 15:52:40,220 - DEBUG - Updated RunningStats: new_mean=44.3246253495542, new_var=17000000193814.387, new_n=1710
2025-06-02 15:52:40,221 - DEBUG - Updated RunningStats: new_mean=44.36403890171073, new_var=17100000228399.645, new_n=1720
2025-06-02 15:52:40,221 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:52:40,221 - DEBUG - Online update step: 1/50
2025-06-02 15:52:40,221 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,221 - DEBUG - Online update step: 2/50
2025-06-02 15:52:40,221 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,221 - DEBUG - Online update step: 3/50
2025-06-02 15:52:40,221 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,221 - DEBUG - Online update step: 4/50
2025-06-02 15:52:40,221 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,221 - DEBUG - Online update step: 5/50
2025-06-02 15:52:40,221 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,221 - DEBUG - Online update step: 6/50
2025-06-02 15:52:40,221 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,221 - DEBUG - Online update step: 7/50
2025-06-02 15:52:40,221 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,221 - DEBUG - Online update step: 8/50
2025-06-02 15:52:40,221 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,221 - DEBUG - Online update step: 9/50
2025-06-02 15:52:40,221 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,221 - DEBUG - Online update step: 10/50
2025-06-02 15:52:40,221 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,221 - DEBUG - Online update step: 11/50
2025-06-02 15:52:40,221 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,221 - DEBUG - Online update step: 12/50
2025-06-02 15:52:40,221 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,221 - DEBUG - Online update step: 13/50
2025-06-02 15:52:40,221 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,221 - DEBUG - Online update step: 14/50
2025-06-02 15:52:40,221 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,221 - DEBUG - Online update step: 15/50
2025-06-02 15:52:40,221 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,221 - DEBUG - Online update step: 16/50
2025-06-02 15:52:40,222 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,222 - DEBUG - Online update step: 17/50
2025-06-02 15:52:40,222 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,222 - DEBUG - Online update step: 18/50
2025-06-02 15:52:40,222 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,222 - DEBUG - Online update step: 19/50
2025-06-02 15:52:40,222 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,222 - DEBUG - Online update step: 20/50
2025-06-02 15:52:40,222 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,222 - DEBUG - Online update step: 21/50
2025-06-02 15:52:40,222 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,222 - DEBUG - Online update step: 22/50
2025-06-02 15:52:40,222 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,222 - DEBUG - Online update step: 23/50
2025-06-02 15:52:40,222 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,222 - DEBUG - Online update step: 24/50
2025-06-02 15:52:40,222 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,222 - DEBUG - Online update step: 25/50
2025-06-02 15:52:40,222 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,222 - DEBUG - Online update step: 26/50
2025-06-02 15:52:40,222 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,222 - DEBUG - Online update step: 27/50
2025-06-02 15:52:40,222 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,222 - DEBUG - Online update step: 28/50
2025-06-02 15:52:40,222 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,222 - DEBUG - Online update step: 29/50
2025-06-02 15:52:40,222 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,222 - DEBUG - Online update step: 30/50
2025-06-02 15:52:40,222 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,222 - DEBUG - Online update step: 31/50
2025-06-02 15:52:40,222 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,222 - DEBUG - Online update step: 32/50
2025-06-02 15:52:40,222 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,222 - DEBUG - Online update step: 33/50
2025-06-02 15:52:40,222 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,222 - DEBUG - Online update step: 34/50
2025-06-02 15:52:40,222 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,222 - DEBUG - Online update step: 35/50
2025-06-02 15:52:40,222 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,222 - DEBUG - Online update step: 36/50
2025-06-02 15:52:40,223 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,223 - DEBUG - Online update step: 37/50
2025-06-02 15:52:40,223 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,223 - DEBUG - Online update step: 38/50
2025-06-02 15:52:40,223 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,223 - DEBUG - Online update step: 39/50
2025-06-02 15:52:40,223 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,223 - DEBUG - Online update step: 40/50
2025-06-02 15:52:40,223 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,223 - DEBUG - Online update step: 41/50
2025-06-02 15:52:40,223 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,223 - DEBUG - Online update step: 42/50
2025-06-02 15:52:40,223 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,223 - DEBUG - Online update step: 43/50
2025-06-02 15:52:40,223 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,223 - DEBUG - Online update step: 44/50
2025-06-02 15:52:40,223 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,223 - DEBUG - Online update step: 45/50
2025-06-02 15:52:40,223 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,223 - DEBUG - Online update step: 46/50
2025-06-02 15:52:40,223 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,223 - DEBUG - Online update step: 47/50
2025-06-02 15:52:40,223 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,223 - DEBUG - Online update step: 48/50
2025-06-02 15:52:40,223 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,223 - DEBUG - Online update step: 49/50
2025-06-02 15:52:40,223 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,223 - DEBUG - Online update step: 50/50
2025-06-02 15:52:40,223 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,223 - WARNING - No successful steps during online update.
2025-06-02 15:52:40,224 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -3.1288529e-08 -4.8810104e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  3.5043151e-08
 -2.2527740e-08  3.7546233e-09 -8.1350171e-09 -2.0024657e-08
  2.2979002e+00  2.9606299e+00  1.4041995e-01  4.3923883e+00
 -3.7546233e-09  3.4475067e+00  5.7073493e+00  7.5931759e+00
  1.4041995e-01  8.0000000e+00 -6.8834760e-09  7.5092466e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.2515411e-08  3.0036986e-08], current edge mean: [ 3.5343088e-09  4.6400555e+02  0.0000000e+00  0.0000000e+00
 -1.7671544e-09  5.8905147e-09 -3.5343088e-09  0.0000000e+00
 -2.3562059e-09 -2.3562059e-09]
2025-06-02 15:52:40,224 - DEBUG - Node drift difference: 0.0179, Edge drift difference: 0.0017
2025-06-02 15:52:40,225 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -3.1288529e-08 -4.8810104e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  3.5043151e-08
 -2.2527740e-08  3.7546233e-09 -8.1350171e-09 -2.0024657e-08
  2.2979002e+00  2.9606299e+00  1.4041995e-01  4.3923883e+00
 -3.7546233e-09  3.4475067e+00  5.7073493e+00  7.5931759e+00
  1.4041995e-01  8.0000000e+00 -6.8834760e-09  7.5092466e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.2515411e-08  3.0036986e-08], edge=[ 3.5343088e-09  4.6400555e+02  0.0000000e+00  0.0000000e+00
 -1.7671544e-09  5.8905147e-09 -3.5343088e-09  0.0000000e+00
 -2.3562059e-09 -2.3562059e-09]
2025-06-02 15:52:40,225 - DEBUG - Updated reference std: node=[0.         0.         1.0006568  1.0006568  0.         0.
 0.         1.0006568  1.0006567  1.0006567  1.0006568  1.0006568
 0.97361827 0.27801365 0.36245453 0.5658664  1.0006567  3.0614383
 2.9225075  1.5215856  0.36245453 0.         1.0006568  1.0006568
 0.         0.         0.         0.         1.0006568  1.0006568 ], edge=[  1.000309  504.0354      0.          0.          1.0003089   1.000309
   1.000309    1.000309    1.000309    1.000309 ]
2025-06-02 15:52:40,225 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:52:40,225 - INFO - Running anomaly detection...
2025-06-02 15:52:40,225 - INFO - Starting anomaly detection.
2025-06-02 15:52:40,232 - DEBUG - Node reconstruction errors: [16.471006  13.939302  23.727848  15.782428  10.189442   8.278761
 22.882854  12.172632  12.172632  12.617125  12.172632  10.701908
 28.954033   8.754904  14.837253  15.933559  11.115682  15.943404
 17.549381  15.616086  11.858692  14.837253  12.759607  10.320561
 14.864645  12.507034  14.864645   9.702645  11.847297  14.864644
 10.920334   9.145522   9.477926  15.488705  12.559479  15.639016
  7.9204    15.616086  11.061561  12.07483   15.429812  14.549743
 15.616086  16.176065   9.229717  12.226876  17.658335   8.501608
 11.576987  16.146803  26.13016   12.235541  12.239541  16.999353
 11.468004  10.595938  23.251137  15.1242695 16.59647   17.415255
  7.5033903 15.36762   14.311316  10.469311  14.322482  11.468014
 11.732741  11.467977  14.311316  14.311316  11.678888   8.305005
 11.76818    7.638792   7.4322815  8.421056  15.514822   8.252534
  7.507147   7.4966407 14.71312    8.4493265  7.4397388 10.281188
 10.743982  10.525159   9.045954   7.5252404  7.3438535  8.906238
 14.286252   8.730547   9.515429   7.4081745 11.423139  26.931997
 14.495774   7.5767465 14.091345  11.374359   8.1959715 14.495774
 15.010741   9.005704   9.897923  11.169781  10.650055   7.72236
  9.624101  13.830978  14.635119  14.85888   10.183868   9.931711
  8.3140955  8.589164   8.226556   8.568712   7.320009  11.625455
 14.270619   9.932831   9.805293   9.677242   7.1782594 11.625502
  9.3988695  7.4287477  7.7683473 14.818928  11.811263  11.448152
 14.909821   9.372823   8.300976  11.227951  15.147489  13.989676
  7.937433   9.099979  11.989688   8.851114  14.398902  11.589342
 11.827673   8.190793   8.226557  11.386624  11.379154   7.3034015
 13.17484    9.328181   7.421164  11.448152   8.695306   8.657211
 11.446547   8.818329   8.19597   14.863786  11.827673   7.6475263
 11.446547  11.811264   8.233455   8.549607   8.170294   7.3447213
  7.9833064  7.38183    7.3936353 11.766763  14.074342  21.509363
  7.610919  12.238693   7.3612723  8.36534    8.176635   8.176633
 11.132775   9.163237  14.370492   9.356001   8.48668    7.602302
 14.346939   8.260609  11.190892  11.416503   7.6655684  7.3276653
 12.098158  11.35835    7.937431  11.842436   6.9563966 14.725256
  8.54963   14.842677  14.515199  11.446547   9.804966   7.350403
  8.25031    7.9045806 11.558204   8.799476  14.205519   7.377916
  8.242543   8.162025  11.662202   7.58207    7.158517  14.491352
  8.637942   8.226556   8.150688  11.35835    9.555126  14.346939
 13.966116  11.662201  11.446547   7.3432264  8.432394  11.328591
  7.282723  10.047466   9.920434   7.1563587  7.632469   8.226557
  8.226559  11.842434   7.3628755 13.966116  11.446547  15.217759
  8.531964   7.5302    11.303206   7.3034015 11.245197   7.481848
  8.442259   8.154369  11.3032055 12.287725  14.074342  14.006892
  8.150688   7.4624424  8.589162   8.216717  11.416501  14.285743
 14.568878   8.176634   7.3128448  8.645596  15.155698  11.496472
  7.495387  11.387297   7.148665  10.316306   7.148667   8.631637
  9.881271   9.521951   7.3631606 14.782785   8.13596    8.176633
 14.139993   7.5585036 11.132775   7.4561396  8.402461  14.000967
  7.243033  14.683385   8.846044  14.367602   8.759534   7.4280562
  9.163238   9.967649  12.119956  14.684392  11.594817  11.245197
  5.583425  14.621657   7.4051385  8.176824  11.842434  15.411269
  7.2207923 13.816445   8.154395   8.154397  13.816445  13.816445
 13.816445   8.103081  13.9442625 13.816446  13.816446   8.3953085
 13.816446  11.431883   7.6913724  7.232332   8.574641   9.316838
 11.614263  11.962161   7.100781  11.822209   7.1044416  8.154397
  7.470285   9.446591  13.997325   8.103079   7.3128753  7.312875
  7.4702206 11.86371   13.816446   8.135959  13.816445   8.103082
 11.8662615 13.901816  13.997325  13.997325  13.816445  14.327746
 13.997326   7.161332   7.129151   7.481305   8.154392  14.456542
  7.1345468  7.2439675 13.816445   8.63297    9.682688   8.374527
 14.436842  11.416501  14.264758  13.816445  13.88727   12.761189
  8.242543  11.409454  10.369333   7.1463346  8.154403  21.439419
 14.021998   8.421945   8.18633    8.324908   7.357454   7.109507
  7.357261   9.756278   7.2047253  8.347854  13.901927  11.178522
  7.1274114 13.816445   8.154399   7.5931683 11.486945   7.22891
  7.7561727  7.220443  11.003254   8.960614   7.9495087 13.816445
  8.365239   8.416223   8.235412   8.347859   7.897748   7.897748
  7.897748  16.16141   13.792697  16.256374  11.49733    8.324309
  7.897748  13.792698   8.263261   8.235423   7.0086856 11.578851
  8.235412   6.9581656  7.897748   8.235412  13.792697   7.897748
  7.897748  14.72227   14.271371   7.897748  13.90193   14.114227
 11.533626  11.92504    8.252127  11.559943   9.520525  11.533738
 11.49733    8.507664   7.2400923 15.088611   7.0111423 11.20799
  8.127018   7.98453    7.897748   7.897748  11.49733    6.9629335
  9.520524  13.891016  13.978809  11.213436  10.251721  14.293067
 14.412279   7.409507   7.312408  11.807996  12.068804  11.555231
  7.255795  13.8505    11.411748  13.797797  13.8505    11.382828
 11.559943  11.428441  14.70675    8.25213    8.203599  11.328024
 11.7364235  9.3822155 11.7364235 11.328024  13.815321   8.25213
  7.5451603 11.982344  13.815321   8.203601   7.1765056 10.216055
  7.227117   8.252896   8.615219   8.203598  13.978809  11.298884
 14.473689   7.84135   14.426759  11.807995   9.586267  14.612775
 13.8505     7.862632  15.195866   9.886859   8.570733  13.978809
  7.3988757 14.11423    8.278492  11.428441   8.21674   16.15112
 13.7978    11.298885  10.251721  14.114227  10.251721  13.896647
 13.789957   9.242663  13.933986   8.472465  11.411748  13.850498
  9.45259   11.31445   11.31445   14.41228    8.089755  14.41228
 13.933986   8.2740345 14.735522   7.348424   8.274031  11.213436
 13.933986  11.699415  13.789957   8.216741  11.727309   9.001257
  8.274031   7.0290637 14.480724  13.7978    13.7978    11.298884
  8.21674    8.253655   7.2893806  7.011443  13.7978     7.9027324
 13.7978     7.9027324 14.431223   8.274033  11.76601   11.31445
 11.860407  13.819656  10.959399  13.819656  13.819656  13.819656
 13.819657  13.819656  13.819656  13.819656   8.279704  11.803155
 15.099731  13.819656  13.819656  13.819656  13.819656  13.819657
 13.819656  13.819656  13.819656  13.819656   8.3501835 13.819656
 13.819656   8.279705  13.819656   9.452589  13.414475  13.7978
 14.527447   8.340284  16.964066  16.964066   7.008745  14.527447
 13.7978    13.933986  13.933986  13.7978    13.933986  14.576859
 11.785338  13.819656  11.213436  13.7978    11.31445   13.7978
 13.7978    14.385095  13.7978    13.933986  13.7978    13.7978
  8.274031  13.933986  13.7978    13.933986  13.7978    13.7978
 13.797797   7.0095778  8.278492   8.278494  13.819656  11.03218
 13.83395   13.7978    13.933986   7.137773  13.819656  13.933986
  7.0515723 14.095016  13.7978    13.7978     8.757427   7.072465
  7.868575  13.7978     8.279705  14.385093  13.933986   9.098417
 13.819657  13.933986   8.27403   13.819657  13.819657   8.279704
 14.385095  13.7978     9.858111   7.868575   8.179188   7.072465
 14.47631    7.9070506  7.9070506 13.47315   13.873199  13.819656
 11.469652   8.080629   7.0724664  8.421002  13.873199  13.941884
 13.898808  13.898808  13.898808  13.898808  13.898808   8.50802
  8.12873   13.898808  13.898808  13.819656  14.319592  13.819656
  7.9070506  7.075871   7.9070506 14.333642   7.9070506  7.614806
  8.3501835 13.819656   8.3501835 13.819657   7.9070506 13.81333
 13.982969  13.982971  13.898808  13.813327   7.1369205 14.382919
 13.819656  13.819657  13.898808  13.941884  13.982969  14.259359
 13.941884  13.881453   8.50802    9.914315  14.214948   8.01312
  8.225932  13.941884  11.517452  13.881453  14.037044  14.037044
  8.186597  13.986926   8.022577  13.941884  13.941884  13.941884
 14.106977  13.941884  13.941884  14.037043  13.941884  13.941884
 13.941884   8.514212  13.982629   7.322218   7.3921328  8.216471
 11.692353  14.037044   7.3921328 16.960451  14.082993  14.024183
 14.082993  11.420779  11.420779  14.037044   7.0011444 10.446546
 14.082993  14.013582  15.037722   8.049473  14.155675  14.155674
 14.155674  14.137558  14.199915   9.594265  11.928809  10.446547
 14.485213  14.208216  11.831452  14.013582  11.793864  12.128009
 14.082993  12.128009  14.082993  10.446546  14.013582   8.399046
 14.208215  14.386876  14.155674  14.137556  14.082991  11.749068 ]
2025-06-02 15:52:40,232 - DEBUG - Edge reconstruction errors: [  4.469886    4.649838   43.871742  ...  12.465825   12.6489315
 535.24817  ]
2025-06-02 15:52:40,233 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155240_update_28.json
2025-06-02 15:52:40,234 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:52:40,236 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155240_update_28.pth and as latest_checkpoint.pth
2025-06-02 15:52:40,237 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869935.dot): 0.4381
2025-06-02 15:52:40,237 - WARNING - Detected 8 anomalous nodes (reconstruction-based):
2025-06-02 15:52:40,237 - WARNING -   Node ID: 192.168.27.13, Recon Error: 23.7278, MLP Score: 0.9524
2025-06-02 15:52:40,237 - WARNING -   Node ID: 192.168.27.12, Recon Error: 22.8829, MLP Score: 0.9523
2025-06-02 15:52:40,237 - WARNING -   Node ID: 192.168.27.10, Recon Error: 28.9540, MLP Score: 0.9533
2025-06-02 15:52:40,237 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 26.1302, MLP Score: 0.9702
2025-06-02 15:52:40,237 - WARNING -   Node ID: 192.168.209.130, Recon Error: 23.2511, MLP Score: 0.7682
2025-06-02 15:52:40,237 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 15:52:40,237 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2476, MLP Score: 0.0000
2025-06-02 15:52:40,237 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9515, MLP Score: 0.0000
2025-06-02 15:52:40,237 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0506, MLP Score: 0.0000
2025-06-02 15:52:40,237 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7497, MLP Score: 0.0000
2025-06-02 15:52:40,237 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7484, MLP Score: 0.0000
2025-06-02 15:52:40,237 - INFO - 
--- Processing file: nw_graph_encoded_1748869965.dot (Timestamp: 2025-06-02 15:12:45) ---
2025-06-02 15:52:40,237 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869965.dot
2025-06-02 15:52:40,237 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869965.dot'.
2025-06-02 15:52:40,237 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869965.dot
2025-06-02 15:52:40,257 - INFO - Parsed 768 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869965.dot'.
2025-06-02 15:52:40,277 - INFO - Parsed 1644 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869965.dot'.
2025-06-02 15:52:40,277 - INFO - Processing node updates/additions.
2025-06-02 15:52:40,281 - INFO - Processing edge updates/additions.
2025-06-02 15:52:40,290 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:52:40,291 - INFO - Finished updating NetworkX graph.
2025-06-02 15:52:40,292 - DEBUG - Updated graph - Nodes: 768, Edges: 1644
2025-06-02 15:52:40,292 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:52:40,292 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:52:40,300 - DEBUG - Initial node features tensor shape: torch.Size([768, 30])
2025-06-02 15:52:40,302 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:52:40,302 - DEBUG - Node features tensor shape after scaling: torch.Size([768, 30])
2025-06-02 15:52:40,303 - DEBUG - Edge index tensor shape: torch.Size([2, 1644])
2025-06-02 15:52:40,304 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:52:40,309 - DEBUG - Initial edge attributes tensor shape: torch.Size([1644, 10])
2025-06-02 15:52:40,311 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:52:40,311 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1644, 10])
2025-06-02 15:52:40,311 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:52:40,311 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:52:40,312 - INFO - Updated main graph to 768 nodes and 1644 edges.
2025-06-02 15:52:40,312 - INFO - Performing online update...
2025-06-02 15:52:40,312 - INFO - Starting online update for 50 steps.
2025-06-02 15:52:40,312 - DEBUG - Updated RunningStats: new_mean=0.9433368245359981, new_var=51600000000160.805, new_n=5190
2025-06-02 15:52:40,313 - DEBUG - Updated RunningStats: new_mean=0.9421373743379671, new_var=51900000000018.92, new_n=5220
2025-06-02 15:52:40,313 - DEBUG - Updated RunningStats: new_mean=44.37562603331732, new_var=17200000193544.293, new_n=1730
2025-06-02 15:52:40,313 - DEBUG - Updated RunningStats: new_mean=44.41208492176303, new_var=17300000224875.12, new_n=1740
2025-06-02 15:52:40,313 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:52:40,313 - DEBUG - Online update step: 1/50
2025-06-02 15:52:40,313 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,313 - DEBUG - Online update step: 2/50
2025-06-02 15:52:40,313 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,313 - DEBUG - Online update step: 3/50
2025-06-02 15:52:40,313 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,313 - DEBUG - Online update step: 4/50
2025-06-02 15:52:40,313 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,313 - DEBUG - Online update step: 5/50
2025-06-02 15:52:40,313 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,313 - DEBUG - Online update step: 6/50
2025-06-02 15:52:40,313 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,313 - DEBUG - Online update step: 7/50
2025-06-02 15:52:40,313 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,313 - DEBUG - Online update step: 8/50
2025-06-02 15:52:40,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,314 - DEBUG - Online update step: 9/50
2025-06-02 15:52:40,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,314 - DEBUG - Online update step: 10/50
2025-06-02 15:52:40,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,314 - DEBUG - Online update step: 11/50
2025-06-02 15:52:40,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,314 - DEBUG - Online update step: 12/50
2025-06-02 15:52:40,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,314 - DEBUG - Online update step: 13/50
2025-06-02 15:52:40,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,314 - DEBUG - Online update step: 14/50
2025-06-02 15:52:40,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,314 - DEBUG - Online update step: 15/50
2025-06-02 15:52:40,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,314 - DEBUG - Online update step: 16/50
2025-06-02 15:52:40,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,314 - DEBUG - Online update step: 17/50
2025-06-02 15:52:40,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,314 - DEBUG - Online update step: 18/50
2025-06-02 15:52:40,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,314 - DEBUG - Online update step: 19/50
2025-06-02 15:52:40,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,314 - DEBUG - Online update step: 20/50
2025-06-02 15:52:40,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,314 - DEBUG - Online update step: 21/50
2025-06-02 15:52:40,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,314 - DEBUG - Online update step: 22/50
2025-06-02 15:52:40,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,314 - DEBUG - Online update step: 23/50
2025-06-02 15:52:40,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,314 - DEBUG - Online update step: 24/50
2025-06-02 15:52:40,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,314 - DEBUG - Online update step: 25/50
2025-06-02 15:52:40,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,314 - DEBUG - Online update step: 26/50
2025-06-02 15:52:40,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,314 - DEBUG - Online update step: 27/50
2025-06-02 15:52:40,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,315 - DEBUG - Online update step: 28/50
2025-06-02 15:52:40,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,315 - DEBUG - Online update step: 29/50
2025-06-02 15:52:40,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,315 - DEBUG - Online update step: 30/50
2025-06-02 15:52:40,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,315 - DEBUG - Online update step: 31/50
2025-06-02 15:52:40,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,315 - DEBUG - Online update step: 32/50
2025-06-02 15:52:40,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,315 - DEBUG - Online update step: 33/50
2025-06-02 15:52:40,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,315 - DEBUG - Online update step: 34/50
2025-06-02 15:52:40,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,315 - DEBUG - Online update step: 35/50
2025-06-02 15:52:40,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,315 - DEBUG - Online update step: 36/50
2025-06-02 15:52:40,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,315 - DEBUG - Online update step: 37/50
2025-06-02 15:52:40,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,315 - DEBUG - Online update step: 38/50
2025-06-02 15:52:40,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,315 - DEBUG - Online update step: 39/50
2025-06-02 15:52:40,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,315 - DEBUG - Online update step: 40/50
2025-06-02 15:52:40,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,315 - DEBUG - Online update step: 41/50
2025-06-02 15:52:40,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,315 - DEBUG - Online update step: 42/50
2025-06-02 15:52:40,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,315 - DEBUG - Online update step: 43/50
2025-06-02 15:52:40,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,315 - DEBUG - Online update step: 44/50
2025-06-02 15:52:40,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,315 - DEBUG - Online update step: 45/50
2025-06-02 15:52:40,316 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,316 - DEBUG - Online update step: 46/50
2025-06-02 15:52:40,316 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,316 - DEBUG - Online update step: 47/50
2025-06-02 15:52:40,316 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,316 - DEBUG - Online update step: 48/50
2025-06-02 15:52:40,316 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,316 - DEBUG - Online update step: 49/50
2025-06-02 15:52:40,316 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,316 - DEBUG - Online update step: 50/50
2025-06-02 15:52:40,316 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,316 - WARNING - No successful steps during online update.
2025-06-02 15:52:40,316 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -3.2285850e-08 -1.9868216e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.1044085e-08
  2.6077032e-08 -3.7252903e-09  1.2417635e-09 -2.2351742e-08
  2.2838542e+00  2.9609375e+00  1.4062500e-01  4.3932290e+00
  3.7252903e-09  3.4492188e+00  5.7096353e+00  7.5963540e+00
  1.4062500e-01  8.0000000e+00  1.2417635e-09 -3.2906730e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.4835269e-09  4.9670539e-09], current edge mean: [-1.7402816e-09  4.6368613e+02  0.0000000e+00  0.0000000e+00
 -3.4805632e-09 -2.9004694e-09 -5.8009386e-10 -4.3507038e-09
 -3.1905163e-09  3.7706100e-09]
2025-06-02 15:52:40,316 - DEBUG - Node drift difference: 0.0144, Edge drift difference: 0.0006
2025-06-02 15:52:40,317 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -3.2285850e-08 -1.9868216e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.1044085e-08
  2.6077032e-08 -3.7252903e-09  1.2417635e-09 -2.2351742e-08
  2.2838542e+00  2.9609375e+00  1.4062500e-01  4.3932290e+00
  3.7252903e-09  3.4492188e+00  5.7096353e+00  7.5963540e+00
  1.4062500e-01  8.0000000e+00  1.2417635e-09 -3.2906730e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.4835269e-09  4.9670539e-09], edge=[-1.7402816e-09  4.6368613e+02  0.0000000e+00  0.0000000e+00
 -3.4805632e-09 -2.9004694e-09 -5.8009386e-10 -4.3507038e-09
 -3.1905163e-09  3.7706100e-09]
2025-06-02 15:52:40,318 - DEBUG - Updated reference std: node=[0.         0.         1.0006517  1.0006517  0.         0.
 0.         1.0006517  1.0006517  1.0006516  1.0006517  1.0006516
 0.96356016 0.27694583 0.362543   0.56546044 1.0006516  3.062159
 2.921897   1.5160462  0.362543   0.         1.0006517  1.0006517
 0.         0.         0.         0.         1.0006517  1.0006516 ], edge=[  1.0003042 500.1926      0.          0.          1.0003042   1.0003042
   1.0003042   1.0003042   1.0003043   1.0003043]
2025-06-02 15:52:40,318 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:52:40,318 - INFO - Running anomaly detection...
2025-06-02 15:52:40,318 - INFO - Starting anomaly detection.
2025-06-02 15:52:40,326 - DEBUG - Node reconstruction errors: [16.43982   13.963849  23.770138  15.74093   10.158047   8.2726965
 22.932295  12.1347685 12.1347685 12.575921  12.1347685 10.679341
 29.027727   8.700877  14.814423  15.904857  11.093769  15.914397
 17.525133  15.598917  11.842044  14.814423  12.689669  10.294339
 14.845933  12.479006  14.845936   9.6932535 11.820699  14.845933
 10.9253645  8.147027   9.473511  15.4624195 12.534098  15.585109
  7.914223  15.598916  11.022976  12.007968  15.4104805 14.536525
 15.598916  16.132652   9.167499   8.611775  17.632359   8.455775
 11.560551  16.14291   26.215117  12.21784   12.221449  17.002008
 11.458959  10.554976  23.315493  15.121047  16.604975  17.384905
  7.4980607 15.318182  14.303462  10.853974  14.313562  11.458968
 11.723663  11.458934  14.303462  14.303462  12.043756   8.305365
 11.750886   7.6483445  7.4338226  8.41898   15.476876   8.253
  7.517489   7.5081453 14.708101   8.450831   7.4091096 10.262768
 10.968275  10.76452    9.027515   7.536343   7.3544316  8.898971
 14.282284   8.731942   9.50752    7.423002  11.4131    27.026838
 14.490617   7.580551  14.085774  11.363043   8.200765  14.490617
 15.001788   9.011349   9.842848  11.1585455 10.607139   7.675472
  9.616821  13.824464  14.586289  14.8503475 10.159195   9.922642
  8.315024   8.575301   8.228329   8.568858   7.3339934 11.602783
 14.261499   9.90086    9.787991   9.652085   7.189651  11.602818
  9.387905   7.4170365  7.7552295 14.783743  11.804705  11.442828
 14.908716   9.368648   8.298382  11.218907  15.126412  13.988295
  7.891193   9.10651   11.946201   8.8391695 14.382955  11.574671
 11.79588    8.1948805  8.228329  11.3825655 11.373749   7.3161435
 13.173665   9.29404    7.4350452 11.442825   8.699524   8.6563015
 11.4351     8.803835   8.200764  14.859494  11.79588    7.6288576
 11.4351    11.804705   8.235929   8.554288   8.17846    7.356174
  7.936028   7.384044   7.4056406 11.733519  14.071997  21.613718
  7.6826987 12.235095   7.373367   8.360753   8.179296   8.179297
 11.118147   9.164197  14.36617    9.351074   8.480105   7.587098
 14.326863   8.264067  11.178491  11.401169   7.650301   7.341004
 12.412289  11.351817   7.891194  11.825407   6.9399123 15.280047
  8.552581  14.810053  14.489921  11.4351     9.795822   7.364771
  8.253867   7.857443  11.552292   8.799883  14.195163   7.3937917
  8.240426   8.165703  11.657072   7.591411   7.223445  14.466224
  8.906981   8.228329   8.15361   11.351817   9.551487  14.326863
 13.963559  11.657072  11.4351     7.327405   8.433017  11.322681
  7.2962646 10.02597   10.364838   7.1687055  7.703269   8.22833
  8.22833   11.825407   7.3721967 13.963559  11.4351    15.274287
  8.52879    7.5393558 11.299561   7.314441  11.239663   7.477831
  8.4410095  8.158696  11.299561  12.232601  14.071997  14.002564
  8.153607   7.4655504  8.575297   8.218413  11.401169  14.2642
 14.959475   8.1792965  7.3226566  8.643286  15.15101   11.475434
  7.4912314 11.3732     7.161792  10.3269415  7.16179    8.618085
  9.87255    9.513259   7.3760056 14.74013    8.14255    8.179297
 14.128255   7.5730133 11.118146   7.451419   8.410216  13.996991
  7.2505713 14.677305   7.427344  14.362701   8.775873   7.4229903
  9.164197   9.931395  12.065268  14.664525  11.5899515 11.239663
  7.0410156 14.592885   7.4143844  8.179432  11.825407  15.403702
  7.2272654 13.810699   8.15529    8.155288  13.810699  13.810699
 13.810699   8.108367  13.932401  13.810699  13.810699   8.394855
 13.810699  11.410406   7.8177195  7.246881   8.775847   9.3060055
 11.6079445 11.937398   7.116988  11.779253   7.1171165  8.15529
  7.423732   9.438173  13.990084   8.108369   7.3278565  7.3278546
  7.4819202 11.839203  13.810699   8.142547  13.810699   8.108365
 11.823838  13.897272  13.990085  13.990085  13.810699  14.3219595
 13.990084   7.2777514  7.140714   7.376745   8.155291  14.448371
  7.1427927  7.259053  13.810699   8.620182   9.669096   8.367571
 14.426932  11.401169  14.243305  13.810699  13.883983  12.738174
  8.240421  11.389627  10.370073   7.1530166  8.155293  21.51815
 14.011599   8.421967   8.185501   8.326931   7.3648443  7.1163797
  7.3646774  9.736196   7.2179875  8.550623  13.896414  11.173211
  7.128975  13.810699   8.155289   7.562999  11.467611   7.2350945
  7.7101107  7.203716  10.99799    8.931872   7.9536605 13.810699
  8.363034   8.41381    8.232182   8.345521   7.906433   7.9064336
  7.9064336 16.172966  13.781462  16.269958  11.462748   8.315533
  7.9064336 13.781462   8.259953   8.232191   7.0223174 11.550351
  8.232181   6.9522014  7.9064336  8.232181  13.781462   7.9064336
  7.9064336 14.69614   14.262748   7.9064336 13.896413  14.095667
 11.499695  11.901424   8.253864  11.525205   9.498104  11.499784
 11.901424   8.487649   7.2379184 15.073975   7.022277  11.171536
  8.124708   7.9884777  7.9064336  7.9064336 11.462749   6.9724045
  9.498106  13.869617  14.468573  11.198698  10.23311   14.254249
 14.3948555  7.85687    7.3712506 11.791819  12.034487  11.526111
  7.2263455 13.841122  11.384237  13.785386  13.841122  11.365869
 11.525204  11.408418  14.697355   8.253861   8.208261  11.314398
 11.693858   9.387318  11.69386   11.314399  13.802919   8.253865
  7.5160604 11.950719  13.802919   8.208262   7.180311  10.24817
  7.2282014  8.254424   8.583808   8.208261  13.958766  11.284511
 14.457591   7.8371444 14.390604  11.791819   9.574336  14.403183
 13.841122   7.7983503 15.176604   9.884084   8.56804   13.958767
  7.370768  14.095667   8.273405  11.408417   8.214935  16.166805
 13.785386  11.284511  10.23311   14.095667  10.23311   13.885508
 13.777586   9.233128  13.912919   8.488192  11.384237  13.841122
  9.422553  11.291185  11.291185  14.3948555  8.084896  14.3948555
 13.912922   8.273927  14.730643   7.35058    8.273924  11.1987
 13.912919  11.684889  13.777586   8.2149315 11.705215   8.985884
  8.273923   7.0341706 14.468573  13.785386  13.785386  11.284511
  8.214932   8.25554    7.2908483  7.01577   13.785386   7.905605
 13.785386   7.905605  14.425015   8.273925  11.740774  11.291185
 11.836849  13.797158  10.978212  13.797158  13.797158  13.797158
 13.797158  13.797158  13.797158  13.797158   8.276102  11.778979
 15.095836  13.797158  13.797158  13.797158  13.797158  13.797158
 13.797158  13.797158  13.797158  13.797158   8.3396015 13.797158
 13.797158   8.276101  13.797158   9.422556  13.416631  13.785386
 14.551375   8.3100605 16.980345  16.980345   7.0135584 14.551375
 13.785386  13.912922  13.912919  13.785386  13.912919  14.564673
 11.772689  13.797158  11.198698  13.785386  11.291184  13.785386
 13.785386  14.369318  13.785386  13.912919  13.785386  13.785386
  8.273926  13.912919  13.785386  13.912922  13.785386  13.785386
 13.785386   7.0151052  8.273405   8.273405  13.797158  11.008904
 13.842309  13.785386  13.912919   7.1366725 13.797158  13.912919
  7.0536284 14.066333  13.785386  13.785386   8.721729   7.0756197
  8.571435  13.785386   8.276099  14.369318  13.912919   9.074375
 13.797158  13.912919   8.27393   13.797158  13.797158   8.276102
 14.369318  13.785386   9.861345   7.871371   8.162312   7.0756197
 14.456021   7.905322   7.905322  13.465405  13.85151   13.797158
 11.44507    8.065381   7.0756197  8.397779  13.85151   13.914012
 13.867777  13.867777  13.867777  13.867777  13.867777   8.487461
  8.115722  13.867777  13.867777  13.797158  14.3073015 13.797158
  7.905322   7.0741744  7.905322  14.316291   7.9053254  7.385767
  8.3396015 13.797158   8.3396    13.797158   7.9053254 13.789828
 13.952475  13.952475  13.867777  13.789825   7.128612  14.355044
 13.797158  13.797158  13.867777  13.914012  13.952475  14.241681
 13.914012  14.197946   8.487456   9.89498   14.197946   8.086764
  8.638644  13.914011  11.48708   13.850004  13.99741   13.99741
  8.157737  13.953335   8.004825  13.914012  13.914011  13.914012
 14.067687  13.914012  13.914012  13.99741   13.914012  13.914012
 13.914011   8.712663  13.94033    7.2954187  7.4952526  8.191364
 11.671705  14.177973   7.3584456 16.90698   14.045364  13.985778
 14.045374  11.393406  11.393406  13.99741    8.200574   7.87785
 14.045374  13.9814625 15.020685   8.020144  14.113892  14.113892
 14.113892  14.098716  14.172699   9.515378  11.873108  10.420423
 14.457457  14.160657  11.794033  13.9814625 11.764762   8.792663
 14.045374  12.097886  14.045374  10.420423  13.9814625  8.359335
 14.160657  14.351048  14.113892  14.098716  14.045374  11.720499
 11.531305  14.098716  14.098716  14.098716  11.860378  11.860379 ]
2025-06-02 15:52:40,327 - DEBUG - Edge reconstruction errors: [  4.4697466   4.6505675  43.87645   ...  12.465214   12.649002
 535.2486   ]
2025-06-02 15:52:40,330 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155240_update_29.json
2025-06-02 15:52:40,331 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:52:40,334 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155240_update_29.pth and as latest_checkpoint.pth
2025-06-02 15:52:40,334 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869965.dot): 0.4374
2025-06-02 15:52:40,334 - WARNING - Detected 8 anomalous nodes (reconstruction-based):
2025-06-02 15:52:40,334 - WARNING -   Node ID: 192.168.27.13, Recon Error: 23.7701, MLP Score: 0.9524
2025-06-02 15:52:40,334 - WARNING -   Node ID: 192.168.27.12, Recon Error: 22.9323, MLP Score: 0.9522
2025-06-02 15:52:40,334 - WARNING -   Node ID: 192.168.27.10, Recon Error: 29.0277, MLP Score: 0.9530
2025-06-02 15:52:40,334 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 26.2151, MLP Score: 0.9706
2025-06-02 15:52:40,334 - WARNING -   Node ID: 192.168.209.130, Recon Error: 23.3155, MLP Score: 0.7655
2025-06-02 15:52:40,334 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 15:52:40,334 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2480, MLP Score: 0.0000
2025-06-02 15:52:40,334 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9515, MLP Score: 0.0000
2025-06-02 15:52:40,334 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0507, MLP Score: 0.0000
2025-06-02 15:52:40,335 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7500, MLP Score: 0.0000
2025-06-02 15:52:40,335 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7487, MLP Score: 0.0000
2025-06-02 15:52:40,335 - INFO - 
--- Processing file: nw_graph_encoded_1748869995.dot (Timestamp: 2025-06-02 15:13:15) ---
2025-06-02 15:52:40,335 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869995.dot
2025-06-02 15:52:40,335 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869995.dot'.
2025-06-02 15:52:40,335 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869995.dot
2025-06-02 15:52:40,356 - INFO - Parsed 780 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869995.dot'.
2025-06-02 15:52:40,378 - INFO - Parsed 1667 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869995.dot'.
2025-06-02 15:52:40,378 - INFO - Processing node updates/additions.
2025-06-02 15:52:40,383 - INFO - Processing edge updates/additions.
2025-06-02 15:52:40,393 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:52:40,394 - INFO - Finished updating NetworkX graph.
2025-06-02 15:52:40,395 - DEBUG - Updated graph - Nodes: 780, Edges: 1667
2025-06-02 15:52:40,395 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:52:40,396 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:52:40,403 - DEBUG - Initial node features tensor shape: torch.Size([780, 30])
2025-06-02 15:52:40,405 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:52:40,405 - DEBUG - Node features tensor shape after scaling: torch.Size([780, 30])
2025-06-02 15:52:40,408 - DEBUG - Edge index tensor shape: torch.Size([2, 1667])
2025-06-02 15:52:40,409 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:52:40,412 - DEBUG - Initial edge attributes tensor shape: torch.Size([1667, 10])
2025-06-02 15:52:40,414 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:52:40,414 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1667, 10])
2025-06-02 15:52:40,414 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:52:40,414 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:52:40,415 - INFO - Updated main graph to 780 nodes and 1667 edges.
2025-06-02 15:52:40,415 - INFO - Performing online update...
2025-06-02 15:52:40,415 - INFO - Starting online update for 50 steps.
2025-06-02 15:52:40,416 - DEBUG - Updated RunningStats: new_mean=0.9433551973795439, new_var=52200000000160.62, new_n=5250
2025-06-02 15:52:40,416 - DEBUG - Updated RunningStats: new_mean=0.942227703616091, new_var=52500000000018.484, new_n=5280
2025-06-02 15:52:40,416 - DEBUG - Updated RunningStats: new_mean=44.42272868593982, new_var=17400000192756.168, new_n=1750
2025-06-02 15:52:40,416 - DEBUG - Updated RunningStats: new_mean=44.45669104126587, new_var=17500000221968.498, new_n=1760
2025-06-02 15:52:40,416 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:52:40,416 - DEBUG - Online update step: 1/50
2025-06-02 15:52:40,416 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,416 - DEBUG - Online update step: 2/50
2025-06-02 15:52:40,416 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,416 - DEBUG - Online update step: 3/50
2025-06-02 15:52:40,416 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,416 - DEBUG - Online update step: 4/50
2025-06-02 15:52:40,416 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,416 - DEBUG - Online update step: 5/50
2025-06-02 15:52:40,416 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,416 - DEBUG - Online update step: 6/50
2025-06-02 15:52:40,416 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,417 - DEBUG - Online update step: 7/50
2025-06-02 15:52:40,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,417 - DEBUG - Online update step: 8/50
2025-06-02 15:52:40,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,417 - DEBUG - Online update step: 9/50
2025-06-02 15:52:40,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,417 - DEBUG - Online update step: 10/50
2025-06-02 15:52:40,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,417 - DEBUG - Online update step: 11/50
2025-06-02 15:52:40,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,417 - DEBUG - Online update step: 12/50
2025-06-02 15:52:40,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,417 - DEBUG - Online update step: 13/50
2025-06-02 15:52:40,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,417 - DEBUG - Online update step: 14/50
2025-06-02 15:52:40,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,417 - DEBUG - Online update step: 15/50
2025-06-02 15:52:40,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,417 - DEBUG - Online update step: 16/50
2025-06-02 15:52:40,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,417 - DEBUG - Online update step: 17/50
2025-06-02 15:52:40,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,417 - DEBUG - Online update step: 18/50
2025-06-02 15:52:40,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,417 - DEBUG - Online update step: 19/50
2025-06-02 15:52:40,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,417 - DEBUG - Online update step: 20/50
2025-06-02 15:52:40,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,417 - DEBUG - Online update step: 21/50
2025-06-02 15:52:40,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,417 - DEBUG - Online update step: 22/50
2025-06-02 15:52:40,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,417 - DEBUG - Online update step: 23/50
2025-06-02 15:52:40,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,417 - DEBUG - Online update step: 24/50
2025-06-02 15:52:40,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,417 - DEBUG - Online update step: 25/50
2025-06-02 15:52:40,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,418 - DEBUG - Online update step: 26/50
2025-06-02 15:52:40,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,418 - DEBUG - Online update step: 27/50
2025-06-02 15:52:40,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,418 - DEBUG - Online update step: 28/50
2025-06-02 15:52:40,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,418 - DEBUG - Online update step: 29/50
2025-06-02 15:52:40,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,418 - DEBUG - Online update step: 30/50
2025-06-02 15:52:40,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,418 - DEBUG - Online update step: 31/50
2025-06-02 15:52:40,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,418 - DEBUG - Online update step: 32/50
2025-06-02 15:52:40,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,418 - DEBUG - Online update step: 33/50
2025-06-02 15:52:40,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,418 - DEBUG - Online update step: 34/50
2025-06-02 15:52:40,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,418 - DEBUG - Online update step: 35/50
2025-06-02 15:52:40,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,418 - DEBUG - Online update step: 36/50
2025-06-02 15:52:40,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,418 - DEBUG - Online update step: 37/50
2025-06-02 15:52:40,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,418 - DEBUG - Online update step: 38/50
2025-06-02 15:52:40,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,418 - DEBUG - Online update step: 39/50
2025-06-02 15:52:40,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,418 - DEBUG - Online update step: 40/50
2025-06-02 15:52:40,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,418 - DEBUG - Online update step: 41/50
2025-06-02 15:52:40,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,418 - DEBUG - Online update step: 42/50
2025-06-02 15:52:40,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,418 - DEBUG - Online update step: 43/50
2025-06-02 15:52:40,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,418 - DEBUG - Online update step: 44/50
2025-06-02 15:52:40,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,419 - DEBUG - Online update step: 45/50
2025-06-02 15:52:40,419 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,419 - DEBUG - Online update step: 46/50
2025-06-02 15:52:40,419 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,419 - DEBUG - Online update step: 47/50
2025-06-02 15:52:40,419 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,419 - DEBUG - Online update step: 48/50
2025-06-02 15:52:40,419 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,419 - DEBUG - Online update step: 49/50
2025-06-02 15:52:40,419 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,419 - DEBUG - Online update step: 50/50
2025-06-02 15:52:40,419 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,419 - WARNING - No successful steps during online update.
2025-06-02 15:52:40,419 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  5.2574354e-08 -8.3140840e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.2924864e-08
 -2.4453188e-09 -3.1789146e-08 -1.8339891e-09 -6.7246266e-09
  2.2884614e+00  2.9564102e+00  1.4230770e-01  4.3961539e+00
  2.9343825e-08  3.4333334e+00  5.7128205e+00  7.5948720e+00
  1.4230770e-01  7.9910254e+00 -4.2793080e-09 -1.0545437e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.2226594e-08 -4.5238398e-08], current edge mean: [-4.5767212e-09  4.6274744e+02  0.0000000e+00  0.0000000e+00
 -2.0023156e-09  0.0000000e+00  3.7185861e-09  0.0000000e+00
  0.0000000e+00  6.4360144e-09]
2025-06-02 15:52:40,420 - DEBUG - Node drift difference: 8974.5518, Edge drift difference: 0.0019
2025-06-02 15:52:40,420 - WARNING - Feature drift detected (1 consecutive)
2025-06-02 15:52:40,420 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  5.2574354e-08 -8.3140840e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.2924864e-08
 -2.4453188e-09 -3.1789146e-08 -1.8339891e-09 -6.7246266e-09
  2.2884614e+00  2.9564102e+00  1.4230770e-01  4.3961539e+00
  2.9343825e-08  3.4333334e+00  5.7128205e+00  7.5948720e+00
  1.4230770e-01  7.9910254e+00 -4.2793080e-09 -1.0545437e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.2226594e-08 -4.5238398e-08], edge=[-4.5767212e-09  4.6274744e+02  0.0000000e+00  0.0000000e+00
 -2.0023156e-09  0.0000000e+00  3.7185861e-09  0.0000000e+00
  0.0000000e+00  6.4360144e-09]
2025-06-02 15:52:40,421 - DEBUG - Updated reference std: node=[0.         0.         1.0006417  1.0006417  0.         0.
 0.         1.0006417  1.0006416  1.0006417  1.0006416  1.0006417
 1.0045444  0.29221377 0.36398143 0.5649002  1.0006417  3.058592
 2.92255    1.5183852  0.36398143 0.2506402  1.0006417  1.0006417
 0.         0.         0.         0.         1.0006417  1.0006417 ], edge=[  1.0003  496.99893   0.        0.        1.0003    1.0003    1.0003
   1.0003    1.0003    1.0003 ]
2025-06-02 15:52:40,421 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:52:40,421 - INFO - Running anomaly detection...
2025-06-02 15:52:40,421 - INFO - Starting anomaly detection.
2025-06-02 15:52:40,428 - DEBUG - Node reconstruction errors: [16.444956  13.512887  23.573702  15.660824  10.063328   8.185812
 22.744055  12.057333  12.057333  12.499587  12.057329  10.592527
 28.611483   8.581081  14.754846  15.832888  10.995057  15.842386
 17.155216  15.547928  11.785736  14.754846  12.548954  10.203843
 14.788409  12.424245  14.788409   9.625173  11.76311   14.788411
 10.634825   8.057074   9.370235  15.398202  12.476716  15.489549
  7.8280106 15.547928  10.931845  11.890826  15.363578  14.492505
 15.547928  16.04803    9.031107   8.501593  17.5756     8.358779
 11.519755  16.127232  26.384869  12.1746645 12.183301  16.69323
 11.411208  10.481673  23.144009  15.095295  16.28731   17.055277
  7.470164  15.224073  14.271176  10.712909  14.280304  11.411218
 11.676498  11.411194  14.271176  14.271176  11.953475   8.271647
 11.710343   7.59773    7.3746204  8.379533  15.677826   8.233525
  7.4666734  7.464141  14.679865   8.408415   7.3447065 10.226644
 10.899506  10.63558    8.971824   7.483286   7.3123846  8.836195
 14.252227   8.699325   9.464242   7.3758063 11.377789  27.221935
 14.470865   7.5144525 14.058726  11.3275795  8.171843  14.470865
 14.969969   8.962955   9.731562  11.132491  10.638629   7.6006527
  9.57321   13.813364  14.497233  14.814356  10.115119   9.888784
  8.282191   8.524815   8.198305   8.547366   7.2962604 11.551556
 14.226461   9.8200245  9.758273   9.580909   7.14651   11.551572
  9.34505    7.382004   7.666742  14.719901  11.781241  11.417444
 14.891122   9.3407345  8.262916  11.189715  15.0820265 13.96729
  7.8154526  9.056179  11.875716   8.791768  14.337718  11.538066
 11.73927    8.167678   8.198305  11.362958  11.348414   7.2782564
 13.157504   9.78596    7.386295  11.417444   8.672839   8.621598
 11.408116   8.735023   8.171845  14.837392  11.73927    7.5879006
 11.408116  11.781243   8.204072   8.535137   8.140936   7.314627
  7.854642   7.332185   7.364968  11.670815  14.047875  21.816956
  7.5998774 12.107265   7.326774   8.299417   8.147761   8.147762
 11.089967   9.143971  14.329843   9.335901   8.546879   7.5931063
 14.280554   8.2250395 11.147216  11.371326   7.654216   7.2920737
 12.354822  11.333025   7.8154535 11.794514   6.880605  15.223992
  8.535323  14.742606  14.431823  11.40812    9.763108   7.3249955
  8.223462   7.7834315 11.529421   8.781766  14.162751   7.346355
  8.2045765  8.133689  11.639389   7.528743   7.1570325 14.415106
  8.822352   8.198306   8.122854  11.333025   9.528964  14.280554
 13.940367  11.639389  11.408116   7.250852   8.408696  11.305897
  7.2589154  9.96913   10.277717   7.120387   7.619099   8.198307
  8.198305  11.794513   7.3176055 13.940367  11.408116  15.258683
  8.487974   7.4822903 11.281384   7.246192  11.224323   7.474505
  8.399283   8.499891  11.281384  12.149078  14.0478735 13.981573
  8.122854   7.406378   8.524816   8.195524  11.371328  14.21842
 14.930971   8.147763   7.26961    8.6158695 15.136412  11.42868
  7.424128  11.335128   7.119066  10.0545025  7.119067   8.55659
  9.854304   9.496667   7.3262    14.671675   8.104846   8.147762
 14.0823345  7.536598  11.089967   7.390031   8.380424  13.959797
  7.2076545 14.660722   7.3417916 14.344781   8.740976   7.403745
  9.143971   9.833182  11.980703  14.626794  11.5672035 11.224323
  6.970846  14.539964   7.361673   8.147826  11.794513  15.357639
  7.1828976 13.788699   8.110967   8.110964  13.788699  13.788699
 13.788699   8.0683775 13.902929  13.788699  13.788699   8.388293
 13.788699  11.374462   7.7301636  7.204669   8.697742   9.264068
 11.588963  11.897622   7.071267  11.70141    7.0847845  8.110965
  7.5104656  9.417525  13.963222   8.0683775  7.283732   7.283736
  7.448214  11.798372  13.788699   8.104849  13.788699   8.0683775
 11.74723   13.877183  13.96322   13.96322   13.788699  14.305066
 13.96322    7.204513   7.0930448  7.2954264  8.110966  14.423646
  7.108627   7.2215466 13.788699   8.55849    9.639124   8.325
 14.39982   11.371328  14.195001  13.788699  13.863977  12.692502
  8.2045765 11.351015  10.334773   7.0993023  8.110968  21.691475
 13.980561   8.390399   8.148077   8.286594   7.3106914  7.0656056
  7.3105807  9.678091   7.177928   8.4592705 13.871869  11.153554
  7.075015  13.788699   8.110966   7.508811  11.428672   7.186084
  7.6376934  7.136653  10.979159   8.866232   7.923295  13.788699
  8.333014   8.362394   8.197436   8.290327   7.8698115  7.8698115
  7.8698115 15.890657  13.755095  15.983641  11.417456   8.275129
  7.8698115 13.755095   8.220608   8.197439   6.985481  11.491024
  8.197435   6.9293356  7.8698115  8.197436  13.755095   7.8698115
  7.8698115 14.655202  14.243942   7.8698115 13.87187   14.645952
 11.433121  11.847693   8.210486  11.470781   9.533252  11.92723
 11.847693   8.432971   7.2251115 15.0527935  6.983736  11.126921
  8.066465   7.9526987  7.8698115  7.8698115 11.417456   6.939441
  9.451261  13.83557   14.439363  11.166952  10.200044  14.198556
 14.356136   7.758669   7.2978954 11.725812  11.983015  11.464583
  7.1423445 13.819808  11.335892  13.764736  13.819808  11.298251
 11.470782  11.36942   14.680769   8.210485   8.169092  11.283146
 11.619145   9.372089  11.619145  11.283148  13.777732   8.503441
  7.4641056 11.896216  13.777732   8.169093   7.084246  10.122432
  7.181916   8.210736   8.503442   8.169091  13.927036  11.251612
 14.42019    7.8108068 14.335409  11.725812   9.536055  14.383731
 13.819808   7.758029  15.143605  10.104173   8.500521  13.927039
  7.2976794 14.063411   8.218032  11.36942    8.169093  16.53873
 13.764736  11.251612  10.200044  14.063412  10.200044  13.85445
 13.760077   9.202154  13.881693   8.458874  11.335892  13.819808
  9.368689  11.251375  11.251375  14.356136   8.024618  14.356136
 13.881693   8.21642   14.72265    7.2902703  8.216418  11.16695
 13.881693  11.650839  13.760076   8.169094  11.6654625  8.947666
  8.216419   6.9945507 14.43936   13.764736  13.764736  11.251612
  8.169095   8.20571    7.2328196  6.975768  13.764736   7.8716984
 13.764736   7.8716984 14.475911   8.216416  11.658568  10.466898
 11.773395  13.767462  10.949446  13.767459  13.767462  13.767459
 13.767462  13.767462  13.767462  13.767462   8.214086  11.72962
 15.100307  13.767462  13.767462  13.767462  13.767459  13.767459
 13.767462  13.767462  13.767462  13.767459   8.269401  13.767462
 13.767459   9.320939  13.767459   9.654187  13.36296   13.764736
 14.516883   8.229524  16.919186  16.919186   6.9752336 14.516883
 13.764736  13.881693  13.881693  13.764736  13.881693  14.541484
 11.871509  13.767462  11.166952  13.764736  11.251375  13.764736
 13.764736  14.331362  13.764736  13.881693  13.764736  13.764736
  8.216417  13.881693  13.764736  13.881693  13.764736  13.764736
 13.764736   6.9713225  8.21803    8.218028  13.767459  10.970791
 13.798112  13.764736  13.881693   7.198998  13.767459  13.881693
  7.0111923 14.025184  13.764736  13.764736   8.618282   7.026385
  8.483784  13.764736   8.2140875 14.331362  13.881693   9.02597
 13.767462  13.881693   8.216416  13.767462  13.767462   8.2140875
 14.331362  13.764736   9.842981   7.8386273  8.090723   7.026385
 14.434698   7.8511553  7.851158  13.398673  14.369732  13.767462
 11.385417   7.985075   7.026383   8.317053  13.818717  13.869699
 13.823456  13.823456  13.823456  13.823456  13.823456   8.392201
  8.045758  13.823456  13.823456  13.767462  14.28273   13.767459
  7.851158   7.0210347  7.851158  14.28877    7.851158   7.2854714
  8.269401  13.767459   8.269401  13.767462   7.8511553 13.761399
 13.910929  13.910929  13.823456  13.761399   7.0701165 14.31435
 13.767459  13.767462  13.823459  13.869699  13.910929  14.210463
 13.869699  14.164981   8.392206   9.8142185 14.164981   8.062453
  8.541827  13.869699  11.425187  13.809256  13.940829  13.940829
  8.072149  13.898251   7.929352  13.869699  13.869699  13.869699
 14.010934  13.869699  13.869699  13.94083   13.869699  13.869699
 13.869699   8.61089   13.885301   7.3857822  7.3857813  8.113115
 11.603336  14.135513   7.4844146 16.482275  14.003208  13.953531
 14.093642  11.335009  11.335009  13.94083    8.141484   7.7609043
 14.003208  13.948161  14.996166   7.969507  14.04213   14.04213
 14.04213   14.024014  14.173311   9.397638  11.788201  10.348861
 14.41337   14.195418  11.724623  13.948161  11.705932   8.681574
 14.093642  12.037699  14.003208   7.760826  13.948161   8.349065
 14.093643  14.3043375 14.04213   14.024014  14.093642  11.661496
 11.451117  14.024014  14.024014  14.024014  11.861377  11.779933
  8.711176  14.04213    7.6620455 14.024014   8.475336  11.946108
 16.91046   11.946107  14.024014  14.09244   11.946107  14.0990505]
2025-06-02 15:52:40,428 - DEBUG - Edge reconstruction errors: [  4.4763446   4.6515493  43.873814  ...  12.466191   12.649784
 535.25134  ]
2025-06-02 15:52:40,430 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155240_update_30.json
2025-06-02 15:52:40,430 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:52:40,433 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155240_update_30.pth and as latest_checkpoint.pth
2025-06-02 15:52:40,433 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869995.dot): 0.4419
2025-06-02 15:52:40,433 - WARNING - Detected 8 anomalous nodes (reconstruction-based):
2025-06-02 15:52:40,433 - WARNING -   Node ID: 192.168.27.13, Recon Error: 23.5737, MLP Score: 0.9533
2025-06-02 15:52:40,433 - WARNING -   Node ID: 192.168.27.12, Recon Error: 22.7441, MLP Score: 0.9523
2025-06-02 15:52:40,433 - WARNING -   Node ID: 192.168.27.10, Recon Error: 28.6115, MLP Score: 0.9537
2025-06-02 15:52:40,433 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 26.3849, MLP Score: 0.9714
2025-06-02 15:52:40,433 - WARNING -   Node ID: 192.168.209.130, Recon Error: 23.1440, MLP Score: 0.7571
2025-06-02 15:52:40,433 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 15:52:40,434 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2507, MLP Score: 0.0000
2025-06-02 15:52:40,434 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9538, MLP Score: 0.0000
2025-06-02 15:52:40,434 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0529, MLP Score: 0.0000
2025-06-02 15:52:40,434 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7526, MLP Score: 0.0000
2025-06-02 15:52:40,434 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7513, MLP Score: 0.0000
2025-06-02 15:52:40,434 - INFO - 
--- Processing file: nw_graph_encoded_1748870025.dot (Timestamp: 2025-06-02 15:13:45) ---
2025-06-02 15:52:40,434 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870025.dot
2025-06-02 15:52:40,434 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870025.dot'.
2025-06-02 15:52:40,434 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870025.dot
2025-06-02 15:52:40,455 - INFO - Parsed 799 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870025.dot'.
2025-06-02 15:52:40,475 - INFO - Parsed 1718 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870025.dot'.
2025-06-02 15:52:40,475 - INFO - Processing node updates/additions.
2025-06-02 15:52:40,480 - INFO - Processing edge updates/additions.
2025-06-02 15:52:40,490 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:52:40,491 - INFO - Finished updating NetworkX graph.
2025-06-02 15:52:40,492 - DEBUG - Updated graph - Nodes: 799, Edges: 1718
2025-06-02 15:52:40,492 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:52:40,493 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:52:40,502 - DEBUG - Initial node features tensor shape: torch.Size([799, 30])
2025-06-02 15:52:40,504 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:52:40,504 - DEBUG - Node features tensor shape after scaling: torch.Size([799, 30])
2025-06-02 15:52:40,506 - DEBUG - Edge index tensor shape: torch.Size([2, 1718])
2025-06-02 15:52:40,507 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:52:40,511 - DEBUG - Initial edge attributes tensor shape: torch.Size([1718, 10])
2025-06-02 15:52:40,512 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:52:40,512 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1718, 10])
2025-06-02 15:52:40,512 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:52:40,512 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:52:40,513 - INFO - Updated main graph to 799 nodes and 1718 edges.
2025-06-02 15:52:40,513 - INFO - Performing online update...
2025-06-02 15:52:40,513 - INFO - Starting online update for 50 steps.
2025-06-02 15:52:40,513 - DEBUG - Updated RunningStats: new_mean=0.9434353813035478, new_var=52800000000160.586, new_n=5310
2025-06-02 15:52:40,514 - DEBUG - Updated RunningStats: new_mean=0.9423226269454905, new_var=53100000000018.48, new_n=5340
2025-06-02 15:52:40,514 - DEBUG - Updated RunningStats: new_mean=44.466025911152954, new_var=17600000191370.426, new_n=1770
2025-06-02 15:52:40,514 - DEBUG - Updated RunningStats: new_mean=44.495444246230086, new_var=17700000215698.695, new_n=1780
2025-06-02 15:52:40,514 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:52:40,514 - DEBUG - Online update step: 1/50
2025-06-02 15:52:40,514 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,514 - DEBUG - Online update step: 2/50
2025-06-02 15:52:40,514 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,514 - DEBUG - Online update step: 3/50
2025-06-02 15:52:40,514 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,514 - DEBUG - Online update step: 4/50
2025-06-02 15:52:40,514 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,514 - DEBUG - Online update step: 5/50
2025-06-02 15:52:40,514 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,514 - DEBUG - Online update step: 6/50
2025-06-02 15:52:40,515 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,515 - DEBUG - Online update step: 7/50
2025-06-02 15:52:40,515 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,515 - DEBUG - Online update step: 8/50
2025-06-02 15:52:40,515 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,515 - DEBUG - Online update step: 9/50
2025-06-02 15:52:40,515 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,515 - DEBUG - Online update step: 10/50
2025-06-02 15:52:40,515 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,515 - DEBUG - Online update step: 11/50
2025-06-02 15:52:40,515 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,515 - DEBUG - Online update step: 12/50
2025-06-02 15:52:40,515 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,515 - DEBUG - Online update step: 13/50
2025-06-02 15:52:40,515 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,515 - DEBUG - Online update step: 14/50
2025-06-02 15:52:40,515 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,515 - DEBUG - Online update step: 15/50
2025-06-02 15:52:40,515 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,515 - DEBUG - Online update step: 16/50
2025-06-02 15:52:40,515 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,515 - DEBUG - Online update step: 17/50
2025-06-02 15:52:40,515 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,515 - DEBUG - Online update step: 18/50
2025-06-02 15:52:40,515 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,515 - DEBUG - Online update step: 19/50
2025-06-02 15:52:40,515 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,515 - DEBUG - Online update step: 20/50
2025-06-02 15:52:40,515 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,515 - DEBUG - Online update step: 21/50
2025-06-02 15:52:40,515 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,515 - DEBUG - Online update step: 22/50
2025-06-02 15:52:40,515 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,515 - DEBUG - Online update step: 23/50
2025-06-02 15:52:40,515 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,515 - DEBUG - Online update step: 24/50
2025-06-02 15:52:40,515 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,515 - DEBUG - Online update step: 25/50
2025-06-02 15:52:40,516 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,516 - DEBUG - Online update step: 26/50
2025-06-02 15:52:40,516 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,516 - DEBUG - Online update step: 27/50
2025-06-02 15:52:40,516 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,516 - DEBUG - Online update step: 28/50
2025-06-02 15:52:40,516 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,516 - DEBUG - Online update step: 29/50
2025-06-02 15:52:40,516 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,516 - DEBUG - Online update step: 30/50
2025-06-02 15:52:40,516 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,516 - DEBUG - Online update step: 31/50
2025-06-02 15:52:40,516 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,516 - DEBUG - Online update step: 32/50
2025-06-02 15:52:40,516 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,516 - DEBUG - Online update step: 33/50
2025-06-02 15:52:40,516 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,516 - DEBUG - Online update step: 34/50
2025-06-02 15:52:40,516 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,516 - DEBUG - Online update step: 35/50
2025-06-02 15:52:40,516 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,516 - DEBUG - Online update step: 36/50
2025-06-02 15:52:40,516 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,516 - DEBUG - Online update step: 37/50
2025-06-02 15:52:40,516 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,516 - DEBUG - Online update step: 38/50
2025-06-02 15:52:40,516 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,516 - DEBUG - Online update step: 39/50
2025-06-02 15:52:40,516 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,516 - DEBUG - Online update step: 40/50
2025-06-02 15:52:40,516 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,516 - DEBUG - Online update step: 41/50
2025-06-02 15:52:40,516 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,516 - DEBUG - Online update step: 42/50
2025-06-02 15:52:40,516 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,516 - DEBUG - Online update step: 43/50
2025-06-02 15:52:40,516 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,517 - DEBUG - Online update step: 44/50
2025-06-02 15:52:40,517 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,517 - DEBUG - Online update step: 45/50
2025-06-02 15:52:40,517 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,517 - DEBUG - Online update step: 46/50
2025-06-02 15:52:40,517 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,517 - DEBUG - Online update step: 47/50
2025-06-02 15:52:40,517 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,517 - DEBUG - Online update step: 48/50
2025-06-02 15:52:40,517 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,517 - DEBUG - Online update step: 49/50
2025-06-02 15:52:40,517 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,517 - DEBUG - Online update step: 50/50
2025-06-02 15:52:40,517 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:40,517 - WARNING - No successful steps during online update.
2025-06-02 15:52:40,517 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -1.4323018e-08  2.1484528e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -4.2670660e-08
 -3.5807545e-08  1.6710189e-08  2.3871698e-08 -2.6258867e-08
  2.2966208e+00  2.9574468e+00  1.5018773e-01  4.3942428e+00
 -1.9097358e-08  3.4367959e+00  5.7058825e+00  7.5969963e+00
  1.5018773e-01  7.9912391e+00  1.1935849e-08  6.8631132e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.0145471e-08 -8.5938112e-08], current edge mean: [-8.8817167e-09  4.6108963e+02  0.0000000e+00  0.0000000e+00
 -3.0530900e-09 -2.2204292e-09  2.2204292e-09  5.5510729e-10
 -3.8857508e-09  1.1102146e-09]
2025-06-02 15:52:40,518 - DEBUG - Node drift difference: 0.0216, Edge drift difference: 0.0033
2025-06-02 15:52:40,518 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -1.4323018e-08  2.1484528e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -4.2670660e-08
 -3.5807545e-08  1.6710189e-08  2.3871698e-08 -2.6258867e-08
  2.2966208e+00  2.9574468e+00  1.5018773e-01  4.3942428e+00
 -1.9097358e-08  3.4367959e+00  5.7058825e+00  7.5969963e+00
  1.5018773e-01  7.9912391e+00  1.1935849e-08  6.8631132e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.0145471e-08 -8.5938112e-08], edge=[-8.8817167e-09  4.6108963e+02  0.0000000e+00  0.0000000e+00
 -3.0530900e-09 -2.2204292e-09  2.2204292e-09  5.5510729e-10
 -3.8857508e-09  1.1102146e-09]
2025-06-02 15:52:40,519 - DEBUG - Updated reference std: node=[0.         0.         1.0006263  1.0006263  0.         0.
 0.         1.0006263  1.0006263  1.0006263  1.0006263  1.0006263
 1.0016909  0.28879055 0.37459666 0.5672931  1.0006264  3.0588543
 2.925534   1.5144387  0.37459666 0.2476422  1.0006263  1.0006263
 0.         0.         0.         0.         1.0006263  1.0006263 ], edge=[  1.0002911 490.02286     0.          0.          1.0002911   1.0002911
   1.0002912   1.0002911   1.0002911   1.0002911]
2025-06-02 15:52:40,519 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:52:40,519 - INFO - Running anomaly detection...
2025-06-02 15:52:40,519 - INFO - Starting anomaly detection.
2025-06-02 15:52:40,526 - DEBUG - Node reconstruction errors: [16.278835  14.034235  22.701643  15.592728   9.962597   8.1449175
 22.217615  11.988656  11.988656  12.430283  11.988658  10.53507
 27.859154   8.562226  14.717957  15.786384  10.935338  15.796119
 17.155348  15.518927  11.751464  14.717957  12.428336  10.145977
 14.755521  12.377886  14.755524   9.6179905 11.7188425 14.755525
 10.65296    8.020014   9.334069  15.350825  12.424569  12.435678
  7.798929  15.518927  10.8231945 11.78876   15.3413515 14.475882
 15.518927  15.978372   8.910331   8.409054  17.532389   8.787989
 11.494848  16.241377  25.292246  12.148895  12.156163  16.72923
 11.383512  10.414595  22.42286   15.098835  16.341244  17.033163
  7.456347  15.167333  14.268921  10.600877  14.274964  11.383518
 11.649555  11.383498  14.268921  14.268921  11.891318   8.274336
 11.684476   7.6028156  7.5954766  8.376611  15.677713   8.235938
  7.4758577  7.4763207 14.678186   8.408839   7.2817698 10.218307
  7.726579  10.54544    8.945845   7.8095202  7.323152   8.842726
 14.248081   8.696738   9.462422   7.3925776 11.367661  26.089111
 14.481336   7.5244145 14.068645  11.304366   8.180105  14.481336
 14.966502   8.970334   9.650977  11.123313  10.5716915  7.5427356
  9.5602255 13.794999  14.440277  14.805695  10.080566   9.867917
  8.282017   8.507921   8.201452   8.545712   7.3134546 11.525617
 14.222091   9.786374   9.743737   9.553954   7.157946  11.525636
  9.339042   7.3673773  7.7266784 14.692108  11.778087  11.407011
 14.896716   9.330477   8.256647  11.17412   15.073811  13.982093
  7.749352   9.036405  11.814801   8.782458  14.321729  11.513132
 11.694577   8.176241   8.201453  11.355967  11.347428   7.2939773
 13.1664915  9.892286   7.4135294 11.407011   8.680255   8.615674
 11.395928   8.717204   8.180108  14.840893  11.694577   7.564698
 11.395928  11.778087   8.206714   8.536048   8.158515   7.3273597
  7.7850866  7.3335395  7.3803763 11.631776  14.053263  20.758907
  7.586194  11.923503   7.342316   8.303779   8.150929   8.15093
 11.07517    9.150109  14.329531   9.339517   8.55512    7.5670033
 14.262443   8.23314   11.126264  11.355597   7.628556   7.3086934
 12.310755  11.330301   7.7493515 11.783758   6.8254833 15.153761
  8.537265  14.706302  14.411124  11.395928   9.7518425  7.604112
  8.230841   7.7219157 11.528367   8.78926   14.165437   7.3735104
  8.199748   8.137392  11.64281    7.544072   7.144882  14.397493
  8.816388   8.201452   8.127374  11.330301   9.536335  14.262443
 13.948778  11.64281   11.395928   7.2389708  8.404593  11.304417
  7.2760215  9.949274  10.203333   7.1383443  7.6087117  8.201452
  8.201454  11.783758   7.329031  13.948778  11.395924  15.271741
  8.484016   7.4893894 11.275967   7.2332797 11.224423   7.463834
  8.403199   8.454085  11.275967  12.091463  14.053263  13.992587
  8.12737    7.4109783  8.977505   8.199494  11.355597  14.209127
 14.888508   8.15093    7.28862    8.618663  15.15307   11.406616
  7.550469  11.321701   7.1437025 10.106452   7.143702   8.544569
  9.848539   9.498169   7.3449693 15.179311   8.119907   8.150931
 14.073294   7.5571246 11.07517    7.391662   8.383023  13.962032
  7.2169275 14.671602   7.4053617 14.359372   8.747176   7.40819
  9.150111   9.768066  11.924762  14.620813  11.56807   11.224423
  6.885564  14.512967   7.3695955  8.151005  11.783761   9.714115
  7.189971  13.805073   8.119405   7.210436  13.80507   13.80507
 13.80507    8.080919  13.911318  13.805073  13.80507    8.392432
 13.805073  11.3512335  7.8127265  7.226417   8.67287    9.26517
 11.591073  11.870815   7.099902  11.649231   7.1005497  8.119407
  7.425802   9.41835   13.974961   8.080922   7.3110228  7.3110223
  7.4765873 11.77665   13.805073   8.119907  13.805073   8.08092
 11.668058  13.891425  13.974961  13.974961  13.805073  14.313512
 13.974961   7.2641683  7.1124554  7.2852354  8.119404  14.432413
  7.1249948  7.241897  13.805073   8.5450115  9.630942   8.53175
 14.404446  11.355597  14.18021   13.805073  13.880271  12.246477
  8.199748  11.332761  10.336581   7.1140842  8.119404  20.579702
 13.978885   8.420689   8.14454    8.285535   7.3281803  7.0808163
  7.302103   9.658949   7.200409   8.531503  13.878286  11.155024
  7.0840364 13.80507    8.119405   7.465873  11.399523   7.187509
  7.5753903  7.1223974 10.971008   8.832945   7.9390216 13.80507
  8.3415     8.350477   8.193599   8.294917   7.887267   7.887267
  7.887267  15.947231  13.7655735 16.035553  11.382646   8.267024
  7.887267  13.765573   8.220145   8.193603   7.210436  11.452702
  8.193598   6.9212985  7.887267   8.193599  13.765573   7.887267
  7.887267  14.629604  14.250602   7.887267  13.8782835 14.656584
 11.384     11.806411   8.215151  11.430044   9.53145   11.888667
 11.806411   8.418882   7.2310505  9.702605   6.9997025 11.092194
  8.0740185  7.963774   7.887267   7.887267  11.382644   6.9484143
  9.443195  13.835476  14.432371  11.151126  10.208474  14.169363
 14.314611   9.470455   7.2704377 11.654017  11.929217  11.398846
  7.2264433 13.827779  11.300172  13.764638  13.827779  11.241744
 11.430043  11.338224  14.690294   8.215151   8.179152  11.260967
 11.5420685  9.38998   11.5420685 11.260967  13.78343    8.470702
  7.4269514 11.856486  13.78343    8.179155   7.063958  10.091037
  7.1777134  8.2154255  8.470701   8.1791525 13.918622  11.2253065
 14.4104     7.8032837 14.310239  11.654017   9.52566   14.38181
 13.827779   7.6681533 15.132087  10.066519   8.4962635 13.918621
  7.270184  14.055991   8.213154  11.338224   8.168522  16.555296
 13.764637  11.225305  10.183884  14.055991  10.183884  13.856249
 13.771901   9.21606   13.882614   8.444844  11.300172  13.827779
  9.353739  11.226076  11.226076  14.314611   8.026904  14.314612
 13.882616   8.220128  14.736361   7.2947607  8.220129  11.151126
 13.882614  11.630099  13.771901   8.168521  11.644712   8.9304905
  8.22013    6.994528  14.432371  13.764637  13.764638  11.225305
  8.168523   8.210187   7.2338047  6.974898  13.764638   7.882079
 13.764638   7.882079  14.482365   8.220127  11.599768  10.487742
  7.76383   13.767559  10.9734335 13.767558  13.767558  13.767558
 13.767558  13.767558  13.767558  13.767559   8.214698  11.68741
 15.12099   13.76756   13.767558  13.767559  13.767558  13.767558
 13.767559  13.767559  13.767558  13.767558   8.262114  13.767558
 13.767558   9.321711  13.767559   9.607769  13.383694  13.764637
 14.568345   8.190623  16.962788  16.962788   6.972998  14.568345
 13.764637  13.882614  13.882614  13.764637  13.882614  14.552858
 11.831908  13.767559  11.151127  13.764637  11.226076  13.764637
 13.764638  14.305527  13.764638  13.882616  13.764637  13.764637
  8.220129  13.882614  13.764638  13.882614  13.764637  13.764637
 13.764638   6.9711695  8.213153   8.213153  13.767558  10.945749
 13.819602  13.764637  13.882614   7.158355  13.767559  13.882614
  7.0018024 14.015305  13.764637  13.764637   8.574232   7.0233846
  8.4446335 13.764637   8.214698  14.305527  13.882616   9.006724
 13.767558  13.882616   8.220125  13.767559  13.767558   8.214698
 14.305527  13.764637   9.848926   7.848367   7.2323976  7.023383
 14.435156   7.8570576  7.8570576 13.404773  14.373847  13.767559
 11.323871   8.211952   7.0233846  8.293107  13.80963   13.844723
 13.804442  13.804442  13.804442  13.804442  13.804442   8.344973
  8.609271  13.804443  13.804442  13.767559  14.28742   13.767558
  7.8570576  7.012922   7.8570576 14.2796955  7.8570576  7.2384644
  8.262113  14.292644   8.262113  13.767558   7.8570576 13.758974
 13.894551  13.894551  13.804442  13.758974   7.051056  14.29565
 13.767558  13.767558  13.804442  13.844723  13.894551  14.186548
 13.844724  14.155613   8.344972   9.7729025 14.155613   8.055444
  8.486254  13.844723  11.720526  13.793013  13.904527  13.904527
  8.033026  13.874787   7.9111795 13.844724  13.844723  13.844723
 13.97476   13.844724  13.844724  13.904527  13.844724  13.844723
 13.844723   8.54117   13.854514   7.298939   7.4549932  8.065682
 11.750716  14.117169   7.3822875 16.427471  13.985441  13.940901
 14.048117  11.283354  11.28335   13.904527   8.090868   7.6536856
 13.985434  13.9420185 14.975261   7.929108  13.970175  13.970175
 13.970175  13.961493  14.126121   9.280761  11.702108  10.252319
 14.369085  14.135465  11.670186  13.9420185 11.649964   8.592241
 14.048118  11.9816065 13.985434   7.653596  13.9420185  8.259413
 14.048117  14.267837  13.970175  13.961493  14.048118  11.615596
 11.379485  13.961493  13.961493  13.961493  11.773263   8.842373
  8.651312  13.970175   7.526965  13.961493   8.362636  11.838083
 16.813631  11.838083  13.961491  14.077146  11.838083  14.021761
 14.077146  11.838083  25.49523   14.366071   8.585129  11.838083
  8.585129  11.510239  14.586595   7.803185  14.077146  14.121857
 14.121857   7.803185  10.428945  14.077146  11.838083  14.586613
 11.838085 ]
2025-06-02 15:52:40,526 - DEBUG - Edge reconstruction errors: [  4.4643703   4.6457524  43.925518  ...  12.671867  535.2511
  12.546412 ]
2025-06-02 15:52:40,528 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155240_update_31.json
2025-06-02 15:52:40,528 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:52:40,532 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155240_update_31.pth and as latest_checkpoint.pth
2025-06-02 15:52:40,532 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870025.dot): 0.4368
2025-06-02 15:52:40,532 - WARNING - Detected 9 anomalous nodes (reconstruction-based):
2025-06-02 15:52:40,532 - WARNING -   Node ID: 192.168.27.13, Recon Error: 22.7016, MLP Score: 0.9499
2025-06-02 15:52:40,532 - WARNING -   Node ID: 192.168.27.12, Recon Error: 22.2176, MLP Score: 0.9502
2025-06-02 15:52:40,532 - WARNING -   Node ID: 192.168.27.10, Recon Error: 27.8592, MLP Score: 0.9513
2025-06-02 15:52:40,532 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 25.2922, MLP Score: 0.9686
2025-06-02 15:52:40,532 - WARNING -   Node ID: 192.168.209.130, Recon Error: 22.4229, MLP Score: 0.7671
2025-06-02 15:52:40,532 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 15:52:40,532 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2505, MLP Score: 0.0000
2025-06-02 15:52:40,532 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9537, MLP Score: 0.0000
2025-06-02 15:52:40,532 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0527, MLP Score: 0.0000
2025-06-02 15:52:40,532 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7523, MLP Score: 0.0000
2025-06-02 15:52:40,532 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7513, MLP Score: 0.0000
2025-06-02 15:52:40,547 - DEBUG - Embedding standard deviations before t-SNE: [1.2381048  0.10263354 1.294169   1.1048794  2.0338643  0.
 0.80691946 0.8596791  2.1586635  1.2751296  0.7749981  0.
 1.6974965  0.67277277 1.0784271  1.207834   0.         0.51206654
 0.         0.0881658  3.189614   0.6728669  0.         1.2285627
 0.9548414  0.94933105 0.         0.8997567  2.1027946  0.
 1.1817969  0.46913996]
2025-06-02 15:52:41,255 - INFO - Embeddings visualization saved to vis/embeddings_31_updates_20250602_155240.png
2025-06-02 15:52:41,256 - INFO - Performing visualization of node and edge features.
2025-06-02 15:52:41,257 - INFO - Starting visualization of node features.
2025-06-02 15:52:41,257 - INFO - Graph has 799 nodes and 30 features.
2025-06-02 15:52:41,257 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:52:41,257 - INFO - Calculating feature statistics:
2025-06-02 15:52:41,257 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:41,257 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:41,258 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 16, 'mean': np.float32(0.0), 'std': np.float32(0.9999999), 'min': np.float32(-2.2631247), 'max': np.float32(2.2575989)}
2025-06-02 15:52:41,258 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 16, 'mean': np.float32(3.8194717e-08), 'std': np.float32(0.9999999), 'min': np.float32(-2.1910229), 'max': np.float32(2.3384998)}
2025-06-02 15:52:41,258 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:41,258 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:41,258 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:41,258 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(-3.8194717e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.4509027), 'max': np.float32(2.2177732)}
2025-06-02 15:52:41,258 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(-3.8194717e-08), 'std': np.float32(1.0), 'min': np.float32(-1.1530161), 'max': np.float32(0.86729056)}
2025-06-02 15:52:41,258 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 4, 'mean': np.float32(2.8646037e-08), 'std': np.float32(1.0), 'min': np.float32(-9.285732), 'max': np.float32(0.11055708)}
2025-06-02 15:52:41,258 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 16, 'mean': np.float32(3.8194717e-08), 'std': np.float32(1.0), 'min': np.float32(-3.0355306), 'max': np.float32(1.4744775)}
2025-06-02 15:52:41,258 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 16, 'mean': np.float32(-1.9097358e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.4472969), 'max': np.float32(3.1356149)}
2025-06-02 15:52:41,258 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 9, 'mean': np.float32(2.2966208), 'std': np.float32(1.0010638), 'min': np.float32(0.0), 'max': np.float32(11.0)}
2025-06-02 15:52:41,259 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.9574468), 'std': np.float32(0.28860977), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:52:41,259 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.15018773), 'std': np.float32(0.37436214), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:52:41,259 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.394243), 'std': np.float32(0.566938), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:52:41,259 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 4, 'mean': np.float32(-1.9097358e-08), 'std': np.float32(1.0), 'min': np.float32(-0.11055708), 'max': np.float32(9.285733)}
2025-06-02 15:52:41,259 - INFO - - service_1: {'name': 'service_1', 'unique': 5, 'mean': np.float32(3.436796), 'std': np.float32(3.0569396), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 15:52:41,259 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.7058825), 'std': np.float32(2.923703), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:52:41,259 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.5969963), 'std': np.float32(1.5134907), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:52:41,259 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.15018773), 'std': np.float32(0.37436214), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:52:41,259 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 2, 'mean': np.float32(7.991239), 'std': np.float32(0.24748717), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:52:41,259 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(-2.3871698e-09), 'std': np.float32(1.0), 'min': np.float32(-0.13463752), 'max': np.float32(15.2332735)}
2025-06-02 15:52:41,259 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(-4.7743396e-09), 'std': np.float32(1.0), 'min': np.float32(-0.14744195), 'max': np.float32(6.78233)}
2025-06-02 15:52:41,259 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:41,260 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:41,260 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:41,260 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:41,260 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(-1.9097358e-08), 'std': np.float32(1.0), 'min': np.float32(-0.98786825), 'max': np.float32(8.7366495)}
2025-06-02 15:52:41,260 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(-5.7292073e-08), 'std': np.float32(1.0), 'min': np.float32(-1.096277), 'max': np.float32(4.459275)}
2025-06-02 15:52:41,272 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x72fd95aa10d0>
2025-06-02 15:52:41,462 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:52:41,562 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:52:41,610 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:52:43,154 - INFO - Node feature visualization saved to vis/node_features_20250602_155241.png
2025-06-02 15:52:43,154 - INFO - Finished visualization of node features.
2025-06-02 15:52:43,154 - INFO - Performing additional feature analysis:
2025-06-02 15:52:43,154 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:52:43,155 - INFO - Starting visualization of edge features.
2025-06-02 15:52:43,155 - INFO - Graph has 1718 edges and 10 edge features.
2025-06-02 15:52:43,155 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:52:43,155 - INFO - Calculating edge feature statistics:
2025-06-02 15:52:43,156 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:52:43,156 - INFO - - count: {'name': 'count', 'unique': 28, 'mean': np.float32(-4.4408583e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.04193423), 'max': np.float32(32.319332)}
2025-06-02 15:52:43,156 - INFO - - dst_port: {'name': 'dst_port', 'unique': 17, 'mean': np.float32(461.08963), 'std': np.float32(489.88022), 'min': np.float32(0.0), 'max': np.float32(8898.0)}
2025-06-02 15:52:43,156 - INFO - - protocol: {'name': 'protocol', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:43,156 - INFO - - service: {'name': 'service', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:52:43,156 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 1147, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.07043896), 'max': np.float32(30.815102)}
2025-06-02 15:52:43,156 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 1215, 'mean': np.float32(-4.4408583e-09), 'std': np.float32(1.0), 'min': np.float32(-0.06402924), 'max': np.float32(31.744682)}
2025-06-02 15:52:43,156 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 393, 'mean': np.float32(2.2204292e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.052897945), 'max': np.float32(32.174114)}
2025-06-02 15:52:43,156 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 1192, 'mean': np.float32(1.1102146e-09), 'std': np.float32(1.0), 'min': np.float32(-0.0993745), 'max': np.float32(26.157906)}
2025-06-02 15:52:43,156 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 1209, 'mean': np.float32(-4.9959654e-09), 'std': np.float32(1.0), 'min': np.float32(-0.09994788), 'max': np.float32(25.52512)}
2025-06-02 15:52:43,156 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 446, 'mean': np.float32(-1.1102146e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.065954395), 'max': np.float32(31.160322)}
2025-06-02 15:52:43,167 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x72fda458ac60>
2025-06-02 15:52:43,248 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:52:43,257 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x72fda4ee9c40>
2025-06-02 15:52:43,334 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:52:43,492 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:52:43,621 - DEBUG - Plotted boxplots of the first 8 non-constant edge features.
2025-06-02 15:52:43,636 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:52:43,642 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:52:45,152 - INFO - Edge feature visualization saved to vis/edge_features_20250602_155243.png
2025-06-02 15:52:45,152 - INFO - Finished visualization of edge features.
2025-06-02 15:52:45,152 - INFO - Performing additional edge feature analysis:
2025-06-02 15:52:45,152 - INFO - - 2 out of 10 edge features are constant.
2025-06-02 15:52:45,152 - INFO - - Highest correlation (1.00) between features: 'total_resp_ip_bytes' and 'total_resp_bytes'.
2025-06-02 15:52:45,154 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:52:45,154 - INFO - Graph has 1718 edges and 10 edge features.
2025-06-02 15:52:45,154 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:52:45,465 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_155245_summary.png
2025-06-02 15:52:45,730 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_155245_pca_3d.png
2025-06-02 15:52:45,915 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_155245_pca_variance.png
2025-06-02 15:52:45,915 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:52:45,915 - INFO - 
--- Processing file: nw_graph_encoded_1748870055.dot (Timestamp: 2025-06-02 15:14:15) ---
2025-06-02 15:52:45,915 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870055.dot
2025-06-02 15:52:45,915 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870055.dot'.
2025-06-02 15:52:45,915 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870055.dot
2025-06-02 15:52:45,930 - INFO - Parsed 805 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870055.dot'.
2025-06-02 15:52:45,947 - INFO - Parsed 1734 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870055.dot'.
2025-06-02 15:52:45,947 - INFO - Processing node updates/additions.
2025-06-02 15:52:45,952 - INFO - Processing edge updates/additions.
2025-06-02 15:52:45,963 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:52:45,964 - INFO - Finished updating NetworkX graph.
2025-06-02 15:52:45,964 - DEBUG - Updated graph - Nodes: 805, Edges: 1734
2025-06-02 15:52:45,964 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:52:45,965 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:52:45,974 - DEBUG - Initial node features tensor shape: torch.Size([805, 30])
2025-06-02 15:52:45,982 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:52:45,988 - DEBUG - Node features tensor shape after scaling: torch.Size([805, 30])
2025-06-02 15:52:45,990 - DEBUG - Edge index tensor shape: torch.Size([2, 1734])
2025-06-02 15:52:45,996 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:52:46,002 - DEBUG - Initial edge attributes tensor shape: torch.Size([1734, 10])
2025-06-02 15:52:46,004 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:52:46,004 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1734, 10])
2025-06-02 15:52:46,004 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:52:46,005 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:52:46,006 - INFO - Updated main graph to 805 nodes and 1734 edges.
2025-06-02 15:52:46,006 - INFO - Performing online update...
2025-06-02 15:52:46,006 - INFO - Starting online update for 50 steps.
2025-06-02 15:52:46,007 - DEBUG - Updated RunningStats: new_mean=0.9435158001148034, new_var=53400000000160.71, new_n=5370
2025-06-02 15:52:46,007 - DEBUG - Updated RunningStats: new_mean=0.9424112793227235, new_var=53700000000018.43, new_n=5400
2025-06-02 15:52:46,007 - DEBUG - Updated RunningStats: new_mean=44.50436507697388, new_var=17800000191230.14, new_n=1790
2025-06-02 15:52:46,007 - DEBUG - Updated RunningStats: new_mean=44.531985601460036, new_var=17900000213682.434, new_n=1800
2025-06-02 15:52:46,007 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:52:46,007 - DEBUG - Online update step: 1/50
2025-06-02 15:52:46,007 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,007 - DEBUG - Online update step: 2/50
2025-06-02 15:52:46,007 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,007 - DEBUG - Online update step: 3/50
2025-06-02 15:52:46,007 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,007 - DEBUG - Online update step: 4/50
2025-06-02 15:52:46,007 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,008 - DEBUG - Online update step: 5/50
2025-06-02 15:52:46,008 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,008 - DEBUG - Online update step: 6/50
2025-06-02 15:52:46,008 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,008 - DEBUG - Online update step: 7/50
2025-06-02 15:52:46,008 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,008 - DEBUG - Online update step: 8/50
2025-06-02 15:52:46,008 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,008 - DEBUG - Online update step: 9/50
2025-06-02 15:52:46,008 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,008 - DEBUG - Online update step: 10/50
2025-06-02 15:52:46,008 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,008 - DEBUG - Online update step: 11/50
2025-06-02 15:52:46,008 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,008 - DEBUG - Online update step: 12/50
2025-06-02 15:52:46,008 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,008 - DEBUG - Online update step: 13/50
2025-06-02 15:52:46,008 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,008 - DEBUG - Online update step: 14/50
2025-06-02 15:52:46,008 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,008 - DEBUG - Online update step: 15/50
2025-06-02 15:52:46,008 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,008 - DEBUG - Online update step: 16/50
2025-06-02 15:52:46,008 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,008 - DEBUG - Online update step: 17/50
2025-06-02 15:52:46,008 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,008 - DEBUG - Online update step: 18/50
2025-06-02 15:52:46,008 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,008 - DEBUG - Online update step: 19/50
2025-06-02 15:52:46,008 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,008 - DEBUG - Online update step: 20/50
2025-06-02 15:52:46,009 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,009 - DEBUG - Online update step: 21/50
2025-06-02 15:52:46,009 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,009 - DEBUG - Online update step: 22/50
2025-06-02 15:52:46,009 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,009 - DEBUG - Online update step: 23/50
2025-06-02 15:52:46,009 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,009 - DEBUG - Online update step: 24/50
2025-06-02 15:52:46,009 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,009 - DEBUG - Online update step: 25/50
2025-06-02 15:52:46,009 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,009 - DEBUG - Online update step: 26/50
2025-06-02 15:52:46,009 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,009 - DEBUG - Online update step: 27/50
2025-06-02 15:52:46,009 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,009 - DEBUG - Online update step: 28/50
2025-06-02 15:52:46,009 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,009 - DEBUG - Online update step: 29/50
2025-06-02 15:52:46,009 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,009 - DEBUG - Online update step: 30/50
2025-06-02 15:52:46,009 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,009 - DEBUG - Online update step: 31/50
2025-06-02 15:52:46,009 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,009 - DEBUG - Online update step: 32/50
2025-06-02 15:52:46,009 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,009 - DEBUG - Online update step: 33/50
2025-06-02 15:52:46,009 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,009 - DEBUG - Online update step: 34/50
2025-06-02 15:52:46,009 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,009 - DEBUG - Online update step: 35/50
2025-06-02 15:52:46,009 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,010 - DEBUG - Online update step: 36/50
2025-06-02 15:52:46,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,010 - DEBUG - Online update step: 37/50
2025-06-02 15:52:46,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,010 - DEBUG - Online update step: 38/50
2025-06-02 15:52:46,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,010 - DEBUG - Online update step: 39/50
2025-06-02 15:52:46,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,010 - DEBUG - Online update step: 40/50
2025-06-02 15:52:46,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,010 - DEBUG - Online update step: 41/50
2025-06-02 15:52:46,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,010 - DEBUG - Online update step: 42/50
2025-06-02 15:52:46,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,010 - DEBUG - Online update step: 43/50
2025-06-02 15:52:46,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,010 - DEBUG - Online update step: 44/50
2025-06-02 15:52:46,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,010 - DEBUG - Online update step: 45/50
2025-06-02 15:52:46,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,010 - DEBUG - Online update step: 46/50
2025-06-02 15:52:46,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,010 - DEBUG - Online update step: 47/50
2025-06-02 15:52:46,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,010 - DEBUG - Online update step: 48/50
2025-06-02 15:52:46,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,010 - DEBUG - Online update step: 49/50
2025-06-02 15:52:46,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,010 - DEBUG - Online update step: 50/50
2025-06-02 15:52:46,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:52:46,010 - WARNING - No successful steps during online update.
2025-06-02 15:52:46,011 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  5.9234428e-10 -3.9094722e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.5470804e-08
  2.0139707e-08  2.6063150e-08 -2.3693771e-09  1.8955017e-08
  2.2968943e+00  2.9577639e+00  1.4658386e-01  4.3987579e+00
 -1.8955017e-08  3.4161491e+00  5.7304349e+00  7.5925465e+00
  1.4658386e-01  7.9913044e+00  2.0732051e-08 -2.3693772e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -6.2196150e-09 -4.7387543e-09], current edge mean: [ 3.2999112e-09  4.6092273e+02  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -2.1999407e-09  4.3998813e-09 -2.7499258e-09
 -1.2374667e-09  0.0000000e+00]
2025-06-02 15:52:46,011 - DEBUG - Node drift difference: 0.0096, Edge drift difference: 0.0003
2025-06-02 15:52:46,012 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  5.9234428e-10 -3.9094722e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.5470804e-08
  2.0139707e-08  2.6063150e-08 -2.3693771e-09  1.8955017e-08
  2.2968943e+00  2.9577639e+00  1.4658386e-01  4.3987579e+00
 -1.8955017e-08  3.4161491e+00  5.7304349e+00  7.5925465e+00
  1.4658386e-01  7.9913044e+00  2.0732051e-08 -2.3693772e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -6.2196150e-09 -4.7387543e-09], edge=[ 3.2999112e-09  4.6092273e+02  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -2.1999407e-09  4.3998813e-09 -2.7499258e-09
 -1.2374667e-09  0.0000000e+00]
2025-06-02 15:52:46,013 - DEBUG - Updated reference std: node=[0.         0.         1.0006217  1.0006217  0.         0.
 0.         1.0006217  1.0006218  1.0006217  1.0006217  1.0006217
 1.0000262  0.28773427 0.3710666  0.5675718  1.0006218  3.0480378
 2.9194205  1.52196    0.3710666  0.24671759 1.0006217  1.0006217
 0.         0.         0.         0.         1.0006217  1.0006217 ], edge=[  1.0002885 487.75858     0.          0.          1.0002885   1.0002885
   1.0002885   1.0002885   1.0002885   1.0002885]
2025-06-02 15:52:46,013 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:52:46,013 - INFO - Running anomaly detection...
2025-06-02 15:52:46,013 - INFO - Starting anomaly detection.
2025-06-02 15:52:46,022 - DEBUG - Node reconstruction errors: [16.340734  13.979595  22.939419  15.571923   9.921368   8.116176
 22.463354  11.970476  11.970476  12.411896  11.970476  10.510843
 28.152252   8.598924  14.709456  15.770838  10.903333  15.780572
 17.15556   15.514969  11.745294  14.709456  12.372992  10.120512
 14.747936  12.3714285 14.747937   9.612195  11.7123785 14.747937
 10.654556   7.993875   9.332348  15.339807  12.417125  12.365549
  7.774119  15.514969  10.803495  11.725448  15.334377  14.475132
 15.514969  15.948865   8.85956    8.666129  17.522207   8.719486
 11.496266  16.198427  25.357672  12.147845  12.15785   16.747988
 11.385154  10.386378  22.457563  15.1083555 16.371033  17.023794
  7.458971  15.128167  14.272186  10.521734  14.278515  11.38516
 11.650661  11.3851385 14.272186  14.272186  11.860353   8.2717085
 11.684103   7.5926695  7.6249723  8.371854  15.676927   8.237662
  7.4655147  7.4693522 14.684337   8.406011   7.678901  10.214131
  7.6913204 10.477606   8.923433   7.7702355  7.3183208  8.831818
 14.253114   8.698942   9.455688   7.3873844 11.3723    26.239876
 14.490789   7.508601  14.072359  11.307515   8.180624  14.490786
 14.96831    8.967948   9.589128  11.131374  10.633962   7.755895
  9.555808  13.887406  14.844616  14.807025  10.454755   9.867855
  8.281356   8.49049    8.201557   8.549692   7.3094053 11.519256
 14.221783   9.752404   9.739946   9.5295515  7.1539464 11.519274
  9.333276   7.3633337  7.687708  14.662933  11.785808  11.41588
 14.9066925  9.33472    8.254342  11.181283  15.064752  13.990381
  7.7138944  9.043315  11.791994   8.766416  14.31514   11.513876
 11.682154   8.892705   8.201558  11.36851   11.355121   7.2918086
 13.170701   9.81475    7.4070992 11.41588    8.730519   8.614079
 11.402146   8.695242   8.180625  14.849004  11.682156   7.552627
 11.402146  11.785808   8.206394   8.545945   8.156054   7.3225174
  7.751716   7.3214464  7.3754654 11.616602  14.061166  20.840332
  7.5577717 12.0365305  7.3363004  8.291581   8.150173   8.150172
 11.079863   9.15712   14.332595   9.351065   8.561275   7.5293455
 14.251412   8.2338705 11.130039  11.359212   7.6715164  7.302905
 12.289544  11.341711   7.7138915 11.787718   6.8022585 15.101532
  8.547767  14.677511  14.396337  11.402146   9.751523   7.65045
  8.743908   8.119687  11.536713   8.795806  14.164555   7.3680544
  8.19747    8.137616  11.655947   7.5305686  7.12327   14.38413
  8.7899685  8.201557   8.128624  11.341711   9.544345  14.25141
 13.955942  11.655948  11.402146   7.2135205  8.408361  11.317877
  7.2749295  9.910309  10.144273   7.1336875  7.581185   8.201558
  8.201556  11.787718   7.3194914 13.955942  11.402146  15.276369
  8.479177   7.4737573 11.288786   7.210141  11.238169   7.4400454
  8.397792   8.415332  11.288784  12.049521  14.061166  14.00151
  8.128629   7.3967085  8.943386   8.202105  11.359212  14.196478
 14.842111   8.150172   7.2805614  8.620946  15.163102  11.402722
  7.5141854 11.323707   7.143484  10.125665   7.1434817  8.524885
  9.846593   9.501987   7.339534  15.171625   8.11681    8.150173
 14.069228   7.554174  11.079863   7.5497117  8.401712  13.964248
  7.2101336 14.679386   7.3670177 14.367408   8.769172   7.412355
  9.157121   9.737677  11.886719  14.61626   11.576646  11.238169
  6.8442264 14.484101   7.3556724  8.150234  11.787716   9.641044
  7.1832767 13.809765   8.114705   7.1779537 13.809765  13.809765
 13.809765   8.078749  13.910425  13.809765  13.809763   8.397878
 13.809763  11.350363   7.756067   7.225486   8.652922   9.257691
 11.602686  11.866541   7.099592  11.626745   7.1006575  8.114704
  7.38248    9.423657  13.977143   8.078747   7.308074   7.308072
  7.482053  11.773226  13.809763   8.116806  13.809763   8.078747
 11.638171  13.899578  13.977143  13.977143  13.809765  14.323336
 13.977143   7.2318244  7.1086583  7.258963   8.114701  14.436305
  7.1259356  7.2405753 13.809763   8.525011   9.631039   8.488267
 14.409495  11.359212  14.16245   13.809763  13.887214  12.208822
  8.197473  11.329963  10.339385   7.1072817  8.114703  20.647266
 13.978821   8.428004   8.141268   8.277266   7.319703   7.0747395
  7.2656612  9.642285   7.2008595  8.488026  13.883497  11.165461
  7.0735254 13.809765   8.1147     7.446278  11.397777   7.1767282
  7.5450773  7.227468  10.983045   8.804017   7.939995  13.809763
  8.342272   8.335917   8.188432   8.283749   7.8877745  7.8877745
  7.8877745 15.977977  13.766358  16.065483  11.375406   8.259667
  7.8877745 13.766359   8.213866   8.188433   7.1779523 11.4427
  8.188429   6.9203157  7.8877745  8.188429  13.766358   7.8877745
  7.8877745 14.612976  14.257966   7.8877764 13.883499  14.650924
 11.374497  11.772672   8.209676  11.421956   9.510532  11.862385
 11.772669   8.4011755  7.2351985  9.661857   6.9997706 11.086297
  8.063032   7.9643464  7.8877764  7.8877745 11.375406   6.948784
  9.430232  13.824894  14.422991  11.154108  10.273347  14.142798
 14.280121   9.460456   8.486383  11.62308   11.908883  11.382405
  7.1881876 13.826642  11.297934  13.759435  13.826642  11.215567
 11.421956  11.336579  14.692815   8.630354   8.176643  11.265884
 11.520004   9.3849    11.520004  11.265884  13.785875   8.442959
  7.4104595 11.8446045 13.785875   8.176645   7.0420313 10.095892
  7.1656713  8.209926   8.630355   8.176645  13.908787  11.229076
 14.406949   7.8114095 14.282857  11.623082   9.612261  14.369188
 13.826642   7.6203017 15.128356  10.075259   8.4754305 13.90879
  7.2441316 14.045455   8.20187   11.336579   8.162114  16.538061
 13.759435  11.229076  10.186136  14.045455  10.186133  13.850823
 13.771201   9.216314  13.87153    8.453625  11.900062  13.826643
  9.337006  11.222936  11.222936  14.280121   8.014712  14.280121
 13.87153    8.207472  14.747598   7.2854705  8.207473  11.154109
 13.87153   11.633103  13.771201   8.162112  11.641544   8.926685
  8.20747    6.992085  14.422989  13.759435  13.759435  11.229076
  8.162114   8.202928   7.2257457  6.9728146 13.759435   7.8835135
 13.759434   7.8835135 14.53364    8.20747   11.567387  10.5031595
  7.701596  13.758712  10.99835   13.758712  13.758714  13.758713
 13.758713  13.758712  13.758714  13.758712   8.205125  11.662276
 15.135123  13.758712  13.758712  13.758712  13.758713  13.758713
 13.758715  13.758713  13.758715  13.758713   8.245665  13.758713
 13.758712   9.298527  13.758713   9.572492  13.364869  13.759435
 14.561013   8.16155   16.937384  16.937384   6.9707274 14.561013
 13.759435  13.87153   13.87153   13.759435  13.871528  14.55281
 11.808599  13.758712  11.154108  13.759435  11.222933  13.759435
 13.759435  14.270083  13.759435  13.87153   13.759435  13.759435
  8.207469  13.87153   13.759435  13.87153   13.759435  13.759435
 13.759435   6.9659276  8.201872   8.201868  13.758713  10.943791
 13.799114  13.759435  13.87153    7.1307745 13.758712  13.87153
  7.4241476 13.995935  13.759435  13.759435   8.538713   7.014993
  8.412528  13.759435   8.205127  14.2700815 13.87153    8.995298
 13.758712  13.871528   8.207472  13.758712  13.758714   8.205127
 14.270083  13.759435   9.854333   7.849622   7.276331   7.014993
 14.436047   7.8507285  7.8507266 13.377519  14.362105  13.758715
 11.302647   8.170696   7.014993   8.2718525 13.801073  13.825623
 13.783362  13.783365  13.783362  13.783362  13.783362   8.318808
  8.563061  13.783362  13.783362  13.758712  14.276975  13.758712
  7.8507266  7.0047765  7.8507266 14.274725   7.8507285  7.2080894
  8.2456665 14.288079   8.245665  13.758714   7.8507285 13.751431
 13.875696  13.875697  13.783365  13.751431   7.0373445 14.283354
 13.758712  13.758712  13.783362  14.260556  13.875697  14.148468
 13.825623  14.143853   8.318806   9.881443  14.143853   8.071223
  8.450164  13.825623  11.696212  13.775229  13.877792  13.877793
  8.001373  13.846002   7.895807  13.825623  13.825623  13.825623
 13.949001  13.825623  13.825623  13.877793  13.825623  13.825623
 13.825623   8.500397  13.828552   7.2566657  7.400597   8.038143
 11.723834  14.106545   7.32993   16.405966  13.951179  13.905842
 14.037646  11.258805  11.258805  13.877793   8.0954275  7.606079
 13.951176  13.918608  14.971584   8.117875  13.948915  13.948915
 13.948915  13.943612  14.087069   9.233057  11.672544  10.231052
 14.354379  14.105134  11.644947  13.918608  11.630034   8.548294
 14.037647  11.961625  13.951175   7.6059976 13.918608   8.385625
 14.037647  14.263558  13.948915  13.943612  14.037647  11.575384
 11.35103   13.943612  13.943612  13.943612  11.734904   8.783693
  8.61406   13.948915   7.4729342 13.943612   8.31334   11.793191
 16.775936  11.793191  13.943612  14.031725  11.793191  13.991629
 14.031726  11.793191  25.501272  14.341646   8.516686  11.793191
  8.516686  11.467436  14.572268   7.7294097 14.031726  14.096969
 14.096969   7.729408  10.410111  14.031725  11.793191  14.572283
 11.793191  14.154555  14.154553  14.154553  14.096969  14.154553
 14.154555 ]
2025-06-02 15:52:46,023 - DEBUG - Edge reconstruction errors: [  4.471344    4.6541247  43.923714  ...  12.672122  535.25134
  12.54655  ]
2025-06-02 15:52:46,025 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155246_update_32.json
2025-06-02 15:52:46,025 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:52:46,029 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155246_update_32.pth and as latest_checkpoint.pth
2025-06-02 15:52:46,029 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870055.dot): 0.4363
2025-06-02 15:52:46,029 - WARNING - Detected 9 anomalous nodes (reconstruction-based):
2025-06-02 15:52:46,029 - WARNING -   Node ID: 192.168.27.13, Recon Error: 22.9394, MLP Score: 0.9510
2025-06-02 15:52:46,029 - WARNING -   Node ID: 192.168.27.12, Recon Error: 22.4634, MLP Score: 0.9513
2025-06-02 15:52:46,029 - WARNING -   Node ID: 192.168.27.10, Recon Error: 28.1523, MLP Score: 0.9527
2025-06-02 15:52:46,029 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 25.3577, MLP Score: 0.9691
2025-06-02 15:52:46,029 - WARNING -   Node ID: 192.168.209.130, Recon Error: 22.4576, MLP Score: 0.7637
2025-06-02 15:52:46,029 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 15:52:46,029 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2509, MLP Score: 0.0000
2025-06-02 15:52:46,029 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9537, MLP Score: 0.0000
2025-06-02 15:52:46,030 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0548, MLP Score: 0.0000
2025-06-02 15:52:46,030 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7526, MLP Score: 0.0000
2025-06-02 15:52:46,030 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7513, MLP Score: 0.0000
2025-06-02 15:52:46,030 - INFO - 
--- Processing file: nw_graph_encoded_1748870085.dot (Timestamp: 2025-06-02 15:14:45) ---
2025-06-02 15:52:46,030 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870085.dot
2025-06-02 15:52:46,030 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870085.dot'.
2025-06-02 15:52:46,030 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870085.dot
2025-06-02 15:52:46,055 - INFO - Parsed 818 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870085.dot'.
2025-06-02 15:52:46,078 - INFO - Parsed 1761 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870085.dot'.
2025-06-02 15:52:46,079 - INFO - Processing node updates/additions.
2025-06-02 15:52:46,084 - INFO - Processing edge updates/additions.
2025-06-02 15:52:46,097 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:52:46,098 - INFO - Finished updating NetworkX graph.
2025-06-02 15:52:46,099 - DEBUG - Updated graph - Nodes: 818, Edges: 1761
2025-06-02 15:52:46,099 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:52:46,100 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:52:46,110 - DEBUG - Initial node features tensor shape: torch.Size([818, 30])
2025-06-02 15:52:46,111 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:52:46,111 - DEBUG - Node features tensor shape after scaling: torch.Size([818, 30])
2025-06-02 15:52:46,117 - DEBUG - Edge index tensor shape: torch.Size([2, 1761])
2025-06-02 15:52:46,119 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:52:46,123 - DEBUG - Initial edge attributes tensor shape: torch.Size([1761, 10])
2025-06-02 15:52:46,125 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:52:46,125 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1761, 10])
2025-06-02 15:52:46,125 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:52:46,126 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:52:46,126 - INFO - Updated main graph to 818 nodes and 1761 edges.
2025-06-02 15:52:46,126 - INFO - Performing online update...
2025-06-02 15:52:46,127 - INFO - Starting online update for 50 steps.
2025-06-02 15:52:46,127 - DEBUG - Updated RunningStats: new_mean=0.9435937500263837, new_var=54000000000160.92, new_n=5430
2025-06-02 15:52:46,127 - DEBUG - Updated RunningStats: new_mean=0.9424955355264498, new_var=54300000000018.4, new_n=5460
2025-06-02 15:52:46,128 - DEBUG - Updated RunningStats: new_mean=44.54033178743847, new_var=18000000190815.96, new_n=1810
2025-06-02 15:52:46,128 - DEBUG - Updated RunningStats: new_mean=44.56544375066684, new_var=18100000210453.87, new_n=1820
2025-06-02 15:52:46,128 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:52:46,128 - DEBUG - Online update step: 1/50
2025-06-02 15:52:46,130 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:46,218 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:46,223 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:46,224 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:46,339 - DEBUG - Step 1: Loss=11.3150
2025-06-02 15:52:46,339 - DEBUG - Online update step: 2/50
2025-06-02 15:52:46,342 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:46,423 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:46,431 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:46,432 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:46,689 - DEBUG - Step 2: Loss=9.5153
2025-06-02 15:52:46,689 - DEBUG - Online update step: 3/50
2025-06-02 15:52:46,693 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:46,873 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:46,879 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:46,881 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:47,113 - DEBUG - Step 3: Loss=7.9989
2025-06-02 15:52:47,113 - DEBUG - Online update step: 4/50
2025-06-02 15:52:47,117 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:47,205 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:47,210 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:47,211 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:47,383 - DEBUG - Step 4: Loss=6.7727
2025-06-02 15:52:47,383 - DEBUG - Online update step: 5/50
2025-06-02 15:52:47,386 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:47,504 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:47,513 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:47,514 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:47,874 - DEBUG - Step 5: Loss=5.7439
2025-06-02 15:52:47,875 - DEBUG - Online update step: 6/50
2025-06-02 15:52:47,878 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:48,017 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:48,031 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:48,034 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:48,370 - DEBUG - Step 6: Loss=5.3055
2025-06-02 15:52:48,370 - DEBUG - Online update step: 7/50
2025-06-02 15:52:48,374 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:48,591 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:48,598 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:48,602 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:48,920 - DEBUG - Step 7: Loss=5.0463
2025-06-02 15:52:48,921 - DEBUG - Online update step: 8/50
2025-06-02 15:52:48,931 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:49,088 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:49,098 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:49,099 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:49,513 - DEBUG - Step 8: Loss=4.7907
2025-06-02 15:52:49,513 - DEBUG - Online update step: 9/50
2025-06-02 15:52:49,517 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:49,908 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:49,916 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:49,917 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:50,334 - DEBUG - Step 9: Loss=4.5061
2025-06-02 15:52:50,334 - DEBUG - Online update step: 10/50
2025-06-02 15:52:50,338 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:50,545 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:50,566 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:50,586 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:51,233 - DEBUG - Step 10: Loss=4.1872
2025-06-02 15:52:51,233 - DEBUG - Online update step: 11/50
2025-06-02 15:52:51,237 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:51,611 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:51,636 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:51,646 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:52,030 - DEBUG - Step 11: Loss=3.8419
2025-06-02 15:52:52,031 - DEBUG - Online update step: 12/50
2025-06-02 15:52:52,034 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:52,206 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:52,212 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:52,213 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:52,411 - DEBUG - Step 12: Loss=3.4876
2025-06-02 15:52:52,412 - DEBUG - Online update step: 13/50
2025-06-02 15:52:52,415 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:52,513 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:52,518 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:52,519 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:52,704 - DEBUG - Step 13: Loss=3.1387
2025-06-02 15:52:52,705 - DEBUG - Online update step: 14/50
2025-06-02 15:52:52,708 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:52,797 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:52,803 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:52,804 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:53,039 - DEBUG - Step 14: Loss=2.7924
2025-06-02 15:52:53,039 - DEBUG - Online update step: 15/50
2025-06-02 15:52:53,042 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:53,201 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:53,209 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:53,213 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:53,849 - DEBUG - Step 15: Loss=2.6328
2025-06-02 15:52:53,849 - DEBUG - Online update step: 16/50
2025-06-02 15:52:53,853 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:54,376 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:54,380 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:54,381 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:54,731 - DEBUG - Step 16: Loss=2.5693
2025-06-02 15:52:54,732 - DEBUG - Online update step: 17/50
2025-06-02 15:52:54,737 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:55,045 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:55,049 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:55,050 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:55,223 - DEBUG - Step 17: Loss=2.4587
2025-06-02 15:52:55,224 - DEBUG - Online update step: 18/50
2025-06-02 15:52:55,232 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:55,334 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:55,338 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:55,346 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:55,506 - DEBUG - Step 18: Loss=2.3166
2025-06-02 15:52:55,507 - DEBUG - Online update step: 19/50
2025-06-02 15:52:55,511 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:55,689 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:55,697 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:55,699 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:55,861 - DEBUG - Step 19: Loss=2.1584
2025-06-02 15:52:55,861 - DEBUG - Online update step: 20/50
2025-06-02 15:52:55,864 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:55,939 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:55,943 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:55,944 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:56,059 - DEBUG - Step 20: Loss=1.9901
2025-06-02 15:52:56,059 - DEBUG - Online update step: 21/50
2025-06-02 15:52:56,062 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:56,131 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:56,135 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:56,136 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:56,253 - DEBUG - Step 21: Loss=1.8524
2025-06-02 15:52:56,253 - DEBUG - Online update step: 22/50
2025-06-02 15:52:56,256 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:56,309 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:56,312 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:56,313 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:56,568 - DEBUG - Step 22: Loss=1.8722
2025-06-02 15:52:56,569 - DEBUG - Online update step: 23/50
2025-06-02 15:52:56,572 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:56,700 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:56,704 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:56,705 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:56,883 - DEBUG - Step 23: Loss=1.8683
2025-06-02 15:52:56,884 - DEBUG - Online update step: 24/50
2025-06-02 15:52:56,887 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:56,980 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:56,987 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:56,988 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:57,197 - DEBUG - Step 24: Loss=1.8268
2025-06-02 15:52:57,198 - DEBUG - Online update step: 25/50
2025-06-02 15:52:57,202 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:57,269 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:57,272 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:57,273 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:57,428 - DEBUG - Step 25: Loss=1.7493
2025-06-02 15:52:57,429 - DEBUG - Online update step: 26/50
2025-06-02 15:52:57,434 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:57,510 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:57,513 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:57,515 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:57,623 - DEBUG - Step 26: Loss=1.6400
2025-06-02 15:52:57,624 - DEBUG - Online update step: 27/50
2025-06-02 15:52:57,629 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:57,722 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:57,725 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:57,726 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:57,837 - DEBUG - Step 27: Loss=1.6111
2025-06-02 15:52:57,837 - DEBUG - Online update step: 28/50
2025-06-02 15:52:57,840 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:57,917 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:57,921 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:57,921 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:58,050 - DEBUG - Step 28: Loss=1.6131
2025-06-02 15:52:58,050 - DEBUG - Online update step: 29/50
2025-06-02 15:52:58,056 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:58,154 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:58,158 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:58,159 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:58,325 - DEBUG - Step 29: Loss=1.5791
2025-06-02 15:52:58,325 - DEBUG - Online update step: 30/50
2025-06-02 15:52:58,328 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:58,417 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:58,420 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:58,421 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:58,539 - DEBUG - Step 30: Loss=1.5129
2025-06-02 15:52:58,539 - DEBUG - Online update step: 31/50
2025-06-02 15:52:58,542 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:58,614 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:58,622 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:58,623 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:58,739 - DEBUG - Step 31: Loss=1.4456
2025-06-02 15:52:58,739 - DEBUG - Online update step: 32/50
2025-06-02 15:52:58,743 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:58,831 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:58,834 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:58,836 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:58,977 - DEBUG - Step 32: Loss=1.4626
2025-06-02 15:52:58,977 - DEBUG - Online update step: 33/50
2025-06-02 15:52:58,982 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:59,056 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:59,059 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:59,060 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:59,155 - DEBUG - Step 33: Loss=1.4634
2025-06-02 15:52:59,155 - DEBUG - Online update step: 34/50
2025-06-02 15:52:59,158 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:59,216 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:59,226 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:59,226 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:59,337 - DEBUG - Step 34: Loss=1.4352
2025-06-02 15:52:59,337 - DEBUG - Online update step: 35/50
2025-06-02 15:52:59,340 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:59,400 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:59,403 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:59,404 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:59,549 - DEBUG - Step 35: Loss=1.3921
2025-06-02 15:52:59,549 - DEBUG - Online update step: 36/50
2025-06-02 15:52:59,552 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:59,618 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:59,621 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:59,622 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:52:59,755 - DEBUG - Step 36: Loss=1.4022
2025-06-02 15:52:59,757 - DEBUG - Online update step: 37/50
2025-06-02 15:52:59,761 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:52:59,855 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:52:59,859 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:52:59,860 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:00,030 - DEBUG - Step 37: Loss=1.4024
2025-06-02 15:53:00,031 - DEBUG - Online update step: 38/50
2025-06-02 15:53:00,034 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:00,109 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:53:00,113 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:53:00,114 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:00,246 - DEBUG - Step 38: Loss=1.3628
2025-06-02 15:53:00,247 - DEBUG - Online update step: 39/50
2025-06-02 15:53:00,250 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:00,320 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:53:00,324 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:53:00,325 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:00,485 - DEBUG - Step 39: Loss=1.3365
2025-06-02 15:53:00,485 - DEBUG - Online update step: 40/50
2025-06-02 15:53:00,488 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:00,574 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:53:00,577 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:53:00,582 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:00,715 - DEBUG - Step 40: Loss=1.3426
2025-06-02 15:53:00,715 - DEBUG - Online update step: 41/50
2025-06-02 15:53:00,718 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:00,778 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:53:00,781 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:53:00,782 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:00,907 - DEBUG - Step 41: Loss=1.3225
2025-06-02 15:53:00,908 - DEBUG - Online update step: 42/50
2025-06-02 15:53:00,911 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:00,980 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:53:00,983 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:53:00,984 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:01,121 - DEBUG - Step 42: Loss=1.2819
2025-06-02 15:53:01,121 - DEBUG - Online update step: 43/50
2025-06-02 15:53:01,124 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:01,188 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:53:01,192 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:53:01,193 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:01,325 - DEBUG - Step 43: Loss=1.2795
2025-06-02 15:53:01,325 - DEBUG - Online update step: 44/50
2025-06-02 15:53:01,328 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:01,408 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:53:01,411 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:53:01,412 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:01,522 - DEBUG - Step 44: Loss=1.2723
2025-06-02 15:53:01,523 - DEBUG - Online update step: 45/50
2025-06-02 15:53:01,526 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:01,579 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:53:01,583 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:53:01,583 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:01,691 - DEBUG - Step 45: Loss=1.2382
2025-06-02 15:53:01,691 - DEBUG - Online update step: 46/50
2025-06-02 15:53:01,694 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:01,760 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:53:01,765 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:53:01,767 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:01,973 - DEBUG - Step 46: Loss=1.2366
2025-06-02 15:53:01,973 - DEBUG - Online update step: 47/50
2025-06-02 15:53:01,977 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:02,059 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:53:02,063 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:53:02,064 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:02,199 - DEBUG - Step 47: Loss=1.2306
2025-06-02 15:53:02,199 - DEBUG - Online update step: 48/50
2025-06-02 15:53:02,202 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:02,263 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:53:02,267 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:53:02,268 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:02,379 - DEBUG - Step 48: Loss=1.2016
2025-06-02 15:53:02,379 - DEBUG - Online update step: 49/50
2025-06-02 15:53:02,382 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:02,479 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:53:02,489 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:53:02,490 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:02,710 - DEBUG - Step 49: Loss=1.1981
2025-06-02 15:53:02,711 - DEBUG - Online update step: 50/50
2025-06-02 15:53:02,714 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:02,831 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:53:02,837 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:53:02,838 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:02,952 - DEBUG - Step 50: Loss=1.1901
2025-06-02 15:53:02,952 - INFO - Online update finished. Average loss: 2.7238, Learning rate: 0.001000
2025-06-02 15:53:02,953 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -1.9819637e-08  3.3227039e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  5.4795468e-08
  3.0312385e-08 -9.3268886e-09 -2.7980665e-08  0.0000000e+00
  2.3019559e+00  2.9584353e+00  1.4303179e-01  4.4034228e+00
  2.7980665e-08  3.4156480e+00  5.7371640e+00  7.5990219e+00
  1.4303179e-01  7.9914427e+00 -1.9819637e-08 -3.8327681e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -5.8293054e-10  2.4483082e-08], current edge mean: [-2.1662108e-09  4.6042645e+02  0.0000000e+00  0.0000000e+00
  1.6246581e-09 -5.4155269e-10 -2.7077636e-09  4.7385862e-10
  3.2493161e-09 -1.0831054e-09]
2025-06-02 15:53:02,953 - DEBUG - Node drift difference: 0.0096, Edge drift difference: 0.0010
2025-06-02 15:53:02,954 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -1.9819637e-08  3.3227039e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  5.4795468e-08
  3.0312385e-08 -9.3268886e-09 -2.7980665e-08  0.0000000e+00
  2.3019559e+00  2.9584353e+00  1.4303179e-01  4.4034228e+00
  2.7980665e-08  3.4156480e+00  5.7371640e+00  7.5990219e+00
  1.4303179e-01  7.9914427e+00 -1.9819637e-08 -3.8327681e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -5.8293054e-10  2.4483082e-08], edge=[-2.1662108e-09  4.6042645e+02  0.0000000e+00  0.0000000e+00
  1.6246581e-09 -5.4155269e-10 -2.7077636e-09  4.7385862e-10
  3.2493161e-09 -1.0831054e-09]
2025-06-02 15:53:02,955 - DEBUG - Updated reference std: node=[0.         0.         1.0006118  1.0006118  0.         0.
 0.         1.0006119  1.0006119  1.0006118  1.0006118  1.0006118
 1.0033096  0.28548482 0.36737394 0.5672308  1.0006118  3.0404615
 2.9175723  1.5106635  0.36737394 0.24474926 1.0006118  1.0006118
 0.         0.         0.         0.         1.0006118  1.0006118 ], edge=[  1.000284  484.1051      0.          0.          1.0002841   1.0002841
   1.0002841   1.0002841   1.0002841   1.0002841]
2025-06-02 15:53:02,955 - INFO - Online update complete. Loss: 2.7238
2025-06-02 15:53:02,955 - INFO - Running anomaly detection...
2025-06-02 15:53:02,955 - INFO - Starting anomaly detection.
2025-06-02 15:53:02,972 - DEBUG - Node reconstruction errors: [ 0.9072657   4.4048443  11.650927    0.98601204  1.7704055   0.9776899
 10.597229    0.7988335   0.7988335   0.99582064  0.7988332   1.7009796
 14.334992    1.1240896   0.7018712   1.0135583   1.798553    1.0134937
  2.576267    0.8679209   0.55407435  0.7018712   0.5771923   1.1841855
  0.65649503  0.80234325  0.65649503  2.0144823   0.7022794   0.6564948
  3.2171474   1.2689337   1.9362938   0.8391857   0.8024315   0.5220397
  1.1729317   0.8679209   1.5040629   1.2278972   0.8854303   0.5862653
  0.8679209   0.77135473  0.83120763  1.0001708   1.4800869   1.0499672
  0.619981    1.1037592   3.3342636   0.6999903   0.6975516   2.5034964
  0.43089592  1.3935568   6.185542    0.6332461   2.4598684   2.6334357
  1.2671698   0.3278899   0.48731905  1.0684298   0.49041688  0.43089885
  0.35171822  0.43088755  0.48731905  0.48731905  0.39068452  0.8337413
  0.3124389   0.9866127   1.0217545   0.8719831   0.51240367  0.7543929
  0.75117874  0.80145276  0.4984099   0.74899566  1.2482231   2.8480508
  0.85390013  1.0807788   0.70785344  0.86884284  0.8630618   1.0308969
  0.36434704  1.8380678   1.073897    0.7509045   0.27119514  4.0227957
  0.42079547  0.75202024  0.29411173  0.38280815  0.7225886   0.42079577
  0.5317183   1.0722219   1.1738218   0.3304013   1.0251842   0.8718984
  1.1141353   0.66836464  0.7851554   0.43682685  1.4525443   1.3894316
  0.73424613  0.683104    0.69919646  1.6197304   0.91143286  0.25647032
  0.27037862  1.016455    1.3214557   0.95458615  0.79245585  0.25647625
  0.982974    0.79554397  0.84107894  0.26602224  0.42336     0.2815131
  0.92694885  1.6849625   0.6813677   0.35552388  0.5004824   0.32452396
  0.87484545  1.738002    0.2484049   0.66754526  0.25210539  0.3145325
  0.2475      0.85127574  0.69919664  0.32933667  0.27797997  0.7239807
  0.85866964  1.1881884   0.71473056  0.2815131   1.6729009   1.6179711
  0.25084817  0.6880442   0.7225885   0.58483034  0.2475      0.77989405
  0.25084805  0.4233607   0.69477576  1.6353078   0.68615055  0.7216503
  0.8045394   0.72597516  0.7779621   0.25674835  0.32542357  3.7723284
  0.80965614  2.156686    0.7093074   0.6567224   0.6713474   0.67134756
  0.30328852  1.110735    0.33360392  1.3650659   1.8950763   0.83830154
  0.2075431   0.69007415  0.32658452  0.22374234  0.88617593  0.8923614
  0.36069843  0.28491995  0.8748447   0.37483332  1.1591791   0.2776732
  1.6358658   0.25577065  0.2779571   0.25084823  1.3650593   0.88844514
  0.86464816  0.87852657  0.49743614  2.059726    0.2697286   0.69244456
  0.6504482   0.6740437   0.4204697   0.7343671   0.8589367   0.24118085
  0.8113444   0.6991965   0.8573355   0.28491992  1.3890896   0.20754303
  0.26713452  0.4204697   0.25084805  0.9688042   1.6059301   0.31089106
  0.7375375   1.0029079   0.9711538   0.7844344   0.8810441   0.6991965
  0.69919664  0.37483332  0.7183807   0.2671344   0.25084823  0.30406228
  1.6096997   0.7113481   0.28604227  0.91530687  0.2679114   0.8099939
  0.6621235   0.77302337  0.28604227  0.27950585  0.32542363  0.32361972
  0.85733527  0.7229245   0.79398435  0.6803103   0.22374251  0.20939685
  0.2120094   0.6713474   0.6706941   1.3129443   0.5119781   0.23750432
  0.8737261   0.24128072  0.7322566   3.1752098   0.7322563   0.64302456
  1.3773673   1.3243188   0.69287515  0.36279276  0.6450099   0.67134756
  0.2611018   0.841744    0.3032881   0.8915128   2.2475383   0.2851775
  0.69874686  0.512674    0.9067121   0.34669226  2.1075199   0.90189916
  1.110735    0.71742374  0.2710158   0.29606268  0.24578552  0.26791134
  1.1823373   0.20143978  0.70183307  0.6713182   0.37483358  1.1705347
  0.7005705   0.22456479  0.6176881   0.84935266  0.22456484  0.22456484
  0.22456484  0.634743    0.20425864  0.22456484  0.22456479  1.6963983
  0.22456484  0.21061735  0.88780296  0.7094371   1.0458565   1.0130936
  0.38551798  0.3622879   0.71884054  0.29521486  0.7810141   0.6176885
  0.81375146  1.342011    0.24181102  0.63474345  0.6836847   0.68368447
  1.0422413   0.35403335  0.22456484  0.6450098   0.22456484  0.6347434
  0.2453284   0.26610762  0.24181102  0.24181102  0.22456484  0.31511447
  0.24181102  0.8613227   0.86266106  0.84339553  0.61768806  0.32319978
  0.74752504  0.7175524   0.22456484  0.6647691   1.3509294   0.75568753
  0.28751105  0.22374234  0.18290232  0.22456484  0.26705444  2.6680937
  0.65044796  0.22217044  0.47025403  0.7564775   0.61768556  3.658921
  0.20426187  1.960051    0.63993347  0.62548757  0.6942342   0.7552965
  0.8801826   1.337854    0.6797016   0.755623    0.22487323  0.25314423
  0.76565063  0.22456484  0.61768824  0.77357215  0.22557057  0.6993668
  0.78709     0.94630706  0.3458387   1.1270398   0.6306135   0.22456484
  0.87283576  0.6218859   0.618953    0.61397946  0.6126812   0.6126812
  0.6126812   2.5493977   0.19656119  2.5427      0.21323283  0.6981692
  0.6126811   0.19656119  0.6263719   0.618951    0.9036243   0.22639094
  0.61895293  0.873203    0.6126811   0.6189527   0.19656128  0.6126811
  0.6126811   0.20010217  0.27124703  0.6126812   0.22487292  0.19660112
  0.22797157  0.23656252  0.6188387   0.22741719  1.308442    0.26988718
  0.27696985  0.69918066  0.935249    1.0072341   0.71662456  0.29360622
  0.61054885  0.6105102   0.6126812   0.6126812   0.2132328   0.7417175
  1.3011699   0.21571474  0.22532028  0.24212708  0.603837    0.16320543
  0.16766068  1.4001368   1.811229    0.25280255  0.363658    0.23879749
  0.96422255  0.18167004  0.23876347  0.18387876  0.18167001  0.33416167
  0.22741722  0.22665785  0.22604288  0.7871768   0.6234001   0.23206015
  0.23176421  1.129445    0.23176415  0.23206013  0.19612871  0.6942504
  0.8737647   0.35428828  0.19612871  0.6233997   0.84074086  1.8315614
  0.7215881   0.6186501   0.78717655  0.6234      0.17045741  0.24501279
  0.24721292  1.7452557   0.1617438   0.25280255  1.3929516   0.18318729
  0.18167004  0.8176348   0.39158297  1.8328332   0.6475497   0.17045741
  0.8022689   0.1689929   0.62524265  0.226658    0.6232503   2.587845
  0.18387875  0.24501279  0.5749719   0.16899301  0.5749719   0.21705635
  0.18200444  0.9746465   0.17490394  1.9900376   0.3018983   0.18167004
  0.9728124   0.23605353  0.23605353  0.16766068  0.6139003   0.22532038
  0.17490394  0.6113304   0.3753198   0.72028923  0.6113303   0.242127
  0.174904    0.3751978   0.18200453  0.6232503   0.36160776  0.91457355
  0.6113306   0.7611516   0.22532038  0.18387881  0.18387882  0.24501278
  0.6232504   0.61792105  0.69544286  0.7583911   0.18387882  0.60664535
  0.18387876  0.6066455   0.26081166  0.6113306   0.2594152   3.336787
  0.8897769   0.18643989  2.3765001   0.1864399   0.1864399   0.18643989
  0.18643989  0.18643995  0.18643986  0.18643989  0.6307415   0.29757994
  0.3896928   0.18643989  0.18643986  0.18643986  0.1864399   0.18643989
  0.18643995  0.18643989  0.18643986  0.1864399   0.6334902   0.18643989
  0.18643986  1.4210349   0.18643989  0.9449631   0.28506252  0.18387882
  0.38418654  0.6921888   2.1395767   2.1395767   0.75284606  0.38418654
  0.18387881  0.17490402  0.17490394  0.18387881  0.17490402  0.23220769
  0.32326338  0.1864399   0.24212691  0.18387876  0.23605353  0.18387881
  0.18387876  0.17769328  0.18387881  0.17490391  0.18387882  0.18387873
  0.6113306   0.17490402  0.18387882  0.17490394  0.18387875  0.18387876
  0.18387882  0.7280791   0.62524277  0.62524265  0.18643986  0.32337093
  0.32772025  0.18387882  0.17490394  0.83755153  0.18643995  0.17490394
  0.9305774   0.17156716  0.18387881  0.18387882  0.73159957  0.7517951
  0.6918217   0.18387882  0.6307417   0.17769334  0.17490391  0.91199404
  0.18643986  0.17490394  0.61133087  0.18643986  0.18643986  0.6307415
  0.1776934   0.18387881  0.6244532   0.6078399   0.9359898   0.7517952
  0.23860882  0.61931986  0.6193198   0.2903747   0.21030703  0.18643986
  0.25930583  0.7220691   0.7517952   0.64354813  0.18236086  0.19902232
  0.20376775  0.2037678   0.2037678   0.2037678   0.20376763  0.672487
  0.8069306   0.2037678   0.20376775  0.18643989  0.1979691   0.18643995
  0.6193198   0.7594534   0.6193197   0.23043919  0.6193198   0.87844175
  0.6334899   0.25027016  0.6334899   0.1864399   0.6193197   0.18286864
  0.1824603   0.1824603   0.20376763  0.18286864  0.8092321   0.24571148
  0.1864399   0.18643995  0.20376775  0.23302321  0.1824603   0.18879852
  0.19902238  0.21646084  0.6724866   2.0287828   0.21646084  1.773389
  0.7283026   0.19902238  0.32652596  0.19982648  0.23124266  0.23124266
  0.69091964  0.23617786  0.6467753   0.19902232  0.19902232  0.19902238
  0.19779985  0.19902238  0.19902232  0.23124266  0.19902232  0.19902232
  0.19902238  0.76676977  0.23238747  0.9473562   0.99259204  0.6974908
  0.38450745  0.2469324   0.99196637  2.961371    0.27907658  0.28017652
  0.29113147  0.49857873  0.49857873  0.23124266  1.898338    1.2555188
  0.2790763   0.28373712  0.500567    1.9744353   0.34542173  0.34542173
  0.34542173  0.34787953  0.3658531   1.182041    0.6317708   0.7701767
  0.33581945  0.33748832  0.43176633  0.28373712  0.45705655  0.9054463
  0.29113147  0.5000678   0.2790763   1.2554971   0.28373712  0.90544677
  0.3374885   0.39450243  0.34542173  0.34787968  0.2911316   0.41221496
  0.57375556  0.34787992  0.34787968  0.3478798   0.5112904   0.92314917
  4.872868    0.34542173  1.0669454   0.34787953  0.8540328   0.58342284
  3.0862427   0.58342284  0.34787953  0.42982605  0.58342284  0.34628338
  0.42982608  0.58342284  3.2566123   0.45539373  1.0000311   0.58342296
  0.9563869   0.6636757   0.5314277   1.1583962   1.0452543   0.43149725
  0.43149742  1.158396    0.9576165   0.42982614  0.5834229   0.5314276
  0.58342284  0.534917    0.534917    0.5349168   0.43149725  0.5349169
  0.5349169   0.5349169   0.5349169   0.71922076  0.5349169   0.5349169
  0.52984303  0.5912336   1.3251098   1.3251094   0.5349169   0.68242675
  0.719221    0.5349172 ]
2025-06-02 15:53:02,973 - DEBUG - Edge reconstruction errors: [  5.2539506   5.25339    44.25256   ...  13.352491  535.2529
  13.352382 ]
2025-06-02 15:53:02,975 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155302_update_33.json
2025-06-02 15:53:02,975 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:53:02,983 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155302_update_33.pth and as latest_checkpoint.pth
2025-06-02 15:53:02,984 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870085.dot): 0.7764
2025-06-02 15:53:02,984 - WARNING - Detected 15 anomalous nodes (reconstruction-based):
2025-06-02 15:53:02,984 - WARNING -   Node ID: 192.168.239.101, Recon Error: 4.4048, MLP Score: 0.4701
2025-06-02 15:53:02,984 - WARNING -   Node ID: 192.168.27.13, Recon Error: 11.6509, MLP Score: 0.4793
2025-06-02 15:53:02,984 - WARNING -   Node ID: 192.168.27.12, Recon Error: 10.5972, MLP Score: 0.4002
2025-06-02 15:53:02,984 - WARNING -   Node ID: 192.168.27.10, Recon Error: 14.3350, MLP Score: 0.3573
2025-06-02 15:53:02,984 - WARNING -   Node ID: 199.232.214.172, Recon Error: 3.2171, MLP Score: 0.4483
2025-06-02 15:53:02,984 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 15:53:02,984 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2526, MLP Score: 0.0001
2025-06-02 15:53:02,984 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9551, MLP Score: 0.0000
2025-06-02 15:53:02,984 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0562, MLP Score: 0.0000
2025-06-02 15:53:02,984 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7540, MLP Score: 0.0000
2025-06-02 15:53:02,985 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7531, MLP Score: 0.0000
2025-06-02 15:53:02,985 - INFO - 
--- Processing file: nw_graph_encoded_1748870115.dot (Timestamp: 2025-06-02 15:15:15) ---
2025-06-02 15:53:02,985 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870115.dot
2025-06-02 15:53:02,985 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870115.dot'.
2025-06-02 15:53:02,985 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870115.dot
2025-06-02 15:53:03,011 - INFO - Parsed 836 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870115.dot'.
2025-06-02 15:53:03,034 - INFO - Parsed 1786 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870115.dot'.
2025-06-02 15:53:03,035 - INFO - Processing node updates/additions.
2025-06-02 15:53:03,040 - INFO - Processing edge updates/additions.
2025-06-02 15:53:03,051 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:53:03,051 - INFO - Finished updating NetworkX graph.
2025-06-02 15:53:03,052 - DEBUG - Updated graph - Nodes: 836, Edges: 1786
2025-06-02 15:53:03,052 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:53:03,053 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:53:03,061 - DEBUG - Initial node features tensor shape: torch.Size([836, 30])
2025-06-02 15:53:03,066 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:53:03,066 - DEBUG - Node features tensor shape after scaling: torch.Size([836, 30])
2025-06-02 15:53:03,068 - DEBUG - Edge index tensor shape: torch.Size([2, 1786])
2025-06-02 15:53:03,069 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:53:03,073 - DEBUG - Initial edge attributes tensor shape: torch.Size([1786, 10])
2025-06-02 15:53:03,074 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:53:03,074 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1786, 10])
2025-06-02 15:53:03,074 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:53:03,075 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:53:03,075 - INFO - Updated main graph to 836 nodes and 1786 edges.
2025-06-02 15:53:03,075 - INFO - Performing online update...
2025-06-02 15:53:03,075 - INFO - Starting online update for 50 steps.
2025-06-02 15:53:03,076 - DEBUG - Updated RunningStats: new_mean=0.9436658259915395, new_var=54600000000161.12, new_n=5490
2025-06-02 15:53:03,076 - DEBUG - Updated RunningStats: new_mean=0.9425709650102605, new_var=54900000000018.29, new_n=5520
2025-06-02 15:53:03,076 - DEBUG - Updated RunningStats: new_mean=44.57382838675975, new_var=18200000191290.92, new_n=1830
2025-06-02 15:53:03,076 - DEBUG - Updated RunningStats: new_mean=44.597294002079046, new_var=18300000208528.816, new_n=1840
2025-06-02 15:53:03,077 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:53:03,077 - DEBUG - Online update step: 1/50
2025-06-02 15:53:03,079 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:03,138 - DEBUG - Node anomaly scores shape: torch.Size([14446, 1])
2025-06-02 15:53:03,141 - DEBUG - Edge anomaly scores shape: torch.Size([29522, 1])
2025-06-02 15:53:03,142 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:03,272 - DEBUG - Step 1: Loss=1.1642
2025-06-02 15:53:03,272 - DEBUG - Online update step: 2/50
2025-06-02 15:53:03,275 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:03,344 - DEBUG - Node anomaly scores shape: torch.Size([14493, 1])
2025-06-02 15:53:03,348 - DEBUG - Edge anomaly scores shape: torch.Size([29643, 1])
2025-06-02 15:53:03,349 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:03,507 - DEBUG - Step 2: Loss=1.1645
2025-06-02 15:53:03,507 - DEBUG - Online update step: 3/50
2025-06-02 15:53:03,510 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:03,585 - DEBUG - Node anomaly scores shape: torch.Size([14846, 1])
2025-06-02 15:53:03,588 - DEBUG - Edge anomaly scores shape: torch.Size([30495, 1])
2025-06-02 15:53:03,589 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:03,739 - DEBUG - Step 3: Loss=1.1515
2025-06-02 15:53:03,739 - DEBUG - Online update step: 4/50
2025-06-02 15:53:03,747 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:03,824 - DEBUG - Node anomaly scores shape: torch.Size([15097, 1])
2025-06-02 15:53:03,827 - DEBUG - Edge anomaly scores shape: torch.Size([30932, 1])
2025-06-02 15:53:03,828 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:03,970 - DEBUG - Step 4: Loss=1.1325
2025-06-02 15:53:03,970 - DEBUG - Online update step: 5/50
2025-06-02 15:53:03,973 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:04,048 - DEBUG - Node anomaly scores shape: torch.Size([14727, 1])
2025-06-02 15:53:04,052 - DEBUG - Edge anomaly scores shape: torch.Size([30165, 1])
2025-06-02 15:53:04,053 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:04,209 - DEBUG - Step 5: Loss=1.1313
2025-06-02 15:53:04,209 - DEBUG - Online update step: 6/50
2025-06-02 15:53:04,212 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:04,285 - DEBUG - Node anomaly scores shape: torch.Size([14431, 1])
2025-06-02 15:53:04,288 - DEBUG - Edge anomaly scores shape: torch.Size([29477, 1])
2025-06-02 15:53:04,289 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:04,412 - DEBUG - Step 6: Loss=1.1138
2025-06-02 15:53:04,412 - DEBUG - Online update step: 7/50
2025-06-02 15:53:04,416 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:04,503 - DEBUG - Node anomaly scores shape: torch.Size([15084, 1])
2025-06-02 15:53:04,508 - DEBUG - Edge anomaly scores shape: torch.Size([30912, 1])
2025-06-02 15:53:04,509 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:04,651 - DEBUG - Step 7: Loss=1.1059
2025-06-02 15:53:04,652 - DEBUG - Online update step: 8/50
2025-06-02 15:53:04,657 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:04,728 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:53:04,731 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:53:04,732 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:04,839 - DEBUG - Step 8: Loss=1.0980
2025-06-02 15:53:04,840 - DEBUG - Online update step: 9/50
2025-06-02 15:53:04,843 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:04,912 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:53:04,915 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:53:04,916 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:05,041 - DEBUG - Step 9: Loss=1.0818
2025-06-02 15:53:05,041 - DEBUG - Online update step: 10/50
2025-06-02 15:53:05,044 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:05,109 - DEBUG - Node anomaly scores shape: torch.Size([15076, 1])
2025-06-02 15:53:05,113 - DEBUG - Edge anomaly scores shape: torch.Size([30903, 1])
2025-06-02 15:53:05,114 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:05,232 - DEBUG - Step 10: Loss=1.0778
2025-06-02 15:53:05,233 - DEBUG - Online update step: 11/50
2025-06-02 15:53:05,236 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:05,294 - DEBUG - Node anomaly scores shape: torch.Size([14410, 1])
2025-06-02 15:53:05,297 - DEBUG - Edge anomaly scores shape: torch.Size([29427, 1])
2025-06-02 15:53:05,298 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:05,406 - DEBUG - Step 11: Loss=1.0637
2025-06-02 15:53:05,406 - DEBUG - Online update step: 12/50
2025-06-02 15:53:05,409 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:05,489 - DEBUG - Node anomaly scores shape: torch.Size([15076, 1])
2025-06-02 15:53:05,493 - DEBUG - Edge anomaly scores shape: torch.Size([30903, 1])
2025-06-02 15:53:05,494 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:05,602 - DEBUG - Step 12: Loss=1.0569
2025-06-02 15:53:05,603 - DEBUG - Online update step: 13/50
2025-06-02 15:53:05,606 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:05,687 - DEBUG - Node anomaly scores shape: torch.Size([15092, 1])
2025-06-02 15:53:05,695 - DEBUG - Edge anomaly scores shape: torch.Size([30927, 1])
2025-06-02 15:53:05,697 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:05,921 - DEBUG - Step 13: Loss=1.0470
2025-06-02 15:53:05,921 - DEBUG - Online update step: 14/50
2025-06-02 15:53:05,925 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:06,049 - DEBUG - Node anomaly scores shape: torch.Size([14410, 1])
2025-06-02 15:53:06,054 - DEBUG - Edge anomaly scores shape: torch.Size([29427, 1])
2025-06-02 15:53:06,055 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:06,193 - DEBUG - Step 14: Loss=1.0380
2025-06-02 15:53:06,193 - DEBUG - Online update step: 15/50
2025-06-02 15:53:06,196 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:06,270 - DEBUG - Node anomaly scores shape: torch.Size([14890, 1])
2025-06-02 15:53:06,274 - DEBUG - Edge anomaly scores shape: torch.Size([30603, 1])
2025-06-02 15:53:06,275 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:06,416 - DEBUG - Step 15: Loss=1.0308
2025-06-02 15:53:06,417 - DEBUG - Online update step: 16/50
2025-06-02 15:53:06,420 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:06,495 - DEBUG - Node anomaly scores shape: torch.Size([14423, 1])
2025-06-02 15:53:06,501 - DEBUG - Edge anomaly scores shape: torch.Size([29451, 1])
2025-06-02 15:53:06,502 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:06,624 - DEBUG - Step 16: Loss=1.0206
2025-06-02 15:53:06,625 - DEBUG - Online update step: 17/50
2025-06-02 15:53:06,628 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:06,702 - DEBUG - Node anomaly scores shape: torch.Size([15069, 1])
2025-06-02 15:53:06,705 - DEBUG - Edge anomaly scores shape: torch.Size([30892, 1])
2025-06-02 15:53:06,706 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:06,826 - DEBUG - Step 17: Loss=1.0131
2025-06-02 15:53:06,826 - DEBUG - Online update step: 18/50
2025-06-02 15:53:06,829 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:06,894 - DEBUG - Node anomaly scores shape: torch.Size([14493, 1])
2025-06-02 15:53:06,897 - DEBUG - Edge anomaly scores shape: torch.Size([29643, 1])
2025-06-02 15:53:06,898 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:07,019 - DEBUG - Step 18: Loss=1.0036
2025-06-02 15:53:07,019 - DEBUG - Online update step: 19/50
2025-06-02 15:53:07,022 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:07,092 - DEBUG - Node anomaly scores shape: torch.Size([14347, 1])
2025-06-02 15:53:07,095 - DEBUG - Edge anomaly scores shape: torch.Size([29280, 1])
2025-06-02 15:53:07,096 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:07,219 - DEBUG - Step 19: Loss=0.9959
2025-06-02 15:53:07,220 - DEBUG - Online update step: 20/50
2025-06-02 15:53:07,223 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:07,287 - DEBUG - Node anomaly scores shape: torch.Size([14754, 1])
2025-06-02 15:53:07,291 - DEBUG - Edge anomaly scores shape: torch.Size([30245, 1])
2025-06-02 15:53:07,292 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:07,421 - DEBUG - Step 20: Loss=0.9870
2025-06-02 15:53:07,422 - DEBUG - Online update step: 21/50
2025-06-02 15:53:07,425 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:07,483 - DEBUG - Node anomaly scores shape: torch.Size([14366, 1])
2025-06-02 15:53:07,487 - DEBUG - Edge anomaly scores shape: torch.Size([29331, 1])
2025-06-02 15:53:07,487 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:07,603 - DEBUG - Step 21: Loss=0.9786
2025-06-02 15:53:07,604 - DEBUG - Online update step: 22/50
2025-06-02 15:53:07,607 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:07,661 - DEBUG - Node anomaly scores shape: torch.Size([14378, 1])
2025-06-02 15:53:07,665 - DEBUG - Edge anomaly scores shape: torch.Size([29354, 1])
2025-06-02 15:53:07,666 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:07,772 - DEBUG - Step 22: Loss=0.9720
2025-06-02 15:53:07,772 - DEBUG - Online update step: 23/50
2025-06-02 15:53:07,775 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:07,836 - DEBUG - Node anomaly scores shape: torch.Size([14780, 1])
2025-06-02 15:53:07,839 - DEBUG - Edge anomaly scores shape: torch.Size([30341, 1])
2025-06-02 15:53:07,840 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:07,949 - DEBUG - Step 23: Loss=0.9619
2025-06-02 15:53:07,950 - DEBUG - Online update step: 24/50
2025-06-02 15:53:07,952 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:08,003 - DEBUG - Node anomaly scores shape: torch.Size([14453, 1])
2025-06-02 15:53:08,006 - DEBUG - Edge anomaly scores shape: torch.Size([29550, 1])
2025-06-02 15:53:08,007 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:08,111 - DEBUG - Step 24: Loss=0.9581
2025-06-02 15:53:08,111 - DEBUG - Online update step: 25/50
2025-06-02 15:53:08,114 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:08,170 - DEBUG - Node anomaly scores shape: torch.Size([14366, 1])
2025-06-02 15:53:08,173 - DEBUG - Edge anomaly scores shape: torch.Size([29331, 1])
2025-06-02 15:53:08,174 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:08,274 - DEBUG - Step 25: Loss=0.9471
2025-06-02 15:53:08,274 - DEBUG - Online update step: 26/50
2025-06-02 15:53:08,277 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:08,339 - DEBUG - Node anomaly scores shape: torch.Size([14707, 1])
2025-06-02 15:53:08,343 - DEBUG - Edge anomaly scores shape: torch.Size([30079, 1])
2025-06-02 15:53:08,344 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:08,487 - DEBUG - Step 26: Loss=0.9401
2025-06-02 15:53:08,487 - DEBUG - Online update step: 27/50
2025-06-02 15:53:08,493 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:08,554 - DEBUG - Node anomaly scores shape: torch.Size([14341, 1])
2025-06-02 15:53:08,557 - DEBUG - Edge anomaly scores shape: torch.Size([29264, 1])
2025-06-02 15:53:08,559 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:08,727 - DEBUG - Step 27: Loss=0.9341
2025-06-02 15:53:08,728 - DEBUG - Online update step: 28/50
2025-06-02 15:53:08,732 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:08,853 - DEBUG - Node anomaly scores shape: torch.Size([15084, 1])
2025-06-02 15:53:08,858 - DEBUG - Edge anomaly scores shape: torch.Size([30912, 1])
2025-06-02 15:53:08,859 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:09,007 - DEBUG - Step 28: Loss=0.9246
2025-06-02 15:53:09,007 - DEBUG - Online update step: 29/50
2025-06-02 15:53:09,010 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:09,075 - DEBUG - Node anomaly scores shape: torch.Size([15127, 1])
2025-06-02 15:53:09,078 - DEBUG - Edge anomaly scores shape: torch.Size([30972, 1])
2025-06-02 15:53:09,079 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:09,198 - DEBUG - Step 29: Loss=0.9193
2025-06-02 15:53:09,198 - DEBUG - Online update step: 30/50
2025-06-02 15:53:09,201 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:09,268 - DEBUG - Node anomaly scores shape: torch.Size([14431, 1])
2025-06-02 15:53:09,272 - DEBUG - Edge anomaly scores shape: torch.Size([29477, 1])
2025-06-02 15:53:09,273 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:09,384 - DEBUG - Step 30: Loss=0.9133
2025-06-02 15:53:09,384 - DEBUG - Online update step: 31/50
2025-06-02 15:53:09,389 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:09,455 - DEBUG - Node anomaly scores shape: torch.Size([14453, 1])
2025-06-02 15:53:09,459 - DEBUG - Edge anomaly scores shape: torch.Size([29550, 1])
2025-06-02 15:53:09,460 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:09,579 - DEBUG - Step 31: Loss=0.9062
2025-06-02 15:53:09,580 - DEBUG - Online update step: 32/50
2025-06-02 15:53:09,586 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:09,649 - DEBUG - Node anomaly scores shape: torch.Size([15017, 1])
2025-06-02 15:53:09,653 - DEBUG - Edge anomaly scores shape: torch.Size([30812, 1])
2025-06-02 15:53:09,654 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:09,794 - DEBUG - Step 32: Loss=0.9011
2025-06-02 15:53:09,795 - DEBUG - Online update step: 33/50
2025-06-02 15:53:09,799 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:09,884 - DEBUG - Node anomaly scores shape: torch.Size([14727, 1])
2025-06-02 15:53:09,887 - DEBUG - Edge anomaly scores shape: torch.Size([30165, 1])
2025-06-02 15:53:09,888 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:10,036 - DEBUG - Step 33: Loss=0.8962
2025-06-02 15:53:10,036 - DEBUG - Online update step: 34/50
2025-06-02 15:53:10,039 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:10,112 - DEBUG - Node anomaly scores shape: torch.Size([14727, 1])
2025-06-02 15:53:10,115 - DEBUG - Edge anomaly scores shape: torch.Size([30165, 1])
2025-06-02 15:53:10,117 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:10,240 - DEBUG - Step 34: Loss=0.8876
2025-06-02 15:53:10,240 - DEBUG - Online update step: 35/50
2025-06-02 15:53:10,245 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:10,314 - DEBUG - Node anomaly scores shape: torch.Size([15097, 1])
2025-06-02 15:53:10,318 - DEBUG - Edge anomaly scores shape: torch.Size([30932, 1])
2025-06-02 15:53:10,319 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:10,429 - DEBUG - Step 35: Loss=0.8803
2025-06-02 15:53:10,430 - DEBUG - Online update step: 36/50
2025-06-02 15:53:10,433 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:10,506 - DEBUG - Node anomaly scores shape: torch.Size([14969, 1])
2025-06-02 15:53:10,510 - DEBUG - Edge anomaly scores shape: torch.Size([30742, 1])
2025-06-02 15:53:10,511 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:10,638 - DEBUG - Step 36: Loss=0.8758
2025-06-02 15:53:10,638 - DEBUG - Online update step: 37/50
2025-06-02 15:53:10,641 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:10,724 - DEBUG - Node anomaly scores shape: torch.Size([15076, 1])
2025-06-02 15:53:10,729 - DEBUG - Edge anomaly scores shape: torch.Size([30903, 1])
2025-06-02 15:53:10,730 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:10,839 - DEBUG - Step 37: Loss=0.8750
2025-06-02 15:53:10,840 - DEBUG - Online update step: 38/50
2025-06-02 15:53:10,843 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:10,911 - DEBUG - Node anomaly scores shape: torch.Size([14635, 1])
2025-06-02 15:53:10,916 - DEBUG - Edge anomaly scores shape: torch.Size([29954, 1])
2025-06-02 15:53:10,917 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:11,050 - DEBUG - Step 38: Loss=0.8663
2025-06-02 15:53:11,051 - DEBUG - Online update step: 39/50
2025-06-02 15:53:11,054 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:11,122 - DEBUG - Node anomaly scores shape: torch.Size([14341, 1])
2025-06-02 15:53:11,125 - DEBUG - Edge anomaly scores shape: torch.Size([29264, 1])
2025-06-02 15:53:11,126 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:11,244 - DEBUG - Step 39: Loss=0.8595
2025-06-02 15:53:11,245 - DEBUG - Online update step: 40/50
2025-06-02 15:53:11,248 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:11,322 - DEBUG - Node anomaly scores shape: torch.Size([14453, 1])
2025-06-02 15:53:11,324 - DEBUG - Edge anomaly scores shape: torch.Size([29550, 1])
2025-06-02 15:53:11,325 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:11,418 - DEBUG - Step 40: Loss=0.8545
2025-06-02 15:53:11,418 - DEBUG - Online update step: 41/50
2025-06-02 15:53:11,421 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:11,482 - DEBUG - Node anomaly scores shape: torch.Size([14890, 1])
2025-06-02 15:53:11,485 - DEBUG - Edge anomaly scores shape: torch.Size([30603, 1])
2025-06-02 15:53:11,486 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:11,613 - DEBUG - Step 41: Loss=0.8491
2025-06-02 15:53:11,613 - DEBUG - Online update step: 42/50
2025-06-02 15:53:11,616 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:11,679 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:53:11,683 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:53:11,684 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:11,800 - DEBUG - Step 42: Loss=0.8461
2025-06-02 15:53:11,801 - DEBUG - Online update step: 43/50
2025-06-02 15:53:11,804 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:11,883 - DEBUG - Node anomaly scores shape: torch.Size([14341, 1])
2025-06-02 15:53:11,886 - DEBUG - Edge anomaly scores shape: torch.Size([29264, 1])
2025-06-02 15:53:11,887 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:12,012 - DEBUG - Step 43: Loss=0.8448
2025-06-02 15:53:12,012 - DEBUG - Online update step: 44/50
2025-06-02 15:53:12,015 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:12,086 - DEBUG - Node anomaly scores shape: torch.Size([14328, 1])
2025-06-02 15:53:12,091 - DEBUG - Edge anomaly scores shape: torch.Size([29237, 1])
2025-06-02 15:53:12,094 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:12,220 - DEBUG - Step 44: Loss=0.8417
2025-06-02 15:53:12,220 - DEBUG - Online update step: 45/50
2025-06-02 15:53:12,225 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:12,329 - DEBUG - Node anomaly scores shape: torch.Size([15127, 1])
2025-06-02 15:53:12,333 - DEBUG - Edge anomaly scores shape: torch.Size([30972, 1])
2025-06-02 15:53:12,335 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:12,499 - DEBUG - Step 45: Loss=0.8314
2025-06-02 15:53:12,500 - DEBUG - Online update step: 46/50
2025-06-02 15:53:12,503 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:12,580 - DEBUG - Node anomaly scores shape: torch.Size([14754, 1])
2025-06-02 15:53:12,584 - DEBUG - Edge anomaly scores shape: torch.Size([30245, 1])
2025-06-02 15:53:12,585 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:12,713 - DEBUG - Step 46: Loss=0.8266
2025-06-02 15:53:12,713 - DEBUG - Online update step: 47/50
2025-06-02 15:53:12,716 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:12,785 - DEBUG - Node anomaly scores shape: torch.Size([14431, 1])
2025-06-02 15:53:12,788 - DEBUG - Edge anomaly scores shape: torch.Size([29477, 1])
2025-06-02 15:53:12,793 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:12,916 - DEBUG - Step 47: Loss=0.8245
2025-06-02 15:53:12,916 - DEBUG - Online update step: 48/50
2025-06-02 15:53:12,919 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:13,003 - DEBUG - Node anomaly scores shape: torch.Size([14635, 1])
2025-06-02 15:53:13,006 - DEBUG - Edge anomaly scores shape: torch.Size([29954, 1])
2025-06-02 15:53:13,008 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:13,126 - DEBUG - Step 48: Loss=0.8256
2025-06-02 15:53:13,127 - DEBUG - Online update step: 49/50
2025-06-02 15:53:13,130 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:13,199 - DEBUG - Node anomaly scores shape: torch.Size([15084, 1])
2025-06-02 15:53:13,204 - DEBUG - Edge anomaly scores shape: torch.Size([30912, 1])
2025-06-02 15:53:13,206 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:13,457 - DEBUG - Step 49: Loss=0.8221
2025-06-02 15:53:13,457 - DEBUG - Online update step: 50/50
2025-06-02 15:53:13,460 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:13,680 - DEBUG - Node anomaly scores shape: torch.Size([15069, 1])
2025-06-02 15:53:13,684 - DEBUG - Edge anomaly scores shape: torch.Size([30892, 1])
2025-06-02 15:53:13,685 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:13,802 - DEBUG - Step 50: Loss=0.8117
2025-06-02 15:53:13,803 - INFO - Online update finished. Average loss: 0.9611, Learning rate: 0.001000
2025-06-02 15:53:13,803 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -2.4811502e-08  5.5611988e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -5.7750911e-09
  7.0727040e-08  5.5897178e-08  1.9392898e-08  1.9392898e-08
  2.2930622e+00  2.9593301e+00  1.4593302e-01  4.3971291e+00
  1.1407587e-09  3.3947368e+00  5.7643542e+00  7.6076555e+00
  1.4593302e-01  7.9916267e+00 -1.9392898e-08 -1.5400243e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.3955934e-08 -5.9319454e-08], current edge mean: [ 1.0679444e-09  4.6099832e+02  0.0000000e+00  0.0000000e+00
  2.6698610e-09  3.2038332e-09  2.1358888e-09 -2.1358888e-09
  8.5435552e-09  8.0095823e-09]
2025-06-02 15:53:13,804 - DEBUG - Node drift difference: 0.0111, Edge drift difference: 0.0012
2025-06-02 15:53:13,805 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -2.4811502e-08  5.5611988e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -5.7750911e-09
  7.0727040e-08  5.5897178e-08  1.9392898e-08  1.9392898e-08
  2.2930622e+00  2.9593301e+00  1.4593302e-01  4.3971291e+00
  1.1407587e-09  3.3947368e+00  5.7643542e+00  7.6076555e+00
  1.4593302e-01  7.9916267e+00 -1.9392898e-08 -1.5400243e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.3955934e-08 -5.9319454e-08], edge=[ 1.0679444e-09  4.6099832e+02  0.0000000e+00  0.0000000e+00
  2.6698610e-09  3.2038332e-09  2.1358888e-09 -2.1358888e-09
  8.5435552e-09  8.0095823e-09]
2025-06-02 15:53:13,805 - DEBUG - Updated reference std: node=[0.         0.         1.0005987  1.0005985  0.         0.
 0.         1.0005987  1.0005987  1.0005987  1.0005987  1.0005987
 0.99652076 0.2824555  0.36981332 0.5666934  1.0005987  3.0259826
 2.9103527  1.4954265  0.36981332 0.24210006 1.0005987  1.0005987
 0.         0.         0.         0.         1.0005987  1.0005987 ], edge=[  1.0002801 481.91306     0.          0.          1.00028     1.0002801
   1.0002801   1.00028     1.0002801   1.00028  ]
2025-06-02 15:53:13,805 - INFO - Online update complete. Loss: 0.9611
2025-06-02 15:53:13,806 - INFO - Running anomaly detection...
2025-06-02 15:53:13,806 - INFO - Starting anomaly detection.
2025-06-02 15:53:13,819 - DEBUG - Node reconstruction errors: [0.6875197  1.3338538  4.08344    0.4715983  0.93846387 0.33917138
 3.1765175  0.38307825 0.38307822 0.5079558  0.38307822 0.8329974
 5.694457   0.94594944 0.30097467 0.35651    0.89065903 0.35651007
 1.5597451  0.29416785 0.23771407 0.30097473 0.3026121  0.5454666
 0.28117222 0.35715142 0.28117213 1.1763703  0.32368946 0.28117213
 2.0420744  0.4497385  1.1175286  0.39995754 0.36327383 0.3168684
 0.41704282 0.29416785 0.8850099  0.6778695  0.44292772 0.248264
 0.29416785 0.44999084 0.95351446 0.6559831  0.6702602  0.6868998
 0.2790235  0.78068733 0.9371994  0.33270428 0.30664518 1.4526098
 0.17175303 0.67002445 1.8484668  0.19103427 1.5393556  1.672685
 0.99652207 0.20957562 0.20197406 0.54913366 0.21800251 0.17175336
 0.12367452 0.17175099 0.20197408 0.20197406 0.20600343 0.22174993
 0.11395829 0.34361893 0.3836044  0.24977325 0.3495812  0.16504034
 0.17476772 0.19837588 0.24028826 0.17430906 0.96636647 2.0096626
 0.26624092 0.5704928  0.15970694 0.28131405 0.23258893 0.30720618
 0.16827223 1.1043282  0.49432936 0.16960417 0.09488697 1.3866321
 0.20092297 0.32514343 0.1166028  0.15346237 0.14721584 0.20092303
 0.28014204 0.36690044 0.61523724 0.13820833 0.58204824 0.5806154
 0.5169416  0.69083405 0.5603802  0.21820132 0.764736   0.7345658
 0.1552241  0.1168773  0.13100001 0.9386083  0.2792263  0.09005933
 0.12600653 0.46795356 0.6551847  0.45195362 0.3629465  0.0900538
 0.476183   0.5599985  0.25924626 0.12263128 0.20053768 0.09779478
 0.72970307 0.99735373 0.1182083  0.1454036  0.26353016 0.12744567
 0.58168787 1.0744954  0.10488068 0.13667844 0.12141751 0.19518827
 0.19518836 0.28861007 0.13100022 0.19518846 0.11138299 0.28268465
 0.6824681  0.6447667  0.18352088 0.09779477 0.9246208  0.93687093
 0.08720676 0.1402387  0.14721568 0.30497357 0.09517623 0.58167475
 0.08720676 0.20053777 0.12664725 0.9370607  0.15039979 0.15224242
 0.5456644  0.32338327 0.1858791  0.09412303 0.14539866 1.1441771
 0.32298583 6.288432   0.1447245  0.10326764 0.11072971 0.11072968
 0.13309647 0.53108317 0.10300908 0.7273057  1.0805328  0.23103108
 0.09412038 0.12486003 0.1395579  0.07897463 0.2707862  0.26336363
 0.20558618 0.10534125 0.5816905  0.16488084 1.0320532  0.23138483
 0.96384376 0.12977412 0.12073608 0.08720676 0.69151425 0.28518018
 0.2460232  0.57945496 0.27328986 1.2128197  0.11070578 0.16140953
 0.09506642 0.11461465 0.18970743 0.19910146 0.24173175 0.12761088
 0.29409173 0.1310002  0.20129807 0.10534117 0.75050247 0.09412038
 0.11487047 0.18970747 0.08720676 0.30046728 0.91091216 0.12218277
 0.16280073 0.47914213 0.47960725 0.18606497 0.31617603 0.13099965
 0.13099986 0.16488096 0.15083942 0.11487047 0.08720676 0.21165554
 0.9077948  0.16893084 0.11355021 0.3668883  0.10741553 0.36688897
 0.10368741 0.18276985 0.11355021 0.13120878 0.14539866 0.14270683
 0.20129779 0.1585383  0.2031853  0.12943716 0.07897463 0.08688903
 0.15657167 0.11072976 0.1391401  0.64391214 0.13621138 0.17686275
 0.26465067 0.08452919 0.18039529 2.1686437  0.18039526 0.09977961
 0.7462398  0.67742866 0.15540592 0.24465045 0.11623276 0.11072968
 0.10683516 0.307677   0.1330963  0.2580169  1.2714863  0.11776321
 0.13711624 0.26579407 0.2707304  0.16187732 1.3074782  0.61157155
 0.5310832  0.66959023 0.11071118 0.15271457 0.11243568 0.10741553
 1.0833281  0.09787889 0.14977507 0.11072693 0.16488096 0.6202744
 0.13770218 0.07611965 0.09566911 0.24627265 0.07611968 0.07611963
 0.07611964 0.11040017 0.0688214  0.07611962 0.07611965 0.9690673
 0.07611964 0.07645194 0.5943702  0.14893459 0.30629653 0.48247924
 0.17656422 0.16499315 0.16866086 0.11834366 0.19304949 0.09566886
 0.55743295 0.69995886 0.09023184 0.11039967 0.15713519 0.15713215
 0.3156894  0.15717937 0.07611963 0.1162329  0.07611963 0.11039988
 0.16091728 0.11423644 0.09023178 0.0902318  0.07611964 0.09685612
 0.0902318  0.25910696 0.24684308 0.23474191 0.09566893 0.15215653
 0.19268064 0.14896062 0.07611965 0.10001006 0.70139885 0.15826648
 0.08497339 0.07897463 0.06715114 0.07611964 0.09894685 1.6658145
 0.09506638 0.09054802 0.35511646 0.17943539 0.09567569 1.4190823
 0.07735147 1.1238492  0.09045153 0.07698713 0.14998475 0.17330252
 0.24880873 0.65689087 0.14401793 0.15824331 0.0867877  0.11978197
 0.18269758 0.07611963 0.09566931 0.5494478  0.07937896 0.14059316
 0.54596645 0.28835428 0.16438688 0.58815414 0.09162472 0.07611964
 0.32809308 0.07122061 0.07152993 0.06512249 0.07668027 0.07668022
 0.07668027 1.6360906  0.05812185 1.6486456  0.07706431 0.17394711
 0.07668022 0.05812179 0.07813532 0.071528   0.27960816 0.07781237
 0.07152987 0.59214664 0.07668027 0.07153003 0.05812179 0.07668015
 0.07668027 0.03924453 0.07211557 0.07668027 0.08677792 0.11000392
 0.07920621 0.09941474 0.07137464 0.07995787 0.68913364 0.10984562
 0.13984033 0.16124077 0.6786047  0.48391804 0.16878995 0.13583757
 0.07325019 0.07559584 0.07668022 0.07668015 0.07706426 0.17376788
 0.6781369  0.05796001 0.14222303 0.11739575 0.34879562 0.05020839
 0.05828227 0.74173224 1.0821589  0.09054504 0.16148472 0.08782
 0.27464852 0.05033845 0.09436802 0.04491747 0.05033845 0.14760087
 0.07995781 0.0836552  0.11022436 0.17767268 0.07684653 0.0898741
 0.08140531 0.5751597  0.08140531 0.0898741  0.06571928 0.17767379
 0.5864371  0.15778702 0.06571928 0.07684465 0.22701289 1.0664002
 0.31001186 0.07075174 0.17767428 0.0768466  0.04596552 0.10352539
 0.10091335 1.0443135  0.13500065 0.09054509 0.74772656 0.07817839
 0.05033845 0.5627644  0.09403202 1.0653675  0.08782056 0.04596552
 0.19586521 0.05622613 0.07321853 0.0836552  0.07296257 1.6562713
 0.04491747 0.10352547 0.35251877 0.05622614 0.35251877 0.07157049
 0.05072946 0.48663184 0.04026993 1.2726859  0.1321563  0.05033845
 0.4798035  0.1069268  0.10692678 0.0582823  0.07169995 0.11356342
 0.04026998 0.0818928  0.19224975 0.16429968 0.08189216 0.11739577
 0.04026998 0.17505641 0.05072945 0.07296388 0.18034767 0.5026099
 0.08189265 0.1871123  0.11356346 0.04491747 0.04491747 0.10352547
 0.07296333 0.06716757 0.16261129 0.17906442 0.04491747 0.07142819
 0.04491747 0.07142819 0.12390446 0.08189318 0.10031428 2.3573534
 0.61598897 0.0365894  1.7598497  0.03658942 0.03658942 0.0365894
 0.03658942 0.03658943 0.0365894  0.03658943 0.0932717  0.11160872
 0.0950675  0.03658943 0.03658943 0.03658943 0.03658942 0.03658943
 0.03658943 0.03658943 0.0365894  0.0365894  0.08937802 0.03658943
 0.0365894  0.77923995 0.0365894  0.48149922 0.11965553 0.04491747
 0.09526751 0.2108135  1.2637851  1.2637851  0.18493633 0.09526751
 0.04491747 0.04026998 0.04026993 0.04491747 0.04026998 0.0992267
 0.11891992 0.0365894  0.11739575 0.04491747 0.1069268  0.04491747
 0.04491747 0.05598681 0.04491747 0.04026998 0.04491747 0.04491747
 0.0818929  0.04026998 0.04491747 0.04026993 0.04491747 0.04491747
 0.04491747 0.17273083 0.07321778 0.0732186  0.03658943 0.18349431
 0.10388439 0.04491747 0.04026993 0.2291148  0.03658943 0.10255212
 0.261633   0.04028876 0.04491747 0.04491747 0.11766521 0.19044481
 0.10956819 0.04491747 0.0932719  0.05598681 0.04026998 0.4897705
 0.03658942 0.13176748 0.08189412 0.03658943 0.0365894  0.09327113
 0.05598681 0.04491747 0.48529312 0.07310684 0.27916953 0.19044481
 0.13581882 0.07396201 0.07396201 0.11177991 0.07579129 0.0365894
 0.11553746 0.14167543 0.19044474 0.07797809 0.09816388 0.03947254
 0.0349753  0.0349753  0.0349753  0.03497533 0.03497533 0.10675292
 0.18391575 0.0349753  0.03497533 0.0365894  0.05840417 0.03658943
 0.07396201 0.19275685 0.07396204 0.03501102 0.073962   0.23404379
 0.08937868 0.07407616 0.0893781  0.03658943 0.07396204 0.04239821
 0.03433276 0.03433274 0.03497533 0.04239818 0.20686151 0.0370623
 0.03658943 0.03658943 0.03497533 0.06869481 0.03433278 0.04502616
 0.03947255 0.05884159 0.10675249 1.2550278  0.05884157 1.0919039
 0.11699171 0.03947254 0.12273157 0.04075205 0.04402705 0.0912127
 0.11144025 0.04010649 0.08760376 0.03947255 0.03947254 0.03947254
 0.03920365 0.03947255 0.03947255 0.04402707 0.03947254 0.03947254
 0.03947254 0.13613118 0.04563206 0.2788486  0.2946757  0.10871315
 0.13849312 0.0543225  0.2973836  1.9627728  0.05567056 0.05756284
 0.06272899 0.24568802 0.24568802 0.04402705 1.1930393  0.43632114
 0.05565327 0.05204358 0.15009268 1.2291943  0.08024078 0.08024078
 0.08024078 0.07261093 0.09434178 0.6259899  0.31043428 0.48959488
 0.10687219 0.0996656  0.164334   0.05204358 0.17234458 0.22855924
 0.06272899 0.2141663  0.05565326 0.43621972 0.05204358 0.22856493
 0.0996656  0.09348378 0.08024078 0.07261094 0.06272899 0.16870032
 0.27303895 0.07261094 0.07261093 0.07261093 0.19762912 0.23542942
 3.8587754  0.08024078 0.3532306  0.07261093 0.20323804 0.23487402
 1.9918338  0.23487414 0.07261094 0.10806207 0.24280675 0.0797563
 0.10806207 0.23487407 1.0873256  0.16600281 0.30308348 0.23487414
 0.2729863  0.31219947 0.18855758 0.41808185 0.30924943 0.11915102
 0.11915102 0.41808185 0.5931533  0.10806207 0.23487414 0.18855755
 0.23487414 0.17244013 0.17244014 0.17244004 0.14023902 0.5295098
 0.1724401  0.17244013 0.1724401  0.33329958 0.17244013 0.17244013
 0.15924335 0.3327395  0.50465864 0.5046585  0.1724401  0.27856937
 0.33329958 0.17244013 0.23905721 0.2785695  0.1724401  0.17244013
 0.8825638  0.2785695  0.17244004 0.2785695  0.29521698 0.6040742
 0.42282882 0.17244004 0.6095347  0.2785695  0.2785695  0.3327395
 0.22471374 0.27856952]
2025-06-02 15:53:13,820 - DEBUG - Edge reconstruction errors: [  5.257027    5.2560043  44.253212  ...  13.353168  535.2537
  13.353132 ]
2025-06-02 15:53:13,821 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155313_update_34.json
2025-06-02 15:53:13,822 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:53:13,831 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155313_update_34.pth and as latest_checkpoint.pth
2025-06-02 15:53:13,831 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870115.dot): 0.7087
2025-06-02 15:53:13,831 - WARNING - Detected 20 anomalous nodes (reconstruction-based):
2025-06-02 15:53:13,831 - WARNING -   Node ID: 192.168.27.13, Recon Error: 4.0834, MLP Score: 0.5040
2025-06-02 15:53:13,831 - WARNING -   Node ID: 192.168.27.12, Recon Error: 3.1765, MLP Score: 0.4840
2025-06-02 15:53:13,831 - WARNING -   Node ID: 192.168.27.10, Recon Error: 5.6945, MLP Score: 0.4707
2025-06-02 15:53:13,831 - WARNING -   Node ID: 43.132.85.151, Recon Error: 1.5597, MLP Score: 0.5352
2025-06-02 15:53:13,831 - WARNING -   Node ID: 199.232.214.172, Recon Error: 2.0421, MLP Score: 0.5092
2025-06-02 15:53:13,832 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:53:13,832 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2532, MLP Score: 0.4392
2025-06-02 15:53:13,832 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9556, MLP Score: 0.4958
2025-06-02 15:53:13,832 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0565, MLP Score: 0.4957
2025-06-02 15:53:13,832 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7545, MLP Score: 0.3556
2025-06-02 15:53:13,832 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7537, MLP Score: 0.3578
2025-06-02 15:53:13,832 - INFO - 
--- Processing file: nw_graph_encoded_1748870145.dot (Timestamp: 2025-06-02 15:15:45) ---
2025-06-02 15:53:13,832 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870145.dot
2025-06-02 15:53:13,832 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870145.dot'.
2025-06-02 15:53:13,832 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870145.dot
2025-06-02 15:53:13,860 - INFO - Parsed 845 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870145.dot'.
2025-06-02 15:53:13,884 - INFO - Parsed 1818 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870145.dot'.
2025-06-02 15:53:13,884 - INFO - Processing node updates/additions.
2025-06-02 15:53:13,890 - INFO - Processing edge updates/additions.
2025-06-02 15:53:13,901 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:53:13,902 - INFO - Finished updating NetworkX graph.
2025-06-02 15:53:13,903 - DEBUG - Updated graph - Nodes: 845, Edges: 1818
2025-06-02 15:53:13,903 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:53:13,904 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:53:13,914 - DEBUG - Initial node features tensor shape: torch.Size([845, 30])
2025-06-02 15:53:13,916 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:53:13,917 - DEBUG - Node features tensor shape after scaling: torch.Size([845, 30])
2025-06-02 15:53:13,919 - DEBUG - Edge index tensor shape: torch.Size([2, 1818])
2025-06-02 15:53:13,921 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:53:13,927 - DEBUG - Initial edge attributes tensor shape: torch.Size([1818, 10])
2025-06-02 15:53:13,929 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:53:13,929 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1818, 10])
2025-06-02 15:53:13,930 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:53:13,930 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:53:13,931 - INFO - Updated main graph to 845 nodes and 1818 edges.
2025-06-02 15:53:13,931 - INFO - Performing online update...
2025-06-02 15:53:13,932 - INFO - Starting online update for 50 steps.
2025-06-02 15:53:13,932 - DEBUG - Updated RunningStats: new_mean=0.9437285589771827, new_var=55200000000161.164, new_n=5550
2025-06-02 15:53:13,933 - DEBUG - Updated RunningStats: new_mean=0.9426445086773105, new_var=55500000000018.23, new_n=5580
2025-06-02 15:53:13,933 - DEBUG - Updated RunningStats: new_mean=44.60524458507374, new_var=18400000191026.23, new_n=1850
2025-06-02 15:53:13,933 - DEBUG - Updated RunningStats: new_mean=44.626000468792874, new_var=18500000204821.566, new_n=1860
2025-06-02 15:53:13,934 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:53:13,934 - DEBUG - Online update step: 1/50
2025-06-02 15:53:13,937 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:14,027 - DEBUG - Node anomaly scores shape: torch.Size([14976, 1])
2025-06-02 15:53:14,032 - DEBUG - Edge anomaly scores shape: torch.Size([30792, 1])
2025-06-02 15:53:14,033 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:14,179 - DEBUG - Step 1: Loss=0.8079
2025-06-02 15:53:14,179 - DEBUG - Online update step: 2/50
2025-06-02 15:53:14,186 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:14,312 - DEBUG - Node anomaly scores shape: torch.Size([14615, 1])
2025-06-02 15:53:14,321 - DEBUG - Edge anomaly scores shape: torch.Size([29945, 1])
2025-06-02 15:53:14,324 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:14,556 - DEBUG - Step 2: Loss=0.8049
2025-06-02 15:53:14,556 - DEBUG - Online update step: 3/50
2025-06-02 15:53:14,563 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:14,646 - DEBUG - Node anomaly scores shape: torch.Size([15099, 1])
2025-06-02 15:53:14,650 - DEBUG - Edge anomaly scores shape: torch.Size([31039, 1])
2025-06-02 15:53:14,652 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:14,780 - DEBUG - Step 3: Loss=0.8024
2025-06-02 15:53:14,780 - DEBUG - Online update step: 4/50
2025-06-02 15:53:14,785 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:14,853 - DEBUG - Node anomaly scores shape: torch.Size([14662, 1])
2025-06-02 15:53:14,857 - DEBUG - Edge anomaly scores shape: torch.Size([30011, 1])
2025-06-02 15:53:14,858 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:15,086 - DEBUG - Step 4: Loss=0.8064
2025-06-02 15:53:15,087 - DEBUG - Online update step: 5/50
2025-06-02 15:53:15,100 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:15,252 - DEBUG - Node anomaly scores shape: torch.Size([15425, 1])
2025-06-02 15:53:15,258 - DEBUG - Edge anomaly scores shape: torch.Size([31672, 1])
2025-06-02 15:53:15,260 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:15,468 - DEBUG - Step 5: Loss=0.8009
2025-06-02 15:53:15,468 - DEBUG - Online update step: 6/50
2025-06-02 15:53:15,476 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:15,566 - DEBUG - Node anomaly scores shape: torch.Size([15553, 1])
2025-06-02 15:53:15,571 - DEBUG - Edge anomaly scores shape: torch.Size([31957, 1])
2025-06-02 15:53:15,573 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:15,740 - DEBUG - Step 6: Loss=0.7925
2025-06-02 15:53:15,740 - DEBUG - Online update step: 7/50
2025-06-02 15:53:15,747 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:15,830 - DEBUG - Node anomaly scores shape: torch.Size([15221, 1])
2025-06-02 15:53:15,834 - DEBUG - Edge anomaly scores shape: torch.Size([31262, 1])
2025-06-02 15:53:15,836 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:16,023 - DEBUG - Step 7: Loss=0.7900
2025-06-02 15:53:16,024 - DEBUG - Online update step: 8/50
2025-06-02 15:53:16,031 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:16,126 - DEBUG - Node anomaly scores shape: torch.Size([15665, 1])
2025-06-02 15:53:16,131 - DEBUG - Edge anomaly scores shape: torch.Size([32326, 1])
2025-06-02 15:53:16,133 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:16,324 - DEBUG - Step 8: Loss=0.7916
2025-06-02 15:53:16,325 - DEBUG - Online update step: 9/50
2025-06-02 15:53:16,332 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:16,431 - DEBUG - Node anomaly scores shape: torch.Size([15374, 1])
2025-06-02 15:53:16,436 - DEBUG - Edge anomaly scores shape: torch.Size([31603, 1])
2025-06-02 15:53:16,438 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:16,622 - DEBUG - Step 9: Loss=0.7908
2025-06-02 15:53:16,623 - DEBUG - Online update step: 10/50
2025-06-02 15:53:16,629 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:16,738 - DEBUG - Node anomaly scores shape: torch.Size([15167, 1])
2025-06-02 15:53:16,746 - DEBUG - Edge anomaly scores shape: torch.Size([31111, 1])
2025-06-02 15:53:16,748 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:16,945 - DEBUG - Step 10: Loss=0.7819
2025-06-02 15:53:16,945 - DEBUG - Online update step: 11/50
2025-06-02 15:53:16,954 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:17,074 - DEBUG - Node anomaly scores shape: torch.Size([15063, 1])
2025-06-02 15:53:17,083 - DEBUG - Edge anomaly scores shape: torch.Size([30912, 1])
2025-06-02 15:53:17,085 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:17,459 - DEBUG - Step 11: Loss=0.7775
2025-06-02 15:53:17,461 - DEBUG - Online update step: 12/50
2025-06-02 15:53:17,480 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:17,640 - DEBUG - Node anomaly scores shape: torch.Size([14423, 1])
2025-06-02 15:53:17,647 - DEBUG - Edge anomaly scores shape: torch.Size([29451, 1])
2025-06-02 15:53:17,648 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:17,897 - DEBUG - Step 12: Loss=0.7786
2025-06-02 15:53:17,898 - DEBUG - Online update step: 13/50
2025-06-02 15:53:17,908 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:18,033 - DEBUG - Node anomaly scores shape: torch.Size([14899, 1])
2025-06-02 15:53:18,040 - DEBUG - Edge anomaly scores shape: torch.Size([30635, 1])
2025-06-02 15:53:18,041 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:18,336 - DEBUG - Step 13: Loss=0.7819
2025-06-02 15:53:18,337 - DEBUG - Online update step: 14/50
2025-06-02 15:53:18,340 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:18,531 - DEBUG - Node anomaly scores shape: torch.Size([14651, 1])
2025-06-02 15:53:18,539 - DEBUG - Edge anomaly scores shape: torch.Size([30040, 1])
2025-06-02 15:53:18,540 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:18,798 - DEBUG - Step 14: Loss=0.7723
2025-06-02 15:53:18,799 - DEBUG - Online update step: 15/50
2025-06-02 15:53:18,802 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:18,898 - DEBUG - Node anomaly scores shape: torch.Size([15418, 1])
2025-06-02 15:53:18,903 - DEBUG - Edge anomaly scores shape: torch.Size([31686, 1])
2025-06-02 15:53:18,904 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:19,117 - DEBUG - Step 15: Loss=0.7681
2025-06-02 15:53:19,117 - DEBUG - Online update step: 16/50
2025-06-02 15:53:19,121 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:19,336 - DEBUG - Node anomaly scores shape: torch.Size([14583, 1])
2025-06-02 15:53:19,392 - DEBUG - Edge anomaly scores shape: torch.Size([29847, 1])
2025-06-02 15:53:19,393 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:19,666 - DEBUG - Step 16: Loss=0.7722
2025-06-02 15:53:19,666 - DEBUG - Online update step: 17/50
2025-06-02 15:53:19,670 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:19,843 - DEBUG - Node anomaly scores shape: torch.Size([15852, 1])
2025-06-02 15:53:19,851 - DEBUG - Edge anomaly scores shape: torch.Size([32624, 1])
2025-06-02 15:53:19,852 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:20,246 - DEBUG - Step 17: Loss=0.7699
2025-06-02 15:53:20,246 - DEBUG - Online update step: 18/50
2025-06-02 15:53:20,249 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:20,537 - DEBUG - Node anomaly scores shape: torch.Size([14946, 1])
2025-06-02 15:53:20,557 - DEBUG - Edge anomaly scores shape: torch.Size([30708, 1])
2025-06-02 15:53:20,565 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:20,894 - DEBUG - Step 18: Loss=0.7537
2025-06-02 15:53:20,894 - DEBUG - Online update step: 19/50
2025-06-02 15:53:20,898 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:21,168 - DEBUG - Node anomaly scores shape: torch.Size([14499, 1])
2025-06-02 15:53:21,180 - DEBUG - Edge anomaly scores shape: torch.Size([29650, 1])
2025-06-02 15:53:21,181 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:21,481 - DEBUG - Step 19: Loss=0.7535
2025-06-02 15:53:21,481 - DEBUG - Online update step: 20/50
2025-06-02 15:53:21,485 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:21,600 - DEBUG - Node anomaly scores shape: torch.Size([15122, 1])
2025-06-02 15:53:21,605 - DEBUG - Edge anomaly scores shape: torch.Size([31003, 1])
2025-06-02 15:53:21,606 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:21,802 - DEBUG - Step 20: Loss=0.7524
2025-06-02 15:53:21,802 - DEBUG - Online update step: 21/50
2025-06-02 15:53:21,805 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:21,932 - DEBUG - Node anomaly scores shape: torch.Size([14829, 1])
2025-06-02 15:53:21,939 - DEBUG - Edge anomaly scores shape: torch.Size([30350, 1])
2025-06-02 15:53:21,942 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:22,162 - DEBUG - Step 21: Loss=0.7581
2025-06-02 15:53:22,163 - DEBUG - Online update step: 22/50
2025-06-02 15:53:22,172 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:22,282 - DEBUG - Node anomaly scores shape: torch.Size([14523, 1])
2025-06-02 15:53:22,287 - DEBUG - Edge anomaly scores shape: torch.Size([29696, 1])
2025-06-02 15:53:22,290 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:22,513 - DEBUG - Step 22: Loss=0.7511
2025-06-02 15:53:22,514 - DEBUG - Online update step: 23/50
2025-06-02 15:53:22,523 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:22,632 - DEBUG - Node anomaly scores shape: torch.Size([15100, 1])
2025-06-02 15:53:22,636 - DEBUG - Edge anomaly scores shape: torch.Size([31011, 1])
2025-06-02 15:53:22,639 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:22,817 - DEBUG - Step 23: Loss=0.7432
2025-06-02 15:53:22,817 - DEBUG - Online update step: 24/50
2025-06-02 15:53:22,823 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:22,942 - DEBUG - Node anomaly scores shape: torch.Size([15562, 1])
2025-06-02 15:53:22,947 - DEBUG - Edge anomaly scores shape: torch.Size([32127, 1])
2025-06-02 15:53:22,950 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:23,177 - DEBUG - Step 24: Loss=0.7401
2025-06-02 15:53:23,178 - DEBUG - Online update step: 25/50
2025-06-02 15:53:23,182 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:23,303 - DEBUG - Node anomaly scores shape: torch.Size([14930, 1])
2025-06-02 15:53:23,308 - DEBUG - Edge anomaly scores shape: torch.Size([30687, 1])
2025-06-02 15:53:23,309 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:23,582 - DEBUG - Step 25: Loss=0.7573
2025-06-02 15:53:23,583 - DEBUG - Online update step: 26/50
2025-06-02 15:53:23,592 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:23,701 - DEBUG - Node anomaly scores shape: torch.Size([14734, 1])
2025-06-02 15:53:23,706 - DEBUG - Edge anomaly scores shape: torch.Size([30136, 1])
2025-06-02 15:53:23,708 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:23,931 - DEBUG - Step 26: Loss=0.7444
2025-06-02 15:53:23,932 - DEBUG - Online update step: 27/50
2025-06-02 15:53:23,946 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:24,195 - DEBUG - Node anomaly scores shape: torch.Size([15123, 1])
2025-06-02 15:53:24,203 - DEBUG - Edge anomaly scores shape: torch.Size([30985, 1])
2025-06-02 15:53:24,206 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:24,492 - DEBUG - Step 27: Loss=0.7424
2025-06-02 15:53:24,493 - DEBUG - Online update step: 28/50
2025-06-02 15:53:24,496 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:24,643 - DEBUG - Node anomaly scores shape: torch.Size([15296, 1])
2025-06-02 15:53:24,648 - DEBUG - Edge anomaly scores shape: torch.Size([31502, 1])
2025-06-02 15:53:24,649 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:24,864 - DEBUG - Step 28: Loss=0.7437
2025-06-02 15:53:24,864 - DEBUG - Online update step: 29/50
2025-06-02 15:53:24,874 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:24,990 - DEBUG - Node anomaly scores shape: torch.Size([15078, 1])
2025-06-02 15:53:24,996 - DEBUG - Edge anomaly scores shape: torch.Size([30924, 1])
2025-06-02 15:53:24,999 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:25,197 - DEBUG - Step 29: Loss=0.7518
2025-06-02 15:53:25,197 - DEBUG - Online update step: 30/50
2025-06-02 15:53:25,200 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:25,304 - DEBUG - Node anomaly scores shape: torch.Size([14852, 1])
2025-06-02 15:53:25,309 - DEBUG - Edge anomaly scores shape: torch.Size([30421, 1])
2025-06-02 15:53:25,311 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:25,513 - DEBUG - Step 30: Loss=0.7351
2025-06-02 15:53:25,514 - DEBUG - Online update step: 31/50
2025-06-02 15:53:25,516 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:25,637 - DEBUG - Node anomaly scores shape: torch.Size([14800, 1])
2025-06-02 15:53:25,641 - DEBUG - Edge anomaly scores shape: torch.Size([30345, 1])
2025-06-02 15:53:25,642 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:25,843 - DEBUG - Step 31: Loss=0.7462
2025-06-02 15:53:25,844 - DEBUG - Online update step: 32/50
2025-06-02 15:53:25,848 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:26,012 - DEBUG - Node anomaly scores shape: torch.Size([14621, 1])
2025-06-02 15:53:26,026 - DEBUG - Edge anomaly scores shape: torch.Size([29957, 1])
2025-06-02 15:53:26,027 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:26,330 - DEBUG - Step 32: Loss=0.7408
2025-06-02 15:53:26,330 - DEBUG - Online update step: 33/50
2025-06-02 15:53:26,334 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:26,528 - DEBUG - Node anomaly scores shape: torch.Size([15103, 1])
2025-06-02 15:53:26,543 - DEBUG - Edge anomaly scores shape: torch.Size([30960, 1])
2025-06-02 15:53:26,548 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:26,871 - DEBUG - Step 33: Loss=0.7299
2025-06-02 15:53:26,872 - DEBUG - Online update step: 34/50
2025-06-02 15:53:26,883 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:27,044 - DEBUG - Node anomaly scores shape: torch.Size([15910, 1])
2025-06-02 15:53:27,050 - DEBUG - Edge anomaly scores shape: torch.Size([32704, 1])
2025-06-02 15:53:27,051 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:27,292 - DEBUG - Step 34: Loss=0.7272
2025-06-02 15:53:27,292 - DEBUG - Online update step: 35/50
2025-06-02 15:53:27,295 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:27,403 - DEBUG - Node anomaly scores shape: torch.Size([14393, 1])
2025-06-02 15:53:27,409 - DEBUG - Edge anomaly scores shape: torch.Size([29388, 1])
2025-06-02 15:53:27,410 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:27,937 - DEBUG - Step 35: Loss=0.7317
2025-06-02 15:53:27,938 - DEBUG - Online update step: 36/50
2025-06-02 15:53:27,941 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:28,075 - DEBUG - Node anomaly scores shape: torch.Size([15122, 1])
2025-06-02 15:53:28,082 - DEBUG - Edge anomaly scores shape: torch.Size([31016, 1])
2025-06-02 15:53:28,083 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:28,270 - DEBUG - Step 36: Loss=0.7398
2025-06-02 15:53:28,271 - DEBUG - Online update step: 37/50
2025-06-02 15:53:28,274 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:28,401 - DEBUG - Node anomaly scores shape: torch.Size([14384, 1])
2025-06-02 15:53:28,417 - DEBUG - Edge anomaly scores shape: torch.Size([29379, 1])
2025-06-02 15:53:28,424 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:28,645 - DEBUG - Step 37: Loss=0.7239
2025-06-02 15:53:28,645 - DEBUG - Online update step: 38/50
2025-06-02 15:53:28,648 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:28,752 - DEBUG - Node anomaly scores shape: torch.Size([14481, 1])
2025-06-02 15:53:28,759 - DEBUG - Edge anomaly scores shape: torch.Size([29590, 1])
2025-06-02 15:53:28,761 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:28,995 - DEBUG - Step 38: Loss=0.7278
2025-06-02 15:53:28,996 - DEBUG - Online update step: 39/50
2025-06-02 15:53:29,000 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:29,210 - DEBUG - Node anomaly scores shape: torch.Size([14899, 1])
2025-06-02 15:53:29,219 - DEBUG - Edge anomaly scores shape: torch.Size([30542, 1])
2025-06-02 15:53:29,232 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:29,475 - DEBUG - Step 39: Loss=0.7382
2025-06-02 15:53:29,476 - DEBUG - Online update step: 40/50
2025-06-02 15:53:29,479 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:29,624 - DEBUG - Node anomaly scores shape: torch.Size([14419, 1])
2025-06-02 15:53:29,634 - DEBUG - Edge anomaly scores shape: torch.Size([29459, 1])
2025-06-02 15:53:29,636 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:29,848 - DEBUG - Step 40: Loss=0.7202
2025-06-02 15:53:29,848 - DEBUG - Online update step: 41/50
2025-06-02 15:53:29,851 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:29,974 - DEBUG - Node anomaly scores shape: torch.Size([15548, 1])
2025-06-02 15:53:29,980 - DEBUG - Edge anomaly scores shape: torch.Size([32053, 1])
2025-06-02 15:53:29,981 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:30,266 - DEBUG - Step 41: Loss=0.7467
2025-06-02 15:53:30,267 - DEBUG - Online update step: 42/50
2025-06-02 15:53:30,270 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:30,376 - DEBUG - Node anomaly scores shape: torch.Size([14969, 1])
2025-06-02 15:53:30,381 - DEBUG - Edge anomaly scores shape: torch.Size([30742, 1])
2025-06-02 15:53:30,382 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:30,573 - DEBUG - Step 42: Loss=0.7321
2025-06-02 15:53:30,574 - DEBUG - Online update step: 43/50
2025-06-02 15:53:30,578 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:30,700 - DEBUG - Node anomaly scores shape: torch.Size([14747, 1])
2025-06-02 15:53:30,710 - DEBUG - Edge anomaly scores shape: torch.Size([30163, 1])
2025-06-02 15:53:30,714 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:31,026 - DEBUG - Step 43: Loss=0.7531
2025-06-02 15:53:31,026 - DEBUG - Online update step: 44/50
2025-06-02 15:53:31,029 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:31,163 - DEBUG - Node anomaly scores shape: torch.Size([14366, 1])
2025-06-02 15:53:31,170 - DEBUG - Edge anomaly scores shape: torch.Size([29331, 1])
2025-06-02 15:53:31,172 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:31,389 - DEBUG - Step 44: Loss=0.7606
2025-06-02 15:53:31,389 - DEBUG - Online update step: 45/50
2025-06-02 15:53:31,392 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:31,491 - DEBUG - Node anomaly scores shape: torch.Size([15889, 1])
2025-06-02 15:53:31,496 - DEBUG - Edge anomaly scores shape: torch.Size([32676, 1])
2025-06-02 15:53:31,498 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:31,764 - DEBUG - Step 45: Loss=0.7131
2025-06-02 15:53:31,764 - DEBUG - Online update step: 46/50
2025-06-02 15:53:31,769 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:31,910 - DEBUG - Node anomaly scores shape: torch.Size([15495, 1])
2025-06-02 15:53:31,918 - DEBUG - Edge anomaly scores shape: torch.Size([31877, 1])
2025-06-02 15:53:31,920 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:32,255 - DEBUG - Step 46: Loss=0.7653
2025-06-02 15:53:32,255 - DEBUG - Online update step: 47/50
2025-06-02 15:53:32,258 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:32,338 - DEBUG - Node anomaly scores shape: torch.Size([15162, 1])
2025-06-02 15:53:32,343 - DEBUG - Edge anomaly scores shape: torch.Size([31083, 1])
2025-06-02 15:53:32,345 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:32,513 - DEBUG - Step 47: Loss=0.7702
2025-06-02 15:53:32,513 - DEBUG - Online update step: 48/50
2025-06-02 15:53:32,516 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:32,607 - DEBUG - Node anomaly scores shape: torch.Size([15209, 1])
2025-06-02 15:53:32,610 - DEBUG - Edge anomaly scores shape: torch.Size([31275, 1])
2025-06-02 15:53:32,611 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:32,790 - DEBUG - Step 48: Loss=0.7189
2025-06-02 15:53:32,791 - DEBUG - Online update step: 49/50
2025-06-02 15:53:32,798 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:32,874 - DEBUG - Node anomaly scores shape: torch.Size([15257, 1])
2025-06-02 15:53:32,878 - DEBUG - Edge anomaly scores shape: torch.Size([31269, 1])
2025-06-02 15:53:32,879 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:33,058 - DEBUG - Step 49: Loss=0.7719
2025-06-02 15:53:33,058 - DEBUG - Online update step: 50/50
2025-06-02 15:53:33,062 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:33,150 - DEBUG - Node anomaly scores shape: torch.Size([15207, 1])
2025-06-02 15:53:33,154 - DEBUG - Edge anomaly scores shape: torch.Size([31186, 1])
2025-06-02 15:53:33,155 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:33,314 - DEBUG - Step 50: Loss=0.8008
2025-06-02 15:53:33,315 - INFO - Online update finished. Average loss: 0.7595, Learning rate: 0.001000
2025-06-02 15:53:33,316 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -1.5236218e-08  3.9783455e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.6929130e-09
 -9.0288692e-09  1.6929130e-08 -5.6430434e-09  3.3858261e-09
  2.2899408e+00  2.9597633e+00  1.4792900e-01  4.3940830e+00
 -9.0288692e-09  3.3775148e+00  5.7952662e+00  7.5976334e+00
  1.4792900e-01  7.9917159e+00 -5.6430434e-09  2.8497368e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -9.0288692e-09  3.1601044e-08], current edge mean: [ 4.1965866e-09  4.6068152e+02  0.0000000e+00  0.0000000e+00
 -3.1474401e-09  1.0491467e-09 -4.1965866e-09  3.1474401e-09
  3.1474401e-09  2.0982933e-09]
2025-06-02 15:53:33,316 - DEBUG - Node drift difference: 0.0106, Edge drift difference: 0.0007
2025-06-02 15:53:33,317 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -1.5236218e-08  3.9783455e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.6929130e-09
 -9.0288692e-09  1.6929130e-08 -5.6430434e-09  3.3858261e-09
  2.2899408e+00  2.9597633e+00  1.4792900e-01  4.3940830e+00
 -9.0288692e-09  3.3775148e+00  5.7952662e+00  7.5976334e+00
  1.4792900e-01  7.9917159e+00 -5.6430434e-09  2.8497368e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -9.0288692e-09  3.1601044e-08], edge=[ 4.1965866e-09  4.6068152e+02  0.0000000e+00  0.0000000e+00
 -3.1474401e-09  1.0491467e-09 -4.1965866e-09  3.1474401e-09
  3.1474401e-09  2.0982933e-09]
2025-06-02 15:53:33,318 - DEBUG - Updated reference std: node=[0.         0.         1.0005922  1.0005922  0.         0.
 0.         1.0005922  1.0005922  1.0005922  1.0005922  1.0005922
 0.9916503  0.28097653 0.3715423  0.5695371  1.0005922  3.015083
 2.9019485  1.5126619  0.3715423  0.24080732 1.0005922  1.0005922
 0.         0.         0.         0.         1.0005922  1.0005922 ], edge=[  1.0002751 477.65646     0.          0.          1.0002751   1.0002751
   1.0002751   1.0002751   1.0002751   1.0002751]
2025-06-02 15:53:33,323 - INFO - Online update complete. Loss: 0.7595
2025-06-02 15:53:33,323 - INFO - Running anomaly detection...
2025-06-02 15:53:33,324 - INFO - Starting anomaly detection.
2025-06-02 15:53:33,333 - DEBUG - Node reconstruction errors: [0.50656277 1.3615937  2.5079153  0.22450139 0.3989501  0.2116537
 1.6451874  0.14861597 0.14861594 0.2145299  0.14861597 0.30724832
 3.577949   0.61985093 0.10981812 0.10998745 0.3257846  0.11112768
 0.85354954 0.08818475 0.09369186 0.10981818 0.18367158 0.17520507
 0.10644194 0.15621494 0.10646134 0.49310926 0.13128836 0.10646132
 0.8097542  0.4278159  0.47983292 0.1938356  0.15686965 0.21143964
 0.24807207 0.08818526 0.36687285 0.37631252 0.23719597 0.09049915
 0.08818526 0.2975411  0.25419775 0.35066995 0.4013731  0.3441368
 0.11730789 0.5459855  0.8483473  0.14153214 0.14137857 0.7497775
 0.0824117  0.30479088 1.1684312  0.05306364 0.7676632  0.8306164
 0.7186913  0.13664122 0.07380659 0.174292   0.0862911  0.08241189
 0.06082007 0.0824115  0.07380806 0.07380809 0.14514884 0.16006722
 0.05685271 0.23665446 0.22821888 0.17442751 0.30959547 0.14146379
 0.08621805 0.108322   0.13008466 0.11696091 0.7353603  1.1251452
 0.14742187 0.22577801 0.14018148 0.15695709 0.14278533 0.25747332
 0.0708722  0.43631536 0.13680111 0.09064563 0.04962601 1.1821101
 0.11587376 0.17694779 0.04779241 0.07512512 0.10921828 0.11587394
 0.18217127 0.34547904 0.19990577 0.07306444 0.17584474 0.32000393
 0.14253972 0.4432489  0.4145037  0.12324459 0.3590928  0.30729312
 0.10287055 0.0805316  0.0904729  0.40631592 0.17549889 0.05026252
 0.06094595 0.10925587 0.29397747 0.15131624 0.19672155 0.05026668
 0.17427899 0.34531906 0.13950592 0.08067915 0.10105342 0.04639276
 0.4073827  0.50289    0.08168165 0.07399227 0.18298417 0.04837382
 0.47024834 0.39832002 0.16379973 0.11011718 0.0638081  0.16379973
 0.13846445 0.17427012 0.09047311 0.27193844 0.04711951 0.14777501
 0.5255543  0.23412204 0.10426834 0.04639276 0.37698936 0.37308094
 0.04652262 0.10273145 0.10921796 0.18968289 0.16379967 0.30814162
 0.04652266 0.10105342 0.09511881 0.4031779  0.1142077  0.07524887
 0.32701352 0.17248844 0.10322523 0.0552581  0.05997951 0.8020528
 0.17550059 8.184628   0.06872656 0.07552608 0.08808021 0.08808025
 0.07514431 0.18201192 0.0485518  0.33855385 0.41951135 0.11267683
 0.05160088 0.09011234 0.0758311  0.04560381 0.13806126 0.13165936
 0.15519686 0.04929888 0.47023723 0.10505586 0.7595014  0.19908693
 0.42335063 0.08564642 0.06897635 0.04652264 0.29093075 0.18767788
 0.19575849 0.30934122 0.14780313 0.4760017  0.04912605 0.08734691
 0.07673942 0.08367298 0.11385495 0.10710928 0.11998757 0.07279409
 0.14930364 0.09047335 0.18004222 0.04929893 0.31357878 0.05160085
 0.050116   0.11385495 0.04652266 0.1543493  0.3888094  0.05622139
 0.08906975 0.10481288 0.14003994 0.10559974 0.16996549 0.09047344
 0.09047351 0.1453161  0.07374325 0.050116   0.04652268 0.1829219
 0.37315878 0.08175796 0.05663835 0.19836798 0.05444888 0.19836816
 0.0701836  0.11267551 0.05663836 0.09562203 0.05997951 0.05974542
 0.18004267 0.07467495 0.12459636 0.10766362 0.04560383 0.04602448
 0.11335768 0.08808015 0.06206939 0.22217876 0.05595701 0.12998384
 0.13274154 0.05006104 0.11538279 0.84264755 0.11538164 0.06949706
 0.38082173 0.3059596  0.08070682 0.2217009  0.0924119  0.08808035
 0.05703056 0.21883564 0.07514432 0.12623815 0.5115072  0.05963625
 0.06625057 0.17123607 0.14036837 0.0950527  0.50076306 0.32751802
 0.18201195 0.24811341 0.07621637 0.09826711 0.075259   0.05444889
 0.60862434 0.06239985 0.06702624 0.08807144 0.10505581 0.20684572
 0.06580279 0.03201983 0.07608763 0.11889497 0.03201984 0.03201983
 0.03201983 0.09157015 0.03238205 0.03201983 0.03201983 0.40705693
 0.03201982 0.0470232  0.32933    0.08003803 0.24540494 0.14816944
 0.11100201 0.1101599  0.10267606 0.0852758  0.11709806 0.0760882
 0.34796134 0.3205504  0.03915529 0.12603356 0.08748098 0.08748059
 0.24904878 0.10637895 0.03201983 0.0924119  0.03201983 0.09157114
 0.10622576 0.04998464 0.0391553  0.03915537 0.03201983 0.03516306
 0.03915528 0.1313937  0.13652883 0.11989191 0.07608732 0.09068452
 0.11802839 0.07697713 0.03201983 0.06388652 0.28848654 0.09341912
 0.03204869 0.04560381 0.03936888 0.03201984 0.03913238 0.91448057
 0.07673915 0.04338    0.23063377 0.10015968 0.0760899  0.980163
 0.0372415  0.45422974 0.06797151 0.0518407  0.07032862 0.09434675
 0.12059361 0.27660447 0.12945141 0.09341323 0.03941    0.05340819
 0.09016071 0.03201983 0.07608681 0.34071872 0.04614488 0.06418054
 0.3297905  0.1403798  0.16741109 0.22872125 0.102906   0.03201983
 0.277062   0.11645517 0.05777841 0.35207942 0.08956155 0.08956151
 0.08956144 0.79723775 0.02670434 0.81047785 0.05040647 0.14643696
 0.0895615  0.02670434 0.0602792  0.05777827 0.13760723 0.05933249
 0.05777846 0.3455048  0.08956149 0.05777836 0.02670434 0.0895615
 0.08956151 0.01873769 0.02815368 0.08956145 0.03933355 0.11447729
 0.06161771 0.07205996 0.0462423  0.04965866 0.30134547 0.07907605
 0.09913638 0.12418769 0.39866492 0.12162603 0.10228062 0.08653908
 0.06338635 0.07119706 0.08956145 0.08956153 0.05040647 0.1021606
 0.29701266 0.03440503 0.0943257  0.05265488 0.23453732 0.0318165
 0.03929777 0.44952613 0.44614983 0.05971633 0.10917225 0.05112566
 0.12919347 0.02507261 0.05148835 0.0232523  0.02507261 0.09138147
 0.04965866 0.04694069 0.08251234 0.10070471 0.05626208 0.04815906
 0.05461055 0.20227297 0.05461055 0.04815908 0.03285079 0.07987355
 0.33493844 0.10638127 0.03285079 0.05626219 0.10387155 0.34256634
 0.1397623  0.04620471 0.07987361 0.05626225 0.0243886  0.05550812
 0.07346718 0.48953676 0.09623685 0.05971633 0.33064872 0.05513043
 0.02507262 0.3390962  0.05294681 0.3438658  0.05313819 0.0243886
 0.07963688 0.03123867 0.03848173 0.04694067 0.04599733 0.9306715
 0.0232523  0.05550811 0.24555069 0.03123864 0.24555066 0.04034893
 0.02717532 0.16111602 0.02355189 0.56101024 0.09233736 0.02507264
 0.13916016 0.04830739 0.04830739 0.03929777 0.06360602 0.07741609
 0.02355189 0.05769473 0.14351502 0.08478387 0.05769509 0.05265487
 0.02355189 0.11317147 0.02717532 0.04599721 0.10101061 0.23185141
 0.05769496 0.11220708 0.07741609 0.0232523  0.02325229 0.05550811
 0.04599712 0.0473661  0.08131024 0.10526583 0.02325231 0.07890604
 0.02325229 0.07890603 0.09135532 0.05769499 0.05151322 1.3976835
 0.36150262 0.02113226 0.73955667 0.02113221 0.02113221 0.02113223
 0.02113226 0.02113226 0.02113226 0.02113226 0.06414642 0.05686729
 0.05676134 0.02113226 0.02113226 0.02113226 0.02113226 0.02113226
 0.02113226 0.02113226 0.02113226 0.02113226 0.05482881 0.02113226
 0.02113226 0.34185764 0.02113226 0.16930556 0.08299559 0.02325229
 0.10049658 0.09962342 0.9994166  0.9994166  0.1129876  0.10049658
 0.02325229 0.02355189 0.02355189 0.0232523  0.02355191 0.08067541
 0.07511055 0.02113226 0.05265487 0.02325229 0.04830737 0.02325233
 0.02325244 0.09052439 0.0232523  0.02355189 0.02325229 0.02325231
 0.05769444 0.02355189 0.0232523  0.02355189 0.0232523  0.02325229
 0.02325229 0.09509258 0.09962239 0.0384817  0.02113221 0.09451148
 0.0860257  0.02325231 0.02355189 0.10543843 0.02113226 0.07372499
 0.10595647 0.02595877 0.02325231 0.0232523  0.04477513 0.10905089
 0.04310086 0.0232523  0.06414654 0.03965415 0.02355191 0.21683554
 0.02113226 0.09098233 0.09442987 0.02113226 0.02113226 0.0641455
 0.03965414 0.02325229 0.3193094  0.07529647 0.12278875 0.10905086
 0.08341842 0.07643498 0.07643496 0.08283685 0.04992316 0.02113226
 0.05274193 0.07464102 0.10905095 0.0368523  0.06280661 0.02158514
 0.02175994 0.02175994 0.02175994 0.02175994 0.02175994 0.05444337
 0.08584024 0.02175994 0.02175994 0.02113221 0.04022497 0.02113226
 0.07643498 0.10382136 0.10022769 0.01983963 0.07643498 0.11480843
 0.05483015 0.04947411 0.05483129 0.02113226 0.07643497 0.02416846
 0.02203674 0.02203673 0.02175994 0.02416845 0.10858533 0.02260538
 0.02113226 0.02113226 0.02175994 0.04114045 0.02203673 0.03136271
 0.02158514 0.037322   0.05444352 0.43995762 0.03732198 0.5660754
 0.04334428 0.02158516 0.0750863  0.02382116 0.02366079 0.04564296
 0.07839952 0.02511086 0.07560901 0.02158516 0.02158516 0.02158518
 0.02227701 0.02158514 0.02158517 0.0236608  0.02158514 0.02158514
 0.02158514 0.05111811 0.02606296 0.13696846 0.14277111 0.07327981
 0.07630711 0.02943384 0.13850756 0.9933022  0.02826485 0.03081502
 0.0557076  0.1234457  0.12344575 0.02366081 0.5791286  0.22511362
 0.02820431 0.03091119 0.0852551  0.5983452  0.03624861 0.03624857
 0.03624857 0.03914569 0.03634853 0.26127627 0.1795315  0.3127099
 0.07135386 0.04335212 0.07076754 0.03091119 0.08349397 0.07937393
 0.03019124 0.13344754 0.02820434 0.22510436 0.0309112  0.07937387
 0.04335208 0.04932106 0.03624861 0.03914571 0.03019125 0.07223466
 0.13295268 0.0391457  0.0391457  0.03914569 0.08169647 0.09173509
 2.0671465  0.03624857 0.18112117 0.03914569 0.09777046 0.0930899
 1.0381005  0.09308989 0.03914571 0.0501462  0.0934864  0.03368362
 0.0501462  0.09308989 0.94214743 0.08995448 0.15002422 0.0930899
 0.12985483 0.1428906  0.09364596 0.21015473 0.12662087 0.04275978
 0.04275979 0.21015471 0.34911385 0.05014616 0.0930899  0.093646
 0.09308989 0.06010286 0.06010287 0.06010287 0.04908594 0.24928306
 0.06010286 0.06010286 0.0706716  0.18438931 0.06010286 0.06010286
 0.0669651  0.15392116 0.26409218 0.24737814 0.06010287 0.16579482
 0.18438941 0.06010287 0.08631177 0.11293123 0.06010287 0.06010286
 0.5744622  0.11293114 0.06010286 0.11293116 0.11738098 0.29738185
 0.20141572 0.06010286 0.4348995  0.11738101 0.117381   0.15392119
 0.09121802 0.117381   0.08631181 0.08631172 0.08631177 0.18314418
 0.13646545 0.18314429 0.44459897 0.08631182 0.13646545]
2025-06-02 15:53:33,334 - DEBUG - Edge reconstruction errors: [  5.262428    5.2618446  44.25845   ...  13.35842   535.2589
  13.358406 ]
2025-06-02 15:53:33,336 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155333_update_35.json
2025-06-02 15:53:33,336 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:53:33,345 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155333_update_35.pth and as latest_checkpoint.pth
2025-06-02 15:53:33,345 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870145.dot): 0.6864
2025-06-02 15:53:33,345 - WARNING - Detected 10 anomalous nodes (reconstruction-based):
2025-06-02 15:53:33,345 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.3616, MLP Score: 0.5289
2025-06-02 15:53:33,345 - WARNING -   Node ID: 192.168.27.13, Recon Error: 2.5079, MLP Score: 0.4947
2025-06-02 15:53:33,345 - WARNING -   Node ID: 192.168.27.12, Recon Error: 1.6452, MLP Score: 0.4783
2025-06-02 15:53:33,345 - WARNING -   Node ID: 192.168.27.10, Recon Error: 3.5779, MLP Score: 0.4507
2025-06-02 15:53:33,345 - WARNING -   Node ID: 192.168.209.130, Recon Error: 1.1684, MLP Score: 0.5000
2025-06-02 15:53:33,346 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:53:33,346 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2584, MLP Score: 0.9969
2025-06-02 15:53:33,346 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9603, MLP Score: 0.9998
2025-06-02 15:53:33,346 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0610, MLP Score: 0.9998
2025-06-02 15:53:33,346 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7595, MLP Score: 0.9999
2025-06-02 15:53:33,346 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7589, MLP Score: 0.9999
2025-06-02 15:53:33,346 - INFO - 
--- Processing file: nw_graph_encoded_1748870175.dot (Timestamp: 2025-06-02 15:16:15) ---
2025-06-02 15:53:33,346 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870175.dot
2025-06-02 15:53:33,346 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870175.dot'.
2025-06-02 15:53:33,346 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870175.dot
2025-06-02 15:53:33,374 - INFO - Parsed 866 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870175.dot'.
2025-06-02 15:53:33,402 - INFO - Parsed 1848 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870175.dot'.
2025-06-02 15:53:33,402 - INFO - Processing node updates/additions.
2025-06-02 15:53:33,409 - INFO - Processing edge updates/additions.
2025-06-02 15:53:33,425 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:53:33,426 - INFO - Finished updating NetworkX graph.
2025-06-02 15:53:33,427 - DEBUG - Updated graph - Nodes: 866, Edges: 1848
2025-06-02 15:53:33,427 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:53:33,428 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:53:33,438 - DEBUG - Initial node features tensor shape: torch.Size([866, 30])
2025-06-02 15:53:33,440 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:53:33,440 - DEBUG - Node features tensor shape after scaling: torch.Size([866, 30])
2025-06-02 15:53:33,442 - DEBUG - Edge index tensor shape: torch.Size([2, 1848])
2025-06-02 15:53:33,443 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:53:33,448 - DEBUG - Initial edge attributes tensor shape: torch.Size([1848, 10])
2025-06-02 15:53:33,449 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:53:33,449 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1848, 10])
2025-06-02 15:53:33,450 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:53:33,450 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:53:33,451 - INFO - Updated main graph to 866 nodes and 1848 edges.
2025-06-02 15:53:33,451 - INFO - Performing online update...
2025-06-02 15:53:33,451 - INFO - Starting online update for 50 steps.
2025-06-02 15:53:33,451 - DEBUG - Updated RunningStats: new_mean=0.943791441060067, new_var=55800000000161.46, new_n=5610
2025-06-02 15:53:33,452 - DEBUG - Updated RunningStats: new_mean=0.9427117717034198, new_var=56100000000018.12, new_n=5640
2025-06-02 15:53:33,452 - DEBUG - Updated RunningStats: new_mean=44.633243892112006, new_var=18600000190296.996, new_n=1870
2025-06-02 15:53:33,452 - DEBUG - Updated RunningStats: new_mean=44.65169241316344, new_var=18700000201678.098, new_n=1880
2025-06-02 15:53:33,452 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:53:33,452 - DEBUG - Online update step: 1/50
2025-06-02 15:53:33,454 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:33,520 - DEBUG - Node anomaly scores shape: torch.Size([16727, 1])
2025-06-02 15:53:33,530 - DEBUG - Edge anomaly scores shape: torch.Size([34486, 1])
2025-06-02 15:53:33,531 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:33,774 - DEBUG - Step 1: Loss=0.7723
2025-06-02 15:53:33,774 - DEBUG - Online update step: 2/50
2025-06-02 15:53:33,777 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:33,871 - DEBUG - Node anomaly scores shape: torch.Size([14972, 1])
2025-06-02 15:53:33,877 - DEBUG - Edge anomaly scores shape: torch.Size([30701, 1])
2025-06-02 15:53:33,878 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:34,045 - DEBUG - Step 2: Loss=0.7020
2025-06-02 15:53:34,045 - DEBUG - Online update step: 3/50
2025-06-02 15:53:34,048 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:34,123 - DEBUG - Node anomaly scores shape: torch.Size([14539, 1])
2025-06-02 15:53:34,127 - DEBUG - Edge anomaly scores shape: torch.Size([29731, 1])
2025-06-02 15:53:34,128 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:34,328 - DEBUG - Step 3: Loss=0.7737
2025-06-02 15:53:34,328 - DEBUG - Online update step: 4/50
2025-06-02 15:53:34,331 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:34,416 - DEBUG - Node anomaly scores shape: torch.Size([16004, 1])
2025-06-02 15:53:34,420 - DEBUG - Edge anomaly scores shape: torch.Size([33104, 1])
2025-06-02 15:53:34,421 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:34,565 - DEBUG - Step 4: Loss=0.7969
2025-06-02 15:53:34,567 - DEBUG - Online update step: 5/50
2025-06-02 15:53:34,571 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:34,698 - DEBUG - Node anomaly scores shape: torch.Size([16026, 1])
2025-06-02 15:53:34,702 - DEBUG - Edge anomaly scores shape: torch.Size([32926, 1])
2025-06-02 15:53:34,703 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:34,902 - DEBUG - Step 5: Loss=0.7623
2025-06-02 15:53:34,903 - DEBUG - Online update step: 6/50
2025-06-02 15:53:34,906 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:34,993 - DEBUG - Node anomaly scores shape: torch.Size([15416, 1])
2025-06-02 15:53:34,997 - DEBUG - Edge anomaly scores shape: torch.Size([31679, 1])
2025-06-02 15:53:34,998 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:35,198 - DEBUG - Step 6: Loss=0.7021
2025-06-02 15:53:35,198 - DEBUG - Online update step: 7/50
2025-06-02 15:53:35,201 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:35,294 - DEBUG - Node anomaly scores shape: torch.Size([15696, 1])
2025-06-02 15:53:35,297 - DEBUG - Edge anomaly scores shape: torch.Size([32357, 1])
2025-06-02 15:53:35,298 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:35,473 - DEBUG - Step 7: Loss=0.7300
2025-06-02 15:53:35,473 - DEBUG - Online update step: 8/50
2025-06-02 15:53:35,476 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:35,561 - DEBUG - Node anomaly scores shape: torch.Size([15619, 1])
2025-06-02 15:53:35,566 - DEBUG - Edge anomaly scores shape: torch.Size([32279, 1])
2025-06-02 15:53:35,567 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:35,786 - DEBUG - Step 8: Loss=0.7092
2025-06-02 15:53:35,786 - DEBUG - Online update step: 9/50
2025-06-02 15:53:35,789 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:35,872 - DEBUG - Node anomaly scores shape: torch.Size([15720, 1])
2025-06-02 15:53:35,876 - DEBUG - Edge anomaly scores shape: torch.Size([32374, 1])
2025-06-02 15:53:35,877 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:36,070 - DEBUG - Step 9: Loss=0.7303
2025-06-02 15:53:36,070 - DEBUG - Online update step: 10/50
2025-06-02 15:53:36,073 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:36,158 - DEBUG - Node anomaly scores shape: torch.Size([15371, 1])
2025-06-02 15:53:36,163 - DEBUG - Edge anomaly scores shape: torch.Size([31574, 1])
2025-06-02 15:53:36,164 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:36,349 - DEBUG - Step 10: Loss=0.7375
2025-06-02 15:53:36,350 - DEBUG - Online update step: 11/50
2025-06-02 15:53:36,353 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:36,436 - DEBUG - Node anomaly scores shape: torch.Size([15585, 1])
2025-06-02 15:53:36,439 - DEBUG - Edge anomaly scores shape: torch.Size([32042, 1])
2025-06-02 15:53:36,440 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:36,616 - DEBUG - Step 11: Loss=0.6974
2025-06-02 15:53:36,616 - DEBUG - Online update step: 12/50
2025-06-02 15:53:36,619 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:36,702 - DEBUG - Node anomaly scores shape: torch.Size([15644, 1])
2025-06-02 15:53:36,707 - DEBUG - Edge anomaly scores shape: torch.Size([32199, 1])
2025-06-02 15:53:36,708 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:36,900 - DEBUG - Step 12: Loss=0.7491
2025-06-02 15:53:36,901 - DEBUG - Online update step: 13/50
2025-06-02 15:53:36,904 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:36,995 - DEBUG - Node anomaly scores shape: torch.Size([14745, 1])
2025-06-02 15:53:36,999 - DEBUG - Edge anomaly scores shape: torch.Size([30191, 1])
2025-06-02 15:53:37,001 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:37,182 - DEBUG - Step 13: Loss=0.7732
2025-06-02 15:53:37,183 - DEBUG - Online update step: 14/50
2025-06-02 15:53:37,190 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:37,275 - DEBUG - Node anomaly scores shape: torch.Size([14894, 1])
2025-06-02 15:53:37,279 - DEBUG - Edge anomaly scores shape: torch.Size([30551, 1])
2025-06-02 15:53:37,281 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:37,461 - DEBUG - Step 14: Loss=0.7368
2025-06-02 15:53:37,461 - DEBUG - Online update step: 15/50
2025-06-02 15:53:37,465 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:37,541 - DEBUG - Node anomaly scores shape: torch.Size([14672, 1])
2025-06-02 15:53:37,545 - DEBUG - Edge anomaly scores shape: torch.Size([30038, 1])
2025-06-02 15:53:37,546 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:37,696 - DEBUG - Step 15: Loss=0.7108
2025-06-02 15:53:37,696 - DEBUG - Online update step: 16/50
2025-06-02 15:53:37,701 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:37,853 - DEBUG - Node anomaly scores shape: torch.Size([16701, 1])
2025-06-02 15:53:37,872 - DEBUG - Edge anomaly scores shape: torch.Size([34453, 1])
2025-06-02 15:53:37,874 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:38,191 - DEBUG - Step 16: Loss=0.7421
2025-06-02 15:53:38,191 - DEBUG - Online update step: 17/50
2025-06-02 15:53:38,194 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:38,277 - DEBUG - Node anomaly scores shape: torch.Size([15393, 1])
2025-06-02 15:53:38,281 - DEBUG - Edge anomaly scores shape: torch.Size([31723, 1])
2025-06-02 15:53:38,282 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:38,461 - DEBUG - Step 17: Loss=0.7139
2025-06-02 15:53:38,461 - DEBUG - Online update step: 18/50
2025-06-02 15:53:38,464 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:38,554 - DEBUG - Node anomaly scores shape: torch.Size([15234, 1])
2025-06-02 15:53:38,558 - DEBUG - Edge anomaly scores shape: torch.Size([31241, 1])
2025-06-02 15:53:38,559 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:38,764 - DEBUG - Step 18: Loss=0.7267
2025-06-02 15:53:38,764 - DEBUG - Online update step: 19/50
2025-06-02 15:53:38,770 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:38,952 - DEBUG - Node anomaly scores shape: torch.Size([15379, 1])
2025-06-02 15:53:38,958 - DEBUG - Edge anomaly scores shape: torch.Size([31520, 1])
2025-06-02 15:53:38,961 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:39,200 - DEBUG - Step 19: Loss=0.7491
2025-06-02 15:53:39,200 - DEBUG - Online update step: 20/50
2025-06-02 15:53:39,207 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:39,293 - DEBUG - Node anomaly scores shape: torch.Size([15608, 1])
2025-06-02 15:53:39,298 - DEBUG - Edge anomaly scores shape: torch.Size([32318, 1])
2025-06-02 15:53:39,299 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:39,511 - DEBUG - Step 20: Loss=0.7202
2025-06-02 15:53:39,511 - DEBUG - Online update step: 21/50
2025-06-02 15:53:39,514 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:39,611 - DEBUG - Node anomaly scores shape: torch.Size([14374, 1])
2025-06-02 15:53:39,616 - DEBUG - Edge anomaly scores shape: torch.Size([29337, 1])
2025-06-02 15:53:39,617 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:39,848 - DEBUG - Step 21: Loss=0.7294
2025-06-02 15:53:39,849 - DEBUG - Online update step: 22/50
2025-06-02 15:53:39,852 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:39,935 - DEBUG - Node anomaly scores shape: torch.Size([15446, 1])
2025-06-02 15:53:39,939 - DEBUG - Edge anomaly scores shape: torch.Size([31865, 1])
2025-06-02 15:53:39,940 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:40,135 - DEBUG - Step 22: Loss=0.7392
2025-06-02 15:53:40,136 - DEBUG - Online update step: 23/50
2025-06-02 15:53:40,139 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:40,239 - DEBUG - Node anomaly scores shape: torch.Size([16025, 1])
2025-06-02 15:53:40,244 - DEBUG - Edge anomaly scores shape: torch.Size([32965, 1])
2025-06-02 15:53:40,246 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:40,471 - DEBUG - Step 23: Loss=0.7155
2025-06-02 15:53:40,472 - DEBUG - Online update step: 24/50
2025-06-02 15:53:40,475 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:40,574 - DEBUG - Node anomaly scores shape: torch.Size([15888, 1])
2025-06-02 15:53:40,578 - DEBUG - Edge anomaly scores shape: torch.Size([32679, 1])
2025-06-02 15:53:40,579 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:40,776 - DEBUG - Step 24: Loss=0.7204
2025-06-02 15:53:40,777 - DEBUG - Online update step: 25/50
2025-06-02 15:53:40,780 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:40,890 - DEBUG - Node anomaly scores shape: torch.Size([14883, 1])
2025-06-02 15:53:40,894 - DEBUG - Edge anomaly scores shape: torch.Size([30452, 1])
2025-06-02 15:53:40,895 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:41,076 - DEBUG - Step 25: Loss=0.7306
2025-06-02 15:53:41,077 - DEBUG - Online update step: 26/50
2025-06-02 15:53:41,080 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:41,189 - DEBUG - Node anomaly scores shape: torch.Size([15430, 1])
2025-06-02 15:53:41,195 - DEBUG - Edge anomaly scores shape: torch.Size([31694, 1])
2025-06-02 15:53:41,197 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:41,539 - DEBUG - Step 26: Loss=0.7033
2025-06-02 15:53:41,540 - DEBUG - Online update step: 27/50
2025-06-02 15:53:41,550 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:41,671 - DEBUG - Node anomaly scores shape: torch.Size([15402, 1])
2025-06-02 15:53:41,678 - DEBUG - Edge anomaly scores shape: torch.Size([31757, 1])
2025-06-02 15:53:41,680 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:41,880 - DEBUG - Step 27: Loss=0.7222
2025-06-02 15:53:41,881 - DEBUG - Online update step: 28/50
2025-06-02 15:53:41,888 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:41,977 - DEBUG - Node anomaly scores shape: torch.Size([15322, 1])
2025-06-02 15:53:41,983 - DEBUG - Edge anomaly scores shape: torch.Size([31400, 1])
2025-06-02 15:53:41,984 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:42,287 - DEBUG - Step 28: Loss=0.7363
2025-06-02 15:53:42,288 - DEBUG - Online update step: 29/50
2025-06-02 15:53:42,303 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:42,435 - DEBUG - Node anomaly scores shape: torch.Size([15947, 1])
2025-06-02 15:53:42,440 - DEBUG - Edge anomaly scores shape: torch.Size([32833, 1])
2025-06-02 15:53:42,442 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:42,643 - DEBUG - Step 29: Loss=0.7071
2025-06-02 15:53:42,643 - DEBUG - Online update step: 30/50
2025-06-02 15:53:42,651 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:42,743 - DEBUG - Node anomaly scores shape: torch.Size([16029, 1])
2025-06-02 15:53:42,748 - DEBUG - Edge anomaly scores shape: torch.Size([33109, 1])
2025-06-02 15:53:42,750 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:42,924 - DEBUG - Step 30: Loss=0.7091
2025-06-02 15:53:42,925 - DEBUG - Online update step: 31/50
2025-06-02 15:53:42,932 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:43,025 - DEBUG - Node anomaly scores shape: torch.Size([14926, 1])
2025-06-02 15:53:43,030 - DEBUG - Edge anomaly scores shape: torch.Size([30579, 1])
2025-06-02 15:53:43,032 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:43,224 - DEBUG - Step 31: Loss=0.7291
2025-06-02 15:53:43,225 - DEBUG - Online update step: 32/50
2025-06-02 15:53:43,234 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:43,321 - DEBUG - Node anomaly scores shape: torch.Size([14840, 1])
2025-06-02 15:53:43,327 - DEBUG - Edge anomaly scores shape: torch.Size([30426, 1])
2025-06-02 15:53:43,329 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:43,647 - DEBUG - Step 32: Loss=0.7011
2025-06-02 15:53:43,647 - DEBUG - Online update step: 33/50
2025-06-02 15:53:43,651 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:43,792 - DEBUG - Node anomaly scores shape: torch.Size([15257, 1])
2025-06-02 15:53:43,798 - DEBUG - Edge anomaly scores shape: torch.Size([31385, 1])
2025-06-02 15:53:43,799 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:43,984 - DEBUG - Step 33: Loss=0.7126
2025-06-02 15:53:43,984 - DEBUG - Online update step: 34/50
2025-06-02 15:53:43,987 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:44,063 - DEBUG - Node anomaly scores shape: torch.Size([14855, 1])
2025-06-02 15:53:44,067 - DEBUG - Edge anomaly scores shape: torch.Size([30429, 1])
2025-06-02 15:53:44,069 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:44,264 - DEBUG - Step 34: Loss=0.7276
2025-06-02 15:53:44,265 - DEBUG - Online update step: 35/50
2025-06-02 15:53:44,268 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:44,388 - DEBUG - Node anomaly scores shape: torch.Size([15789, 1])
2025-06-02 15:53:44,394 - DEBUG - Edge anomaly scores shape: torch.Size([32607, 1])
2025-06-02 15:53:44,395 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:44,642 - DEBUG - Step 35: Loss=0.6998
2025-06-02 15:53:44,643 - DEBUG - Online update step: 36/50
2025-06-02 15:53:44,645 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:44,745 - DEBUG - Node anomaly scores shape: torch.Size([15057, 1])
2025-06-02 15:53:44,752 - DEBUG - Edge anomaly scores shape: torch.Size([30967, 1])
2025-06-02 15:53:44,753 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:44,948 - DEBUG - Step 36: Loss=0.7092
2025-06-02 15:53:44,948 - DEBUG - Online update step: 37/50
2025-06-02 15:53:44,952 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:45,072 - DEBUG - Node anomaly scores shape: torch.Size([15591, 1])
2025-06-02 15:53:45,079 - DEBUG - Edge anomaly scores shape: torch.Size([32204, 1])
2025-06-02 15:53:45,082 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:45,287 - DEBUG - Step 37: Loss=0.7234
2025-06-02 15:53:45,287 - DEBUG - Online update step: 38/50
2025-06-02 15:53:45,291 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:45,382 - DEBUG - Node anomaly scores shape: torch.Size([16317, 1])
2025-06-02 15:53:45,391 - DEBUG - Edge anomaly scores shape: torch.Size([33699, 1])
2025-06-02 15:53:45,393 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:45,717 - DEBUG - Step 38: Loss=0.6982
2025-06-02 15:53:45,718 - DEBUG - Online update step: 39/50
2025-06-02 15:53:45,728 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:45,822 - DEBUG - Node anomaly scores shape: torch.Size([14816, 1])
2025-06-02 15:53:45,828 - DEBUG - Edge anomaly scores shape: torch.Size([30357, 1])
2025-06-02 15:53:45,830 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:46,162 - DEBUG - Step 39: Loss=0.7035
2025-06-02 15:53:46,163 - DEBUG - Online update step: 40/50
2025-06-02 15:53:46,176 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:46,317 - DEBUG - Node anomaly scores shape: torch.Size([15696, 1])
2025-06-02 15:53:46,323 - DEBUG - Edge anomaly scores shape: torch.Size([32317, 1])
2025-06-02 15:53:46,326 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:46,562 - DEBUG - Step 40: Loss=0.7156
2025-06-02 15:53:46,563 - DEBUG - Online update step: 41/50
2025-06-02 15:53:46,570 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:46,657 - DEBUG - Node anomaly scores shape: torch.Size([15183, 1])
2025-06-02 15:53:46,661 - DEBUG - Edge anomaly scores shape: torch.Size([31130, 1])
2025-06-02 15:53:46,663 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:46,851 - DEBUG - Step 41: Loss=0.6892
2025-06-02 15:53:46,851 - DEBUG - Online update step: 42/50
2025-06-02 15:53:46,857 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:46,939 - DEBUG - Node anomaly scores shape: torch.Size([14876, 1])
2025-06-02 15:53:46,943 - DEBUG - Edge anomaly scores shape: torch.Size([30459, 1])
2025-06-02 15:53:46,945 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:47,128 - DEBUG - Step 42: Loss=0.7066
2025-06-02 15:53:47,128 - DEBUG - Online update step: 43/50
2025-06-02 15:53:47,134 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:47,217 - DEBUG - Node anomaly scores shape: torch.Size([15353, 1])
2025-06-02 15:53:47,221 - DEBUG - Edge anomaly scores shape: torch.Size([31669, 1])
2025-06-02 15:53:47,223 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:47,384 - DEBUG - Step 43: Loss=0.7182
2025-06-02 15:53:47,384 - DEBUG - Online update step: 44/50
2025-06-02 15:53:47,396 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:47,494 - DEBUG - Node anomaly scores shape: torch.Size([15763, 1])
2025-06-02 15:53:47,498 - DEBUG - Edge anomaly scores shape: torch.Size([32497, 1])
2025-06-02 15:53:47,500 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:47,687 - DEBUG - Step 44: Loss=0.6907
2025-06-02 15:53:47,688 - DEBUG - Online update step: 45/50
2025-06-02 15:53:47,693 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:47,793 - DEBUG - Node anomaly scores shape: torch.Size([15729, 1])
2025-06-02 15:53:47,797 - DEBUG - Edge anomaly scores shape: torch.Size([32403, 1])
2025-06-02 15:53:47,799 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:48,025 - DEBUG - Step 45: Loss=0.7019
2025-06-02 15:53:48,026 - DEBUG - Online update step: 46/50
2025-06-02 15:53:48,033 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:48,154 - DEBUG - Node anomaly scores shape: torch.Size([15378, 1])
2025-06-02 15:53:48,158 - DEBUG - Edge anomaly scores shape: torch.Size([31639, 1])
2025-06-02 15:53:48,159 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:48,388 - DEBUG - Step 46: Loss=0.7174
2025-06-02 15:53:48,388 - DEBUG - Online update step: 47/50
2025-06-02 15:53:48,394 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:48,490 - DEBUG - Node anomaly scores shape: torch.Size([16306, 1])
2025-06-02 15:53:48,494 - DEBUG - Edge anomaly scores shape: torch.Size([33650, 1])
2025-06-02 15:53:48,496 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:48,710 - DEBUG - Step 47: Loss=0.6903
2025-06-02 15:53:48,710 - DEBUG - Online update step: 48/50
2025-06-02 15:53:48,716 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:48,794 - DEBUG - Node anomaly scores shape: torch.Size([15523, 1])
2025-06-02 15:53:48,799 - DEBUG - Edge anomaly scores shape: torch.Size([31876, 1])
2025-06-02 15:53:48,800 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:48,993 - DEBUG - Step 48: Loss=0.6961
2025-06-02 15:53:48,993 - DEBUG - Online update step: 49/50
2025-06-02 15:53:48,999 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:49,085 - DEBUG - Node anomaly scores shape: torch.Size([15646, 1])
2025-06-02 15:53:49,089 - DEBUG - Edge anomaly scores shape: torch.Size([32288, 1])
2025-06-02 15:53:49,091 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:49,316 - DEBUG - Step 49: Loss=0.7107
2025-06-02 15:53:49,316 - DEBUG - Online update step: 50/50
2025-06-02 15:53:49,324 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:49,595 - DEBUG - Node anomaly scores shape: torch.Size([15210, 1])
2025-06-02 15:53:49,600 - DEBUG - Edge anomaly scores shape: torch.Size([31193, 1])
2025-06-02 15:53:49,603 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:49,786 - DEBUG - Step 50: Loss=0.6851
2025-06-02 15:53:49,786 - INFO - Online update finished. Average loss: 0.7215, Learning rate: 0.001000
2025-06-02 15:53:49,787 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  1.7344538e-08  5.7815130e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.8081635e-08
  1.3214887e-08 -5.5062026e-09  9.9111652e-09  1.1012405e-09
  2.3048499e+00  2.9584296e+00  1.4434180e-01  4.4006929e+00
  5.5062026e-09  3.3418014e+00  5.8198614e+00  7.6073904e+00
  1.4434180e-01  7.9919167e+00 -3.7992798e-08  3.1935976e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.6074435e-09  3.3037217e-09], current edge mean: [-2.0642301e-09  4.5980521e+02  0.0000000e+00  0.0000000e+00
 -1.0321151e-09  0.0000000e+00  3.0963452e-09 -6.1926904e-09
  4.1284602e-09 -2.0642301e-09]
2025-06-02 15:53:49,787 - DEBUG - Node drift difference: 0.0150, Edge drift difference: 0.0018
2025-06-02 15:53:49,788 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  1.7344538e-08  5.7815130e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.8081635e-08
  1.3214887e-08 -5.5062026e-09  9.9111652e-09  1.1012405e-09
  2.3048499e+00  2.9584296e+00  1.4434180e-01  4.4006929e+00
  5.5062026e-09  3.3418014e+00  5.8198614e+00  7.6073904e+00
  1.4434180e-01  7.9919167e+00 -3.7992798e-08  3.1935976e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.6074435e-09  3.3037217e-09], edge=[-2.0642301e-09  4.5980521e+02  0.0000000e+00  0.0000000e+00
 -1.0321151e-09  0.0000000e+00  3.0963452e-09 -6.1926904e-09
  4.1284602e-09 -2.0642301e-09]
2025-06-02 15:53:49,789 - DEBUG - Updated reference std: node=[0.         0.         1.0005779  1.0005779  0.         0.
 0.         1.0005778  1.0005778  1.0005779  1.0005779  1.0005779
 0.99914396 0.28549412 0.3677101  0.5709333  1.0005779  2.9968822
 2.89626    1.4954702  0.3677101  0.23786968 1.0005778  1.0005778
 0.         0.         0.         0.         1.0005778  1.0005778 ], edge=[  1.0002707 474.01376     0.          0.          1.0002707   1.0002707
   1.0002707   1.0002707   1.0002707   1.0002707]
2025-06-02 15:53:49,789 - INFO - Online update complete. Loss: 0.7215
2025-06-02 15:53:49,789 - INFO - Running anomaly detection...
2025-06-02 15:53:49,789 - INFO - Starting anomaly detection.
2025-06-02 15:53:49,807 - DEBUG - Node reconstruction errors: [4.05428708e-01 1.30827868e+00 2.40635037e+00 8.93790200e-02
 1.56191900e-01 1.24694400e-01 1.45713294e+00 6.22975975e-02
 6.22975603e-02 1.09164074e-01 6.22975603e-02 1.26859128e-01
 3.14873719e+00 4.32911664e-01 2.41516661e-02 3.46250571e-02
 1.27606586e-01 3.46254893e-02 4.73413140e-01 2.94416565e-02
 5.35721071e-02 2.41516661e-02 1.29344746e-01 9.25470516e-02
 2.38651708e-02 8.08257610e-02 2.38651428e-02 1.92148417e-01
 6.08097874e-02 2.38651708e-02 4.67027098e-01 3.33533764e-01
 1.84789598e-01 8.25011209e-02 8.13380629e-02 1.38844669e-01
 1.93362057e-01 2.94416565e-02 2.27101550e-01 3.02122593e-01
 1.35827079e-01 2.07020529e-02 2.94416565e-02 2.13471636e-01
 1.56535059e-01 1.81406155e-01 2.83733755e-01 1.60167381e-01
 5.89407645e-02 5.41817605e-01 6.70781076e-01 7.21815079e-02
 7.70773143e-02 4.07943547e-01 6.46537468e-02 1.77313358e-01
 8.84126782e-01 2.72779725e-02 4.12142664e-01 4.62801546e-01
 4.65331763e-01 2.25078896e-01 1.72423497e-02 9.46920589e-02
 1.93997342e-02 6.46536574e-02 5.32307737e-02 6.46535382e-02
 1.72423683e-02 2.25078896e-01 1.03776373e-01 1.02896526e-01
 3.70670632e-02 2.06754372e-01 1.66460201e-01 1.05531923e-01
 2.45025411e-01 9.72680748e-02 5.52641563e-02 7.10520893e-02
 6.90465197e-02 6.87047467e-02 5.56740522e-01 5.52621245e-01
 1.04015559e-01 1.09797619e-01 1.11369215e-01 1.03688784e-01
 9.39971358e-02 2.42258638e-01 1.81386527e-02 1.75097167e-01
 5.34247570e-02 6.50446191e-02 4.38555852e-02 8.39335263e-01
 6.53442591e-02 1.23444460e-01 1.16628744e-02 5.14922962e-02
 7.18029216e-02 6.53442591e-02 1.29550472e-01 3.44258577e-01
 1.13495104e-01 4.90729325e-02 1.04808010e-01 1.59476802e-01
 5.15317470e-02 2.86386281e-01 2.92995721e-01 7.36352503e-02
 2.02898443e-01 1.90647915e-01 6.60585985e-02 5.67529947e-02
 6.11410998e-02 1.89541623e-01 1.23263083e-01 4.38346304e-02
 1.75878815e-02 3.13555524e-02 1.82253942e-01 9.57974121e-02
 1.43002763e-01 4.38409336e-02 1.16381839e-01 1.96515694e-01
 8.96230713e-02 4.99196909e-02 6.24395534e-02 2.90440749e-02
 1.43713951e-01 3.51258934e-01 5.39939962e-02 5.08793518e-02
 1.38727322e-01 1.21232430e-02 3.10949028e-01 1.42019957e-01
 1.04387000e-01 8.10803249e-02 2.21867561e-02 1.04386926e-01
 8.79473165e-02 1.36702567e-01 6.11410700e-02 1.98240191e-01
 2.64570955e-02 1.08277880e-01 4.13022131e-01 1.30336106e-01
 6.52704462e-02 2.90440898e-02 1.40375480e-01 1.63118362e-01
 2.97829099e-02 5.59790358e-02 7.18029514e-02 1.27782494e-01
 1.04386970e-01 1.48443043e-01 2.97829099e-02 6.24395609e-02
 6.11553304e-02 1.64674118e-01 7.56354108e-02 4.94122170e-02
 1.60860762e-01 1.26872718e-01 7.36634210e-02 4.58125398e-02
 1.55114792e-02 6.06371343e-01 1.23264439e-01 8.31464863e+00
 5.22950031e-02 6.65514767e-02 5.98693453e-02 5.98693006e-02
 4.75519188e-02 9.10852402e-02 4.15469259e-02 2.25562096e-01
 1.71734884e-01 7.83543140e-02 2.00777650e-02 6.06921427e-02
 4.91601303e-02 2.84256767e-02 9.31316540e-02 9.21296924e-02
 1.07837655e-01 2.82959919e-02 3.10945570e-01 6.76476061e-02
 6.08705461e-01 1.36690080e-01 2.03972712e-01 1.70552149e-01
 4.10466194e-02 2.97829099e-02 2.20414415e-01 1.23934545e-01
 1.44034937e-01 1.46932364e-01 9.11940560e-02 2.23303154e-01
 1.37104299e-02 5.50634041e-02 5.07621057e-02 5.96030951e-02
 6.89650252e-02 6.15022629e-02 8.61138031e-02 3.01477704e-02
 1.10016227e-01 6.11410141e-02 1.72136843e-01 2.82959919e-02
 2.04973593e-01 2.00777650e-02 1.32338870e-02 6.89649507e-02
 2.97829434e-02 1.18361011e-01 1.81654692e-01 3.14642116e-02
 6.61687180e-02 2.69217733e-02 8.28613117e-02 9.37220156e-02
 1.23302631e-01 6.11411221e-02 6.11411110e-02 9.02665928e-02
 5.61936870e-02 1.32338917e-02 2.97829099e-02 1.37085155e-01
 1.65791944e-01 5.53231239e-02 3.27991769e-02 1.26872495e-01
 3.04200072e-02 1.42028868e-01 4.62031439e-02 9.42976773e-02
 3.27991769e-02 7.11405352e-02 1.55114569e-02 1.39729585e-02
 1.72137395e-01 5.08395880e-02 9.93364975e-02 8.56986865e-02
 2.84257047e-02 1.52920661e-02 6.85356036e-02 5.98692819e-02
 4.57329340e-02 1.11726366e-01 4.55824211e-02 1.02494590e-01
 1.30422428e-01 4.30046171e-02 7.68129379e-02 4.31332648e-01
 7.68150836e-02 4.42482568e-02 2.53144890e-01 1.96625516e-01
 6.01197705e-02 1.77994877e-01 6.41951263e-02 5.98693117e-02
 3.37009020e-02 1.56898662e-01 4.75519188e-02 9.19545591e-02
 2.72347808e-01 3.34221907e-02 5.25268652e-02 1.18670456e-01
 1.09863810e-01 5.64430133e-02 2.77068913e-01 1.33642420e-01
 9.10852402e-02 1.90528885e-01 1.27097115e-01 6.86209053e-02
 6.08997792e-02 3.04200351e-02 4.44556981e-01 2.84481961e-02
 4.98739406e-02 5.98693751e-02 6.76475838e-02 1.13750190e-01
 5.22312745e-02 8.45398847e-03 5.54197393e-02 9.24161822e-02
 8.45398847e-03 8.45398847e-03 8.45400896e-03 6.69360310e-02
 8.20082240e-03 8.45400896e-03 8.45398847e-03 1.56271428e-01
 8.45398847e-03 2.76792068e-02 1.52377769e-01 6.66919276e-02
 2.29723766e-01 7.18278736e-02 6.71380535e-02 7.13879764e-02
 6.93262815e-02 7.54053071e-02 7.65299052e-02 5.54198362e-02
 1.63251504e-01 2.09298983e-01 9.66958515e-03 9.38365534e-02
 6.00466095e-02 6.00470528e-02 2.34204352e-01 6.65336698e-02
 8.45400896e-03 6.41950220e-02 8.45400896e-03 6.69360533e-02
 8.58995095e-02 1.17592644e-02 9.66958515e-03 9.66958515e-03
 8.45400337e-03 1.53266517e-02 9.66958515e-03 1.01013251e-01
 1.00237034e-01 9.79256630e-02 5.54197691e-02 5.72405793e-02
 7.59899616e-02 5.67443334e-02 8.45400896e-03 4.43812124e-02
 1.80601269e-01 7.90399238e-02 1.38998786e-02 2.84257047e-02
 1.36384992e-02 8.45398847e-03 1.00322645e-02 5.08800328e-01
 5.07621802e-02 2.42709517e-02 1.88759357e-01 8.93868953e-02
 5.54198250e-02 7.70531714e-01 1.14268949e-02 1.74101010e-01
 5.04216440e-02 3.85076366e-02 5.57001904e-02 8.50099996e-02
 1.00844719e-01 1.70692250e-01 1.03292800e-01 7.90399686e-02
 1.14831068e-02 2.85502896e-02 7.28161559e-02 8.45400896e-03
 5.54198101e-02 1.90774739e-01 2.78759599e-02 5.46125919e-02
 1.79957584e-01 1.02768607e-01 9.78684723e-02 1.44562438e-01
 7.85620660e-02 8.45400896e-03 2.17564568e-01 1.40552223e-01
 4.51490879e-02 2.02268511e-01 7.18098357e-02 7.18098059e-02
 7.18097985e-02 4.13399100e-01 7.38646882e-03 4.19107884e-01
 2.76794676e-02 1.20402843e-01 7.18098059e-02 7.38646882e-03
 4.40463871e-02 4.51490879e-02 1.06974289e-01 4.76390496e-02
 4.51491065e-02 1.70185804e-01 7.18098134e-02 4.51490954e-02
 7.38646882e-03 7.18098059e-02 7.18098134e-02 1.45818861e-02
 1.49567761e-02 7.18097985e-02 1.14785014e-02 7.11705834e-02
 4.76229452e-02 3.98845449e-02 3.71930674e-02 2.76932009e-02
 1.83521673e-01 5.59004694e-02 5.59984595e-02 1.08204432e-01
 1.86345249e-01 3.87949310e-02 6.96001351e-02 4.59009632e-02
 5.64463772e-02 6.75509945e-02 7.18098581e-02 7.18098134e-02
 2.76794750e-02 7.41429850e-02 1.84229478e-01 2.45911162e-02
 5.48133068e-02 2.67641861e-02 1.73106864e-01 1.36318170e-02
 1.79021284e-02 1.81373209e-01 1.72198907e-01 3.09821572e-02
 6.72325045e-02 2.66027413e-02 1.04849376e-01 9.48944688e-03
 2.74085309e-02 6.76634954e-03 9.48944688e-03 4.72140461e-02
 2.76932083e-02 2.64644511e-02 6.38778284e-02 7.60205165e-02
 4.37958390e-02 2.76707448e-02 3.07770129e-02 9.91301537e-02
 3.07769943e-02 2.76707448e-02 8.84088594e-03 6.08869381e-02
 1.65718481e-01 6.69111460e-02 8.84088594e-03 4.37959582e-02
 7.91419074e-02 1.88815355e-01 1.27605230e-01 3.71925794e-02
 6.08871356e-02 4.37958576e-02 9.60772391e-03 3.06800064e-02
 5.32889813e-02 2.82192349e-01 5.70395440e-02 3.09821498e-02
 1.93626881e-01 2.68255901e-02 9.48944688e-03 1.81535169e-01
 5.45485392e-02 1.88784525e-01 3.53922322e-02 9.60772391e-03
 6.28288537e-02 1.26894061e-02 3.26897837e-02 2.64644697e-02
 3.90049331e-02 4.90651906e-01 6.76634954e-03 3.06800567e-02
 1.86826035e-01 1.26894061e-02 1.86826006e-01 2.65286919e-02
 8.13569408e-03 8.13429058e-02 6.58853399e-03 3.22997242e-01
 4.85547297e-02 9.48944688e-03 5.97557053e-02 2.37063635e-02
 2.37063635e-02 1.79021284e-02 5.71113341e-02 4.25565094e-02
 6.58851629e-03 4.40450124e-02 1.15664005e-01 6.97493851e-02
 4.40448858e-02 2.67641284e-02 6.58852188e-03 6.62317127e-02
 8.13569408e-03 3.90048586e-02 5.60871102e-02 1.79011807e-01
 4.40451764e-02 7.79410526e-02 4.25565094e-02 6.76634954e-03
 6.76634954e-03 3.06800567e-02 3.90048251e-02 3.98597755e-02
 6.43167794e-02 8.78230706e-02 6.76634954e-03 6.57406524e-02
 6.76634954e-03 6.57406002e-02 5.44179156e-02 4.40446846e-02
 2.39608213e-02 6.98234141e-01 1.80086225e-01 6.63235085e-03
 4.92552638e-01 6.63235085e-03 6.63236249e-03 6.63235085e-03
 6.63235085e-03 6.63235085e-03 6.63235085e-03 6.63235085e-03
 4.88131307e-02 2.44776942e-02 5.72037213e-02 6.63235085e-03
 6.63235085e-03 6.63235085e-03 6.63236110e-03 6.63235085e-03
 6.63235085e-03 6.63235085e-03 6.63236110e-03 6.63235085e-03
 4.11920995e-02 6.63235085e-03 6.63236110e-03 1.99817270e-01
 6.63235085e-03 1.12408765e-01 6.12848550e-02 6.76634954e-03
 9.62898284e-02 7.99107403e-02 6.73746526e-01 6.73746526e-01
 8.25551003e-02 9.62898284e-02 6.76634954e-03 6.58852188e-03
 6.58853352e-03 6.76634582e-03 6.58853352e-03 6.35621175e-02
 4.80713509e-02 6.63234480e-03 2.67641190e-02 6.76634954e-03
 2.37063579e-02 6.76634954e-03 6.76634582e-03 5.34346439e-02
 6.76634954e-03 6.58852188e-03 6.76634954e-03 6.76634582e-03
 4.40452434e-02 6.58853166e-03 6.76634954e-03 6.58853352e-03
 6.76634954e-03 6.76634954e-03 6.76637609e-03 6.61298186e-02
 1.22078925e-01 3.26898657e-02 6.63236110e-03 4.82271239e-02
 7.69391432e-02 6.76634954e-03 6.58853352e-03 7.97095820e-02
 6.63235085e-03 4.35895510e-02 7.64908940e-02 8.41551181e-03
 6.76634954e-03 6.76634954e-03 3.14007141e-02 7.48904198e-02
 3.22746001e-02 6.76634954e-03 4.88134623e-02 1.82241220e-02
 6.58852188e-03 1.61236256e-01 6.63235085e-03 5.93234785e-02
 6.54595271e-02 6.63235085e-03 6.63235085e-03 4.88133766e-02
 1.82240903e-02 6.76634582e-03 2.34637395e-01 6.71429560e-02
 9.33914706e-02 7.48904198e-02 4.49505597e-02 6.44876137e-02
 6.44875988e-02 6.16126433e-02 2.24322565e-02 6.63235085e-03
 2.37590764e-02 6.28723949e-02 7.48904049e-02 2.93070301e-02
 3.08337454e-02 7.93806557e-03 7.00051896e-03 7.00053154e-03
 7.00053154e-03 7.00053154e-03 7.00051896e-03 3.85216698e-02
 6.07493408e-02 7.00053154e-03 7.00053107e-03 6.63235085e-03
 1.71926823e-02 6.63235085e-03 6.44876137e-02 7.10096434e-02
 7.33859316e-02 1.77150369e-02 6.44876137e-02 9.57849994e-02
 4.11924683e-02 2.81962082e-02 4.11926582e-02 6.63236110e-03
 6.44876137e-02 7.93166831e-03 6.55644434e-03 6.55644434e-03
 7.00053154e-03 7.93167856e-03 8.09209645e-02 1.83351580e-02
 4.49810550e-02 6.63235085e-03 7.00053154e-03 1.52171711e-02
 6.55644434e-03 1.19902939e-02 7.93806557e-03 1.26668606e-02
 3.85211632e-02 2.38262147e-01 1.26668522e-02 2.61450022e-01
 2.75366101e-02 7.93805160e-03 3.31323184e-02 7.50675192e-03
 7.79280160e-03 1.53036034e-02 6.48611039e-02 7.90377986e-03
 6.38893768e-02 7.93806557e-03 7.93806836e-03 7.93806557e-03
 6.80996012e-03 7.93806836e-03 7.93806836e-03 7.79280160e-03
 7.93806557e-03 7.93806557e-03 7.93806557e-03 3.01433131e-02
 7.54680159e-03 9.10284966e-02 1.06554113e-01 6.08567670e-02
 3.22347134e-02 7.71221658e-03 9.48577896e-02 5.05063891e-01
 8.35864153e-03 8.38705059e-03 1.63233224e-02 5.04638366e-02
 5.04638031e-02 7.79280160e-03 2.96094477e-01 1.47814766e-01
 8.35421309e-03 9.35067609e-03 6.58676252e-02 2.72016406e-01
 1.01401079e-02 1.01401079e-02 1.01401079e-02 1.17167505e-02
 8.88644066e-03 1.34525314e-01 8.85864869e-02 2.20988885e-01
 5.11988923e-02 1.13960486e-02 2.69288942e-02 9.35067609e-03
 3.38675231e-02 4.02475595e-02 7.29414402e-03 7.03681707e-02
 8.35420284e-03 1.47814110e-01 9.35067609e-03 4.02472354e-02
 1.13960486e-02 2.35129178e-01 1.01401079e-02 1.17167542e-02
 7.29416264e-03 2.89953519e-02 5.18292189e-02 1.17167579e-02
 1.17167505e-02 1.17167505e-02 2.88864002e-02 4.65592556e-02
 1.50885820e+00 1.01401079e-02 1.14589170e-01 1.17167542e-02
 6.90232739e-02 3.37540992e-02 4.78594512e-01 3.37540656e-02
 1.17167579e-02 1.49497772e-02 3.23811844e-02 9.79433302e-03
 2.06912860e-01 3.37540433e-02 7.74128020e-01 5.16851544e-02
 8.50774348e-02 3.37540992e-02 7.85617307e-02 5.40134050e-02
 4.54217754e-02 1.22146249e-01 5.80979511e-02 1.21204425e-02
 1.21204490e-02 1.22146174e-01 2.06912830e-01 1.49497772e-02
 3.37540992e-02 4.54218052e-02 3.37540992e-02 1.45525439e-02
 1.45525485e-02 1.45525439e-02 1.13014989e-02 1.46219313e-01
 1.45525439e-02 1.45525485e-02 1.43619096e-02 1.05505735e-01
 1.45525439e-02 1.45525485e-02 1.90608073e-02 7.40486160e-02
 1.62073627e-01 1.38910234e-01 1.45525439e-02 7.72568360e-02
 1.05505683e-01 1.45525439e-02 2.01201141e-02 4.15387042e-02
 1.80107579e-02 1.43619096e-02 2.79889643e-01 4.15387005e-02
 1.45525439e-02 4.15387042e-02 3.94257903e-02 1.60054684e-01
 8.98178443e-02 1.45525439e-02 2.99132615e-01 3.94258238e-02
 3.94258015e-02 7.40486160e-02 2.52572130e-02 3.94258015e-02
 2.01200936e-02 5.32479137e-02 2.24480703e-02 5.99004366e-02
 4.39524651e-02 5.99004366e-02 2.64004797e-01 2.01200936e-02
 4.39524651e-02 3.42651196e-02 3.42650972e-02 6.84870481e-01
 3.42651196e-02 8.06098953e-02 2.52572261e-02 6.01878092e-02
 3.85922343e-02 2.24480703e-02 3.85922194e-02 2.54902691e-01
 2.01201029e-02 2.02885881e-01 3.42651196e-02 6.01479299e-02
 5.32479137e-02 3.42651196e-02 1.90329313e-01 2.24480964e-02
 6.01479262e-02 2.24480703e-02]
2025-06-02 15:53:49,808 - DEBUG - Edge reconstruction errors: [  5.2635236   5.2625747  44.259083  ...  13.359058  535.25946
  13.359049 ]
2025-06-02 15:53:49,809 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155349_update_36.json
2025-06-02 15:53:49,810 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:53:49,820 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155349_update_36.pth and as latest_checkpoint.pth
2025-06-02 15:53:49,820 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870175.dot): 0.6727
2025-06-02 15:53:49,820 - WARNING - Detected 6 anomalous nodes (reconstruction-based):
2025-06-02 15:53:49,821 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.3083, MLP Score: 0.4902
2025-06-02 15:53:49,821 - WARNING -   Node ID: 192.168.27.13, Recon Error: 2.4064, MLP Score: 0.4608
2025-06-02 15:53:49,821 - WARNING -   Node ID: 192.168.27.12, Recon Error: 1.4571, MLP Score: 0.4573
2025-06-02 15:53:49,821 - WARNING -   Node ID: 192.168.27.10, Recon Error: 3.1487, MLP Score: 0.4632
2025-06-02 15:53:49,821 - WARNING -   Node ID: 183.81.34.26, Recon Error: 8.3146, MLP Score: 0.4608
2025-06-02 15:53:49,821 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:53:49,821 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2591, MLP Score: 0.0460
2025-06-02 15:53:49,821 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9608, MLP Score: 0.0114
2025-06-02 15:53:49,821 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0615, MLP Score: 0.0114
2025-06-02 15:53:49,821 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7601, MLP Score: 0.0068
2025-06-02 15:53:49,821 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7594, MLP Score: 0.0063
2025-06-02 15:53:49,832 - DEBUG - Embedding standard deviations before t-SNE: [0.97250843 0.         0.46331608 1.2779186  2.1594617  0.
 0.90394545 1.1756294  0.79631954 1.6843535  1.1105249  0.6915676
 1.7159481  0.         0.85088676 1.223583   0.48435426 0.4174714
 0.         1.054515   2.7218933  1.1015123  0.         1.8000144
 0.5590814  1.3447627  0.         1.1901722  1.2686958  0.
 0.5177565  1.3928906 ]
2025-06-02 15:53:50,971 - INFO - Embeddings visualization saved to vis/embeddings_36_updates_20250602_155349.png
2025-06-02 15:53:50,971 - INFO - Performing visualization of node and edge features.
2025-06-02 15:53:50,972 - INFO - Starting visualization of node features.
2025-06-02 15:53:50,973 - INFO - Graph has 866 nodes and 30 features.
2025-06-02 15:53:50,973 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:53:50,973 - INFO - Calculating feature statistics:
2025-06-02 15:53:50,973 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:53:50,973 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:53:50,973 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 19, 'mean': np.float32(-3.5239697e-08), 'std': np.float32(1.0), 'min': np.float32(-2.0430336), 'max': np.float32(2.4478908)}
2025-06-02 15:53:50,973 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 19, 'mean': np.float32(-7.0479395e-08), 'std': np.float32(1.0), 'min': np.float32(-2.36622), 'max': np.float32(2.1294224)}
2025-06-02 15:53:50,973 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:53:50,973 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:53:50,974 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:53:50,974 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(1.7619849e-08), 'std': np.float32(1.0), 'min': np.float32(-0.45955282), 'max': np.float32(2.1760283)}
2025-06-02 15:53:50,974 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-1.1335609), 'max': np.float32(0.88217574)}
2025-06-02 15:53:50,974 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 4, 'mean': np.float32(-1.7619849e-08), 'std': np.float32(1.0), 'min': np.float32(-9.6710415), 'max': np.float32(0.106151916)}
2025-06-02 15:53:50,974 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 19, 'mean': np.float32(1.7619849e-08), 'std': np.float32(1.0), 'min': np.float32(-2.6916394), 'max': np.float32(1.5956728)}
2025-06-02 15:53:50,974 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 19, 'mean': np.float32(1.7619849e-08), 'std': np.float32(1.0), 'min': np.float32(-1.5623697), 'max': np.float32(2.8000467)}
2025-06-02 15:53:50,974 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 8, 'mean': np.float32(2.3048499), 'std': np.float32(0.9985669), 'min': np.float32(0.0), 'max': np.float32(11.0)}
2025-06-02 15:53:50,974 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.9584296), 'std': np.float32(0.28532922), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:53:50,974 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.1443418), 'std': np.float32(0.3674977), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:53:50,974 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.400693), 'std': np.float32(0.57060355), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:53:50,975 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 4, 'mean': np.float32(1.7619849e-08), 'std': np.float32(1.0), 'min': np.float32(-0.106151916), 'max': np.float32(9.6710415)}
2025-06-02 15:53:50,975 - INFO - - service_1: {'name': 'service_1', 'unique': 5, 'mean': np.float32(3.3418014), 'std': np.float32(2.995151), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 15:53:50,975 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.8198614), 'std': np.float32(2.8945873), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:53:50,975 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.6073904), 'std': np.float32(1.4946064), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:53:50,975 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.1443418), 'std': np.float32(0.3674977), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:53:50,975 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 2, 'mean': np.float32(7.9919167), 'std': np.float32(0.23773229), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:53:50,975 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(-1.982233e-08), 'std': np.float32(1.0), 'min': np.float32(-0.133326), 'max': np.float32(15.61126)}
2025-06-02 15:53:50,975 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(2.4227292e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.14569288), 'max': np.float32(6.8637533)}
2025-06-02 15:53:50,975 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:53:50,975 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:53:50,975 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:53:50,975 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:53:50,976 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(8.809924e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.9807018), 'max': np.float32(8.856608)}
2025-06-02 15:53:50,976 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(2.6429774e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.0817144), 'max': np.float32(4.494266)}
2025-06-02 15:53:50,990 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x72fda5329460>
2025-06-02 15:53:51,151 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:53:51,232 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:53:51,283 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:53:52,903 - INFO - Node feature visualization saved to vis/node_features_20250602_155351.png
2025-06-02 15:53:52,903 - INFO - Finished visualization of node features.
2025-06-02 15:53:52,903 - INFO - Performing additional feature analysis:
2025-06-02 15:53:52,904 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:53:52,905 - INFO - Starting visualization of edge features.
2025-06-02 15:53:52,905 - INFO - Graph has 1848 edges and 10 edge features.
2025-06-02 15:53:52,905 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:53:52,905 - INFO - Calculating edge feature statistics:
2025-06-02 15:53:52,906 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:53:52,906 - INFO - - count: {'name': 'count', 'unique': 32, 'mean': np.float32(-2.0642301e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.036982697), 'max': np.float32(35.559486)}
2025-06-02 15:53:52,906 - INFO - - dst_port: {'name': 'dst_port', 'unique': 18, 'mean': np.float32(459.8052), 'std': np.float32(473.8855), 'min': np.float32(0.0), 'max': np.float32(8898.0)}
2025-06-02 15:53:52,906 - INFO - - protocol: {'name': 'protocol', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:53:52,906 - INFO - - service: {'name': 'service', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:53:52,906 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 1235, 'mean': np.float32(-2.0642301e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.05767335), 'max': np.float32(34.11734)}
2025-06-02 15:53:52,906 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 1316, 'mean': np.float32(2.0642301e-09), 'std': np.float32(1.0), 'min': np.float32(-0.05346426), 'max': np.float32(34.90347)}
2025-06-02 15:53:52,906 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 421, 'mean': np.float32(1.0321151e-09), 'std': np.float32(1.0), 'min': np.float32(-0.045245994), 'max': np.float32(35.391674)}
2025-06-02 15:53:52,906 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 1284, 'mean': np.float32(-4.1284602e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.08053714), 'max': np.float32(28.465456)}
2025-06-02 15:53:52,906 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 1305, 'mean': np.float32(3.0963452e-09), 'std': np.float32(1.0), 'min': np.float32(-0.081029944), 'max': np.float32(27.663826)}
2025-06-02 15:53:52,906 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 468, 'mean': np.float32(1.0321151e-09), 'std': np.float32(1.0), 'min': np.float32(-0.05446046), 'max': np.float32(34.686768)}
2025-06-02 15:53:52,918 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x72fd95926fc0>
2025-06-02 15:53:53,017 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:53:53,029 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x72fd95b34a10>
2025-06-02 15:53:53,136 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:53:53,466 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:53:53,619 - DEBUG - Plotted boxplots of the first 8 non-constant edge features.
2025-06-02 15:53:53,856 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:53:53,863 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:53:55,310 - INFO - Edge feature visualization saved to vis/edge_features_20250602_155353.png
2025-06-02 15:53:55,310 - INFO - Finished visualization of edge features.
2025-06-02 15:53:55,310 - INFO - Performing additional edge feature analysis:
2025-06-02 15:53:55,310 - INFO - - 2 out of 10 edge features are constant.
2025-06-02 15:53:55,311 - INFO - - Highest correlation (1.00) between features: 'total_resp_bytes' and 'total_resp_ip_bytes'.
2025-06-02 15:53:55,312 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:53:55,312 - INFO - Graph has 1848 edges and 10 edge features.
2025-06-02 15:53:55,312 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:53:55,621 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_155355_summary.png
2025-06-02 15:53:55,945 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_155355_pca_3d.png
2025-06-02 15:53:56,159 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_155355_pca_variance.png
2025-06-02 15:53:56,159 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:53:56,159 - INFO - 
--- Processing file: nw_graph_encoded_1748870205.dot (Timestamp: 2025-06-02 15:16:45) ---
2025-06-02 15:53:56,159 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870205.dot
2025-06-02 15:53:56,159 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870205.dot'.
2025-06-02 15:53:56,160 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870205.dot
2025-06-02 15:53:56,181 - INFO - Parsed 894 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870205.dot'.
2025-06-02 15:53:56,204 - INFO - Parsed 1887 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870205.dot'.
2025-06-02 15:53:56,204 - INFO - Processing node updates/additions.
2025-06-02 15:53:56,212 - INFO - Processing edge updates/additions.
2025-06-02 15:53:56,225 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:53:56,226 - INFO - Finished updating NetworkX graph.
2025-06-02 15:53:56,227 - DEBUG - Updated graph - Nodes: 894, Edges: 1887
2025-06-02 15:53:56,227 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:53:56,228 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:53:56,238 - DEBUG - Initial node features tensor shape: torch.Size([894, 30])
2025-06-02 15:53:56,246 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:53:56,249 - DEBUG - Node features tensor shape after scaling: torch.Size([894, 30])
2025-06-02 15:53:56,252 - DEBUG - Edge index tensor shape: torch.Size([2, 1887])
2025-06-02 15:53:56,254 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:53:56,262 - DEBUG - Initial edge attributes tensor shape: torch.Size([1887, 10])
2025-06-02 15:53:56,264 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:53:56,264 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1887, 10])
2025-06-02 15:53:56,264 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:53:56,265 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:53:56,266 - INFO - Updated main graph to 894 nodes and 1887 edges.
2025-06-02 15:53:56,266 - INFO - Performing online update...
2025-06-02 15:53:56,267 - INFO - Starting online update for 50 steps.
2025-06-02 15:53:56,268 - DEBUG - Updated RunningStats: new_mean=0.9438541060834249, new_var=56400000000162.055, new_n=5670
2025-06-02 15:53:56,268 - DEBUG - Updated RunningStats: new_mean=0.9427690202192172, new_var=56700000000017.94, new_n=5700
2025-06-02 15:53:56,268 - DEBUG - Updated RunningStats: new_mean=44.65822991507393, new_var=18800000189523.01, new_n=1890
2025-06-02 15:53:56,269 - DEBUG - Updated RunningStats: new_mean=44.6738959376059, new_var=18900000197689.98, new_n=1900
2025-06-02 15:53:56,269 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:53:56,269 - DEBUG - Online update step: 1/50
2025-06-02 15:53:56,273 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:56,365 - DEBUG - Node anomaly scores shape: torch.Size([15988, 1])
2025-06-02 15:53:56,371 - DEBUG - Edge anomaly scores shape: torch.Size([32918, 1])
2025-06-02 15:53:56,374 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:56,682 - DEBUG - Step 1: Loss=0.6986
2025-06-02 15:53:56,683 - DEBUG - Online update step: 2/50
2025-06-02 15:53:56,690 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:56,799 - DEBUG - Node anomaly scores shape: torch.Size([15323, 1])
2025-06-02 15:53:56,803 - DEBUG - Edge anomaly scores shape: torch.Size([31432, 1])
2025-06-02 15:53:56,805 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:57,057 - DEBUG - Step 2: Loss=0.7106
2025-06-02 15:53:57,057 - DEBUG - Online update step: 3/50
2025-06-02 15:53:57,066 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:57,181 - DEBUG - Node anomaly scores shape: torch.Size([16431, 1])
2025-06-02 15:53:57,186 - DEBUG - Edge anomaly scores shape: torch.Size([34020, 1])
2025-06-02 15:53:57,189 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:57,441 - DEBUG - Step 3: Loss=0.6831
2025-06-02 15:53:57,442 - DEBUG - Online update step: 4/50
2025-06-02 15:53:57,453 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:57,568 - DEBUG - Node anomaly scores shape: torch.Size([15985, 1])
2025-06-02 15:53:57,573 - DEBUG - Edge anomaly scores shape: torch.Size([32992, 1])
2025-06-02 15:53:57,575 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:57,824 - DEBUG - Step 4: Loss=0.6957
2025-06-02 15:53:57,825 - DEBUG - Online update step: 5/50
2025-06-02 15:53:57,833 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:57,966 - DEBUG - Node anomaly scores shape: torch.Size([16156, 1])
2025-06-02 15:53:57,972 - DEBUG - Edge anomaly scores shape: torch.Size([33335, 1])
2025-06-02 15:53:57,975 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:58,198 - DEBUG - Step 5: Loss=0.7070
2025-06-02 15:53:58,199 - DEBUG - Online update step: 6/50
2025-06-02 15:53:58,202 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:58,321 - DEBUG - Node anomaly scores shape: torch.Size([16251, 1])
2025-06-02 15:53:58,328 - DEBUG - Edge anomaly scores shape: torch.Size([33653, 1])
2025-06-02 15:53:58,329 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:58,577 - DEBUG - Step 6: Loss=0.6813
2025-06-02 15:53:58,577 - DEBUG - Online update step: 7/50
2025-06-02 15:53:58,580 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:58,745 - DEBUG - Node anomaly scores shape: torch.Size([15767, 1])
2025-06-02 15:53:58,751 - DEBUG - Edge anomaly scores shape: torch.Size([32381, 1])
2025-06-02 15:53:58,754 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:59,002 - DEBUG - Step 7: Loss=0.6908
2025-06-02 15:53:59,002 - DEBUG - Online update step: 8/50
2025-06-02 15:53:59,005 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:59,109 - DEBUG - Node anomaly scores shape: torch.Size([15208, 1])
2025-06-02 15:53:59,117 - DEBUG - Edge anomaly scores shape: torch.Size([31223, 1])
2025-06-02 15:53:59,118 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:59,333 - DEBUG - Step 8: Loss=0.7042
2025-06-02 15:53:59,333 - DEBUG - Online update step: 9/50
2025-06-02 15:53:59,343 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:59,435 - DEBUG - Node anomaly scores shape: torch.Size([14995, 1])
2025-06-02 15:53:59,440 - DEBUG - Edge anomaly scores shape: torch.Size([30731, 1])
2025-06-02 15:53:59,441 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:53:59,662 - DEBUG - Step 9: Loss=0.6778
2025-06-02 15:53:59,662 - DEBUG - Online update step: 10/50
2025-06-02 15:53:59,671 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:53:59,779 - DEBUG - Node anomaly scores shape: torch.Size([15926, 1])
2025-06-02 15:53:59,784 - DEBUG - Edge anomaly scores shape: torch.Size([32906, 1])
2025-06-02 15:53:59,786 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:00,019 - DEBUG - Step 10: Loss=0.6891
2025-06-02 15:54:00,019 - DEBUG - Online update step: 11/50
2025-06-02 15:54:00,027 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:00,110 - DEBUG - Node anomaly scores shape: torch.Size([14729, 1])
2025-06-02 15:54:00,114 - DEBUG - Edge anomaly scores shape: torch.Size([30157, 1])
2025-06-02 15:54:00,116 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:00,303 - DEBUG - Step 11: Loss=0.7026
2025-06-02 15:54:00,304 - DEBUG - Online update step: 12/50
2025-06-02 15:54:00,310 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:00,421 - DEBUG - Node anomaly scores shape: torch.Size([14918, 1])
2025-06-02 15:54:00,425 - DEBUG - Edge anomaly scores shape: torch.Size([30576, 1])
2025-06-02 15:54:00,427 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:00,662 - DEBUG - Step 12: Loss=0.6757
2025-06-02 15:54:00,663 - DEBUG - Online update step: 13/50
2025-06-02 15:54:00,671 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:00,774 - DEBUG - Node anomaly scores shape: torch.Size([15063, 1])
2025-06-02 15:54:00,779 - DEBUG - Edge anomaly scores shape: torch.Size([30963, 1])
2025-06-02 15:54:00,781 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:01,018 - DEBUG - Step 13: Loss=0.6887
2025-06-02 15:54:01,019 - DEBUG - Online update step: 14/50
2025-06-02 15:54:01,026 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:01,132 - DEBUG - Node anomaly scores shape: torch.Size([15708, 1])
2025-06-02 15:54:01,138 - DEBUG - Edge anomaly scores shape: torch.Size([32358, 1])
2025-06-02 15:54:01,140 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:01,409 - DEBUG - Step 14: Loss=0.7039
2025-06-02 15:54:01,410 - DEBUG - Online update step: 15/50
2025-06-02 15:54:01,421 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:01,551 - DEBUG - Node anomaly scores shape: torch.Size([15333, 1])
2025-06-02 15:54:01,557 - DEBUG - Edge anomaly scores shape: torch.Size([31395, 1])
2025-06-02 15:54:01,559 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:01,851 - DEBUG - Step 15: Loss=0.6777
2025-06-02 15:54:01,851 - DEBUG - Online update step: 16/50
2025-06-02 15:54:01,862 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:02,013 - DEBUG - Node anomaly scores shape: torch.Size([15931, 1])
2025-06-02 15:54:02,020 - DEBUG - Edge anomaly scores shape: torch.Size([32840, 1])
2025-06-02 15:54:02,021 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:02,249 - DEBUG - Step 16: Loss=0.6844
2025-06-02 15:54:02,249 - DEBUG - Online update step: 17/50
2025-06-02 15:54:02,252 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:02,353 - DEBUG - Node anomaly scores shape: torch.Size([16328, 1])
2025-06-02 15:54:02,357 - DEBUG - Edge anomaly scores shape: torch.Size([33791, 1])
2025-06-02 15:54:02,358 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:02,560 - DEBUG - Step 17: Loss=0.6983
2025-06-02 15:54:02,561 - DEBUG - Online update step: 18/50
2025-06-02 15:54:02,564 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:02,662 - DEBUG - Node anomaly scores shape: torch.Size([15845, 1])
2025-06-02 15:54:02,667 - DEBUG - Edge anomaly scores shape: torch.Size([32791, 1])
2025-06-02 15:54:02,669 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:02,873 - DEBUG - Step 18: Loss=0.6731
2025-06-02 15:54:02,873 - DEBUG - Online update step: 19/50
2025-06-02 15:54:02,877 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:03,040 - DEBUG - Node anomaly scores shape: torch.Size([14987, 1])
2025-06-02 15:54:03,048 - DEBUG - Edge anomaly scores shape: torch.Size([30702, 1])
2025-06-02 15:54:03,049 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:03,268 - DEBUG - Step 19: Loss=0.6865
2025-06-02 15:54:03,268 - DEBUG - Online update step: 20/50
2025-06-02 15:54:03,272 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:03,368 - DEBUG - Node anomaly scores shape: torch.Size([15722, 1])
2025-06-02 15:54:03,373 - DEBUG - Edge anomaly scores shape: torch.Size([32341, 1])
2025-06-02 15:54:03,374 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:03,571 - DEBUG - Step 20: Loss=0.6986
2025-06-02 15:54:03,572 - DEBUG - Online update step: 21/50
2025-06-02 15:54:03,582 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:03,683 - DEBUG - Node anomaly scores shape: torch.Size([15381, 1])
2025-06-02 15:54:03,688 - DEBUG - Edge anomaly scores shape: torch.Size([31669, 1])
2025-06-02 15:54:03,689 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:03,890 - DEBUG - Step 21: Loss=0.6737
2025-06-02 15:54:03,891 - DEBUG - Online update step: 22/50
2025-06-02 15:54:03,898 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:03,991 - DEBUG - Node anomaly scores shape: torch.Size([16226, 1])
2025-06-02 15:54:03,995 - DEBUG - Edge anomaly scores shape: torch.Size([33446, 1])
2025-06-02 15:54:03,997 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:04,288 - DEBUG - Step 22: Loss=0.6820
2025-06-02 15:54:04,289 - DEBUG - Online update step: 23/50
2025-06-02 15:54:04,292 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:04,397 - DEBUG - Node anomaly scores shape: torch.Size([16104, 1])
2025-06-02 15:54:04,401 - DEBUG - Edge anomaly scores shape: torch.Size([33222, 1])
2025-06-02 15:54:04,402 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:04,632 - DEBUG - Step 23: Loss=0.6927
2025-06-02 15:54:04,632 - DEBUG - Online update step: 24/50
2025-06-02 15:54:04,636 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:04,858 - DEBUG - Node anomaly scores shape: torch.Size([15923, 1])
2025-06-02 15:54:04,872 - DEBUG - Edge anomaly scores shape: torch.Size([32781, 1])
2025-06-02 15:54:04,873 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:05,075 - DEBUG - Step 24: Loss=0.6678
2025-06-02 15:54:05,075 - DEBUG - Online update step: 25/50
2025-06-02 15:54:05,079 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:05,188 - DEBUG - Node anomaly scores shape: torch.Size([15592, 1])
2025-06-02 15:54:05,192 - DEBUG - Edge anomaly scores shape: torch.Size([32118, 1])
2025-06-02 15:54:05,193 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:05,521 - DEBUG - Step 25: Loss=0.6842
2025-06-02 15:54:05,522 - DEBUG - Online update step: 26/50
2025-06-02 15:54:05,525 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:05,684 - DEBUG - Node anomaly scores shape: torch.Size([16823, 1])
2025-06-02 15:54:05,691 - DEBUG - Edge anomaly scores shape: torch.Size([34843, 1])
2025-06-02 15:54:05,692 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:05,965 - DEBUG - Step 26: Loss=0.6953
2025-06-02 15:54:05,966 - DEBUG - Online update step: 27/50
2025-06-02 15:54:05,969 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:06,065 - DEBUG - Node anomaly scores shape: torch.Size([15516, 1])
2025-06-02 15:54:06,071 - DEBUG - Edge anomaly scores shape: torch.Size([32001, 1])
2025-06-02 15:54:06,074 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:06,273 - DEBUG - Step 27: Loss=0.6694
2025-06-02 15:54:06,274 - DEBUG - Online update step: 28/50
2025-06-02 15:54:06,287 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:06,378 - DEBUG - Node anomaly scores shape: torch.Size([15191, 1])
2025-06-02 15:54:06,382 - DEBUG - Edge anomaly scores shape: torch.Size([31267, 1])
2025-06-02 15:54:06,383 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:06,606 - DEBUG - Step 28: Loss=0.6772
2025-06-02 15:54:06,606 - DEBUG - Online update step: 29/50
2025-06-02 15:54:06,610 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:06,709 - DEBUG - Node anomaly scores shape: torch.Size([16801, 1])
2025-06-02 15:54:06,718 - DEBUG - Edge anomaly scores shape: torch.Size([34718, 1])
2025-06-02 15:54:06,719 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:06,916 - DEBUG - Step 29: Loss=0.6901
2025-06-02 15:54:06,917 - DEBUG - Online update step: 30/50
2025-06-02 15:54:06,920 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:07,016 - DEBUG - Node anomaly scores shape: torch.Size([16167, 1])
2025-06-02 15:54:07,024 - DEBUG - Edge anomaly scores shape: torch.Size([33225, 1])
2025-06-02 15:54:07,027 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:07,237 - DEBUG - Step 30: Loss=0.6651
2025-06-02 15:54:07,237 - DEBUG - Online update step: 31/50
2025-06-02 15:54:07,241 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:07,334 - DEBUG - Node anomaly scores shape: torch.Size([15215, 1])
2025-06-02 15:54:07,341 - DEBUG - Edge anomaly scores shape: torch.Size([31281, 1])
2025-06-02 15:54:07,344 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:07,650 - DEBUG - Step 31: Loss=0.6803
2025-06-02 15:54:07,651 - DEBUG - Online update step: 32/50
2025-06-02 15:54:07,655 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:07,840 - DEBUG - Node anomaly scores shape: torch.Size([16180, 1])
2025-06-02 15:54:07,851 - DEBUG - Edge anomaly scores shape: torch.Size([33413, 1])
2025-06-02 15:54:07,852 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:08,084 - DEBUG - Step 32: Loss=0.6930
2025-06-02 15:54:08,084 - DEBUG - Online update step: 33/50
2025-06-02 15:54:08,088 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:08,220 - DEBUG - Node anomaly scores shape: torch.Size([16105, 1])
2025-06-02 15:54:08,226 - DEBUG - Edge anomaly scores shape: torch.Size([33202, 1])
2025-06-02 15:54:08,227 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:08,423 - DEBUG - Step 33: Loss=0.6679
2025-06-02 15:54:08,424 - DEBUG - Online update step: 34/50
2025-06-02 15:54:08,427 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:08,603 - DEBUG - Node anomaly scores shape: torch.Size([16742, 1])
2025-06-02 15:54:08,612 - DEBUG - Edge anomaly scores shape: torch.Size([34655, 1])
2025-06-02 15:54:08,619 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:08,991 - DEBUG - Step 34: Loss=0.6746
2025-06-02 15:54:08,991 - DEBUG - Online update step: 35/50
2025-06-02 15:54:08,994 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:09,120 - DEBUG - Node anomaly scores shape: torch.Size([16372, 1])
2025-06-02 15:54:09,131 - DEBUG - Edge anomaly scores shape: torch.Size([33860, 1])
2025-06-02 15:54:09,133 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:09,572 - DEBUG - Step 35: Loss=0.6870
2025-06-02 15:54:09,573 - DEBUG - Online update step: 36/50
2025-06-02 15:54:09,592 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:09,740 - DEBUG - Node anomaly scores shape: torch.Size([15449, 1])
2025-06-02 15:54:09,748 - DEBUG - Edge anomaly scores shape: torch.Size([31733, 1])
2025-06-02 15:54:09,752 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:10,151 - DEBUG - Step 36: Loss=0.6627
2025-06-02 15:54:10,151 - DEBUG - Online update step: 37/50
2025-06-02 15:54:10,155 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:10,347 - DEBUG - Node anomaly scores shape: torch.Size([16652, 1])
2025-06-02 15:54:10,361 - DEBUG - Edge anomaly scores shape: torch.Size([34426, 1])
2025-06-02 15:54:10,364 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:10,719 - DEBUG - Step 37: Loss=0.6776
2025-06-02 15:54:10,719 - DEBUG - Online update step: 38/50
2025-06-02 15:54:10,723 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:10,887 - DEBUG - Node anomaly scores shape: torch.Size([15422, 1])
2025-06-02 15:54:10,895 - DEBUG - Edge anomaly scores shape: torch.Size([31585, 1])
2025-06-02 15:54:10,896 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:11,393 - DEBUG - Step 38: Loss=0.6907
2025-06-02 15:54:11,393 - DEBUG - Online update step: 39/50
2025-06-02 15:54:11,397 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:11,540 - DEBUG - Node anomaly scores shape: torch.Size([14553, 1])
2025-06-02 15:54:11,547 - DEBUG - Edge anomaly scores shape: torch.Size([29758, 1])
2025-06-02 15:54:11,549 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:11,894 - DEBUG - Step 39: Loss=0.6663
2025-06-02 15:54:11,895 - DEBUG - Online update step: 40/50
2025-06-02 15:54:11,899 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:12,098 - DEBUG - Node anomaly scores shape: torch.Size([16330, 1])
2025-06-02 15:54:12,112 - DEBUG - Edge anomaly scores shape: torch.Size([33794, 1])
2025-06-02 15:54:12,122 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:12,478 - DEBUG - Step 40: Loss=0.6724
2025-06-02 15:54:12,478 - DEBUG - Online update step: 41/50
2025-06-02 15:54:12,481 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:12,601 - DEBUG - Node anomaly scores shape: torch.Size([15605, 1])
2025-06-02 15:54:12,611 - DEBUG - Edge anomaly scores shape: torch.Size([32035, 1])
2025-06-02 15:54:12,614 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:12,938 - DEBUG - Step 41: Loss=0.6843
2025-06-02 15:54:12,939 - DEBUG - Online update step: 42/50
2025-06-02 15:54:12,942 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:13,042 - DEBUG - Node anomaly scores shape: torch.Size([15577, 1])
2025-06-02 15:54:13,049 - DEBUG - Edge anomaly scores shape: torch.Size([32118, 1])
2025-06-02 15:54:13,050 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:13,287 - DEBUG - Step 42: Loss=0.6593
2025-06-02 15:54:13,287 - DEBUG - Online update step: 43/50
2025-06-02 15:54:13,290 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:13,383 - DEBUG - Node anomaly scores shape: torch.Size([15347, 1])
2025-06-02 15:54:13,388 - DEBUG - Edge anomaly scores shape: torch.Size([31505, 1])
2025-06-02 15:54:13,389 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:13,650 - DEBUG - Step 43: Loss=0.6768
2025-06-02 15:54:13,651 - DEBUG - Online update step: 44/50
2025-06-02 15:54:13,655 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:13,740 - DEBUG - Node anomaly scores shape: torch.Size([16161, 1])
2025-06-02 15:54:13,744 - DEBUG - Edge anomaly scores shape: torch.Size([33220, 1])
2025-06-02 15:54:13,745 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:13,933 - DEBUG - Step 44: Loss=0.6881
2025-06-02 15:54:13,933 - DEBUG - Online update step: 45/50
2025-06-02 15:54:13,936 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:14,027 - DEBUG - Node anomaly scores shape: torch.Size([15694, 1])
2025-06-02 15:54:14,031 - DEBUG - Edge anomaly scores shape: torch.Size([32301, 1])
2025-06-02 15:54:14,032 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:14,216 - DEBUG - Step 45: Loss=0.6631
2025-06-02 15:54:14,216 - DEBUG - Online update step: 46/50
2025-06-02 15:54:14,220 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:14,316 - DEBUG - Node anomaly scores shape: torch.Size([16599, 1])
2025-06-02 15:54:14,321 - DEBUG - Edge anomaly scores shape: torch.Size([34372, 1])
2025-06-02 15:54:14,322 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:14,543 - DEBUG - Step 46: Loss=0.6703
2025-06-02 15:54:14,543 - DEBUG - Online update step: 47/50
2025-06-02 15:54:14,546 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:14,636 - DEBUG - Node anomaly scores shape: torch.Size([15042, 1])
2025-06-02 15:54:14,640 - DEBUG - Edge anomaly scores shape: torch.Size([30936, 1])
2025-06-02 15:54:14,641 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:14,826 - DEBUG - Step 47: Loss=0.6827
2025-06-02 15:54:14,826 - DEBUG - Online update step: 48/50
2025-06-02 15:54:14,829 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:14,940 - DEBUG - Node anomaly scores shape: torch.Size([15868, 1])
2025-06-02 15:54:14,945 - DEBUG - Edge anomaly scores shape: torch.Size([32686, 1])
2025-06-02 15:54:14,946 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:15,149 - DEBUG - Step 48: Loss=0.6572
2025-06-02 15:54:15,150 - DEBUG - Online update step: 49/50
2025-06-02 15:54:15,153 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:15,270 - DEBUG - Node anomaly scores shape: torch.Size([16386, 1])
2025-06-02 15:54:15,276 - DEBUG - Edge anomaly scores shape: torch.Size([33941, 1])
2025-06-02 15:54:15,279 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:15,555 - DEBUG - Step 49: Loss=0.6733
2025-06-02 15:54:15,556 - DEBUG - Online update step: 50/50
2025-06-02 15:54:15,566 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:15,682 - DEBUG - Node anomaly scores shape: torch.Size([16140, 1])
2025-06-02 15:54:15,687 - DEBUG - Edge anomaly scores shape: torch.Size([33308, 1])
2025-06-02 15:54:15,689 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:15,923 - DEBUG - Step 50: Loss=0.6858
2025-06-02 15:54:15,924 - INFO - Online update finished. Average loss: 0.6828, Learning rate: 0.001000
2025-06-02 15:54:15,926 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -4.2669992e-09 -2.7202120e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.6001247e-08
  4.2669992e-09 -6.9338735e-09  1.3867747e-08 -7.4672482e-09
  2.2941835e+00  2.9597316e+00  1.4541388e-01  4.4116330e+00
 -2.1334996e-09  3.3221476e+00  5.8680091e+00  7.6196866e+00
  1.4541388e-01  7.9921699e+00  1.8134747e-08  1.1734247e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -7.4672482e-09  8.1072983e-08], current edge mean: [-2.0215671e-09  4.5887280e+02  0.0000000e+00  0.0000000e+00
  2.0215671e-09  5.0539177e-09  0.0000000e+00 -3.5377425e-09
  3.5377425e-09  3.0323508e-09]
2025-06-02 15:54:15,927 - DEBUG - Node drift difference: 0.0192, Edge drift difference: 0.0020
2025-06-02 15:54:15,930 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -4.2669992e-09 -2.7202120e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.6001247e-08
  4.2669992e-09 -6.9338735e-09  1.3867747e-08 -7.4672482e-09
  2.2941835e+00  2.9597316e+00  1.4541388e-01  4.4116330e+00
 -2.1334996e-09  3.3221476e+00  5.8680091e+00  7.6196866e+00
  1.4541388e-01  7.9921699e+00  1.8134747e-08  1.1734247e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -7.4672482e-09  8.1072983e-08], edge=[-2.0215671e-09  4.5887280e+02  0.0000000e+00  0.0000000e+00
  2.0215671e-09  5.0539177e-09  0.0000000e+00 -3.5377425e-09
  3.5377425e-09  3.0323508e-09]
2025-06-02 15:54:15,932 - DEBUG - Updated reference std: node=[0.         0.         1.0005598  1.0005598  0.         0.
 0.         1.0005598  1.0005598  1.0005598  1.0005598  1.0005598
 0.97541434 0.28107604 0.36824727 0.5703764  1.0005598  2.9711607
 2.8818514  1.4734278  0.36824727 0.23411502 1.0005598  1.0005598
 0.         0.         0.         0.         1.0005598  1.0005597 ], edge=[  1.0002651 469.3459      0.          0.          1.0002651   1.0002651
   1.0002651   1.000265    1.0002651   1.0002651]
2025-06-02 15:54:15,933 - INFO - Online update complete. Loss: 0.6828
2025-06-02 15:54:15,933 - INFO - Running anomaly detection...
2025-06-02 15:54:15,934 - INFO - Starting anomaly detection.
2025-06-02 15:54:15,981 - DEBUG - Node reconstruction errors: [2.69451141e-01 1.55706608e+00 2.12626553e+00 4.44755182e-02
 5.68874031e-02 7.84305260e-02 1.14497817e+00 2.93120742e-02
 2.93120742e-02 5.67131788e-02 2.93120742e-02 8.38991627e-02
 2.75912118e+00 3.56349111e-01 7.65373278e-03 2.82448102e-02
 8.59401971e-02 2.82449629e-02 2.22413093e-01 2.72455998e-02
 3.29034664e-02 7.65373278e-03 1.61049828e-01 6.63679168e-02
 6.36714604e-03 3.43723558e-02 6.36714604e-03 8.83340314e-02
 2.96045113e-02 6.36714604e-03 2.73244917e-01 2.92880386e-01
 7.93570802e-02 4.38143648e-02 3.57466862e-02 9.61499661e-02
 1.49507657e-01 2.72455998e-02 1.52235001e-01 2.21603721e-01
 8.72011930e-02 7.26085855e-03 2.72456091e-02 1.50706828e-01
 1.05457634e-01 9.61761549e-02 2.20858306e-01 9.47405249e-02
 3.04907486e-02 4.57016110e-01 3.72427553e-01 3.14073637e-02
 3.28165703e-02 1.93015590e-01 4.50026952e-02 1.14010595e-01
 6.37894332e-01 3.05339117e-02 1.70550913e-01 2.46021703e-01
 3.23039323e-01 1.22140206e-01 7.02390727e-03 5.86974807e-02
 5.66244544e-03 4.50026244e-02 3.44627500e-02 4.50024754e-02
 7.02390727e-03 1.22140206e-01 7.35684708e-02 8.00437033e-02
 1.74047127e-02 1.45666167e-01 1.27376944e-01 7.93649107e-02
 1.85042366e-01 7.54097179e-02 4.06257510e-02 4.78268526e-02
 4.04759012e-02 5.29016592e-02 4.47538763e-01 3.44007671e-01
 8.49564746e-02 8.18860084e-02 8.54797065e-02 8.08996707e-02
 6.88787624e-02 2.05485359e-01 5.77158714e-03 7.19186515e-02
 3.52093019e-02 5.71206957e-02 7.62963295e-02 5.92150092e-01
 3.88548560e-02 9.48691294e-02 4.29770257e-03 2.63015144e-02
 5.63327670e-02 3.88547629e-02 9.68414992e-02 3.19692165e-01
 7.61311054e-02 2.29978319e-02 5.49141057e-02 8.35239589e-02
 3.50485556e-02 2.29346931e-01 2.06953749e-01 4.58067320e-02
 5.17550558e-02 1.29963964e-01 4.90230471e-02 4.11011539e-02
 4.65796776e-02 1.04646780e-01 9.39535648e-02 2.77256574e-02
 4.64041810e-03 1.94461700e-02 1.23276554e-01 7.72823617e-02
 1.20893762e-01 2.77267396e-02 9.49123651e-02 1.17401823e-01
 1.09558180e-01 2.40710583e-02 3.08576915e-02 1.47509892e-02
 5.42098507e-02 2.82295048e-01 4.05507013e-02 2.47408021e-02
 1.05445229e-01 6.01601508e-03 2.49358788e-01 5.38232811e-02
 6.37174994e-02 6.78886250e-02 5.56213642e-03 6.37174845e-02
 5.29225208e-02 9.81080905e-02 4.65797260e-02 1.65116474e-01
 7.38364309e-02 8.26461837e-02 5.13470471e-01 7.87434876e-02
 4.67633493e-02 1.47510134e-02 5.05683869e-02 8.92356783e-02
 1.37356641e-02 4.32198606e-02 5.63330650e-02 8.84701163e-02
 6.37174845e-02 7.77621791e-02 1.37356641e-02 3.08577288e-02
 4.74347919e-02 5.20266108e-02 5.71449995e-02 3.64678614e-02
 8.49468485e-02 1.08528294e-01 5.22551052e-02 2.95458026e-02
 6.92246808e-03 3.61340404e-01 9.39542949e-02 8.33564472e+00
 4.22555208e-02 5.48193343e-02 4.80608121e-02 4.80607897e-02
 2.25527566e-02 6.08948395e-02 6.40217438e-02 1.60654470e-01
 8.00677687e-02 6.49053007e-02 5.20140491e-03 4.86006960e-02
 2.41801180e-02 1.24800093e-02 7.59330764e-02 7.39472210e-02
 6.85038045e-02 1.41856074e-02 2.49357700e-01 3.45076658e-02
 5.00441134e-01 6.82725087e-02 1.17562942e-01 1.20671496e-01
 2.15752348e-02 1.37356641e-02 7.24347457e-02 9.63377208e-02
 1.07035786e-01 7.72690997e-02 5.13092466e-02 1.41702250e-01
 3.81550542e-03 3.98528650e-02 4.07108180e-02 4.68016230e-02
 2.97665931e-02 5.55235147e-02 6.90034926e-02 7.05161085e-03
 8.90165865e-02 4.65796813e-02 1.52960464e-01 1.41856074e-02
 1.46851599e-01 5.20140491e-03 6.29213918e-03 2.97665931e-02
 1.37356641e-02 9.46419686e-02 9.98651832e-02 1.60920713e-02
 4.90630306e-02 1.69111807e-02 5.69651388e-02 7.63679519e-02
 9.77827236e-02 4.65797409e-02 4.65796739e-02 5.19869886e-02
 5.11363521e-02 6.29213918e-03 1.37356641e-02 9.41676944e-02
 8.61745849e-02 5.00140451e-02 1.68198887e-02 1.21498674e-01
 1.52268214e-02 1.21498756e-01 3.65635492e-02 7.06652254e-02
 1.68198887e-02 4.78151217e-02 6.92246808e-03 5.05483989e-03
 1.52962029e-01 4.26907130e-02 7.13258684e-02 7.02522174e-02
 1.24799935e-02 3.90043575e-03 2.79156230e-02 4.80606407e-02
 3.80144455e-02 7.53759146e-02 2.52394658e-02 7.65600279e-02
 1.01490386e-01 6.53735846e-02 6.06076382e-02 2.32315227e-01
 6.06073588e-02 3.43477987e-02 1.74453422e-01 1.36941299e-01
 5.35971783e-02 1.82805076e-01 4.96548899e-02 4.80606407e-02
 2.08116993e-02 1.24281213e-01 2.25528069e-02 7.31844530e-02
 1.86474189e-01 2.28182189e-02 3.99415493e-02 8.25659931e-02
 9.73989666e-02 3.60649861e-02 2.01789126e-01 4.89995815e-02
 6.08948432e-02 1.37639940e-01 9.30322632e-02 4.76473570e-02
 5.17145805e-02 1.52268214e-02 3.76071393e-01 9.08714440e-03
 4.57457528e-02 4.80609536e-02 3.45076658e-02 7.80428723e-02
 4.05182838e-02 4.77673253e-03 4.40201610e-02 7.96877965e-02
 4.77674091e-03 4.77674091e-03 4.77673253e-03 5.27834818e-02
 5.64231537e-02 4.77673253e-03 4.77674091e-03 5.81464358e-02
 4.77674091e-03 1.12673827e-02 8.76729414e-02 5.09091727e-02
 2.02387661e-01 4.64867502e-02 2.93202735e-02 3.86649519e-02
 5.49313016e-02 5.73411696e-02 5.96013479e-02 4.40202095e-02
 8.71483088e-02 1.47771209e-01 6.96313530e-02 8.57731029e-02
 4.47838865e-02 4.47842963e-02 2.15530232e-01 3.39703113e-02
 4.77674091e-03 4.96547073e-02 4.77674091e-03 5.27830198e-02
 5.55402711e-02 4.47674794e-03 3.70811904e-03 3.70813534e-03
 4.77673253e-03 1.43048493e-02 3.70811904e-03 8.65081847e-02
 8.26931074e-02 8.75897408e-02 4.40201126e-02 3.78643274e-02
 5.91913946e-02 4.24600840e-02 4.77674091e-03 3.31897549e-02
 1.26440927e-01 6.24391548e-02 1.13402773e-02 1.24799935e-02
 3.52694886e-03 4.77673253e-03 5.34660369e-03 3.78797978e-01
 4.07108516e-02 8.83788802e-03 1.66741207e-01 7.71638528e-02
 4.40199226e-02 5.93841374e-01 4.07237839e-03 7.72092417e-02
 4.07684408e-02 3.04186419e-02 5.31339683e-02 7.07767457e-02
 8.97871107e-02 1.17168508e-01 8.61550570e-02 6.24396577e-02
 5.73987793e-03 1.25478040e-02 6.06525764e-02 4.77674091e-03
 4.40199859e-02 1.11824736e-01 1.20492019e-02 4.18922938e-02
 1.03837952e-01 8.15476105e-02 5.89655302e-02 1.12807624e-01
 6.83432519e-02 4.77674091e-03 1.92962661e-01 1.06355555e-01
 3.79623249e-02 1.23311549e-01 6.31047040e-02 6.31047413e-02
 6.31047338e-02 1.65302008e-01 4.31129895e-03 1.67361259e-01
 1.02725653e-02 1.10038243e-01 6.31047413e-02 4.31129895e-03
 3.68622504e-02 3.79622579e-02 9.05226544e-02 2.98319962e-02
 3.79621387e-02 9.07035917e-02 6.31047338e-02 3.79621163e-02
 4.31129895e-03 6.31047264e-02 6.31047264e-02 1.09151891e-02
 1.38375554e-02 6.31047338e-02 5.73062431e-03 3.27204987e-02
 2.95088068e-02 1.63771957e-02 3.04275528e-02 1.10495202e-02
 1.21114254e-01 3.53251211e-02 2.66404729e-02 6.74015060e-02
 8.20623562e-02 2.41178311e-02 5.58581203e-02 2.05950420e-02
 4.78918627e-02 5.79143427e-02 6.31047189e-02 6.31047264e-02
 1.02725513e-02 5.85481413e-02 1.24492995e-01 2.23421995e-02
 2.49697026e-02 1.11605646e-02 1.56547174e-01 4.57309093e-03
 6.89602504e-03 7.56905600e-02 7.14919120e-02 1.11094201e-02
 3.51031013e-02 1.06347073e-02 9.22050029e-02 4.90501709e-03
 1.22564789e-02 3.95614747e-03 4.90502501e-03 2.15172004e-02
 1.10495202e-02 4.34275083e-02 5.07753342e-02 5.44300154e-02
 3.61155979e-02 1.28586749e-02 1.18540712e-02 4.95681129e-02
 1.18540963e-02 1.28586749e-02 3.60490545e-03 4.51581478e-02
 9.11693797e-02 3.51627059e-02 3.60490871e-03 3.61155756e-02
 6.30912036e-02 1.33267686e-01 1.00088201e-01 3.04274298e-02
 4.51581143e-02 3.61154601e-02 3.47211096e-03 1.45517914e-02
 3.97980213e-02 1.93236932e-01 2.54046954e-02 1.11094201e-02
 1.20264687e-01 9.72003769e-03 4.90501709e-03 1.05077259e-01
 2.91925687e-02 1.33265793e-01 2.94439960e-02 3.47211096e-03
 4.88241501e-02 3.56607116e-03 2.80797314e-02 1.14965681e-02
 3.26677002e-02 3.07510793e-01 3.95614747e-03 1.45517793e-02
 1.70246437e-01 3.56605859e-03 1.70246407e-01 2.27448829e-02
 3.32597690e-03 4.85355109e-02 2.48558051e-03 2.65288025e-01
 2.14106124e-02 4.90502501e-03 3.58130336e-02 8.92460626e-03
 8.92459881e-03 6.89602504e-03 4.86422032e-02 1.87074635e-02
 2.48558051e-03 3.71076092e-02 9.04222578e-02 6.42473400e-02
 3.71073820e-02 1.11605646e-02 2.48558051e-03 3.02398279e-02
 3.32597690e-03 3.26674841e-02 2.72716228e-02 1.40152365e-01
 3.71071957e-02 6.24682084e-02 1.87074617e-02 3.95614747e-03
 3.95614747e-03 1.45517914e-02 3.26674692e-02 3.47221866e-02
 4.84168753e-02 6.88324198e-02 3.95615119e-03 5.91169223e-02
 3.95615119e-03 5.91169707e-02 3.86867411e-02 3.71071547e-02
 8.39471165e-03 3.45004231e-01 1.05057709e-01 3.71916313e-03
 3.56546491e-01 3.71918036e-03 3.71918036e-03 3.71918036e-03
 3.71918036e-03 3.71918036e-03 3.71916313e-03 3.71918036e-03
 4.11078595e-02 8.10622051e-03 2.97913235e-02 3.71918036e-03
 3.71918036e-03 3.71918036e-03 3.71918036e-03 3.71918036e-03
 3.71918036e-03 3.71918036e-03 3.71918036e-03 3.71918036e-03
 3.53282057e-02 3.71918036e-03 3.71918036e-03 1.52564242e-01
 3.71918036e-03 8.82008448e-02 5.81424274e-02 3.95614747e-03
 7.00078905e-02 6.18017390e-02 5.32010674e-01 5.32010674e-01
 6.51094094e-02 7.00078905e-02 3.95614747e-03 2.48558051e-03
 2.48558051e-03 3.95614747e-03 2.48558051e-03 5.06976843e-02
 2.89605223e-02 3.71918036e-03 1.11605646e-02 3.95614747e-03
 8.92463047e-03 3.95614747e-03 3.95614747e-03 3.12894210e-02
 3.95614747e-03 2.48558051e-03 3.95614747e-03 3.95615119e-03
 3.71076055e-02 2.48558144e-03 3.95615119e-03 2.48558051e-03
 3.95614747e-03 3.95614747e-03 3.95615119e-03 5.20699210e-02
 9.41026956e-02 2.80798357e-02 3.71916313e-03 2.41875593e-02
 8.02679732e-02 3.95615119e-03 2.48558051e-03 6.40500262e-02
 3.71918036e-03 2.70661674e-02 5.78723811e-02 2.25266791e-03
 3.95615119e-03 3.95614747e-03 2.58492026e-02 5.72446771e-02
 2.71281190e-02 3.95615119e-03 4.11078595e-02 5.63461334e-03
 2.48558051e-03 1.24750949e-01 3.71918036e-03 3.62048633e-02
 1.01348199e-01 3.71918036e-03 3.71916313e-03 4.11088653e-02
 5.63461334e-03 3.95614747e-03 1.98765531e-01 5.90812452e-02
 7.46921077e-02 5.72447143e-02 1.88085232e-02 5.60903437e-02
 5.60903437e-02 5.67747504e-02 9.33069270e-03 3.71918036e-03
 8.47693346e-03 5.47145605e-02 5.72447143e-02 2.66542826e-02
 1.32485013e-02 1.86029151e-02 3.59335914e-03 3.59335914e-03
 3.59335914e-03 3.59335914e-03 3.59335914e-03 3.44420448e-02
 5.03041893e-02 3.59335914e-03 3.59335914e-03 3.71918036e-03
 5.90244820e-03 3.71918036e-03 5.60903437e-02 5.40438034e-02
 5.59093319e-02 1.47339804e-02 5.60903437e-02 8.23425427e-02
 3.53288054e-02 2.09338609e-02 3.53283398e-02 3.71918036e-03
 5.60903102e-02 3.15265381e-03 2.33514258e-03 2.33514258e-03
 3.59335914e-03 3.15265567e-03 6.05762713e-02 1.44117791e-02
 2.13340744e-02 3.71918036e-03 3.59335914e-03 6.09564548e-03
 2.33516446e-03 3.42335226e-03 4.47647460e-03 3.97596369e-03
 3.44417505e-02 1.66395754e-01 3.97594739e-03 1.32503331e-01
 2.26699393e-02 4.47647180e-03 9.76047199e-03 3.09899449e-03
 4.43894602e-03 5.79424808e-03 5.15027158e-02 3.67109035e-03
 5.38291223e-02 4.47647460e-03 4.47647180e-03 4.47647460e-03
 3.32877249e-03 4.47647460e-03 4.47647180e-03 4.43894602e-03
 4.47647460e-03 4.47647460e-03 4.47647180e-03 2.39703488e-02
 3.16433236e-03 6.81272745e-02 8.11736435e-02 5.06212525e-02
 9.09577403e-03 3.46341380e-03 6.58506900e-02 2.35912964e-01
 4.45744535e-03 3.34254163e-03 5.86605072e-03 2.45886911e-02
 2.45886911e-02 4.43894602e-03 1.74039468e-01 1.15895957e-01
 4.47036372e-03 3.95541638e-03 3.15058418e-02 1.42247334e-01
 3.58690764e-03 3.58690647e-03 3.58690647e-03 4.42414172e-03
 3.16652190e-03 7.63537362e-02 4.12182733e-02 1.88724607e-01
 3.64545360e-02 3.78953083e-03 8.69287737e-03 3.95541638e-03
 9.10529681e-03 2.72060316e-02 3.46410810e-03 3.22555900e-02
 4.47036466e-03 1.15895957e-01 3.95538751e-03 2.72060893e-02
 3.78953083e-03 1.60440713e-01 3.58690764e-03 4.42414172e-03
 3.46411113e-03 1.09261060e-02 2.51607727e-02 4.42414172e-03
 4.42414172e-03 4.42414172e-03 9.48530249e-03 3.41547318e-02
 1.08209634e+00 3.58690647e-03 7.68872574e-02 4.42414172e-03
 4.72748950e-02 1.26358429e-02 2.49273404e-01 1.26358429e-02
 4.42414172e-03 4.96295886e-03 1.06476219e-02 4.46048053e-03
 1.71806097e-01 1.26358727e-02 4.38723445e-01 3.61117199e-02
 8.81433710e-02 1.26358727e-02 4.80474420e-02 2.62725893e-02
 2.25893743e-02 8.34527388e-02 3.97705622e-02 4.33791103e-03
 4.33791569e-03 8.34527388e-02 1.71806097e-01 4.96295886e-03
 1.26358727e-02 2.25893743e-02 1.26358727e-02 4.50471882e-03
 4.50471882e-03 4.50471696e-03 3.19589232e-03 1.07401490e-01
 4.50471882e-03 4.50471882e-03 4.22003726e-03 8.33812207e-02
 4.50471882e-03 4.50471882e-03 5.58777619e-03 3.53489034e-02
 1.16998546e-01 1.04256310e-01 4.50471882e-03 5.06146327e-02
 8.33812952e-02 4.50471882e-03 5.16192010e-03 1.37307579e-02
 4.22003260e-03 3.62855406e-03 1.61858007e-01 1.37307793e-02
 4.50471882e-03 1.37307579e-02 1.13700172e-02 1.01638779e-01
 4.73904200e-02 4.50471882e-03 2.20546946e-01 1.13700172e-02
 1.13700172e-02 3.53489034e-02 6.38925610e-03 1.13700172e-02
 5.16191591e-03 3.53690125e-02 5.76059241e-03 2.96183396e-02
 1.45835755e-02 2.96183396e-02 2.05936879e-01 5.16192010e-03
 1.45835755e-02 1.01474142e-02 1.01473946e-02 3.74823242e-01
 1.01474142e-02 3.52008268e-02 6.38925610e-03 2.85703838e-02
 1.38873355e-02 5.76059241e-03 1.38873355e-02 1.58807740e-01
 5.16191591e-03 8.78775865e-02 1.01474142e-02 3.82044129e-02
 3.53690051e-02 1.01473946e-02 1.16841033e-01 5.76060545e-03
 3.82044129e-02 5.76060545e-03 1.01474142e-02 1.01473946e-02
 1.01473946e-02 1.01474142e-02 1.01473946e-02 8.76082666e-03
 1.78804342e-02 8.76082666e-03 1.78804342e-02 8.76082666e-03
 8.44371319e-02 8.44371319e-02 8.44371319e-02 1.01473946e-02
 1.01473946e-02 1.01474142e-02 1.01474142e-02 7.17364371e-01
 1.78804342e-02 8.76082666e-03 1.01474142e-02 1.01474142e-02
 1.01473946e-02 1.54085420e-02 1.01474142e-02 1.01473946e-02
 1.01474142e-02 1.78804342e-02]
2025-06-02 15:54:15,982 - DEBUG - Edge reconstruction errors: [  5.263182    5.262263   44.25883   ... 535.2592     13.358801
   2.1577063]
2025-06-02 15:54:15,989 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155415_update_37.json
2025-06-02 15:54:15,990 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:54:16,015 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155415_update_37.pth and as latest_checkpoint.pth
2025-06-02 15:54:16,015 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870205.dot): 0.6689
2025-06-02 15:54:16,015 - WARNING - Detected 6 anomalous nodes (reconstruction-based):
2025-06-02 15:54:16,015 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.5571, MLP Score: 0.5395
2025-06-02 15:54:16,015 - WARNING -   Node ID: 192.168.27.13, Recon Error: 2.1263, MLP Score: 0.5023
2025-06-02 15:54:16,016 - WARNING -   Node ID: 192.168.27.12, Recon Error: 1.1450, MLP Score: 0.5050
2025-06-02 15:54:16,016 - WARNING -   Node ID: 192.168.27.10, Recon Error: 2.7591, MLP Score: 0.5209
2025-06-02 15:54:16,016 - WARNING -   Node ID: 183.81.34.26, Recon Error: 8.3356, MLP Score: 0.5023
2025-06-02 15:54:16,016 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:54:16,016 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2588, MLP Score: 0.2334
2025-06-02 15:54:16,016 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9605, MLP Score: 0.1548
2025-06-02 15:54:16,016 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0612, MLP Score: 0.1548
2025-06-02 15:54:16,016 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7599, MLP Score: 0.1116
2025-06-02 15:54:16,017 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7591, MLP Score: 0.1111
2025-06-02 15:54:16,017 - INFO - 
--- Processing file: nw_graph_encoded_1748870235.dot (Timestamp: 2025-06-02 15:17:15) ---
2025-06-02 15:54:16,017 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870235.dot
2025-06-02 15:54:16,017 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870235.dot'.
2025-06-02 15:54:16,017 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870235.dot
2025-06-02 15:54:16,048 - INFO - Parsed 901 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870235.dot'.
2025-06-02 15:54:16,080 - INFO - Parsed 1907 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870235.dot'.
2025-06-02 15:54:16,080 - INFO - Processing node updates/additions.
2025-06-02 15:54:16,090 - INFO - Processing edge updates/additions.
2025-06-02 15:54:16,110 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:54:16,112 - INFO - Finished updating NetworkX graph.
2025-06-02 15:54:16,113 - DEBUG - Updated graph - Nodes: 901, Edges: 1907
2025-06-02 15:54:16,113 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:54:16,116 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:54:16,132 - DEBUG - Initial node features tensor shape: torch.Size([901, 30])
2025-06-02 15:54:16,137 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:54:16,137 - DEBUG - Node features tensor shape after scaling: torch.Size([901, 30])
2025-06-02 15:54:16,146 - DEBUG - Edge index tensor shape: torch.Size([2, 1907])
2025-06-02 15:54:16,149 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:54:16,159 - DEBUG - Initial edge attributes tensor shape: torch.Size([1907, 10])
2025-06-02 15:54:16,163 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:54:16,181 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1907, 10])
2025-06-02 15:54:16,182 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:54:16,184 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:54:16,189 - INFO - Updated main graph to 901 nodes and 1907 edges.
2025-06-02 15:54:16,189 - INFO - Performing online update...
2025-06-02 15:54:16,190 - INFO - Starting online update for 50 steps.
2025-06-02 15:54:16,191 - DEBUG - Updated RunningStats: new_mean=0.9438990334060063, new_var=57000000000162.055, new_n=5730
2025-06-02 15:54:16,192 - DEBUG - Updated RunningStats: new_mean=0.9428271217622368, new_var=57300000000017.945, new_n=5760
2025-06-02 15:54:16,193 - DEBUG - Updated RunningStats: new_mean=44.67997709676813, new_var=19000000189092.95, new_n=1910
2025-06-02 15:54:16,194 - DEBUG - Updated RunningStats: new_mean=44.694154804838995, new_var=19100000195718.004, new_n=1920
2025-06-02 15:54:16,195 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:54:16,195 - DEBUG - Online update step: 1/50
2025-06-02 15:54:16,202 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:16,660 - DEBUG - Node anomaly scores shape: torch.Size([15742, 1])
2025-06-02 15:54:16,690 - DEBUG - Edge anomaly scores shape: torch.Size([32368, 1])
2025-06-02 15:54:16,692 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:17,128 - DEBUG - Step 1: Loss=0.6599
2025-06-02 15:54:17,128 - DEBUG - Online update step: 2/50
2025-06-02 15:54:17,136 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:17,331 - DEBUG - Node anomaly scores shape: torch.Size([15511, 1])
2025-06-02 15:54:17,365 - DEBUG - Edge anomaly scores shape: torch.Size([31843, 1])
2025-06-02 15:54:17,381 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:17,739 - DEBUG - Step 2: Loss=0.6699
2025-06-02 15:54:17,741 - DEBUG - Online update step: 3/50
2025-06-02 15:54:17,758 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:17,935 - DEBUG - Node anomaly scores shape: torch.Size([15724, 1])
2025-06-02 15:54:17,946 - DEBUG - Edge anomaly scores shape: torch.Size([32406, 1])
2025-06-02 15:54:17,947 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:18,319 - DEBUG - Step 3: Loss=0.6819
2025-06-02 15:54:18,320 - DEBUG - Online update step: 4/50
2025-06-02 15:54:18,335 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:18,511 - DEBUG - Node anomaly scores shape: torch.Size([14617, 1])
2025-06-02 15:54:18,538 - DEBUG - Edge anomaly scores shape: torch.Size([29919, 1])
2025-06-02 15:54:18,547 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:19,021 - DEBUG - Step 4: Loss=0.6565
2025-06-02 15:54:19,021 - DEBUG - Online update step: 5/50
2025-06-02 15:54:19,026 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:19,322 - DEBUG - Node anomaly scores shape: torch.Size([16078, 1])
2025-06-02 15:54:19,330 - DEBUG - Edge anomaly scores shape: torch.Size([33088, 1])
2025-06-02 15:54:19,332 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:19,689 - DEBUG - Step 5: Loss=0.6708
2025-06-02 15:54:19,690 - DEBUG - Online update step: 6/50
2025-06-02 15:54:19,693 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:19,840 - DEBUG - Node anomaly scores shape: torch.Size([16341, 1])
2025-06-02 15:54:19,848 - DEBUG - Edge anomaly scores shape: torch.Size([33740, 1])
2025-06-02 15:54:19,850 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:20,240 - DEBUG - Step 6: Loss=0.6840
2025-06-02 15:54:20,241 - DEBUG - Online update step: 7/50
2025-06-02 15:54:20,253 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:20,513 - DEBUG - Node anomaly scores shape: torch.Size([16388, 1])
2025-06-02 15:54:20,526 - DEBUG - Edge anomaly scores shape: torch.Size([33906, 1])
2025-06-02 15:54:20,532 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:21,068 - DEBUG - Step 7: Loss=0.6576
2025-06-02 15:54:21,069 - DEBUG - Online update step: 8/50
2025-06-02 15:54:21,073 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:21,277 - DEBUG - Node anomaly scores shape: torch.Size([16149, 1])
2025-06-02 15:54:21,287 - DEBUG - Edge anomaly scores shape: torch.Size([33218, 1])
2025-06-02 15:54:21,294 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:21,550 - DEBUG - Step 8: Loss=0.6668
2025-06-02 15:54:21,550 - DEBUG - Online update step: 9/50
2025-06-02 15:54:21,554 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:21,648 - DEBUG - Node anomaly scores shape: torch.Size([15835, 1])
2025-06-02 15:54:21,652 - DEBUG - Edge anomaly scores shape: torch.Size([32731, 1])
2025-06-02 15:54:21,654 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:21,883 - DEBUG - Step 9: Loss=0.6791
2025-06-02 15:54:21,883 - DEBUG - Online update step: 10/50
2025-06-02 15:54:21,886 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:22,012 - DEBUG - Node anomaly scores shape: torch.Size([15613, 1])
2025-06-02 15:54:22,024 - DEBUG - Edge anomaly scores shape: torch.Size([32063, 1])
2025-06-02 15:54:22,027 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:22,376 - DEBUG - Step 10: Loss=0.6536
2025-06-02 15:54:22,377 - DEBUG - Online update step: 11/50
2025-06-02 15:54:22,387 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:22,494 - DEBUG - Node anomaly scores shape: torch.Size([15442, 1])
2025-06-02 15:54:22,501 - DEBUG - Edge anomaly scores shape: torch.Size([31771, 1])
2025-06-02 15:54:22,503 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:22,836 - DEBUG - Step 11: Loss=0.6704
2025-06-02 15:54:22,837 - DEBUG - Online update step: 12/50
2025-06-02 15:54:22,848 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:22,955 - DEBUG - Node anomaly scores shape: torch.Size([15889, 1])
2025-06-02 15:54:22,960 - DEBUG - Edge anomaly scores shape: torch.Size([32808, 1])
2025-06-02 15:54:22,962 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:23,258 - DEBUG - Step 12: Loss=0.6828
2025-06-02 15:54:23,260 - DEBUG - Online update step: 13/50
2025-06-02 15:54:23,279 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:23,478 - DEBUG - Node anomaly scores shape: torch.Size([15502, 1])
2025-06-02 15:54:23,500 - DEBUG - Edge anomaly scores shape: torch.Size([31868, 1])
2025-06-02 15:54:23,504 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:23,880 - DEBUG - Step 13: Loss=0.6575
2025-06-02 15:54:23,880 - DEBUG - Online update step: 14/50
2025-06-02 15:54:23,884 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:24,058 - DEBUG - Node anomaly scores shape: torch.Size([15508, 1])
2025-06-02 15:54:24,066 - DEBUG - Edge anomaly scores shape: torch.Size([31967, 1])
2025-06-02 15:54:24,070 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:24,371 - DEBUG - Step 14: Loss=0.6652
2025-06-02 15:54:24,371 - DEBUG - Online update step: 15/50
2025-06-02 15:54:24,374 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:24,495 - DEBUG - Node anomaly scores shape: torch.Size([16701, 1])
2025-06-02 15:54:24,500 - DEBUG - Edge anomaly scores shape: torch.Size([34573, 1])
2025-06-02 15:54:24,501 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:24,740 - DEBUG - Step 15: Loss=0.6768
2025-06-02 15:54:24,741 - DEBUG - Online update step: 16/50
2025-06-02 15:54:24,744 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:24,901 - DEBUG - Node anomaly scores shape: torch.Size([16474, 1])
2025-06-02 15:54:24,911 - DEBUG - Edge anomaly scores shape: torch.Size([33897, 1])
2025-06-02 15:54:24,912 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:25,225 - DEBUG - Step 16: Loss=0.6528
2025-06-02 15:54:25,225 - DEBUG - Online update step: 17/50
2025-06-02 15:54:25,228 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:25,349 - DEBUG - Node anomaly scores shape: torch.Size([15616, 1])
2025-06-02 15:54:25,360 - DEBUG - Edge anomaly scores shape: torch.Size([32092, 1])
2025-06-02 15:54:25,361 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:25,985 - DEBUG - Step 17: Loss=0.6695
2025-06-02 15:54:25,985 - DEBUG - Online update step: 18/50
2025-06-02 15:54:25,989 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:26,186 - DEBUG - Node anomaly scores shape: torch.Size([16025, 1])
2025-06-02 15:54:26,192 - DEBUG - Edge anomaly scores shape: torch.Size([33131, 1])
2025-06-02 15:54:26,193 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:26,436 - DEBUG - Step 18: Loss=0.6790
2025-06-02 15:54:26,436 - DEBUG - Online update step: 19/50
2025-06-02 15:54:26,449 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:26,572 - DEBUG - Node anomaly scores shape: torch.Size([16212, 1])
2025-06-02 15:54:26,580 - DEBUG - Edge anomaly scores shape: torch.Size([33483, 1])
2025-06-02 15:54:26,582 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:26,816 - DEBUG - Step 19: Loss=0.6552
2025-06-02 15:54:26,817 - DEBUG - Online update step: 20/50
2025-06-02 15:54:26,820 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:27,137 - DEBUG - Node anomaly scores shape: torch.Size([16025, 1])
2025-06-02 15:54:27,147 - DEBUG - Edge anomaly scores shape: torch.Size([32965, 1])
2025-06-02 15:54:27,148 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:27,577 - DEBUG - Step 20: Loss=0.6641
2025-06-02 15:54:27,578 - DEBUG - Online update step: 21/50
2025-06-02 15:54:27,592 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:27,737 - DEBUG - Node anomaly scores shape: torch.Size([15886, 1])
2025-06-02 15:54:27,749 - DEBUG - Edge anomaly scores shape: torch.Size([32684, 1])
2025-06-02 15:54:27,754 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:28,201 - DEBUG - Step 21: Loss=0.6743
2025-06-02 15:54:28,201 - DEBUG - Online update step: 22/50
2025-06-02 15:54:28,204 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:28,316 - DEBUG - Node anomaly scores shape: torch.Size([16471, 1])
2025-06-02 15:54:28,326 - DEBUG - Edge anomaly scores shape: torch.Size([34101, 1])
2025-06-02 15:54:28,328 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:28,776 - DEBUG - Step 22: Loss=0.6505
2025-06-02 15:54:28,777 - DEBUG - Online update step: 23/50
2025-06-02 15:54:28,788 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:28,880 - DEBUG - Node anomaly scores shape: torch.Size([15879, 1])
2025-06-02 15:54:28,885 - DEBUG - Edge anomaly scores shape: torch.Size([32719, 1])
2025-06-02 15:54:28,887 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:29,076 - DEBUG - Step 23: Loss=0.6678
2025-06-02 15:54:29,077 - DEBUG - Online update step: 24/50
2025-06-02 15:54:29,085 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:29,169 - DEBUG - Node anomaly scores shape: torch.Size([15751, 1])
2025-06-02 15:54:29,173 - DEBUG - Edge anomaly scores shape: torch.Size([32345, 1])
2025-06-02 15:54:29,175 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:29,384 - DEBUG - Step 24: Loss=0.6783
2025-06-02 15:54:29,385 - DEBUG - Online update step: 25/50
2025-06-02 15:54:29,394 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:29,516 - DEBUG - Node anomaly scores shape: torch.Size([16386, 1])
2025-06-02 15:54:29,523 - DEBUG - Edge anomaly scores shape: torch.Size([33744, 1])
2025-06-02 15:54:29,525 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:29,819 - DEBUG - Step 25: Loss=0.6535
2025-06-02 15:54:29,820 - DEBUG - Online update step: 26/50
2025-06-02 15:54:29,830 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:29,921 - DEBUG - Node anomaly scores shape: torch.Size([15962, 1])
2025-06-02 15:54:29,926 - DEBUG - Edge anomaly scores shape: torch.Size([32910, 1])
2025-06-02 15:54:29,928 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:30,162 - DEBUG - Step 26: Loss=0.6621
2025-06-02 15:54:30,163 - DEBUG - Online update step: 27/50
2025-06-02 15:54:30,176 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:30,290 - DEBUG - Node anomaly scores shape: torch.Size([15456, 1])
2025-06-02 15:54:30,297 - DEBUG - Edge anomaly scores shape: torch.Size([31784, 1])
2025-06-02 15:54:30,302 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:30,539 - DEBUG - Step 27: Loss=0.6735
2025-06-02 15:54:30,540 - DEBUG - Online update step: 28/50
2025-06-02 15:54:30,549 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:30,671 - DEBUG - Node anomaly scores shape: torch.Size([16397, 1])
2025-06-02 15:54:30,677 - DEBUG - Edge anomaly scores shape: torch.Size([33869, 1])
2025-06-02 15:54:30,679 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:31,016 - DEBUG - Step 28: Loss=0.6488
2025-06-02 15:54:31,017 - DEBUG - Online update step: 29/50
2025-06-02 15:54:31,028 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:31,154 - DEBUG - Node anomaly scores shape: torch.Size([15470, 1])
2025-06-02 15:54:31,161 - DEBUG - Edge anomaly scores shape: torch.Size([31862, 1])
2025-06-02 15:54:31,163 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:31,425 - DEBUG - Step 29: Loss=0.6650
2025-06-02 15:54:31,425 - DEBUG - Online update step: 30/50
2025-06-02 15:54:31,436 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:31,603 - DEBUG - Node anomaly scores shape: torch.Size([14786, 1])
2025-06-02 15:54:31,674 - DEBUG - Edge anomaly scores shape: torch.Size([30293, 1])
2025-06-02 15:54:31,712 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:31,957 - DEBUG - Step 30: Loss=0.6769
2025-06-02 15:54:31,957 - DEBUG - Online update step: 31/50
2025-06-02 15:54:31,966 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:32,090 - DEBUG - Node anomaly scores shape: torch.Size([16798, 1])
2025-06-02 15:54:32,095 - DEBUG - Edge anomaly scores shape: torch.Size([34684, 1])
2025-06-02 15:54:32,098 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:32,350 - DEBUG - Step 31: Loss=0.6515
2025-06-02 15:54:32,350 - DEBUG - Online update step: 32/50
2025-06-02 15:54:32,359 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:32,467 - DEBUG - Node anomaly scores shape: torch.Size([15770, 1])
2025-06-02 15:54:32,474 - DEBUG - Edge anomaly scores shape: torch.Size([32514, 1])
2025-06-02 15:54:32,475 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:32,752 - DEBUG - Step 32: Loss=0.6603
2025-06-02 15:54:32,752 - DEBUG - Online update step: 33/50
2025-06-02 15:54:32,760 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:32,905 - DEBUG - Node anomaly scores shape: torch.Size([16466, 1])
2025-06-02 15:54:32,913 - DEBUG - Edge anomaly scores shape: torch.Size([33911, 1])
2025-06-02 15:54:32,914 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:33,136 - DEBUG - Step 33: Loss=0.6716
2025-06-02 15:54:33,137 - DEBUG - Online update step: 34/50
2025-06-02 15:54:33,140 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:33,256 - DEBUG - Node anomaly scores shape: torch.Size([15736, 1])
2025-06-02 15:54:33,269 - DEBUG - Edge anomaly scores shape: torch.Size([32453, 1])
2025-06-02 15:54:33,271 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:33,554 - DEBUG - Step 34: Loss=0.6479
2025-06-02 15:54:33,554 - DEBUG - Online update step: 35/50
2025-06-02 15:54:33,558 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:33,811 - DEBUG - Node anomaly scores shape: torch.Size([17062, 1])
2025-06-02 15:54:33,816 - DEBUG - Edge anomaly scores shape: torch.Size([35345, 1])
2025-06-02 15:54:33,817 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:34,039 - DEBUG - Step 35: Loss=0.6629
2025-06-02 15:54:34,040 - DEBUG - Online update step: 36/50
2025-06-02 15:54:34,043 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:34,201 - DEBUG - Node anomaly scores shape: torch.Size([16615, 1])
2025-06-02 15:54:34,206 - DEBUG - Edge anomaly scores shape: torch.Size([34331, 1])
2025-06-02 15:54:34,207 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:34,440 - DEBUG - Step 36: Loss=0.6743
2025-06-02 15:54:34,440 - DEBUG - Online update step: 37/50
2025-06-02 15:54:34,444 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:34,551 - DEBUG - Node anomaly scores shape: torch.Size([16062, 1])
2025-06-02 15:54:34,557 - DEBUG - Edge anomaly scores shape: torch.Size([33021, 1])
2025-06-02 15:54:34,560 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:34,756 - DEBUG - Step 37: Loss=0.6507
2025-06-02 15:54:34,757 - DEBUG - Online update step: 38/50
2025-06-02 15:54:34,761 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:34,876 - DEBUG - Node anomaly scores shape: torch.Size([15043, 1])
2025-06-02 15:54:34,880 - DEBUG - Edge anomaly scores shape: torch.Size([30830, 1])
2025-06-02 15:54:34,881 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:35,212 - DEBUG - Step 38: Loss=0.6600
2025-06-02 15:54:35,212 - DEBUG - Online update step: 39/50
2025-06-02 15:54:35,215 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:35,360 - DEBUG - Node anomaly scores shape: torch.Size([16041, 1])
2025-06-02 15:54:35,369 - DEBUG - Edge anomaly scores shape: torch.Size([33063, 1])
2025-06-02 15:54:35,376 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:35,603 - DEBUG - Step 39: Loss=0.6717
2025-06-02 15:54:35,604 - DEBUG - Online update step: 40/50
2025-06-02 15:54:35,607 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:35,699 - DEBUG - Node anomaly scores shape: torch.Size([16282, 1])
2025-06-02 15:54:35,704 - DEBUG - Edge anomaly scores shape: torch.Size([33671, 1])
2025-06-02 15:54:35,705 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:36,011 - DEBUG - Step 40: Loss=0.6468
2025-06-02 15:54:36,011 - DEBUG - Online update step: 41/50
2025-06-02 15:54:36,014 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:36,112 - DEBUG - Node anomaly scores shape: torch.Size([15785, 1])
2025-06-02 15:54:36,119 - DEBUG - Edge anomaly scores shape: torch.Size([32576, 1])
2025-06-02 15:54:36,121 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:36,524 - DEBUG - Step 41: Loss=0.6618
2025-06-02 15:54:36,524 - DEBUG - Online update step: 42/50
2025-06-02 15:54:36,528 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:36,630 - DEBUG - Node anomaly scores shape: torch.Size([16675, 1])
2025-06-02 15:54:36,636 - DEBUG - Edge anomaly scores shape: torch.Size([34439, 1])
2025-06-02 15:54:36,637 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:36,844 - DEBUG - Step 42: Loss=0.6728
2025-06-02 15:54:36,844 - DEBUG - Online update step: 43/50
2025-06-02 15:54:36,847 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:36,934 - DEBUG - Node anomaly scores shape: torch.Size([15127, 1])
2025-06-02 15:54:36,940 - DEBUG - Edge anomaly scores shape: torch.Size([31031, 1])
2025-06-02 15:54:36,941 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:37,095 - DEBUG - Step 43: Loss=0.6494
2025-06-02 15:54:37,096 - DEBUG - Online update step: 44/50
2025-06-02 15:54:37,100 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:37,196 - DEBUG - Node anomaly scores shape: torch.Size([15169, 1])
2025-06-02 15:54:37,200 - DEBUG - Edge anomaly scores shape: torch.Size([31150, 1])
2025-06-02 15:54:37,201 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:37,377 - DEBUG - Step 44: Loss=0.6587
2025-06-02 15:54:37,377 - DEBUG - Online update step: 45/50
2025-06-02 15:54:37,380 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:37,489 - DEBUG - Node anomaly scores shape: torch.Size([16653, 1])
2025-06-02 15:54:37,494 - DEBUG - Edge anomaly scores shape: torch.Size([34385, 1])
2025-06-02 15:54:37,495 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:37,678 - DEBUG - Step 45: Loss=0.6693
2025-06-02 15:54:37,678 - DEBUG - Online update step: 46/50
2025-06-02 15:54:37,681 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:37,780 - DEBUG - Node anomaly scores shape: torch.Size([16751, 1])
2025-06-02 15:54:37,787 - DEBUG - Edge anomaly scores shape: torch.Size([34739, 1])
2025-06-02 15:54:37,788 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:38,134 - DEBUG - Step 46: Loss=0.6442
2025-06-02 15:54:38,134 - DEBUG - Online update step: 47/50
2025-06-02 15:54:38,138 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:39,369 - DEBUG - Node anomaly scores shape: torch.Size([16082, 1])
2025-06-02 15:54:39,450 - DEBUG - Edge anomaly scores shape: torch.Size([33116, 1])
2025-06-02 15:54:39,514 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:42,825 - DEBUG - Step 47: Loss=0.6602
2025-06-02 15:54:42,830 - DEBUG - Online update step: 48/50
2025-06-02 15:54:42,880 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:44,648 - DEBUG - Node anomaly scores shape: torch.Size([16350, 1])
2025-06-02 15:54:44,746 - DEBUG - Edge anomaly scores shape: torch.Size([33604, 1])
2025-06-02 15:54:44,796 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:45,790 - DEBUG - Step 48: Loss=0.6713
2025-06-02 15:54:45,791 - DEBUG - Online update step: 49/50
2025-06-02 15:54:45,795 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:46,775 - DEBUG - Node anomaly scores shape: torch.Size([17326, 1])
2025-06-02 15:54:46,857 - DEBUG - Edge anomaly scores shape: torch.Size([35761, 1])
2025-06-02 15:54:46,902 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:47,567 - DEBUG - Step 49: Loss=0.6465
2025-06-02 15:54:47,568 - DEBUG - Online update step: 50/50
2025-06-02 15:54:47,573 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:47,826 - DEBUG - Node anomaly scores shape: torch.Size([15885, 1])
2025-06-02 15:54:47,838 - DEBUG - Edge anomaly scores shape: torch.Size([32875, 1])
2025-06-02 15:54:47,840 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:48,146 - DEBUG - Step 50: Loss=0.6569
2025-06-02 15:54:48,147 - INFO - Online update finished. Average loss: 0.6639, Learning rate: 0.001000
2025-06-02 15:54:48,148 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  2.2756934e-08  4.4984638e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.2227704e-08
  2.1169242e-09 -1.0452313e-08 -8.9969276e-09 -4.2338481e-08
  2.2941177e+00  2.9600444e+00  1.4428413e-01  4.4139843e+00
  1.0452313e-08  3.3218646e+00  5.8712540e+00  7.6159821e+00
  1.4428413e-01  7.9922309e+00 -1.0055389e-08  1.1643083e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.9747715e-08  9.5261585e-09], current edge mean: [-1.0001828e-09  4.5835397e+02  0.0000000e+00  0.0000000e+00
 -1.0001828e-09  1.0001828e-09 -9.0016457e-09 -2.2504114e-09
 -1.5002742e-09  1.0001828e-09]
2025-06-02 15:54:48,148 - DEBUG - Node drift difference: 0.0041, Edge drift difference: 0.0011
2025-06-02 15:54:48,149 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  2.2756934e-08  4.4984638e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.2227704e-08
  2.1169242e-09 -1.0452313e-08 -8.9969276e-09 -4.2338481e-08
  2.2941177e+00  2.9600444e+00  1.4428413e-01  4.4139843e+00
  1.0452313e-08  3.3218646e+00  5.8712540e+00  7.6159821e+00
  1.4428413e-01  7.9922309e+00 -1.0055389e-08  1.1643083e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.9747715e-08  9.5261585e-09], edge=[-1.0001828e-09  4.5835397e+02  0.0000000e+00  0.0000000e+00
 -1.0001828e-09  1.0001828e-09 -9.0016457e-09 -2.2504114e-09
 -1.5002742e-09  1.0001828e-09]
2025-06-02 15:54:48,149 - DEBUG - Updated reference std: node=[0.         0.         1.0005554  1.0005554  0.         0.
 0.         1.0005554  1.0005554  1.0005554  1.0005554  1.0005554
 0.9781268  0.28000316 0.37004966 0.57211477 1.0005554  2.9718418
 2.880792   1.4799136  0.37004966 0.23320381 1.0005554  1.0005554
 0.         0.         0.         0.         1.0005554  1.0005554 ], edge=[  1.0002623 467.01913     0.          0.          1.0002623   1.0002624
   1.0002623   1.0002623   1.0002623   1.0002623]
2025-06-02 15:54:48,150 - INFO - Online update complete. Loss: 0.6639
2025-06-02 15:54:48,150 - INFO - Running anomaly detection...
2025-06-02 15:54:48,150 - INFO - Starting anomaly detection.
2025-06-02 15:54:48,171 - DEBUG - Node reconstruction errors: [2.33221203e-01 1.57846391e+00 1.86777198e+00 2.60481890e-02
 3.61464173e-02 6.13038763e-02 9.09384310e-01 2.24619396e-02
 2.24619117e-02 4.60778959e-02 2.24619396e-02 7.27385655e-02
 2.39888453e+00 3.02518815e-01 5.10608917e-03 2.62779761e-02
 7.42693692e-02 2.62782499e-02 1.17600642e-01 2.54048705e-02
 2.69500371e-02 5.10611245e-03 1.28582716e-01 5.23785502e-02
 3.73458257e-03 1.85297132e-02 3.73460748e-03 6.63828924e-02
 2.20366921e-02 3.73458257e-03 1.84486121e-01 2.62492836e-01
 6.12020567e-02 2.52500791e-02 1.76780194e-01 7.98465908e-02
 1.34339079e-01 2.54049227e-02 1.22820377e-01 1.73039824e-01
 5.68459854e-02 4.82658856e-03 2.54049227e-02 1.09501325e-01
 1.04986385e-01 4.99495678e-02 1.69102669e-01 3.17181915e-01
 2.18743477e-02 4.17956740e-01 1.77272484e-01 1.94240455e-02
 1.79983340e-02 9.54985246e-02 3.29306833e-02 8.93380642e-02
 5.35340965e-01 2.64529958e-02 6.92128018e-02 1.36440769e-01
 2.58013397e-01 8.04418698e-02 4.72538685e-03 2.83066612e-02
 7.28102550e-02 3.29307877e-02 2.28111036e-02 3.29303071e-02
 4.72538685e-03 8.04419816e-02 5.78994192e-02 6.74488097e-02
 9.63500980e-03 1.10202514e-01 1.03457764e-01 6.58026487e-02
 1.41239375e-01 6.86013028e-02 3.49259712e-02 4.53254767e-02
 2.37748306e-02 4.64824326e-02 3.78814012e-01 2.61719972e-01
 6.75961822e-02 7.46494830e-02 7.30445161e-02 6.20250627e-02
 5.64508326e-02 1.92198738e-01 3.02589731e-03 5.34991734e-02
 2.59344205e-02 4.75416742e-02 5.67493476e-02 3.69528860e-01
 2.31519006e-02 7.06853345e-02 2.43556779e-03 1.94012206e-02
 4.76450138e-02 2.31519006e-02 6.49103895e-02 3.07767093e-01
 4.78413254e-02 1.70261785e-02 2.76451968e-02 5.03928661e-02
 2.73582507e-02 1.62746698e-01 1.59750238e-01 2.85941008e-02
 3.22378799e-02 9.79104489e-02 4.04103585e-02 3.39511558e-02
 3.99066694e-02 8.40720385e-02 6.89626709e-02 1.90415066e-02
 2.06381571e-03 1.28543992e-02 9.92447212e-02 5.69917671e-02
 9.28336158e-02 1.90413278e-02 7.43744522e-02 7.86980838e-02
 8.46920013e-02 1.77686978e-02 2.31618267e-02 7.23852450e-03
 3.91573273e-02 2.48255551e-01 3.46772708e-02 1.79384593e-02
 7.52038509e-02 4.05334169e-03 1.89108938e-01 3.82946394e-02
 4.62942682e-02 6.17839806e-02 2.35383678e-03 4.62942161e-02
 3.79716307e-02 9.82754529e-02 3.99067551e-02 1.29469916e-01
 5.58528304e-02 6.40324578e-02 4.39688057e-01 4.12839428e-02
 4.59196717e-02 7.23850122e-03 3.42684723e-02 7.19836727e-02
 6.72219088e-03 3.83440480e-02 4.76448722e-02 5.70436679e-02
 4.62942682e-02 4.07620743e-02 6.72219088e-03 2.31618267e-02
 4.03309129e-02 2.99704187e-02 4.93622981e-02 3.37145813e-02
 4.68877628e-02 9.38344300e-02 4.97883521e-02 2.08497085e-02
 4.37964592e-03 1.69266447e-01 8.93018097e-02 8.35476017e+00
 3.60400751e-02 5.10433838e-02 4.23250645e-02 4.23253551e-02
 1.72441807e-02 4.52830903e-02 5.18078767e-02 1.25300720e-01
 6.34245798e-02 5.01979180e-02 2.21776101e-03 4.56629880e-02
 1.81179047e-02 6.39664941e-03 6.14430569e-02 5.64352833e-02
 5.54162823e-02 7.59686530e-03 1.89119086e-01 2.49833837e-02
 4.35628444e-01 4.49178368e-02 9.49023440e-02 6.00306913e-02
 1.73726287e-02 6.72219088e-03 5.53190336e-02 8.55648443e-02
 7.85469711e-02 4.06148285e-02 4.56026159e-02 1.29697666e-01
 1.89082744e-03 3.96030471e-02 3.58590260e-02 4.16933931e-02
 1.80706922e-02 4.97621931e-02 5.60130365e-02 3.47599434e-03
 8.86760876e-02 3.99067737e-02 1.46858826e-01 7.59686530e-03
 1.11522056e-01 2.21776101e-03 4.11984371e-03 1.80706922e-02
 6.72220672e-03 7.47388676e-02 7.99489841e-02 8.59887525e-03
 4.68634889e-02 1.06420852e-02 3.60924341e-02 6.22362718e-02
 9.55033526e-02 3.99067067e-02 3.99067178e-02 3.78283747e-02
 4.22661453e-02 4.11984371e-03 6.72219088e-03 7.10038394e-02
 6.80058673e-02 4.33666743e-02 8.59234761e-03 9.40694511e-02
 8.15993920e-03 1.05806455e-01 3.39942984e-02 6.11746795e-02
 8.59234761e-03 3.47154774e-02 4.37964592e-03 3.37947579e-03
 1.46858320e-01 3.55266444e-02 5.52674718e-02 6.33641705e-02
 6.39664941e-03 2.07789405e-03 1.71365310e-02 4.23248410e-02
 3.45888548e-02 5.67080416e-02 1.53142186e-02 5.95476441e-02
 7.83848092e-02 4.87430245e-02 5.03982976e-02 1.43929094e-01
 5.03979698e-02 3.08522694e-02 1.40199766e-01 1.09485403e-01
 4.50477935e-02 1.48952901e-01 4.36769351e-02 4.23247777e-02
 1.64442416e-02 1.03890643e-01 1.72441527e-02 5.66942841e-02
 1.56076297e-01 1.77376978e-02 3.49397250e-02 5.56664020e-02
 7.95652643e-02 2.30673607e-02 1.71935871e-01 2.87172310e-02
 4.52831984e-02 9.14558098e-02 7.21495375e-02 3.16794962e-02
 4.34092134e-02 8.15994386e-03 3.01000029e-01 5.56451268e-03
 3.71270739e-02 4.23246212e-02 2.49834526e-02 4.70256619e-02
 3.63105573e-02 3.43213091e-03 3.91675234e-02 6.44927248e-02
 3.43213091e-03 3.43213091e-03 3.43213091e-03 4.69705015e-02
 4.81513739e-02 3.43213091e-03 3.43213091e-03 3.71181816e-02
 3.43213091e-03 5.98545186e-03 4.70184051e-02 4.48761061e-02
 1.91855624e-01 3.23698707e-02 1.83918886e-02 2.91674715e-02
 4.55344208e-02 4.41088453e-02 5.08718081e-02 3.91672626e-02
 5.30036502e-02 1.16484828e-01 4.77372631e-02 7.12178275e-02
 4.38829586e-02 4.38835546e-02 2.05278143e-01 2.52148695e-02
 3.43213091e-03 4.36773561e-02 3.43213091e-03 4.69705388e-02
 4.15512882e-02 3.16307950e-03 2.16566329e-03 2.16566911e-03
 3.43213091e-03 1.17107769e-02 2.16566329e-03 7.12265745e-02
 6.58087507e-02 8.86754766e-02 3.91672850e-02 2.50838436e-02
 5.03843650e-02 3.99508812e-02 3.43213091e-03 2.90995352e-02
 9.74001437e-02 5.50975204e-02 9.61629581e-03 6.39664941e-03
 2.02746247e-03 3.43213091e-03 3.70942801e-03 2.90735453e-01
 8.56057853e-02 5.52522345e-03 1.41911000e-01 6.17229454e-02
 3.91676165e-02 2.91308016e-01 2.34681484e-03 5.53414747e-02
 3.70157398e-02 2.80349571e-02 4.39168625e-02 5.56456000e-02
 7.11668432e-02 9.25258324e-02 7.02509433e-02 5.50974421e-02
 3.91526939e-03 6.40351977e-03 4.75135259e-02 3.43213091e-03
 3.91676798e-02 7.02128187e-02 6.28304901e-03 3.55335064e-02
 4.64883074e-02 6.45452738e-02 4.80047613e-02 8.22367594e-02
 6.50922731e-02 3.43213091e-03 1.69927403e-01 8.26474950e-02
 3.46624255e-02 9.42900553e-02 6.01914674e-02 6.01914637e-02
 6.01914786e-02 5.51520512e-02 3.22205503e-03 5.60308918e-02
 5.49688330e-03 9.93907452e-02 6.01914674e-02 3.22205783e-03
 3.41389962e-02 3.46624032e-02 1.08405478e-01 2.05375589e-02
 3.46623920e-02 5.67895100e-02 6.01914711e-02 3.46627049e-02
 3.22205503e-03 6.01914674e-02 6.01914674e-02 9.04680416e-03
 1.15051912e-02 6.01914749e-02 3.92409507e-03 2.30558999e-02
 4.44675945e-02 1.07062273e-02 2.86086071e-02 5.85422525e-03
 9.68248695e-02 2.56783310e-02 1.88144445e-02 5.14002033e-02
 5.27507998e-02 1.46751348e-02 4.74537052e-02 1.72281768e-02
 4.58512828e-02 5.36607578e-02 6.01914786e-02 6.01914711e-02
 5.49689401e-03 4.92591150e-02 9.96869057e-02 1.82203911e-02
 1.75313354e-02 6.12219376e-03 1.34465933e-01 2.16971198e-03
 2.90148780e-02 4.91696149e-02 5.64068332e-02 6.57704985e-03
 2.75573153e-02 5.46279456e-03 7.24693909e-02 3.48091847e-03
 6.17572200e-03 3.09632765e-03 3.48093500e-03 1.78707130e-02
 5.85422525e-03 3.15623097e-02 3.80056240e-02 4.34023552e-02
 3.33788358e-02 6.41456805e-03 6.85653603e-03 3.33589129e-02
 6.85653603e-03 6.41456479e-03 2.78348895e-03 3.69284749e-02
 5.35764284e-02 2.69655082e-02 2.78348895e-03 3.33788432e-02
 4.87828106e-02 9.90009159e-02 7.62161091e-02 2.86087152e-02
 3.69277261e-02 3.33787762e-02 2.06444017e-03 7.73697020e-03
 2.59235632e-02 1.60890371e-01 1.81578025e-02 6.57704985e-03
 9.28371921e-02 5.64372586e-03 3.48091847e-03 6.46159276e-02
 1.90379247e-02 9.89998728e-02 2.80786622e-02 2.06443970e-03
 3.92195918e-02 1.66407670e-03 2.67073326e-02 5.70563367e-03
 3.10361348e-02 1.98373586e-01 3.09632951e-03 7.73698511e-03
 1.39656544e-01 1.66407670e-03 1.26489550e-01 1.73764937e-02
 2.65782699e-03 3.33622955e-02 1.90079759e-03 2.19256833e-01
 1.47494227e-02 3.48091847e-03 2.34688409e-02 5.21817943e-03
 5.21817943e-03 3.57669638e-03 4.58218008e-02 1.34116998e-02
 1.90079759e-03 3.31997760e-02 6.59461990e-02 5.07474691e-02
 3.31995711e-02 6.12219376e-03 1.90079294e-03 7.45445490e-02
 2.65782699e-03 3.10360920e-02 2.20950004e-02 1.07267447e-01
 3.31997946e-02 5.31253591e-02 1.34116998e-02 3.09632951e-03
 3.09632765e-03 7.73697020e-03 3.10361590e-02 3.23587917e-02
 4.23774682e-02 5.47819771e-02 3.09632951e-03 5.40760942e-02
 3.09632951e-03 5.40760942e-02 3.51836085e-02 3.32002677e-02
 6.08055247e-03 2.53342777e-01 5.43720648e-02 3.10076028e-03
 3.06318313e-01 3.10076028e-03 3.10076238e-03 3.10076028e-03
 3.10076238e-03 3.10076238e-03 3.10076238e-03 3.10076028e-03
 3.67130227e-02 6.06178073e-03 1.97106581e-02 3.10076238e-03
 3.10076238e-03 3.10076238e-03 3.10076238e-03 3.10076238e-03
 3.10076238e-03 3.10076238e-03 3.10076238e-03 3.10076238e-03
 3.14881578e-02 3.10076238e-03 3.10076028e-03 1.17566586e-01
 3.10076238e-03 4.09907475e-02 4.37906496e-02 3.09632765e-03
 4.63364348e-02 5.38305044e-02 3.96350324e-01 3.96350324e-01
 5.45936860e-02 4.63364348e-02 3.09632951e-03 1.90079759e-03
 1.90079294e-03 3.09632951e-03 1.90079294e-03 3.73937078e-02
 2.21258439e-02 3.10076028e-03 6.12219376e-03 3.09632765e-03
 5.21817943e-03 3.09632951e-03 3.09632951e-03 2.43530441e-02
 3.09632951e-03 1.90079294e-03 3.09632765e-03 3.09632951e-03
 3.31998430e-02 1.90079294e-03 3.09632951e-03 1.90079759e-03
 3.09632951e-03 3.09632951e-03 3.09632951e-03 4.27603871e-02
 7.15965256e-02 2.67072674e-02 3.10076238e-03 2.08966304e-02
 6.16188534e-02 3.09632765e-03 1.90079294e-03 4.84050885e-02
 3.10076238e-03 2.14713309e-02 4.57960516e-02 1.59785978e-03
 3.09632951e-03 3.09632951e-03 2.43376903e-02 4.68051285e-02
 2.43948065e-02 3.09632951e-03 3.67131270e-02 3.65842506e-03
 1.90079759e-03 9.39572826e-02 3.10076238e-03 2.81190276e-02
 8.00217241e-02 3.10076238e-03 3.10076238e-03 3.67131978e-02
 3.65844881e-03 3.09632765e-03 1.71750456e-01 5.44985868e-02
 5.76368012e-02 4.68050800e-02 1.31334746e-02 5.27016148e-02
 5.27015999e-02 4.23832275e-02 6.16676500e-03 3.10076238e-03
 5.21156052e-03 5.09672537e-02 4.68050800e-02 2.59534232e-02
 9.52562597e-03 1.25788990e-02 3.17840977e-03 3.17840977e-03
 3.17840977e-03 3.17840977e-03 3.17840977e-03 3.02951839e-02
 4.55344506e-02 3.17840977e-03 3.17840977e-03 3.10076238e-03
 3.93026182e-03 3.10076028e-03 5.27015999e-02 4.36420031e-02
 5.00318296e-02 1.24295829e-02 5.27015999e-02 6.10396639e-02
 3.14883813e-02 1.75734535e-02 3.14884111e-02 3.10076238e-03
 5.27015999e-02 2.58979830e-03 1.96994166e-03 1.96994166e-03
 3.17840977e-03 2.58979830e-03 4.74500656e-02 1.26475962e-02
 1.42976642e-02 3.10076238e-03 3.17840977e-03 4.04594000e-03
 1.96992490e-03 2.37445836e-03 3.28524504e-03 2.15415959e-03
 3.02950628e-02 1.18165866e-01 2.15415354e-03 9.27831009e-02
 2.22857483e-02 3.28524504e-03 6.15347829e-03 2.58258358e-03
 3.29068280e-03 4.19996819e-03 4.77824435e-02 3.32554476e-03
 4.99434546e-02 3.28524504e-03 3.28524504e-03 3.28524504e-03
 2.04540533e-03 1.72288772e-02 3.28524504e-03 3.29068280e-03
 3.28524504e-03 3.28524504e-03 3.28524504e-03 2.31239516e-02
 2.63929018e-03 5.27948365e-02 5.80262728e-02 4.61639650e-02
 5.80252288e-03 1.98984519e-03 5.04668392e-02 1.15676187e-01
 3.22589162e-03 2.70991982e-03 3.63374944e-03 2.21217275e-02
 2.21217163e-02 3.29068280e-03 8.98502916e-02 1.05828293e-01
 3.26000503e-03 3.53829027e-03 2.64934655e-02 9.68184322e-02
 2.77909241e-03 2.77909241e-03 2.77909241e-03 3.82256368e-03
 2.07744632e-03 5.35747036e-02 5.42782210e-02 1.57227248e-01
 2.72942018e-02 2.67750723e-03 6.37732446e-03 3.53826629e-03
 6.05043862e-03 2.42759474e-02 2.12086015e-03 2.52287611e-02
 3.26000503e-03 1.05828635e-01 3.53826629e-03 2.42761001e-02
 2.67750723e-03 1.07114919e-01 2.77909241e-03 3.82257858e-03
 2.12086784e-03 7.56600825e-03 2.29142196e-02 3.82256368e-03
 3.82257858e-03 3.82256368e-03 7.17770262e-03 3.10613159e-02
 8.54585409e-01 2.77909241e-03 6.09027147e-02 3.82256368e-03
 4.28685732e-02 9.37068835e-03 1.34581238e-01 9.37068835e-03
 3.82256368e-03 4.18828428e-03 8.41418002e-03 3.14739463e-03
 1.41620785e-01 9.37068835e-03 1.92682341e-01 2.78126616e-02
 6.56815693e-02 9.37068835e-03 4.47120108e-02 2.40391586e-02
 1.76454280e-02 6.31629229e-02 3.64077091e-02 3.08325468e-03
 3.08325468e-03 6.31629005e-02 1.44614488e-01 4.18828428e-03
 9.37068835e-03 1.76454075e-02 9.37069021e-03 1.48583984e-03
 3.06680962e-03 3.06680962e-03 2.10237573e-03 7.89113790e-02
 3.06680962e-03 3.06679052e-03 1.48584216e-03 6.29558861e-02
 3.06680962e-03 3.06679402e-03 4.54320433e-03 2.96044517e-02
 8.09273347e-02 7.88551793e-02 3.06680962e-03 4.28572632e-02
 6.29558861e-02 3.06678819e-03 2.87374156e-03 9.13436431e-03
 1.48584216e-03 1.83032500e-03 1.06517114e-01 9.13438108e-03
 3.06678819e-03 9.13436431e-03 7.11200433e-03 9.16754901e-02
 4.48927768e-02 3.06680962e-03 1.84747547e-01 7.65604060e-03
 7.65604060e-03 2.96044517e-02 4.88220295e-03 7.65604060e-03
 2.87373620e-03 2.69344021e-02 1.76766538e-03 2.72961464e-02
 9.81263164e-03 2.72961464e-02 1.67810708e-01 2.87373713e-03
 9.81263164e-03 5.65919699e-03 5.65919699e-03 2.30462968e-01
 5.65919699e-03 2.60980893e-02 4.88221506e-03 2.73839626e-02
 1.09452559e-02 1.76766538e-03 1.09452559e-02 1.07613333e-01
 6.36734292e-02 5.92899546e-02 5.65919699e-03 2.66810376e-02
 2.69344375e-02 5.65917604e-03 8.64563808e-02 6.60972893e-02
 2.66810376e-02 1.76766538e-03 5.65917604e-03 1.78577900e-01
 5.65919699e-03 5.65919699e-03 5.65919699e-03 3.03919124e-03
 1.35392360e-02 3.03919124e-03 1.35392360e-02 3.03918612e-03
 6.71377927e-02 6.71377927e-02 6.71377927e-02 5.65919699e-03
 5.65917604e-03 5.65919699e-03 5.65919699e-03 4.75211680e-01
 1.35392360e-02 3.03919124e-03 5.65919699e-03 5.65919699e-03
 5.65919699e-03 1.17999557e-02 5.65919699e-03 5.65919699e-03
 5.65919699e-03 1.35392360e-02 6.34299731e-03 2.40206778e-01
 6.54661097e-03 5.65919699e-03 5.65919699e-03 1.02039473e-02
 5.65919699e-03]
2025-06-02 15:54:48,172 - DEBUG - Edge reconstruction errors: [ 5.263401   5.2621207 44.258614  ... 13.358589   2.158082  13.358588 ]
2025-06-02 15:54:48,175 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155448_update_38.json
2025-06-02 15:54:48,175 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:54:48,184 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155448_update_38.pth and as latest_checkpoint.pth
2025-06-02 15:54:48,185 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870235.dot): 0.6372
2025-06-02 15:54:48,185 - WARNING - Detected 6 anomalous nodes (reconstruction-based):
2025-06-02 15:54:48,185 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.5785, MLP Score: 0.5094
2025-06-02 15:54:48,185 - WARNING -   Node ID: 192.168.27.13, Recon Error: 1.8678, MLP Score: 0.4813
2025-06-02 15:54:48,185 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.9094, MLP Score: 0.4862
2025-06-02 15:54:48,185 - WARNING -   Node ID: 192.168.27.10, Recon Error: 2.3989, MLP Score: 0.5012
2025-06-02 15:54:48,185 - WARNING -   Node ID: 183.81.34.26, Recon Error: 8.3548, MLP Score: 0.4813
2025-06-02 15:54:48,185 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:54:48,185 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2585, MLP Score: 0.9934
2025-06-02 15:54:48,185 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9603, MLP Score: 0.9995
2025-06-02 15:54:48,186 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0610, MLP Score: 0.9995
2025-06-02 15:54:48,186 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7596, MLP Score: 0.9996
2025-06-02 15:54:48,186 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7589, MLP Score: 0.9997
2025-06-02 15:54:48,186 - INFO - 
--- Processing file: nw_graph_encoded_1748870265.dot (Timestamp: 2025-06-02 15:17:45) ---
2025-06-02 15:54:48,186 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870265.dot
2025-06-02 15:54:48,186 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870265.dot'.
2025-06-02 15:54:48,186 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870265.dot
2025-06-02 15:54:48,216 - INFO - Parsed 914 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870265.dot'.
2025-06-02 15:54:48,246 - INFO - Parsed 1945 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870265.dot'.
2025-06-02 15:54:48,247 - INFO - Processing node updates/additions.
2025-06-02 15:54:48,254 - INFO - Processing edge updates/additions.
2025-06-02 15:54:48,271 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:54:48,272 - INFO - Finished updating NetworkX graph.
2025-06-02 15:54:48,273 - DEBUG - Updated graph - Nodes: 914, Edges: 1945
2025-06-02 15:54:48,273 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:54:48,275 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:54:48,288 - DEBUG - Initial node features tensor shape: torch.Size([914, 30])
2025-06-02 15:54:48,290 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:54:48,291 - DEBUG - Node features tensor shape after scaling: torch.Size([914, 30])
2025-06-02 15:54:48,293 - DEBUG - Edge index tensor shape: torch.Size([2, 1945])
2025-06-02 15:54:48,295 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:54:48,301 - DEBUG - Initial edge attributes tensor shape: torch.Size([1945, 10])
2025-06-02 15:54:48,302 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:54:48,303 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1945, 10])
2025-06-02 15:54:48,303 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:54:48,303 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:54:48,304 - INFO - Updated main graph to 914 nodes and 1945 edges.
2025-06-02 15:54:48,304 - INFO - Performing online update...
2025-06-02 15:54:48,304 - INFO - Starting online update for 50 steps.
2025-06-02 15:54:48,305 - DEBUG - Updated RunningStats: new_mean=0.9439474190761655, new_var=57600000000161.92, new_n=5790
2025-06-02 15:54:48,305 - DEBUG - Updated RunningStats: new_mean=0.9428982958272212, new_var=57900000000018.01, new_n=5820
2025-06-02 15:54:48,305 - DEBUG - Updated RunningStats: new_mean=44.699912544497764, new_var=19200000188844.395, new_n=1930
2025-06-02 15:54:48,306 - DEBUG - Updated RunningStats: new_mean=44.71147937739285, new_var=19300000191867.78, new_n=1940
2025-06-02 15:54:48,306 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:54:48,306 - DEBUG - Online update step: 1/50
2025-06-02 15:54:48,308 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:48,438 - DEBUG - Node anomaly scores shape: torch.Size([16042, 1])
2025-06-02 15:54:48,451 - DEBUG - Edge anomaly scores shape: torch.Size([32988, 1])
2025-06-02 15:54:48,457 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:48,713 - DEBUG - Step 1: Loss=0.6688
2025-06-02 15:54:48,714 - DEBUG - Online update step: 2/50
2025-06-02 15:54:48,717 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:48,826 - DEBUG - Node anomaly scores shape: torch.Size([15289, 1])
2025-06-02 15:54:48,832 - DEBUG - Edge anomaly scores shape: torch.Size([31445, 1])
2025-06-02 15:54:48,833 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:49,016 - DEBUG - Step 2: Loss=0.6453
2025-06-02 15:54:49,016 - DEBUG - Online update step: 3/50
2025-06-02 15:54:49,020 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:49,122 - DEBUG - Node anomaly scores shape: torch.Size([17684, 1])
2025-06-02 15:54:49,126 - DEBUG - Edge anomaly scores shape: torch.Size([36724, 1])
2025-06-02 15:54:49,127 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:49,317 - DEBUG - Step 3: Loss=0.6578
2025-06-02 15:54:49,317 - DEBUG - Online update step: 4/50
2025-06-02 15:54:49,320 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:49,408 - DEBUG - Node anomaly scores shape: torch.Size([16828, 1])
2025-06-02 15:54:49,412 - DEBUG - Edge anomaly scores shape: torch.Size([34785, 1])
2025-06-02 15:54:49,413 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:49,612 - DEBUG - Step 4: Loss=0.6698
2025-06-02 15:54:49,613 - DEBUG - Online update step: 5/50
2025-06-02 15:54:49,617 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:49,721 - DEBUG - Node anomaly scores shape: torch.Size([16664, 1])
2025-06-02 15:54:49,725 - DEBUG - Edge anomaly scores shape: torch.Size([34519, 1])
2025-06-02 15:54:49,726 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:49,963 - DEBUG - Step 5: Loss=0.6457
2025-06-02 15:54:49,963 - DEBUG - Online update step: 6/50
2025-06-02 15:54:49,967 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:50,137 - DEBUG - Node anomaly scores shape: torch.Size([16299, 1])
2025-06-02 15:54:50,144 - DEBUG - Edge anomaly scores shape: torch.Size([33555, 1])
2025-06-02 15:54:50,145 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:50,447 - DEBUG - Step 6: Loss=0.6560
2025-06-02 15:54:50,447 - DEBUG - Online update step: 7/50
2025-06-02 15:54:50,450 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:50,556 - DEBUG - Node anomaly scores shape: torch.Size([16574, 1])
2025-06-02 15:54:50,563 - DEBUG - Edge anomaly scores shape: torch.Size([34155, 1])
2025-06-02 15:54:50,564 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:50,795 - DEBUG - Step 7: Loss=0.6662
2025-06-02 15:54:50,796 - DEBUG - Online update step: 8/50
2025-06-02 15:54:50,799 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:50,872 - DEBUG - Node anomaly scores shape: torch.Size([15553, 1])
2025-06-02 15:54:50,875 - DEBUG - Edge anomaly scores shape: torch.Size([31964, 1])
2025-06-02 15:54:50,876 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:51,005 - DEBUG - Step 8: Loss=0.6434
2025-06-02 15:54:51,005 - DEBUG - Online update step: 9/50
2025-06-02 15:54:51,008 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:51,113 - DEBUG - Node anomaly scores shape: torch.Size([15000, 1])
2025-06-02 15:54:51,117 - DEBUG - Edge anomaly scores shape: torch.Size([30732, 1])
2025-06-02 15:54:51,118 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:51,293 - DEBUG - Step 9: Loss=0.6579
2025-06-02 15:54:51,294 - DEBUG - Online update step: 10/50
2025-06-02 15:54:51,301 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:51,404 - DEBUG - Node anomaly scores shape: torch.Size([16747, 1])
2025-06-02 15:54:51,409 - DEBUG - Edge anomaly scores shape: torch.Size([34494, 1])
2025-06-02 15:54:51,411 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:51,599 - DEBUG - Step 10: Loss=0.6676
2025-06-02 15:54:51,599 - DEBUG - Online update step: 11/50
2025-06-02 15:54:51,602 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:51,738 - DEBUG - Node anomaly scores shape: torch.Size([16487, 1])
2025-06-02 15:54:51,745 - DEBUG - Edge anomaly scores shape: torch.Size([34082, 1])
2025-06-02 15:54:51,746 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:51,948 - DEBUG - Step 11: Loss=0.6430
2025-06-02 15:54:51,949 - DEBUG - Online update step: 12/50
2025-06-02 15:54:51,952 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:52,074 - DEBUG - Node anomaly scores shape: torch.Size([16586, 1])
2025-06-02 15:54:52,093 - DEBUG - Edge anomaly scores shape: torch.Size([34299, 1])
2025-06-02 15:54:52,094 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:52,279 - DEBUG - Step 12: Loss=0.6545
2025-06-02 15:54:52,279 - DEBUG - Online update step: 13/50
2025-06-02 15:54:52,285 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:52,385 - DEBUG - Node anomaly scores shape: torch.Size([16484, 1])
2025-06-02 15:54:52,388 - DEBUG - Edge anomaly scores shape: torch.Size([34113, 1])
2025-06-02 15:54:52,389 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:52,633 - DEBUG - Step 13: Loss=0.6648
2025-06-02 15:54:52,634 - DEBUG - Online update step: 14/50
2025-06-02 15:54:52,637 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:52,739 - DEBUG - Node anomaly scores shape: torch.Size([16784, 1])
2025-06-02 15:54:52,743 - DEBUG - Edge anomaly scores shape: torch.Size([34694, 1])
2025-06-02 15:54:52,744 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:52,962 - DEBUG - Step 14: Loss=0.6408
2025-06-02 15:54:52,963 - DEBUG - Online update step: 15/50
2025-06-02 15:54:52,966 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:53,067 - DEBUG - Node anomaly scores shape: torch.Size([16449, 1])
2025-06-02 15:54:53,071 - DEBUG - Edge anomaly scores shape: torch.Size([33958, 1])
2025-06-02 15:54:53,072 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:53,236 - DEBUG - Step 15: Loss=0.6564
2025-06-02 15:54:53,237 - DEBUG - Online update step: 16/50
2025-06-02 15:54:53,240 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:53,323 - DEBUG - Node anomaly scores shape: torch.Size([15409, 1])
2025-06-02 15:54:53,327 - DEBUG - Edge anomaly scores shape: torch.Size([31668, 1])
2025-06-02 15:54:53,330 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:53,494 - DEBUG - Step 16: Loss=0.6677
2025-06-02 15:54:53,494 - DEBUG - Online update step: 17/50
2025-06-02 15:54:53,498 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:53,601 - DEBUG - Node anomaly scores shape: torch.Size([16377, 1])
2025-06-02 15:54:53,606 - DEBUG - Edge anomaly scores shape: torch.Size([33759, 1])
2025-06-02 15:54:53,607 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:53,785 - DEBUG - Step 17: Loss=0.6428
2025-06-02 15:54:53,786 - DEBUG - Online update step: 18/50
2025-06-02 15:54:53,789 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:53,875 - DEBUG - Node anomaly scores shape: torch.Size([17741, 1])
2025-06-02 15:54:53,878 - DEBUG - Edge anomaly scores shape: torch.Size([36653, 1])
2025-06-02 15:54:53,879 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:54,045 - DEBUG - Step 18: Loss=0.6538
2025-06-02 15:54:54,045 - DEBUG - Online update step: 19/50
2025-06-02 15:54:54,048 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:54,138 - DEBUG - Node anomaly scores shape: torch.Size([17840, 1])
2025-06-02 15:54:54,142 - DEBUG - Edge anomaly scores shape: torch.Size([36901, 1])
2025-06-02 15:54:54,143 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:54,312 - DEBUG - Step 19: Loss=0.6641
2025-06-02 15:54:54,313 - DEBUG - Online update step: 20/50
2025-06-02 15:54:54,316 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:54,478 - DEBUG - Node anomaly scores shape: torch.Size([17136, 1])
2025-06-02 15:54:54,484 - DEBUG - Edge anomaly scores shape: torch.Size([35655, 1])
2025-06-02 15:54:54,485 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:54,713 - DEBUG - Step 20: Loss=0.6396
2025-06-02 15:54:54,714 - DEBUG - Online update step: 21/50
2025-06-02 15:54:54,717 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:54,832 - DEBUG - Node anomaly scores shape: torch.Size([15969, 1])
2025-06-02 15:54:54,837 - DEBUG - Edge anomaly scores shape: torch.Size([33011, 1])
2025-06-02 15:54:54,837 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:55,013 - DEBUG - Step 21: Loss=0.6553
2025-06-02 15:54:55,013 - DEBUG - Online update step: 22/50
2025-06-02 15:54:55,016 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:55,120 - DEBUG - Node anomaly scores shape: torch.Size([16275, 1])
2025-06-02 15:54:55,124 - DEBUG - Edge anomaly scores shape: torch.Size([33623, 1])
2025-06-02 15:54:55,125 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:55,335 - DEBUG - Step 22: Loss=0.6664
2025-06-02 15:54:55,335 - DEBUG - Online update step: 23/50
2025-06-02 15:54:55,338 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:55,460 - DEBUG - Node anomaly scores shape: torch.Size([17469, 1])
2025-06-02 15:54:55,465 - DEBUG - Edge anomaly scores shape: torch.Size([36441, 1])
2025-06-02 15:54:55,466 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:55,668 - DEBUG - Step 23: Loss=0.6412
2025-06-02 15:54:55,669 - DEBUG - Online update step: 24/50
2025-06-02 15:54:55,672 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:55,753 - DEBUG - Node anomaly scores shape: torch.Size([15570, 1])
2025-06-02 15:54:55,757 - DEBUG - Edge anomaly scores shape: torch.Size([32045, 1])
2025-06-02 15:54:55,758 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:55,902 - DEBUG - Step 24: Loss=0.6524
2025-06-02 15:54:55,903 - DEBUG - Online update step: 25/50
2025-06-02 15:54:55,906 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:56,029 - DEBUG - Node anomaly scores shape: torch.Size([16084, 1])
2025-06-02 15:54:56,037 - DEBUG - Edge anomaly scores shape: torch.Size([33086, 1])
2025-06-02 15:54:56,038 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:56,273 - DEBUG - Step 25: Loss=0.6634
2025-06-02 15:54:56,273 - DEBUG - Online update step: 26/50
2025-06-02 15:54:56,278 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:56,473 - DEBUG - Node anomaly scores shape: torch.Size([17416, 1])
2025-06-02 15:54:56,484 - DEBUG - Edge anomaly scores shape: torch.Size([36174, 1])
2025-06-02 15:54:56,493 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:56,833 - DEBUG - Step 26: Loss=0.6388
2025-06-02 15:54:56,833 - DEBUG - Online update step: 27/50
2025-06-02 15:54:56,837 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:56,995 - DEBUG - Node anomaly scores shape: torch.Size([17187, 1])
2025-06-02 15:54:57,003 - DEBUG - Edge anomaly scores shape: torch.Size([35839, 1])
2025-06-02 15:54:57,004 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:57,375 - DEBUG - Step 27: Loss=0.6521
2025-06-02 15:54:57,375 - DEBUG - Online update step: 28/50
2025-06-02 15:54:57,378 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:57,483 - DEBUG - Node anomaly scores shape: torch.Size([16086, 1])
2025-06-02 15:54:57,488 - DEBUG - Edge anomaly scores shape: torch.Size([33367, 1])
2025-06-02 15:54:57,489 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:57,709 - DEBUG - Step 28: Loss=0.6640
2025-06-02 15:54:57,709 - DEBUG - Online update step: 29/50
2025-06-02 15:54:57,713 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:57,854 - DEBUG - Node anomaly scores shape: torch.Size([16720, 1])
2025-06-02 15:54:57,861 - DEBUG - Edge anomaly scores shape: torch.Size([34435, 1])
2025-06-02 15:54:57,862 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:58,056 - DEBUG - Step 29: Loss=0.6406
2025-06-02 15:54:58,056 - DEBUG - Online update step: 30/50
2025-06-02 15:54:58,059 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:58,152 - DEBUG - Node anomaly scores shape: torch.Size([15731, 1])
2025-06-02 15:54:58,157 - DEBUG - Edge anomaly scores shape: torch.Size([32420, 1])
2025-06-02 15:54:58,158 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:58,364 - DEBUG - Step 30: Loss=0.6508
2025-06-02 15:54:58,364 - DEBUG - Online update step: 31/50
2025-06-02 15:54:58,368 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:58,483 - DEBUG - Node anomaly scores shape: torch.Size([16190, 1])
2025-06-02 15:54:58,490 - DEBUG - Edge anomaly scores shape: torch.Size([33628, 1])
2025-06-02 15:54:58,493 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:58,692 - DEBUG - Step 31: Loss=0.6610
2025-06-02 15:54:58,692 - DEBUG - Online update step: 32/50
2025-06-02 15:54:58,695 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:58,776 - DEBUG - Node anomaly scores shape: torch.Size([16275, 1])
2025-06-02 15:54:58,780 - DEBUG - Edge anomaly scores shape: torch.Size([33608, 1])
2025-06-02 15:54:58,781 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:58,963 - DEBUG - Step 32: Loss=0.6377
2025-06-02 15:54:58,964 - DEBUG - Online update step: 33/50
2025-06-02 15:54:58,968 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:59,093 - DEBUG - Node anomaly scores shape: torch.Size([15483, 1])
2025-06-02 15:54:59,099 - DEBUG - Edge anomaly scores shape: torch.Size([31885, 1])
2025-06-02 15:54:59,100 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:59,293 - DEBUG - Step 33: Loss=0.6528
2025-06-02 15:54:59,293 - DEBUG - Online update step: 34/50
2025-06-02 15:54:59,296 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:59,384 - DEBUG - Node anomaly scores shape: torch.Size([15750, 1])
2025-06-02 15:54:59,390 - DEBUG - Edge anomaly scores shape: torch.Size([32549, 1])
2025-06-02 15:54:59,391 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:59,544 - DEBUG - Step 34: Loss=0.6639
2025-06-02 15:54:59,544 - DEBUG - Online update step: 35/50
2025-06-02 15:54:59,547 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:59,640 - DEBUG - Node anomaly scores shape: torch.Size([16285, 1])
2025-06-02 15:54:59,647 - DEBUG - Edge anomaly scores shape: torch.Size([33650, 1])
2025-06-02 15:54:59,648 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:54:59,804 - DEBUG - Step 35: Loss=0.6396
2025-06-02 15:54:59,804 - DEBUG - Online update step: 36/50
2025-06-02 15:54:59,807 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:54:59,890 - DEBUG - Node anomaly scores shape: torch.Size([16620, 1])
2025-06-02 15:54:59,894 - DEBUG - Edge anomaly scores shape: torch.Size([34250, 1])
2025-06-02 15:54:59,895 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:00,050 - DEBUG - Step 36: Loss=0.6501
2025-06-02 15:55:00,050 - DEBUG - Online update step: 37/50
2025-06-02 15:55:00,054 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:00,144 - DEBUG - Node anomaly scores shape: torch.Size([15989, 1])
2025-06-02 15:55:00,150 - DEBUG - Edge anomaly scores shape: torch.Size([32936, 1])
2025-06-02 15:55:00,151 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:00,468 - DEBUG - Step 37: Loss=0.6602
2025-06-02 15:55:00,469 - DEBUG - Online update step: 38/50
2025-06-02 15:55:00,472 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:00,564 - DEBUG - Node anomaly scores shape: torch.Size([16743, 1])
2025-06-02 15:55:00,568 - DEBUG - Edge anomaly scores shape: torch.Size([34568, 1])
2025-06-02 15:55:00,570 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:00,719 - DEBUG - Step 38: Loss=0.6366
2025-06-02 15:55:00,719 - DEBUG - Online update step: 39/50
2025-06-02 15:55:00,723 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:00,812 - DEBUG - Node anomaly scores shape: torch.Size([16267, 1])
2025-06-02 15:55:00,823 - DEBUG - Edge anomaly scores shape: torch.Size([33591, 1])
2025-06-02 15:55:00,824 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:01,118 - DEBUG - Step 39: Loss=0.6514
2025-06-02 15:55:01,118 - DEBUG - Online update step: 40/50
2025-06-02 15:55:01,123 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:01,262 - DEBUG - Node anomaly scores shape: torch.Size([15990, 1])
2025-06-02 15:55:01,269 - DEBUG - Edge anomaly scores shape: torch.Size([32955, 1])
2025-06-02 15:55:01,271 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:01,733 - DEBUG - Step 40: Loss=0.6615
2025-06-02 15:55:01,733 - DEBUG - Online update step: 41/50
2025-06-02 15:55:01,737 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:01,948 - DEBUG - Node anomaly scores shape: torch.Size([16599, 1])
2025-06-02 15:55:01,956 - DEBUG - Edge anomaly scores shape: torch.Size([34206, 1])
2025-06-02 15:55:01,958 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:02,328 - DEBUG - Step 41: Loss=0.6383
2025-06-02 15:55:02,328 - DEBUG - Online update step: 42/50
2025-06-02 15:55:02,338 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:02,428 - DEBUG - Node anomaly scores shape: torch.Size([16242, 1])
2025-06-02 15:55:02,433 - DEBUG - Edge anomaly scores shape: torch.Size([33518, 1])
2025-06-02 15:55:02,434 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:02,685 - DEBUG - Step 42: Loss=0.6495
2025-06-02 15:55:02,686 - DEBUG - Online update step: 43/50
2025-06-02 15:55:02,692 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:02,771 - DEBUG - Node anomaly scores shape: torch.Size([15342, 1])
2025-06-02 15:55:02,775 - DEBUG - Edge anomaly scores shape: torch.Size([31483, 1])
2025-06-02 15:55:02,778 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:03,097 - DEBUG - Step 43: Loss=0.6596
2025-06-02 15:55:03,097 - DEBUG - Online update step: 44/50
2025-06-02 15:55:03,105 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:03,203 - DEBUG - Node anomaly scores shape: torch.Size([15804, 1])
2025-06-02 15:55:03,207 - DEBUG - Edge anomaly scores shape: torch.Size([32599, 1])
2025-06-02 15:55:03,209 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:03,369 - DEBUG - Step 44: Loss=0.6362
2025-06-02 15:55:03,369 - DEBUG - Online update step: 45/50
2025-06-02 15:55:03,372 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:03,515 - DEBUG - Node anomaly scores shape: torch.Size([16382, 1])
2025-06-02 15:55:03,525 - DEBUG - Edge anomaly scores shape: torch.Size([33874, 1])
2025-06-02 15:55:03,526 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:03,895 - DEBUG - Step 45: Loss=0.6504
2025-06-02 15:55:03,895 - DEBUG - Online update step: 46/50
2025-06-02 15:55:03,902 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:04,464 - DEBUG - Node anomaly scores shape: torch.Size([16314, 1])
2025-06-02 15:55:04,467 - DEBUG - Edge anomaly scores shape: torch.Size([33710, 1])
2025-06-02 15:55:04,468 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:04,910 - DEBUG - Step 46: Loss=0.6601
2025-06-02 15:55:04,910 - DEBUG - Online update step: 47/50
2025-06-02 15:55:04,916 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:05,091 - DEBUG - Node anomaly scores shape: torch.Size([17244, 1])
2025-06-02 15:55:05,095 - DEBUG - Edge anomaly scores shape: torch.Size([35593, 1])
2025-06-02 15:55:05,097 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:05,299 - DEBUG - Step 47: Loss=0.6370
2025-06-02 15:55:05,299 - DEBUG - Online update step: 48/50
2025-06-02 15:55:05,305 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:05,386 - DEBUG - Node anomaly scores shape: torch.Size([16687, 1])
2025-06-02 15:55:05,390 - DEBUG - Edge anomaly scores shape: torch.Size([34535, 1])
2025-06-02 15:55:05,391 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:05,535 - DEBUG - Step 48: Loss=0.6481
2025-06-02 15:55:05,535 - DEBUG - Online update step: 49/50
2025-06-02 15:55:05,538 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:05,741 - DEBUG - Node anomaly scores shape: torch.Size([16039, 1])
2025-06-02 15:55:05,754 - DEBUG - Edge anomaly scores shape: torch.Size([32944, 1])
2025-06-02 15:55:05,796 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:06,565 - DEBUG - Step 49: Loss=0.6581
2025-06-02 15:55:06,566 - DEBUG - Online update step: 50/50
2025-06-02 15:55:06,569 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:06,770 - DEBUG - Node anomaly scores shape: torch.Size([16458, 1])
2025-06-02 15:55:06,777 - DEBUG - Edge anomaly scores shape: torch.Size([34011, 1])
2025-06-02 15:55:06,778 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:06,970 - DEBUG - Step 50: Loss=0.6339
2025-06-02 15:55:06,971 - INFO - Online update finished. Average loss: 0.6523, Learning rate: 0.001000
2025-06-02 15:55:06,972 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  3.6519257e-09  3.4954144e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.7128591e-08
 -3.9649478e-08 -2.2694110e-08 -2.6085183e-09 -6.7821477e-09
  2.3085339e+00  2.9606128e+00  1.4770241e-01  4.4059081e+00
  2.2694110e-08  3.3380744e+00  5.8621445e+00  7.6083150e+00
  1.4770241e-01  7.9923415e+00  3.1302221e-09  3.7301813e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  3.0780516e-08 -2.2954962e-08], current edge mean: [-3.9225680e-09  4.5805399e+02  0.0000000e+00  0.0000000e+00
 -5.8838516e-09 -3.9225680e-09 -9.8064201e-10  9.8064201e-10
  2.9419258e-09  4.9032098e-09]
2025-06-02 15:55:06,972 - DEBUG - Node drift difference: 0.0147, Edge drift difference: 0.0006
2025-06-02 15:55:06,974 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  3.6519257e-09  3.4954144e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.7128591e-08
 -3.9649478e-08 -2.2694110e-08 -2.6085183e-09 -6.7821477e-09
  2.3085339e+00  2.9606128e+00  1.4770241e-01  4.4059081e+00
  2.2694110e-08  3.3380744e+00  5.8621445e+00  7.6083150e+00
  1.4770241e-01  7.9923415e+00  3.1302221e-09  3.7301813e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  3.0780516e-08 -2.2954962e-08], edge=[-3.9225680e-09  4.5805399e+02  0.0000000e+00  0.0000000e+00
 -5.8838516e-09 -3.9225680e-09 -9.8064201e-10  9.8064201e-10
  2.9419258e-09  4.9032098e-09]
2025-06-02 15:55:06,976 - DEBUG - Updated reference std: node=[0.         0.         1.0005475  1.0005475  0.         0.
 0.         1.0005475  1.0005475  1.0005475  1.0005475  1.0005475
 1.0195211  0.27804288 0.37305197 0.5736149  1.0005475  2.9805017
 2.883391   1.4932402  0.37305197 0.23153941 1.0005475  1.0005474
 0.         0.         0.         0.         1.0005475  1.0005475 ], edge=[  1.0002571 462.43698     0.          0.          1.0002571   1.0002571
   1.0002571   1.0002571   1.0002571   1.0002573]
2025-06-02 15:55:06,976 - INFO - Online update complete. Loss: 0.6523
2025-06-02 15:55:06,976 - INFO - Running anomaly detection...
2025-06-02 15:55:06,977 - INFO - Starting anomaly detection.
2025-06-02 15:55:07,023 - DEBUG - Node reconstruction errors: [1.92705721e-01 1.61455142e+00 1.78769827e+00 1.74537506e-02
 3.01170275e-02 4.60788868e-02 8.30948532e-01 1.96353793e-02
 1.96353793e-02 3.91676649e-02 1.96353793e-02 5.16650267e-02
 2.21213651e+00 2.74503827e-01 4.19058232e-03 2.16850173e-02
 5.33411950e-02 2.16852073e-02 7.89724663e-02 2.19730102e-02
 2.43060105e-02 4.19058232e-03 9.79335457e-02 3.39016803e-02
 3.27193667e-03 1.32969944e-02 3.27194016e-03 6.71952665e-02
 1.94484685e-02 3.27193667e-03 1.50971115e-01 2.25644544e-01
 6.30513877e-02 1.69050414e-02 1.36375934e-01 6.35511577e-02
 1.17529660e-01 2.19730102e-02 1.08840622e-01 1.42556697e-01
 3.66087817e-02 4.09447169e-03 2.19729953e-02 7.19162747e-02
 1.11221194e-01 2.69620344e-02 1.18675977e-01 2.81544596e-01
 1.95242651e-02 3.49867195e-01 9.69359577e-02 1.35872625e-02
 1.29330056e-02 5.59188910e-02 2.76903100e-02 7.02926815e-02
 4.87471014e-01 2.27441248e-02 3.57869826e-02 8.34434554e-02
 2.02286482e-01 5.06539382e-02 4.15962655e-03 1.66109055e-02
 9.96933877e-02 2.76901890e-02 1.83441173e-02 2.76901964e-02
 4.15962376e-03 5.06539382e-02 4.47126217e-02 4.57773842e-02
 8.17074534e-03 9.83648971e-02 1.10120937e-01 4.36582528e-02
 9.62747484e-02 5.57120070e-02 3.16998288e-02 3.75157818e-02
 1.56025253e-02 3.36676165e-02 3.27255785e-01 7.68982321e-02
 5.42918965e-02 6.66638538e-02 5.90028428e-02 5.09852581e-02
 5.03072664e-02 1.71697691e-01 3.35334288e-03 5.49406670e-02
 2.17871461e-02 4.29177508e-02 4.07477356e-02 2.08863243e-01
 1.52671151e-02 5.65202013e-02 2.48630252e-03 7.24748895e-02
 3.25488262e-02 1.52671151e-02 4.15767208e-02 2.79105365e-01
 2.65634544e-02 1.73590463e-02 1.84936170e-02 3.29893306e-02
 2.14176867e-02 1.35268018e-01 1.37610570e-01 1.84762310e-02
 2.54685599e-02 7.41751641e-02 2.73901615e-02 2.43253186e-02
 2.72028912e-02 7.13101551e-02 6.82833195e-02 1.54026626e-02
 2.51619262e-03 1.20794792e-02 7.83385783e-02 4.10754904e-02
 7.47240484e-02 1.54029541e-02 5.56400530e-02 5.16262017e-02
 7.50298649e-02 1.33615080e-02 1.67494938e-02 6.78563397e-03
 5.86500242e-02 2.17478469e-01 2.39793435e-02 1.74970757e-02
 4.82111610e-02 3.61520075e-03 1.53011322e-01 3.14703472e-02
 3.19507606e-02 5.09841293e-02 2.57730973e-03 3.19507606e-02
 2.62827203e-02 7.06161931e-02 2.72030104e-02 1.15520209e-01
 4.61808071e-02 7.03012869e-02 3.84128153e-01 2.19634604e-02
 3.81738357e-02 6.78566610e-03 2.50959285e-02 6.18143491e-02
 6.52242685e-03 3.23103331e-02 3.25488187e-02 3.66188474e-02
 3.19507606e-02 2.28825156e-02 6.52242685e-03 1.67494845e-02
 2.71522086e-02 2.20025573e-02 3.45708653e-02 2.97775771e-02
 2.46715527e-02 7.03006983e-02 4.16458175e-02 1.65123902e-02
 4.39279806e-03 1.15930505e-01 6.82839528e-02 8.47549152e+00
 3.30865793e-02 4.70687561e-02 2.90580597e-02 2.90581081e-02
 1.75514910e-02 3.66717465e-02 4.02631201e-02 9.64505821e-02
 6.12636656e-02 4.21942323e-02 2.42784410e-03 3.30956765e-02
 1.76228844e-02 6.19614078e-03 5.24422117e-02 4.60036807e-02
 8.19395632e-02 8.08841456e-03 1.53017670e-01 1.85188074e-02
 3.84566486e-01 4.22456339e-02 8.01589116e-02 3.99449356e-02
 1.34156346e-02 6.52242685e-03 5.39851226e-02 6.89491555e-02
 6.76885322e-02 2.30067112e-02 3.85096408e-02 1.17429130e-01
 2.01530405e-03 3.38531882e-02 2.45112758e-02 2.90333983e-02
 1.27491951e-02 4.90417629e-02 5.05208001e-02 3.62693006e-03
 6.95695132e-02 2.72028837e-02 1.30441338e-01 8.08841456e-03
 8.36620629e-02 2.42786459e-03 4.19116905e-03 1.27492240e-02
 6.52242685e-03 9.14248973e-02 6.76052123e-02 9.01484303e-03
 3.96322571e-02 1.08319204e-02 1.96768809e-02 6.03952631e-02
 7.42682964e-02 2.72031054e-02 2.72030812e-02 2.62100641e-02
 3.85357663e-02 4.19116905e-03 6.52242685e-03 8.51505995e-02
 5.73792942e-02 4.05915119e-02 8.15036707e-03 7.47840405e-02
 8.48296843e-03 8.31264108e-02 2.49737184e-02 5.32960743e-02
 8.15036893e-03 2.55211014e-02 4.39279806e-03 4.11947211e-03
 1.30441427e-01 3.26428302e-02 4.11387086e-02 5.31034246e-02
 6.19613100e-03 1.65848609e-03 3.63626331e-02 2.90580746e-02
 3.16812396e-02 4.28303480e-02 1.67400464e-02 4.74133231e-02
 6.30660355e-02 3.52230556e-02 4.64691892e-02 1.08860187e-01
 4.64692451e-02 2.47071143e-02 1.13446586e-01 8.55117813e-02
 4.19179462e-02 1.06362477e-01 3.11549269e-02 1.18698105e-01
 1.48074143e-02 8.19925964e-02 1.75514910e-02 4.41173948e-02
 1.38596311e-01 1.60982329e-02 3.13157551e-02 3.54263708e-02
 7.47321174e-02 1.42260585e-02 1.50552809e-01 1.97959859e-02
 3.66718732e-02 7.44731277e-02 5.60789555e-02 2.05677580e-02
 4.07035016e-02 8.48296843e-03 2.52570212e-01 3.36822728e-03
 3.51419114e-02 2.90581323e-02 1.85188074e-02 3.02061755e-02
 3.16096097e-02 3.10327834e-03 2.83055026e-02 5.84185049e-02
 3.10327997e-03 3.10327834e-03 3.10327834e-03 3.40252742e-02
 3.01579554e-02 3.10327997e-03 3.10327834e-03 2.92069595e-02
 3.10327834e-03 5.88777848e-03 2.54428349e-02 3.95152383e-02
 1.69274703e-01 2.66864561e-02 1.28715010e-02 2.17431094e-02
 4.29825820e-02 3.69622894e-02 8.34170878e-02 2.83054952e-02
 3.48770432e-02 9.03933197e-02 2.96597145e-02 5.62334917e-02
 3.67157683e-02 3.67157608e-02 1.93851128e-01 1.85433812e-02
 3.10327834e-03 3.11550852e-02 3.10327997e-03 3.40249203e-02
 3.03248670e-02 3.94272897e-03 2.22971407e-03 2.22971407e-03
 3.10327997e-03 1.29691279e-02 2.22971267e-03 9.18265507e-02
 5.52079417e-02 6.95691928e-02 2.83054467e-02 1.54107306e-02
 4.56609502e-02 3.43605429e-02 3.10327834e-03 2.17506643e-02
 7.58277550e-02 5.03451638e-02 1.10449558e-02 6.19613100e-03
 1.43930048e-03 3.10327997e-03 3.33306054e-03 1.12964563e-01
 6.19871542e-02 4.06316854e-03 1.29354686e-01 5.95876239e-02
 2.83055101e-02 1.50166765e-01 2.80085928e-03 5.45462593e-02
 2.62698140e-02 1.98753364e-02 4.09994982e-02 5.35475239e-02
 6.52615353e-02 7.18677491e-02 6.94610626e-02 5.03454804e-02
 4.05219849e-03 5.00763394e-03 5.16808853e-02 3.10327997e-03
 2.83055436e-02 4.41255309e-02 5.72204031e-03 3.16248797e-02
 2.53866743e-02 5.66296838e-02 3.80351208e-02 5.86910211e-02
 5.44137694e-02 3.10327834e-03 1.32358894e-01 6.03818819e-02
 2.48495843e-02 7.32857883e-02 5.09886108e-02 5.09886108e-02
 5.09886108e-02 2.60420963e-02 2.92547955e-03 2.70441975e-02
 5.61114447e-03 7.70827830e-02 5.09886108e-02 2.92547955e-03
 2.57675722e-02 2.48495955e-02 8.77484232e-02 1.67566724e-02
 2.48495881e-02 3.81737836e-02 5.09886108e-02 2.48495992e-02
 2.92547815e-03 5.09886108e-02 5.09886108e-02 8.82722624e-03
 1.26394508e-02 5.09886108e-02 4.03565215e-03 1.48134697e-02
 3.21033224e-02 8.06283765e-03 2.07364056e-02 5.46386559e-03
 7.63636753e-02 3.21036354e-02 1.32469190e-02 3.80840451e-02
 3.61054093e-02 1.17386263e-02 4.33966555e-02 1.80832632e-02
 4.20797877e-02 4.77232859e-02 5.09886257e-02 5.09886108e-02
 5.61113469e-03 4.40578572e-02 7.85765797e-02 1.52096013e-02
 1.12407617e-02 4.24285419e-03 1.23637371e-01 2.29772134e-03
 1.92825310e-02 3.73115651e-02 4.68723886e-02 5.56561071e-03
 2.00393200e-02 5.05802548e-03 6.73161596e-02 3.73467058e-03
 5.68814669e-03 2.82099610e-03 3.73467058e-03 1.80926155e-02
 5.46386559e-03 2.16066055e-02 2.41997913e-02 3.28689627e-02
 2.43617706e-02 6.14261907e-03 5.74980769e-03 2.67970208e-02
 5.74981887e-03 6.14261907e-03 3.66823887e-03 2.82877516e-02
 3.21871936e-02 1.96896512e-02 3.66823887e-03 2.43617725e-02
 4.40765060e-02 8.36408958e-02 6.68587238e-02 2.07363460e-02
 2.82882955e-02 2.43616886e-02 2.56738788e-03 6.90273847e-03
 1.64750051e-02 1.41874820e-01 1.10661536e-02 5.56561071e-03
 7.19998926e-02 4.39538900e-03 3.73467058e-03 3.98481749e-02
 1.93487220e-02 8.36394131e-02 2.29872651e-02 2.56740698e-03
 3.39927264e-02 2.13626144e-03 3.89914587e-02 5.52371936e-03
 2.32657138e-02 1.27731353e-01 2.82099610e-03 6.90273847e-03
 1.26128212e-01 2.13626144e-03 1.10516712e-01 1.59448143e-02
 3.56072909e-03 2.62007583e-02 1.73339108e-03 1.83218166e-01
 1.03281699e-02 3.73467058e-03 1.23057067e-02 3.53377406e-03
 3.53377732e-03 2.99477670e-03 4.20479141e-02 8.15124530e-03
 1.73339108e-03 2.48986371e-02 4.26093601e-02 4.54185009e-02
 2.48985533e-02 4.24285419e-03 1.73339108e-03 5.76012097e-02
 3.56072909e-03 2.32657511e-02 1.49971647e-02 7.91982785e-02
 2.48985700e-02 4.70941626e-02 8.15123506e-03 2.82099610e-03
 2.82099610e-03 6.90273661e-03 2.32657362e-02 2.38969028e-02
 3.57277915e-02 4.86958735e-02 2.82099610e-03 4.73737642e-02
 2.82098423e-03 4.73737642e-02 2.35791598e-02 2.48986520e-02
 4.23075864e-03 7.66585320e-02 3.00774630e-02 2.75117066e-03
 2.64260650e-01 2.75117066e-03 2.75115739e-03 2.75115739e-03
 2.75117066e-03 2.75117066e-03 2.75117066e-03 2.75117066e-03
 2.79408861e-02 3.99981625e-03 1.97578613e-02 2.75117066e-03
 2.75117066e-03 2.75117066e-03 2.75118323e-03 2.75117066e-03
 2.75118323e-03 2.75117066e-03 2.75117066e-03 2.75117066e-03
 2.40591969e-02 2.75117066e-03 2.75117066e-03 9.08346847e-02
 2.75117066e-03 2.59422697e-02 2.97955703e-02 2.82099610e-03
 3.17012146e-02 4.88080643e-02 2.41914555e-01 2.41914555e-01
 4.83161323e-02 3.17012146e-02 2.82098423e-03 1.73339108e-03
 1.73339108e-03 2.82099610e-03 1.73339108e-03 2.30642278e-02
 1.70697775e-02 2.75118323e-03 4.24285419e-03 2.82099610e-03
 3.53377406e-03 2.82099610e-03 2.82099610e-03 2.31954753e-02
 2.82099610e-03 1.73339108e-03 2.82099610e-03 2.82098423e-03
 2.48984341e-02 1.73339108e-03 2.82099610e-03 1.73339108e-03
 2.82099610e-03 2.82099610e-03 2.82098423e-03 3.98728624e-02
 6.81197643e-02 1.99673120e-02 2.75117066e-03 1.93952136e-02
 4.13950607e-02 2.82099610e-03 1.73339108e-03 4.39486690e-02
 2.75117066e-03 1.60733219e-02 5.53083979e-02 1.15789881e-03
 2.82099610e-03 2.82099610e-03 1.90329440e-02 4.23081927e-02
 1.95454881e-02 2.82099610e-03 2.79409830e-02 1.83744321e-03
 1.73339108e-03 6.64896891e-02 2.75117066e-03 2.08321195e-02
 6.92648441e-02 2.75117066e-03 2.75118323e-03 2.79409010e-02
 1.83744321e-03 2.82098423e-03 1.56291455e-01 4.82245050e-02
 5.17999381e-02 4.23081703e-02 8.61954037e-03 4.58744280e-02
 4.58743945e-02 2.89773829e-02 4.08417033e-03 2.75118323e-03
 3.24562867e-03 4.70565706e-02 4.23081703e-02 2.07411181e-02
 5.84381958e-03 8.49500299e-03 2.69573578e-03 2.69573578e-03
 2.69572926e-03 2.69573578e-03 2.69573578e-03 2.34031156e-02
 4.23711389e-02 2.69573578e-03 2.69573578e-03 2.75117066e-03
 1.80447369e-03 2.75118323e-03 4.58743945e-02 4.00794260e-02
 5.54157719e-02 1.20665580e-02 4.58743945e-02 5.84346764e-02
 2.40591578e-02 1.36930142e-02 2.40592286e-02 2.75117066e-03
 4.58743945e-02 3.49054229e-03 1.62844383e-03 1.62844686e-03
 2.69572926e-03 3.49054229e-03 4.26338576e-02 1.20222308e-02
 7.53983436e-03 2.75117066e-03 2.69573578e-03 2.94528785e-03
 1.62844383e-03 1.14995940e-03 3.56357498e-03 1.20466063e-02
 2.34030504e-02 9.48397145e-02 2.59117526e-03 8.12921226e-02
 1.73317287e-02 3.56357498e-03 5.00543136e-03 3.45904380e-03
 3.54706054e-03 2.91926297e-03 4.18841578e-02 8.40699300e-03
 4.36187573e-02 3.56357498e-03 3.56357498e-03 3.56357498e-03
 2.50140997e-03 1.14119193e-02 3.56357498e-03 3.54709174e-03
 3.56357498e-03 3.56357498e-03 3.56357498e-03 1.79114882e-02
 3.46792093e-03 4.21659164e-02 5.32694943e-02 4.19272855e-02
 4.43614088e-03 8.41217209e-03 4.40117903e-02 6.55498281e-02
 3.51237878e-03 3.49595328e-03 2.88093439e-03 1.92051399e-02
 1.92052200e-02 3.54706054e-03 6.85309023e-02 9.89978760e-02
 3.51248612e-03 2.70493585e-03 1.89719405e-02 7.50682056e-02
 3.53154447e-03 3.53154144e-03 3.53154144e-03 2.85774306e-03
 2.45086523e-03 3.86619680e-02 4.42455858e-02 1.40800744e-01
 1.87176056e-02 2.25394359e-03 3.31086456e-03 2.70494004e-03
 4.53351345e-03 1.66911595e-02 2.52669607e-03 1.80172566e-02
 3.51248612e-03 9.89976153e-02 2.70494004e-03 1.66911408e-02
 2.25394359e-03 6.84534684e-02 3.53154447e-03 2.85774306e-03
 2.52669607e-03 4.25717980e-03 1.96525622e-02 2.85775005e-03
 2.85774306e-03 2.85774306e-03 3.66706657e-03 7.21535027e-01
 7.32215762e-01 3.53154144e-03 5.17474823e-02 2.85774306e-03
 3.86863276e-02 5.17175114e-03 7.87732601e-02 5.17175114e-03
 2.85774306e-03 2.93000857e-03 4.48492169e-03 3.42198554e-03
 1.23276375e-01 5.17175114e-03 1.08850509e-01 1.72854755e-02
 5.70937023e-02 5.17174089e-03 3.65994088e-02 2.05128510e-02
 1.21299084e-02 5.42768352e-02 2.49947906e-02 3.24244890e-03
 3.24244890e-03 5.42768240e-02 1.26083434e-01 2.93002534e-03
 5.17174089e-03 1.21299094e-02 5.17174089e-03 2.14685476e-03
 3.12032760e-03 3.12032760e-03 2.36064801e-03 6.88637272e-02
 3.12032900e-03 3.12032900e-03 2.14685476e-03 4.13625762e-02
 3.12032760e-03 3.12032760e-03 3.05259903e-03 2.16964055e-02
 7.05918446e-02 6.15679584e-02 3.12032900e-03 2.90200226e-02
 4.13625762e-02 3.12032760e-03 3.08938976e-03 6.98930630e-03
 2.14685476e-03 2.32907617e-03 7.13868216e-02 5.06426906e-03
 3.12032760e-03 5.06426906e-03 4.99312673e-03 7.13955238e-02
 3.64779159e-02 3.12032760e-03 1.59351155e-01 5.65806963e-03
 5.06426906e-03 2.16963682e-02 3.28866323e-03 5.65806543e-03
 3.08937090e-03 1.84683241e-02 2.43433914e-03 2.30098926e-02
 7.41016958e-03 2.30098926e-02 1.42022923e-01 2.25844071e-03
 7.41016958e-03 3.75641743e-03 3.75641743e-03 1.60264194e-01
 3.75641743e-03 2.48940382e-02 3.28866323e-03 2.33172253e-02
 6.13037357e-03 2.25842954e-03 6.13033259e-03 7.26703182e-02
 4.22808155e-02 3.31746526e-02 3.75641743e-03 1.91149376e-02
 2.67332997e-02 3.75641743e-03 7.01733157e-02 4.88999076e-02
 1.91149376e-02 2.25842954e-03 3.75641743e-03 1.55280456e-01
 3.75641743e-03 3.75641743e-03 3.75641743e-03 3.23328539e-03
 5.08821867e-02 3.23327677e-03 7.98563845e-03 3.23327677e-03
 5.28633744e-02 5.28633967e-02 5.28633967e-02 3.75641743e-03
 3.75641743e-03 3.75641743e-03 3.75641743e-03 3.78157735e-01
 7.98563845e-03 3.23327677e-03 3.75641743e-03 3.75641743e-03
 3.75641743e-03 8.93836748e-03 3.75641743e-03 3.75641743e-03
 3.11515480e-03 7.98565429e-03 4.27895179e-03 1.37857169e-01
 3.11515480e-03 3.75641743e-03 3.75641743e-03 9.68291424e-03
 5.08819558e-02 6.00176975e-02 6.00176975e-02 5.33731980e-03
 2.17579715e-02 2.70105489e-02 2.70105824e-02 2.17579715e-02
 6.00177050e-02 4.27896297e-03 6.00176975e-02 2.03103442e-02
 8.94114934e-03 6.00176714e-02]
2025-06-02 15:55:07,024 - DEBUG - Edge reconstruction errors: [ 5.2634735  5.2622766 44.2589    ... 13.358875   2.158724  13.358874 ]
2025-06-02 15:55:07,028 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155507_update_39.json
2025-06-02 15:55:07,028 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:55:07,049 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155507_update_39.pth and as latest_checkpoint.pth
2025-06-02 15:55:07,050 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870265.dot): 0.6231
2025-06-02 15:55:07,050 - WARNING - Detected 5 anomalous nodes (reconstruction-based):
2025-06-02 15:55:07,050 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.6146, MLP Score: 0.5030
2025-06-02 15:55:07,050 - WARNING -   Node ID: 192.168.27.13, Recon Error: 1.7877, MLP Score: 0.4760
2025-06-02 15:55:07,050 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.8309, MLP Score: 0.4784
2025-06-02 15:55:07,051 - WARNING -   Node ID: 192.168.27.10, Recon Error: 2.2121, MLP Score: 0.5074
2025-06-02 15:55:07,051 - WARNING -   Node ID: 183.81.34.26, Recon Error: 8.4755, MLP Score: 0.4760
2025-06-02 15:55:07,051 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:55:07,051 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2589, MLP Score: 0.0637
2025-06-02 15:55:07,051 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9606, MLP Score: 0.0220
2025-06-02 15:55:07,051 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0613, MLP Score: 0.0220
2025-06-02 15:55:07,051 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7599, MLP Score: 0.0119
2025-06-02 15:55:07,051 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7592, MLP Score: 0.0111
2025-06-02 15:55:07,051 - INFO - 
--- Processing file: nw_graph_encoded_1748870295.dot (Timestamp: 2025-06-02 15:18:15) ---
2025-06-02 15:55:07,051 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870295.dot
2025-06-02 15:55:07,051 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870295.dot'.
2025-06-02 15:55:07,051 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870295.dot
2025-06-02 15:55:07,075 - INFO - Parsed 918 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870295.dot'.
2025-06-02 15:55:07,097 - INFO - Parsed 1958 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870295.dot'.
2025-06-02 15:55:07,097 - INFO - Processing node updates/additions.
2025-06-02 15:55:07,102 - INFO - Processing edge updates/additions.
2025-06-02 15:55:07,112 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:55:07,113 - INFO - Finished updating NetworkX graph.
2025-06-02 15:55:07,114 - DEBUG - Updated graph - Nodes: 918, Edges: 1958
2025-06-02 15:55:07,114 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:55:07,115 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:55:07,123 - DEBUG - Initial node features tensor shape: torch.Size([918, 30])
2025-06-02 15:55:07,125 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:55:07,125 - DEBUG - Node features tensor shape after scaling: torch.Size([918, 30])
2025-06-02 15:55:07,129 - DEBUG - Edge index tensor shape: torch.Size([2, 1958])
2025-06-02 15:55:07,131 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:55:07,134 - DEBUG - Initial edge attributes tensor shape: torch.Size([1958, 10])
2025-06-02 15:55:07,136 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:55:07,136 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1958, 10])
2025-06-02 15:55:07,136 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:55:07,136 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:55:07,137 - INFO - Updated main graph to 918 nodes and 1958 edges.
2025-06-02 15:55:07,137 - INFO - Performing online update...
2025-06-02 15:55:07,137 - INFO - Starting online update for 50 steps.
2025-06-02 15:55:07,138 - DEBUG - Updated RunningStats: new_mean=0.9440031840024941, new_var=58200000000161.88, new_n=5850
2025-06-02 15:55:07,138 - DEBUG - Updated RunningStats: new_mean=0.9429626808815351, new_var=58500000000018.0, new_n=5880
2025-06-02 15:55:07,138 - DEBUG - Updated RunningStats: new_mean=44.71703796547527, new_var=19400000188761.402, new_n=1950
2025-06-02 15:55:07,138 - DEBUG - Updated RunningStats: new_mean=44.72761527392966, new_var=19500000190585.465, new_n=1960
2025-06-02 15:55:07,139 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:55:07,139 - DEBUG - Online update step: 1/50
2025-06-02 15:55:07,141 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:07,223 - DEBUG - Node anomaly scores shape: torch.Size([16390, 1])
2025-06-02 15:55:07,228 - DEBUG - Edge anomaly scores shape: torch.Size([33881, 1])
2025-06-02 15:55:07,229 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:07,416 - DEBUG - Step 1: Loss=0.6489
2025-06-02 15:55:07,416 - DEBUG - Online update step: 2/50
2025-06-02 15:55:07,419 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:07,554 - DEBUG - Node anomaly scores shape: torch.Size([15823, 1])
2025-06-02 15:55:07,562 - DEBUG - Edge anomaly scores shape: torch.Size([32507, 1])
2025-06-02 15:55:07,563 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:07,949 - DEBUG - Step 2: Loss=0.6605
2025-06-02 15:55:07,949 - DEBUG - Online update step: 3/50
2025-06-02 15:55:07,954 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:09,385 - DEBUG - Node anomaly scores shape: torch.Size([17717, 1])
2025-06-02 15:55:09,539 - DEBUG - Edge anomaly scores shape: torch.Size([36868, 1])
2025-06-02 15:55:09,613 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:12,195 - DEBUG - Step 3: Loss=0.6351
2025-06-02 15:55:12,196 - DEBUG - Online update step: 4/50
2025-06-02 15:55:12,202 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:12,518 - DEBUG - Node anomaly scores shape: torch.Size([16830, 1])
2025-06-02 15:55:12,531 - DEBUG - Edge anomaly scores shape: torch.Size([34845, 1])
2025-06-02 15:55:12,533 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:12,984 - DEBUG - Step 4: Loss=0.6467
2025-06-02 15:55:12,985 - DEBUG - Online update step: 5/50
2025-06-02 15:55:12,988 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:13,133 - DEBUG - Node anomaly scores shape: torch.Size([17329, 1])
2025-06-02 15:55:13,138 - DEBUG - Edge anomaly scores shape: torch.Size([35863, 1])
2025-06-02 15:55:13,140 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:13,442 - DEBUG - Step 5: Loss=0.6580
2025-06-02 15:55:13,444 - DEBUG - Online update step: 6/50
2025-06-02 15:55:13,450 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:13,792 - DEBUG - Node anomaly scores shape: torch.Size([17744, 1])
2025-06-02 15:55:13,807 - DEBUG - Edge anomaly scores shape: torch.Size([36676, 1])
2025-06-02 15:55:13,808 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:14,183 - DEBUG - Step 6: Loss=0.6341
2025-06-02 15:55:14,183 - DEBUG - Online update step: 7/50
2025-06-02 15:55:14,187 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:14,301 - DEBUG - Node anomaly scores shape: torch.Size([17741, 1])
2025-06-02 15:55:14,306 - DEBUG - Edge anomaly scores shape: torch.Size([36831, 1])
2025-06-02 15:55:14,307 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:14,513 - DEBUG - Step 7: Loss=0.6470
2025-06-02 15:55:14,513 - DEBUG - Online update step: 8/50
2025-06-02 15:55:14,516 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:14,659 - DEBUG - Node anomaly scores shape: torch.Size([17142, 1])
2025-06-02 15:55:14,664 - DEBUG - Edge anomaly scores shape: torch.Size([35533, 1])
2025-06-02 15:55:14,665 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:14,896 - DEBUG - Step 8: Loss=0.6587
2025-06-02 15:55:14,896 - DEBUG - Online update step: 9/50
2025-06-02 15:55:14,900 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:15,046 - DEBUG - Node anomaly scores shape: torch.Size([18030, 1])
2025-06-02 15:55:15,052 - DEBUG - Edge anomaly scores shape: torch.Size([37455, 1])
2025-06-02 15:55:15,053 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:15,298 - DEBUG - Step 9: Loss=0.6349
2025-06-02 15:55:15,299 - DEBUG - Online update step: 10/50
2025-06-02 15:55:15,303 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:15,459 - DEBUG - Node anomaly scores shape: torch.Size([16173, 1])
2025-06-02 15:55:15,466 - DEBUG - Edge anomaly scores shape: torch.Size([33351, 1])
2025-06-02 15:55:15,467 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:15,757 - DEBUG - Step 10: Loss=0.6465
2025-06-02 15:55:15,758 - DEBUG - Online update step: 11/50
2025-06-02 15:55:15,761 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:15,889 - DEBUG - Node anomaly scores shape: torch.Size([16771, 1])
2025-06-02 15:55:15,894 - DEBUG - Edge anomaly scores shape: torch.Size([34602, 1])
2025-06-02 15:55:15,895 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:16,197 - DEBUG - Step 11: Loss=0.6558
2025-06-02 15:55:16,198 - DEBUG - Online update step: 12/50
2025-06-02 15:55:16,201 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:16,404 - DEBUG - Node anomaly scores shape: torch.Size([15365, 1])
2025-06-02 15:55:16,421 - DEBUG - Edge anomaly scores shape: torch.Size([31488, 1])
2025-06-02 15:55:16,425 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:16,662 - DEBUG - Step 12: Loss=0.6328
2025-06-02 15:55:16,662 - DEBUG - Online update step: 13/50
2025-06-02 15:55:16,672 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:16,849 - DEBUG - Node anomaly scores shape: torch.Size([16373, 1])
2025-06-02 15:55:16,859 - DEBUG - Edge anomaly scores shape: torch.Size([33827, 1])
2025-06-02 15:55:16,864 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:17,218 - DEBUG - Step 13: Loss=0.6473
2025-06-02 15:55:17,219 - DEBUG - Online update step: 14/50
2025-06-02 15:55:17,222 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:17,419 - DEBUG - Node anomaly scores shape: torch.Size([16480, 1])
2025-06-02 15:55:17,437 - DEBUG - Edge anomaly scores shape: torch.Size([34059, 1])
2025-06-02 15:55:17,444 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:17,659 - DEBUG - Step 14: Loss=0.6560
2025-06-02 15:55:17,660 - DEBUG - Online update step: 15/50
2025-06-02 15:55:17,671 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:17,805 - DEBUG - Node anomaly scores shape: torch.Size([16702, 1])
2025-06-02 15:55:17,810 - DEBUG - Edge anomaly scores shape: torch.Size([34526, 1])
2025-06-02 15:55:17,812 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:18,109 - DEBUG - Step 15: Loss=0.6322
2025-06-02 15:55:18,109 - DEBUG - Online update step: 16/50
2025-06-02 15:55:18,113 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:18,264 - DEBUG - Node anomaly scores shape: torch.Size([16502, 1])
2025-06-02 15:55:18,277 - DEBUG - Edge anomaly scores shape: torch.Size([34006, 1])
2025-06-02 15:55:18,281 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:18,559 - DEBUG - Step 16: Loss=0.6461
2025-06-02 15:55:18,559 - DEBUG - Online update step: 17/50
2025-06-02 15:55:18,562 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:18,680 - DEBUG - Node anomaly scores shape: torch.Size([16217, 1])
2025-06-02 15:55:18,686 - DEBUG - Edge anomaly scores shape: torch.Size([33426, 1])
2025-06-02 15:55:18,687 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:18,880 - DEBUG - Step 17: Loss=0.6554
2025-06-02 15:55:18,880 - DEBUG - Online update step: 18/50
2025-06-02 15:55:18,884 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:19,009 - DEBUG - Node anomaly scores shape: torch.Size([16629, 1])
2025-06-02 15:55:19,013 - DEBUG - Edge anomaly scores shape: torch.Size([34370, 1])
2025-06-02 15:55:19,014 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:19,180 - DEBUG - Step 18: Loss=0.6309
2025-06-02 15:55:19,180 - DEBUG - Online update step: 19/50
2025-06-02 15:55:19,183 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:19,277 - DEBUG - Node anomaly scores shape: torch.Size([16234, 1])
2025-06-02 15:55:19,283 - DEBUG - Edge anomaly scores shape: torch.Size([33439, 1])
2025-06-02 15:55:19,284 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:19,495 - DEBUG - Step 19: Loss=0.6475
2025-06-02 15:55:19,495 - DEBUG - Online update step: 20/50
2025-06-02 15:55:19,498 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:19,585 - DEBUG - Node anomaly scores shape: torch.Size([16299, 1])
2025-06-02 15:55:19,589 - DEBUG - Edge anomaly scores shape: torch.Size([33746, 1])
2025-06-02 15:55:19,590 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:19,778 - DEBUG - Step 20: Loss=0.6573
2025-06-02 15:55:19,778 - DEBUG - Online update step: 21/50
2025-06-02 15:55:19,782 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:19,885 - DEBUG - Node anomaly scores shape: torch.Size([15462, 1])
2025-06-02 15:55:19,890 - DEBUG - Edge anomaly scores shape: torch.Size([31678, 1])
2025-06-02 15:55:19,891 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:20,113 - DEBUG - Step 21: Loss=0.6356
2025-06-02 15:55:20,114 - DEBUG - Online update step: 22/50
2025-06-02 15:55:20,118 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:20,273 - DEBUG - Node anomaly scores shape: torch.Size([16975, 1])
2025-06-02 15:55:20,279 - DEBUG - Edge anomaly scores shape: torch.Size([35125, 1])
2025-06-02 15:55:20,280 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:20,551 - DEBUG - Step 22: Loss=0.6434
2025-06-02 15:55:20,551 - DEBUG - Online update step: 23/50
2025-06-02 15:55:20,555 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:20,696 - DEBUG - Node anomaly scores shape: torch.Size([16131, 1])
2025-06-02 15:55:20,701 - DEBUG - Edge anomaly scores shape: torch.Size([33375, 1])
2025-06-02 15:55:20,702 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:20,931 - DEBUG - Step 23: Loss=0.6546
2025-06-02 15:55:20,931 - DEBUG - Online update step: 24/50
2025-06-02 15:55:20,935 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:21,070 - DEBUG - Node anomaly scores shape: torch.Size([16690, 1])
2025-06-02 15:55:21,077 - DEBUG - Edge anomaly scores shape: torch.Size([34388, 1])
2025-06-02 15:55:21,078 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:21,389 - DEBUG - Step 24: Loss=0.6315
2025-06-02 15:55:21,390 - DEBUG - Online update step: 25/50
2025-06-02 15:55:21,400 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:21,529 - DEBUG - Node anomaly scores shape: torch.Size([16903, 1])
2025-06-02 15:55:21,535 - DEBUG - Edge anomaly scores shape: torch.Size([34948, 1])
2025-06-02 15:55:21,537 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:21,817 - DEBUG - Step 25: Loss=0.6444
2025-06-02 15:55:21,818 - DEBUG - Online update step: 26/50
2025-06-02 15:55:21,826 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:21,968 - DEBUG - Node anomaly scores shape: torch.Size([16370, 1])
2025-06-02 15:55:21,975 - DEBUG - Edge anomaly scores shape: torch.Size([33711, 1])
2025-06-02 15:55:21,977 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:22,219 - DEBUG - Step 26: Loss=0.6553
2025-06-02 15:55:22,219 - DEBUG - Online update step: 27/50
2025-06-02 15:55:22,227 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:22,400 - DEBUG - Node anomaly scores shape: torch.Size([16709, 1])
2025-06-02 15:55:22,410 - DEBUG - Edge anomaly scores shape: torch.Size([34652, 1])
2025-06-02 15:55:22,411 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:22,849 - DEBUG - Step 27: Loss=0.6315
2025-06-02 15:55:22,849 - DEBUG - Online update step: 28/50
2025-06-02 15:55:22,852 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:23,023 - DEBUG - Node anomaly scores shape: torch.Size([17454, 1])
2025-06-02 15:55:23,029 - DEBUG - Edge anomaly scores shape: torch.Size([36262, 1])
2025-06-02 15:55:23,031 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:23,268 - DEBUG - Step 28: Loss=0.6432
2025-06-02 15:55:23,269 - DEBUG - Online update step: 29/50
2025-06-02 15:55:23,271 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:23,384 - DEBUG - Node anomaly scores shape: torch.Size([15955, 1])
2025-06-02 15:55:23,393 - DEBUG - Edge anomaly scores shape: torch.Size([32970, 1])
2025-06-02 15:55:23,396 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:23,671 - DEBUG - Step 29: Loss=0.6534
2025-06-02 15:55:23,671 - DEBUG - Online update step: 30/50
2025-06-02 15:55:23,675 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:23,839 - DEBUG - Node anomaly scores shape: torch.Size([17421, 1])
2025-06-02 15:55:23,846 - DEBUG - Edge anomaly scores shape: torch.Size([36044, 1])
2025-06-02 15:55:23,847 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:24,172 - DEBUG - Step 30: Loss=0.6298
2025-06-02 15:55:24,172 - DEBUG - Online update step: 31/50
2025-06-02 15:55:24,175 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:24,277 - DEBUG - Node anomaly scores shape: torch.Size([16054, 1])
2025-06-02 15:55:24,283 - DEBUG - Edge anomaly scores shape: torch.Size([33003, 1])
2025-06-02 15:55:24,284 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:24,555 - DEBUG - Step 31: Loss=0.6451
2025-06-02 15:55:24,555 - DEBUG - Online update step: 32/50
2025-06-02 15:55:24,560 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:24,823 - DEBUG - Node anomaly scores shape: torch.Size([17261, 1])
2025-06-02 15:55:24,834 - DEBUG - Edge anomaly scores shape: torch.Size([35823, 1])
2025-06-02 15:55:24,836 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:25,212 - DEBUG - Step 32: Loss=0.6551
2025-06-02 15:55:25,212 - DEBUG - Online update step: 33/50
2025-06-02 15:55:25,215 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:25,363 - DEBUG - Node anomaly scores shape: torch.Size([17729, 1])
2025-06-02 15:55:25,370 - DEBUG - Edge anomaly scores shape: torch.Size([37035, 1])
2025-06-02 15:55:25,371 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:25,645 - DEBUG - Step 33: Loss=0.6313
2025-06-02 15:55:25,646 - DEBUG - Online update step: 34/50
2025-06-02 15:55:25,650 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:25,846 - DEBUG - Node anomaly scores shape: torch.Size([16134, 1])
2025-06-02 15:55:25,873 - DEBUG - Edge anomaly scores shape: torch.Size([33386, 1])
2025-06-02 15:55:25,878 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:26,227 - DEBUG - Step 34: Loss=0.6421
2025-06-02 15:55:26,228 - DEBUG - Online update step: 35/50
2025-06-02 15:55:26,232 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:26,329 - DEBUG - Node anomaly scores shape: torch.Size([16945, 1])
2025-06-02 15:55:26,334 - DEBUG - Edge anomaly scores shape: torch.Size([35031, 1])
2025-06-02 15:55:26,335 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:26,510 - DEBUG - Step 35: Loss=0.6527
2025-06-02 15:55:26,511 - DEBUG - Online update step: 36/50
2025-06-02 15:55:26,514 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:26,603 - DEBUG - Node anomaly scores shape: torch.Size([16523, 1])
2025-06-02 15:55:26,607 - DEBUG - Edge anomaly scores shape: torch.Size([34019, 1])
2025-06-02 15:55:26,608 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:26,782 - DEBUG - Step 36: Loss=0.6307
2025-06-02 15:55:26,782 - DEBUG - Online update step: 37/50
2025-06-02 15:55:26,785 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:26,881 - DEBUG - Node anomaly scores shape: torch.Size([17068, 1])
2025-06-02 15:55:26,886 - DEBUG - Edge anomaly scores shape: torch.Size([35305, 1])
2025-06-02 15:55:26,887 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:27,093 - DEBUG - Step 37: Loss=0.6424
2025-06-02 15:55:27,094 - DEBUG - Online update step: 38/50
2025-06-02 15:55:27,097 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:27,240 - DEBUG - Node anomaly scores shape: torch.Size([17377, 1])
2025-06-02 15:55:27,247 - DEBUG - Edge anomaly scores shape: torch.Size([35979, 1])
2025-06-02 15:55:27,248 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:27,527 - DEBUG - Step 38: Loss=0.6534
2025-06-02 15:55:27,527 - DEBUG - Online update step: 39/50
2025-06-02 15:55:27,531 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:27,655 - DEBUG - Node anomaly scores shape: torch.Size([17815, 1])
2025-06-02 15:55:27,661 - DEBUG - Edge anomaly scores shape: torch.Size([37087, 1])
2025-06-02 15:55:27,662 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:27,945 - DEBUG - Step 39: Loss=0.6295
2025-06-02 15:55:27,946 - DEBUG - Online update step: 40/50
2025-06-02 15:55:27,952 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:28,220 - DEBUG - Node anomaly scores shape: torch.Size([16204, 1])
2025-06-02 15:55:28,227 - DEBUG - Edge anomaly scores shape: torch.Size([33388, 1])
2025-06-02 15:55:28,228 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:28,474 - DEBUG - Step 40: Loss=0.6415
2025-06-02 15:55:28,475 - DEBUG - Online update step: 41/50
2025-06-02 15:55:28,486 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:28,644 - DEBUG - Node anomaly scores shape: torch.Size([17708, 1])
2025-06-02 15:55:28,652 - DEBUG - Edge anomaly scores shape: torch.Size([36852, 1])
2025-06-02 15:55:28,656 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:28,941 - DEBUG - Step 41: Loss=0.6508
2025-06-02 15:55:28,942 - DEBUG - Online update step: 42/50
2025-06-02 15:55:28,945 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:29,085 - DEBUG - Node anomaly scores shape: torch.Size([17456, 1])
2025-06-02 15:55:29,091 - DEBUG - Edge anomaly scores shape: torch.Size([36192, 1])
2025-06-02 15:55:29,092 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:29,389 - DEBUG - Step 42: Loss=0.6281
2025-06-02 15:55:29,389 - DEBUG - Online update step: 43/50
2025-06-02 15:55:29,394 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:29,559 - DEBUG - Node anomaly scores shape: torch.Size([17653, 1])
2025-06-02 15:55:29,568 - DEBUG - Edge anomaly scores shape: torch.Size([36655, 1])
2025-06-02 15:55:29,570 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:30,030 - DEBUG - Step 43: Loss=0.6416
2025-06-02 15:55:30,030 - DEBUG - Online update step: 44/50
2025-06-02 15:55:30,034 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:30,191 - DEBUG - Node anomaly scores shape: torch.Size([17191, 1])
2025-06-02 15:55:30,197 - DEBUG - Edge anomaly scores shape: torch.Size([35646, 1])
2025-06-02 15:55:30,198 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:30,485 - DEBUG - Step 44: Loss=0.6534
2025-06-02 15:55:30,485 - DEBUG - Online update step: 45/50
2025-06-02 15:55:30,489 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:30,662 - DEBUG - Node anomaly scores shape: torch.Size([18194, 1])
2025-06-02 15:55:30,668 - DEBUG - Edge anomaly scores shape: torch.Size([37961, 1])
2025-06-02 15:55:30,669 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:31,068 - DEBUG - Step 45: Loss=0.6288
2025-06-02 15:55:31,068 - DEBUG - Online update step: 46/50
2025-06-02 15:55:31,071 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:31,208 - DEBUG - Node anomaly scores shape: torch.Size([16938, 1])
2025-06-02 15:55:31,214 - DEBUG - Edge anomaly scores shape: torch.Size([35124, 1])
2025-06-02 15:55:31,215 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:31,472 - DEBUG - Step 46: Loss=0.6407
2025-06-02 15:55:31,472 - DEBUG - Online update step: 47/50
2025-06-02 15:55:31,476 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:31,645 - DEBUG - Node anomaly scores shape: torch.Size([16698, 1])
2025-06-02 15:55:31,661 - DEBUG - Edge anomaly scores shape: torch.Size([34694, 1])
2025-06-02 15:55:31,662 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:32,022 - DEBUG - Step 47: Loss=0.6504
2025-06-02 15:55:32,022 - DEBUG - Online update step: 48/50
2025-06-02 15:55:32,025 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:32,150 - DEBUG - Node anomaly scores shape: torch.Size([16671, 1])
2025-06-02 15:55:32,156 - DEBUG - Edge anomaly scores shape: torch.Size([34427, 1])
2025-06-02 15:55:32,157 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:32,404 - DEBUG - Step 48: Loss=0.6275
2025-06-02 15:55:32,404 - DEBUG - Online update step: 49/50
2025-06-02 15:55:32,416 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:32,554 - DEBUG - Node anomaly scores shape: torch.Size([17490, 1])
2025-06-02 15:55:32,563 - DEBUG - Edge anomaly scores shape: torch.Size([36156, 1])
2025-06-02 15:55:32,566 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:32,847 - DEBUG - Step 49: Loss=0.6417
2025-06-02 15:55:32,848 - DEBUG - Online update step: 50/50
2025-06-02 15:55:32,852 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:33,015 - DEBUG - Node anomaly scores shape: torch.Size([17376, 1])
2025-06-02 15:55:33,024 - DEBUG - Edge anomaly scores shape: torch.Size([36073, 1])
2025-06-02 15:55:33,027 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:33,309 - DEBUG - Step 50: Loss=0.6521
2025-06-02 15:55:33,309 - INFO - Online update finished. Average loss: 0.6439, Learning rate: 0.001000
2025-06-02 15:55:33,310 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  5.4540198e-08 -1.7141206e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.6750669e-08
  4.8826461e-08 -1.6102344e-08 -1.4544053e-08  7.2720265e-09
  2.3082788e+00  2.9607842e+00  1.4270152e-01  4.4074073e+00
  1.1946900e-08  3.3213508e+00  5.8714595e+00  7.6034861e+00
  1.4270152e-01  7.9923749e+00  1.2985761e-09  9.0900327e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.4024622e-08  4.9865324e-08], current edge mean: [-9.7413111e-10  4.5795404e+02  0.0000000e+00  0.0000000e+00
 -2.4353277e-09  6.3318519e-09 -4.8706555e-10  9.7413111e-10
  2.9223932e-09  9.7413111e-10]
2025-06-02 15:55:33,310 - DEBUG - Node drift difference: 0.0134, Edge drift difference: 0.0002
2025-06-02 15:55:33,311 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  5.4540198e-08 -1.7141206e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.6750669e-08
  4.8826461e-08 -1.6102344e-08 -1.4544053e-08  7.2720265e-09
  2.3082788e+00  2.9607842e+00  1.4270152e-01  4.4074073e+00
  1.1946900e-08  3.3213508e+00  5.8714595e+00  7.6034861e+00
  1.4270152e-01  7.9923749e+00  1.2985761e-09  9.0900327e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.4024622e-08  4.9865324e-08], edge=[-9.7413111e-10  4.5795404e+02  0.0000000e+00  0.0000000e+00
 -2.4353277e-09  6.3318519e-09 -4.8706555e-10  9.7413111e-10
  2.9223932e-09  9.7413111e-10]
2025-06-02 15:55:33,312 - DEBUG - Updated reference std: node=[0.         0.         1.0005451  1.0005451  0.         0.
 0.         1.0005451  1.0005451  1.0005451  1.0005451  1.0005451
 1.0198451  0.27744794 0.36818114 0.57352495 1.000545   2.9750328
 2.8805428  1.5016054  0.36818114 0.23103443 1.0005451  1.0005451
 0.         0.         0.         0.         1.0005451  1.000545  ], edge=[  1.0002555 460.90012     0.          0.          1.0002555   1.0002555
   1.0002555   1.0002555   1.0002555   1.0002555]
2025-06-02 15:55:33,321 - INFO - Online update complete. Loss: 0.6439
2025-06-02 15:55:33,321 - INFO - Running anomaly detection...
2025-06-02 15:55:33,322 - INFO - Starting anomaly detection.
2025-06-02 15:55:33,334 - DEBUG - Node reconstruction errors: [1.59241155e-01 1.62365913e+00 1.69385266e+00 1.00263851e-02
 2.85122003e-02 3.71015444e-02 7.29294956e-01 1.94927454e-02
 1.94927286e-02 3.59810665e-02 1.94927286e-02 4.69174720e-02
 1.96884811e+00 2.37657040e-01 4.79512149e-03 1.53232794e-02
 3.19806784e-02 1.53234955e-02 5.31540141e-02 1.50536960e-02
 2.37407200e-02 4.79512149e-03 7.72325248e-02 2.37645339e-02
 4.00462933e-03 9.14941635e-03 4.00462933e-03 5.88126257e-02
 1.91116165e-02 4.00459394e-03 1.27905041e-01 2.00680599e-01
 5.43618761e-02 1.00782197e-02 1.01536594e-01 5.14262356e-02
 1.00357600e-01 1.50537044e-02 9.95363742e-02 1.07927568e-01
 2.55421326e-02 4.70619788e-03 1.50537044e-02 4.79948595e-02
 1.23254798e-01 1.99177489e-02 8.80397037e-02 3.69096011e-01
 1.89379826e-02 2.58206099e-01 5.20473793e-02 1.22098373e-02
 8.83003138e-03 3.51316594e-02 2.61729285e-02 5.81765771e-02
 4.21786249e-01 1.52681582e-02 1.96545608e-02 4.88717780e-02
 1.66253805e-01 3.37156430e-02 4.60298825e-03 1.16984444e-02
 7.84700215e-02 2.61728875e-02 1.60334595e-02 2.61728931e-02
 4.60298825e-03 3.37157212e-02 3.74153368e-02 3.25444788e-02
 5.99641586e-03 7.72733539e-02 8.49373117e-02 3.05559896e-02
 9.92980227e-02 4.23686430e-02 2.69285683e-02 3.23195830e-02
 9.81210731e-03 2.59364564e-02 2.90978342e-01 2.72366833e-02
 4.33443785e-02 3.63890380e-02 5.01512364e-02 4.18356732e-02
 4.03096713e-02 1.55678719e-01 3.74375540e-03 4.93809320e-02
 1.36315934e-02 3.70084122e-02 3.05266101e-02 1.55950248e-01
 9.23447963e-03 4.60591093e-02 2.92358338e-03 5.43843284e-02
 2.30300706e-02 9.23447963e-03 2.73049362e-02 2.50526845e-01
 1.51024973e-02 1.64869297e-02 1.17125595e-02 2.54649445e-02
 1.43307485e-02 1.14502333e-01 1.14014767e-01 1.18361758e-02
 2.59564221e-02 5.79212569e-02 1.86759699e-02 1.79058909e-02
 1.91822052e-02 5.64676113e-02 5.31478785e-02 1.43611273e-02
 2.85460474e-03 8.96240305e-03 6.09414093e-02 2.33155359e-02
 5.64091951e-02 1.43608935e-02 3.27282995e-02 3.02172583e-02
 6.02256991e-02 1.06696347e-02 1.41919432e-02 5.56574157e-03
 5.64844161e-02 2.16333330e-01 1.67747904e-02 1.67496316e-02
 3.32955196e-02 3.95584758e-03 1.27918988e-01 3.17633152e-02
 2.10603308e-02 4.48212437e-02 2.65379692e-03 2.10603550e-02
 3.02254353e-02 6.42449930e-02 1.91821847e-02 9.35628861e-02
 3.15941945e-02 5.38166873e-02 3.25389355e-01 1.64677948e-02
 3.23377550e-02 5.56574157e-03 2.44881343e-02 5.12496606e-02
 4.73043323e-03 2.66641099e-02 2.30300445e-02 2.42356230e-02
 2.10603550e-02 1.58956088e-02 4.73043323e-03 1.41919432e-02
 1.90732852e-02 2.03038976e-02 2.43258718e-02 2.59735025e-02
 1.62376855e-02 5.38169257e-02 3.59258577e-02 1.50834434e-02
 4.65475582e-03 8.38470310e-02 5.31470105e-02 8.57323742e+00
 2.84395982e-02 4.08373363e-02 2.08148528e-02 2.08151117e-02
 1.64879989e-02 2.26474293e-02 3.01012285e-02 7.08957836e-02
 5.42242900e-02 3.45170908e-02 2.47473060e-03 2.48704478e-02
 1.67069975e-02 4.37882543e-03 4.42464910e-02 3.70933563e-02
 5.49999215e-02 6.14925474e-03 1.27910003e-01 1.25876972e-02
 3.32185328e-01 2.76227575e-02 6.28886521e-02 2.85654832e-02
 1.13870250e-02 4.73043323e-03 2.83989273e-02 5.64310327e-02
 5.18746823e-02 1.20273847e-02 3.59032378e-02 1.10557988e-01
 2.30736868e-03 2.88344417e-02 1.73516665e-02 2.10644566e-02
 9.32997558e-03 4.43673842e-02 3.86950634e-02 2.71083438e-03
 5.52806146e-02 1.91821028e-02 1.16328612e-01 6.14925474e-03
 6.27250150e-02 2.47472408e-03 4.46399767e-03 9.32997558e-03
 4.73043323e-03 7.28542954e-02 5.44829182e-02 7.42593734e-03
 3.43832783e-02 7.98080768e-03 9.87483654e-03 5.09279408e-02
 5.91835864e-02 1.91822182e-02 1.91820916e-02 1.65995099e-02
 3.32978852e-02 4.46399767e-03 4.73043323e-03 5.55293187e-02
 4.69821543e-02 3.48296575e-02 7.06357742e-03 5.57491593e-02
 6.88473880e-03 6.15300089e-02 1.95073187e-02 4.55812626e-02
 7.06357323e-03 2.00704560e-02 4.65477165e-03 4.01526922e-03
 1.16328351e-01 2.74852850e-02 3.12104132e-02 4.17343155e-02
 4.37885756e-03 1.86547078e-03 2.30002999e-02 2.08149087e-02
 2.72877328e-02 3.00451461e-02 1.00328932e-02 4.97689173e-02
 5.12202270e-02 2.66497973e-02 3.60952951e-02 8.98719728e-02
 3.60950604e-02 1.98131111e-02 8.79793167e-02 6.43313751e-02
 3.60978395e-02 7.55868107e-02 2.21270043e-02 9.83817503e-02
 1.23376064e-02 7.25093335e-02 1.64879989e-02 3.43537852e-02
 1.17817849e-01 1.33666079e-02 2.69954968e-02 2.58456953e-02
 6.05326556e-02 1.08646937e-02 1.29976988e-01 1.26589108e-02
 2.26475243e-02 5.43681905e-02 4.64625582e-02 1.27864648e-02
 3.94229926e-02 6.88473880e-03 2.03341290e-01 2.70587229e-03
 2.98447050e-02 2.08150204e-02 1.25876796e-02 1.77081116e-02
 2.77709533e-02 3.49758635e-03 2.02317536e-02 4.55000922e-02
 3.49758635e-03 3.49758635e-03 3.49758123e-03 2.45628469e-02
 1.99118964e-02 3.49758123e-03 3.49758635e-03 2.80263461e-02
 3.49758635e-03 4.05587954e-03 1.64806638e-02 3.41280699e-02
 1.53068706e-01 1.62413698e-02 9.52058844e-03 1.45945279e-02
 6.21036664e-02 3.37210447e-02 6.19579963e-02 2.02317499e-02
 2.67800465e-02 6.71186373e-02 1.94557495e-02 4.60534208e-02
 3.12163606e-02 3.12163141e-02 1.81495801e-01 1.26145892e-02
 3.49758635e-03 2.21269690e-02 3.49758123e-03 2.45628245e-02
 2.33248156e-02 3.83564876e-03 2.67564855e-03 2.67564855e-03
 3.49758123e-03 8.06344952e-03 2.67564575e-03 6.88701496e-02
 4.44049388e-02 5.52799627e-02 2.02317890e-02 1.15166288e-02
 3.53103764e-02 2.98573617e-02 3.49758635e-03 1.72192045e-02
 5.88399507e-02 4.51834463e-02 6.76265080e-03 4.37885756e-03
 1.68132538e-03 3.49758635e-03 3.70719889e-03 3.04861087e-02
 4.62878086e-02 4.01326176e-03 1.15092292e-01 4.90913391e-02
 2.02317797e-02 8.17625448e-02 3.16273025e-03 4.73039299e-02
 1.92927215e-02 1.47027140e-02 3.51068713e-02 4.32198383e-02
 6.51690513e-02 5.63324355e-02 5.25628068e-02 4.51837666e-02
 4.30539111e-03 4.79429774e-03 4.44788113e-02 3.49758635e-03
 2.02317890e-02 2.40148511e-02 4.44192113e-03 2.73016915e-02
 1.27254631e-02 4.22110111e-02 3.05104330e-02 3.60676534e-02
 4.03578505e-02 3.49758123e-03 1.07982792e-01 4.64042537e-02
 1.82212275e-02 5.75546585e-02 3.82803231e-02 3.82803231e-02
 3.82803530e-02 1.69876628e-02 3.32432077e-03 1.77684911e-02
 3.75818810e-03 6.29583821e-02 3.82803231e-02 3.32432077e-03
 1.93781555e-02 1.82212219e-02 6.53398186e-02 1.44942645e-02
 1.82212237e-02 2.69550998e-02 3.82803231e-02 1.82209983e-02
 3.32432077e-03 3.82803530e-02 3.82803530e-02 5.78331947e-03
 7.85793085e-03 3.82803231e-02 4.28614765e-03 9.31281410e-03
 2.38758456e-02 4.93280124e-03 1.56251006e-02 4.12650080e-03
 5.84929772e-02 2.38761902e-02 8.00230168e-03 3.05593181e-02
 2.20092908e-02 7.70436740e-03 3.32716778e-02 1.66378003e-02
 3.51594202e-02 3.99412923e-02 3.82803231e-02 3.82803530e-02
 3.75818810e-03 3.46379988e-02 5.97985946e-02 2.08215546e-02
 7.03730574e-03 3.98256723e-03 1.13126323e-01 2.01183697e-03
 1.25768818e-02 3.31181958e-02 4.62303646e-02 3.88572668e-03
 1.43095339e-02 4.18524444e-03 5.57551645e-02 3.93089233e-03
 4.79318388e-03 3.20000178e-03 3.93089978e-03 1.69053860e-02
 4.12650080e-03 1.37719922e-02 1.59371216e-02 3.53531055e-02
 1.82602964e-02 5.20956004e-03 4.15081624e-03 2.11497005e-02
 4.15081624e-03 5.20956004e-03 3.51259601e-03 2.30130330e-02
 1.63003672e-02 1.40099954e-02 3.51259601e-03 1.82602964e-02
 3.42967845e-02 6.42736331e-02 5.19927815e-02 1.56252440e-02
 2.30130795e-02 1.82603095e-02 2.82288436e-03 5.66409621e-03
 1.12787150e-02 1.14761367e-01 6.96978858e-03 3.88572668e-03
 5.60402311e-02 2.43619876e-03 3.93089978e-03 2.08393931e-02
 1.20242722e-02 6.42719343e-02 1.91162061e-02 2.82290252e-03
 2.85492148e-02 2.33945344e-03 3.07774339e-02 4.51107044e-03
 1.77870691e-02 8.31123292e-02 3.20000178e-03 5.66409621e-03
 1.09633066e-01 2.33945344e-03 9.38663557e-02 1.34115163e-02
 3.34340357e-03 1.67008396e-02 2.19819741e-03 1.52948722e-01
 6.52077701e-03 3.93089233e-03 9.48364008e-03 3.92171135e-03
 3.92172765e-03 2.16858578e-03 4.13107798e-02 5.10686031e-03
 2.19820207e-03 1.83893014e-02 2.90621184e-02 3.87291573e-02
 1.83892734e-02 3.98260262e-03 2.19819741e-03 4.43108417e-02
 3.34340357e-03 1.77870113e-02 1.33988373e-02 4.68562990e-02
 1.83893517e-02 3.71421650e-02 5.10686031e-03 3.20000178e-03
 3.20000178e-03 5.66409621e-03 1.77870784e-02 1.78578608e-02
 3.06500979e-02 3.79352570e-02 3.20000178e-03 3.80441733e-02
 3.20000178e-03 3.80441733e-02 2.06160825e-02 1.83892790e-02
 3.59658408e-03 4.10984792e-02 1.82196107e-02 3.09187779e-03
 2.31697902e-01 3.09189851e-03 3.09184846e-03 3.09185195e-03
 3.09187779e-03 3.09189851e-03 3.09189851e-03 3.09189851e-03
 2.09039338e-02 3.40175838e-03 1.22094965e-02 3.09189851e-03
 3.09187779e-03 3.09187779e-03 3.09189851e-03 3.09187779e-03
 3.09187779e-03 3.09189851e-03 3.09187779e-03 3.09187779e-03
 1.80870704e-02 3.09187779e-03 3.09189851e-03 7.41410926e-02
 3.09189851e-03 1.29699297e-02 2.25581005e-02 3.20000178e-03
 2.16110423e-02 4.12712172e-02 7.51193389e-02 7.51193389e-02
 3.79434302e-02 2.16110423e-02 3.19999992e-03 2.19819741e-03
 2.19819741e-03 3.19999992e-03 2.19819741e-03 1.65038314e-02
 1.53594008e-02 3.09189851e-03 3.98256723e-03 3.20000178e-03
 3.92172765e-03 3.20000178e-03 3.20000178e-03 1.81738939e-02
 3.19999992e-03 2.19819741e-03 3.20000178e-03 3.20000178e-03
 1.83893070e-02 2.19820207e-03 3.20000178e-03 2.19820207e-03
 3.19999992e-03 3.19999992e-03 3.19999992e-03 3.05242892e-02
 4.96271737e-02 1.54770734e-02 3.09189851e-03 1.85476579e-02
 2.84412112e-02 3.20000178e-03 2.19820207e-03 3.39775309e-02
 3.09189851e-03 1.29474532e-02 4.38940264e-02 1.61176873e-03
 3.20000178e-03 3.20000178e-03 1.68138631e-02 3.25320065e-02
 1.60379037e-02 3.20000178e-03 2.09039096e-02 1.68758037e-03
 2.19819741e-03 3.98210697e-02 3.09189851e-03 2.14261357e-02
 5.38212173e-02 3.09189851e-03 3.09189851e-03 2.09039357e-02
 1.68758037e-03 3.20000178e-03 1.39830157e-01 3.85679975e-02
 4.07203399e-02 3.25320065e-02 4.86715464e-03 3.50644924e-02
 3.50644737e-02 2.18870603e-02 2.66936282e-03 3.09187779e-03
 3.59724299e-03 3.88741903e-02 3.25320065e-02 1.59365945e-02
 3.67882638e-03 5.36992541e-03 3.01818619e-03 3.01818619e-03
 3.01818619e-03 3.01818619e-03 3.01818619e-03 1.77683551e-02
 3.52953188e-02 3.01818619e-03 3.01818619e-03 3.09189851e-03
 1.62112003e-03 3.09189851e-03 3.50644961e-02 3.08178607e-02
 4.82378863e-02 8.16803612e-03 3.50644961e-02 4.78567854e-02
 1.80871449e-02 1.17333476e-02 1.80870462e-02 3.09187779e-03
 3.50644961e-02 3.19726276e-03 2.10079760e-03 2.10079760e-03
 3.01818619e-03 3.19726276e-03 3.24391052e-02 1.07692415e-02
 5.03768818e-03 3.09189851e-03 3.01818619e-03 7.53875636e-03
 2.10079760e-03 1.37173047e-03 3.61768901e-03 7.24431220e-03
 1.77683830e-02 6.99007213e-02 1.46368437e-03 6.34492487e-02
 1.41584380e-02 3.61767295e-03 2.97637330e-03 3.07456939e-03
 3.50586604e-03 1.98003766e-03 3.25210020e-02 5.78205567e-03
 3.35696414e-02 3.61767295e-03 3.61767295e-03 3.61768901e-03
 2.56572291e-03 7.53878057e-03 3.61767295e-03 3.50586604e-03
 3.61768901e-03 3.61768901e-03 3.61767295e-03 1.41441245e-02
 2.97578843e-03 3.33215222e-02 4.22012582e-02 3.44855711e-02
 3.16599803e-03 5.57857938e-03 3.17820199e-02 4.10648994e-02
 3.33222863e-03 2.85575818e-03 1.94294960e-03 1.82315893e-02
 1.82315838e-02 3.50586604e-03 5.15887178e-02 8.71737227e-02
 3.32895876e-03 2.93901493e-03 1.24287661e-02 5.58666140e-02
 2.78396462e-03 2.78396462e-03 2.78396462e-03 2.91896774e-03
 2.19584978e-03 2.42751651e-02 3.64513807e-02 1.22913949e-01
 1.37126436e-02 1.63963996e-03 3.43459868e-03 2.93899304e-03
 3.11856624e-03 1.31942164e-02 2.35080090e-03 1.47455204e-02
 3.32895201e-03 8.71734172e-02 2.93901493e-03 1.31941298e-02
 1.63963996e-03 3.73239852e-02 2.78396462e-03 2.91896774e-03
 2.35080090e-03 3.80444177e-03 1.86608415e-02 2.91896774e-03
 2.91896774e-03 2.91896774e-03 3.35387737e-02 4.55583543e-01
 6.67974710e-01 2.78396462e-03 3.68709937e-02 2.91896774e-03
 3.13814469e-02 4.39933129e-03 5.65819703e-02 4.39933734e-03
 2.91896774e-03 3.02560697e-03 3.54717812e-03 3.13586160e-03
 1.05355330e-01 4.39933129e-03 6.55306876e-02 1.48334270e-02
 4.23051268e-02 4.39933129e-03 2.81980876e-02 1.93526205e-02
 1.03457868e-02 3.98842618e-02 1.89202782e-02 2.99409358e-03
 2.99409358e-03 8.56416598e-02 1.07707612e-01 3.02560697e-03
 4.39933129e-03 1.03457971e-02 4.39933734e-03 1.73570612e-03
 2.92337663e-03 2.92337663e-03 2.10725749e-03 5.66327162e-02
 2.60176766e-03 2.92337663e-03 1.73570612e-03 3.29139493e-02
 2.92337663e-03 2.92337663e-03 3.19059193e-03 1.80767495e-02
 5.26461974e-02 5.00144809e-02 2.92337663e-03 2.27618217e-02
 3.29139493e-02 2.92337663e-03 2.88851536e-03 3.25525017e-03
 1.89619896e-03 1.89619896e-03 4.20075133e-02 3.25525017e-03
 2.92337663e-03 3.25525017e-03 3.50200827e-03 5.75568415e-02
 3.25834751e-02 2.92337663e-03 1.24835208e-01 4.31604683e-03
 3.25525017e-03 1.80767495e-02 3.36636207e-03 4.31604683e-03
 2.88851536e-03 1.51769379e-02 2.20921426e-03 2.17237119e-02
 5.94287319e-03 2.17237119e-02 1.25212267e-01 2.02294509e-03
 5.94287319e-03 3.63682304e-03 3.63682304e-03 1.19879313e-01
 3.63681372e-03 1.55448196e-02 3.36636207e-03 2.24951003e-02
 5.37227700e-03 2.02294509e-03 5.37227700e-03 4.18653041e-02
 3.19034792e-02 2.30398141e-02 3.63681372e-03 1.55151403e-02
 2.14524791e-02 3.63682304e-03 5.01781628e-02 4.05119881e-02
 1.82787646e-02 2.02294183e-03 3.63682304e-03 1.35074437e-01
 3.63682304e-03 3.63682304e-03 3.63682304e-03 3.03750741e-03
 3.85060459e-02 3.03751486e-03 6.85334625e-03 3.03749205e-03
 4.43473086e-02 3.95652056e-02 4.43473607e-02 3.63682304e-03
 3.63682304e-03 3.63682304e-03 3.63681372e-03 3.84628445e-01
 6.85334625e-03 3.03749205e-03 3.63681372e-03 3.63682304e-03
 3.63682304e-03 4.77096159e-03 3.63681372e-03 3.63681372e-03
 2.98954942e-03 6.85334625e-03 3.42197809e-03 8.46637264e-02
 2.98955082e-03 3.63681372e-03 3.63682304e-03 4.89263330e-03
 4.11440879e-02 4.42239232e-02 4.42239270e-02 4.22385195e-03
 2.13850215e-02 2.34332103e-02 6.31829305e-03 2.12728698e-02
 4.42239270e-02 3.42197809e-03 4.42239232e-02 1.85888428e-02
 6.31829305e-03 4.42239232e-02 8.24222714e-03 3.42197809e-03
 8.51983111e-03 4.22385195e-03]
2025-06-02 15:55:33,335 - DEBUG - Edge reconstruction errors: [ 5.2641516  5.2622833 44.25904   ... 13.359021   2.1589577 13.35902  ]
2025-06-02 15:55:33,337 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155533_update_40.json
2025-06-02 15:55:33,338 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:55:33,347 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155533_update_40.pth and as latest_checkpoint.pth
2025-06-02 15:55:33,347 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870295.dot): 0.6146
2025-06-02 15:55:33,347 - WARNING - Detected 4 anomalous nodes (reconstruction-based):
2025-06-02 15:55:33,347 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.6237, MLP Score: 0.5321
2025-06-02 15:55:33,347 - WARNING -   Node ID: 192.168.27.13, Recon Error: 1.6939, MLP Score: 0.5034
2025-06-02 15:55:33,347 - WARNING -   Node ID: 192.168.27.10, Recon Error: 1.9688, MLP Score: 0.5229
2025-06-02 15:55:33,347 - WARNING -   Node ID: 183.81.34.26, Recon Error: 8.5732, MLP Score: 0.5034
2025-06-02 15:55:33,347 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:55:33,348 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2590, MLP Score: 0.1194
2025-06-02 15:55:33,348 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9618, MLP Score: 0.0602
2025-06-02 15:55:33,348 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0613, MLP Score: 0.0602
2025-06-02 15:55:33,348 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7599, MLP Score: 0.0341
2025-06-02 15:55:33,348 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7594, MLP Score: 0.0321
2025-06-02 15:55:33,348 - INFO - 
--- Processing file: nw_graph_encoded_1748870325.dot (Timestamp: 2025-06-02 15:18:45) ---
2025-06-02 15:55:33,348 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870325.dot
2025-06-02 15:55:33,348 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870325.dot'.
2025-06-02 15:55:33,348 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870325.dot
2025-06-02 15:55:33,377 - INFO - Parsed 922 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870325.dot'.
2025-06-02 15:55:33,410 - INFO - Parsed 1981 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870325.dot'.
2025-06-02 15:55:33,410 - INFO - Processing node updates/additions.
2025-06-02 15:55:33,418 - INFO - Processing edge updates/additions.
2025-06-02 15:55:33,438 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:55:33,439 - INFO - Finished updating NetworkX graph.
2025-06-02 15:55:33,440 - DEBUG - Updated graph - Nodes: 922, Edges: 1981
2025-06-02 15:55:33,440 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:55:33,442 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:55:33,456 - DEBUG - Initial node features tensor shape: torch.Size([922, 30])
2025-06-02 15:55:33,458 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:55:33,459 - DEBUG - Node features tensor shape after scaling: torch.Size([922, 30])
2025-06-02 15:55:33,462 - DEBUG - Edge index tensor shape: torch.Size([2, 1981])
2025-06-02 15:55:33,464 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:55:33,481 - DEBUG - Initial edge attributes tensor shape: torch.Size([1981, 10])
2025-06-02 15:55:33,484 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:55:33,484 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1981, 10])
2025-06-02 15:55:33,484 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:55:33,485 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:55:33,486 - INFO - Updated main graph to 922 nodes and 1981 edges.
2025-06-02 15:55:33,486 - INFO - Performing online update...
2025-06-02 15:55:33,486 - INFO - Starting online update for 50 steps.
2025-06-02 15:55:33,487 - DEBUG - Updated RunningStats: new_mean=0.9440530884281254, new_var=58800000000161.695, new_n=5910
2025-06-02 15:55:33,487 - DEBUG - Updated RunningStats: new_mean=0.9430256425100368, new_var=59100000000018.03, new_n=5940
2025-06-02 15:55:33,487 - DEBUG - Updated RunningStats: new_mean=44.73294739234081, new_var=19600000188617.6, new_n=1970
2025-06-02 15:55:33,488 - DEBUG - Updated RunningStats: new_mean=44.741982964624626, new_var=19700000188359.754, new_n=1980
2025-06-02 15:55:33,488 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:55:33,488 - DEBUG - Online update step: 1/50
2025-06-02 15:55:33,491 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:33,725 - DEBUG - Node anomaly scores shape: torch.Size([16926, 1])
2025-06-02 15:55:33,739 - DEBUG - Edge anomaly scores shape: torch.Size([34990, 1])
2025-06-02 15:55:33,742 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:34,111 - DEBUG - Step 1: Loss=0.6285
2025-06-02 15:55:34,111 - DEBUG - Online update step: 2/50
2025-06-02 15:55:34,114 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:34,252 - DEBUG - Node anomaly scores shape: torch.Size([16642, 1])
2025-06-02 15:55:34,264 - DEBUG - Edge anomaly scores shape: torch.Size([34468, 1])
2025-06-02 15:55:34,266 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:34,726 - DEBUG - Step 2: Loss=0.6394
2025-06-02 15:55:34,727 - DEBUG - Online update step: 3/50
2025-06-02 15:55:34,742 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:34,928 - DEBUG - Node anomaly scores shape: torch.Size([16764, 1])
2025-06-02 15:55:34,944 - DEBUG - Edge anomaly scores shape: torch.Size([34686, 1])
2025-06-02 15:55:34,947 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:35,296 - DEBUG - Step 3: Loss=0.6490
2025-06-02 15:55:35,297 - DEBUG - Online update step: 4/50
2025-06-02 15:55:35,307 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:35,442 - DEBUG - Node anomaly scores shape: torch.Size([18191, 1])
2025-06-02 15:55:35,450 - DEBUG - Edge anomaly scores shape: torch.Size([38074, 1])
2025-06-02 15:55:35,453 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:35,705 - DEBUG - Step 4: Loss=0.6256
2025-06-02 15:55:35,706 - DEBUG - Online update step: 5/50
2025-06-02 15:55:35,718 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:35,863 - DEBUG - Node anomaly scores shape: torch.Size([17364, 1])
2025-06-02 15:55:35,869 - DEBUG - Edge anomaly scores shape: torch.Size([35998, 1])
2025-06-02 15:55:35,870 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:36,224 - DEBUG - Step 5: Loss=0.6413
2025-06-02 15:55:36,224 - DEBUG - Online update step: 6/50
2025-06-02 15:55:36,228 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:36,437 - DEBUG - Node anomaly scores shape: torch.Size([16240, 1])
2025-06-02 15:55:36,452 - DEBUG - Edge anomaly scores shape: torch.Size([33419, 1])
2025-06-02 15:55:36,455 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:36,673 - DEBUG - Step 6: Loss=0.6522
2025-06-02 15:55:36,674 - DEBUG - Online update step: 7/50
2025-06-02 15:55:36,680 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:36,764 - DEBUG - Node anomaly scores shape: torch.Size([16840, 1])
2025-06-02 15:55:36,769 - DEBUG - Edge anomaly scores shape: torch.Size([34864, 1])
2025-06-02 15:55:36,771 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:36,947 - DEBUG - Step 7: Loss=0.6283
2025-06-02 15:55:36,948 - DEBUG - Online update step: 8/50
2025-06-02 15:55:36,957 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:37,061 - DEBUG - Node anomaly scores shape: torch.Size([16575, 1])
2025-06-02 15:55:37,068 - DEBUG - Edge anomaly scores shape: torch.Size([34373, 1])
2025-06-02 15:55:37,069 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:37,247 - DEBUG - Step 8: Loss=0.6390
2025-06-02 15:55:37,247 - DEBUG - Online update step: 9/50
2025-06-02 15:55:37,255 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:37,362 - DEBUG - Node anomaly scores shape: torch.Size([16919, 1])
2025-06-02 15:55:37,369 - DEBUG - Edge anomaly scores shape: torch.Size([35019, 1])
2025-06-02 15:55:37,371 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:37,865 - DEBUG - Step 9: Loss=0.6491
2025-06-02 15:55:37,865 - DEBUG - Online update step: 10/50
2025-06-02 15:55:37,872 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:38,649 - DEBUG - Node anomaly scores shape: torch.Size([15868, 1])
2025-06-02 15:55:38,718 - DEBUG - Edge anomaly scores shape: torch.Size([32744, 1])
2025-06-02 15:55:38,767 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:41,241 - DEBUG - Step 10: Loss=0.6266
2025-06-02 15:55:41,241 - DEBUG - Online update step: 11/50
2025-06-02 15:55:41,248 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:43,107 - DEBUG - Node anomaly scores shape: torch.Size([16172, 1])
2025-06-02 15:55:43,214 - DEBUG - Edge anomaly scores shape: torch.Size([33243, 1])
2025-06-02 15:55:43,286 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:45,557 - DEBUG - Step 11: Loss=0.6400
2025-06-02 15:55:45,557 - DEBUG - Online update step: 12/50
2025-06-02 15:55:45,560 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:45,858 - DEBUG - Node anomaly scores shape: torch.Size([17394, 1])
2025-06-02 15:55:45,931 - DEBUG - Edge anomaly scores shape: torch.Size([36192, 1])
2025-06-02 15:55:45,982 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:46,681 - DEBUG - Step 12: Loss=0.6493
2025-06-02 15:55:46,682 - DEBUG - Online update step: 13/50
2025-06-02 15:55:46,686 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:47,287 - DEBUG - Node anomaly scores shape: torch.Size([18902, 1])
2025-06-02 15:55:47,291 - DEBUG - Edge anomaly scores shape: torch.Size([39309, 1])
2025-06-02 15:55:47,292 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:47,485 - DEBUG - Step 13: Loss=0.6263
2025-06-02 15:55:47,486 - DEBUG - Online update step: 14/50
2025-06-02 15:55:47,489 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:47,674 - DEBUG - Node anomaly scores shape: torch.Size([16307, 1])
2025-06-02 15:55:47,680 - DEBUG - Edge anomaly scores shape: torch.Size([33558, 1])
2025-06-02 15:55:47,683 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:47,877 - DEBUG - Step 14: Loss=0.6391
2025-06-02 15:55:47,878 - DEBUG - Online update step: 15/50
2025-06-02 15:55:47,884 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:48,043 - DEBUG - Node anomaly scores shape: torch.Size([17616, 1])
2025-06-02 15:55:48,050 - DEBUG - Edge anomaly scores shape: torch.Size([36507, 1])
2025-06-02 15:55:48,054 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:48,313 - DEBUG - Step 15: Loss=0.6489
2025-06-02 15:55:48,313 - DEBUG - Online update step: 16/50
2025-06-02 15:55:48,317 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:48,423 - DEBUG - Node anomaly scores shape: torch.Size([17817, 1])
2025-06-02 15:55:48,430 - DEBUG - Edge anomaly scores shape: torch.Size([36894, 1])
2025-06-02 15:55:48,432 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:48,617 - DEBUG - Step 16: Loss=0.6255
2025-06-02 15:55:48,617 - DEBUG - Online update step: 17/50
2025-06-02 15:55:48,620 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:48,736 - DEBUG - Node anomaly scores shape: torch.Size([17929, 1])
2025-06-02 15:55:48,741 - DEBUG - Edge anomaly scores shape: torch.Size([37210, 1])
2025-06-02 15:55:48,742 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:48,970 - DEBUG - Step 17: Loss=0.6392
2025-06-02 15:55:48,971 - DEBUG - Online update step: 18/50
2025-06-02 15:55:48,974 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:49,129 - DEBUG - Node anomaly scores shape: torch.Size([17463, 1])
2025-06-02 15:55:49,155 - DEBUG - Edge anomaly scores shape: torch.Size([36180, 1])
2025-06-02 15:55:49,156 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:49,698 - DEBUG - Step 18: Loss=0.6498
2025-06-02 15:55:49,698 - DEBUG - Online update step: 19/50
2025-06-02 15:55:49,701 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:49,786 - DEBUG - Node anomaly scores shape: torch.Size([16577, 1])
2025-06-02 15:55:49,790 - DEBUG - Edge anomaly scores shape: torch.Size([34197, 1])
2025-06-02 15:55:49,791 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:49,946 - DEBUG - Step 19: Loss=0.6276
2025-06-02 15:55:49,947 - DEBUG - Online update step: 20/50
2025-06-02 15:55:49,950 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:50,044 - DEBUG - Node anomaly scores shape: torch.Size([18226, 1])
2025-06-02 15:55:50,048 - DEBUG - Edge anomaly scores shape: torch.Size([37921, 1])
2025-06-02 15:55:50,049 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:50,279 - DEBUG - Step 20: Loss=0.6377
2025-06-02 15:55:50,279 - DEBUG - Online update step: 21/50
2025-06-02 15:55:50,286 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:50,635 - DEBUG - Node anomaly scores shape: torch.Size([17545, 1])
2025-06-02 15:55:50,640 - DEBUG - Edge anomaly scores shape: torch.Size([36447, 1])
2025-06-02 15:55:50,641 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:50,774 - DEBUG - Step 21: Loss=0.6473
2025-06-02 15:55:50,774 - DEBUG - Online update step: 22/50
2025-06-02 15:55:50,777 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:50,877 - DEBUG - Node anomaly scores shape: torch.Size([17071, 1])
2025-06-02 15:55:50,889 - DEBUG - Edge anomaly scores shape: torch.Size([35427, 1])
2025-06-02 15:55:50,890 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:51,052 - DEBUG - Step 22: Loss=0.6245
2025-06-02 15:55:51,053 - DEBUG - Online update step: 23/50
2025-06-02 15:55:51,056 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:51,157 - DEBUG - Node anomaly scores shape: torch.Size([16951, 1])
2025-06-02 15:55:51,161 - DEBUG - Edge anomaly scores shape: torch.Size([35163, 1])
2025-06-02 15:55:51,162 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:51,292 - DEBUG - Step 23: Loss=0.6386
2025-06-02 15:55:51,292 - DEBUG - Online update step: 24/50
2025-06-02 15:55:51,295 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:51,372 - DEBUG - Node anomaly scores shape: torch.Size([16923, 1])
2025-06-02 15:55:51,376 - DEBUG - Edge anomaly scores shape: torch.Size([34934, 1])
2025-06-02 15:55:51,377 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:51,541 - DEBUG - Step 24: Loss=0.6496
2025-06-02 15:55:51,542 - DEBUG - Online update step: 25/50
2025-06-02 15:55:51,547 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:51,678 - DEBUG - Node anomaly scores shape: torch.Size([16933, 1])
2025-06-02 15:55:51,702 - DEBUG - Edge anomaly scores shape: torch.Size([34947, 1])
2025-06-02 15:55:51,704 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:52,145 - DEBUG - Step 25: Loss=0.6260
2025-06-02 15:55:52,146 - DEBUG - Online update step: 26/50
2025-06-02 15:55:52,150 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:52,436 - DEBUG - Node anomaly scores shape: torch.Size([17831, 1])
2025-06-02 15:55:52,443 - DEBUG - Edge anomaly scores shape: torch.Size([37214, 1])
2025-06-02 15:55:52,444 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:52,914 - DEBUG - Step 26: Loss=0.6365
2025-06-02 15:55:52,915 - DEBUG - Online update step: 27/50
2025-06-02 15:55:52,921 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:53,068 - DEBUG - Node anomaly scores shape: torch.Size([16751, 1])
2025-06-02 15:55:53,072 - DEBUG - Edge anomaly scores shape: torch.Size([34617, 1])
2025-06-02 15:55:53,074 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:53,262 - DEBUG - Step 27: Loss=0.6474
2025-06-02 15:55:53,262 - DEBUG - Online update step: 28/50
2025-06-02 15:55:53,268 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:53,446 - DEBUG - Node anomaly scores shape: torch.Size([17609, 1])
2025-06-02 15:55:53,462 - DEBUG - Edge anomaly scores shape: torch.Size([36492, 1])
2025-06-02 15:55:53,481 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:53,739 - DEBUG - Step 28: Loss=0.6243
2025-06-02 15:55:53,739 - DEBUG - Online update step: 29/50
2025-06-02 15:55:53,744 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:53,929 - DEBUG - Node anomaly scores shape: torch.Size([17696, 1])
2025-06-02 15:55:53,933 - DEBUG - Edge anomaly scores shape: torch.Size([36713, 1])
2025-06-02 15:55:53,934 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:54,102 - DEBUG - Step 29: Loss=0.6379
2025-06-02 15:55:54,103 - DEBUG - Online update step: 30/50
2025-06-02 15:55:54,108 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:54,187 - DEBUG - Node anomaly scores shape: torch.Size([17582, 1])
2025-06-02 15:55:54,191 - DEBUG - Edge anomaly scores shape: torch.Size([36314, 1])
2025-06-02 15:55:54,193 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:54,376 - DEBUG - Step 30: Loss=0.6489
2025-06-02 15:55:54,377 - DEBUG - Online update step: 31/50
2025-06-02 15:55:54,382 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:54,470 - DEBUG - Node anomaly scores shape: torch.Size([16523, 1])
2025-06-02 15:55:54,474 - DEBUG - Edge anomaly scores shape: torch.Size([34098, 1])
2025-06-02 15:55:54,475 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:54,627 - DEBUG - Step 31: Loss=0.6272
2025-06-02 15:55:54,628 - DEBUG - Online update step: 32/50
2025-06-02 15:55:54,635 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:54,737 - DEBUG - Node anomaly scores shape: torch.Size([16533, 1])
2025-06-02 15:55:54,741 - DEBUG - Edge anomaly scores shape: torch.Size([34207, 1])
2025-06-02 15:55:54,742 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:54,920 - DEBUG - Step 32: Loss=0.6358
2025-06-02 15:55:54,920 - DEBUG - Online update step: 33/50
2025-06-02 15:55:54,926 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:55,114 - DEBUG - Node anomaly scores shape: torch.Size([18053, 1])
2025-06-02 15:55:55,138 - DEBUG - Edge anomaly scores shape: torch.Size([37552, 1])
2025-06-02 15:55:55,140 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:55,859 - DEBUG - Step 33: Loss=0.6457
2025-06-02 15:55:55,859 - DEBUG - Online update step: 34/50
2025-06-02 15:55:55,863 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:55,955 - DEBUG - Node anomaly scores shape: torch.Size([17544, 1])
2025-06-02 15:55:55,959 - DEBUG - Edge anomaly scores shape: torch.Size([36266, 1])
2025-06-02 15:55:55,960 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:56,177 - DEBUG - Step 34: Loss=0.6230
2025-06-02 15:55:56,178 - DEBUG - Online update step: 35/50
2025-06-02 15:55:56,184 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:56,353 - DEBUG - Node anomaly scores shape: torch.Size([16454, 1])
2025-06-02 15:55:56,361 - DEBUG - Edge anomaly scores shape: torch.Size([33964, 1])
2025-06-02 15:55:56,365 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:56,911 - DEBUG - Step 35: Loss=0.6370
2025-06-02 15:55:56,911 - DEBUG - Online update step: 36/50
2025-06-02 15:55:56,925 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:55:58,420 - DEBUG - Node anomaly scores shape: torch.Size([16467, 1])
2025-06-02 15:55:58,483 - DEBUG - Edge anomaly scores shape: torch.Size([33981, 1])
2025-06-02 15:55:58,517 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:55:59,226 - DEBUG - Step 36: Loss=0.6477
2025-06-02 15:55:59,226 - DEBUG - Online update step: 37/50
2025-06-02 15:55:59,252 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:00,588 - DEBUG - Node anomaly scores shape: torch.Size([18841, 1])
2025-06-02 15:56:00,647 - DEBUG - Edge anomaly scores shape: torch.Size([39360, 1])
2025-06-02 15:56:00,687 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:01,337 - DEBUG - Step 37: Loss=0.6228
2025-06-02 15:56:01,343 - DEBUG - Online update step: 38/50
2025-06-02 15:56:01,352 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:02,101 - DEBUG - Node anomaly scores shape: torch.Size([17952, 1])
2025-06-02 15:56:02,106 - DEBUG - Edge anomaly scores shape: torch.Size([37212, 1])
2025-06-02 15:56:02,107 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:02,267 - DEBUG - Step 38: Loss=0.6365
2025-06-02 15:56:02,268 - DEBUG - Online update step: 39/50
2025-06-02 15:56:02,272 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:02,366 - DEBUG - Node anomaly scores shape: torch.Size([16377, 1])
2025-06-02 15:56:02,374 - DEBUG - Edge anomaly scores shape: torch.Size([33829, 1])
2025-06-02 15:56:02,375 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:02,524 - DEBUG - Step 39: Loss=0.6463
2025-06-02 15:56:02,525 - DEBUG - Online update step: 40/50
2025-06-02 15:56:02,530 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:02,644 - DEBUG - Node anomaly scores shape: torch.Size([17282, 1])
2025-06-02 15:56:02,649 - DEBUG - Edge anomaly scores shape: torch.Size([35652, 1])
2025-06-02 15:56:02,652 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:02,814 - DEBUG - Step 40: Loss=0.6234
2025-06-02 15:56:02,814 - DEBUG - Online update step: 41/50
2025-06-02 15:56:02,819 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:02,908 - DEBUG - Node anomaly scores shape: torch.Size([17403, 1])
2025-06-02 15:56:02,913 - DEBUG - Edge anomaly scores shape: torch.Size([36040, 1])
2025-06-02 15:56:02,914 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:03,059 - DEBUG - Step 41: Loss=0.6370
2025-06-02 15:56:03,059 - DEBUG - Online update step: 42/50
2025-06-02 15:56:03,064 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:03,156 - DEBUG - Node anomaly scores shape: torch.Size([16218, 1])
2025-06-02 15:56:03,165 - DEBUG - Edge anomaly scores shape: torch.Size([33502, 1])
2025-06-02 15:56:03,168 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:03,318 - DEBUG - Step 42: Loss=0.6479
2025-06-02 15:56:03,318 - DEBUG - Online update step: 43/50
2025-06-02 15:56:03,324 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:03,452 - DEBUG - Node anomaly scores shape: torch.Size([18205, 1])
2025-06-02 15:56:03,459 - DEBUG - Edge anomaly scores shape: torch.Size([37817, 1])
2025-06-02 15:56:03,461 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:03,635 - DEBUG - Step 43: Loss=0.6249
2025-06-02 15:56:03,636 - DEBUG - Online update step: 44/50
2025-06-02 15:56:03,641 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:03,756 - DEBUG - Node anomaly scores shape: torch.Size([17176, 1])
2025-06-02 15:56:03,762 - DEBUG - Edge anomaly scores shape: torch.Size([35801, 1])
2025-06-02 15:56:03,763 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:03,917 - DEBUG - Step 44: Loss=0.6348
2025-06-02 15:56:03,918 - DEBUG - Online update step: 45/50
2025-06-02 15:56:03,923 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:04,031 - DEBUG - Node anomaly scores shape: torch.Size([17767, 1])
2025-06-02 15:56:04,036 - DEBUG - Edge anomaly scores shape: torch.Size([36707, 1])
2025-06-02 15:56:04,037 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:04,194 - DEBUG - Step 45: Loss=0.6449
2025-06-02 15:56:04,194 - DEBUG - Online update step: 46/50
2025-06-02 15:56:04,199 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:04,288 - DEBUG - Node anomaly scores shape: torch.Size([15900, 1])
2025-06-02 15:56:04,294 - DEBUG - Edge anomaly scores shape: torch.Size([32643, 1])
2025-06-02 15:56:04,296 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:04,445 - DEBUG - Step 46: Loss=0.6233
2025-06-02 15:56:04,445 - DEBUG - Online update step: 47/50
2025-06-02 15:56:04,450 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:04,579 - DEBUG - Node anomaly scores shape: torch.Size([16351, 1])
2025-06-02 15:56:04,587 - DEBUG - Edge anomaly scores shape: torch.Size([33797, 1])
2025-06-02 15:56:04,592 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:05,015 - DEBUG - Step 47: Loss=0.6359
2025-06-02 15:56:05,016 - DEBUG - Online update step: 48/50
2025-06-02 15:56:05,024 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:05,265 - DEBUG - Node anomaly scores shape: torch.Size([16708, 1])
2025-06-02 15:56:05,270 - DEBUG - Edge anomaly scores shape: torch.Size([34658, 1])
2025-06-02 15:56:05,271 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:05,616 - DEBUG - Step 48: Loss=0.6457
2025-06-02 15:56:05,616 - DEBUG - Online update step: 49/50
2025-06-02 15:56:05,620 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:05,795 - DEBUG - Node anomaly scores shape: torch.Size([16530, 1])
2025-06-02 15:56:05,803 - DEBUG - Edge anomaly scores shape: torch.Size([34253, 1])
2025-06-02 15:56:05,804 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:06,099 - DEBUG - Step 49: Loss=0.6233
2025-06-02 15:56:06,099 - DEBUG - Online update step: 50/50
2025-06-02 15:56:06,103 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:06,299 - DEBUG - Node anomaly scores shape: torch.Size([17448, 1])
2025-06-02 15:56:06,309 - DEBUG - Edge anomaly scores shape: torch.Size([36155, 1])
2025-06-02 15:56:06,314 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:06,608 - DEBUG - Step 50: Loss=0.6351
2025-06-02 15:56:06,609 - INFO - Online update finished. Average loss: 0.6368, Learning rate: 0.001000
2025-06-02 15:56:06,610 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  2.7927555e-08  3.6202388e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.7584016e-08
  7.2404774e-08 -3.7236742e-08 -1.0343539e-09  8.2748315e-09
  2.3080261e+00  2.9609544e+00  1.4425163e-01  4.4078093e+00
  3.7236742e-08  3.3156183e+00  5.8611712e+00  7.5986986e+00
  1.4425163e-01  7.9924078e+00 -6.2061236e-09 -2.5858848e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.7066840e-08 -3.2064971e-08], current edge mean: [ 0.0000000e+00  4.5778043e+02  0.0000000e+00  0.0000000e+00
 -3.3698739e-09 -9.6282116e-10 -2.8884632e-09 -2.6477580e-09
 -3.3698739e-09 -2.8884632e-09]
2025-06-02 15:56:06,610 - DEBUG - Node drift difference: 0.0042, Edge drift difference: 0.0004
2025-06-02 15:56:06,611 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  2.7927555e-08  3.6202388e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.7584016e-08
  7.2404774e-08 -3.7236742e-08 -1.0343539e-09  8.2748315e-09
  2.3080261e+00  2.9609544e+00  1.4425163e-01  4.4078093e+00
  3.7236742e-08  3.3156183e+00  5.8611712e+00  7.5986986e+00
  1.4425163e-01  7.9924078e+00 -6.2061236e-09 -2.5858848e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.7066840e-08 -3.2064971e-08], edge=[ 0.0000000e+00  4.5778043e+02  0.0000000e+00  0.0000000e+00
 -3.3698739e-09 -9.6282116e-10 -2.8884632e-09 -2.6477580e-09
 -3.3698739e-09 -2.8884632e-09]
2025-06-02 15:56:06,612 - DEBUG - Updated reference std: node=[0.         0.         1.0005428  1.0005428  0.         0.
 0.         1.0005426  1.0005426  1.0005428  1.0005428  1.0005428
 1.0201662  0.2768568  0.3696031  0.5732584  1.0005428  2.978598
 2.8835957  1.5098369  0.3696031  0.23053272 1.0005428  1.0005428
 0.         0.         0.         0.         1.0005428  1.0005428 ], edge=[  1.0002525 458.21814     0.          0.          1.0002525   1.0002525
   1.0002525   1.0002525   1.0002525   1.0002525]
2025-06-02 15:56:06,615 - INFO - Online update complete. Loss: 0.6368
2025-06-02 15:56:06,615 - INFO - Running anomaly detection...
2025-06-02 15:56:06,616 - INFO - Starting anomaly detection.
2025-06-02 15:56:06,626 - DEBUG - Node reconstruction errors: [1.25726447e-01 1.61143661e+00 1.61875606e+00 7.63940113e-03
 2.32525095e-02 2.83271540e-02 6.51578128e-01 1.84026677e-02
 1.84026677e-02 3.29909734e-02 1.84026677e-02 3.44607830e-02
 1.75036538e+00 2.05368131e-01 3.08901654e-03 1.17633697e-02
 2.74958331e-02 1.17636444e-02 4.62203547e-02 1.14554027e-02
 2.04088688e-02 3.08901654e-03 5.47723211e-02 1.54509852e-02
 2.58824253e-03 7.08381180e-03 2.58824253e-03 5.16235791e-02
 1.77707393e-02 2.58824253e-03 1.14420414e-01 1.82734758e-01
 4.80282865e-02 7.20087765e-03 6.94800541e-02 4.04089093e-02
 8.67005438e-02 1.14553878e-02 8.98791626e-02 8.93348679e-02
 1.88544150e-02 2.75967014e-03 1.14553878e-02 3.41836549e-02
 1.38627484e-01 1.43112326e-02 4.38225605e-02 3.62484813e-01
 1.74091384e-02 1.88422859e-01 3.80818807e-02 1.02144908e-02
 6.47375174e-03 2.72981822e-02 2.03853212e-02 4.81560454e-02
 3.87036860e-01 1.14699882e-02 1.64602771e-02 3.27273719e-02
 1.52130336e-01 2.64081694e-02 2.48654629e-03 7.85928499e-03
 6.12329878e-02 2.03853250e-02 1.13751078e-02 2.03853454e-02
 2.48656026e-03 2.64082085e-02 2.78487690e-02 2.67894305e-02
 4.22334578e-03 5.85165173e-02 6.47198781e-02 2.53812708e-02
 6.83777705e-02 3.73558216e-02 1.96378995e-02 2.72068307e-02
 6.46248134e-03 2.35174168e-02 2.66154200e-01 2.98371781e-02
 3.00740208e-02 2.91578248e-02 4.57489155e-02 4.69014607e-02
 3.09616011e-02 1.54234096e-01 2.12948979e-03 4.46792729e-02
 1.01711424e-02 3.92879024e-02 2.02323459e-02 1.15021005e-01
 6.10159244e-03 3.02255880e-02 1.63254736e-03 4.56318073e-02
 1.83080323e-02 6.10159151e-03 1.85475182e-02 2.39236832e-01
 7.51979556e-03 1.46046607e-02 6.99412078e-03 2.03209277e-02
 1.04429983e-02 9.26281735e-02 9.94219333e-02 7.87904114e-03
 2.43591834e-02 6.56680465e-02 1.55961458e-02 1.44058913e-02
 1.53637845e-02 4.28986289e-02 3.46190445e-02 9.98262037e-03
 1.75228948e-03 9.20732319e-03 4.85996492e-02 1.26205469e-02
 3.69167700e-02 9.98251047e-03 1.88485067e-02 1.85416136e-02
 4.05451097e-02 7.56867416e-03 1.08081419e-02 3.98751767e-03
 5.15895337e-02 2.07942322e-01 1.36613734e-02 1.45655395e-02
 2.39783488e-02 2.11597234e-03 9.06934291e-02 2.72402205e-02
 2.50428077e-02 4.07318324e-02 1.81085244e-03 1.48163289e-02
 2.50428077e-02 4.90583926e-02 1.53636001e-02 6.39484301e-02
 2.32932102e-02 3.80083174e-02 2.73530960e-01 8.62731505e-03
 2.84892078e-02 3.98750929e-03 1.86974686e-02 3.71403247e-02
 3.44342343e-03 2.45406684e-02 1.83081925e-02 1.64862778e-02
 2.50428077e-02 9.71441809e-03 3.44342343e-03 1.08081419e-02
 1.54592069e-02 1.67995337e-02 1.87332351e-02 2.02765334e-02
 9.94181819e-03 3.80089283e-02 3.02274786e-02 1.04715237e-02
 2.61836033e-03 6.95243105e-02 3.46187018e-02 8.67438412e+00
 2.06982736e-02 3.74845602e-02 1.63527913e-02 1.63526367e-02
 1.48338331e-02 1.57726575e-02 2.37930156e-02 5.46395779e-02
 4.69113365e-02 2.28222292e-02 1.74126285e-03 2.14094538e-02
 1.47482017e-02 3.30805732e-03 2.21332628e-02 3.65422294e-02
 3.59620340e-02 4.20912681e-03 9.06915814e-02 8.43754783e-03
 2.89879143e-01 2.09042206e-02 4.79808487e-02 1.93317439e-02
 8.04898515e-03 3.44343251e-03 2.24714838e-02 4.68737669e-02
 3.39987613e-02 6.71831798e-03 3.10120415e-02 1.16235159e-01
 1.53378188e-03 2.53056847e-02 1.40631460e-02 1.62422154e-02
 6.48203725e-03 3.44311856e-02 2.48953532e-02 2.24548206e-03
 3.69762331e-02 1.53637053e-02 1.10368542e-01 4.20914125e-03
 4.68601696e-02 1.74125587e-03 2.54650135e-03 6.48200652e-03
 3.44343251e-03 5.13794459e-02 4.20386866e-02 5.02523780e-03
 2.86928900e-02 1.26721617e-02 5.31417597e-03 3.82150747e-02
 4.38632444e-02 1.53635051e-02 1.53637975e-02 1.18069025e-02
 2.42817104e-02 2.54650135e-03 3.44342343e-03 3.82137820e-02
 3.45865376e-02 2.53625512e-02 5.09537198e-03 3.67219895e-02
 4.84792190e-03 4.11445871e-02 1.72846355e-02 3.94006297e-02
 5.09537198e-03 1.41153568e-02 2.61836033e-03 2.29976675e-03
 1.10368125e-01 1.91123560e-02 4.18589376e-02 3.68028656e-02
 3.30806617e-03 1.63487112e-03 1.77785326e-02 1.63526796e-02
 2.31486727e-02 2.22046487e-02 7.19386945e-03 3.68723385e-02
 3.42190154e-02 1.78786777e-02 2.70593725e-02 8.80008414e-02
 2.70593185e-02 1.66712012e-02 7.11713880e-02 5.01328222e-02
 2.66696308e-02 5.43314666e-02 1.65746473e-02 9.60644186e-02
 8.72511975e-03 6.38357326e-02 1.48338638e-02 2.24438440e-02
 1.18098944e-01 9.36403871e-03 1.99447554e-02 1.89566854e-02
 5.55698760e-02 8.20746366e-03 1.33760020e-01 8.52497201e-03
 1.57726817e-02 4.59878072e-02 3.45650390e-02 8.82057287e-03
 3.86503339e-02 4.84792190e-03 1.58843771e-01 2.84058135e-03
 2.11803950e-02 1.63523387e-02 8.43754783e-03 8.85173399e-03
 2.14171428e-02 1.92857510e-03 1.51169095e-02 3.33782472e-02
 1.92857662e-03 1.92857510e-03 1.92857662e-03 1.80329587e-02
 1.62109789e-02 1.92857662e-03 1.92857662e-03 2.25074682e-02
 1.92857510e-03 3.20979115e-03 9.80265345e-03 2.65810173e-02
 1.50746390e-01 1.18983351e-02 6.69777114e-03 9.66651831e-03
 4.54516970e-02 2.63379402e-02 4.05843481e-02 1.51168816e-02
 2.07009688e-02 5.20546846e-02 1.59107558e-02 3.76791283e-02
 2.71537919e-02 2.71538105e-02 1.86088547e-01 8.49167909e-03
 1.92857662e-03 1.65746454e-02 1.92857510e-03 1.80331189e-02
 1.58487055e-02 2.22016452e-03 1.54389569e-03 1.54389569e-03
 1.92857662e-03 5.26942313e-03 1.54389569e-03 5.18334135e-02
 3.01665775e-02 3.69757675e-02 1.51168276e-02 8.75032227e-03
 2.80880947e-02 2.43570786e-02 1.92857510e-03 1.46637056e-02
 4.49058749e-02 4.14127670e-02 4.78465529e-03 3.30805732e-03
 1.60551770e-03 1.92857662e-03 2.00137729e-03 1.66610982e-02
 3.59799303e-02 4.02932893e-03 8.85061398e-02 3.60430889e-02
 1.51169058e-02 4.87983637e-02 1.91439840e-03 4.04891223e-02
 1.47037022e-02 1.11643821e-02 2.57057939e-02 3.12645175e-02
 4.39805202e-02 1.90383457e-02 3.64759639e-02 4.14128155e-02
 2.49374448e-03 5.03596710e-03 3.89641114e-02 1.92857662e-03
 1.51168304e-02 7.98242912e-03 3.48429172e-03 1.96214858e-02
 7.02464720e-03 2.73896139e-02 2.48469785e-02 2.10132767e-02
 3.34752053e-02 1.92857662e-03 9.74169150e-02 3.04967184e-02
 1.43426219e-02 5.69170080e-02 3.14298235e-02 3.14298198e-02
 3.14298198e-02 1.40471952e-02 1.89457752e-03 1.35716097e-02
 3.11666471e-03 5.52175269e-02 3.14298235e-02 1.89457752e-03
 1.45495357e-02 1.43426796e-02 4.45725992e-02 1.06298318e-02
 1.43426415e-02 2.03403607e-02 3.14298235e-02 1.43425697e-02
 1.89457752e-03 3.14298235e-02 3.14298235e-02 4.92046494e-03
 5.20573277e-03 3.14298235e-02 2.51223519e-03 7.62968557e-03
 1.65507067e-02 4.01238026e-03 1.16514163e-02 3.38371936e-03
 4.70006429e-02 1.85087342e-02 6.01141062e-03 2.39090454e-02
 1.39177563e-02 7.57309794e-03 2.62356959e-02 1.54005550e-02
 2.87040062e-02 3.27172019e-02 3.14298198e-02 3.14298235e-02
 3.11666471e-03 2.66516134e-02 4.74986024e-02 1.45317800e-02
 5.91882458e-03 4.68064845e-03 8.43578950e-02 1.62076054e-03
 9.98314656e-03 2.55025309e-02 4.54444550e-02 3.35457176e-03
 9.83471144e-03 3.53631238e-03 4.10925262e-02 2.39053089e-03
 4.01804317e-03 1.39192538e-02 2.39052274e-03 1.55230630e-02
 3.38371936e-03 1.00118564e-02 1.10265482e-02 2.72902530e-02
 1.38147809e-02 4.07822849e-03 3.44436406e-03 1.69153120e-02
 3.44436406e-03 4.07822849e-03 2.07986659e-03 1.79549940e-02
 8.78878590e-03 9.55193117e-03 2.07986659e-03 1.38147455e-02
 2.42419299e-02 5.42256609e-02 3.49868983e-02 1.16514964e-02
 1.79547183e-02 1.38147492e-02 1.79851614e-03 4.61211707e-03
 7.74193462e-03 1.01344965e-01 5.91945136e-03 3.35457176e-03
 4.61452417e-02 2.47918535e-03 2.39053089e-03 1.16916439e-02
 8.67869053e-03 5.42239919e-02 1.52909430e-02 1.79852499e-03
 2.04060860e-02 1.58087595e-03 3.33783850e-02 3.59808211e-03
 1.33064948e-02 5.95201962e-02 1.91087578e-03 4.61210730e-03
 8.41933563e-02 1.58087583e-03 6.64098188e-02 9.51358955e-03
 2.02228175e-03 1.26007060e-02 1.55475980e-03 1.42789781e-01
 5.11330646e-03 2.39052274e-03 9.25480481e-03 4.29617427e-03
 4.29619197e-03 1.97684811e-03 3.31477001e-02 4.51435614e-03
 1.55475980e-03 1.36196017e-02 2.02727746e-02 2.88501177e-02
 1.36196204e-02 4.68064845e-03 1.55475980e-03 3.25429477e-02
 2.02228175e-03 1.33065181e-02 1.07235024e-02 2.67202612e-02
 1.36195701e-02 2.91299094e-02 4.51435614e-03 3.62919495e-02
 1.91087578e-03 4.61211707e-03 1.33064836e-02 1.39280614e-02
 2.61120200e-02 2.87352446e-02 1.91087509e-03 3.15366872e-02
 1.91087509e-03 3.15366872e-02 1.45141426e-02 1.36196204e-02
 4.04236419e-03 3.85234766e-02 1.00981984e-02 1.99751346e-03
 2.18060955e-01 1.99751346e-03 1.99751346e-03 1.99751509e-03
 1.99751509e-03 1.99751346e-03 1.99751346e-03 1.99751812e-03
 1.55834397e-02 4.03322512e-03 8.91058706e-03 1.99751346e-03
 1.99751509e-03 1.99751509e-03 1.99751346e-03 1.99751346e-03
 1.99751346e-03 1.99751346e-03 1.99751509e-03 1.99751509e-03
 1.35142803e-02 1.99751346e-03 1.99751346e-03 6.49873316e-02
 1.99751509e-03 6.73061935e-03 1.55347688e-02 1.91087509e-03
 1.66665874e-02 3.46118771e-02 4.63647060e-02 4.63647060e-02
 2.96152476e-02 1.66665874e-02 1.91087509e-03 1.55475980e-03
 1.55475980e-03 1.91087509e-03 1.55475386e-03 1.25535810e-02
 1.11878272e-02 1.99751346e-03 4.68064845e-03 1.91087509e-03
 4.29619197e-03 1.91087509e-03 1.91087509e-03 1.27653768e-02
 1.91087509e-03 1.55475980e-03 1.91087509e-03 1.91087509e-03
 1.36195617e-02 1.55475980e-03 1.91087509e-03 1.55475386e-03
 1.91087509e-03 1.91087578e-03 1.91087509e-03 2.48273909e-02
 3.69131938e-02 1.12642674e-02 1.99751346e-03 1.83528960e-02
 1.82027929e-02 1.91087509e-03 1.55475980e-03 2.63348743e-02
 1.99751346e-03 9.31244623e-03 2.99871080e-02 1.47873117e-03
 1.91087578e-03 1.91087509e-03 1.34670595e-02 2.66832784e-02
 1.18252579e-02 1.91087509e-03 1.55833503e-02 2.15179846e-03
 1.55475980e-03 2.16416549e-02 1.99751346e-03 1.48191331e-02
 3.82890105e-02 1.99751346e-03 1.99751509e-03 1.55834053e-02
 2.15179846e-03 1.91087578e-03 1.13409966e-01 3.14426050e-02
 3.09022442e-02 2.66832784e-02 4.47483873e-03 2.86502410e-02
 2.86502279e-02 1.52020138e-02 2.53029051e-03 1.99751509e-03
 4.07294882e-03 3.32588963e-02 2.66832374e-02 1.21286511e-02
 3.38965352e-03 4.65408992e-03 2.09386484e-03 2.09386484e-03
 2.09386484e-03 2.09387438e-03 2.09386484e-03 1.35487756e-02
 2.91736778e-02 2.09387438e-03 2.09387438e-03 1.99751346e-03
 2.16216967e-03 1.99751346e-03 2.86502279e-02 2.55786218e-02
 4.33640927e-02 5.69311855e-03 2.86502410e-02 5.07930964e-02
 1.35141993e-02 8.56474694e-03 1.35142123e-02 1.99751346e-03
 2.86502279e-02 1.98816136e-03 1.64417410e-03 1.64416956e-03
 2.09387438e-03 1.98816136e-03 2.42176000e-02 1.02381902e-02
 5.10804029e-03 1.99751509e-03 2.09386484e-03 6.29305514e-03
 1.64416956e-03 1.76158175e-03 2.33156863e-03 6.15670346e-03
 1.35488091e-02 5.56936599e-02 1.47046812e-03 5.27157411e-02
 1.14302756e-02 2.33156444e-03 2.92231282e-03 1.97717804e-03
 2.34528352e-03 1.94429536e-03 2.74621602e-02 5.69158047e-03
 2.78610457e-02 2.33156863e-03 2.33156863e-03 2.33156863e-03
 1.77207240e-03 6.29305514e-03 2.33156863e-03 2.34528352e-03
 2.33156863e-03 2.33156444e-03 2.33156444e-03 1.17592392e-02
 1.98958651e-03 2.36777458e-02 3.16133164e-02 3.00927479e-02
 3.18742706e-03 4.81743319e-03 2.30923891e-02 2.78693978e-02
 2.25599413e-03 1.94204482e-03 1.91565801e-03 1.85134057e-02
 1.85133610e-02 2.34528352e-03 3.78714986e-02 7.93667287e-02
 2.30244244e-03 2.31123925e-03 1.08097838e-02 3.21213715e-02
 1.81989884e-03 1.81989127e-03 1.81989127e-03 2.33358378e-03
 1.57187588e-03 1.80237684e-02 3.04783303e-02 9.54607949e-02
 1.00991530e-02 1.53384835e-03 4.19577071e-03 2.31123925e-03
 3.23364069e-03 1.04579274e-02 1.71525334e-03 1.15980348e-02
 2.30245339e-03 7.93668032e-02 2.31123925e-03 1.04578976e-02
 1.53384835e-03 1.95174441e-02 1.81989127e-03 2.33358378e-03
 1.71525334e-03 4.72215423e-03 1.89951025e-02 2.33358378e-03
 2.33358378e-03 2.33358378e-03 1.94355510e-02 4.00052905e-01
 5.78409016e-01 1.81989884e-03 2.72557009e-02 2.33358378e-03
 2.80088056e-02 5.40783210e-03 4.25185114e-02 5.40783210e-03
 2.33358378e-03 2.48244451e-03 4.55351174e-03 2.16469448e-03
 7.74812847e-02 5.40783210e-03 4.88167033e-02 1.22483717e-02
 2.89590526e-02 5.40784420e-03 2.53744740e-02 1.97521485e-02
 9.88042448e-03 2.80039702e-02 1.58414710e-02 1.99675397e-03
 1.99677330e-03 6.43237904e-02 1.33462489e-01 2.32410021e-02
 5.40784420e-03 9.88040585e-03 5.40784420e-03 1.31112884e-03
 1.89978362e-03 1.89978362e-03 1.43624865e-03 4.51398641e-02
 2.10273662e-03 1.89978583e-03 1.31114013e-03 2.58477852e-02
 1.89978583e-03 1.89978362e-03 2.71396642e-03 1.48182083e-02
 3.77591439e-02 3.62027101e-02 1.89978362e-03 1.93439331e-02
 2.58477721e-02 1.89978362e-03 1.88718119e-03 3.56621225e-03
 1.54801598e-03 1.54801598e-03 2.49435473e-02 3.56621225e-03
 1.89978583e-03 3.56623367e-03 3.76220583e-03 4.22015116e-02
 2.86333673e-02 1.89978362e-03 1.05961166e-01 3.71283875e-03
 3.71285295e-03 1.48182083e-02 3.02977697e-03 4.40278463e-03
 1.88719260e-03 1.14027262e-02 1.44801172e-03 2.21973266e-02
 5.77451382e-03 2.21973266e-02 8.70865956e-02 1.38939393e-03
 5.77454036e-03 3.38599621e-03 3.38599621e-03 9.10834000e-02
 3.38599621e-03 1.22790243e-02 3.02981329e-03 2.28522941e-02
 6.07733708e-03 1.38939393e-03 6.07733708e-03 2.35057063e-02
 4.17649671e-02 1.56508908e-02 3.38599621e-03 1.20951971e-02
 1.69188473e-02 3.38599621e-03 3.44663858e-02 3.53638120e-02
 1.39396805e-02 1.38939393e-03 3.38599621e-03 1.06916934e-01
 3.38599621e-03 3.38599621e-03 3.38599621e-03 1.94761052e-03
 3.31559293e-02 1.94761797e-03 7.53498916e-03 1.94761052e-03
 3.70090492e-02 3.56053673e-02 4.42392044e-02 3.38599621e-03
 3.38599621e-03 3.38599621e-03 3.38599621e-03 3.20234299e-01
 7.53503060e-03 1.94761052e-03 3.38599621e-03 3.38599621e-03
 3.38599621e-03 5.33420080e-03 3.38599621e-03 3.38599621e-03
 3.01080989e-03 7.53498916e-03 1.95696135e-03 6.54690489e-02
 3.01080989e-03 3.38599621e-03 3.38599621e-03 3.93373286e-03
 3.35598774e-02 3.95418070e-02 3.95418257e-02 3.78022832e-03
 2.18228195e-02 1.96374729e-02 5.99990925e-03 2.49006018e-01
 3.95418257e-02 2.12066574e-03 3.95418070e-02 1.36276046e-02
 5.99990925e-03 3.95418257e-02 5.12273889e-03 1.95697020e-03
 7.55868014e-03 3.68100940e-03 3.19843949e-03 5.12273330e-03
 2.02620719e-02 3.21076671e-03]
2025-06-02 15:56:06,627 - DEBUG - Edge reconstruction errors: [ 5.264453   5.2621913 44.258915  ... 13.358893   2.1589563 13.358892 ]
2025-06-02 15:56:06,629 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155606_update_41.json
2025-06-02 15:56:06,629 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:56:06,638 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155606_update_41.pth and as latest_checkpoint.pth
2025-06-02 15:56:06,638 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870325.dot): 0.5898
2025-06-02 15:56:06,638 - WARNING - Detected 4 anomalous nodes (reconstruction-based):
2025-06-02 15:56:06,638 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.6114, MLP Score: 0.5017
2025-06-02 15:56:06,639 - WARNING -   Node ID: 192.168.27.13, Recon Error: 1.6188, MLP Score: 0.4839
2025-06-02 15:56:06,639 - WARNING -   Node ID: 192.168.27.10, Recon Error: 1.7504, MLP Score: 0.4979
2025-06-02 15:56:06,639 - WARNING -   Node ID: 183.81.34.26, Recon Error: 8.6744, MLP Score: 0.4839
2025-06-02 15:56:06,639 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:56:06,639 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2589, MLP Score: 0.9793
2025-06-02 15:56:06,639 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9615, MLP Score: 0.9974
2025-06-02 15:56:06,639 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0612, MLP Score: 0.9974
2025-06-02 15:56:06,639 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7598, MLP Score: 0.9976
2025-06-02 15:56:06,639 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7592, MLP Score: 0.9979
2025-06-02 15:56:06,645 - DEBUG - Embedding standard deviations before t-SNE: [0.9864293  0.02038524 0.61324805 1.1289996  2.2985396  0.
 0.86206    1.2553908  0.82463914 1.730663   1.0087212  0.95424926
 1.6005177  0.         0.8461045  1.156679   0.5715162  0.40164316
 0.         1.0710707  2.5543678  1.1011918  0.         1.6902748
 0.7016317  1.374463   0.         1.1516749  1.4384785  0.
 0.657378   1.44985   ]
2025-06-02 15:56:07,679 - INFO - Embeddings visualization saved to vis/embeddings_41_updates_20250602_155606.png
2025-06-02 15:56:07,679 - INFO - Performing visualization of node and edge features.
2025-06-02 15:56:07,680 - INFO - Starting visualization of node features.
2025-06-02 15:56:07,681 - INFO - Graph has 922 nodes and 30 features.
2025-06-02 15:56:07,681 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:56:07,681 - INFO - Calculating feature statistics:
2025-06-02 15:56:07,681 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:56:07,681 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:56:07,681 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 21, 'mean': np.float32(3.3099326e-08), 'std': np.float32(1.0), 'min': np.float32(-1.9147569), 'max': np.float32(2.4391384)}
2025-06-02 15:56:07,681 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 21, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.352639), 'max': np.float32(2.006021)}
2025-06-02 15:56:07,681 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:56:07,681 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:56:07,682 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:56:07,682 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(-1.6549663e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.46169025), 'max': np.float32(2.165954)}
2025-06-02 15:56:07,682 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(6.619865e-08), 'std': np.float32(1.0), 'min': np.float32(-1.1199458), 'max': np.float32(0.8929003)}
2025-06-02 15:56:07,682 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 4, 'mean': np.float32(-2.896191e-08), 'std': np.float32(1.0), 'min': np.float32(-9.039497), 'max': np.float32(0.11300867)}
2025-06-02 15:56:07,682 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 21, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.4760993), 'max': np.float32(1.4725882)}
2025-06-02 15:56:07,682 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 21, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.4442264), 'max': np.float32(2.5885324)}
2025-06-02 15:56:07,682 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 9, 'mean': np.float32(2.308026), 'std': np.float32(1.0196128), 'min': np.float32(0.0), 'max': np.float32(11.0)}
2025-06-02 15:56:07,682 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.9609544), 'std': np.float32(0.27670658), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:56:07,682 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.14425163), 'std': np.float32(0.3694026), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:56:07,682 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.4078093), 'std': np.float32(0.5729474), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:56:07,682 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 4, 'mean': np.float32(2.896191e-08), 'std': np.float32(1.0), 'min': np.float32(-0.11300867), 'max': np.float32(9.039497)}
2025-06-02 15:56:07,682 - INFO - - service_1: {'name': 'service_1', 'unique': 6, 'mean': np.float32(3.3156183), 'std': np.float32(2.9769824), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 15:56:07,683 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.8611712), 'std': np.float32(2.8820314), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:56:07,683 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.5986986), 'std': np.float32(1.5090178), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:56:07,683 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.14425163), 'std': np.float32(0.3694026), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:56:07,683 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 2, 'mean': np.float32(7.992408), 'std': np.float32(0.23040767), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:56:07,683 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(-4.1374157e-09), 'std': np.float32(1.0000001), 'min': np.float32(-0.12914392), 'max': np.float32(16.107769)}
2025-06-02 15:56:07,683 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(-6.2061236e-09), 'std': np.float32(1.0), 'min': np.float32(-0.14110813), 'max': np.float32(7.086764)}
2025-06-02 15:56:07,683 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:56:07,683 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:56:07,683 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:56:07,683 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:56:07,683 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(8.2748315e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.974236), 'max': np.float32(8.896596)}
2025-06-02 15:56:07,683 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(-1.6549663e-08), 'std': np.float32(1.0), 'min': np.float32(-1.0681784), 'max': np.float32(4.4855456)}
2025-06-02 15:56:07,696 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x72fd95bde480>
2025-06-02 15:56:07,831 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:56:07,882 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:56:07,911 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:56:10,043 - INFO - Node feature visualization saved to vis/node_features_20250602_155608.png
2025-06-02 15:56:10,043 - INFO - Finished visualization of node features.
2025-06-02 15:56:10,043 - INFO - Performing additional feature analysis:
2025-06-02 15:56:10,044 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:56:10,045 - INFO - Starting visualization of edge features.
2025-06-02 15:56:10,045 - INFO - Graph has 1981 edges and 10 edge features.
2025-06-02 15:56:10,045 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:56:10,045 - INFO - Calculating edge feature statistics:
2025-06-02 15:56:10,046 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:56:10,046 - INFO - - count: {'name': 'count', 'unique': 34, 'mean': np.float32(0.0), 'std': np.float32(1.0000001), 'min': np.float32(-0.03646034), 'max': np.float32(34.218254)}
2025-06-02 15:56:10,046 - INFO - - dst_port: {'name': 'dst_port', 'unique': 19, 'mean': np.float32(457.78043), 'std': np.float32(458.10248), 'min': np.float32(0.0), 'max': np.float32(8898.0)}
2025-06-02 15:56:10,046 - INFO - - protocol: {'name': 'protocol', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:56:10,046 - INFO - - service: {'name': 'service', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:56:10,046 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 1323, 'mean': np.float32(-1.9256423e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.058690593), 'max': np.float32(31.43086)}
2025-06-02 15:56:10,046 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 1409, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.05430731), 'max': np.float32(33.032013)}
2025-06-02 15:56:10,046 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 468, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.044447273), 'max': np.float32(34.08441)}
2025-06-02 15:56:10,046 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 1380, 'mean': np.float32(-1.4442316e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.0819718), 'max': np.float32(28.840654)}
2025-06-02 15:56:10,046 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 1404, 'mean': np.float32(-2.8884632e-09), 'std': np.float32(1.0), 'min': np.float32(-0.082216784), 'max': np.float32(27.85083)}
2025-06-02 15:56:10,046 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 509, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.052967753), 'max': np.float32(33.503876)}
2025-06-02 15:56:10,059 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x72fd959240e0>
2025-06-02 15:56:10,197 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:56:10,219 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x72fda4b7ccb0>
2025-06-02 15:56:10,398 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:56:11,054 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:56:11,226 - DEBUG - Plotted boxplots of the first 8 non-constant edge features.
2025-06-02 15:56:11,251 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:56:11,261 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:56:13,609 - INFO - Edge feature visualization saved to vis/edge_features_20250602_155611.png
2025-06-02 15:56:13,609 - INFO - Finished visualization of edge features.
2025-06-02 15:56:13,609 - INFO - Performing additional edge feature analysis:
2025-06-02 15:56:13,609 - INFO - - 2 out of 10 edge features are constant.
2025-06-02 15:56:13,610 - INFO - - Highest correlation (1.00) between features: 'total_resp_bytes' and 'total_resp_ip_bytes'.
2025-06-02 15:56:13,612 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:56:13,612 - INFO - Graph has 1981 edges and 10 edge features.
2025-06-02 15:56:13,612 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:56:13,990 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_155613_summary.png
2025-06-02 15:56:14,248 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_155613_pca_3d.png
2025-06-02 15:56:14,420 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_155613_pca_variance.png
2025-06-02 15:56:14,420 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:56:14,420 - INFO - 
--- Processing file: nw_graph_encoded_1748870355.dot (Timestamp: 2025-06-02 15:19:15) ---
2025-06-02 15:56:14,420 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870355.dot
2025-06-02 15:56:14,420 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870355.dot'.
2025-06-02 15:56:14,420 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870355.dot
2025-06-02 15:56:14,436 - INFO - Parsed 934 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870355.dot'.
2025-06-02 15:56:14,454 - INFO - Parsed 2007 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870355.dot'.
2025-06-02 15:56:14,454 - INFO - Processing node updates/additions.
2025-06-02 15:56:14,459 - INFO - Processing edge updates/additions.
2025-06-02 15:56:14,471 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:56:14,472 - INFO - Finished updating NetworkX graph.
2025-06-02 15:56:14,473 - DEBUG - Updated graph - Nodes: 934, Edges: 2007
2025-06-02 15:56:14,473 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:56:14,475 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:56:14,484 - DEBUG - Initial node features tensor shape: torch.Size([934, 30])
2025-06-02 15:56:14,487 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:56:14,496 - DEBUG - Node features tensor shape after scaling: torch.Size([934, 30])
2025-06-02 15:56:14,498 - DEBUG - Edge index tensor shape: torch.Size([2, 2007])
2025-06-02 15:56:14,500 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:56:14,507 - DEBUG - Initial edge attributes tensor shape: torch.Size([2007, 10])
2025-06-02 15:56:14,512 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:56:14,514 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2007, 10])
2025-06-02 15:56:14,514 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:56:14,514 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:56:14,515 - INFO - Updated main graph to 934 nodes and 2007 edges.
2025-06-02 15:56:14,515 - INFO - Performing online update...
2025-06-02 15:56:14,516 - INFO - Starting online update for 50 steps.
2025-06-02 15:56:14,516 - DEBUG - Updated RunningStats: new_mean=0.944103914206677, new_var=59400000000161.836, new_n=5970
2025-06-02 15:56:14,516 - DEBUG - Updated RunningStats: new_mean=0.9430813235311967, new_var=59700000000017.98, new_n=6000
2025-06-02 15:56:14,517 - DEBUG - Updated RunningStats: new_mean=44.74698841519363, new_var=19800000188287.246, new_n=1990
2025-06-02 15:56:14,517 - DEBUG - Updated RunningStats: new_mean=44.754426495149445, new_var=19900000185991.066, new_n=2000
2025-06-02 15:56:14,517 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:56:14,517 - DEBUG - Online update step: 1/50
2025-06-02 15:56:14,519 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:14,599 - DEBUG - Node anomaly scores shape: torch.Size([16536, 1])
2025-06-02 15:56:14,604 - DEBUG - Edge anomaly scores shape: torch.Size([34227, 1])
2025-06-02 15:56:14,605 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:14,783 - DEBUG - Step 1: Loss=0.6442
2025-06-02 15:56:14,783 - DEBUG - Online update step: 2/50
2025-06-02 15:56:14,787 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:14,869 - DEBUG - Node anomaly scores shape: torch.Size([17128, 1])
2025-06-02 15:56:14,873 - DEBUG - Edge anomaly scores shape: torch.Size([35537, 1])
2025-06-02 15:56:14,877 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:15,033 - DEBUG - Step 2: Loss=0.6218
2025-06-02 15:56:15,033 - DEBUG - Online update step: 3/50
2025-06-02 15:56:15,037 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:15,126 - DEBUG - Node anomaly scores shape: torch.Size([16771, 1])
2025-06-02 15:56:15,129 - DEBUG - Edge anomaly scores shape: torch.Size([34619, 1])
2025-06-02 15:56:15,130 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:15,273 - DEBUG - Step 3: Loss=0.6358
2025-06-02 15:56:15,273 - DEBUG - Online update step: 4/50
2025-06-02 15:56:15,277 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:15,374 - DEBUG - Node anomaly scores shape: torch.Size([17248, 1])
2025-06-02 15:56:15,378 - DEBUG - Edge anomaly scores shape: torch.Size([35711, 1])
2025-06-02 15:56:15,379 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:15,536 - DEBUG - Step 4: Loss=0.6468
2025-06-02 15:56:15,536 - DEBUG - Online update step: 5/50
2025-06-02 15:56:15,539 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:15,672 - DEBUG - Node anomaly scores shape: torch.Size([17092, 1])
2025-06-02 15:56:15,685 - DEBUG - Edge anomaly scores shape: torch.Size([35339, 1])
2025-06-02 15:56:15,686 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:15,894 - DEBUG - Step 5: Loss=0.6239
2025-06-02 15:56:15,895 - DEBUG - Online update step: 6/50
2025-06-02 15:56:15,898 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:15,984 - DEBUG - Node anomaly scores shape: torch.Size([16029, 1])
2025-06-02 15:56:15,987 - DEBUG - Edge anomaly scores shape: torch.Size([33096, 1])
2025-06-02 15:56:15,988 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:16,126 - DEBUG - Step 6: Loss=0.6325
2025-06-02 15:56:16,126 - DEBUG - Online update step: 7/50
2025-06-02 15:56:16,129 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:16,224 - DEBUG - Node anomaly scores shape: torch.Size([15918, 1])
2025-06-02 15:56:16,227 - DEBUG - Edge anomaly scores shape: torch.Size([32781, 1])
2025-06-02 15:56:16,228 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:16,401 - DEBUG - Step 7: Loss=0.6433
2025-06-02 15:56:16,402 - DEBUG - Online update step: 8/50
2025-06-02 15:56:16,405 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:16,487 - DEBUG - Node anomaly scores shape: torch.Size([16001, 1])
2025-06-02 15:56:16,492 - DEBUG - Edge anomaly scores shape: torch.Size([32999, 1])
2025-06-02 15:56:16,493 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:16,634 - DEBUG - Step 8: Loss=0.6212
2025-06-02 15:56:16,634 - DEBUG - Online update step: 9/50
2025-06-02 15:56:16,639 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:16,744 - DEBUG - Node anomaly scores shape: torch.Size([17864, 1])
2025-06-02 15:56:16,749 - DEBUG - Edge anomaly scores shape: torch.Size([37085, 1])
2025-06-02 15:56:16,750 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:16,971 - DEBUG - Step 9: Loss=0.6340
2025-06-02 15:56:16,971 - DEBUG - Online update step: 10/50
2025-06-02 15:56:16,974 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:17,053 - DEBUG - Node anomaly scores shape: torch.Size([18878, 1])
2025-06-02 15:56:17,057 - DEBUG - Edge anomaly scores shape: torch.Size([39309, 1])
2025-06-02 15:56:17,058 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:17,211 - DEBUG - Step 10: Loss=0.6449
2025-06-02 15:56:17,211 - DEBUG - Online update step: 11/50
2025-06-02 15:56:17,214 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:17,314 - DEBUG - Node anomaly scores shape: torch.Size([17159, 1])
2025-06-02 15:56:17,318 - DEBUG - Edge anomaly scores shape: torch.Size([35630, 1])
2025-06-02 15:56:17,319 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:17,469 - DEBUG - Step 11: Loss=0.6217
2025-06-02 15:56:17,469 - DEBUG - Online update step: 12/50
2025-06-02 15:56:17,472 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:17,551 - DEBUG - Node anomaly scores shape: torch.Size([16116, 1])
2025-06-02 15:56:17,556 - DEBUG - Edge anomaly scores shape: torch.Size([33344, 1])
2025-06-02 15:56:17,557 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:17,699 - DEBUG - Step 12: Loss=0.6338
2025-06-02 15:56:17,699 - DEBUG - Online update step: 13/50
2025-06-02 15:56:17,704 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:17,804 - DEBUG - Node anomaly scores shape: torch.Size([18005, 1])
2025-06-02 15:56:17,809 - DEBUG - Edge anomaly scores shape: torch.Size([37480, 1])
2025-06-02 15:56:17,811 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:18,010 - DEBUG - Step 13: Loss=0.6438
2025-06-02 15:56:18,010 - DEBUG - Online update step: 14/50
2025-06-02 15:56:18,013 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:18,096 - DEBUG - Node anomaly scores shape: torch.Size([17229, 1])
2025-06-02 15:56:18,100 - DEBUG - Edge anomaly scores shape: torch.Size([35665, 1])
2025-06-02 15:56:18,101 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:18,278 - DEBUG - Step 14: Loss=0.6213
2025-06-02 15:56:18,278 - DEBUG - Online update step: 15/50
2025-06-02 15:56:18,281 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:18,415 - DEBUG - Node anomaly scores shape: torch.Size([16865, 1])
2025-06-02 15:56:18,423 - DEBUG - Edge anomaly scores shape: torch.Size([34788, 1])
2025-06-02 15:56:18,425 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:18,612 - DEBUG - Step 15: Loss=0.6340
2025-06-02 15:56:18,613 - DEBUG - Online update step: 16/50
2025-06-02 15:56:18,616 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:18,699 - DEBUG - Node anomaly scores shape: torch.Size([19152, 1])
2025-06-02 15:56:18,703 - DEBUG - Edge anomaly scores shape: torch.Size([39852, 1])
2025-06-02 15:56:18,704 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:18,873 - DEBUG - Step 16: Loss=0.6441
2025-06-02 15:56:18,874 - DEBUG - Online update step: 17/50
2025-06-02 15:56:18,880 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:18,971 - DEBUG - Node anomaly scores shape: torch.Size([16001, 1])
2025-06-02 15:56:18,977 - DEBUG - Edge anomaly scores shape: torch.Size([32931, 1])
2025-06-02 15:56:18,978 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:19,151 - DEBUG - Step 17: Loss=0.6231
2025-06-02 15:56:19,151 - DEBUG - Online update step: 18/50
2025-06-02 15:56:19,156 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:19,254 - DEBUG - Node anomaly scores shape: torch.Size([17743, 1])
2025-06-02 15:56:19,264 - DEBUG - Edge anomaly scores shape: torch.Size([36684, 1])
2025-06-02 15:56:19,269 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:19,458 - DEBUG - Step 18: Loss=0.6325
2025-06-02 15:56:19,458 - DEBUG - Online update step: 19/50
2025-06-02 15:56:19,464 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:19,559 - DEBUG - Node anomaly scores shape: torch.Size([16916, 1])
2025-06-02 15:56:19,563 - DEBUG - Edge anomaly scores shape: torch.Size([35051, 1])
2025-06-02 15:56:19,564 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:19,705 - DEBUG - Step 19: Loss=0.6420
2025-06-02 15:56:19,706 - DEBUG - Online update step: 20/50
2025-06-02 15:56:19,711 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:19,797 - DEBUG - Node anomaly scores shape: torch.Size([18228, 1])
2025-06-02 15:56:19,802 - DEBUG - Edge anomaly scores shape: torch.Size([37987, 1])
2025-06-02 15:56:19,803 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:19,987 - DEBUG - Step 20: Loss=0.6192
2025-06-02 15:56:19,988 - DEBUG - Online update step: 21/50
2025-06-02 15:56:19,993 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:20,091 - DEBUG - Node anomaly scores shape: torch.Size([16279, 1])
2025-06-02 15:56:20,095 - DEBUG - Edge anomaly scores shape: torch.Size([33787, 1])
2025-06-02 15:56:20,097 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:20,275 - DEBUG - Step 21: Loss=0.6340
2025-06-02 15:56:20,275 - DEBUG - Online update step: 22/50
2025-06-02 15:56:20,280 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:20,362 - DEBUG - Node anomaly scores shape: torch.Size([16458, 1])
2025-06-02 15:56:20,367 - DEBUG - Edge anomaly scores shape: torch.Size([33963, 1])
2025-06-02 15:56:20,368 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:20,525 - DEBUG - Step 22: Loss=0.6445
2025-06-02 15:56:20,526 - DEBUG - Online update step: 23/50
2025-06-02 15:56:20,531 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:20,622 - DEBUG - Node anomaly scores shape: torch.Size([17906, 1])
2025-06-02 15:56:20,627 - DEBUG - Edge anomaly scores shape: torch.Size([37265, 1])
2025-06-02 15:56:20,628 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:20,811 - DEBUG - Step 23: Loss=0.6206
2025-06-02 15:56:20,812 - DEBUG - Online update step: 24/50
2025-06-02 15:56:20,818 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:20,912 - DEBUG - Node anomaly scores shape: torch.Size([17725, 1])
2025-06-02 15:56:20,917 - DEBUG - Edge anomaly scores shape: torch.Size([36800, 1])
2025-06-02 15:56:20,919 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:21,109 - DEBUG - Step 24: Loss=0.6333
2025-06-02 15:56:21,110 - DEBUG - Online update step: 25/50
2025-06-02 15:56:21,115 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:21,208 - DEBUG - Node anomaly scores shape: torch.Size([18258, 1])
2025-06-02 15:56:21,212 - DEBUG - Edge anomaly scores shape: torch.Size([38030, 1])
2025-06-02 15:56:21,214 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:21,399 - DEBUG - Step 25: Loss=0.6425
2025-06-02 15:56:21,399 - DEBUG - Online update step: 26/50
2025-06-02 15:56:21,404 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:21,496 - DEBUG - Node anomaly scores shape: torch.Size([17630, 1])
2025-06-02 15:56:21,504 - DEBUG - Edge anomaly scores shape: torch.Size([36661, 1])
2025-06-02 15:56:21,505 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:21,680 - DEBUG - Step 26: Loss=0.6200
2025-06-02 15:56:21,680 - DEBUG - Online update step: 27/50
2025-06-02 15:56:21,685 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:21,771 - DEBUG - Node anomaly scores shape: torch.Size([16710, 1])
2025-06-02 15:56:21,775 - DEBUG - Edge anomaly scores shape: torch.Size([34569, 1])
2025-06-02 15:56:21,776 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:21,954 - DEBUG - Step 27: Loss=0.6334
2025-06-02 15:56:21,954 - DEBUG - Online update step: 28/50
2025-06-02 15:56:21,960 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:22,056 - DEBUG - Node anomaly scores shape: torch.Size([18491, 1])
2025-06-02 15:56:22,060 - DEBUG - Edge anomaly scores shape: torch.Size([38598, 1])
2025-06-02 15:56:22,062 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:22,311 - DEBUG - Step 28: Loss=0.6440
2025-06-02 15:56:22,311 - DEBUG - Online update step: 29/50
2025-06-02 15:56:22,317 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:22,402 - DEBUG - Node anomaly scores shape: torch.Size([16297, 1])
2025-06-02 15:56:22,406 - DEBUG - Edge anomaly scores shape: torch.Size([33712, 1])
2025-06-02 15:56:22,407 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:22,552 - DEBUG - Step 29: Loss=0.6233
2025-06-02 15:56:22,552 - DEBUG - Online update step: 30/50
2025-06-02 15:56:22,555 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:22,660 - DEBUG - Node anomaly scores shape: torch.Size([17432, 1])
2025-06-02 15:56:22,663 - DEBUG - Edge anomaly scores shape: torch.Size([36336, 1])
2025-06-02 15:56:22,665 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:22,832 - DEBUG - Step 30: Loss=0.6293
2025-06-02 15:56:22,832 - DEBUG - Online update step: 31/50
2025-06-02 15:56:22,837 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:22,917 - DEBUG - Node anomaly scores shape: torch.Size([17371, 1])
2025-06-02 15:56:22,921 - DEBUG - Edge anomaly scores shape: torch.Size([36086, 1])
2025-06-02 15:56:22,922 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:23,095 - DEBUG - Step 31: Loss=0.6401
2025-06-02 15:56:23,095 - DEBUG - Online update step: 32/50
2025-06-02 15:56:23,101 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:23,216 - DEBUG - Node anomaly scores shape: torch.Size([16448, 1])
2025-06-02 15:56:23,221 - DEBUG - Edge anomaly scores shape: torch.Size([33934, 1])
2025-06-02 15:56:23,222 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:23,437 - DEBUG - Step 32: Loss=0.6179
2025-06-02 15:56:23,437 - DEBUG - Online update step: 33/50
2025-06-02 15:56:23,445 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:23,583 - DEBUG - Node anomaly scores shape: torch.Size([18569, 1])
2025-06-02 15:56:23,595 - DEBUG - Edge anomaly scores shape: torch.Size([38568, 1])
2025-06-02 15:56:23,599 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:23,962 - DEBUG - Step 33: Loss=0.6315
2025-06-02 15:56:23,962 - DEBUG - Online update step: 34/50
2025-06-02 15:56:23,970 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:24,063 - DEBUG - Node anomaly scores shape: torch.Size([15747, 1])
2025-06-02 15:56:24,068 - DEBUG - Edge anomaly scores shape: torch.Size([32538, 1])
2025-06-02 15:56:24,069 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:24,232 - DEBUG - Step 34: Loss=0.6420
2025-06-02 15:56:24,233 - DEBUG - Online update step: 35/50
2025-06-02 15:56:24,239 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:24,335 - DEBUG - Node anomaly scores shape: torch.Size([18468, 1])
2025-06-02 15:56:24,339 - DEBUG - Edge anomaly scores shape: torch.Size([38417, 1])
2025-06-02 15:56:24,341 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:24,623 - DEBUG - Step 35: Loss=0.6176
2025-06-02 15:56:24,624 - DEBUG - Online update step: 36/50
2025-06-02 15:56:24,640 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:24,826 - DEBUG - Node anomaly scores shape: torch.Size([16411, 1])
2025-06-02 15:56:24,837 - DEBUG - Edge anomaly scores shape: torch.Size([33979, 1])
2025-06-02 15:56:24,845 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:25,073 - DEBUG - Step 36: Loss=0.6334
2025-06-02 15:56:25,073 - DEBUG - Online update step: 37/50
2025-06-02 15:56:25,079 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:25,254 - DEBUG - Node anomaly scores shape: torch.Size([17914, 1])
2025-06-02 15:56:25,268 - DEBUG - Edge anomaly scores shape: torch.Size([37118, 1])
2025-06-02 15:56:25,275 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:25,765 - DEBUG - Step 37: Loss=0.6427
2025-06-02 15:56:25,765 - DEBUG - Online update step: 38/50
2025-06-02 15:56:25,768 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:25,867 - DEBUG - Node anomaly scores shape: torch.Size([16636, 1])
2025-06-02 15:56:25,872 - DEBUG - Edge anomaly scores shape: torch.Size([34609, 1])
2025-06-02 15:56:25,873 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:26,047 - DEBUG - Step 38: Loss=0.6200
2025-06-02 15:56:26,047 - DEBUG - Online update step: 39/50
2025-06-02 15:56:26,050 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:26,134 - DEBUG - Node anomaly scores shape: torch.Size([17191, 1])
2025-06-02 15:56:26,138 - DEBUG - Edge anomaly scores shape: torch.Size([35575, 1])
2025-06-02 15:56:26,139 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:26,282 - DEBUG - Step 39: Loss=0.6325
2025-06-02 15:56:26,282 - DEBUG - Online update step: 40/50
2025-06-02 15:56:26,285 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:26,365 - DEBUG - Node anomaly scores shape: torch.Size([17721, 1])
2025-06-02 15:56:26,369 - DEBUG - Edge anomaly scores shape: torch.Size([36892, 1])
2025-06-02 15:56:26,370 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:26,532 - DEBUG - Step 40: Loss=0.6443
2025-06-02 15:56:26,532 - DEBUG - Online update step: 41/50
2025-06-02 15:56:26,537 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:26,635 - DEBUG - Node anomaly scores shape: torch.Size([17024, 1])
2025-06-02 15:56:26,639 - DEBUG - Edge anomaly scores shape: torch.Size([35215, 1])
2025-06-02 15:56:26,640 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:26,778 - DEBUG - Step 41: Loss=0.6240
2025-06-02 15:56:26,778 - DEBUG - Online update step: 42/50
2025-06-02 15:56:26,783 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:26,883 - DEBUG - Node anomaly scores shape: torch.Size([19073, 1])
2025-06-02 15:56:26,887 - DEBUG - Edge anomaly scores shape: torch.Size([39709, 1])
2025-06-02 15:56:26,889 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:27,064 - DEBUG - Step 42: Loss=0.6277
2025-06-02 15:56:27,064 - DEBUG - Online update step: 43/50
2025-06-02 15:56:27,067 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:27,155 - DEBUG - Node anomaly scores shape: torch.Size([17504, 1])
2025-06-02 15:56:27,158 - DEBUG - Edge anomaly scores shape: torch.Size([36152, 1])
2025-06-02 15:56:27,159 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:27,309 - DEBUG - Step 43: Loss=0.6381
2025-06-02 15:56:27,310 - DEBUG - Online update step: 44/50
2025-06-02 15:56:27,314 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:27,400 - DEBUG - Node anomaly scores shape: torch.Size([16598, 1])
2025-06-02 15:56:27,404 - DEBUG - Edge anomaly scores shape: torch.Size([34380, 1])
2025-06-02 15:56:27,405 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:27,537 - DEBUG - Step 44: Loss=0.6165
2025-06-02 15:56:27,537 - DEBUG - Online update step: 45/50
2025-06-02 15:56:27,541 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:27,642 - DEBUG - Node anomaly scores shape: torch.Size([16886, 1])
2025-06-02 15:56:27,646 - DEBUG - Edge anomaly scores shape: torch.Size([35013, 1])
2025-06-02 15:56:27,647 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:27,807 - DEBUG - Step 45: Loss=0.6319
2025-06-02 15:56:27,808 - DEBUG - Online update step: 46/50
2025-06-02 15:56:27,811 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:27,886 - DEBUG - Node anomaly scores shape: torch.Size([16247, 1])
2025-06-02 15:56:27,889 - DEBUG - Edge anomaly scores shape: torch.Size([33555, 1])
2025-06-02 15:56:27,890 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:28,015 - DEBUG - Step 46: Loss=0.6396
2025-06-02 15:56:28,015 - DEBUG - Online update step: 47/50
2025-06-02 15:56:28,018 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:28,119 - DEBUG - Node anomaly scores shape: torch.Size([16985, 1])
2025-06-02 15:56:28,124 - DEBUG - Edge anomaly scores shape: torch.Size([35130, 1])
2025-06-02 15:56:28,124 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:28,275 - DEBUG - Step 47: Loss=0.6164
2025-06-02 15:56:28,275 - DEBUG - Online update step: 48/50
2025-06-02 15:56:28,278 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:28,364 - DEBUG - Node anomaly scores shape: torch.Size([17624, 1])
2025-06-02 15:56:28,368 - DEBUG - Edge anomaly scores shape: torch.Size([36501, 1])
2025-06-02 15:56:28,369 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:28,554 - DEBUG - Step 48: Loss=0.6337
2025-06-02 15:56:28,554 - DEBUG - Online update step: 49/50
2025-06-02 15:56:28,558 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:28,668 - DEBUG - Node anomaly scores shape: torch.Size([18047, 1])
2025-06-02 15:56:28,675 - DEBUG - Edge anomaly scores shape: torch.Size([37542, 1])
2025-06-02 15:56:28,678 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:28,996 - DEBUG - Step 49: Loss=0.6416
2025-06-02 15:56:28,997 - DEBUG - Online update step: 50/50
2025-06-02 15:56:29,000 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:29,136 - DEBUG - Node anomaly scores shape: torch.Size([17549, 1])
2025-06-02 15:56:29,141 - DEBUG - Edge anomaly scores shape: torch.Size([36449, 1])
2025-06-02 15:56:29,143 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:29,348 - DEBUG - Step 50: Loss=0.6188
2025-06-02 15:56:29,348 - INFO - Online update finished. Average loss: 0.6320, Learning rate: 0.001000
2025-06-02 15:56:29,349 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -6.6369199e-09 -9.7001136e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  3.3184598e-08
 -2.2463421e-08 -4.2118913e-09  8.1685165e-09  4.5947908e-09
  2.3062098e+00  2.9614561e+00  1.4025696e-01  4.4132762e+00
 -1.9144961e-09  3.2944326e+00  5.8822269e+00  7.5974302e+00
  1.4025696e-01  7.9925056e+00 -1.0465912e-08  3.0631937e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.6247794e-08  1.2252775e-08], current edge mean: [ 3.8013925e-09  4.5738068e+02  0.0000000e+00  0.0000000e+00
 -2.3758702e-09  1.9006963e-09 -9.5034813e-10  1.9006963e-09
  1.9006963e-09  2.8510443e-09]
2025-06-02 15:56:29,349 - DEBUG - Node drift difference: 0.0108, Edge drift difference: 0.0009
2025-06-02 15:56:29,350 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -6.6369199e-09 -9.7001136e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  3.3184598e-08
 -2.2463421e-08 -4.2118913e-09  8.1685165e-09  4.5947908e-09
  2.3062098e+00  2.9614561e+00  1.4025696e-01  4.4132762e+00
 -1.9144961e-09  3.2944326e+00  5.8822269e+00  7.5974302e+00
  1.4025696e-01  7.9925056e+00 -1.0465912e-08  3.0631937e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.6247794e-08  1.2252775e-08], edge=[ 3.8013925e-09  4.5738068e+02  0.0000000e+00  0.0000000e+00
 -2.3758702e-09  1.9006963e-09 -9.5034813e-10  1.9006963e-09
  1.9006963e-09  2.8510443e-09]
2025-06-02 15:56:29,351 - DEBUG - Updated reference std: node=[0.         0.         1.0005357  1.0005357  0.         0.
 0.         1.0005357  1.0005357  1.0005358  1.0005357  1.0005357
 1.0156461  0.27510577 0.3654804  0.5750021  1.0005357  2.9664128
 2.87709    1.51188    0.3654804  0.229047   1.0005357  1.0005357
 0.         0.         0.         0.         1.0005357  1.0005357 ], edge=[  1.0002493 455.3443      0.          0.          1.0002491   1.0002493
   1.0002493   1.0002493   1.0002493   1.0002493]
2025-06-02 15:56:29,351 - INFO - Online update complete. Loss: 0.6320
2025-06-02 15:56:29,351 - INFO - Running anomaly detection...
2025-06-02 15:56:29,351 - INFO - Starting anomaly detection.
2025-06-02 15:56:29,368 - DEBUG - Node reconstruction errors: [1.11294366e-01 1.54097962e+00 1.63394499e+00 6.96706586e-03
 2.20111497e-02 2.04338059e-02 6.31018400e-01 1.69529356e-02
 1.69528928e-02 2.55213585e-02 1.69529356e-02 1.86274331e-02
 1.59728968e+00 1.84487730e-01 2.25321483e-03 1.07864868e-02
 2.12245770e-02 1.07868733e-02 3.69335413e-02 1.07835028e-02
 1.76499616e-02 2.25321483e-03 4.79597412e-02 8.42356682e-03
 2.21209670e-03 5.43772988e-03 2.21209670e-03 4.72780690e-02
 1.66099742e-02 2.21209670e-03 1.02831572e-01 1.65260240e-01
 4.45836112e-02 6.50232565e-03 4.37850319e-02 2.98007596e-02
 7.81306475e-02 1.07835196e-02 7.75890052e-02 8.42053518e-02
 1.23865753e-02 2.26939027e-03 1.07835196e-02 2.16341503e-02
 1.28497615e-01 1.20447017e-02 2.42315885e-02 3.19872797e-01
 1.64237730e-02 1.58396259e-01 3.31906751e-02 6.49937149e-03
 5.22345165e-03 2.03288849e-02 1.91399567e-02 3.86658423e-02
 3.44892561e-01 1.13464287e-02 1.22997183e-02 2.31117401e-02
 1.37177393e-01 1.81909930e-02 2.15920550e-03 6.68607466e-03
 4.82041426e-02 1.91399883e-02 1.15458490e-02 1.91399623e-02
 2.15921667e-03 2.74356622e-02 2.25498639e-02 1.93079580e-02
 5.01320930e-03 4.46688980e-02 4.79630753e-02 1.84194166e-02
 4.16545533e-02 3.44393849e-02 1.66260153e-02 2.19886098e-02
 5.62687824e-03 1.81067828e-02 2.38678470e-01 3.09332889e-02
 2.33260635e-02 2.20200922e-02 4.02177162e-02 3.11851334e-02
 3.05361040e-02 1.47244796e-01 2.74614920e-03 4.28488404e-02
 1.03511773e-02 2.72249598e-02 1.42143006e-02 8.11252818e-02
 5.54993888e-03 2.12765876e-02 1.56037323e-03 3.44150476e-02
 1.29470685e-02 5.54993888e-03 1.28168128e-02 2.23246306e-01
 5.26040886e-03 1.53032327e-02 7.51627097e-03 1.92890558e-02
 1.02792727e-02 7.28291348e-02 9.90018547e-02 6.40836265e-03
 1.76958498e-02 5.09014912e-02 1.14392005e-02 1.01399366e-02
 1.11648915e-02 3.71753797e-02 2.39725802e-02 9.33512114e-03
 2.57351459e-03 8.69093277e-03 3.87643836e-02 1.17175160e-02
 2.92583033e-02 9.33514163e-03 1.50212478e-02 1.39345564e-02
 2.75903773e-02 7.88876042e-03 6.58075232e-03 4.89169639e-03
 4.95196097e-02 1.84832484e-01 9.76871140e-03 1.46943806e-02
 1.43667003e-02 1.73092785e-03 6.75539672e-02 2.23961584e-02
 1.73967816e-02 3.63812968e-02 2.77307327e-03 1.08731231e-02
 1.73968095e-02 3.19749005e-02 1.11651476e-02 4.93565872e-02
 1.46021396e-02 2.91738641e-02 2.40995467e-01 6.89522317e-03
 2.32434366e-02 4.89170849e-03 1.49361752e-02 3.21903042e-02
 4.69764834e-03 1.75314527e-02 1.29469316e-02 1.20023526e-02
 1.73968095e-02 8.62023607e-03 4.69764834e-03 6.58075232e-03
 1.07739074e-02 1.49333412e-02 1.22158639e-02 1.60932317e-02
 9.53170098e-03 2.91739535e-02 2.42944118e-02 9.33005568e-03
 2.86765117e-03 5.59848212e-02 2.39718556e-02 8.68772602e+00
 1.80208124e-02 3.60096358e-02 1.12223905e-02 1.12225730e-02
 1.54772382e-02 1.39580127e-02 2.12208070e-02 4.25684378e-02
 4.76425961e-02 1.72246061e-02 2.65623606e-03 1.57753360e-02
 1.48221357e-02 4.49530035e-03 1.72506049e-02 2.47840341e-02
 2.25248095e-02 5.65673923e-03 6.75510466e-02 6.12647412e-03
 2.53354818e-01 1.57651398e-02 4.13311347e-02 1.46031352e-02
 8.41615163e-03 4.69764834e-03 1.64950192e-02 3.14474367e-02
 2.43186429e-02 6.26454828e-03 2.29828618e-02 1.03496425e-01
 1.63090846e-03 2.06568781e-02 9.38440766e-03 3.23339328e-02
 5.06518967e-03 2.94175819e-02 2.09080838e-02 3.62813915e-03
 2.54637580e-02 1.11652892e-02 1.04384392e-01 5.65676531e-03
 3.66304927e-02 2.65624025e-03 2.76315305e-03 5.06518967e-03
 4.69764834e-03 4.12907638e-02 3.55683528e-02 6.42485311e-03
 2.25967281e-02 7.71868415e-03 5.51145338e-03 3.79902534e-02
 2.98788678e-02 1.11649930e-02 1.11653237e-02 9.11575928e-03
 2.15585288e-02 2.76315073e-03 4.69764834e-03 2.54401807e-02
 2.95859352e-02 3.34594250e-02 5.94594283e-03 2.84941737e-02
 6.19233819e-03 3.16266790e-02 1.26275402e-02 3.56843285e-02
 5.94594283e-03 1.16488747e-02 2.86765117e-03 2.91877170e-03
 1.04384765e-01 1.56019144e-02 2.93973722e-02 3.54947858e-02
 4.49528685e-03 1.59749459e-03 1.39783137e-02 1.12225814e-02
 1.89885981e-02 1.80000588e-02 9.64931492e-03 2.88707595e-02
 2.41318159e-02 1.72884986e-02 2.57391036e-02 8.64291638e-02
 2.57391501e-02 1.10105472e-02 5.91830164e-02 3.93874608e-02
 2.39828844e-02 3.62637639e-02 1.08365845e-02 6.89724833e-02
 9.96384863e-03 5.01765572e-02 1.54772485e-02 1.63037088e-02
 1.06498852e-01 1.05763460e-02 1.58960074e-02 1.22786844e-02
 4.36257534e-02 5.15126390e-03 1.21716909e-01 8.64779670e-03
 1.39580211e-02 4.57321852e-02 3.19030322e-02 6.88890507e-03
 3.76021676e-02 6.19232422e-03 1.37631282e-01 2.31018406e-03
 1.82088185e-02 1.12224771e-02 6.12647412e-03 7.04651745e-03
 1.63277052e-02 1.51755642e-02 1.00285476e-02 2.64941156e-02
 1.46757113e-03 1.46757113e-03 1.46756391e-03 1.15711698e-02
 1.05263675e-02 1.51755633e-02 1.46757113e-03 1.85354091e-02
 1.46756391e-03 4.32768278e-03 7.77119212e-03 2.18482967e-02
 1.43804148e-01 1.05799632e-02 4.93983459e-03 6.81031449e-03
 3.44837084e-02 2.41606608e-02 3.11473627e-02 1.00286007e-02
 2.03067791e-02 4.07178253e-02 1.23630024e-01 2.62572207e-02
 2.19184589e-02 2.19184812e-02 1.82111606e-01 6.02257252e-03
 1.46756391e-03 1.08366134e-02 1.46757113e-03 1.15710264e-02
 1.16464850e-02 2.80825654e-03 1.78595074e-02 1.41136418e-03
 1.51755633e-02 7.19147641e-03 1.41136418e-03 3.85618247e-02
 2.14795731e-02 2.54634935e-02 1.00284973e-02 5.24013536e-03
 2.53515746e-02 1.89559255e-02 1.46757113e-03 9.65110958e-03
 3.52548473e-02 3.69706266e-02 6.84874505e-03 4.49530035e-03
 1.51755633e-02 1.46757113e-03 1.58064452e-03 2.18601469e-02
 2.35726200e-02 2.90752645e-03 7.39881322e-02 3.50610018e-02
 1.00286342e-02 3.44109423e-02 2.41605449e-03 3.97599973e-02
 1.04520684e-02 7.89069664e-03 2.21186690e-02 3.01342886e-02
 3.50987278e-02 1.51801407e-02 2.50301827e-02 3.69705483e-02
 2.71170726e-03 4.08287253e-03 3.86673473e-02 1.46756391e-03
 1.00287218e-02 7.20282085e-03 4.19527432e-03 1.52303465e-02
 6.81942282e-03 2.17899438e-02 2.06775535e-02 1.49207795e-02
 2.88638733e-02 1.46757113e-03 7.68722594e-02 2.06643678e-02
 9.44206119e-03 4.23626080e-02 2.72475835e-02 2.72475835e-02
 2.72475965e-02 1.05860177e-02 1.38847309e-03 1.08663877e-02
 4.17327834e-03 4.12100703e-02 2.72475965e-02 1.38848170e-03
 9.95680504e-03 9.44200531e-03 3.35371085e-02 1.06972866e-02
 9.44205653e-03 2.05796361e-02 2.72475835e-02 9.44210589e-03
 1.38848170e-03 2.72475835e-02 2.72475835e-02 6.32042764e-03
 6.96269888e-03 2.72475835e-02 2.69313133e-03 6.69566216e-03
 1.27299745e-02 4.28976584e-03 8.06128606e-03 4.04878194e-03
 3.72592807e-02 1.36621036e-02 5.39653422e-03 1.46057568e-02
 1.22041404e-02 6.32957043e-03 2.31527798e-02 1.59285925e-02
 2.93572173e-02 3.22074667e-02 5.99947199e-02 2.72475965e-02
 4.17327834e-03 2.34969277e-02 3.75366025e-02 1.06136585e-02
 5.45852911e-03 3.85906291e-03 7.14068264e-02 2.42106244e-03
 7.79568451e-03 2.19525136e-02 3.53744365e-02 3.78220272e-03
 6.18655700e-03 4.21949336e-03 3.65343839e-02 2.52457499e-03
 4.68756910e-03 1.05760256e-02 2.52456102e-03 1.54316043e-02
 4.04877355e-03 7.46410666e-03 7.61144143e-03 2.11703349e-02
 9.63372178e-03 4.82227979e-03 3.93966679e-03 1.60914194e-02
 3.93966679e-03 4.82227234e-03 2.62135477e-03 1.22156180e-02
 7.90597498e-03 6.28926558e-03 2.62135477e-03 9.63372644e-03
 1.97916515e-02 5.15411161e-02 2.89556701e-02 8.06124229e-03
 1.22155445e-02 9.63372085e-03 2.25619320e-03 5.40354243e-03
 5.59742516e-03 9.33728069e-02 5.62960096e-03 3.78220272e-03
 3.58736701e-02 3.64985899e-03 2.52456102e-03 9.93695669e-03
 1.07643716e-02 5.15387058e-02 1.07695423e-02 2.25619273e-03
 1.51174916e-02 2.28568143e-03 2.47719195e-02 4.33283625e-03
 9.32977162e-03 3.78510281e-02 1.34094316e-03 5.40357362e-03
 7.10937232e-02 2.28568143e-03 5.33832684e-02 1.05216550e-02
 2.55937176e-03 9.80399176e-03 1.16476219e-03 1.34605959e-01
 4.50027268e-03 2.52456102e-03 5.54346992e-03 3.28755169e-03
 3.28755169e-03 2.85422360e-03 2.14701388e-02 4.57090233e-03
 1.16476219e-03 9.86160245e-03 1.29711777e-02 2.45803036e-02
 9.86165740e-03 3.85906291e-03 1.16476219e-03 2.13321652e-02
 2.55937176e-03 9.32981074e-03 5.55412285e-03 2.02199481e-02
 3.11995577e-02 2.48314794e-02 4.57090233e-03 2.82550231e-02
 1.34094316e-03 5.40354243e-03 9.32971667e-03 9.38512012e-03
 2.04696096e-02 2.54570283e-02 1.34094560e-03 2.77848113e-02
 1.34094560e-03 2.16203593e-02 1.14241298e-02 9.86159872e-03
 2.59499182e-03 3.90651673e-02 8.12695269e-03 1.32451463e-03
 1.93177685e-01 1.32452219e-03 1.32452219e-03 1.32451463e-03
 1.32452219e-03 1.32452219e-03 1.32452219e-03 1.32452219e-03
 1.12433620e-02 2.50887917e-03 1.07487757e-02 1.32451463e-03
 1.32452219e-03 1.32452219e-03 1.32452219e-03 1.32451463e-03
 1.32452219e-03 1.32451463e-03 1.32452219e-03 1.32452219e-03
 1.03279930e-02 1.32452219e-03 1.32452219e-03 5.32533005e-02
 1.32452219e-03 5.52127464e-03 9.33991745e-03 1.34094560e-03
 1.14245918e-02 3.23175006e-02 3.45955864e-02 3.45955864e-02
 2.54875105e-02 1.14245918e-02 1.34094560e-03 1.16476219e-03
 1.16476219e-03 1.34094316e-03 1.16476219e-03 6.86022034e-03
 9.55925602e-03 1.32452219e-03 3.85904917e-03 1.34094316e-03
 3.28755169e-03 1.34094560e-03 1.34094560e-03 9.80704185e-03
 1.34094316e-03 1.16476219e-03 1.34094560e-03 1.34094560e-03
 9.86166205e-03 1.16476219e-03 1.34094560e-03 1.16476219e-03
 1.34094316e-03 1.34094560e-03 1.34094560e-03 2.14918479e-02
 2.69659813e-02 7.84605183e-03 1.32452219e-03 1.69214085e-02
 1.10091902e-02 1.34094560e-03 1.16476219e-03 2.25478318e-02
 1.32451463e-03 8.38068686e-03 2.04299781e-02 1.12033752e-03
 1.34094316e-03 1.34094560e-03 9.05203354e-03 2.24194191e-02
 7.49601424e-03 1.34094560e-03 1.12431888e-02 1.47660717e-03
 1.16476219e-03 1.55080762e-02 1.32452219e-03 1.08385254e-02
 2.87529938e-02 1.32452219e-03 1.32452219e-03 1.12432204e-02
 1.47660717e-03 1.34094560e-03 9.79872197e-02 2.81130150e-02
 2.53211260e-02 2.24194191e-02 4.79125790e-03 2.52773818e-02
 2.52774060e-02 9.15308017e-03 3.17604584e-03 1.32452219e-03
 3.21515789e-03 2.99559347e-02 2.24193893e-02 8.17892142e-03
 3.71456239e-03 4.19973675e-03 1.31622399e-03 1.31622644e-03
 1.31622399e-03 1.31622644e-03 1.31622644e-03 1.01599963e-02
 2.77408604e-02 1.31622399e-03 1.31622644e-03 1.32452219e-03
 1.37301884e-03 1.32451463e-03 2.52774060e-02 2.14469470e-02
 3.80061306e-02 6.55263849e-03 2.52774060e-02 4.15418632e-02
 1.03280209e-02 8.18725117e-03 1.03279566e-02 1.32452219e-03
 2.52773818e-02 2.51684315e-03 1.14132452e-03 1.14131125e-03
 1.31622644e-03 2.51686852e-03 2.08364632e-02 9.55633260e-03
 3.11189797e-03 1.32452219e-03 1.31622644e-03 5.09027345e-03
 1.14132452e-03 1.13456615e-03 2.44541699e-03 5.33309812e-03
 1.01598976e-02 5.05711660e-02 2.69166101e-03 5.10879084e-02
 7.65633862e-03 2.44541699e-03 3.68712028e-03 2.49281665e-03
 2.44188914e-03 2.58145086e-03 2.39022877e-02 3.01741133e-03
 2.45343074e-02 2.44541187e-03 2.44541699e-03 2.44541187e-03
 2.18800339e-03 5.09027345e-03 2.44540116e-03 2.44188914e-03
 2.44540116e-03 2.44541187e-03 2.44540116e-03 8.09875503e-03
 2.47939350e-03 1.75741967e-02 2.79017407e-02 2.64732037e-02
 3.62400967e-03 4.04806528e-03 2.45189350e-02 2.20694561e-02
 2.44471221e-03 2.43978435e-03 2.38265423e-03 1.68722365e-02
 1.68722365e-02 2.44188937e-03 3.09466962e-02 7.37598836e-02
 2.44169519e-03 1.36961101e-03 6.94221584e-03 2.64408197e-02
 2.42755236e-03 2.42754468e-03 2.42754468e-03 1.43850385e-03
 2.06847279e-03 1.27579505e-02 2.22261827e-02 8.10653865e-02
 6.56813523e-03 2.26468756e-03 2.69428873e-03 1.36960880e-03
 3.50550795e-03 6.92675123e-03 2.17993022e-03 6.96697086e-03
 2.44169519e-03 7.37598464e-02 1.36960880e-03 6.92675030e-03
 2.26467429e-03 1.38627132e-02 2.42754468e-03 1.43850385e-03
 2.17993022e-03 3.10772704e-03 1.70149375e-02 1.43850385e-03
 1.43850385e-03 1.43850385e-03 1.60062984e-02 3.30254614e-01
 4.95905757e-01 2.42754468e-03 5.28200455e-02 1.43850385e-03
 2.52809133e-02 3.51239578e-03 2.66264025e-02 3.37550323e-03
 1.43850385e-03 1.55256537e-03 2.33080378e-03 2.36198329e-03
 2.00089306e-01 3.37548507e-03 5.59511892e-02 6.68047834e-03
 2.92166360e-02 3.37548507e-03 2.23797001e-02 1.73789747e-02
 6.11121953e-03 2.26819180e-02 1.03351735e-02 2.25093542e-03
 2.25093542e-03 6.07697293e-02 1.05672605e-01 1.64805446e-02
 3.37548507e-03 6.11121673e-03 3.37548507e-03 1.87588332e-03
 2.13982048e-03 2.13982048e-03 1.92847115e-03 3.48818786e-02
 2.24445644e-03 2.13983725e-03 1.87587517e-03 1.51623935e-02
 2.13982048e-03 2.13983539e-03 1.68292411e-03 8.99372622e-03
 2.98205502e-02 2.87710391e-02 2.13983725e-03 1.18178846e-02
 1.51623935e-02 2.13983539e-03 2.10416177e-03 3.05182231e-03
 1.97259476e-03 1.97259476e-03 1.77699383e-02 3.05183441e-03
 2.13982048e-03 3.05183441e-03 3.44515662e-03 3.40184495e-02
 2.06261110e-02 2.13982048e-03 9.99445990e-02 2.92160758e-03
 2.92161573e-03 8.99372622e-03 1.88035716e-03 4.10045078e-03
 2.10416177e-03 7.36726634e-03 1.88567117e-03 1.89349893e-02
 5.01812715e-03 1.89349893e-02 6.95984513e-02 1.94676372e-03
 5.01812389e-03 2.16656481e-03 2.16657366e-03 7.76279867e-02
 2.16657366e-03 1.22989565e-02 1.88035716e-03 1.92676652e-02
 3.33924824e-03 1.94676372e-03 3.33924824e-03 1.71156283e-02
 3.35667990e-02 1.10947154e-02 2.16657366e-03 8.73658620e-03
 9.29683819e-03 2.16656481e-03 2.50600018e-02 3.04667819e-02
 8.73658620e-03 1.94676279e-03 2.16657366e-03 9.18917507e-02
 2.16657366e-03 2.16657366e-03 2.16656481e-03 2.15027342e-03
 2.07719728e-02 2.15025898e-03 3.29726259e-03 2.15025898e-03
 2.32301317e-02 2.75973715e-02 4.24815938e-02 2.16657366e-03
 2.16657366e-03 2.18229485e-03 2.16656481e-03 2.66571313e-01
 4.47315304e-03 2.15027342e-03 2.16656481e-03 2.16656481e-03
 2.16657366e-03 4.63194586e-03 2.16656481e-03 2.16657366e-03
 1.86946418e-03 4.47314046e-03 2.26338301e-03 6.95450455e-02
 1.86946418e-03 2.16656481e-03 2.16656481e-03 4.99420706e-03
 2.50576325e-02 2.82953456e-02 2.82953456e-02 2.56431079e-03
 1.91626381e-02 1.17671173e-02 4.72448301e-03 2.28211880e-01
 2.82953456e-02 2.31673196e-03 2.82953456e-02 8.72936938e-03
 4.72447136e-03 2.82953456e-02 3.10474657e-03 2.26338301e-03
 6.34761434e-03 2.58748629e-03 2.68495828e-03 3.80615564e-03
 1.26366746e-02 3.41760367e-03 5.87459980e-03 5.87459980e-03
 3.41760111e-03 5.87459980e-03 5.87459980e-03 5.87459980e-03
 5.87459980e-03 5.07499725e-02 5.87461237e-03 5.87462727e-03
 5.87455742e-03 5.87459980e-03]
2025-06-02 15:56:29,369 - DEBUG - Edge reconstruction errors: [ 5.2645655  5.261892  44.258606  ... 13.358587   2.1586962 13.358587 ]
2025-06-02 15:56:29,370 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155629_update_42.json
2025-06-02 15:56:29,371 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:56:29,380 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155629_update_42.pth and as latest_checkpoint.pth
2025-06-02 15:56:29,380 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870355.dot): 0.5772
2025-06-02 15:56:29,380 - WARNING - Detected 4 anomalous nodes (reconstruction-based):
2025-06-02 15:56:29,380 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.5410, MLP Score: 0.4913
2025-06-02 15:56:29,380 - WARNING -   Node ID: 192.168.27.13, Recon Error: 1.6339, MLP Score: 0.4733
2025-06-02 15:56:29,380 - WARNING -   Node ID: 192.168.27.10, Recon Error: 1.5973, MLP Score: 0.4900
2025-06-02 15:56:29,380 - WARNING -   Node ID: 183.81.34.26, Recon Error: 8.6877, MLP Score: 0.4733
2025-06-02 15:56:29,380 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:56:29,381 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2586, MLP Score: 0.0352
2025-06-02 15:56:29,381 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9613, MLP Score: 0.0095
2025-06-02 15:56:29,381 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0609, MLP Score: 0.0095
2025-06-02 15:56:29,381 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7596, MLP Score: 0.0044
2025-06-02 15:56:29,381 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7589, MLP Score: 0.0039
2025-06-02 15:56:29,381 - INFO - 
--- Processing file: nw_graph_encoded_1748870385.dot (Timestamp: 2025-06-02 15:19:45) ---
2025-06-02 15:56:29,381 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870385.dot
2025-06-02 15:56:29,381 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870385.dot'.
2025-06-02 15:56:29,381 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870385.dot
2025-06-02 15:56:29,410 - INFO - Parsed 944 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870385.dot'.
2025-06-02 15:56:29,436 - INFO - Parsed 2034 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870385.dot'.
2025-06-02 15:56:29,436 - INFO - Processing node updates/additions.
2025-06-02 15:56:29,442 - INFO - Processing edge updates/additions.
2025-06-02 15:56:29,454 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:56:29,455 - INFO - Finished updating NetworkX graph.
2025-06-02 15:56:29,455 - DEBUG - Updated graph - Nodes: 944, Edges: 2034
2025-06-02 15:56:29,455 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:56:29,457 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:56:29,466 - DEBUG - Initial node features tensor shape: torch.Size([944, 30])
2025-06-02 15:56:29,467 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:56:29,467 - DEBUG - Node features tensor shape after scaling: torch.Size([944, 30])
2025-06-02 15:56:29,469 - DEBUG - Edge index tensor shape: torch.Size([2, 2034])
2025-06-02 15:56:29,470 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:56:29,475 - DEBUG - Initial edge attributes tensor shape: torch.Size([2034, 10])
2025-06-02 15:56:29,476 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:56:29,476 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2034, 10])
2025-06-02 15:56:29,476 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:56:29,477 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:56:29,477 - INFO - Updated main graph to 944 nodes and 2034 edges.
2025-06-02 15:56:29,477 - INFO - Performing online update...
2025-06-02 15:56:29,477 - INFO - Starting online update for 50 steps.
2025-06-02 15:56:29,478 - DEBUG - Updated RunningStats: new_mean=0.9441478371279851, new_var=60000000000161.984, new_n=6030
2025-06-02 15:56:29,478 - DEBUG - Updated RunningStats: new_mean=0.9431277294369128, new_var=60300000000017.93, new_n=6060
2025-06-02 15:56:29,478 - DEBUG - Updated RunningStats: new_mean=44.759047684335385, new_var=20000000187835.22, new_n=2010
2025-06-02 15:56:29,479 - DEBUG - Updated RunningStats: new_mean=44.764928416578286, new_var=20100000183636.96, new_n=2020
2025-06-02 15:56:29,479 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:56:29,479 - DEBUG - Online update step: 1/50
2025-06-02 15:56:29,481 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:29,579 - DEBUG - Node anomaly scores shape: torch.Size([18084, 1])
2025-06-02 15:56:29,592 - DEBUG - Edge anomaly scores shape: torch.Size([37411, 1])
2025-06-02 15:56:29,598 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:29,788 - DEBUG - Step 1: Loss=0.6313
2025-06-02 15:56:29,788 - DEBUG - Online update step: 2/50
2025-06-02 15:56:29,791 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:29,878 - DEBUG - Node anomaly scores shape: torch.Size([17729, 1])
2025-06-02 15:56:29,882 - DEBUG - Edge anomaly scores shape: torch.Size([36980, 1])
2025-06-02 15:56:29,883 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:30,033 - DEBUG - Step 2: Loss=0.6427
2025-06-02 15:56:30,034 - DEBUG - Online update step: 3/50
2025-06-02 15:56:30,037 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:30,123 - DEBUG - Node anomaly scores shape: torch.Size([17583, 1])
2025-06-02 15:56:30,127 - DEBUG - Edge anomaly scores shape: torch.Size([36480, 1])
2025-06-02 15:56:30,128 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:30,322 - DEBUG - Step 3: Loss=0.6224
2025-06-02 15:56:30,322 - DEBUG - Online update step: 4/50
2025-06-02 15:56:30,325 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:30,398 - DEBUG - Node anomaly scores shape: torch.Size([15926, 1])
2025-06-02 15:56:30,401 - DEBUG - Edge anomaly scores shape: torch.Size([32891, 1])
2025-06-02 15:56:30,402 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:30,539 - DEBUG - Step 4: Loss=0.6267
2025-06-02 15:56:30,539 - DEBUG - Online update step: 5/50
2025-06-02 15:56:30,542 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:30,659 - DEBUG - Node anomaly scores shape: torch.Size([18580, 1])
2025-06-02 15:56:30,664 - DEBUG - Edge anomaly scores shape: torch.Size([38714, 1])
2025-06-02 15:56:30,665 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:30,858 - DEBUG - Step 5: Loss=0.6364
2025-06-02 15:56:30,859 - DEBUG - Online update step: 6/50
2025-06-02 15:56:30,862 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:30,948 - DEBUG - Node anomaly scores shape: torch.Size([18044, 1])
2025-06-02 15:56:30,952 - DEBUG - Edge anomaly scores shape: torch.Size([37572, 1])
2025-06-02 15:56:30,953 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:31,132 - DEBUG - Step 6: Loss=0.6144
2025-06-02 15:56:31,132 - DEBUG - Online update step: 7/50
2025-06-02 15:56:31,136 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:31,225 - DEBUG - Node anomaly scores shape: torch.Size([17576, 1])
2025-06-02 15:56:31,229 - DEBUG - Edge anomaly scores shape: torch.Size([36531, 1])
2025-06-02 15:56:31,230 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:31,422 - DEBUG - Step 7: Loss=0.6293
2025-06-02 15:56:31,423 - DEBUG - Online update step: 8/50
2025-06-02 15:56:31,426 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:31,515 - DEBUG - Node anomaly scores shape: torch.Size([17234, 1])
2025-06-02 15:56:31,522 - DEBUG - Edge anomaly scores shape: torch.Size([35842, 1])
2025-06-02 15:56:31,523 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:31,703 - DEBUG - Step 8: Loss=0.6390
2025-06-02 15:56:31,703 - DEBUG - Online update step: 9/50
2025-06-02 15:56:31,710 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:31,811 - DEBUG - Node anomaly scores shape: torch.Size([18175, 1])
2025-06-02 15:56:31,815 - DEBUG - Edge anomaly scores shape: torch.Size([37903, 1])
2025-06-02 15:56:31,816 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:31,981 - DEBUG - Step 9: Loss=0.6141
2025-06-02 15:56:31,981 - DEBUG - Online update step: 10/50
2025-06-02 15:56:31,985 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:32,068 - DEBUG - Node anomaly scores shape: torch.Size([18402, 1])
2025-06-02 15:56:32,072 - DEBUG - Edge anomaly scores shape: torch.Size([38348, 1])
2025-06-02 15:56:32,073 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:32,237 - DEBUG - Step 10: Loss=0.6316
2025-06-02 15:56:32,237 - DEBUG - Online update step: 11/50
2025-06-02 15:56:32,245 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:32,338 - DEBUG - Node anomaly scores shape: torch.Size([17380, 1])
2025-06-02 15:56:32,342 - DEBUG - Edge anomaly scores shape: torch.Size([36121, 1])
2025-06-02 15:56:32,344 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:32,794 - DEBUG - Step 11: Loss=0.6417
2025-06-02 15:56:32,794 - DEBUG - Online update step: 12/50
2025-06-02 15:56:32,797 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:32,921 - DEBUG - Node anomaly scores shape: torch.Size([17466, 1])
2025-06-02 15:56:32,926 - DEBUG - Edge anomaly scores shape: torch.Size([36177, 1])
2025-06-02 15:56:32,928 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:33,125 - DEBUG - Step 12: Loss=0.6182
2025-06-02 15:56:33,125 - DEBUG - Online update step: 13/50
2025-06-02 15:56:33,131 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:33,317 - DEBUG - Node anomaly scores shape: torch.Size([17394, 1])
2025-06-02 15:56:33,322 - DEBUG - Edge anomaly scores shape: torch.Size([36012, 1])
2025-06-02 15:56:33,324 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:33,508 - DEBUG - Step 13: Loss=0.6307
2025-06-02 15:56:33,509 - DEBUG - Online update step: 14/50
2025-06-02 15:56:33,514 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:33,604 - DEBUG - Node anomaly scores shape: torch.Size([17273, 1])
2025-06-02 15:56:33,608 - DEBUG - Edge anomaly scores shape: torch.Size([35820, 1])
2025-06-02 15:56:33,610 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:33,791 - DEBUG - Step 14: Loss=0.6441
2025-06-02 15:56:33,792 - DEBUG - Online update step: 15/50
2025-06-02 15:56:33,797 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:33,876 - DEBUG - Node anomaly scores shape: torch.Size([17156, 1])
2025-06-02 15:56:33,880 - DEBUG - Edge anomaly scores shape: torch.Size([35466, 1])
2025-06-02 15:56:33,881 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:34,026 - DEBUG - Step 15: Loss=0.6230
2025-06-02 15:56:34,026 - DEBUG - Online update step: 16/50
2025-06-02 15:56:34,030 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:34,249 - DEBUG - Node anomaly scores shape: torch.Size([18062, 1])
2025-06-02 15:56:34,258 - DEBUG - Edge anomaly scores shape: torch.Size([37486, 1])
2025-06-02 15:56:34,264 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:34,492 - DEBUG - Step 16: Loss=0.6251
2025-06-02 15:56:34,492 - DEBUG - Online update step: 17/50
2025-06-02 15:56:34,496 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:34,585 - DEBUG - Node anomaly scores shape: torch.Size([16665, 1])
2025-06-02 15:56:34,589 - DEBUG - Edge anomaly scores shape: torch.Size([34449, 1])
2025-06-02 15:56:34,590 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:34,770 - DEBUG - Step 17: Loss=0.6356
2025-06-02 15:56:34,770 - DEBUG - Online update step: 18/50
2025-06-02 15:56:34,773 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:34,876 - DEBUG - Node anomaly scores shape: torch.Size([17431, 1])
2025-06-02 15:56:34,880 - DEBUG - Edge anomaly scores shape: torch.Size([36197, 1])
2025-06-02 15:56:34,881 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:35,041 - DEBUG - Step 18: Loss=0.6141
2025-06-02 15:56:35,041 - DEBUG - Online update step: 19/50
2025-06-02 15:56:35,044 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:35,128 - DEBUG - Node anomaly scores shape: torch.Size([17943, 1])
2025-06-02 15:56:35,133 - DEBUG - Edge anomaly scores shape: torch.Size([37354, 1])
2025-06-02 15:56:35,134 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:35,368 - DEBUG - Step 19: Loss=0.6291
2025-06-02 15:56:35,369 - DEBUG - Online update step: 20/50
2025-06-02 15:56:35,371 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:35,442 - DEBUG - Node anomaly scores shape: torch.Size([17028, 1])
2025-06-02 15:56:35,446 - DEBUG - Edge anomaly scores shape: torch.Size([35508, 1])
2025-06-02 15:56:35,447 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:35,590 - DEBUG - Step 20: Loss=0.6369
2025-06-02 15:56:35,590 - DEBUG - Online update step: 21/50
2025-06-02 15:56:35,593 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:35,683 - DEBUG - Node anomaly scores shape: torch.Size([17071, 1])
2025-06-02 15:56:35,687 - DEBUG - Edge anomaly scores shape: torch.Size([35432, 1])
2025-06-02 15:56:35,688 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:35,850 - DEBUG - Step 21: Loss=0.6138
2025-06-02 15:56:35,851 - DEBUG - Online update step: 22/50
2025-06-02 15:56:35,854 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:35,967 - DEBUG - Node anomaly scores shape: torch.Size([16603, 1])
2025-06-02 15:56:35,971 - DEBUG - Edge anomaly scores shape: torch.Size([34330, 1])
2025-06-02 15:56:35,972 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:36,170 - DEBUG - Step 22: Loss=0.6330
2025-06-02 15:56:36,170 - DEBUG - Online update step: 23/50
2025-06-02 15:56:36,173 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:36,268 - DEBUG - Node anomaly scores shape: torch.Size([16922, 1])
2025-06-02 15:56:36,272 - DEBUG - Edge anomaly scores shape: torch.Size([35040, 1])
2025-06-02 15:56:36,273 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:36,436 - DEBUG - Step 23: Loss=0.6410
2025-06-02 15:56:36,436 - DEBUG - Online update step: 24/50
2025-06-02 15:56:36,440 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:36,531 - DEBUG - Node anomaly scores shape: torch.Size([18501, 1])
2025-06-02 15:56:36,535 - DEBUG - Edge anomaly scores shape: torch.Size([38655, 1])
2025-06-02 15:56:36,538 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:36,713 - DEBUG - Step 24: Loss=0.6168
2025-06-02 15:56:36,714 - DEBUG - Online update step: 25/50
2025-06-02 15:56:36,717 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:36,811 - DEBUG - Node anomaly scores shape: torch.Size([18269, 1])
2025-06-02 15:56:36,818 - DEBUG - Edge anomaly scores shape: torch.Size([38047, 1])
2025-06-02 15:56:36,821 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:36,988 - DEBUG - Step 25: Loss=0.6294
2025-06-02 15:56:36,988 - DEBUG - Online update step: 26/50
2025-06-02 15:56:36,991 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:37,074 - DEBUG - Node anomaly scores shape: torch.Size([16354, 1])
2025-06-02 15:56:37,078 - DEBUG - Edge anomaly scores shape: torch.Size([33825, 1])
2025-06-02 15:56:37,079 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:37,227 - DEBUG - Step 26: Loss=0.6430
2025-06-02 15:56:37,228 - DEBUG - Online update step: 27/50
2025-06-02 15:56:37,231 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:37,326 - DEBUG - Node anomaly scores shape: torch.Size([16836, 1])
2025-06-02 15:56:37,332 - DEBUG - Edge anomaly scores shape: torch.Size([34917, 1])
2025-06-02 15:56:37,333 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:37,538 - DEBUG - Step 27: Loss=0.6223
2025-06-02 15:56:37,538 - DEBUG - Online update step: 28/50
2025-06-02 15:56:37,542 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:37,622 - DEBUG - Node anomaly scores shape: torch.Size([17967, 1])
2025-06-02 15:56:37,625 - DEBUG - Edge anomaly scores shape: torch.Size([37383, 1])
2025-06-02 15:56:37,626 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:37,855 - DEBUG - Step 28: Loss=0.6237
2025-06-02 15:56:37,855 - DEBUG - Online update step: 29/50
2025-06-02 15:56:37,858 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:37,944 - DEBUG - Node anomaly scores shape: torch.Size([17369, 1])
2025-06-02 15:56:37,948 - DEBUG - Edge anomaly scores shape: torch.Size([36112, 1])
2025-06-02 15:56:37,949 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:38,089 - DEBUG - Step 29: Loss=0.6333
2025-06-02 15:56:38,089 - DEBUG - Online update step: 30/50
2025-06-02 15:56:38,092 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:38,195 - DEBUG - Node anomaly scores shape: torch.Size([19166, 1])
2025-06-02 15:56:38,199 - DEBUG - Edge anomaly scores shape: torch.Size([39908, 1])
2025-06-02 15:56:38,200 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:38,379 - DEBUG - Step 30: Loss=0.6115
2025-06-02 15:56:38,380 - DEBUG - Online update step: 31/50
2025-06-02 15:56:38,383 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:38,502 - DEBUG - Node anomaly scores shape: torch.Size([18490, 1])
2025-06-02 15:56:38,508 - DEBUG - Edge anomaly scores shape: torch.Size([38517, 1])
2025-06-02 15:56:38,509 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:38,705 - DEBUG - Step 31: Loss=0.6282
2025-06-02 15:56:38,706 - DEBUG - Online update step: 32/50
2025-06-02 15:56:38,709 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:38,822 - DEBUG - Node anomaly scores shape: torch.Size([19016, 1])
2025-06-02 15:56:38,826 - DEBUG - Edge anomaly scores shape: torch.Size([39601, 1])
2025-06-02 15:56:38,827 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:38,999 - DEBUG - Step 32: Loss=0.6354
2025-06-02 15:56:38,999 - DEBUG - Online update step: 33/50
2025-06-02 15:56:39,002 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:39,084 - DEBUG - Node anomaly scores shape: torch.Size([18001, 1])
2025-06-02 15:56:39,089 - DEBUG - Edge anomaly scores shape: torch.Size([37636, 1])
2025-06-02 15:56:39,090 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:39,286 - DEBUG - Step 33: Loss=0.6110
2025-06-02 15:56:39,287 - DEBUG - Online update step: 34/50
2025-06-02 15:56:39,290 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:39,446 - DEBUG - Node anomaly scores shape: torch.Size([17935, 1])
2025-06-02 15:56:39,451 - DEBUG - Edge anomaly scores shape: torch.Size([37177, 1])
2025-06-02 15:56:39,452 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:39,628 - DEBUG - Step 34: Loss=0.6322
2025-06-02 15:56:39,628 - DEBUG - Online update step: 35/50
2025-06-02 15:56:39,631 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:39,705 - DEBUG - Node anomaly scores shape: torch.Size([16826, 1])
2025-06-02 15:56:39,708 - DEBUG - Edge anomaly scores shape: torch.Size([34673, 1])
2025-06-02 15:56:39,709 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:39,843 - DEBUG - Step 35: Loss=0.6412
2025-06-02 15:56:39,844 - DEBUG - Online update step: 36/50
2025-06-02 15:56:39,847 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:39,944 - DEBUG - Node anomaly scores shape: torch.Size([17485, 1])
2025-06-02 15:56:39,948 - DEBUG - Edge anomaly scores shape: torch.Size([36201, 1])
2025-06-02 15:56:39,949 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:40,108 - DEBUG - Step 36: Loss=0.6174
2025-06-02 15:56:40,108 - DEBUG - Online update step: 37/50
2025-06-02 15:56:40,111 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:40,193 - DEBUG - Node anomaly scores shape: torch.Size([17595, 1])
2025-06-02 15:56:40,197 - DEBUG - Edge anomaly scores shape: torch.Size([36466, 1])
2025-06-02 15:56:40,198 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:40,345 - DEBUG - Step 37: Loss=0.6282
2025-06-02 15:56:40,345 - DEBUG - Online update step: 38/50
2025-06-02 15:56:40,349 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:40,443 - DEBUG - Node anomaly scores shape: torch.Size([18078, 1])
2025-06-02 15:56:40,447 - DEBUG - Edge anomaly scores shape: torch.Size([37631, 1])
2025-06-02 15:56:40,448 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:40,639 - DEBUG - Step 38: Loss=0.6416
2025-06-02 15:56:40,640 - DEBUG - Online update step: 39/50
2025-06-02 15:56:40,643 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:40,729 - DEBUG - Node anomaly scores shape: torch.Size([17160, 1])
2025-06-02 15:56:40,732 - DEBUG - Edge anomaly scores shape: torch.Size([35668, 1])
2025-06-02 15:56:40,733 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:40,883 - DEBUG - Step 39: Loss=0.6216
2025-06-02 15:56:40,883 - DEBUG - Online update step: 40/50
2025-06-02 15:56:40,887 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:40,992 - DEBUG - Node anomaly scores shape: torch.Size([18224, 1])
2025-06-02 15:56:40,996 - DEBUG - Edge anomaly scores shape: torch.Size([37971, 1])
2025-06-02 15:56:40,998 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:41,163 - DEBUG - Step 40: Loss=0.6224
2025-06-02 15:56:41,163 - DEBUG - Online update step: 41/50
2025-06-02 15:56:41,170 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:41,259 - DEBUG - Node anomaly scores shape: torch.Size([17382, 1])
2025-06-02 15:56:41,262 - DEBUG - Edge anomaly scores shape: torch.Size([35978, 1])
2025-06-02 15:56:41,263 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:41,414 - DEBUG - Step 41: Loss=0.6333
2025-06-02 15:56:41,414 - DEBUG - Online update step: 42/50
2025-06-02 15:56:41,418 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:41,531 - DEBUG - Node anomaly scores shape: torch.Size([18492, 1])
2025-06-02 15:56:41,536 - DEBUG - Edge anomaly scores shape: torch.Size([38639, 1])
2025-06-02 15:56:41,538 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:41,740 - DEBUG - Step 42: Loss=0.6112
2025-06-02 15:56:41,741 - DEBUG - Online update step: 43/50
2025-06-02 15:56:41,746 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:41,840 - DEBUG - Node anomaly scores shape: torch.Size([17257, 1])
2025-06-02 15:56:41,845 - DEBUG - Edge anomaly scores shape: torch.Size([35805, 1])
2025-06-02 15:56:41,846 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:42,029 - DEBUG - Step 43: Loss=0.6293
2025-06-02 15:56:42,030 - DEBUG - Online update step: 44/50
2025-06-02 15:56:42,035 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:42,123 - DEBUG - Node anomaly scores shape: torch.Size([17947, 1])
2025-06-02 15:56:42,127 - DEBUG - Edge anomaly scores shape: torch.Size([37454, 1])
2025-06-02 15:56:42,129 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:42,322 - DEBUG - Step 44: Loss=0.6382
2025-06-02 15:56:42,322 - DEBUG - Online update step: 45/50
2025-06-02 15:56:42,327 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:42,413 - DEBUG - Node anomaly scores shape: torch.Size([17785, 1])
2025-06-02 15:56:42,417 - DEBUG - Edge anomaly scores shape: torch.Size([37164, 1])
2025-06-02 15:56:42,419 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:42,589 - DEBUG - Step 45: Loss=0.6138
2025-06-02 15:56:42,590 - DEBUG - Online update step: 46/50
2025-06-02 15:56:42,595 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:42,685 - DEBUG - Node anomaly scores shape: torch.Size([18478, 1])
2025-06-02 15:56:42,689 - DEBUG - Edge anomaly scores shape: torch.Size([38392, 1])
2025-06-02 15:56:42,691 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:42,881 - DEBUG - Step 46: Loss=0.6297
2025-06-02 15:56:42,882 - DEBUG - Online update step: 47/50
2025-06-02 15:56:42,887 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:42,972 - DEBUG - Node anomaly scores shape: torch.Size([16876, 1])
2025-06-02 15:56:42,975 - DEBUG - Edge anomaly scores shape: torch.Size([34843, 1])
2025-06-02 15:56:42,976 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:43,142 - DEBUG - Step 47: Loss=0.6408
2025-06-02 15:56:43,143 - DEBUG - Online update step: 48/50
2025-06-02 15:56:43,148 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:43,245 - DEBUG - Node anomaly scores shape: torch.Size([18402, 1])
2025-06-02 15:56:43,250 - DEBUG - Edge anomaly scores shape: torch.Size([38359, 1])
2025-06-02 15:56:43,251 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:43,425 - DEBUG - Step 48: Loss=0.6186
2025-06-02 15:56:43,426 - DEBUG - Online update step: 49/50
2025-06-02 15:56:43,432 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:43,529 - DEBUG - Node anomaly scores shape: torch.Size([18473, 1])
2025-06-02 15:56:43,534 - DEBUG - Edge anomaly scores shape: torch.Size([38447, 1])
2025-06-02 15:56:43,535 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:43,707 - DEBUG - Step 49: Loss=0.6247
2025-06-02 15:56:43,708 - DEBUG - Online update step: 50/50
2025-06-02 15:56:43,711 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:43,799 - DEBUG - Node anomaly scores shape: torch.Size([17833, 1])
2025-06-02 15:56:43,803 - DEBUG - Edge anomaly scores shape: torch.Size([36993, 1])
2025-06-02 15:56:43,804 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:43,973 - DEBUG - Step 50: Loss=0.6369
2025-06-02 15:56:43,973 - INFO - Online update finished. Average loss: 0.6282, Learning rate: 0.001000
2025-06-02 15:56:43,974 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -2.0204965e-08 -2.0204965e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.5658847e-08
 -1.2122978e-08  2.3993396e-09 -1.9194717e-08 -3.0307445e-09
  2.3029661e+00  2.9618645e+00  1.3559322e-01  4.4152541e+00
 -3.7884307e-10  3.2870762e+00  5.8845339e+00  7.6080508e+00
  1.3559322e-01  7.9925847e+00 -2.2225461e-08 -6.0614891e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  8.0819857e-09 -2.0204965e-08], current edge mean: [-3.7509316e-09  4.5683286e+02  0.0000000e+00  0.0000000e+00
  1.8754658e-09 -9.3773289e-10 -4.6886641e-09 -4.6886641e-09
  0.0000000e+00  2.8131986e-09]
2025-06-02 15:56:43,974 - DEBUG - Node drift difference: 0.0128, Edge drift difference: 0.0012
2025-06-02 15:56:43,975 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -2.0204965e-08 -2.0204965e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.5658847e-08
 -1.2122978e-08  2.3993396e-09 -1.9194717e-08 -3.0307445e-09
  2.3029661e+00  2.9618645e+00  1.3559322e-01  4.4152541e+00
 -3.7884307e-10  3.2870762e+00  5.8845339e+00  7.6080508e+00
  1.3559322e-01  7.9925847e+00 -2.2225461e-08 -6.0614891e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  8.0819857e-09 -2.0204965e-08], edge=[-3.7509316e-09  4.5683286e+02  0.0000000e+00  0.0000000e+00
  1.8754658e-09 -9.3773289e-10 -4.6886641e-09 -4.6886641e-09
  0.0000000e+00  2.8131986e-09]
2025-06-02 15:56:43,976 - DEBUG - Updated reference std: node=[0.         0.         1.0005301  1.0005301  0.         0.
 0.         1.0005301  1.0005301  1.0005301  1.0005301  1.0005301
 1.0107334  0.27367172 0.36063462 0.5744843  1.0005301  2.9573143
 2.8775678  1.49335    0.36063462 0.22783059 1.0005301  1.0005301
 0.         0.         0.         0.         1.00053    1.00053   ], edge=[  1.0002459 452.46783     0.          0.          1.0002459   1.0002459
   1.0002459   1.0002459   1.0002459   1.0002459]
2025-06-02 15:56:43,976 - INFO - Online update complete. Loss: 0.6282
2025-06-02 15:56:43,976 - INFO - Running anomaly detection...
2025-06-02 15:56:43,976 - INFO - Starting anomaly detection.
2025-06-02 15:56:43,992 - DEBUG - Node reconstruction errors: [9.02768672e-02 1.38194931e+00 1.61151862e+00 4.24203509e-03
 2.18398590e-02 1.49679184e-02 5.63845932e-01 1.72025301e-02
 1.72025301e-02 2.29452625e-02 1.72024891e-02 1.55558940e-02
 1.39358735e+00 1.58021361e-01 2.79339100e-03 7.79941911e-03
 1.51153924e-02 7.79967476e-03 2.88601406e-02 7.67836440e-03
 1.74659118e-02 2.79338635e-03 3.55385765e-02 7.31351972e-03
 2.62287911e-03 4.53983573e-03 2.62287911e-03 4.02957797e-02
 1.65489838e-02 2.62287911e-03 9.40147266e-02 1.54453769e-01
 3.74228209e-02 4.61805752e-03 2.81905364e-02 2.46609412e-02
 7.14398697e-02 7.67836440e-03 7.11775646e-02 6.93725199e-02
 1.06747942e-02 2.83007044e-03 7.67836440e-03 1.51009094e-02
 1.23181224e-01 1.25948880e-02 1.98265426e-02 2.92791396e-01
 1.61270946e-02 1.21775791e-01 5.12238182e-02 7.07092602e-03
 4.47030179e-03 1.52328005e-02 1.93366017e-02 3.26787345e-02
 2.99100041e-01 8.06781929e-03 9.73042008e-03 1.53750544e-02
 1.28906175e-01 1.06630027e-02 2.62818974e-03 6.56862743e-03
 4.11299355e-02 1.93364974e-02 1.16802612e-02 1.93364713e-02
 2.62818974e-03 1.67719964e-02 2.11097877e-02 1.32479342e-02
 4.16123355e-03 3.68355438e-02 3.68232541e-02 1.29184024e-02
 2.64170170e-02 5.15368134e-02 1.39284367e-02 1.79955959e-02
 4.97142412e-03 1.44941863e-02 2.24408075e-01 2.34566908e-02
 1.90092977e-02 1.58748440e-02 3.74246910e-02 2.41150614e-02
 2.44928207e-02 1.38417080e-01 2.47365539e-03 3.67949829e-02
 6.76811161e-03 1.95536334e-02 1.12477960e-02 7.01990426e-02
 4.59233997e-03 1.63776148e-02 1.95091334e-03 2.69126389e-02
 8.88227765e-03 4.59233997e-03 1.07201934e-02 1.81625977e-01
 7.68402126e-03 1.47433877e-02 7.05179432e-03 1.87092982e-02
 7.25461449e-03 6.36315942e-02 8.78199786e-02 5.23240911e-03
 2.07701009e-02 4.27789204e-02 8.55773967e-03 8.18989985e-03
 8.07137415e-03 2.95291953e-02 1.76140312e-02 1.02566993e-02
 2.15874519e-03 7.08587980e-03 2.91850921e-02 8.09937064e-03
 2.18652729e-02 1.02565624e-02 9.21150669e-03 1.01120630e-02
 2.14948971e-02 6.62811054e-03 6.83378987e-03 4.78936592e-03
 1.16009161e-01 1.64780080e-01 7.31221400e-03 1.45460730e-02
 1.17152315e-02 2.28918320e-03 5.42660728e-02 2.53807437e-02
 1.12555940e-02 3.41122597e-02 2.12124898e-03 7.19865225e-03
 1.12556340e-02 2.56534498e-02 8.07185005e-03 3.94261442e-02
 9.61896870e-03 2.21525002e-02 2.07747430e-01 9.91214160e-03
 1.91751346e-02 4.78936592e-03 1.69076491e-02 2.78938301e-02
 3.98907298e-03 1.38186384e-02 8.88194144e-03 1.05612399e-02
 1.12556340e-02 7.27984589e-03 3.98907298e-03 6.83378987e-03
 7.55636161e-03 1.49980504e-02 8.93829670e-03 1.39301335e-02
 8.47064611e-03 2.21529268e-02 1.99777000e-02 1.01027843e-02
 2.75809038e-03 4.51896265e-02 1.76134631e-02 8.78554440e+00
 1.45948119e-02 3.26047055e-02 7.69168418e-03 7.69175030e-03
 1.48437647e-02 9.23009496e-03 1.51855759e-02 2.97824573e-02
 4.14048061e-02 1.39563624e-02 2.02218466e-03 1.21246409e-02
 1.46025438e-02 3.72257177e-03 2.00644732e-02 1.78131629e-02
 1.37430755e-02 4.96390602e-03 5.42639270e-02 5.08273067e-03
 2.33001396e-01 9.14751086e-03 3.23275290e-02 9.26609617e-03
 7.85873365e-03 3.98907298e-03 1.91757362e-02 2.46600676e-02
 1.78839248e-02 5.39506460e-03 2.06924323e-02 9.67556611e-02
 1.69886439e-03 1.72973853e-02 6.65427139e-03 2.57283188e-02
 5.08890487e-03 2.43156515e-02 1.58026870e-02 2.04181601e-03
 1.92944035e-02 8.07163958e-03 9.66651812e-02 4.96389670e-03
 2.80828737e-02 2.02218466e-03 2.66249105e-03 5.08888066e-03
 3.98907298e-03 3.23980190e-02 2.89133284e-02 5.63859288e-03
 1.87175870e-02 6.70550484e-03 5.13161300e-03 3.15003321e-02
 2.25429237e-02 8.07156321e-03 8.07153992e-03 5.52250538e-03
 1.82474591e-02 2.66250642e-03 3.98908369e-03 1.50753213e-02
 2.53387447e-02 2.47536171e-02 5.69681032e-03 2.04894170e-02
 5.37268305e-03 2.23857444e-02 1.03818811e-02 3.10322568e-02
 5.69682848e-03 1.07498998e-02 2.75808480e-03 2.33254419e-03
 9.66660529e-02 1.38807539e-02 2.16814354e-02 2.88843382e-02
 3.72257177e-03 1.42802112e-03 7.58952973e-03 7.69212656e-03
 1.72106437e-02 1.29155535e-02 7.60896178e-03 2.60570105e-02
 1.86104868e-02 1.27379121e-02 1.92692094e-02 7.42454976e-02
 1.92692373e-02 8.63051787e-03 4.66823131e-02 2.85508633e-02
 1.98583938e-02 2.49929149e-02 7.91059062e-03 6.09709248e-02
 9.08867456e-03 4.57895026e-02 1.48437377e-02 1.33310156e-02
 9.70885977e-02 9.74557362e-03 1.35254031e-02 1.19400853e-02
 3.39739136e-02 5.92832966e-03 1.11711517e-01 5.94880432e-03
 9.23009869e-03 4.22813930e-02 2.75882836e-02 4.89801355e-03
 3.77383716e-02 5.37268305e-03 1.19239129e-01 1.52047270e-03
 1.56680495e-02 7.69158127e-03 5.08273067e-03 6.66123852e-02
 1.43293673e-02 8.99723731e-03 7.36315222e-03 2.10942850e-02
 2.07153638e-03 2.07153638e-03 2.07153638e-03 8.27408396e-03
 5.95431169e-03 8.99723731e-03 2.07153917e-03 2.05520317e-02
 2.07153638e-03 3.43937101e-03 8.21391027e-03 1.78038906e-02
 1.36057794e-01 7.22405594e-03 4.98008542e-03 5.32036880e-03
 2.75231972e-02 2.43206378e-02 2.34003663e-02 7.36313872e-03
 1.94623787e-02 2.88989749e-02 1.09617330e-01 2.17822958e-02
 1.83764063e-02 1.83764435e-02 1.68060556e-01 4.93765716e-03
 2.07153638e-03 7.91069306e-03 2.07153638e-03 8.27415101e-03
 1.00175776e-02 2.22633779e-03 1.06442394e-02 1.81832584e-03
 8.99723731e-03 3.98713723e-03 1.81832584e-03 2.83154566e-02
 1.70749165e-02 1.92940477e-02 7.36323791e-03 5.60096232e-03
 1.75939258e-02 1.59839969e-02 2.07153917e-03 8.27759691e-03
 2.28517670e-02 3.31451744e-02 3.67043610e-03 3.72257177e-03
 8.99723731e-03 2.07153638e-03 2.16725538e-03 1.68666281e-02
 1.90594811e-02 3.36570945e-03 6.09632619e-02 2.83315685e-02
 7.36313406e-03 2.63332333e-02 2.19789403e-03 3.54460552e-02
 7.39750871e-03 6.18495746e-03 1.83866154e-02 2.37053242e-02
 2.70130169e-02 1.68086998e-02 1.81492213e-02 3.31451334e-02
 2.60069664e-03 4.67659347e-03 3.33629921e-02 2.07153638e-03
 7.36313546e-03 6.04300108e-03 3.91421886e-03 1.30475732e-02
 5.81889274e-03 1.61620397e-02 1.79697443e-02 1.10939043e-02
 2.08468717e-02 2.07153638e-03 6.56599179e-02 1.50760245e-02
 6.78194966e-03 3.31440791e-02 1.96823291e-02 1.96823049e-02
 1.96823049e-02 7.80595792e-03 1.99877517e-03 8.20972025e-03
 3.19138262e-03 3.48598547e-02 2.67834570e-02 1.99877238e-03
 7.00438023e-03 6.78199995e-03 2.54218746e-02 1.10914744e-02
 6.78194268e-03 1.97288953e-02 1.96823049e-02 6.78200880e-03
 1.99877517e-03 1.96823049e-02 1.96823049e-02 3.77385411e-03
 3.88281560e-03 1.96823049e-02 2.58477684e-03 3.60031659e-03
 1.07316710e-02 2.86258245e-03 6.32690731e-03 3.63516901e-03
 2.73678619e-02 1.10930987e-02 3.29754152e-03 1.21874968e-02
 8.18911381e-03 5.42134838e-03 1.61965806e-02 1.49348080e-02
 2.44622603e-02 2.67909188e-02 4.92220707e-02 1.96823049e-02
 3.19138984e-03 1.83707159e-02 2.73862183e-02 7.94504583e-03
 2.90245912e-03 4.23865765e-03 6.17319196e-02 1.74914801e-03
 4.28627618e-03 2.30109580e-02 3.59500088e-02 3.15639423e-03
 5.66678634e-03 3.73881962e-03 2.85039302e-02 2.46125157e-03
 4.22926573e-03 6.23493502e-03 2.46125623e-03 1.46684265e-02
 3.63516901e-03 4.81609954e-03 5.90860751e-03 1.77468769e-02
 7.05161504e-03 4.49546380e-03 3.40306666e-03 1.16201043e-02
 3.40306666e-03 4.49546380e-03 2.06816173e-03 1.03701744e-02
 5.94777474e-03 5.79080870e-03 2.06816173e-03 7.05153449e-03
 1.51468795e-02 4.17447165e-02 2.23001074e-02 6.32723700e-03
 1.03700114e-02 7.05167092e-03 2.07028701e-03 4.89127357e-03
 5.35396766e-03 7.89199173e-02 3.01162526e-03 3.15639423e-03
 2.75331531e-02 1.56649202e-03 2.46125623e-03 7.03054387e-03
 8.64937715e-03 4.17422317e-02 8.97507742e-03 2.07029446e-03
 1.29905976e-02 1.91752217e-03 1.85721349e-02 4.00036434e-03
 7.18579255e-03 2.74001863e-02 1.94671575e-03 4.89127357e-03
 5.87625057e-02 1.91752217e-03 4.45798971e-02 9.93088260e-03
 2.01229402e-03 7.77639868e-03 1.57270045e-03 1.21559359e-01
 3.22463200e-03 2.46125157e-03 6.31783484e-03 3.67935095e-03
 3.67935095e-03 1.73955888e-03 1.70295108e-02 2.43288535e-03
 1.57270045e-03 7.59534258e-03 1.13455104e-02 2.00083889e-02
 2.42601074e-02 4.23865765e-03 1.57270045e-03 1.66335907e-02
 2.01230985e-03 7.18591176e-03 6.26005325e-03 1.29108764e-02
 2.42606271e-02 1.95476301e-02 2.43288535e-03 2.04580147e-02
 1.94671575e-03 4.89125960e-03 7.18584470e-03 7.02063041e-03
 1.75384786e-02 1.99774913e-02 1.94671575e-03 2.13946942e-02
 1.94671575e-03 1.92234777e-02 8.19200743e-03 7.59540219e-03
 2.73401546e-03 2.88595390e-02 7.92358629e-03 1.91642565e-03
 1.72586054e-01 1.91642565e-03 1.91642565e-03 1.91642565e-03
 1.91642565e-03 1.91642565e-03 1.91642565e-03 1.91642565e-03
 8.70049931e-03 2.54727225e-03 8.56352318e-03 1.91642565e-03
 1.91642565e-03 1.91642565e-03 1.91642565e-03 1.91642565e-03
 1.91642565e-03 1.91642565e-03 1.91642565e-03 1.91642565e-03
 8.23971443e-03 1.91642565e-03 1.91642565e-03 4.74314243e-02
 1.91642565e-03 5.05569344e-03 8.69536772e-03 1.94671575e-03
 1.14365499e-02 2.80020647e-02 3.17635983e-02 3.17635983e-02
 1.99787598e-02 1.14365499e-02 1.94671575e-03 1.57270499e-03
 1.57270045e-03 1.94671575e-03 1.57270045e-03 6.11030776e-03
 1.01628983e-02 1.91642565e-03 4.23865765e-03 1.94671575e-03
 3.67935095e-03 1.94671575e-03 1.94671575e-03 7.58029334e-03
 1.94671575e-03 1.57270045e-03 1.94671575e-03 1.94671575e-03
 7.59505993e-03 1.57270045e-03 1.94671575e-03 1.57270045e-03
 1.94671575e-03 1.94671575e-03 1.94671575e-03 1.57355964e-02
 1.68727338e-02 6.63572224e-03 1.91642565e-03 1.56248771e-02
 9.36195441e-03 1.94671575e-03 1.57270045e-03 1.82451960e-02
 1.91642565e-03 7.32278638e-03 1.53531274e-02 1.31989713e-03
 1.94671575e-03 1.94671575e-03 8.50608014e-03 1.57889239e-02
 6.95704389e-03 1.94671575e-03 8.70051607e-03 1.18027278e-03
 1.57270499e-03 1.06205838e-02 1.91642565e-03 9.61854216e-03
 2.19051130e-02 1.91642565e-03 1.91642565e-03 8.70047696e-03
 1.18027278e-03 1.94671575e-03 8.22218955e-02 3.77442203e-02
 2.05766577e-02 1.57889239e-02 2.08844687e-03 1.84853561e-02
 1.84853561e-02 8.29318911e-03 1.76554942e-03 1.91642565e-03
 3.50496010e-03 2.49984264e-02 1.57889239e-02 7.21930573e-03
 1.99673558e-03 2.28367699e-03 1.91003340e-03 1.91003340e-03
 1.91003340e-03 1.91003340e-03 1.91003655e-03 8.44764803e-03
 2.49268431e-02 1.91003340e-03 1.91003340e-03 1.91642565e-03
 1.14960666e-03 1.91642565e-03 1.84853561e-02 1.58344973e-02
 3.43604200e-02 4.34445636e-03 2.18496285e-02 3.29173617e-02
 8.23969208e-03 7.81341735e-03 8.23971815e-03 1.91642565e-03
 1.84853561e-02 1.96655351e-03 1.54232373e-03 1.54232373e-03
 1.91003655e-03 1.96655607e-03 1.60873886e-02 6.02917606e-03
 1.81598857e-03 1.91642565e-03 1.91003655e-03 2.78454181e-03
 1.54232373e-03 1.16038555e-03 2.36425945e-03 2.50153313e-03
 8.44754372e-03 4.07478623e-02 1.26615691e-03 4.14424278e-02
 6.86151441e-03 2.36426690e-03 2.34876364e-03 1.92915078e-03
 2.33524805e-03 1.55628321e-03 1.76711679e-02 1.91084121e-03
 1.79378930e-02 2.36426690e-03 2.36426690e-03 2.36425945e-03
 1.97364087e-03 2.78456556e-03 2.36426690e-03 2.33524805e-03
 2.36426690e-03 2.36425945e-03 2.36425945e-03 7.43171573e-03
 1.92308135e-03 1.39700407e-02 2.21522488e-02 2.06182413e-02
 2.78174761e-03 3.59474774e-03 1.90559998e-02 1.75446104e-02
 2.32191104e-03 1.92878663e-03 1.50257745e-03 1.55293224e-02
 1.55293224e-02 2.33524805e-03 2.64778845e-02 7.03718886e-02
 2.31998530e-03 1.91384007e-03 7.08096800e-03 2.42175143e-02
 1.88662542e-03 1.88662542e-03 1.88662542e-03 1.82779692e-03
 1.84456853e-03 1.08132446e-02 1.97093375e-02 6.54922202e-02
 6.62475778e-03 1.52046978e-03 2.97305430e-03 1.91384007e-03
 2.64580897e-03 6.26471825e-03 1.91791728e-03 7.17404811e-03
 2.31999462e-03 7.03715384e-02 1.91384007e-03 6.26489194e-03
 1.52047386e-03 9.94350202e-03 1.88662542e-03 1.82779692e-03
 1.91791728e-03 3.44187766e-03 1.56100243e-02 1.82779692e-03
 1.82779692e-03 1.82780426e-03 1.36153344e-02 3.04588407e-01
 4.34804589e-01 1.88662542e-03 4.80371304e-02 1.82780426e-03
 2.05297992e-02 2.40329024e-03 2.22392324e-02 3.43727926e-03
 1.82779692e-03 1.76467979e-03 2.24526599e-03 2.19928613e-03
 1.20594949e-01 3.43727856e-03 4.82079498e-02 7.53613561e-03
 1.92276500e-02 3.43727926e-03 1.83492694e-02 1.58302840e-02
 6.08537253e-03 1.64241958e-02 8.82354379e-03 2.05099978e-03
 2.05100048e-03 5.19676805e-02 8.60691145e-02 1.24405771e-02
 3.43727204e-03 6.08537812e-03 3.43727204e-03 1.57524983e-03
 1.96453976e-03 1.96455396e-03 1.76709169e-03 2.48717405e-02
 1.65478874e-03 1.96453976e-03 1.57524983e-03 1.42530659e-02
 1.96455396e-03 1.96455396e-03 1.81160052e-03 8.81925412e-03
 2.09290553e-02 2.31126323e-02 1.96455396e-03 9.34067462e-03
 1.42530659e-02 1.96455396e-03 1.93282939e-03 2.07028352e-03
 1.58050389e-03 1.58049888e-03 1.35987550e-02 2.07028352e-03
 1.96455396e-03 2.07028771e-03 1.65200292e-03 2.76124552e-02
 1.95845440e-02 1.96453976e-03 7.89271817e-02 1.77076191e-03
 1.77076191e-03 8.81925412e-03 1.91934907e-03 3.13534145e-03
 1.93281507e-03 7.45835714e-03 1.66895578e-03 1.68052334e-02
 3.89688718e-03 1.68052334e-02 5.88437468e-02 1.57449767e-03
 3.89688718e-03 2.08026473e-03 2.08026473e-03 6.21855147e-02
 2.08026194e-03 8.72676633e-03 1.91934907e-03 1.70859694e-02
 3.02540301e-03 1.57448975e-03 3.02540301e-03 1.14897275e-02
 2.80571096e-02 1.04034012e-02 2.08026473e-03 8.22535995e-03
 8.16814229e-03 2.08026194e-03 1.65907387e-02 2.82934532e-02
 8.22535995e-03 1.57449767e-03 2.08026473e-03 7.20392317e-02
 2.08026473e-03 2.08026473e-03 2.08026194e-03 1.96244451e-03
 1.60040464e-02 1.96244824e-03 2.54770368e-03 1.96244451e-03
 1.72364414e-02 2.04023160e-02 2.79027820e-02 2.08026473e-03
 2.08026473e-03 1.84898649e-03 2.08026194e-03 2.48343393e-01
 2.54770298e-03 1.96244824e-03 1.84901210e-03 2.08026473e-03
 2.08026194e-03 2.83454126e-03 1.84901210e-03 2.08026473e-03
 1.82373414e-03 3.85260954e-03 1.88217382e-03 5.84786423e-02
 1.82373414e-03 2.08026473e-03 2.08026194e-03 3.39440932e-03
 1.93625111e-02 2.08081007e-02 2.08081007e-02 2.30399310e-03
 1.76104549e-02 1.09047610e-02 3.50317778e-03 2.13640794e-01
 2.08081268e-02 2.05857516e-03 2.08081007e-02 8.39960948e-03
 3.50317778e-03 2.08081268e-02 2.67881621e-03 1.88217382e-03
 4.69801854e-03 2.08574068e-03 2.35277810e-03 2.53727660e-03
 1.11507364e-02 2.54698819e-03 3.81032657e-03 3.81032145e-03
 3.02395932e-02 3.81032145e-03 3.81032657e-03 3.81032145e-03
 3.81032145e-03 3.54067013e-02 3.81032657e-03 3.81032145e-03
 3.81032657e-03 3.81032657e-03 3.81032145e-03 3.81032145e-03
 3.81032657e-03 3.81032145e-03 3.81032145e-03 6.18198840e-03
 3.81032145e-03 3.81032657e-03 3.81032145e-03 3.81032145e-03]
2025-06-02 15:56:43,992 - DEBUG - Edge reconstruction errors: [ 5.2643447  5.261712  44.258453  ... 13.358429   2.1586637 13.358429 ]
2025-06-02 15:56:43,994 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155643_update_43.json
2025-06-02 15:56:43,995 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:56:44,003 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155643_update_43.pth and as latest_checkpoint.pth
2025-06-02 15:56:44,003 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870385.dot): 0.5837
2025-06-02 15:56:44,003 - WARNING - Detected 4 anomalous nodes (reconstruction-based):
2025-06-02 15:56:44,004 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.3819, MLP Score: 0.5251
2025-06-02 15:56:44,004 - WARNING -   Node ID: 192.168.27.13, Recon Error: 1.6115, MLP Score: 0.5037
2025-06-02 15:56:44,004 - WARNING -   Node ID: 192.168.27.10, Recon Error: 1.3936, MLP Score: 0.5182
2025-06-02 15:56:44,004 - WARNING -   Node ID: 183.81.34.26, Recon Error: 8.7855, MLP Score: 0.5037
2025-06-02 15:56:44,004 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:56:44,004 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2584, MLP Score: 0.0658
2025-06-02 15:56:44,004 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9611, MLP Score: 0.0234
2025-06-02 15:56:44,004 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0607, MLP Score: 0.0234
2025-06-02 15:56:44,004 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7593, MLP Score: 0.0122
2025-06-02 15:56:44,004 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7588, MLP Score: 0.0110
2025-06-02 15:56:44,004 - INFO - 
--- Processing file: nw_graph_encoded_1748870415.dot (Timestamp: 2025-06-02 15:20:15) ---
2025-06-02 15:56:44,004 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870415.dot
2025-06-02 15:56:44,004 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870415.dot'.
2025-06-02 15:56:44,005 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870415.dot
2025-06-02 15:56:44,032 - INFO - Parsed 957 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870415.dot'.
2025-06-02 15:56:44,056 - INFO - Parsed 2059 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870415.dot'.
2025-06-02 15:56:44,056 - INFO - Processing node updates/additions.
2025-06-02 15:56:44,061 - INFO - Processing edge updates/additions.
2025-06-02 15:56:44,072 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:56:44,073 - INFO - Finished updating NetworkX graph.
2025-06-02 15:56:44,073 - DEBUG - Updated graph - Nodes: 957, Edges: 2059
2025-06-02 15:56:44,073 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:56:44,075 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:56:44,083 - DEBUG - Initial node features tensor shape: torch.Size([957, 30])
2025-06-02 15:56:44,084 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:56:44,085 - DEBUG - Node features tensor shape after scaling: torch.Size([957, 30])
2025-06-02 15:56:44,086 - DEBUG - Edge index tensor shape: torch.Size([2, 2059])
2025-06-02 15:56:44,087 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:56:44,091 - DEBUG - Initial edge attributes tensor shape: torch.Size([2059, 10])
2025-06-02 15:56:44,092 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:56:44,092 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2059, 10])
2025-06-02 15:56:44,092 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:56:44,092 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:56:44,093 - INFO - Updated main graph to 957 nodes and 2059 edges.
2025-06-02 15:56:44,093 - INFO - Performing online update...
2025-06-02 15:56:44,093 - INFO - Starting online update for 50 steps.
2025-06-02 15:56:44,093 - DEBUG - Updated RunningStats: new_mean=0.9441858395258845, new_var=60600000000162.08, new_n=6090
2025-06-02 15:56:44,093 - DEBUG - Updated RunningStats: new_mean=0.9431686217571654, new_var=60900000000017.94, new_n=6120
2025-06-02 15:56:44,094 - DEBUG - Updated RunningStats: new_mean=44.769369599975434, new_var=20200000187696.625, new_n=2030
2025-06-02 15:56:44,094 - DEBUG - Updated RunningStats: new_mean=44.77379204122814, new_var=20300000181398.68, new_n=2040
2025-06-02 15:56:44,094 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:56:44,094 - DEBUG - Online update step: 1/50
2025-06-02 15:56:44,096 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:44,172 - DEBUG - Node anomaly scores shape: torch.Size([17749, 1])
2025-06-02 15:56:44,176 - DEBUG - Edge anomaly scores shape: torch.Size([36928, 1])
2025-06-02 15:56:44,177 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:44,372 - DEBUG - Step 1: Loss=0.6164
2025-06-02 15:56:44,373 - DEBUG - Online update step: 2/50
2025-06-02 15:56:44,376 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:44,471 - DEBUG - Node anomaly scores shape: torch.Size([17222, 1])
2025-06-02 15:56:44,474 - DEBUG - Edge anomaly scores shape: torch.Size([35707, 1])
2025-06-02 15:56:44,475 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:44,607 - DEBUG - Step 2: Loss=0.6261
2025-06-02 15:56:44,607 - DEBUG - Online update step: 3/50
2025-06-02 15:56:44,610 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:44,695 - DEBUG - Node anomaly scores shape: torch.Size([17775, 1])
2025-06-02 15:56:44,703 - DEBUG - Edge anomaly scores shape: torch.Size([36765, 1])
2025-06-02 15:56:44,705 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:44,860 - DEBUG - Step 3: Loss=0.6354
2025-06-02 15:56:44,861 - DEBUG - Online update step: 4/50
2025-06-02 15:56:44,864 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:44,972 - DEBUG - Node anomaly scores shape: torch.Size([17726, 1])
2025-06-02 15:56:44,976 - DEBUG - Edge anomaly scores shape: torch.Size([36779, 1])
2025-06-02 15:56:44,977 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:45,125 - DEBUG - Step 4: Loss=0.6132
2025-06-02 15:56:45,126 - DEBUG - Online update step: 5/50
2025-06-02 15:56:45,129 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:45,238 - DEBUG - Node anomaly scores shape: torch.Size([19164, 1])
2025-06-02 15:56:45,242 - DEBUG - Edge anomaly scores shape: torch.Size([40028, 1])
2025-06-02 15:56:45,243 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:45,405 - DEBUG - Step 5: Loss=0.6281
2025-06-02 15:56:45,406 - DEBUG - Online update step: 6/50
2025-06-02 15:56:45,409 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:45,517 - DEBUG - Node anomaly scores shape: torch.Size([17269, 1])
2025-06-02 15:56:45,522 - DEBUG - Edge anomaly scores shape: torch.Size([35950, 1])
2025-06-02 15:56:45,523 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:45,655 - DEBUG - Step 6: Loss=0.6399
2025-06-02 15:56:45,655 - DEBUG - Online update step: 7/50
2025-06-02 15:56:45,658 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:45,748 - DEBUG - Node anomaly scores shape: torch.Size([18924, 1])
2025-06-02 15:56:45,756 - DEBUG - Edge anomaly scores shape: torch.Size([39690, 1])
2025-06-02 15:56:45,757 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:45,918 - DEBUG - Step 7: Loss=0.6176
2025-06-02 15:56:45,919 - DEBUG - Online update step: 8/50
2025-06-02 15:56:45,922 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:46,036 - DEBUG - Node anomaly scores shape: torch.Size([16196, 1])
2025-06-02 15:56:46,039 - DEBUG - Edge anomaly scores shape: torch.Size([33407, 1])
2025-06-02 15:56:46,041 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:46,174 - DEBUG - Step 8: Loss=0.6248
2025-06-02 15:56:46,175 - DEBUG - Online update step: 9/50
2025-06-02 15:56:46,178 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:46,305 - DEBUG - Node anomaly scores shape: torch.Size([19063, 1])
2025-06-02 15:56:46,310 - DEBUG - Edge anomaly scores shape: torch.Size([39947, 1])
2025-06-02 15:56:46,311 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:46,477 - DEBUG - Step 9: Loss=0.6345
2025-06-02 15:56:46,477 - DEBUG - Online update step: 10/50
2025-06-02 15:56:46,480 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:46,578 - DEBUG - Node anomaly scores shape: torch.Size([17499, 1])
2025-06-02 15:56:46,583 - DEBUG - Edge anomaly scores shape: torch.Size([36367, 1])
2025-06-02 15:56:46,584 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:46,738 - DEBUG - Step 10: Loss=0.6141
2025-06-02 15:56:46,738 - DEBUG - Online update step: 11/50
2025-06-02 15:56:46,741 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:46,853 - DEBUG - Node anomaly scores shape: torch.Size([19798, 1])
2025-06-02 15:56:46,863 - DEBUG - Edge anomaly scores shape: torch.Size([41455, 1])
2025-06-02 15:56:46,864 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:47,070 - DEBUG - Step 11: Loss=0.6254
2025-06-02 15:56:47,070 - DEBUG - Online update step: 12/50
2025-06-02 15:56:47,073 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:47,151 - DEBUG - Node anomaly scores shape: torch.Size([16216, 1])
2025-06-02 15:56:47,155 - DEBUG - Edge anomaly scores shape: torch.Size([33475, 1])
2025-06-02 15:56:47,156 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:47,329 - DEBUG - Step 12: Loss=0.6367
2025-06-02 15:56:47,329 - DEBUG - Online update step: 13/50
2025-06-02 15:56:47,335 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:47,417 - DEBUG - Node anomaly scores shape: torch.Size([16529, 1])
2025-06-02 15:56:47,420 - DEBUG - Edge anomaly scores shape: torch.Size([34086, 1])
2025-06-02 15:56:47,422 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:47,572 - DEBUG - Step 13: Loss=0.6147
2025-06-02 15:56:47,573 - DEBUG - Online update step: 14/50
2025-06-02 15:56:47,578 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:47,672 - DEBUG - Node anomaly scores shape: torch.Size([17408, 1])
2025-06-02 15:56:47,676 - DEBUG - Edge anomaly scores shape: torch.Size([36174, 1])
2025-06-02 15:56:47,677 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:47,859 - DEBUG - Step 14: Loss=0.6258
2025-06-02 15:56:47,860 - DEBUG - Online update step: 15/50
2025-06-02 15:56:47,866 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:47,977 - DEBUG - Node anomaly scores shape: torch.Size([18696, 1])
2025-06-02 15:56:47,981 - DEBUG - Edge anomaly scores shape: torch.Size([38974, 1])
2025-06-02 15:56:47,984 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:48,187 - DEBUG - Step 15: Loss=0.6353
2025-06-02 15:56:48,187 - DEBUG - Online update step: 16/50
2025-06-02 15:56:48,194 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:48,306 - DEBUG - Node anomaly scores shape: torch.Size([16890, 1])
2025-06-02 15:56:48,310 - DEBUG - Edge anomaly scores shape: torch.Size([34933, 1])
2025-06-02 15:56:48,311 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:48,509 - DEBUG - Step 16: Loss=0.6133
2025-06-02 15:56:48,509 - DEBUG - Online update step: 17/50
2025-06-02 15:56:48,516 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:48,609 - DEBUG - Node anomaly scores shape: torch.Size([17377, 1])
2025-06-02 15:56:48,613 - DEBUG - Edge anomaly scores shape: torch.Size([36126, 1])
2025-06-02 15:56:48,615 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:48,972 - DEBUG - Step 17: Loss=0.6271
2025-06-02 15:56:48,972 - DEBUG - Online update step: 18/50
2025-06-02 15:56:48,979 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:49,089 - DEBUG - Node anomaly scores shape: torch.Size([17886, 1])
2025-06-02 15:56:49,093 - DEBUG - Edge anomaly scores shape: torch.Size([37161, 1])
2025-06-02 15:56:49,094 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:49,254 - DEBUG - Step 18: Loss=0.6380
2025-06-02 15:56:49,255 - DEBUG - Online update step: 19/50
2025-06-02 15:56:49,259 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:49,401 - DEBUG - Node anomaly scores shape: torch.Size([17123, 1])
2025-06-02 15:56:49,416 - DEBUG - Edge anomaly scores shape: torch.Size([35454, 1])
2025-06-02 15:56:49,417 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:49,690 - DEBUG - Step 19: Loss=0.6174
2025-06-02 15:56:49,691 - DEBUG - Online update step: 20/50
2025-06-02 15:56:49,697 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:50,596 - DEBUG - Node anomaly scores shape: torch.Size([19544, 1])
2025-06-02 15:56:50,689 - DEBUG - Edge anomaly scores shape: torch.Size([41020, 1])
2025-06-02 15:56:50,747 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:52,287 - DEBUG - Step 20: Loss=0.6227
2025-06-02 15:56:52,288 - DEBUG - Online update step: 21/50
2025-06-02 15:56:52,295 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:53,424 - DEBUG - Node anomaly scores shape: torch.Size([18526, 1])
2025-06-02 15:56:53,488 - DEBUG - Edge anomaly scores shape: torch.Size([38682, 1])
2025-06-02 15:56:53,539 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:54,255 - DEBUG - Step 21: Loss=0.6334
2025-06-02 15:56:54,255 - DEBUG - Online update step: 22/50
2025-06-02 15:56:54,258 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:54,747 - DEBUG - Node anomaly scores shape: torch.Size([18668, 1])
2025-06-02 15:56:54,757 - DEBUG - Edge anomaly scores shape: torch.Size([39156, 1])
2025-06-02 15:56:54,758 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:55,164 - DEBUG - Step 22: Loss=0.6119
2025-06-02 15:56:55,164 - DEBUG - Online update step: 23/50
2025-06-02 15:56:55,169 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:55,253 - DEBUG - Node anomaly scores shape: torch.Size([18530, 1])
2025-06-02 15:56:55,258 - DEBUG - Edge anomaly scores shape: torch.Size([38636, 1])
2025-06-02 15:56:55,259 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:55,435 - DEBUG - Step 23: Loss=0.6261
2025-06-02 15:56:55,436 - DEBUG - Online update step: 24/50
2025-06-02 15:56:55,442 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:55,559 - DEBUG - Node anomaly scores shape: torch.Size([16227, 1])
2025-06-02 15:56:55,564 - DEBUG - Edge anomaly scores shape: torch.Size([33511, 1])
2025-06-02 15:56:55,565 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:55,767 - DEBUG - Step 24: Loss=0.6386
2025-06-02 15:56:55,768 - DEBUG - Online update step: 25/50
2025-06-02 15:56:55,774 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:55,865 - DEBUG - Node anomaly scores shape: torch.Size([17473, 1])
2025-06-02 15:56:55,870 - DEBUG - Edge anomaly scores shape: torch.Size([36445, 1])
2025-06-02 15:56:55,872 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:56,085 - DEBUG - Step 25: Loss=0.6160
2025-06-02 15:56:56,085 - DEBUG - Online update step: 26/50
2025-06-02 15:56:56,090 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:56,173 - DEBUG - Node anomaly scores shape: torch.Size([17979, 1])
2025-06-02 15:56:56,177 - DEBUG - Edge anomaly scores shape: torch.Size([37291, 1])
2025-06-02 15:56:56,178 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:56,358 - DEBUG - Step 26: Loss=0.6234
2025-06-02 15:56:56,358 - DEBUG - Online update step: 27/50
2025-06-02 15:56:56,362 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:56,457 - DEBUG - Node anomaly scores shape: torch.Size([17082, 1])
2025-06-02 15:56:56,463 - DEBUG - Edge anomaly scores shape: torch.Size([35345, 1])
2025-06-02 15:56:56,467 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:56,641 - DEBUG - Step 27: Loss=0.6339
2025-06-02 15:56:56,641 - DEBUG - Online update step: 28/50
2025-06-02 15:56:56,648 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:56,756 - DEBUG - Node anomaly scores shape: torch.Size([17489, 1])
2025-06-02 15:56:56,761 - DEBUG - Edge anomaly scores shape: torch.Size([36289, 1])
2025-06-02 15:56:56,762 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:56,990 - DEBUG - Step 28: Loss=0.6128
2025-06-02 15:56:56,991 - DEBUG - Online update step: 29/50
2025-06-02 15:56:56,997 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:57,102 - DEBUG - Node anomaly scores shape: torch.Size([18670, 1])
2025-06-02 15:56:57,108 - DEBUG - Edge anomaly scores shape: torch.Size([39174, 1])
2025-06-02 15:56:57,110 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:57,296 - DEBUG - Step 29: Loss=0.6250
2025-06-02 15:56:57,296 - DEBUG - Online update step: 30/50
2025-06-02 15:56:57,299 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:57,402 - DEBUG - Node anomaly scores shape: torch.Size([19081, 1])
2025-06-02 15:56:57,406 - DEBUG - Edge anomaly scores shape: torch.Size([39817, 1])
2025-06-02 15:56:57,407 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:57,584 - DEBUG - Step 30: Loss=0.6365
2025-06-02 15:56:57,584 - DEBUG - Online update step: 31/50
2025-06-02 15:56:57,588 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:57,684 - DEBUG - Node anomaly scores shape: torch.Size([17235, 1])
2025-06-02 15:56:57,689 - DEBUG - Edge anomaly scores shape: torch.Size([35597, 1])
2025-06-02 15:56:57,690 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:57,887 - DEBUG - Step 31: Loss=0.6157
2025-06-02 15:56:57,888 - DEBUG - Online update step: 32/50
2025-06-02 15:56:57,894 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:57,996 - DEBUG - Node anomaly scores shape: torch.Size([18091, 1])
2025-06-02 15:56:58,002 - DEBUG - Edge anomaly scores shape: torch.Size([37702, 1])
2025-06-02 15:56:58,004 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:58,214 - DEBUG - Step 32: Loss=0.6228
2025-06-02 15:56:58,215 - DEBUG - Online update step: 33/50
2025-06-02 15:56:58,222 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:58,330 - DEBUG - Node anomaly scores shape: torch.Size([19234, 1])
2025-06-02 15:56:58,335 - DEBUG - Edge anomaly scores shape: torch.Size([40119, 1])
2025-06-02 15:56:58,337 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:58,617 - DEBUG - Step 33: Loss=0.6321
2025-06-02 15:56:58,617 - DEBUG - Online update step: 34/50
2025-06-02 15:56:58,620 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:58,709 - DEBUG - Node anomaly scores shape: torch.Size([18265, 1])
2025-06-02 15:56:58,712 - DEBUG - Edge anomaly scores shape: torch.Size([38140, 1])
2025-06-02 15:56:58,713 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:58,919 - DEBUG - Step 34: Loss=0.6106
2025-06-02 15:56:58,919 - DEBUG - Online update step: 35/50
2025-06-02 15:56:58,923 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:59,030 - DEBUG - Node anomaly scores shape: torch.Size([17528, 1])
2025-06-02 15:56:59,036 - DEBUG - Edge anomaly scores shape: torch.Size([36560, 1])
2025-06-02 15:56:59,037 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:59,361 - DEBUG - Step 35: Loss=0.6252
2025-06-02 15:56:59,361 - DEBUG - Online update step: 36/50
2025-06-02 15:56:59,365 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:59,468 - DEBUG - Node anomaly scores shape: torch.Size([18308, 1])
2025-06-02 15:56:59,474 - DEBUG - Edge anomaly scores shape: torch.Size([38184, 1])
2025-06-02 15:56:59,475 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:56:59,748 - DEBUG - Step 36: Loss=0.6366
2025-06-02 15:56:59,748 - DEBUG - Online update step: 37/50
2025-06-02 15:56:59,751 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:56:59,846 - DEBUG - Node anomaly scores shape: torch.Size([17129, 1])
2025-06-02 15:56:59,852 - DEBUG - Edge anomaly scores shape: torch.Size([35526, 1])
2025-06-02 15:56:59,853 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:57:00,042 - DEBUG - Step 37: Loss=0.6150
2025-06-02 15:57:00,042 - DEBUG - Online update step: 38/50
2025-06-02 15:57:00,045 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:57:00,143 - DEBUG - Node anomaly scores shape: torch.Size([17949, 1])
2025-06-02 15:57:00,147 - DEBUG - Edge anomaly scores shape: torch.Size([37395, 1])
2025-06-02 15:57:00,148 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:57:00,337 - DEBUG - Step 38: Loss=0.6226
2025-06-02 15:57:00,337 - DEBUG - Online update step: 39/50
2025-06-02 15:57:00,340 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:57:00,445 - DEBUG - Node anomaly scores shape: torch.Size([18234, 1])
2025-06-02 15:57:00,450 - DEBUG - Edge anomaly scores shape: torch.Size([37873, 1])
2025-06-02 15:57:00,451 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:57:00,679 - DEBUG - Step 39: Loss=0.6338
2025-06-02 15:57:00,679 - DEBUG - Online update step: 40/50
2025-06-02 15:57:00,682 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:57:00,768 - DEBUG - Node anomaly scores shape: torch.Size([17098, 1])
2025-06-02 15:57:00,771 - DEBUG - Edge anomaly scores shape: torch.Size([35328, 1])
2025-06-02 15:57:00,772 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:57:00,973 - DEBUG - Step 40: Loss=0.6128
2025-06-02 15:57:00,974 - DEBUG - Online update step: 41/50
2025-06-02 15:57:00,977 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:57:01,072 - DEBUG - Node anomaly scores shape: torch.Size([18574, 1])
2025-06-02 15:57:01,077 - DEBUG - Edge anomaly scores shape: torch.Size([38834, 1])
2025-06-02 15:57:01,078 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:57:01,270 - DEBUG - Step 41: Loss=0.6233
2025-06-02 15:57:01,270 - DEBUG - Online update step: 42/50
2025-06-02 15:57:01,274 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:57:01,363 - DEBUG - Node anomaly scores shape: torch.Size([17490, 1])
2025-06-02 15:57:01,368 - DEBUG - Edge anomaly scores shape: torch.Size([36266, 1])
2025-06-02 15:57:01,369 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:57:01,554 - DEBUG - Step 42: Loss=0.6351
2025-06-02 15:57:01,554 - DEBUG - Online update step: 43/50
2025-06-02 15:57:01,557 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:57:01,658 - DEBUG - Node anomaly scores shape: torch.Size([17721, 1])
2025-06-02 15:57:01,663 - DEBUG - Edge anomaly scores shape: torch.Size([36801, 1])
2025-06-02 15:57:01,664 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:57:01,852 - DEBUG - Step 43: Loss=0.6139
2025-06-02 15:57:01,853 - DEBUG - Online update step: 44/50
2025-06-02 15:57:01,856 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:57:01,994 - DEBUG - Node anomaly scores shape: torch.Size([17583, 1])
2025-06-02 15:57:01,998 - DEBUG - Edge anomaly scores shape: torch.Size([36462, 1])
2025-06-02 15:57:01,999 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:57:02,205 - DEBUG - Step 44: Loss=0.6228
2025-06-02 15:57:02,206 - DEBUG - Online update step: 45/50
2025-06-02 15:57:02,210 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:57:02,311 - DEBUG - Node anomaly scores shape: torch.Size([17578, 1])
2025-06-02 15:57:02,317 - DEBUG - Edge anomaly scores shape: torch.Size([36453, 1])
2025-06-02 15:57:02,319 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:57:02,527 - DEBUG - Step 45: Loss=0.6328
2025-06-02 15:57:02,528 - DEBUG - Online update step: 46/50
2025-06-02 15:57:02,531 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:57:02,623 - DEBUG - Node anomaly scores shape: torch.Size([17885, 1])
2025-06-02 15:57:02,627 - DEBUG - Edge anomaly scores shape: torch.Size([37016, 1])
2025-06-02 15:57:02,628 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:57:02,829 - DEBUG - Step 46: Loss=0.6114
2025-06-02 15:57:02,829 - DEBUG - Online update step: 47/50
2025-06-02 15:57:02,832 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:57:02,928 - DEBUG - Node anomaly scores shape: torch.Size([15960, 1])
2025-06-02 15:57:02,933 - DEBUG - Edge anomaly scores shape: torch.Size([32867, 1])
2025-06-02 15:57:02,935 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:57:03,127 - DEBUG - Step 47: Loss=0.6249
2025-06-02 15:57:03,127 - DEBUG - Online update step: 48/50
2025-06-02 15:57:03,130 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:57:03,241 - DEBUG - Node anomaly scores shape: torch.Size([18529, 1])
2025-06-02 15:57:03,247 - DEBUG - Edge anomaly scores shape: torch.Size([38666, 1])
2025-06-02 15:57:03,248 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:57:03,497 - DEBUG - Step 48: Loss=0.6353
2025-06-02 15:57:03,497 - DEBUG - Online update step: 49/50
2025-06-02 15:57:03,504 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:57:03,597 - DEBUG - Node anomaly scores shape: torch.Size([17512, 1])
2025-06-02 15:57:03,601 - DEBUG - Edge anomaly scores shape: torch.Size([36418, 1])
2025-06-02 15:57:03,602 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:57:03,797 - DEBUG - Step 49: Loss=0.6138
2025-06-02 15:57:03,798 - DEBUG - Online update step: 50/50
2025-06-02 15:57:03,804 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:57:03,906 - DEBUG - Node anomaly scores shape: torch.Size([18526, 1])
2025-06-02 15:57:03,912 - DEBUG - Edge anomaly scores shape: torch.Size([38499, 1])
2025-06-02 15:57:03,913 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:57:04,137 - DEBUG - Step 50: Loss=0.6223
2025-06-02 15:57:04,138 - INFO - Online update finished. Average loss: 0.6245, Learning rate: 0.001000
2025-06-02 15:57:04,139 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  3.4130977e-08  7.4739365e-10
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.9860995e-09
 -5.9791492e-09  4.6089275e-09 -9.9652486e-10  1.4449611e-08
  2.2967608e+00  2.9623826e+00  1.3688610e-01  4.4158831e+00
 -1.6193530e-09  3.3009405e+00  5.8819227e+00  7.6133752e+00
  1.3688610e-01  7.9926853e+00 -1.1709168e-08 -2.1923547e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -4.9826244e-08], current edge mean: [-2.7790412e-09  4.5666489e+02  0.0000000e+00  0.0000000e+00
 -4.6317354e-09  0.0000000e+00  9.2634705e-10 -4.6317353e-10
 -6.6002230e-09  9.2634705e-10]
2025-06-02 15:57:04,139 - DEBUG - Node drift difference: 0.0061, Edge drift difference: 0.0004
2025-06-02 15:57:04,140 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  3.4130977e-08  7.4739365e-10
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.9860995e-09
 -5.9791492e-09  4.6089275e-09 -9.9652486e-10  1.4449611e-08
  2.2967608e+00  2.9623826e+00  1.3688610e-01  4.4158831e+00
 -1.6193530e-09  3.3009405e+00  5.8819227e+00  7.6133752e+00
  1.3688610e-01  7.9926853e+00 -1.1709168e-08 -2.1923547e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -4.9826244e-08], edge=[-2.7790412e-09  4.5666489e+02  0.0000000e+00  0.0000000e+00
 -4.6317354e-09  0.0000000e+00  9.2634705e-10 -4.6317353e-10
 -6.6002230e-09  9.2634705e-10]
2025-06-02 15:57:04,141 - DEBUG - Updated reference std: node=[0.         0.         1.0005229  1.0005229  0.         0.
 0.         1.0005229  1.0005229  1.0005229  1.0005229  1.0005229
 0.97763693 0.27184048 0.36169627 0.5735438  1.0005229  2.9591587
 2.8782218  1.4838562  0.36169627 0.22627786 1.0005229  1.0005229
 0.         0.         0.         0.         1.0005229  1.0005229 ], edge=[  1.000243  449.71378     0.          0.          1.0002428   1.000243
   1.000243    1.000243    1.000243    1.000243 ]
2025-06-02 15:57:04,144 - INFO - Online update complete. Loss: 0.6245
2025-06-02 15:57:04,144 - INFO - Running anomaly detection...
2025-06-02 15:57:04,145 - INFO - Starting anomaly detection.
2025-06-02 15:57:04,159 - DEBUG - Node reconstruction errors: [8.13272670e-02 8.44294846e-01 1.36041439e+00 3.94756254e-03
 2.30798610e-02 1.18384026e-02 3.94330770e-01 1.56028168e-02
 1.56028215e-02 2.02207491e-02 1.56028206e-02 1.50961550e-02
 1.03021789e+00 1.40365899e-01 1.87976228e-03 6.71489444e-03
 1.47194015e-02 6.71514636e-03 2.99492721e-02 6.56953221e-03
 1.57112163e-02 1.87975343e-03 3.04941181e-02 5.39561361e-03
 1.75962097e-03 3.71777569e-03 1.75961317e-03 3.99968065e-02
 1.51049159e-02 1.75961060e-03 1.22672118e-01 1.51691422e-01
 3.68111469e-02 3.53162480e-03 1.89020280e-02 4.01292816e-02
 6.89550340e-02 6.56951871e-03 6.83947578e-02 6.01068512e-02
 7.00780703e-03 1.64807425e-03 6.56951871e-03 1.03791598e-02
 1.29520983e-01 7.52184587e-03 1.53800715e-02 2.74065971e-01
 1.48341004e-02 9.93289277e-02 5.05480245e-02 5.53383538e-03
 3.46195186e-03 1.77481715e-02 1.58432666e-02 2.47828476e-02
 2.12360159e-01 6.78847590e-03 1.11447228e-02 1.39708351e-02
 1.29230902e-01 1.80764403e-02 1.44789543e-03 4.79209283e-03
 3.33404317e-02 1.58433318e-02 8.28705169e-03 1.58432517e-02
 1.44790160e-03 1.59740113e-02 1.73833054e-02 1.35370446e-02
 2.87674367e-03 2.69980803e-02 2.82247458e-02 1.37077803e-02
 1.88525598e-02 4.40896526e-02 1.05524566e-02 1.47939911e-02
 3.05283861e-03 1.58492420e-02 2.08335608e-01 1.12786945e-02
 1.41953360e-02 1.61393192e-02 3.46985608e-02 1.80089343e-02
 1.79843828e-02 1.38804913e-01 1.37852109e-03 3.84608880e-02
 5.65877138e-03 1.59704220e-02 7.70122837e-03 5.72006181e-02
 2.74325442e-03 1.17968572e-02 1.10753172e-03 2.44853180e-02
 8.59419908e-03 2.74324580e-03 6.63865311e-03 1.76230177e-01
 4.69548348e-03 1.35001419e-02 4.87726741e-03 1.74956042e-02
 5.80009026e-03 5.22032417e-02 8.01468343e-02 3.28132464e-03
 2.02496871e-02 3.40632796e-02 7.95529131e-03 5.93190873e-03
 7.28031714e-03 2.89374515e-02 1.21336747e-02 7.02733593e-03
 1.27377617e-03 6.92633819e-03 2.31943838e-02 5.76189673e-03
 1.61143355e-02 7.02730054e-03 6.45424146e-03 7.51892757e-03
 1.64843090e-02 5.40479599e-03 4.89913626e-03 3.22225015e-03
 1.09135710e-01 1.64709851e-01 6.28355145e-03 1.30069535e-02
 7.61933718e-03 1.16915489e-03 3.97360958e-02 4.02998440e-02
 9.52965301e-03 3.25206183e-02 1.40191859e-03 6.07539434e-03
 9.52907000e-03 2.29760036e-02 7.28009595e-03 2.72359774e-02
 9.42831859e-03 1.71167813e-02 1.93704739e-01 5.72433835e-03
 1.71926152e-02 3.22225294e-03 1.65729858e-02 3.36479656e-02
 2.68590753e-03 1.43490788e-02 8.59372038e-03 6.29008329e-03
 9.53073986e-03 4.78371978e-03 2.68591172e-03 4.89912741e-03
 7.19585130e-03 1.34146893e-02 8.69575236e-03 1.09102763e-02
 4.62103821e-03 1.71172246e-02 1.65479854e-02 6.93327049e-03
 1.43777137e-03 4.16004620e-02 1.21333320e-02 9.40493202e+00
 1.15081249e-02 2.89589483e-02 7.16628041e-03 7.16616446e-03
 1.37534169e-02 7.81451724e-03 1.30603230e-02 2.46597826e-02
 4.19580080e-02 1.01974094e-02 1.34673447e-03 1.20548690e-02
 1.32265091e-02 2.56382022e-03 2.62118150e-02 1.50800468e-02
 9.77145042e-03 3.10376217e-03 3.97396162e-02 3.23765073e-03
 2.12194860e-01 8.50993581e-03 1.70513503e-02 7.17231538e-03
 6.08643936e-03 2.68591545e-03 2.21385490e-02 1.96817257e-02
 1.24064414e-02 3.38761765e-03 1.78532992e-02 1.30808040e-01
 1.16931519e-03 1.52339349e-02 5.97477611e-03 1.97554473e-02
 3.30839562e-03 2.09460668e-02 1.20616797e-02 1.73730729e-03
 1.40426941e-02 7.28050712e-03 9.57868919e-02 3.10376193e-03
 2.42171809e-02 1.34673459e-03 1.36269035e-03 3.30839562e-03
 2.68591312e-03 2.54707690e-02 2.77245361e-02 3.45798279e-03
 1.53001305e-02 5.39843552e-03 2.91409180e-03 2.59103421e-02
 1.61780771e-02 7.28026032e-03 7.28046615e-03 4.82320227e-03
 1.47425849e-02 1.36268639e-03 2.68591102e-03 1.11920498e-02
 2.79223211e-02 1.79434903e-02 3.68010113e-03 1.53782219e-02
 3.32436315e-03 1.64662283e-02 1.08678071e-02 2.61802431e-02
 3.68009997e-03 7.66641321e-03 1.43777649e-03 1.29619578e-03
 9.57871228e-02 1.04848975e-02 1.56186512e-02 2.54810508e-02
 2.56348541e-03 1.25713204e-03 7.39649497e-03 7.16629717e-03
 1.46801909e-02 1.11940764e-02 5.28417109e-03 1.98436659e-02
 1.39353620e-02 8.76405556e-03 1.47841321e-02 6.75663576e-02
 1.47839980e-02 8.27200059e-03 3.88207883e-02 2.29992867e-02
 1.65170338e-02 1.74935069e-02 7.23361643e-03 5.54631129e-02
 7.26666115e-03 4.43661027e-02 1.37534160e-02 9.34124831e-03
 1.36642590e-01 7.75287487e-03 1.04002235e-02 7.05469539e-03
 2.57798824e-02 3.54453572e-03 1.28671527e-01 5.55115985e-03
 7.81450327e-03 3.63231227e-02 2.08953656e-02 3.16155353e-03
 3.61304507e-02 3.32436222e-03 1.04515880e-01 1.84129702e-03
 1.21168438e-02 7.16619613e-03 3.23756156e-03 6.10654913e-02
 1.12302480e-02 9.37533751e-03 6.27931859e-03 1.71796028e-02
 1.01746828e-03 1.01746537e-03 1.01746514e-03 7.57824490e-03
 6.71377871e-03 9.37530678e-03 1.01746514e-03 2.01496258e-02
 1.01746793e-03 2.46248767e-03 4.99550346e-03 1.45055419e-02
 1.32234514e-01 6.22959528e-03 3.25447787e-03 3.38192633e-03
 2.27171164e-02 1.91505160e-02 1.77378152e-02 6.27932278e-03
 1.70366447e-02 2.35383138e-02 1.13658428e-01 1.71479471e-02
 1.62332878e-02 1.62332635e-02 1.71589941e-01 3.15908995e-03
 1.01747294e-03 7.23362109e-03 1.01746991e-03 7.57828355e-03
 7.01958919e-03 1.21109583e-03 1.08046914e-02 1.02690340e-03
 9.37694870e-03 2.67642061e-03 1.02690549e-03 2.84722988e-02
 1.30198281e-02 1.40427733e-02 6.27929531e-03 3.47487396e-03
 1.33540994e-02 1.27512310e-02 1.01746689e-03 8.07380117e-03
 2.87754666e-02 3.08059920e-02 2.80895317e-03 2.56348099e-03
 1.10431360e-02 1.01746537e-03 1.07952149e-03 1.75019968e-02
 1.41836740e-02 3.02973646e-03 4.66520712e-02 2.30453424e-02
 6.27932372e-03 2.29862910e-02 1.17528997e-03 4.20031585e-02
 6.17353292e-03 4.44162078e-03 1.51620321e-02 1.89108718e-02
 2.04021074e-02 1.84226371e-02 1.34737846e-02 3.08062602e-02
 1.31438323e-03 3.45706358e-03 3.41113694e-02 1.01746537e-03
 6.27931673e-03 3.90553474e-03 2.81572668e-03 1.01108989e-02
 3.62456171e-03 1.29794832e-02 1.71780307e-02 8.29393882e-03
 1.98617000e-02 1.01746351e-03 6.50177374e-02 1.10584740e-02
 5.67249395e-03 2.44229157e-02 1.80137362e-02 1.80137698e-02
 1.80138256e-02 7.42831593e-03 9.79947159e-04 7.67017249e-03
 2.38055992e-03 3.44215967e-02 2.21982803e-02 9.79954959e-04
 6.01723883e-03 5.67244086e-03 2.07105372e-02 7.93705322e-03
 5.67248417e-03 1.72156803e-02 1.80138089e-02 5.67255681e-03
 9.79954028e-04 1.80137381e-02 1.80138219e-02 3.34793353e-03
 2.68074404e-03 1.80138107e-02 1.31443329e-03 3.72257573e-03
 7.78191304e-03 2.50890851e-03 4.49433364e-03 2.70865555e-03
 2.15957332e-02 8.01108219e-03 3.04633728e-03 8.68885592e-03
 7.61544891e-03 5.36561711e-03 1.22127188e-02 1.43736480e-02
 1.94619317e-02 2.19092648e-02 4.22788523e-02 1.80137586e-02
 2.38050870e-03 1.41247092e-02 2.17351206e-02 5.92690008e-03
 3.05590918e-03 3.31096747e-03 4.39935587e-02 1.20519707e-03
 4.35535330e-03 2.22159438e-02 4.03958224e-02 2.56713200e-03
 3.80666228e-03 2.75061489e-03 2.29021199e-02 1.20778952e-03
 2.96910643e-03 6.96328469e-03 1.20780850e-03 1.40782651e-02
 2.70833191e-03 4.38668625e-03 3.75757902e-03 1.42172473e-02
 5.52241551e-03 3.07758921e-03 2.66360398e-03 9.83943697e-03
 2.66404008e-03 3.07758851e-03 1.09678158e-03 6.81576412e-03
 3.81908473e-03 3.84988985e-03 1.09678158e-03 5.52230515e-03
 1.18049579e-02 3.73885706e-02 1.76289082e-02 4.49422840e-03
 6.81558717e-03 5.52245928e-03 1.07705244e-03 3.28950328e-03
 3.17033846e-03 8.26483220e-02 3.14976112e-03 2.56720046e-03
 2.06589196e-02 1.72800815e-03 1.20780850e-03 4.53862455e-03
 6.01201830e-03 3.77781317e-02 8.01251363e-03 1.07706571e-03
 1.04482612e-02 1.11642410e-03 1.67059284e-02 2.84617604e-03
 5.24253724e-03 3.17849591e-02 9.64717939e-04 3.28949536e-03
 4.31069918e-02 1.11641688e-03 3.10059581e-02 7.78573193e-03
 1.05693482e-03 6.58098469e-03 9.54612973e-04 1.44437730e-01
 2.96272128e-03 1.20780850e-03 5.71666099e-03 3.09368432e-03
 3.09372367e-03 1.42005726e-03 1.31201977e-02 2.56548007e-03
 9.54641029e-04 5.93561120e-03 6.99803932e-03 1.72670893e-02
 2.00683717e-02 3.31090786e-03 9.54609946e-04 1.22366166e-02
 1.05693983e-03 5.24257403e-03 4.56886133e-03 8.58304277e-03
 2.00680494e-02 1.53079266e-02 2.56548007e-03 1.73654314e-02
 9.64711362e-04 3.28949885e-03 5.24258707e-03 5.49242366e-03
 1.53618995e-02 1.54071050e-02 9.64709790e-04 1.80622377e-02
 9.64714098e-04 1.52888494e-02 6.91928016e-03 5.93561213e-03
 2.96054361e-03 2.36783829e-02 4.62436583e-03 9.71639529e-04
 1.66073799e-01 9.71635513e-04 9.71638307e-04 9.71629866e-04
 9.71633359e-04 9.71640169e-04 9.71639529e-04 9.71640169e-04
 7.05050491e-03 2.91580427e-03 6.01320062e-03 9.71636793e-04
 9.71639529e-04 9.71640169e-04 9.71639529e-04 9.71640169e-04
 9.71639529e-04 9.71639529e-04 9.71640169e-04 9.71639529e-04
 6.25519967e-03 9.71639180e-04 9.71639529e-04 4.38991860e-02
 9.71629866e-04 3.18118394e-03 5.99648338e-03 9.64717939e-04
 8.36810283e-03 2.33775675e-02 2.12490316e-02 2.12490316e-02
 1.56954341e-02 8.36810283e-03 9.64711362e-04 9.54610121e-04
 9.54610121e-04 9.64717939e-04 9.54610063e-04 4.13775537e-03
 7.17552193e-03 9.71660018e-04 3.31091788e-03 9.64717939e-04
 3.09373322e-03 9.64711362e-04 9.64714098e-04 5.66331204e-03
 9.64717939e-04 9.54610121e-04 9.64717939e-04 9.64717939e-04
 5.93560142e-03 9.54609946e-04 9.64717939e-04 9.54608724e-04
 9.64711362e-04 9.64717939e-04 9.64717939e-04 1.22580370e-02
 1.37929320e-02 4.35221801e-03 9.71639529e-04 1.55067202e-02
 6.05649641e-03 9.64717939e-04 9.54610354e-04 1.53148472e-02
 9.71639180e-04 5.57251787e-03 1.19982343e-02 1.04575907e-03
 9.64717939e-04 9.64717939e-04 7.12979399e-03 1.22878486e-02
 4.33365256e-03 9.64713283e-04 7.05051329e-03 1.49369834e-03
 9.54613322e-04 6.42430782e-03 9.71639529e-04 6.64241845e-03
 1.81548037e-02 9.71640169e-04 9.71635687e-04 7.05055101e-03
 1.49367738e-03 9.64711362e-04 6.99179843e-02 1.81975309e-02
 1.73887815e-02 1.22878682e-02 2.38510827e-03 1.59948841e-02
 1.59948785e-02 5.78579772e-03 1.70344487e-03 9.71639529e-04
 3.07780458e-03 2.14864500e-02 1.22877955e-02 5.00009116e-03
 2.08289828e-03 2.39336467e-03 1.00141705e-03 1.00141705e-03
 1.00141589e-03 1.00142125e-03 1.00141705e-03 6.40752865e-03
 2.10165326e-02 1.00141705e-03 1.00142218e-03 9.71629866e-04
 1.51574169e-03 9.71640169e-04 1.59948748e-02 2.65182517e-02
 3.15466076e-02 3.14340484e-03 1.82118919e-02 2.51052305e-02
 6.25515450e-03 5.90910995e-03 6.25518663e-03 9.71639471e-04
 1.59948859e-02 1.02850934e-03 9.79855191e-04 9.79854492e-04
 1.00141705e-03 1.02849281e-03 1.24527570e-02 6.22986816e-03
 2.76037795e-03 9.71639529e-04 1.00142125e-03 2.87196878e-03
 9.79840872e-04 1.25027797e-03 1.15960324e-03 2.70018936e-03
 6.40753377e-03 3.44374329e-02 1.06973585e-03 4.00238968e-02
 4.92676534e-03 1.15960569e-03 2.16163625e-03 9.89273540e-04
 1.15691847e-03 1.36649807e-03 1.52798556e-02 2.83231051e-03
 1.54913720e-02 1.15960918e-03 1.15959928e-03 1.15960825e-03
 1.03704131e-03 2.87195994e-03 1.15960918e-03 1.15695212e-03
 1.15959684e-03 1.15960918e-03 1.15961127e-03 5.72325010e-03
 9.31012852e-04 1.20162424e-02 1.85465291e-02 1.71095505e-02
 1.52200880e-02 3.52713512e-03 1.52148148e-02 1.29464278e-02
 1.13248080e-03 8.88120092e-04 1.27989554e-03 1.62695888e-02
 1.62696727e-02 1.15695212e-03 2.31035389e-02 7.24077746e-02
 1.13296811e-03 1.09861046e-03 6.70839055e-03 2.31104977e-02
 8.56501632e-04 8.56509258e-04 8.56509258e-04 1.13745709e-03
 9.46229033e-04 9.09945276e-03 1.85962152e-02 4.85210195e-02
 4.00312338e-03 1.14408729e-03 3.05156317e-03 1.09859486e-03
 2.41498486e-03 4.55468567e-03 1.01558887e-03 5.21646906e-03
 1.13296811e-03 7.24175870e-02 1.09859486e-03 4.55459813e-03
 1.14410545e-03 5.72121656e-03 8.56501632e-04 1.13745104e-03
 1.01558364e-03 3.15356697e-03 1.64181814e-02 1.13744917e-03
 1.13745709e-03 1.13745115e-03 7.43595418e-03 2.69421130e-01
 3.85425180e-01 8.56501632e-04 4.90077585e-02 1.13745860e-03
 1.74021311e-02 3.72655666e-03 2.66456176e-02 3.28050065e-03
 1.13745709e-03 1.22233771e-03 2.94263661e-03 1.04986341e-03
 1.12081029e-01 3.28146364e-03 4.20947820e-02 4.90688626e-03
 1.60637815e-02 3.28040658e-03 1.59721393e-02 1.66909900e-02
 4.46632644e-03 1.22472309e-02 7.68816518e-03 9.59608587e-04
 9.59613069e-04 5.09121306e-02 6.27334267e-02 6.37076749e-03
 3.28041636e-03 4.46631154e-03 3.28041706e-03 8.50419921e-04
 9.07882291e-04 9.07890615e-04 8.84411507e-04 2.08461974e-02
 1.15302438e-03 9.07889917e-04 8.50429409e-04 9.16244742e-03
 9.07889917e-04 9.07889917e-04 1.40765868e-03 6.78777229e-03
 1.78254060e-02 1.97138656e-02 9.07889917e-04 7.59413512e-03
 9.16243810e-03 9.07889917e-04 9.02483822e-04 2.23977119e-03
 9.56417876e-04 9.56419331e-04 7.23261479e-03 2.23978120e-03
 9.07882291e-04 2.23977817e-03 2.26555346e-03 2.32065134e-02
 1.81261636e-02 9.07882291e-04 7.05634058e-02 2.14158627e-03
 2.14157044e-03 6.78777741e-03 1.63654936e-03 2.83449423e-03
 9.02481086e-04 4.61879605e-03 8.13651306e-04 1.77552886e-02
 3.31622013e-03 1.77552607e-02 4.22528237e-02 8.51264980e-04
 3.31622292e-03 1.88164541e-03 1.88164541e-03 4.70821820e-02
 1.88165403e-03 7.85242859e-03 1.63655519e-03 1.83039010e-02
 3.17955320e-03 8.51252989e-04 3.17950500e-03 6.98785670e-03
 2.38457751e-02 8.53952300e-03 1.88164040e-03 5.24199847e-03
 6.32071681e-03 1.88164169e-03 1.22389141e-02 2.68107168e-02
 5.24199521e-03 8.51256133e-04 1.88164541e-03 5.88949211e-02
 1.88164541e-03 1.88163959e-03 1.88164972e-03 9.22892650e-04
 1.32336384e-02 9.22892184e-04 3.42413783e-03 9.22884443e-04
 1.38565134e-02 1.78034641e-02 2.43938882e-02 1.88165135e-03
 1.88164995e-03 2.22360436e-03 1.88164541e-03 2.24763229e-01
 3.42357159e-03 9.22900683e-04 2.22361740e-03 1.88165240e-03
 1.88164995e-03 4.21265047e-03 2.22360250e-03 1.88165135e-03
 1.85629970e-03 3.87261319e-03 9.50105838e-04 4.92400974e-02
 1.85630540e-03 1.88164681e-03 1.88165240e-03 3.18908715e-03
 1.66870337e-02 1.86100863e-02 1.86101291e-02 2.14869156e-03
 1.80409662e-02 8.62673577e-03 3.16162175e-03 2.10174292e-01
 1.86101031e-02 1.00334466e-03 1.86101217e-02 5.37290843e-03
 3.16161010e-03 1.86100956e-02 2.48873397e-03 9.50103684e-04
 3.74647137e-03 2.53736135e-03 1.15122413e-03 2.49236031e-03
 8.79654381e-03 1.41738413e-03 2.91984738e-03 2.91985413e-03
 2.44991779e-02 3.51943858e-02 2.91986112e-03 2.91984598e-03
 3.09219789e-02 3.49811167e-02 2.91984598e-03 2.91984598e-03
 2.91985227e-03 2.91984878e-03 2.91985227e-03 2.91984878e-03
 2.91985227e-03 2.91984878e-03 3.22996220e-03 5.28104743e-03
 2.91985227e-03 2.91985227e-03 2.91985227e-03 2.91984598e-03
 1.78350031e-01 1.13238506e-02 1.73426012e-03 5.28102135e-03
 1.42113445e-03 4.26104106e-03 4.26104851e-03 2.91985227e-03
 4.26104479e-03 4.26104944e-03 1.30236102e-02 3.94337401e-02
 3.94337401e-02]
2025-06-02 15:57:04,160 - DEBUG - Edge reconstruction errors: [ 5.263407  5.260819 44.25781  ... 13.357791  2.158215 13.357791]
2025-06-02 15:57:04,162 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155704_update_44.json
2025-06-02 15:57:04,162 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:57:04,173 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155704_update_44.pth and as latest_checkpoint.pth
2025-06-02 15:57:04,174 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870415.dot): 0.5647
2025-06-02 15:57:04,174 - WARNING - Detected 4 anomalous nodes (reconstruction-based):
2025-06-02 15:57:04,174 - WARNING -   Node ID: 192.168.239.101, Recon Error: 0.8443, MLP Score: 0.5117
2025-06-02 15:57:04,174 - WARNING -   Node ID: 192.168.27.13, Recon Error: 1.3604, MLP Score: 0.4794
2025-06-02 15:57:04,174 - WARNING -   Node ID: 192.168.27.10, Recon Error: 1.0302, MLP Score: 0.4981
2025-06-02 15:57:04,174 - WARNING -   Node ID: 183.81.34.26, Recon Error: 9.4049, MLP Score: 0.4794
2025-06-02 15:57:04,174 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:57:04,174 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2578, MLP Score: 0.9559
2025-06-02 15:57:04,174 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9604, MLP Score: 0.9918
2025-06-02 15:57:04,174 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0601, MLP Score: 0.9918
2025-06-02 15:57:04,174 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7588, MLP Score: 0.9915
2025-06-02 15:57:04,175 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7580, MLP Score: 0.9924
2025-06-02 15:57:04,175 - INFO - 
--- Processing file: nw_graph_encoded_1748870445.dot (Timestamp: 2025-06-02 15:20:45) ---
2025-06-02 15:57:04,175 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870445.dot
2025-06-02 15:57:04,175 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870445.dot'.
2025-06-02 15:57:04,175 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870445.dot
2025-06-02 15:57:04,204 - INFO - Parsed 962 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870445.dot'.
2025-06-02 15:57:04,229 - INFO - Parsed 2098 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870445.dot'.
2025-06-02 15:57:04,229 - INFO - Processing node updates/additions.
2025-06-02 15:57:04,235 - INFO - Processing edge updates/additions.
2025-06-02 15:57:04,246 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:57:04,247 - INFO - Finished updating NetworkX graph.
2025-06-02 15:57:04,247 - DEBUG - Updated graph - Nodes: 962, Edges: 2098
2025-06-02 15:57:04,247 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:57:04,248 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:57:04,257 - DEBUG - Initial node features tensor shape: torch.Size([962, 30])
2025-06-02 15:57:04,258 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:57:04,258 - DEBUG - Node features tensor shape after scaling: torch.Size([962, 30])
2025-06-02 15:57:04,260 - DEBUG - Edge index tensor shape: torch.Size([2, 2098])
2025-06-02 15:57:04,261 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:57:04,265 - DEBUG - Initial edge attributes tensor shape: torch.Size([2098, 10])
2025-06-02 15:57:04,266 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:57:04,266 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2098, 10])
2025-06-02 15:57:04,267 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:57:04,267 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:57:04,267 - INFO - Updated main graph to 962 nodes and 2098 edges.
2025-06-02 15:57:04,268 - INFO - Performing online update...
2025-06-02 15:57:04,268 - INFO - Starting online update for 50 steps.
2025-06-02 15:57:04,268 - DEBUG - Updated RunningStats: new_mean=0.9442132194315705, new_var=61200000000161.63, new_n=6150
2025-06-02 15:57:04,268 - DEBUG - Updated RunningStats: new_mean=0.9432129817161549, new_var=61500000000018.14, new_n=6180
2025-06-02 15:57:04,269 - DEBUG - Updated RunningStats: new_mean=44.77800531032785, new_var=20400000187457.848, new_n=2050
2025-06-02 15:57:04,269 - DEBUG - Updated RunningStats: new_mean=44.78035068847776, new_var=20500000178091.758, new_n=2060
2025-06-02 15:57:04,269 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:57:04,269 - DEBUG - Online update step: 1/50
2025-06-02 15:57:04,271 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:57:04,362 - DEBUG - Node anomaly scores shape: torch.Size([18400, 1])
2025-06-02 15:57:04,385 - DEBUG - Edge anomaly scores shape: torch.Size([38344, 1])
2025-06-02 15:57:04,390 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:57:04,624 - DEBUG - Step 1: Loss=0.6321
2025-06-02 15:57:04,624 - DEBUG - Online update step: 2/50
2025-06-02 15:57:04,627 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:57:04,725 - DEBUG - Node anomaly scores shape: torch.Size([16055, 1])
2025-06-02 15:57:04,731 - DEBUG - Edge anomaly scores shape: torch.Size([33102, 1])
2025-06-02 15:57:04,734 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:57:04,918 - DEBUG - Step 2: Loss=0.6116
2025-06-02 15:57:04,918 - DEBUG - Online update step: 3/50
2025-06-02 15:57:04,921 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:57:05,032 - DEBUG - Node anomaly scores shape: torch.Size([18532, 1])
2025-06-02 15:57:05,037 - DEBUG - Edge anomaly scores shape: torch.Size([38753, 1])
2025-06-02 15:57:05,038 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:57:05,231 - DEBUG - Step 3: Loss=0.6236
2025-06-02 15:57:05,231 - DEBUG - Online update step: 4/50
2025-06-02 15:57:05,235 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:57:05,342 - DEBUG - Node anomaly scores shape: torch.Size([18706, 1])
2025-06-02 15:57:05,347 - DEBUG - Edge anomaly scores shape: torch.Size([39236, 1])
2025-06-02 15:57:05,348 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:57:05,543 - DEBUG - Step 4: Loss=0.6333
2025-06-02 15:57:05,543 - DEBUG - Online update step: 5/50
2025-06-02 15:57:05,546 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:57:05,635 - DEBUG - Node anomaly scores shape: torch.Size([16368, 1])
2025-06-02 15:57:05,639 - DEBUG - Edge anomaly scores shape: torch.Size([33903, 1])
2025-06-02 15:57:05,640 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:57:05,834 - DEBUG - Step 5: Loss=0.6133
2025-06-02 15:57:05,835 - DEBUG - Online update step: 6/50
2025-06-02 15:57:05,838 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:57:05,933 - DEBUG - Node anomaly scores shape: torch.Size([18821, 1])
2025-06-02 15:57:05,937 - DEBUG - Edge anomaly scores shape: torch.Size([39211, 1])
2025-06-02 15:57:05,938 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:57:06,161 - DEBUG - Step 6: Loss=0.6222
2025-06-02 15:57:06,161 - DEBUG - Online update step: 7/50
2025-06-02 15:57:06,164 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:57:06,249 - DEBUG - Node anomaly scores shape: torch.Size([17477, 1])
2025-06-02 15:57:06,254 - DEBUG - Edge anomaly scores shape: torch.Size([36420, 1])
2025-06-02 15:57:06,255 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:57:06,446 - DEBUG - Step 7: Loss=0.6327
2025-06-02 15:57:06,446 - DEBUG - Online update step: 8/50
2025-06-02 15:57:06,450 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:57:06,556 - DEBUG - Node anomaly scores shape: torch.Size([20719, 1])
2025-06-02 15:57:06,561 - DEBUG - Edge anomaly scores shape: torch.Size([43394, 1])
2025-06-02 15:57:06,562 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:57:06,790 - DEBUG - Step 8: Loss=0.6104
2025-06-02 15:57:06,790 - DEBUG - Online update step: 9/50
2025-06-02 15:57:06,794 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:57:06,898 - DEBUG - Node anomaly scores shape: torch.Size([18697, 1])
2025-06-02 15:57:06,903 - DEBUG - Edge anomaly scores shape: torch.Size([39038, 1])
2025-06-02 15:57:06,904 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:57:07,098 - DEBUG - Step 9: Loss=0.6236
2025-06-02 15:57:07,098 - DEBUG - Online update step: 10/50
2025-06-02 15:57:07,101 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:57:07,218 - DEBUG - Node anomaly scores shape: torch.Size([18627, 1])
2025-06-02 15:57:07,224 - DEBUG - Edge anomaly scores shape: torch.Size([38974, 1])
2025-06-02 15:57:07,225 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:57:07,468 - DEBUG - Step 10: Loss=0.6351
2025-06-02 15:57:07,468 - DEBUG - Online update step: 11/50
2025-06-02 15:57:07,474 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:57:07,588 - DEBUG - Node anomaly scores shape: torch.Size([19318, 1])
2025-06-02 15:57:07,593 - DEBUG - Edge anomaly scores shape: torch.Size([40389, 1])
2025-06-02 15:57:07,595 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:57:07,817 - DEBUG - Step 11: Loss=0.6127
2025-06-02 15:57:07,817 - DEBUG - Online update step: 12/50
2025-06-02 15:57:07,820 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:57:07,911 - DEBUG - Node anomaly scores shape: torch.Size([18457, 1])
2025-06-02 15:57:07,916 - DEBUG - Edge anomaly scores shape: torch.Size([38594, 1])
2025-06-02 15:57:07,917 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
