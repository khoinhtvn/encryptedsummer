2025-06-04 11:15:25,727 - INFO - Application logging to file: logs/app_20250604_111525.log
2025-06-04 11:15:25,727 - INFO - Starting to monitor directory: /home/lu/Desktop/output/ with log level: DEBUG
2025-06-04 11:15:25,727 - INFO - Starting to monitor directory: /home/lu/Desktop/output/ for new and existing files every 30 seconds.
2025-06-04 11:15:25,727 - INFO - Train Mode: train, Visualization Path: vis
2025-06-04 11:15:25,727 - INFO - Found 42 files to process.
2025-06-04 11:15:25,727 - INFO - 
--- Processing file: nw_graph_encoded_1749028219.dot ---
2025-06-04 11:15:25,727 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028219.dot
2025-06-04 11:15:25,727 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028219.dot file.
2025-06-04 11:15:25,728 - INFO - Parsed 13 nodes.
2025-06-04 11:15:25,728 - INFO - Parsed 15 edges.
2025-06-04 11:15:25,729 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 11:15:25,729 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 11:15:25,729 - DEBUG - Initial node features tensor shape: torch.Size([13, 19])
2025-06-04 11:15:25,735 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 11:15:25,735 - DEBUG - Node features tensor shape after scaling: torch.Size([13, 19])
2025-06-04 11:15:25,737 - DEBUG - Edge index tensor shape: torch.Size([2, 15])
2025-06-04 11:15:25,737 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 11:15:25,737 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 2
2025-06-04 11:15:25,738 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 5
2025-06-04 11:15:25,739 - DEBUG - Shape of encoded categorical edge features: torch.Size([15, 2])
2025-06-04 11:15:25,740 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 11:15:25,740 - DEBUG - Shape of scaled numerical edge features: torch.Size([15, 20])
2025-06-04 11:15:25,740 - DEBUG - Final edge attributes tensor shape: torch.Size([15, 22])
2025-06-04 11:15:25,741 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 11:15:25,741 - INFO - Initializing HybridGNNAnomalyDetector with node_dim=19, edge_dim=22, hidden_dim=128, embedding_dim=64, heads=4, num_gat_layers=3, gat_heads=4, recon_loss_type=mse, edge_recon_loss_type=bce
2025-06-04 11:15:25,741 - INFO - Initializing GraphAutoencoder with node_dim=19, edge_dim=22, hidden_dim=128, embedding_dim=64, num_gat_layers=3, gat_heads=4, use_batch_norm=True, use_residual=True
2025-06-04 11:15:25,804 - DEBUG - Encoder GATConv layers initialized with final embedding dimension: 64
2025-06-04 11:15:25,807 - DEBUG - Decoder MLP layers initialized with proper weight initialization.
2025-06-04 11:15:25,810 - DEBUG - Anomaly scoring MLPs initialized.
2025-06-04 11:15:25,810 - INFO - Optimizer (AdamW) and scheduler (CosineAnnealingWarmRestarts) initialized.
2025-06-04 11:15:25,810 - INFO - Replay buffer initialized with maxlen=2000, batch_size=16
2025-06-04 11:15:25,810 - INFO - RunningStats initialized.
2025-06-04 11:15:25,810 - INFO - RunningStats initialized.
2025-06-04 11:15:25,811 - INFO - Statistical controls initialized: drift_threshold=0.15
2025-06-04 11:15:25,811 - INFO - Using device: cpu
2025-06-04 11:15:25,811 - INFO - Initialized Hybrid GNN (node_dim=19, edge_dim=22)
2025-06-04 11:15:25,863 - INFO - Checkpoint loaded from model_checkpoints/latest_checkpoint.pth at epoch 19
2025-06-04 11:15:25,863 - INFO - Resuming online updates from step: 19
2025-06-04 11:15:25,864 - INFO - Running statistics loaded from stats/running_stats.pkl
2025-06-04 11:15:25,864 - INFO - Performing online update...
2025-06-04 11:15:25,864 - INFO - Starting online update for 50 steps.
2025-06-04 11:15:25,865 - DEBUG - Updated RunningStats: new_mean=[ 5.29473132e-10 -5.13761003e-10 -2.16084471e-09  2.39810640e-09
 -2.73329564e-08  1.47036495e-08 -1.05765044e-08 -2.30255274e-09
 -3.08384690e-09  9.28083015e-10  1.64629383e-09 -1.63508613e-09
  4.04045084e-09 -3.46284331e-09  9.91273100e-10  9.24593284e-10
 -4.03121383e-09  1.47615326e-09 -5.31693324e-09], new_M2=[174503.00514984 174503.00507579 174503.00028056 174503.00397928
 174502.99872616 174502.99837532 174502.99618416 174502.99843915
 174502.99348019 174502.99833332 174503.00186068 174502.9939494
 174502.99275176 138897.99642043 138898.00024815 138897.99905218
 138898.0000499  174503.00043338 174503.00740827], new_n=174503
2025-06-04 11:15:25,866 - DEBUG - Updated RunningStats: new_mean=[ 1.41974426e+00  5.53135064e+00  1.18290692e-10  3.27858406e-10
  1.67904740e-10 -1.56126765e-10 -1.36169832e-09  2.99920933e-10
  3.77878865e-10 -3.16912211e-10  4.81713418e-10 -3.99821091e-09
 -8.78801799e-10  8.50217157e-10  4.18827398e-10 -1.71660739e-10
 -1.71660739e-10 -1.71660739e-10 -1.71660739e-10 -1.71660739e-10
 -1.71660739e-10 -6.53582326e-11], new_M2=[  96476.09050555 1665842.90242556  377567.99912404  377568.00680211
  377568.00563465  377567.9937755   377568.00029362  377567.9992378
  377568.00169069  377567.99936129  377567.99377292  377568.00893554
  377568.00114129  377567.99965734  377568.00194559  377567.99451418
  377567.99451418  377567.99451418  377567.99451418  377567.99451418
  377567.99451418  377567.99962862], new_n=377568
2025-06-04 11:15:25,866 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.00000001 0.99999998
 0.99999998 0.89216779 0.89216781 0.8921678  0.89216781 1.
 1.00000002]
2025-06-04 11:15:25,867 - DEBUG - Calculated standard deviation: [0.50548964 2.10048426 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 11:15:25,867 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 11:15:25,867 - DEBUG - Online update step: 1/50
2025-06-04 11:15:25,867 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,867 - DEBUG - Online update step: 2/50
2025-06-04 11:15:25,867 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,867 - DEBUG - Online update step: 3/50
2025-06-04 11:15:25,867 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,867 - DEBUG - Online update step: 4/50
2025-06-04 11:15:25,867 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,867 - DEBUG - Online update step: 5/50
2025-06-04 11:15:25,867 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,867 - DEBUG - Online update step: 6/50
2025-06-04 11:15:25,867 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,867 - DEBUG - Online update step: 7/50
2025-06-04 11:15:25,868 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,868 - DEBUG - Online update step: 8/50
2025-06-04 11:15:25,868 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,868 - DEBUG - Online update step: 9/50
2025-06-04 11:15:25,868 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,868 - DEBUG - Online update step: 10/50
2025-06-04 11:15:25,868 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,868 - DEBUG - Online update step: 11/50
2025-06-04 11:15:25,868 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,868 - DEBUG - Online update step: 12/50
2025-06-04 11:15:25,868 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,868 - DEBUG - Online update step: 13/50
2025-06-04 11:15:25,868 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,868 - DEBUG - Online update step: 14/50
2025-06-04 11:15:25,868 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,868 - DEBUG - Online update step: 15/50
2025-06-04 11:15:25,868 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,868 - DEBUG - Online update step: 16/50
2025-06-04 11:15:25,868 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,868 - DEBUG - Online update step: 17/50
2025-06-04 11:15:25,868 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,868 - DEBUG - Online update step: 18/50
2025-06-04 11:15:25,868 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,868 - DEBUG - Online update step: 19/50
2025-06-04 11:15:25,868 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,869 - DEBUG - Online update step: 20/50
2025-06-04 11:15:25,869 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,869 - DEBUG - Online update step: 21/50
2025-06-04 11:15:25,869 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,869 - DEBUG - Online update step: 22/50
2025-06-04 11:15:25,869 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,869 - DEBUG - Online update step: 23/50
2025-06-04 11:15:25,869 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,869 - DEBUG - Online update step: 24/50
2025-06-04 11:15:25,869 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,869 - DEBUG - Online update step: 25/50
2025-06-04 11:15:25,869 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,869 - DEBUG - Online update step: 26/50
2025-06-04 11:15:25,869 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,869 - DEBUG - Online update step: 27/50
2025-06-04 11:15:25,869 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,869 - DEBUG - Online update step: 28/50
2025-06-04 11:15:25,869 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,869 - DEBUG - Online update step: 29/50
2025-06-04 11:15:25,869 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,869 - DEBUG - Online update step: 30/50
2025-06-04 11:15:25,869 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,869 - DEBUG - Online update step: 31/50
2025-06-04 11:15:25,869 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,869 - DEBUG - Online update step: 32/50
2025-06-04 11:15:25,869 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,870 - DEBUG - Online update step: 33/50
2025-06-04 11:15:25,870 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,870 - DEBUG - Online update step: 34/50
2025-06-04 11:15:25,870 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,870 - DEBUG - Online update step: 35/50
2025-06-04 11:15:25,870 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,870 - DEBUG - Online update step: 36/50
2025-06-04 11:15:25,870 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,870 - DEBUG - Online update step: 37/50
2025-06-04 11:15:25,870 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,870 - DEBUG - Online update step: 38/50
2025-06-04 11:15:25,870 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,870 - DEBUG - Online update step: 39/50
2025-06-04 11:15:25,870 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,870 - DEBUG - Online update step: 40/50
2025-06-04 11:15:25,870 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,870 - DEBUG - Online update step: 41/50
2025-06-04 11:15:25,870 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,870 - DEBUG - Online update step: 42/50
2025-06-04 11:15:25,870 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,870 - DEBUG - Online update step: 43/50
2025-06-04 11:15:25,870 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,870 - DEBUG - Online update step: 44/50
2025-06-04 11:15:25,870 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,870 - DEBUG - Online update step: 45/50
2025-06-04 11:15:25,870 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,871 - DEBUG - Online update step: 46/50
2025-06-04 11:15:25,871 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,871 - DEBUG - Online update step: 47/50
2025-06-04 11:15:25,871 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,871 - DEBUG - Online update step: 48/50
2025-06-04 11:15:25,871 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,871 - DEBUG - Online update step: 49/50
2025-06-04 11:15:25,871 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,871 - DEBUG - Online update step: 50/50
2025-06-04 11:15:25,871 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:25,871 - WARNING - No successful steps during online update.
2025-06-04 11:15:25,879 - DEBUG - Current node mean: [-9.1699457e-09  9.1699457e-09  9.1699457e-09  0.0000000e+00
 -9.1699457e-09  9.1699457e-09 -2.7509836e-08  9.1699457e-09
 -3.4387295e-09  0.0000000e+00  9.1699457e-09 -9.1699457e-09
  9.1699457e-09  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  1.3754918e-08  9.1699457e-09], current edge mean: [ 2.0000000e-01  2.2000000e+00 -1.5894573e-08 -7.9472864e-09
  1.9868216e-09 -1.1920929e-08  1.5894573e-08  0.0000000e+00
  1.1920929e-08  1.5894573e-08  2.3841858e-08  1.1920929e-08
  3.9736432e-09 -2.3841858e-08  7.9472864e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  3.9736432e-09]
2025-06-04 11:15:25,879 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 2.4130
2025-06-04 11:15:25,879 - WARNING - Feature drift detected (1 consecutive)
2025-06-04 11:15:25,880 - DEBUG - Updated reference mean: node=[-9.1699457e-09  9.1699457e-09  9.1699457e-09  0.0000000e+00
 -9.1699457e-09  9.1699457e-09 -2.7509836e-08  9.1699457e-09
 -3.4387295e-09  0.0000000e+00  9.1699457e-09 -9.1699457e-09
  9.1699457e-09  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  1.3754918e-08  9.1699457e-09], edge=[ 2.0000000e-01  2.2000000e+00 -1.5894573e-08 -7.9472864e-09
  1.9868216e-09 -1.1920929e-08  1.5894573e-08  0.0000000e+00
  1.1920929e-08  1.5894573e-08  2.3841858e-08  1.1920929e-08
  3.9736432e-09 -2.3841858e-08  7.9472864e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  3.9736432e-09]
2025-06-04 11:15:25,880 - DEBUG - Updated reference std: node=[1.040833 1.040833 1.040833 1.040833 1.040833 1.040833 1.040833 1.040833
 1.040833 1.040833 1.040833 1.040833 1.040833 0.       0.       0.
 0.       1.040833 1.040833], edge=[0.41403934 1.6124516  1.0350983  1.0350983  1.0350983  1.0350983
 1.0350983  1.0350983  1.0350983  1.0350983  1.0350983  1.0350983
 1.0350983  1.0350983  1.0350983  1.0350983  1.0350983  1.0350983
 1.0350983  1.0350983  1.0350983  1.0350983 ]
2025-06-04 11:15:25,880 - INFO - Online update complete. Loss: 0.0000
2025-06-04 11:15:25,880 - INFO - Running anomaly detection...
2025-06-04 11:15:25,881 - INFO - Starting anomaly detection.
2025-06-04 11:15:26,365 - DEBUG - Node reconstruction errors: [0.15702763 0.1432931  0.1432931  0.15702763 0.27929494 0.29853335
 1.963739   0.32412487 0.1432931  0.14329308 1.0905453  0.1432931
 1.5941739 ]
2025-06-04 11:15:26,365 - DEBUG - Edge reconstruction errors: [0.19999212 0.19998842 0.19999999 0.19999999 0.19999999 0.19999987
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999987 0.19999748
 0.19999737 0.19999784 0.19999999]
2025-06-04 11:15:26,438 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_111526_update_1.json
2025-06-04 11:15:26,439 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 11:15:26,464 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_111526_update_1.pth and as latest_checkpoint.pth
2025-06-04 11:15:26,464 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028219.dot): 1.0000
2025-06-04 11:15:26,464 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-04 11:15:26,464 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 11:15:26,834 - INFO - Starting 3D embedding visualization...
2025-06-04 11:15:26,836 - ERROR - Error during 3D t-SNE or plotting: perplexity must be less than n_samples
2025-06-04 11:15:26,838 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 46, in visualize_embeddings_3d
    reduced_embeddings = tsne.fit_transform(embeddings)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/sklearn/utils/_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/sklearn/manifold/_t_sne.py", line 1177, in fit_transform
    self._check_params_vs_input(X)
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/sklearn/manifold/_t_sne.py", line 862, in _check_params_vs_input
    raise ValueError("perplexity must be less than n_samples")
ValueError: perplexity must be less than n_samples

2025-06-04 11:15:26,838 - INFO - Performing visualization of node and edge features.
2025-06-04 11:15:26,838 - INFO - Starting visualization of node features.
2025-06-04 11:15:26,839 - INFO - Graph has 13 nodes and 19 features.
2025-06-04 11:15:26,839 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, http_ratio, ssl_ratio
2025-06-04 11:15:26,839 - INFO - Calculating feature statistics:
2025-06-04 11:15:26,840 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 2, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.5477226), 'max': np.float32(1.8257419)}
2025-06-04 11:15:26,840 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 2, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.8257419), 'max': np.float32(0.5477226)}
2025-06-04 11:15:26,840 - INFO - - server_score: {'name': 'server_score', 'unique': 4, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.4013742), 'max': np.float32(2.4682057)}
2025-06-04 11:15:26,840 - INFO - - client_score: {'name': 'client_score', 'unique': 4, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.51907015), 'max': np.float32(2.5818622)}
2025-06-04 11:15:26,840 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 2, 'mean': np.float32(1.8339891e-08), 'std': np.float32(1.0), 'min': np.float32(-0.42640144), 'max': np.float32(2.345208)}
2025-06-04 11:15:26,843 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 3, 'mean': np.float32(3.6679783e-08), 'std': np.float32(1.0), 'min': np.float32(-0.42617667), 'max': np.float32(2.4267406)}
2025-06-04 11:15:26,843 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 3, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.503131), 'max': np.float32(0.42553222)}
2025-06-04 11:15:26,843 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 3, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.4602873), 'max': np.float32(3.1299536)}
2025-06-04 11:15:26,843 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 3, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.89260745), 'max': np.float32(3.2516413)}
2025-06-04 11:15:26,843 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 4, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.5204165), 'max': np.float32(2.6020825)}
2025-06-04 11:15:26,843 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 3, 'mean': np.float32(-9.169946e-09), 'std': np.float32(1.0), 'min': np.float32(-1.7344548), 'max': np.float32(0.63900965)}
2025-06-04 11:15:26,843 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 2, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.5477226), 'max': np.float32(1.8257419)}
2025-06-04 11:15:26,843 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 2, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.8257419), 'max': np.float32(0.5477226)}
2025-06-04 11:15:26,844 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-04 11:15:26,844 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-04 11:15:26,844 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-04 11:15:26,844 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-04 11:15:26,844 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 5, 'mean': np.float32(-1.432804e-09), 'std': np.float32(0.9999999), 'min': np.float32(-1.9622618), 'max': np.float32(0.6965064)}
2025-06-04 11:15:26,844 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 5, 'mean': np.float32(9.169946e-09), 'std': np.float32(1.0), 'min': np.float32(-1.2277385), 'max': np.float32(1.7117991)}
2025-06-04 11:15:26,854 - DEBUG - Loaded backend module://backend_interagg version unknown.
2025-06-04 11:15:26,888 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7ed12526d100>
2025-06-04 11:15:27,038 - DEBUG - Plotted correlation matrix of node features.
2025-06-04 11:15:27,105 - DEBUG - Plotted ranges of node feature values.
2025-06-04 11:15:27,150 - DEBUG - Plotted sparsity of node features.
2025-06-04 11:15:28,519 - INFO - Node feature visualization saved to vis/node_features_20250604_111527.png
2025-06-04 11:15:28,520 - INFO - Finished visualization of node features.
2025-06-04 11:15:28,520 - INFO - Performing additional feature analysis:
2025-06-04 11:15:28,520 - INFO - - Maximum correlation between different features: nan
2025-06-04 11:15:28,520 - INFO - Starting visualization of edge features.
2025-06-04 11:15:28,520 - INFO - Graph has 15 edges and 22 edge features.
2025-06-04 11:15:28,520 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-04 11:15:28,520 - ERROR - Error during 2D feature visualization: Expected 22 names, got 10
2025-06-04 11:15:28,522 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 491, in monitor_new_files
    visualize_edge_features(main_data, save_path=visualization_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/visualization.py", line 197, in visualize_edge_features
    raise ValueError(f"Expected {num_features} names, got {len(edge_feature_names)}")
ValueError: Expected 22 names, got 10

2025-06-04 11:15:28,522 - INFO - 
--- Processing file: nw_graph_encoded_1749028234.dot ---
2025-06-04 11:15:28,522 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028234.dot
2025-06-04 11:15:28,522 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028234.dot file.
2025-06-04 11:15:28,523 - INFO - Parsed 19 nodes.
2025-06-04 11:15:28,523 - INFO - Parsed 25 edges.
2025-06-04 11:15:28,524 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 11:15:28,524 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 11:15:28,525 - DEBUG - Initial node features tensor shape: torch.Size([19, 19])
2025-06-04 11:15:28,525 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 11:15:28,526 - DEBUG - Node features tensor shape after scaling: torch.Size([19, 19])
2025-06-04 11:15:28,526 - DEBUG - Edge index tensor shape: torch.Size([2, 25])
2025-06-04 11:15:28,526 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 11:15:28,526 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 2
2025-06-04 11:15:28,527 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 5
2025-06-04 11:15:28,527 - DEBUG - Shape of encoded categorical edge features: torch.Size([25, 2])
2025-06-04 11:15:28,527 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 11:15:28,528 - DEBUG - Shape of scaled numerical edge features: torch.Size([25, 20])
2025-06-04 11:15:28,528 - DEBUG - Final edge attributes tensor shape: torch.Size([25, 22])
2025-06-04 11:15:28,528 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 11:15:28,528 - INFO - Performing online update...
2025-06-04 11:15:28,528 - INFO - Starting online update for 50 steps.
2025-06-04 11:15:28,528 - DEBUG - Updated RunningStats: new_mean=[ 5.30610847e-10 -5.14729663e-10 -2.16020389e-09  2.39682072e-09
 -2.73299807e-08  1.46993165e-08 -1.05774021e-08 -2.30409510e-09
 -3.08558169e-09  9.28152742e-10  1.64867608e-09 -1.63320046e-09
  4.04001096e-09 -3.46246631e-09  9.91165181e-10  9.24492625e-10
 -4.03077496e-09  1.47633408e-09 -5.31550057e-09], new_M2=[174522.00515219 174522.00507815 174522.00028152 174522.00397869
 174521.99872548 174521.9983747  174521.99618594 174521.99843916
 174521.99348021 174521.99833384 174522.00185872 174521.99395017
 174521.99275108 138897.99642043 138898.00024815 138897.99905218
 138898.0000499  174522.00043374 174522.00740956], new_n=174522
2025-06-04 11:15:28,529 - DEBUG - Updated RunningStats: new_mean=[ 1.41966085e+00  5.53115391e+00  1.18036213e-10  3.28098145e-10
  1.67543384e-10 -1.55692194e-10 -1.36205521e-09  2.99348586e-10
  3.77952505e-10 -3.16516325e-10  4.81010644e-10 -3.99861707e-09
 -8.78378577e-10  8.50634428e-10  4.17852542e-10 -1.71099967e-10
 -1.71099967e-10 -1.71099967e-10 -1.71099967e-10 -1.71099967e-10
 -1.71099967e-10 -6.53341736e-11], new_M2=[  96519.12176868 1666123.77092799  377592.99912419  377593.00680184
  377593.00563351  377592.99377574  377593.00029395  377592.99923696
  377593.00169046  377592.99936181  377592.993772    377593.00893662
  377593.00114067  377592.99965613  377593.00194525  377592.99451422
  377592.99451422  377592.99451422  377592.99451422  377592.99451422
  377592.99451422  377592.99962886], new_n=377593
2025-06-04 11:15:28,529 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.00000001 0.99999998
 0.99999998 0.89211923 0.89211924 0.89211924 0.89211924 1.
 1.00000002]
2025-06-04 11:15:28,529 - DEBUG - Calculated standard deviation: [0.50558562 2.10059179 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 11:15:28,529 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 11:15:28,529 - DEBUG - Online update step: 1/50
2025-06-04 11:15:28,529 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,530 - DEBUG - Online update step: 2/50
2025-06-04 11:15:28,530 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,530 - DEBUG - Online update step: 3/50
2025-06-04 11:15:28,530 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,530 - DEBUG - Online update step: 4/50
2025-06-04 11:15:28,530 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,530 - DEBUG - Online update step: 5/50
2025-06-04 11:15:28,530 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,530 - DEBUG - Online update step: 6/50
2025-06-04 11:15:28,530 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,530 - DEBUG - Online update step: 7/50
2025-06-04 11:15:28,530 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,530 - DEBUG - Online update step: 8/50
2025-06-04 11:15:28,530 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,530 - DEBUG - Online update step: 9/50
2025-06-04 11:15:28,530 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,530 - DEBUG - Online update step: 10/50
2025-06-04 11:15:28,530 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,530 - DEBUG - Online update step: 11/50
2025-06-04 11:15:28,530 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,530 - DEBUG - Online update step: 12/50
2025-06-04 11:15:28,530 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,530 - DEBUG - Online update step: 13/50
2025-06-04 11:15:28,530 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,530 - DEBUG - Online update step: 14/50
2025-06-04 11:15:28,530 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,530 - DEBUG - Online update step: 15/50
2025-06-04 11:15:28,530 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,530 - DEBUG - Online update step: 16/50
2025-06-04 11:15:28,531 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,531 - DEBUG - Online update step: 17/50
2025-06-04 11:15:28,531 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,531 - DEBUG - Online update step: 18/50
2025-06-04 11:15:28,531 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,531 - DEBUG - Online update step: 19/50
2025-06-04 11:15:28,531 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,531 - DEBUG - Online update step: 20/50
2025-06-04 11:15:28,531 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,531 - DEBUG - Online update step: 21/50
2025-06-04 11:15:28,531 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,531 - DEBUG - Online update step: 22/50
2025-06-04 11:15:28,531 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,531 - DEBUG - Online update step: 23/50
2025-06-04 11:15:28,531 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,531 - DEBUG - Online update step: 24/50
2025-06-04 11:15:28,531 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,531 - DEBUG - Online update step: 25/50
2025-06-04 11:15:28,531 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,531 - DEBUG - Online update step: 26/50
2025-06-04 11:15:28,531 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,531 - DEBUG - Online update step: 27/50
2025-06-04 11:15:28,532 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,532 - DEBUG - Online update step: 28/50
2025-06-04 11:15:28,532 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,532 - DEBUG - Online update step: 29/50
2025-06-04 11:15:28,532 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,532 - DEBUG - Online update step: 30/50
2025-06-04 11:15:28,532 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,532 - DEBUG - Online update step: 31/50
2025-06-04 11:15:28,532 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,532 - DEBUG - Online update step: 32/50
2025-06-04 11:15:28,532 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,532 - DEBUG - Online update step: 33/50
2025-06-04 11:15:28,532 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,532 - DEBUG - Online update step: 34/50
2025-06-04 11:15:28,532 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,532 - DEBUG - Online update step: 35/50
2025-06-04 11:15:28,532 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,532 - DEBUG - Online update step: 36/50
2025-06-04 11:15:28,532 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,532 - DEBUG - Online update step: 37/50
2025-06-04 11:15:28,532 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,532 - DEBUG - Online update step: 38/50
2025-06-04 11:15:28,532 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,532 - DEBUG - Online update step: 39/50
2025-06-04 11:15:28,532 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,532 - DEBUG - Online update step: 40/50
2025-06-04 11:15:28,532 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,532 - DEBUG - Online update step: 41/50
2025-06-04 11:15:28,532 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,532 - DEBUG - Online update step: 42/50
2025-06-04 11:15:28,532 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,532 - DEBUG - Online update step: 43/50
2025-06-04 11:15:28,533 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,533 - DEBUG - Online update step: 44/50
2025-06-04 11:15:28,533 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,533 - DEBUG - Online update step: 45/50
2025-06-04 11:15:28,533 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,533 - DEBUG - Online update step: 46/50
2025-06-04 11:15:28,533 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,533 - DEBUG - Online update step: 47/50
2025-06-04 11:15:28,533 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,533 - DEBUG - Online update step: 48/50
2025-06-04 11:15:28,533 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,533 - DEBUG - Online update step: 49/50
2025-06-04 11:15:28,533 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,533 - DEBUG - Online update step: 50/50
2025-06-04 11:15:28,533 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:28,533 - WARNING - No successful steps during online update.
2025-06-04 11:15:28,533 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -6.2741732e-09 -1.2548346e-08
 -1.2548346e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -6.2741732e-09  2.5096693e-08  2.5096693e-08  5.0193385e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00  1.5685433e-08], current edge mean: [ 1.6000000e-01  2.5599999e+00  0.0000000e+00  4.7683715e-09
 -9.5367430e-09  9.5367430e-09 -4.7683715e-09  1.9073486e-08
  0.0000000e+00  2.3841857e-09 -4.7683715e-09 -1.2516975e-08
  1.9073486e-08  3.8146972e-08  0.0000000e+00  1.6689301e-08
  1.6689301e-08  1.6689301e-08  1.6689301e-08  1.6689301e-08
  1.6689301e-08 -2.3841857e-09]
2025-06-04 11:15:28,534 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 2.4915
2025-06-04 11:15:28,534 - WARNING - Feature drift detected (2 consecutive)
2025-06-04 11:15:28,534 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -6.2741732e-09 -1.2548346e-08
 -1.2548346e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -6.2741732e-09  2.5096693e-08  2.5096693e-08  5.0193385e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00  1.5685433e-08], edge=[ 1.6000000e-01  2.5599999e+00  0.0000000e+00  4.7683715e-09
 -9.5367430e-09  9.5367430e-09 -4.7683715e-09  1.9073486e-08
  0.0000000e+00  2.3841857e-09 -4.7683715e-09 -1.2516975e-08
  1.9073486e-08  3.8146972e-08  0.0000000e+00  1.6689301e-08
  1.6689301e-08  1.6689301e-08  1.6689301e-08  1.6689301e-08
  1.6689301e-08 -2.3841857e-09]
2025-06-04 11:15:28,534 - DEBUG - Updated reference std: node=[1.0274024 1.0274024 1.0274024 1.0274023 1.0274023 1.0274023 1.0274024
 1.0274023 1.0274023 1.0274024 1.0274023 1.0274024 1.0274023 0.
 0.        0.        0.        1.0274024 1.0274024], edge=[0.37416574 1.5832456  1.0206207  1.0206207  1.0206207  1.0206207
 1.0206207  1.0206207  1.0206207  1.0206207  1.0206207  1.0206207
 1.0206207  1.0206207  1.0206207  1.0206207  1.0206207  1.0206207
 1.0206207  1.0206207  1.0206207  1.0206207 ]
2025-06-04 11:15:28,534 - INFO - Online update complete. Loss: 0.0000
2025-06-04 11:15:28,534 - INFO - Running anomaly detection...
2025-06-04 11:15:28,535 - INFO - Starting anomaly detection.
2025-06-04 11:15:28,944 - DEBUG - Node reconstruction errors: [0.08971393 0.08971393 0.08971393 0.08971393 0.08971393 1.2535816
 0.08971393 1.3398674  0.08971392 0.08971393 0.4581333  3.4342287
 0.3632686  0.08971392 0.1577725  1.705388   0.08971393 0.08971393
 0.15777253]
2025-06-04 11:15:28,945 - DEBUG - Edge reconstruction errors: [0.1999963  0.1999957  0.19999713 0.19999892 0.13001281 0.10330522
 0.10773611 0.19999987 0.19999987 0.1999963  0.19998115 0.19999462
 0.19994992 0.19995719 0.19994241 0.19998354 0.19998115 0.19997925
 0.1999889  0.19998997 0.1999858  0.19998628 0.7999595  0.19999975
 0.19999975]
2025-06-04 11:15:29,043 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_111529_update_2.json
2025-06-04 11:15:29,043 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 11:15:29,080 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_111529_update_2.pth and as latest_checkpoint.pth
2025-06-04 11:15:29,081 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028234.dot): 1.0000
2025-06-04 11:15:29,081 - WARNING - Detected 1 anomalous nodes (reconstruction-based):
2025-06-04 11:15:29,081 - WARNING -   Node ID: 192.168.239.101, Recon Error: 3.4342, MLP Score: 0.0000
2025-06-04 11:15:29,081 - WARNING - Detected 1 anomalous edges (reconstruction-based):
2025-06-04 11:15:29,081 - WARNING -   Source: 192.168.239.101, Target: 1.1.1.1, Recon Error: 0.8000, MLP Score: 0.0000
2025-06-04 11:15:29,081 - INFO - 
--- Processing file: nw_graph_encoded_1749028249.dot ---
2025-06-04 11:15:29,081 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028249.dot
2025-06-04 11:15:29,081 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028249.dot file.
2025-06-04 11:15:29,081 - INFO - Parsed 21 nodes.
2025-06-04 11:15:29,082 - INFO - Parsed 29 edges.
2025-06-04 11:15:29,083 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 11:15:29,083 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 11:15:29,083 - DEBUG - Initial node features tensor shape: torch.Size([21, 19])
2025-06-04 11:15:29,084 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 11:15:29,084 - DEBUG - Node features tensor shape after scaling: torch.Size([21, 19])
2025-06-04 11:15:29,084 - DEBUG - Edge index tensor shape: torch.Size([2, 29])
2025-06-04 11:15:29,084 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 11:15:29,085 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 2
2025-06-04 11:15:29,085 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 5
2025-06-04 11:15:29,085 - DEBUG - Shape of encoded categorical edge features: torch.Size([29, 2])
2025-06-04 11:15:29,086 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 11:15:29,086 - DEBUG - Shape of scaled numerical edge features: torch.Size([29, 20])
2025-06-04 11:15:29,086 - DEBUG - Final edge attributes tensor shape: torch.Size([29, 22])
2025-06-04 11:15:29,086 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 11:15:29,086 - INFO - Performing online update...
2025-06-04 11:15:29,086 - INFO - Starting online update for 50 steps.
2025-06-04 11:15:29,087 - DEBUG - Updated RunningStats: new_mean=[ 5.30290890e-10 -5.13984754e-10 -2.16224904e-09  2.39704459e-09
 -2.73266925e-08  1.46968650e-08 -1.05764710e-08 -2.30612294e-09
 -3.08585075e-09  9.30090010e-10  1.64984368e-09 -1.63624812e-09
  4.03952489e-09 -3.46204973e-09  9.91045930e-10  9.24381395e-10
 -4.03029000e-09  1.47325380e-09 -5.31161422e-09], new_M2=[174543.0051509  174543.00507688 174543.00028237 174543.00397853
 174542.99872701 174542.99837488 174542.99618497 174542.99843903
 174542.99348198 174542.99833423 174543.00185681 174542.9939497
 174542.99275261 138897.99642043 138898.00024815 138897.99905218
 138898.0000499  174543.00043356 174543.00741056], new_n=174543
2025-06-04 11:15:29,087 - DEBUG - Updated RunningStats: new_mean=[ 1.41956242e+00  5.53093835e+00  1.17755857e-10  3.28466321e-10
  1.67732753e-10 -1.55630912e-10 -1.36181250e-09  2.99167755e-10
  3.77726177e-10 -3.16610399e-10  4.81082220e-10 -3.99811269e-09
 -8.79060871e-10  8.49030142e-10  4.18136137e-10 -1.71596115e-10
 -1.71596115e-10 -1.71596115e-10 -1.71596115e-10 -1.71596115e-10
 -1.71596115e-10 -6.53291561e-11], new_M2=[  96570.20849421 1666418.0473066   377621.99912331  377622.00680348
  377622.00563367  377621.99377493  377622.0002933   377621.999237
  377622.00168955  377621.99936127  377621.99377272  377622.00893635
  377622.00114083  377621.99965663  377622.00194558  377621.99451336
  377621.99451336  377621.99451336  377621.99451336  377621.99451336
  377621.99451336  377621.99962854], new_n=377622
2025-06-04 11:15:29,088 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.00000001 0.99999998
 0.99999998 0.89206556 0.89206557 0.89206557 0.89206557 1.
 1.00000002]
2025-06-04 11:15:29,088 - DEBUG - Calculated standard deviation: [0.50569998 2.10069662 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 11:15:29,088 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 11:15:29,088 - DEBUG - Online update step: 1/50
2025-06-04 11:15:29,088 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,088 - DEBUG - Online update step: 2/50
2025-06-04 11:15:29,088 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,088 - DEBUG - Online update step: 3/50
2025-06-04 11:15:29,088 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,088 - DEBUG - Online update step: 4/50
2025-06-04 11:15:29,088 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,088 - DEBUG - Online update step: 5/50
2025-06-04 11:15:29,088 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,088 - DEBUG - Online update step: 6/50
2025-06-04 11:15:29,088 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,088 - DEBUG - Online update step: 7/50
2025-06-04 11:15:29,088 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,088 - DEBUG - Online update step: 8/50
2025-06-04 11:15:29,088 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,088 - DEBUG - Online update step: 9/50
2025-06-04 11:15:29,088 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,089 - DEBUG - Online update step: 10/50
2025-06-04 11:15:29,089 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,089 - DEBUG - Online update step: 11/50
2025-06-04 11:15:29,089 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,089 - DEBUG - Online update step: 12/50
2025-06-04 11:15:29,089 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,089 - DEBUG - Online update step: 13/50
2025-06-04 11:15:29,089 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,089 - DEBUG - Online update step: 14/50
2025-06-04 11:15:29,089 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,089 - DEBUG - Online update step: 15/50
2025-06-04 11:15:29,089 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,089 - DEBUG - Online update step: 16/50
2025-06-04 11:15:29,089 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,089 - DEBUG - Online update step: 17/50
2025-06-04 11:15:29,089 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,089 - DEBUG - Online update step: 18/50
2025-06-04 11:15:29,089 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,089 - DEBUG - Online update step: 19/50
2025-06-04 11:15:29,089 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,089 - DEBUG - Online update step: 20/50
2025-06-04 11:15:29,089 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,089 - DEBUG - Online update step: 21/50
2025-06-04 11:15:29,089 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,089 - DEBUG - Online update step: 22/50
2025-06-04 11:15:29,089 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,089 - DEBUG - Online update step: 23/50
2025-06-04 11:15:29,089 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,089 - DEBUG - Online update step: 24/50
2025-06-04 11:15:29,089 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,089 - DEBUG - Online update step: 25/50
2025-06-04 11:15:29,090 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,090 - DEBUG - Online update step: 26/50
2025-06-04 11:15:29,090 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,090 - DEBUG - Online update step: 27/50
2025-06-04 11:15:29,090 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,090 - DEBUG - Online update step: 28/50
2025-06-04 11:15:29,090 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,090 - DEBUG - Online update step: 29/50
2025-06-04 11:15:29,090 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,090 - DEBUG - Online update step: 30/50
2025-06-04 11:15:29,090 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,090 - DEBUG - Online update step: 31/50
2025-06-04 11:15:29,090 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,090 - DEBUG - Online update step: 32/50
2025-06-04 11:15:29,090 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,090 - DEBUG - Online update step: 33/50
2025-06-04 11:15:29,090 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,090 - DEBUG - Online update step: 34/50
2025-06-04 11:15:29,090 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,090 - DEBUG - Online update step: 35/50
2025-06-04 11:15:29,090 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,090 - DEBUG - Online update step: 36/50
2025-06-04 11:15:29,090 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,090 - DEBUG - Online update step: 37/50
2025-06-04 11:15:29,090 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,090 - DEBUG - Online update step: 38/50
2025-06-04 11:15:29,090 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,090 - DEBUG - Online update step: 39/50
2025-06-04 11:15:29,090 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,090 - DEBUG - Online update step: 40/50
2025-06-04 11:15:29,090 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,091 - DEBUG - Online update step: 41/50
2025-06-04 11:15:29,091 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,091 - DEBUG - Online update step: 42/50
2025-06-04 11:15:29,091 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,091 - DEBUG - Online update step: 43/50
2025-06-04 11:15:29,091 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,091 - DEBUG - Online update step: 44/50
2025-06-04 11:15:29,091 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,091 - DEBUG - Online update step: 45/50
2025-06-04 11:15:29,091 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,091 - DEBUG - Online update step: 46/50
2025-06-04 11:15:29,091 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,091 - DEBUG - Online update step: 47/50
2025-06-04 11:15:29,091 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,091 - DEBUG - Online update step: 48/50
2025-06-04 11:15:29,091 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,091 - DEBUG - Online update step: 49/50
2025-06-04 11:15:29,091 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,091 - DEBUG - Online update step: 50/50
2025-06-04 11:15:29,091 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,091 - WARNING - No successful steps during online update.
2025-06-04 11:15:29,092 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -2.2706532e-08  1.7029899e-08
 -5.6766329e-09 -2.2706532e-08  0.0000000e+00 -1.1353266e-08
 -1.7029899e-08  3.4059799e-08  1.7029899e-08 -3.2640639e-08
  5.6766329e-09  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -2.2706532e-08  2.2706532e-08], current edge mean: [ 1.3793103e-01  2.7241380e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  1.6442661e-08  1.6442661e-08 -8.2213303e-09
 -8.2213303e-09 -4.1106651e-09  0.0000000e+00  0.0000000e+00
 -1.2331996e-08 -1.6442661e-08 -8.2213303e-09 -8.2213303e-09
 -8.2213303e-09 -8.2213303e-09 -8.2213303e-09 -8.2213303e-09
 -8.2213303e-09  4.1106651e-09]
2025-06-04 11:15:29,092 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 2.5344
2025-06-04 11:15:29,092 - WARNING - Feature drift detected (3 consecutive)
2025-06-04 11:15:29,092 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-04 11:15:29,092 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-04 11:15:29,092 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-04 11:15:29,093 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-04 11:15:29,093 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-04 11:15:29,093 - INFO - Resetting parameters of module: autoencoder.node_decoder.3
2025-06-04 11:15:29,093 - INFO - Resetting parameters of module: autoencoder.node_decoder.4
2025-06-04 11:15:29,093 - INFO - Resetting parameters of module: autoencoder.node_decoder.5
2025-06-04 11:15:29,093 - INFO - Resetting parameters of module: autoencoder.node_decoder.6
2025-06-04 11:15:29,093 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-04 11:15:29,093 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-04 11:15:29,094 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-04 11:15:29,094 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-04 11:15:29,094 - INFO - Resetting parameters of module: autoencoder.edge_decoder.3
2025-06-04 11:15:29,094 - INFO - Resetting parameters of module: autoencoder.edge_decoder.4
2025-06-04 11:15:29,094 - INFO - Resetting parameters of module: autoencoder.edge_decoder.5
2025-06-04 11:15:29,094 - INFO - Resetting parameters of module: autoencoder.edge_decoder.6
2025-06-04 11:15:29,094 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-04 11:15:29,094 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-04 11:15:29,095 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-04 11:15:29,095 - INFO - Optimizer and scheduler reset.
2025-06-04 11:15:29,096 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -2.2706532e-08  1.7029899e-08
 -5.6766329e-09 -2.2706532e-08  0.0000000e+00 -1.1353266e-08
 -1.7029899e-08  3.4059799e-08  1.7029899e-08 -3.2640639e-08
  5.6766329e-09  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -2.2706532e-08  2.2706532e-08], edge=[ 1.3793103e-01  2.7241380e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  1.6442661e-08  1.6442661e-08 -8.2213303e-09
 -8.2213303e-09 -4.1106651e-09  0.0000000e+00  0.0000000e+00
 -1.2331996e-08 -1.6442661e-08 -8.2213303e-09 -8.2213303e-09
 -8.2213303e-09 -8.2213303e-09 -8.2213303e-09 -8.2213303e-09
 -8.2213303e-09  4.1106651e-09]
2025-06-04 11:15:29,096 - DEBUG - Updated reference std: node=[1.024695  1.024695  1.024695  1.024695  1.0246952 1.024695  1.024695
 1.024695  1.0246952 1.024695  1.024695  1.024695  1.0246952 0.
 0.        0.        0.        1.024695  1.0246952], edge=[0.3509312 1.5328907 1.0177004 1.0177006 1.0177004 1.0177004 1.0177004
 1.0177004 1.0177004 1.0177004 1.0177006 1.0177004 1.0177004 1.0177006
 1.0177006 1.0177004 1.0177004 1.0177004 1.0177004 1.0177004 1.0177004
 1.0177004]
2025-06-04 11:15:29,096 - INFO - Online update complete. Loss: 0.0000
2025-06-04 11:15:29,096 - INFO - Running anomaly detection...
2025-06-04 11:15:29,096 - INFO - Starting anomaly detection.
2025-06-04 11:15:29,554 - DEBUG - Node reconstruction errors: [  6.786642    6.786642    6.786642    6.786642    6.786642    6.786642
   6.786642  186.78918     6.786642  419.30844     6.786642    6.786642
  18.776705   38.53029    11.6729765   6.786642   10.021365  122.56389
   6.7866426   6.7866426  10.021363 ]
2025-06-04 11:15:29,555 - DEBUG - Edge reconstruction errors: [0.8        0.8        0.8        0.8        0.19999999 0.19999999
 0.19999999 0.19999999 0.8        0.8        0.8        0.8
 0.8        0.19999999 0.19999999 0.19999999 0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.19999999 0.19999999 0.19999999 0.19999999]
2025-06-04 11:15:29,646 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_111529_update_3.json
2025-06-04 11:15:29,646 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 11:15:29,657 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_111529_update_3.pth and as latest_checkpoint.pth
2025-06-04 11:15:29,657 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028249.dot): 1.0000
2025-06-04 11:15:29,657 - WARNING - Detected 1 anomalous nodes (reconstruction-based):
2025-06-04 11:15:29,657 - WARNING -   Node ID: 192.168.27.10, Recon Error: 419.3084, MLP Score: 0.0104
2025-06-04 11:15:29,657 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 11:15:29,658 - INFO - 
--- Processing file: nw_graph_encoded_1749028264.dot ---
2025-06-04 11:15:29,658 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028264.dot
2025-06-04 11:15:29,658 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028264.dot file.
2025-06-04 11:15:29,658 - INFO - Parsed 31 nodes.
2025-06-04 11:15:29,659 - INFO - Parsed 41 edges.
2025-06-04 11:15:29,660 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 11:15:29,660 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 11:15:29,661 - DEBUG - Initial node features tensor shape: torch.Size([31, 19])
2025-06-04 11:15:29,662 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 11:15:29,662 - DEBUG - Node features tensor shape after scaling: torch.Size([31, 19])
2025-06-04 11:15:29,662 - DEBUG - Edge index tensor shape: torch.Size([2, 41])
2025-06-04 11:15:29,662 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 11:15:29,663 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 2
2025-06-04 11:15:29,664 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 5
2025-06-04 11:15:29,664 - DEBUG - Shape of encoded categorical edge features: torch.Size([41, 2])
2025-06-04 11:15:29,665 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 11:15:29,665 - DEBUG - Shape of scaled numerical edge features: torch.Size([41, 20])
2025-06-04 11:15:29,665 - DEBUG - Final edge attributes tensor shape: torch.Size([41, 22])
2025-06-04 11:15:29,665 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 11:15:29,665 - INFO - Performing online update...
2025-06-04 11:15:29,665 - INFO - Starting online update for 50 steps.
2025-06-04 11:15:29,666 - DEBUG - Updated RunningStats: new_mean=[ 5.34592623e-10 -5.18118669e-10 -2.16034999e-09  2.39457036e-09
 -2.73232056e-08  1.46922066e-08 -1.05759586e-08 -2.30417700e-09
 -3.08412912e-09  9.28729847e-10  1.65125785e-09 -1.63885971e-09
  4.04017329e-09 -3.45972781e-09  9.89162799e-10  9.28314397e-10
 -4.02547717e-09  1.47563826e-09 -5.30930529e-09], new_M2=[174574.0051539  174574.00507989 174574.00028294 174574.00398013
 174573.99872533 174573.99837397 174573.99618431 174573.99843789
 174573.99348054 174573.99833266 174574.00185898 174573.99394756
 174573.99275093 138928.99642136 138929.00024908 138928.99905152
 138929.00004924 174574.00043408 174574.00741017], new_n=174574
2025-06-04 11:15:29,667 - DEBUG - Updated RunningStats: new_mean=[ 1.41942155e+00  5.53062651e+00  1.17931723e-10  3.27846216e-10
  1.67527126e-10 -1.56501782e-10 -1.36109254e-09  2.98523705e-10
  3.77842995e-10 -3.16543969e-10  4.80803120e-10 -3.99775756e-09
 -8.79728053e-10  8.48937969e-10  4.17459443e-10 -1.71695854e-10
 -1.71695854e-10 -1.71695854e-10 -1.71695854e-10 -1.71695854e-10
 -1.71695854e-10 -6.52727436e-11], new_M2=[  96643.62683133 1666863.50846128  377662.99912539  377663.00680098
  377663.00563404  377662.9937723   377663.00029179  377662.9992368
  377663.00169021  377662.99936118  377662.99377386  377663.00893706
  377663.00114062  377662.99965652  377663.00194518  377662.99451298
  377662.99451298  377662.99451298  377662.99451298  377662.99451298
  377662.99451298  377662.9996285 ], new_n=377663
2025-06-04 11:15:29,668 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.00000001 0.99999998
 0.99999998 0.89208588 0.8920859  0.89208589 0.8920859  1.
 1.00000002]
2025-06-04 11:15:29,668 - DEBUG - Calculated standard deviation: [0.50586472 2.10086333 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 11:15:29,668 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 11:15:29,668 - DEBUG - Online update step: 1/50
2025-06-04 11:15:29,668 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,668 - DEBUG - Online update step: 2/50
2025-06-04 11:15:29,668 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,668 - DEBUG - Online update step: 3/50
2025-06-04 11:15:29,668 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,668 - DEBUG - Online update step: 4/50
2025-06-04 11:15:29,668 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,669 - DEBUG - Online update step: 5/50
2025-06-04 11:15:29,669 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,669 - DEBUG - Online update step: 6/50
2025-06-04 11:15:29,669 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,669 - DEBUG - Online update step: 7/50
2025-06-04 11:15:29,669 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,669 - DEBUG - Online update step: 8/50
2025-06-04 11:15:29,669 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,669 - DEBUG - Online update step: 9/50
2025-06-04 11:15:29,669 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,669 - DEBUG - Online update step: 10/50
2025-06-04 11:15:29,669 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,669 - DEBUG - Online update step: 11/50
2025-06-04 11:15:29,669 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,669 - DEBUG - Online update step: 12/50
2025-06-04 11:15:29,669 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,669 - DEBUG - Online update step: 13/50
2025-06-04 11:15:29,669 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,669 - DEBUG - Online update step: 14/50
2025-06-04 11:15:29,669 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,669 - DEBUG - Online update step: 15/50
2025-06-04 11:15:29,669 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,669 - DEBUG - Online update step: 16/50
2025-06-04 11:15:29,669 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,670 - DEBUG - Online update step: 17/50
2025-06-04 11:15:29,670 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,670 - DEBUG - Online update step: 18/50
2025-06-04 11:15:29,670 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,670 - DEBUG - Online update step: 19/50
2025-06-04 11:15:29,670 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,670 - DEBUG - Online update step: 20/50
2025-06-04 11:15:29,670 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,670 - DEBUG - Online update step: 21/50
2025-06-04 11:15:29,671 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,671 - DEBUG - Online update step: 22/50
2025-06-04 11:15:29,671 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,671 - DEBUG - Online update step: 23/50
2025-06-04 11:15:29,671 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,671 - DEBUG - Online update step: 24/50
2025-06-04 11:15:29,671 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,671 - DEBUG - Online update step: 25/50
2025-06-04 11:15:29,671 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,671 - DEBUG - Online update step: 26/50
2025-06-04 11:15:29,671 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,671 - DEBUG - Online update step: 27/50
2025-06-04 11:15:29,671 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,671 - DEBUG - Online update step: 28/50
2025-06-04 11:15:29,671 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,671 - DEBUG - Online update step: 29/50
2025-06-04 11:15:29,672 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,672 - DEBUG - Online update step: 30/50
2025-06-04 11:15:29,672 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,672 - DEBUG - Online update step: 31/50
2025-06-04 11:15:29,672 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,672 - DEBUG - Online update step: 32/50
2025-06-04 11:15:29,672 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,672 - DEBUG - Online update step: 33/50
2025-06-04 11:15:29,672 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,672 - DEBUG - Online update step: 34/50
2025-06-04 11:15:29,672 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,672 - DEBUG - Online update step: 35/50
2025-06-04 11:15:29,672 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,672 - DEBUG - Online update step: 36/50
2025-06-04 11:15:29,672 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,672 - DEBUG - Online update step: 37/50
2025-06-04 11:15:29,672 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,672 - DEBUG - Online update step: 38/50
2025-06-04 11:15:29,672 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,672 - DEBUG - Online update step: 39/50
2025-06-04 11:15:29,672 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,672 - DEBUG - Online update step: 40/50
2025-06-04 11:15:29,673 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,673 - DEBUG - Online update step: 41/50
2025-06-04 11:15:29,673 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,673 - DEBUG - Online update step: 42/50
2025-06-04 11:15:29,673 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,673 - DEBUG - Online update step: 43/50
2025-06-04 11:15:29,673 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,673 - DEBUG - Online update step: 44/50
2025-06-04 11:15:29,673 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,673 - DEBUG - Online update step: 45/50
2025-06-04 11:15:29,673 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,673 - DEBUG - Online update step: 46/50
2025-06-04 11:15:29,673 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,673 - DEBUG - Online update step: 47/50
2025-06-04 11:15:29,673 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,673 - DEBUG - Online update step: 48/50
2025-06-04 11:15:29,673 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,673 - DEBUG - Online update step: 49/50
2025-06-04 11:15:29,673 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,673 - DEBUG - Online update step: 50/50
2025-06-04 11:15:29,673 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:29,673 - WARNING - No successful steps during online update.
2025-06-04 11:15:29,675 - DEBUG - Current node mean: [ 1.9227304e-08 -1.9227304e-08  2.3072765e-08 -1.2497748e-08
  1.5381843e-08  0.0000000e+00 -7.6909217e-09  8.6522869e-09
  2.3072765e-08  1.5381843e-08  2.6918226e-08  0.0000000e+00
 -1.5381843e-08 -2.3072765e-08  2.3072765e-08  2.3072765e-08
  2.3072765e-08  1.5381843e-08  1.9227304e-09], current edge mean: [ 1.2195122e-01  2.6585367e+00 -3.6344294e-10  4.3613153e-09
  4.3613153e-09 -1.1630174e-08  1.8899033e-08  0.0000000e+00
  1.1630174e-08 -1.1630174e-08  6.5419732e-09 -1.2902225e-08
  1.4537719e-08 -2.0352806e-08 -2.3260348e-08  2.9075435e-09
  2.9075435e-09  2.9075435e-09  2.9075435e-09  2.9075435e-09
  2.9075435e-09  2.9075435e-09]
2025-06-04 11:15:29,675 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 2.5649
2025-06-04 11:15:29,675 - WARNING - Feature drift detected (1 consecutive)
2025-06-04 11:15:29,676 - DEBUG - Updated reference mean: node=[ 1.9227304e-08 -1.9227304e-08  2.3072765e-08 -1.2497748e-08
  1.5381843e-08  0.0000000e+00 -7.6909217e-09  8.6522869e-09
  2.3072765e-08  1.5381843e-08  2.6918226e-08  0.0000000e+00
 -1.5381843e-08 -2.3072765e-08  2.3072765e-08  2.3072765e-08
  2.3072765e-08  1.5381843e-08  1.9227304e-09], edge=[ 1.2195122e-01  2.6585367e+00 -3.6344294e-10  4.3613153e-09
  4.3613153e-09 -1.1630174e-08  1.8899033e-08  0.0000000e+00
  1.1630174e-08 -1.1630174e-08  6.5419732e-09 -1.2902225e-08
  1.4537719e-08 -2.0352806e-08 -2.3260348e-08  2.9075435e-09
  2.9075435e-09  2.9075435e-09  2.9075435e-09  2.9075435e-09
  2.9075435e-09  2.9075435e-09]
2025-06-04 11:15:29,676 - DEBUG - Updated reference std: node=[1.01653 1.01653 1.01653 1.01653 1.01653 1.01653 1.01653 1.01653 1.01653
 1.01653 1.01653 1.01653 1.01653 1.01653 1.01653 1.01653 1.01653 1.01653
 1.01653], edge=[0.33129457 1.6372195  1.0124229  1.0124228  1.0124228  1.0124228
 1.0124228  1.0124228  1.0124228  1.0124228  1.0124228  1.0124228
 1.0124228  1.0124228  1.0124228  1.0124228  1.0124228  1.0124228
 1.0124228  1.0124228  1.0124228  1.0124228 ]
2025-06-04 11:15:29,676 - INFO - Online update complete. Loss: 0.0000
2025-06-04 11:15:29,676 - INFO - Running anomaly detection...
2025-06-04 11:15:29,677 - INFO - Starting anomaly detection.
2025-06-04 11:15:30,087 - DEBUG - Node reconstruction errors: [  3.003222    7.435373    4.3718057 205.58882     7.435373    4.3718057
  10.481286   58.541637   19.117538    4.3718057   4.3718057   4.3718057
   4.3718057 747.00616     4.3718057   4.3718057 272.20514     4.3718057
   4.3718057   3.003222    4.3718057   4.3718057   4.3718057   4.3718057
   4.3718057   4.3718057   5.209862    5.2098618   4.371806    7.435373
   4.3718066]
2025-06-04 11:15:30,088 - DEBUG - Edge reconstruction errors: [0.19999963 0.19999987 0.19999963 0.19999999 0.8        0.8
 0.8        0.8        0.8        0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.05489033 0.17781496 0.1748746  0.16245979]
2025-06-04 11:15:30,167 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_111530_update_4.json
2025-06-04 11:15:30,167 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 11:15:30,188 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_111530_update_4.pth and as latest_checkpoint.pth
2025-06-04 11:15:30,189 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028264.dot): 1.0000
2025-06-04 11:15:30,189 - WARNING - Detected 1 anomalous nodes (reconstruction-based):
2025-06-04 11:15:30,189 - WARNING -   Node ID: 192.168.27.10, Recon Error: 747.0062, MLP Score: 0.0078
2025-06-04 11:15:30,189 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 11:15:30,189 - INFO - 
--- Processing file: nw_graph_encoded_1749028279.dot ---
2025-06-04 11:15:30,189 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028279.dot
2025-06-04 11:15:30,189 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028279.dot file.
2025-06-04 11:15:30,190 - INFO - Parsed 41 nodes.
2025-06-04 11:15:30,191 - INFO - Parsed 54 edges.
2025-06-04 11:15:30,193 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 11:15:30,193 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 11:15:30,194 - DEBUG - Initial node features tensor shape: torch.Size([41, 19])
2025-06-04 11:15:30,195 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 11:15:30,195 - DEBUG - Node features tensor shape after scaling: torch.Size([41, 19])
2025-06-04 11:15:30,195 - DEBUG - Edge index tensor shape: torch.Size([2, 54])
2025-06-04 11:15:30,195 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 11:15:30,196 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 2
2025-06-04 11:15:30,197 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 5
2025-06-04 11:15:30,197 - DEBUG - Shape of encoded categorical edge features: torch.Size([54, 2])
2025-06-04 11:15:30,198 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 11:15:30,198 - DEBUG - Shape of scaled numerical edge features: torch.Size([54, 20])
2025-06-04 11:15:30,198 - DEBUG - Final edge attributes tensor shape: torch.Size([54, 22])
2025-06-04 11:15:30,198 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 11:15:30,198 - INFO - Performing online update...
2025-06-04 11:15:30,199 - INFO - Starting online update for 50 steps.
2025-06-04 11:15:30,199 - DEBUG - Updated RunningStats: new_mean=[ 5.31117613e-10 -5.14498187e-10 -2.16150681e-09  2.39281339e-09
 -2.73183262e-08  1.46919996e-08 -1.05744994e-08 -2.30636677e-09
 -3.08393831e-09  9.27487733e-10  1.65001676e-09 -1.64001097e-09
  4.03342172e-09 -3.45959815e-09  9.89613239e-10  9.39702291e-10
 -4.03374840e-09  1.47580380e-09 -5.31130147e-09], new_M2=[174615.00515644 174615.00508243 174615.00028252 174615.0039833
 174614.99872162 174614.99837388 174614.99618598 174614.99843492
 174614.99347867 174614.9983316  174615.00185931 174614.99394384
 174614.99275399 138969.99642063 138970.00024836 138969.99905408
 138970.00004936 174615.000431   174615.00740972], new_n=174615
2025-06-04 11:15:30,200 - DEBUG - Updated RunningStats: new_mean=[ 1.41923715e+00  5.53019589e+00  1.17876646e-10  3.27602093e-10
  1.67779330e-10 -1.56656935e-10 -1.35989690e-09  2.98688142e-10
  3.77754458e-10 -3.16459264e-10  4.80048928e-10 -3.99548718e-09
 -8.79148601e-10  8.48895503e-10  4.20240204e-10 -1.71858698e-10
 -1.71858698e-10 -1.71858698e-10 -1.71858698e-10 -1.71858698e-10
 -1.71858698e-10 -6.53028625e-11], new_M2=[  96739.53899348 1667500.85080633  377716.99912627  377717.0067998
  377717.00563425  377716.9937716   377717.00029001  377716.99923564
  377717.0016914   377716.99936199  377716.9937733   377717.00893473
  377717.00114126  377716.99965512  377717.00194586  377716.99451329
  377716.99451329  377716.99451329  377716.99451329  377716.99451329
  377716.99451329  377716.99962786], new_n=377717
2025-06-04 11:15:30,200 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.00000001 0.99999998
 0.99999998 0.89211276 0.89211277 0.89211276 0.89211277 1.
 1.00000002]
2025-06-04 11:15:30,200 - DEBUG - Calculated standard deviation: [0.50607949 2.10111472 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 11:15:30,201 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 11:15:30,201 - DEBUG - Online update step: 1/50
2025-06-04 11:15:30,201 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,201 - DEBUG - Online update step: 2/50
2025-06-04 11:15:30,201 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,201 - DEBUG - Online update step: 3/50
2025-06-04 11:15:30,201 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,201 - DEBUG - Online update step: 4/50
2025-06-04 11:15:30,201 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,201 - DEBUG - Online update step: 5/50
2025-06-04 11:15:30,201 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,201 - DEBUG - Online update step: 6/50
2025-06-04 11:15:30,201 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,201 - DEBUG - Online update step: 7/50
2025-06-04 11:15:30,201 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,201 - DEBUG - Online update step: 8/50
2025-06-04 11:15:30,201 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,201 - DEBUG - Online update step: 9/50
2025-06-04 11:15:30,201 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,201 - DEBUG - Online update step: 10/50
2025-06-04 11:15:30,201 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,201 - DEBUG - Online update step: 11/50
2025-06-04 11:15:30,201 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,202 - DEBUG - Online update step: 12/50
2025-06-04 11:15:30,202 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,202 - DEBUG - Online update step: 13/50
2025-06-04 11:15:30,202 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,202 - DEBUG - Online update step: 14/50
2025-06-04 11:15:30,202 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,202 - DEBUG - Online update step: 15/50
2025-06-04 11:15:30,202 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,202 - DEBUG - Online update step: 16/50
2025-06-04 11:15:30,202 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,202 - DEBUG - Online update step: 17/50
2025-06-04 11:15:30,202 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,202 - DEBUG - Online update step: 18/50
2025-06-04 11:15:30,202 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,202 - DEBUG - Online update step: 19/50
2025-06-04 11:15:30,202 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,202 - DEBUG - Online update step: 20/50
2025-06-04 11:15:30,202 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,202 - DEBUG - Online update step: 21/50
2025-06-04 11:15:30,202 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,202 - DEBUG - Online update step: 22/50
2025-06-04 11:15:30,202 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,203 - DEBUG - Online update step: 23/50
2025-06-04 11:15:30,203 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,203 - DEBUG - Online update step: 24/50
2025-06-04 11:15:30,203 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,203 - DEBUG - Online update step: 25/50
2025-06-04 11:15:30,203 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,203 - DEBUG - Online update step: 26/50
2025-06-04 11:15:30,203 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,203 - DEBUG - Online update step: 27/50
2025-06-04 11:15:30,203 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,203 - DEBUG - Online update step: 28/50
2025-06-04 11:15:30,203 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,203 - DEBUG - Online update step: 29/50
2025-06-04 11:15:30,203 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,203 - DEBUG - Online update step: 30/50
2025-06-04 11:15:30,203 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,203 - DEBUG - Online update step: 31/50
2025-06-04 11:15:30,203 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,203 - DEBUG - Online update step: 32/50
2025-06-04 11:15:30,203 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,203 - DEBUG - Online update step: 33/50
2025-06-04 11:15:30,203 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,203 - DEBUG - Online update step: 34/50
2025-06-04 11:15:30,203 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,203 - DEBUG - Online update step: 35/50
2025-06-04 11:15:30,203 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,204 - DEBUG - Online update step: 36/50
2025-06-04 11:15:30,204 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,204 - DEBUG - Online update step: 37/50
2025-06-04 11:15:30,204 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,204 - DEBUG - Online update step: 38/50
2025-06-04 11:15:30,204 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,204 - DEBUG - Online update step: 39/50
2025-06-04 11:15:30,204 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,204 - DEBUG - Online update step: 40/50
2025-06-04 11:15:30,204 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,204 - DEBUG - Online update step: 41/50
2025-06-04 11:15:30,204 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,204 - DEBUG - Online update step: 42/50
2025-06-04 11:15:30,204 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,204 - DEBUG - Online update step: 43/50
2025-06-04 11:15:30,204 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,204 - DEBUG - Online update step: 44/50
2025-06-04 11:15:30,204 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,204 - DEBUG - Online update step: 45/50
2025-06-04 11:15:30,204 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,204 - DEBUG - Online update step: 46/50
2025-06-04 11:15:30,204 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,204 - DEBUG - Online update step: 47/50
2025-06-04 11:15:30,204 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,204 - DEBUG - Online update step: 48/50
2025-06-04 11:15:30,204 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,205 - DEBUG - Online update step: 49/50
2025-06-04 11:15:30,205 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,205 - DEBUG - Online update step: 50/50
2025-06-04 11:15:30,205 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,205 - WARNING - No successful steps during online update.
2025-06-04 11:15:30,205 - DEBUG - Current node mean: [ 1.1630174e-08 -1.1630174e-08 -7.2688593e-09 -2.3260348e-08
 -1.1630174e-08  2.3260348e-08  0.0000000e+00 -3.4890522e-08
 -3.9251841e-08  1.1630174e-08 -1.1630174e-08 -1.1630174e-08
 -1.1630174e-08  1.4537719e-08 -1.4537719e-08  6.9781045e-08
 -5.8150874e-08  1.5991491e-08 -4.0705611e-08], current edge mean: [ 1.2962963e-01  2.5185184e+00  1.7660636e-08  0.0000000e+00
  4.4151589e-09 -1.3245477e-08  1.2141687e-08 -3.3113692e-09
  1.3245477e-08  4.4151589e-09 -1.1037897e-08  2.4283374e-08
  8.8303178e-09  0.0000000e+00  2.6490953e-08 -1.3245477e-08
 -1.3245477e-08 -1.3245477e-08 -1.3245477e-08 -1.3245477e-08
 -1.3245477e-08 -8.8303178e-09]
2025-06-04 11:15:30,205 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 2.5482
2025-06-04 11:15:30,206 - WARNING - Feature drift detected (2 consecutive)
2025-06-04 11:15:30,206 - DEBUG - Updated reference mean: node=[ 1.1630174e-08 -1.1630174e-08 -7.2688593e-09 -2.3260348e-08
 -1.1630174e-08  2.3260348e-08  0.0000000e+00 -3.4890522e-08
 -3.9251841e-08  1.1630174e-08 -1.1630174e-08 -1.1630174e-08
 -1.1630174e-08  1.4537719e-08 -1.4537719e-08  6.9781045e-08
 -5.8150874e-08  1.5991491e-08 -4.0705611e-08], edge=[ 1.2962963e-01  2.5185184e+00  1.7660636e-08  0.0000000e+00
  4.4151589e-09 -1.3245477e-08  1.2141687e-08 -3.3113692e-09
  1.3245477e-08  4.4151589e-09 -1.1037897e-08  2.4283374e-08
  8.8303178e-09  0.0000000e+00  2.6490953e-08 -1.3245477e-08
 -1.3245477e-08 -1.3245477e-08 -1.3245477e-08 -1.3245477e-08
 -1.3245477e-08 -8.8303178e-09]
2025-06-04 11:15:30,207 - DEBUG - Updated reference std: node=[1.0124229 1.0124229 1.0124228 1.0124229 1.0124228 1.0124228 1.0124228
 1.0124228 1.0124228 1.0124228 1.0124228 1.0124228 1.0124229 1.0124228
 1.0124228 1.0124229 1.0124228 1.0124228 1.0124228], edge=[0.33904952 1.6681335  1.0093899  1.0093899  1.0093899  1.0093899
 1.0093899  1.0093899  1.0093899  1.0093899  1.0093899  1.0093899
 1.0093899  1.0093899  1.0093899  1.0093899  1.0093899  1.0093899
 1.0093899  1.0093899  1.0093899  1.0093899 ]
2025-06-04 11:15:30,207 - INFO - Online update complete. Loss: 0.0000
2025-06-04 11:15:30,207 - INFO - Running anomaly detection...
2025-06-04 11:15:30,207 - INFO - Starting anomaly detection.
2025-06-04 11:15:30,656 - DEBUG - Node reconstruction errors: [  2.5849884   2.5849884   4.403821    2.5849884   7.2470126   2.5849884
   6.2013464   3.3913767 309.8745      6.2013464   3.3913767  16.117435
  96.46687     2.5849884  20.161798    2.5849884   4.403821    3.3913767
   3.3913767   3.3913767   3.3913767 907.42303     3.3913767   2.5849884
   3.3913767 385.51807     3.3913767   3.3913767   2.5849884   3.3913767
   3.3913767   3.3913767   3.3913767   2.5849884   3.3913767   3.3913767
   4.0470877   4.0470877   3.3913767   6.2013464   4.0470886]
2025-06-04 11:15:30,658 - DEBUG - Edge reconstruction errors: [0.7998813  0.7997066  0.7998896  0.79999965 0.8        0.8
 0.19999999 0.8        0.8        0.8        0.8        0.8
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.19917667
 0.19991511 0.19991368 0.19988662 0.19947791 0.19984299 0.8       ]
2025-06-04 11:15:30,758 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_111530_update_5.json
2025-06-04 11:15:30,758 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 11:15:30,777 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_111530_update_5.pth and as latest_checkpoint.pth
2025-06-04 11:15:30,778 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028279.dot): 1.0000
2025-06-04 11:15:30,778 - WARNING - Detected 1 anomalous nodes (reconstruction-based):
2025-06-04 11:15:30,778 - WARNING -   Node ID: 192.168.27.10, Recon Error: 907.4230, MLP Score: 0.7800
2025-06-04 11:15:30,778 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 11:15:30,778 - INFO - 
--- Processing file: nw_graph_encoded_1749028294.dot ---
2025-06-04 11:15:30,778 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028294.dot
2025-06-04 11:15:30,778 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028294.dot file.
2025-06-04 11:15:30,781 - INFO - Parsed 48 nodes.
2025-06-04 11:15:30,783 - INFO - Parsed 62 edges.
2025-06-04 11:15:30,785 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 11:15:30,785 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 11:15:30,786 - DEBUG - Initial node features tensor shape: torch.Size([48, 19])
2025-06-04 11:15:30,787 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 11:15:30,787 - DEBUG - Node features tensor shape after scaling: torch.Size([48, 19])
2025-06-04 11:15:30,787 - DEBUG - Edge index tensor shape: torch.Size([2, 62])
2025-06-04 11:15:30,787 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 11:15:30,788 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-04 11:15:30,788 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-04 11:15:30,789 - DEBUG - Shape of encoded categorical edge features: torch.Size([62, 2])
2025-06-04 11:15:30,790 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 11:15:30,790 - DEBUG - Shape of scaled numerical edge features: torch.Size([62, 20])
2025-06-04 11:15:30,790 - DEBUG - Final edge attributes tensor shape: torch.Size([62, 22])
2025-06-04 11:15:30,790 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 11:15:30,790 - INFO - Performing online update...
2025-06-04 11:15:30,790 - INFO - Starting online update for 50 steps.
2025-06-04 11:15:30,791 - DEBUG - Updated RunningStats: new_mean=[ 5.31739478e-10 -5.14953991e-10 -2.16159531e-09  2.38985233e-09
 -2.73094537e-08  1.46845495e-08 -1.05763709e-08 -2.30795110e-09
 -3.08309080e-09  9.27574100e-10  1.64683327e-09 -1.63580647e-09
  4.03094825e-09 -3.45079854e-09  9.84563707e-10  9.33642710e-10
 -4.02683853e-09  1.47167641e-09 -5.31410753e-09], new_M2=[174663.00515844 174663.00508443 174663.00028667 174663.0039789
 174662.99872406 174662.99837261 174662.99619047 174662.99843318
 174662.99348138 174662.99833273 174663.00185742 174662.9939448
 174662.99275644 139017.99641587 139018.00025198 139017.99905033
 139018.00005108 174663.00042802 174663.00740759], new_n=174663
2025-06-04 11:15:30,791 - DEBUG - Updated RunningStats: new_mean=[ 1.41918953e+00  5.52980446e+00  1.18028578e-10  3.27646938e-10
  1.67357353e-10 -1.57065111e-10 -1.36032208e-09  2.98382736e-10
  3.78220027e-10 -3.16239690e-10  4.79417926e-10 -3.99324383e-09
 -8.78937756e-10  8.49249236e-10  4.19382353e-10 -1.72249587e-10
 -1.72249587e-10 -1.72249587e-10 -1.72249587e-10 -1.72249587e-10
 -1.72249587e-10 -6.55288099e-11], new_M2=[  96753.72744912 1668133.16665567  377778.99912616  377779.00679983
  377779.00563139  377778.9937694   377779.00029117  377778.99923536
  377779.00168918  377778.99936149  377778.99377332  377779.00893162
  377779.00113972  377778.99965852  377779.00194453  377778.99451151
  377778.99451151  377778.99451151  377778.99451151  377778.99451151
  377778.99451151  377778.99962616], new_n=377779
2025-06-04 11:15:30,792 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.00000001 0.99999998
 0.99999998 0.8921442  0.89214421 0.89214421 0.89214421 1.
 1.00000002]
2025-06-04 11:15:30,792 - DEBUG - Calculated standard deviation: [0.50607507 2.1013406  1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 11:15:30,792 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 11:15:30,792 - DEBUG - Online update step: 1/50
2025-06-04 11:15:30,792 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,792 - DEBUG - Online update step: 2/50
2025-06-04 11:15:30,792 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,792 - DEBUG - Online update step: 3/50
2025-06-04 11:15:30,792 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,792 - DEBUG - Online update step: 4/50
2025-06-04 11:15:30,792 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,792 - DEBUG - Online update step: 5/50
2025-06-04 11:15:30,792 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,793 - DEBUG - Online update step: 6/50
2025-06-04 11:15:30,793 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,793 - DEBUG - Online update step: 7/50
2025-06-04 11:15:30,793 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,793 - DEBUG - Online update step: 8/50
2025-06-04 11:15:30,793 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,793 - DEBUG - Online update step: 9/50
2025-06-04 11:15:30,793 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,793 - DEBUG - Online update step: 10/50
2025-06-04 11:15:30,793 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,793 - DEBUG - Online update step: 11/50
2025-06-04 11:15:30,793 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,793 - DEBUG - Online update step: 12/50
2025-06-04 11:15:30,793 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,793 - DEBUG - Online update step: 13/50
2025-06-04 11:15:30,793 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,793 - DEBUG - Online update step: 14/50
2025-06-04 11:15:30,793 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,793 - DEBUG - Online update step: 15/50
2025-06-04 11:15:30,793 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,793 - DEBUG - Online update step: 16/50
2025-06-04 11:15:30,793 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,793 - DEBUG - Online update step: 17/50
2025-06-04 11:15:30,793 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,794 - DEBUG - Online update step: 18/50
2025-06-04 11:15:30,794 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,794 - DEBUG - Online update step: 19/50
2025-06-04 11:15:30,794 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,794 - DEBUG - Online update step: 20/50
2025-06-04 11:15:30,794 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,794 - DEBUG - Online update step: 21/50
2025-06-04 11:15:30,794 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,794 - DEBUG - Online update step: 22/50
2025-06-04 11:15:30,794 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,794 - DEBUG - Online update step: 23/50
2025-06-04 11:15:30,794 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,794 - DEBUG - Online update step: 24/50
2025-06-04 11:15:30,794 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,794 - DEBUG - Online update step: 25/50
2025-06-04 11:15:30,794 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,794 - DEBUG - Online update step: 26/50
2025-06-04 11:15:30,794 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,794 - DEBUG - Online update step: 27/50
2025-06-04 11:15:30,794 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,794 - DEBUG - Online update step: 28/50
2025-06-04 11:15:30,794 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,795 - DEBUG - Online update step: 29/50
2025-06-04 11:15:30,795 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,795 - DEBUG - Online update step: 30/50
2025-06-04 11:15:30,795 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,795 - DEBUG - Online update step: 31/50
2025-06-04 11:15:30,795 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,795 - DEBUG - Online update step: 32/50
2025-06-04 11:15:30,795 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,795 - DEBUG - Online update step: 33/50
2025-06-04 11:15:30,795 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,795 - DEBUG - Online update step: 34/50
2025-06-04 11:15:30,795 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,795 - DEBUG - Online update step: 35/50
2025-06-04 11:15:30,795 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,795 - DEBUG - Online update step: 36/50
2025-06-04 11:15:30,795 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,795 - DEBUG - Online update step: 37/50
2025-06-04 11:15:30,795 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,795 - DEBUG - Online update step: 38/50
2025-06-04 11:15:30,795 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,795 - DEBUG - Online update step: 39/50
2025-06-04 11:15:30,795 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,795 - DEBUG - Online update step: 40/50
2025-06-04 11:15:30,795 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,796 - DEBUG - Online update step: 41/50
2025-06-04 11:15:30,796 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,796 - DEBUG - Online update step: 42/50
2025-06-04 11:15:30,796 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,796 - DEBUG - Online update step: 43/50
2025-06-04 11:15:30,796 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,796 - DEBUG - Online update step: 44/50
2025-06-04 11:15:30,796 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,796 - DEBUG - Online update step: 45/50
2025-06-04 11:15:30,796 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,796 - DEBUG - Online update step: 46/50
2025-06-04 11:15:30,796 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,796 - DEBUG - Online update step: 47/50
2025-06-04 11:15:30,796 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,796 - DEBUG - Online update step: 48/50
2025-06-04 11:15:30,796 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,796 - DEBUG - Online update step: 49/50
2025-06-04 11:15:30,796 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,796 - DEBUG - Online update step: 50/50
2025-06-04 11:15:30,796 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:30,796 - WARNING - No successful steps during online update.
2025-06-04 11:15:30,797 - DEBUG - Current node mean: [ 1.7384687e-08 -1.7384687e-08 -9.9341078e-09 -1.7384687e-08
  3.4769375e-08 -2.7318796e-08 -1.9868216e-08 -4.9670539e-09
  0.0000000e+00  1.2417634e-08  9.9341078e-09 -1.2417635e-09
 -2.4835268e-08  4.4703484e-08 -9.9341078e-09 -1.9868216e-08
  1.9868216e-08 -1.9868216e-08 -5.4637592e-08], current edge mean: [ 1.1290323e+00  3.1451614e+00 -1.5381843e-08 -7.6909217e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.6909217e-09
 -7.6909217e-09 -3.8454608e-09  7.6909217e-09  0.0000000e+00
  7.6909217e-09  7.6909217e-09 -3.8454608e-08 -3.8454608e-09
 -3.8454608e-09 -3.8454608e-09 -3.8454608e-09 -3.8454608e-09
 -3.8454608e-09 -1.5381843e-08]
2025-06-04 11:15:30,797 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 1.1348
2025-06-04 11:15:30,797 - WARNING - Feature drift detected (3 consecutive)
2025-06-04 11:15:30,797 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-04 11:15:30,797 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-04 11:15:30,798 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-04 11:15:30,798 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-04 11:15:30,798 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-04 11:15:30,798 - INFO - Resetting parameters of module: autoencoder.node_decoder.3
2025-06-04 11:15:30,798 - INFO - Resetting parameters of module: autoencoder.node_decoder.4
2025-06-04 11:15:30,798 - INFO - Resetting parameters of module: autoencoder.node_decoder.5
2025-06-04 11:15:30,798 - INFO - Resetting parameters of module: autoencoder.node_decoder.6
2025-06-04 11:15:30,798 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-04 11:15:30,799 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-04 11:15:30,799 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-04 11:15:30,799 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-04 11:15:30,799 - INFO - Resetting parameters of module: autoencoder.edge_decoder.3
2025-06-04 11:15:30,799 - INFO - Resetting parameters of module: autoencoder.edge_decoder.4
2025-06-04 11:15:30,800 - INFO - Resetting parameters of module: autoencoder.edge_decoder.5
2025-06-04 11:15:30,800 - INFO - Resetting parameters of module: autoencoder.edge_decoder.6
2025-06-04 11:15:30,800 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-04 11:15:30,800 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-04 11:15:30,800 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-04 11:15:30,801 - INFO - Optimizer and scheduler reset.
2025-06-04 11:15:30,801 - DEBUG - Updated reference mean: node=[ 1.7384687e-08 -1.7384687e-08 -9.9341078e-09 -1.7384687e-08
  3.4769375e-08 -2.7318796e-08 -1.9868216e-08 -4.9670539e-09
  0.0000000e+00  1.2417634e-08  9.9341078e-09 -1.2417635e-09
 -2.4835268e-08  4.4703484e-08 -9.9341078e-09 -1.9868216e-08
  1.9868216e-08 -1.9868216e-08 -5.4637592e-08], edge=[ 1.1290323e+00  3.1451614e+00 -1.5381843e-08 -7.6909217e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.6909217e-09
 -7.6909217e-09 -3.8454608e-09  7.6909217e-09  0.0000000e+00
  7.6909217e-09  7.6909217e-09 -3.8454608e-08 -3.8454608e-09
 -3.8454608e-09 -3.8454608e-09 -3.8454608e-09 -3.8454608e-09
 -3.8454608e-09 -1.5381843e-08]
2025-06-04 11:15:30,802 - DEBUG - Updated reference std: node=[1.0105823 1.0105823 1.0105823 1.0105822 1.0105823 1.0105823 1.0105823
 1.0105823 1.0105823 1.0105823 1.0105823 1.0105823 1.0105823 1.0105822
 1.0105823 1.0105822 1.0105823 1.0105823 1.0105823], edge=[0.38342166 2.141294   1.0081635  1.0081635  1.0081633  1.0081633
 1.0081635  1.0081635  1.0081633  1.0081635  1.0081635  1.0081633
 1.0081633  1.0081635  1.0081633  1.0081633  1.0081633  1.0081633
 1.0081633  1.0081633  1.0081633  1.0081633 ]
2025-06-04 11:15:30,802 - INFO - Online update complete. Loss: 0.0000
2025-06-04 11:15:30,802 - INFO - Running anomaly detection...
2025-06-04 11:15:30,802 - INFO - Starting anomaly detection.
2025-06-04 11:15:31,226 - DEBUG - Node reconstruction errors: [  6.791864  694.2962      4.7057586   4.7057586   4.7057586   7.314642
   4.7057586   6.791864    4.7057586   7.594762    4.7057586   6.8997393
 538.3918      7.594762    6.8997393   8.883453  107.90647     4.7057586
   4.7057586   8.723553    4.7057586   7.314642    6.8997393   6.8997393
   6.8997393   6.8997393 696.0012      6.8997393   4.7057586   4.7057586
   6.8997393 554.9268      4.7057586   6.8997393   6.8997393   4.7057586
   6.8997393   5.0418086   6.8997393   6.8997393   4.7057586   6.8997393
   5.0418086   9.601616    5.0418086   5.04181     7.5947633   5.04181  ]
2025-06-04 11:15:31,227 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.19999999 0.19999999 0.8        0.8
 0.8        0.8        0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999963 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.78738683 0.78525686 0.786511   0.7949998
 0.78948945 0.7874899  0.18447566 0.787824   0.7808572  0.78843355
 0.7762434  0.7809136  0.7769992  0.778483   0.7797123  0.77711785
 0.8        0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.8       ]
2025-06-04 11:15:31,312 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_111531_update_6.json
2025-06-04 11:15:31,313 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 11:15:31,325 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_111531_update_6.pth and as latest_checkpoint.pth
2025-06-04 11:15:31,325 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028294.dot): 0.0000
2025-06-04 11:15:31,325 - WARNING - Detected 4 anomalous nodes (reconstruction-based):
2025-06-04 11:15:31,325 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 694.2962, MLP Score: 0.9998
2025-06-04 11:15:31,326 - WARNING -   Node ID: 192.168.27.13, Recon Error: 538.3918, MLP Score: 0.0014
2025-06-04 11:15:31,326 - WARNING -   Node ID: 192.168.27.10, Recon Error: 696.0012, MLP Score: 0.0104
2025-06-04 11:15:31,326 - WARNING -   Node ID: 192.168.27.12, Recon Error: 554.9268, MLP Score: 0.9337
2025-06-04 11:15:31,326 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 11:15:31,809 - INFO - Starting 3D embedding visualization...
2025-06-04 11:15:42,703 - DEBUG - colorbar update normal <matplotlib.colors.Normalize object at 0x7ed124709d00> <matplotlib.colors.Normalize object at 0x7ed124709d00>
2025-06-04 11:15:42,705 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7ed12523b620>
2025-06-04 11:15:42,707 - DEBUG - colorbar update normal <matplotlib.colors.Normalize object at 0x7ed124709d00> <matplotlib.colors.Normalize object at 0x7ed124709d00>
2025-06-04 11:15:42,709 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7ed12523b620>
2025-06-04 11:15:42,713 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7ed12523bd10>
2025-06-04 11:15:42,937 - INFO - 3D embeddings visualization saved to vis/embeddings_3d_6_updates_20250604_111531.png
2025-06-04 11:15:42,938 - INFO - Performing visualization of node and edge features.
2025-06-04 11:15:42,938 - INFO - Starting visualization of node features.
2025-06-04 11:15:42,938 - INFO - Graph has 48 nodes and 19 features.
2025-06-04 11:15:42,938 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, http_ratio, ssl_ratio
2025-06-04 11:15:42,938 - INFO - Calculating feature statistics:
2025-06-04 11:15:42,939 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 3, 'mean': np.float32(1.9868216e-08), 'std': np.float32(1.0), 'min': np.float32(-0.30681947), 'max': np.float32(3.3146563)}
2025-06-04 11:15:42,939 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 3, 'mean': np.float32(-1.9868216e-08), 'std': np.float32(1.0), 'min': np.float32(-3.3146563), 'max': np.float32(0.30681947)}
2025-06-04 11:15:42,939 - INFO - - server_score: {'name': 'server_score', 'unique': 5, 'mean': np.float32(4.967054e-09), 'std': np.float32(1.0), 'min': np.float32(-1.9474404), 'max': np.float32(4.976149)}
2025-06-04 11:15:42,939 - INFO - - client_score: {'name': 'client_score', 'unique': 6, 'mean': np.float32(-2.4835268e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.27038658), 'max': np.float32(5.1146607)}
2025-06-04 11:15:42,940 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 2, 'mean': np.float32(2.4835268e-08), 'std': np.float32(1.0), 'min': np.float32(-0.30151135), 'max': np.float32(3.3166249)}
2025-06-04 11:15:42,940 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 4, 'mean': np.float32(-2.7318796e-08), 'std': np.float32(1.0), 'min': np.float32(-0.29470298), 'max': np.float32(3.9405174)}
2025-06-04 11:15:42,940 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 4, 'mean': np.float32(-1.7384687e-08), 'std': np.float32(1.0), 'min': np.float32(-4.16387), 'max': np.float32(0.28778362)}
2025-06-04 11:15:42,940 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 5, 'mean': np.float32(-2.483527e-09), 'std': np.float32(1.0), 'min': np.float32(-0.2806588), 'max': np.float32(4.6825705)}
2025-06-04 11:15:42,940 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 3, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.5491934), 'max': np.float32(6.1967735)}
2025-06-04 11:15:42,940 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 5, 'mean': np.float32(-9.934108e-09), 'std': np.float32(1.0), 'min': np.float32(-0.30420706), 'max': np.float32(4.142791)}
2025-06-04 11:15:42,940 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 5, 'mean': np.float32(1.4901161e-08), 'std': np.float32(0.99999994), 'min': np.float32(-2.77095), 'max': np.float32(0.43216652)}
2025-06-04 11:15:42,940 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 2, 'mean': np.float32(-1.4901161e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.34099716), 'max': np.float32(2.9325757)}
2025-06-04 11:15:42,941 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 2, 'mean': np.float32(-2.9802322e-08), 'std': np.float32(1.0), 'min': np.float32(-3.3166249), 'max': np.float32(0.30151135)}
2025-06-04 11:15:42,941 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 2, 'mean': np.float32(4.4703484e-08), 'std': np.float32(0.9999999), 'min': np.float32(-1.2354414), 'max': np.float32(0.8094272)}
2025-06-04 11:15:42,941 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 2, 'mean': np.float32(-1.9868216e-08), 'std': np.float32(1.0), 'min': np.float32(-0.80942726), 'max': np.float32(1.2354416)}
2025-06-04 11:15:42,941 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 2, 'mean': np.float32(-2.9802322e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.7405316), 'max': np.float32(1.3503811)}
2025-06-04 11:15:42,941 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 2, 'mean': np.float32(2.9802322e-08), 'std': np.float32(1.0), 'min': np.float32(-0.7405316), 'max': np.float32(1.3503813)}
2025-06-04 11:15:42,941 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 6, 'mean': np.float32(-1.2417634e-08), 'std': np.float32(1.0), 'min': np.float32(-2.7371583), 'max': np.float32(0.4274241)}
2025-06-04 11:15:42,941 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 6, 'mean': np.float32(-3.228585e-08), 'std': np.float32(1.0), 'min': np.float32(-1.8509557), 'max': np.float32(1.5174342)}
2025-06-04 11:15:42,967 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7ed1250af710>
2025-06-04 11:15:43,385 - DEBUG - Plotted correlation matrix of node features.
2025-06-04 11:15:43,444 - DEBUG - Plotted ranges of node feature values.
2025-06-04 11:15:43,470 - DEBUG - Plotted sparsity of node features.
2025-06-04 11:15:45,330 - INFO - Node feature visualization saved to vis/node_features_20250604_111543.png
2025-06-04 11:15:45,330 - INFO - Finished visualization of node features.
2025-06-04 11:15:45,331 - INFO - Performing additional feature analysis:
2025-06-04 11:15:45,331 - INFO - - Maximum correlation between different features: 1.00
2025-06-04 11:15:45,331 - INFO - Starting visualization of edge features.
2025-06-04 11:15:45,331 - INFO - Graph has 62 edges and 22 edge features.
2025-06-04 11:15:45,331 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-04 11:15:45,331 - ERROR - Error during 2D feature visualization: Expected 22 names, got 10
2025-06-04 11:15:45,332 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 491, in monitor_new_files
    visualize_edge_features(main_data, save_path=visualization_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/visualization.py", line 197, in visualize_edge_features
    raise ValueError(f"Expected {num_features} names, got {len(edge_feature_names)}")
ValueError: Expected 22 names, got 10

2025-06-04 11:15:45,332 - INFO - 
--- Processing file: nw_graph_encoded_1749028309.dot ---
2025-06-04 11:15:45,332 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028309.dot
2025-06-04 11:15:45,332 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028309.dot file.
2025-06-04 11:15:45,334 - INFO - Parsed 52 nodes.
2025-06-04 11:15:45,335 - INFO - Parsed 68 edges.
2025-06-04 11:15:45,338 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 11:15:45,338 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 11:15:45,339 - DEBUG - Initial node features tensor shape: torch.Size([52, 19])
2025-06-04 11:15:45,340 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 11:15:45,340 - DEBUG - Node features tensor shape after scaling: torch.Size([52, 19])
2025-06-04 11:15:45,341 - DEBUG - Edge index tensor shape: torch.Size([2, 68])
2025-06-04 11:15:45,341 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 11:15:45,342 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-04 11:15:45,342 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-04 11:15:45,343 - DEBUG - Shape of encoded categorical edge features: torch.Size([68, 2])
2025-06-04 11:15:45,343 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 11:15:45,344 - DEBUG - Shape of scaled numerical edge features: torch.Size([68, 20])
2025-06-04 11:15:45,344 - DEBUG - Final edge attributes tensor shape: torch.Size([68, 22])
2025-06-04 11:15:45,344 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 11:15:45,344 - INFO - Performing online update...
2025-06-04 11:15:45,344 - INFO - Starting online update for 50 steps.
2025-06-04 11:15:45,345 - DEBUG - Updated RunningStats: new_mean=[ 5.33649461e-10 -5.16719715e-10 -2.15975792e-09  2.38965278e-09
 -2.73023491e-08  1.46760851e-08 -1.05745877e-08 -2.30180573e-09
 -3.08249302e-09  9.23374763e-10  1.64873120e-09 -1.63924287e-09
  4.03793622e-09 -3.45488879e-09  9.89387977e-10  9.40529057e-10
 -4.03041618e-09  1.46680340e-09 -5.31201418e-09], new_M2=[174715.00516106 174715.00508705 174715.00028756 174715.00398281
 174714.9987251  174714.99837582 174714.99619407 174714.99843348
 174714.99347852 174714.99832987 174715.00185368 174714.99394074
 174714.9927554  139069.99641683 139070.00025295 139069.99904875
 139070.00005241 174715.00042573 174715.0074025 ], new_n=174715
2025-06-04 11:15:45,345 - DEBUG - Updated RunningStats: new_mean=[ 1.41913526e+00  5.52936506e+00  1.17503436e-10  3.26602047e-10
  1.67637801e-10 -1.56785433e-10 -1.36084136e-09  2.98812140e-10
  3.77745265e-10 -3.17119407e-10  4.78385158e-10 -3.99465293e-09
 -8.79819728e-10  8.49510488e-10  4.17571649e-10 -1.72785495e-10
 -1.72785495e-10 -1.72785495e-10 -1.72785495e-10 -1.72785495e-10
 -1.72785495e-10 -6.55909613e-11], new_M2=[  96768.96825435 1668857.92997169  377846.99912355  377847.00679388
  377847.0056336   377846.99377152  377847.00029265  377846.99923884
  377847.00168708  377846.99936037  377846.99376913  377847.00893413
  377847.00114145  377846.9996572   377847.00194545  377846.9945097
  377846.9945097   377846.9945097   377846.9945097   377846.9945097
  377846.9945097   377846.99962642], new_n=377847
2025-06-04 11:15:45,346 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.00000001 0.99999998
 0.99999998 0.89217824 0.89217825 0.89217825 0.89217825 1.
 1.00000002]
2025-06-04 11:15:45,346 - DEBUG - Calculated standard deviation: [0.50606939 2.10160791 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 11:15:45,346 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 11:15:45,346 - DEBUG - Online update step: 1/50
2025-06-04 11:15:45,346 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,346 - DEBUG - Online update step: 2/50
2025-06-04 11:15:45,346 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,346 - DEBUG - Online update step: 3/50
2025-06-04 11:15:45,346 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,346 - DEBUG - Online update step: 4/50
2025-06-04 11:15:45,347 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,347 - DEBUG - Online update step: 5/50
2025-06-04 11:15:45,347 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,347 - DEBUG - Online update step: 6/50
2025-06-04 11:15:45,347 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,347 - DEBUG - Online update step: 7/50
2025-06-04 11:15:45,347 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,347 - DEBUG - Online update step: 8/50
2025-06-04 11:15:45,347 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,347 - DEBUG - Online update step: 9/50
2025-06-04 11:15:45,347 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,347 - DEBUG - Online update step: 10/50
2025-06-04 11:15:45,347 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,347 - DEBUG - Online update step: 11/50
2025-06-04 11:15:45,347 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,347 - DEBUG - Online update step: 12/50
2025-06-04 11:15:45,347 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,347 - DEBUG - Online update step: 13/50
2025-06-04 11:15:45,347 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,347 - DEBUG - Online update step: 14/50
2025-06-04 11:15:45,347 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,347 - DEBUG - Online update step: 15/50
2025-06-04 11:15:45,347 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,347 - DEBUG - Online update step: 16/50
2025-06-04 11:15:45,348 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,348 - DEBUG - Online update step: 17/50
2025-06-04 11:15:45,348 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,348 - DEBUG - Online update step: 18/50
2025-06-04 11:15:45,348 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,348 - DEBUG - Online update step: 19/50
2025-06-04 11:15:45,348 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,348 - DEBUG - Online update step: 20/50
2025-06-04 11:15:45,348 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,348 - DEBUG - Online update step: 21/50
2025-06-04 11:15:45,348 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,348 - DEBUG - Online update step: 22/50
2025-06-04 11:15:45,348 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,348 - DEBUG - Online update step: 23/50
2025-06-04 11:15:45,348 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,348 - DEBUG - Online update step: 24/50
2025-06-04 11:15:45,348 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,348 - DEBUG - Online update step: 25/50
2025-06-04 11:15:45,348 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,348 - DEBUG - Online update step: 26/50
2025-06-04 11:15:45,348 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,348 - DEBUG - Online update step: 27/50
2025-06-04 11:15:45,348 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,349 - DEBUG - Online update step: 28/50
2025-06-04 11:15:45,349 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,349 - DEBUG - Online update step: 29/50
2025-06-04 11:15:45,349 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,349 - DEBUG - Online update step: 30/50
2025-06-04 11:15:45,349 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,349 - DEBUG - Online update step: 31/50
2025-06-04 11:15:45,349 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,349 - DEBUG - Online update step: 32/50
2025-06-04 11:15:45,349 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,349 - DEBUG - Online update step: 33/50
2025-06-04 11:15:45,349 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,349 - DEBUG - Online update step: 34/50
2025-06-04 11:15:45,349 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,349 - DEBUG - Online update step: 35/50
2025-06-04 11:15:45,349 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,349 - DEBUG - Online update step: 36/50
2025-06-04 11:15:45,349 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,349 - DEBUG - Online update step: 37/50
2025-06-04 11:15:45,349 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,349 - DEBUG - Online update step: 38/50
2025-06-04 11:15:45,349 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,349 - DEBUG - Online update step: 39/50
2025-06-04 11:15:45,349 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,350 - DEBUG - Online update step: 40/50
2025-06-04 11:15:45,350 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,350 - DEBUG - Online update step: 41/50
2025-06-04 11:15:45,350 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,350 - DEBUG - Online update step: 42/50
2025-06-04 11:15:45,350 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,350 - DEBUG - Online update step: 43/50
2025-06-04 11:15:45,350 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,350 - DEBUG - Online update step: 44/50
2025-06-04 11:15:45,350 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,350 - DEBUG - Online update step: 45/50
2025-06-04 11:15:45,350 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,350 - DEBUG - Online update step: 46/50
2025-06-04 11:15:45,350 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,350 - DEBUG - Online update step: 47/50
2025-06-04 11:15:45,350 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,350 - DEBUG - Online update step: 48/50
2025-06-04 11:15:45,350 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,350 - DEBUG - Online update step: 49/50
2025-06-04 11:15:45,350 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,350 - DEBUG - Online update step: 50/50
2025-06-04 11:15:45,350 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:45,350 - WARNING - No successful steps during online update.
2025-06-04 11:15:45,351 - DEBUG - Current node mean: [-4.5849728e-09  4.5849728e-09 -2.2924864e-09  3.6679783e-08
 -9.1699457e-09 -2.7509836e-08 -3.6679783e-08 -1.8339891e-08
 -1.6620525e-08  1.3754918e-08 -2.7509836e-08 -3.6679783e-08
  4.1264755e-08 -3.2094810e-08  3.2094810e-08  3.0948566e-08
 -1.3754918e-08  0.0000000e+00 -4.5849728e-08], current edge mean: [ 1.1176471e+00  3.0882354e+00 -1.4024622e-08 -7.0123112e-09
  7.0123112e-09 -7.0123112e-09 -7.0123112e-09  3.5061556e-09
  7.0123112e-09 -7.0123112e-09 -3.5061556e-09  1.4024622e-08
  1.4024622e-08  7.0123112e-09  1.4024622e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  7.0123112e-09]
2025-06-04 11:15:45,351 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 1.1616
2025-06-04 11:15:45,351 - WARNING - Feature drift detected (1 consecutive)
2025-06-04 11:15:45,352 - DEBUG - Updated reference mean: node=[-4.5849728e-09  4.5849728e-09 -2.2924864e-09  3.6679783e-08
 -9.1699457e-09 -2.7509836e-08 -3.6679783e-08 -1.8339891e-08
 -1.6620525e-08  1.3754918e-08 -2.7509836e-08 -3.6679783e-08
  4.1264755e-08 -3.2094810e-08  3.2094810e-08  3.0948566e-08
 -1.3754918e-08  0.0000000e+00 -4.5849728e-08], edge=[ 1.1176471e+00  3.0882354e+00 -1.4024622e-08 -7.0123112e-09
  7.0123112e-09 -7.0123112e-09 -7.0123112e-09  3.5061556e-09
  7.0123112e-09 -7.0123112e-09 -3.5061556e-09  1.4024622e-08
  1.4024622e-08  7.0123112e-09  1.4024622e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  7.0123112e-09]
2025-06-04 11:15:45,352 - DEBUG - Updated reference std: node=[1.0097563 1.0097563 1.0097563 1.0097563 1.0097563 1.0097563 1.0097563
 1.0097563 1.0097563 1.0097563 1.0097563 1.0097563 1.0097563 1.0097563
 1.0097563 1.0097563 1.0097563 1.0097563 1.0097563], edge=[0.36770412 2.183625   1.0074351  1.007435   1.0074351  1.0074351
 1.0074351  1.0074351  1.0074351  1.0074351  1.007435   1.0074351
 1.0074351  1.0074351  1.0074351  1.0074351  1.0074351  1.0074351
 1.0074351  1.0074351  1.0074351  1.0074351 ]
2025-06-04 11:15:45,352 - INFO - Online update complete. Loss: 0.0000
2025-06-04 11:15:45,352 - INFO - Running anomaly detection...
2025-06-04 11:15:45,353 - INFO - Starting anomaly detection.
2025-06-04 11:15:45,898 - DEBUG - Node reconstruction errors: [  4.5573254   7.424806  752.77136     4.5573254   4.5573254   4.5573254
   4.5573254   7.6361732   4.5573254   7.424806    4.5573254   7.533113
   4.5573254   6.72203   586.38947     7.533113    6.72203     9.468541
 120.45972     4.5573254   4.5573254   9.624217    4.5573254   7.6361732
   6.722031    6.722031    6.72203     6.72203   773.0702      6.72203
   4.5573254   4.5573254   6.72203   603.88855     4.5573254   6.72203
   6.72203     4.5573254   6.72203     4.5573254   4.8369603   6.72203
   6.72203     4.5573254   6.72203     4.8369603   4.6738033   4.8369603
   4.8369603   7.533113    4.557327    4.8369613]
2025-06-04 11:15:45,899 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.19999999 0.19999999 0.8        0.8
 0.8        0.8        0.19999999 0.19999999 0.8        0.8
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19853932 0.19999927 0.19999939
 0.8        0.8        0.8        0.8        0.19999939 0.19999951
 0.19999999 0.19999999 0.19999999 0.19999999 0.7999392  0.7998841
 0.7997957  0.7997934  0.7999164  0.79989904 0.0594517  0.7999024
 0.79985356 0.79993296 0.7998457  0.7998634  0.79985106 0.799855
 0.7997462  0.7998786  0.7998714  0.8        0.8        0.8
 0.8        0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.8       ]
2025-06-04 11:15:46,015 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_111546_update_7.json
2025-06-04 11:15:46,016 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 11:15:46,037 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_111546_update_7.pth and as latest_checkpoint.pth
2025-06-04 11:15:46,038 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028309.dot): 0.0000
2025-06-04 11:15:46,038 - WARNING - Detected 4 anomalous nodes (reconstruction-based):
2025-06-04 11:15:46,038 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 752.7714, MLP Score: 0.9998
2025-06-04 11:15:46,038 - WARNING -   Node ID: 192.168.27.13, Recon Error: 586.3895, MLP Score: 0.0003
2025-06-04 11:15:46,039 - WARNING -   Node ID: 192.168.27.10, Recon Error: 773.0702, MLP Score: 0.0450
2025-06-04 11:15:46,039 - WARNING -   Node ID: 192.168.27.12, Recon Error: 603.8885, MLP Score: 0.9637
2025-06-04 11:15:46,039 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 11:15:46,039 - INFO - 
--- Processing file: nw_graph_encoded_1749028324.dot ---
2025-06-04 11:15:46,039 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028324.dot
2025-06-04 11:15:46,039 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028324.dot file.
2025-06-04 11:15:46,044 - INFO - Parsed 54 nodes.
2025-06-04 11:15:46,045 - INFO - Parsed 71 edges.
2025-06-04 11:15:46,048 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 11:15:46,049 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 11:15:46,050 - DEBUG - Initial node features tensor shape: torch.Size([54, 19])
2025-06-04 11:15:46,051 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 11:15:46,051 - DEBUG - Node features tensor shape after scaling: torch.Size([54, 19])
2025-06-04 11:15:46,051 - DEBUG - Edge index tensor shape: torch.Size([2, 71])
2025-06-04 11:15:46,051 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 11:15:46,053 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-04 11:15:46,054 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-04 11:15:46,054 - DEBUG - Shape of encoded categorical edge features: torch.Size([71, 2])
2025-06-04 11:15:46,055 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 11:15:46,056 - DEBUG - Shape of scaled numerical edge features: torch.Size([71, 20])
2025-06-04 11:15:46,056 - DEBUG - Final edge attributes tensor shape: torch.Size([71, 22])
2025-06-04 11:15:46,056 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 11:15:46,056 - INFO - Performing online update...
2025-06-04 11:15:46,056 - INFO - Starting online update for 50 steps.
2025-06-04 11:15:46,057 - DEBUG - Updated RunningStats: new_mean=[ 5.31502232e-10 -5.14428509e-10 -2.15926112e-09  2.38277556e-09
 -2.72939132e-08  1.46790536e-08 -1.05757540e-08 -2.30569867e-09
 -3.08358688e-09  9.23942079e-10  1.64975650e-09 -1.64044162e-09
  4.04044011e-09 -3.47530733e-09  9.83625506e-10  9.42284742e-10
 -4.02712458e-09  1.46218301e-09 -5.30559820e-09], new_M2=[174769.00516187 174769.00508787 174769.00028645 174769.00398249
 174768.99872325 174768.99837619 174768.99619572 174768.99842958
 174768.99348024 174768.99833024 174769.00185759 174768.99393758
 174768.99275574 139123.99641803 139124.00025093 139123.99904699
 139124.00005065 174769.0004274  174769.00740041], new_n=174769
2025-06-04 11:15:46,058 - DEBUG - Updated RunningStats: new_mean=[ 1.41907768e+00  5.52890574e+00  1.17920015e-10  3.27506713e-10
  1.67295798e-10 -1.56514471e-10 -1.35896415e-09  2.98459048e-10
  3.77901018e-10 -3.17109116e-10  4.80306193e-10 -3.99276392e-09
 -8.79748080e-10  8.53412139e-10  4.12761646e-10 -1.73152259e-10
 -1.73152259e-10 -1.73152259e-10 -1.73152259e-10 -1.73152259e-10
 -1.73152259e-10 -6.63672309e-11], new_M2=[  96784.73371737 1669607.73368036  377917.9991254   377918.00680076
  377918.00563283  377917.99377349  377918.00029472  377917.99923815
  377918.00168891  377917.99936133  377917.99377438  377918.00893272
  377918.00114053  377917.99965817  377918.00194482  377917.99450679
  377917.99450679  377917.99450679  377917.99450679  377917.99450679
  377917.99450679  377917.99962156], new_n=377918
2025-06-04 11:15:46,058 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.00000001 0.99999998
 0.99999998 0.89221356 0.89221358 0.89221357 0.89221358 1.
 1.00000002]
2025-06-04 11:15:46,059 - DEBUG - Calculated standard deviation: [0.50606306 2.1018825  1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 11:15:46,059 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 11:15:46,059 - DEBUG - Online update step: 1/50
2025-06-04 11:15:46,059 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,059 - DEBUG - Online update step: 2/50
2025-06-04 11:15:46,059 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,059 - DEBUG - Online update step: 3/50
2025-06-04 11:15:46,059 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,059 - DEBUG - Online update step: 4/50
2025-06-04 11:15:46,060 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,060 - DEBUG - Online update step: 5/50
2025-06-04 11:15:46,060 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,060 - DEBUG - Online update step: 6/50
2025-06-04 11:15:46,060 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,060 - DEBUG - Online update step: 7/50
2025-06-04 11:15:46,061 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,061 - DEBUG - Online update step: 8/50
2025-06-04 11:15:46,061 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,061 - DEBUG - Online update step: 9/50
2025-06-04 11:15:46,061 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,061 - DEBUG - Online update step: 10/50
2025-06-04 11:15:46,061 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,061 - DEBUG - Online update step: 11/50
2025-06-04 11:15:46,061 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,061 - DEBUG - Online update step: 12/50
2025-06-04 11:15:46,061 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,061 - DEBUG - Online update step: 13/50
2025-06-04 11:15:46,061 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,061 - DEBUG - Online update step: 14/50
2025-06-04 11:15:46,062 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,062 - DEBUG - Online update step: 15/50
2025-06-04 11:15:46,062 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,062 - DEBUG - Online update step: 16/50
2025-06-04 11:15:46,062 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,062 - DEBUG - Online update step: 17/50
2025-06-04 11:15:46,062 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,062 - DEBUG - Online update step: 18/50
2025-06-04 11:15:46,062 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,062 - DEBUG - Online update step: 19/50
2025-06-04 11:15:46,062 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,062 - DEBUG - Online update step: 20/50
2025-06-04 11:15:46,062 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,062 - DEBUG - Online update step: 21/50
2025-06-04 11:15:46,062 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,062 - DEBUG - Online update step: 22/50
2025-06-04 11:15:46,062 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,062 - DEBUG - Online update step: 23/50
2025-06-04 11:15:46,062 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,062 - DEBUG - Online update step: 24/50
2025-06-04 11:15:46,062 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,062 - DEBUG - Online update step: 25/50
2025-06-04 11:15:46,063 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,063 - DEBUG - Online update step: 26/50
2025-06-04 11:15:46,063 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,063 - DEBUG - Online update step: 27/50
2025-06-04 11:15:46,063 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,063 - DEBUG - Online update step: 28/50
2025-06-04 11:15:46,063 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,063 - DEBUG - Online update step: 29/50
2025-06-04 11:15:46,063 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,063 - DEBUG - Online update step: 30/50
2025-06-04 11:15:46,063 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,063 - DEBUG - Online update step: 31/50
2025-06-04 11:15:46,063 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,063 - DEBUG - Online update step: 32/50
2025-06-04 11:15:46,063 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,063 - DEBUG - Online update step: 33/50
2025-06-04 11:15:46,063 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,063 - DEBUG - Online update step: 34/50
2025-06-04 11:15:46,063 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,063 - DEBUG - Online update step: 35/50
2025-06-04 11:15:46,063 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,063 - DEBUG - Online update step: 36/50
2025-06-04 11:15:46,063 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,063 - DEBUG - Online update step: 37/50
2025-06-04 11:15:46,063 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,064 - DEBUG - Online update step: 38/50
2025-06-04 11:15:46,064 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,064 - DEBUG - Online update step: 39/50
2025-06-04 11:15:46,064 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,064 - DEBUG - Online update step: 40/50
2025-06-04 11:15:46,064 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,064 - DEBUG - Online update step: 41/50
2025-06-04 11:15:46,064 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,064 - DEBUG - Online update step: 42/50
2025-06-04 11:15:46,064 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,064 - DEBUG - Online update step: 43/50
2025-06-04 11:15:46,064 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,064 - DEBUG - Online update step: 44/50
2025-06-04 11:15:46,064 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,064 - DEBUG - Online update step: 45/50
2025-06-04 11:15:46,064 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,064 - DEBUG - Online update step: 46/50
2025-06-04 11:15:46,064 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,064 - DEBUG - Online update step: 47/50
2025-06-04 11:15:46,064 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,064 - DEBUG - Online update step: 48/50
2025-06-04 11:15:46,064 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,064 - DEBUG - Online update step: 49/50
2025-06-04 11:15:46,064 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,065 - DEBUG - Online update step: 50/50
2025-06-04 11:15:46,065 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,065 - WARNING - No successful steps during online update.
2025-06-04 11:15:46,066 - DEBUG - Current node mean: [-2.2075794e-08  2.2075794e-08  8.8303178e-09 -3.5321271e-08
  2.8698533e-08  1.4349267e-08 -2.7042848e-08 -3.0906111e-08
 -7.1746333e-09  0.0000000e+00 -2.8698533e-08  8.8303178e-09
 -8.8303178e-09 -9.1614545e-08 -3.3113693e-08  0.0000000e+00
  0.0000000e+00  2.6490953e-08 -5.2981907e-08], current edge mean: [ 1.1126760e+00  3.0845070e+00 -6.7160162e-09  3.3580081e-09
  3.3580081e-09  5.0370121e-09  2.0148049e-08  0.0000000e+00
  2.0148049e-08  1.6790040e-09  1.3432032e-08 -5.0370121e-09
  1.1753029e-08 -3.3580081e-09 -1.3432032e-08  6.7160162e-09
  6.7160162e-09  6.7160162e-09  6.7160162e-09  6.7160162e-09
  6.7160162e-09 -6.7160162e-09]
2025-06-04 11:15:46,066 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 1.1630
2025-06-04 11:15:46,066 - WARNING - Feature drift detected (2 consecutive)
2025-06-04 11:15:46,067 - DEBUG - Updated reference mean: node=[-2.2075794e-08  2.2075794e-08  8.8303178e-09 -3.5321271e-08
  2.8698533e-08  1.4349267e-08 -2.7042848e-08 -3.0906111e-08
 -7.1746333e-09  0.0000000e+00 -2.8698533e-08  8.8303178e-09
 -8.8303178e-09 -9.1614545e-08 -3.3113693e-08  0.0000000e+00
  0.0000000e+00  2.6490953e-08 -5.2981907e-08], edge=[ 1.1126760e+00  3.0845070e+00 -6.7160162e-09  3.3580081e-09
  3.3580081e-09  5.0370121e-09  2.0148049e-08  0.0000000e+00
  2.0148049e-08  1.6790040e-09  1.3432032e-08 -5.0370121e-09
  1.1753029e-08 -3.3580081e-09 -1.3432032e-08  6.7160162e-09
  6.7160162e-09  6.7160162e-09  6.7160162e-09  6.7160162e-09
  6.7160162e-09 -6.7160162e-09]
2025-06-04 11:15:46,067 - DEBUG - Updated reference std: node=[1.0093899 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899
 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899
 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899], edge=[0.36052722 2.1563625  1.0071175  1.0071176  1.0071175  1.0071175
 1.0071175  1.0071175  1.0071175  1.0071175  1.0071175  1.0071175
 1.0071175  1.0071175  1.0071175  1.0071175  1.0071175  1.0071175
 1.0071175  1.0071175  1.0071175  1.0071175 ]
2025-06-04 11:15:46,067 - INFO - Online update complete. Loss: 0.0000
2025-06-04 11:15:46,067 - INFO - Running anomaly detection...
2025-06-04 11:15:46,068 - INFO - Starting anomaly detection.
2025-06-04 11:15:46,640 - DEBUG - Node reconstruction errors: [  4.285466    7.3428555 790.1793      4.285466    4.285466    4.285466
   4.285466    7.1411557   4.285466    7.3428555   4.285466    7.2249827
   4.2854667   6.5272975 611.56714     7.2249827   6.5272956   9.865952
 126.87738     4.285466    4.285466    9.704858    4.285466    7.1411557
   6.5272965   6.5272965   6.5272965   6.5272975 802.34595     6.5272956
   4.285466    4.285466    6.5272956 624.41113     4.285466    6.5272956
   6.5272956   4.285466    6.5272956   4.285466    4.5550933   4.2854667
   6.5272956   6.5272956   4.285466    6.5272956   4.5550933   4.6286783
   4.5550933   7.1411557   4.5550933   8.2861      4.2854667   4.5550923]
2025-06-04 11:15:46,641 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.19999999 0.19999999 0.8        0.8
 0.8        0.8        0.19999999 0.19999999 0.8        0.8
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19469535 0.19999856 0.19999892
 0.8        0.8        0.8        0.8        0.1999988  0.19999903
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.79998624
 0.7999742  0.79995495 0.79993725 0.7999815  0.7999776  0.30404922
 0.7999783  0.7999661  0.7999867  0.79996514 0.79996836 0.7999661
 0.7999675  0.7999418  0.7999729  0.79997    0.35506788 0.8
 0.8        0.8        0.8        0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.8        0.8       ]
2025-06-04 11:15:46,757 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_111546_update_8.json
2025-06-04 11:15:46,758 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 11:15:46,776 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_111546_update_8.pth and as latest_checkpoint.pth
2025-06-04 11:15:46,776 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028324.dot): 0.0000
2025-06-04 11:15:46,776 - WARNING - Detected 4 anomalous nodes (reconstruction-based):
2025-06-04 11:15:46,776 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 790.1793, MLP Score: 0.9999
2025-06-04 11:15:46,776 - WARNING -   Node ID: 192.168.27.13, Recon Error: 611.5671, MLP Score: 0.0001
2025-06-04 11:15:46,776 - WARNING -   Node ID: 192.168.27.10, Recon Error: 802.3459, MLP Score: 0.0391
2025-06-04 11:15:46,776 - WARNING -   Node ID: 192.168.27.12, Recon Error: 624.4111, MLP Score: 0.9946
2025-06-04 11:15:46,777 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 11:15:46,777 - INFO - 
--- Processing file: nw_graph_encoded_1749028339.dot ---
2025-06-04 11:15:46,777 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028339.dot
2025-06-04 11:15:46,777 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028339.dot file.
2025-06-04 11:15:46,778 - INFO - Parsed 54 nodes.
2025-06-04 11:15:46,780 - INFO - Parsed 71 edges.
2025-06-04 11:15:46,782 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 11:15:46,783 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 11:15:46,783 - DEBUG - Initial node features tensor shape: torch.Size([54, 19])
2025-06-04 11:15:46,784 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 11:15:46,785 - DEBUG - Node features tensor shape after scaling: torch.Size([54, 19])
2025-06-04 11:15:46,785 - DEBUG - Edge index tensor shape: torch.Size([2, 71])
2025-06-04 11:15:46,785 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 11:15:46,786 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-04 11:15:46,786 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-04 11:15:46,787 - DEBUG - Shape of encoded categorical edge features: torch.Size([71, 2])
2025-06-04 11:15:46,787 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 11:15:46,788 - DEBUG - Shape of scaled numerical edge features: torch.Size([71, 20])
2025-06-04 11:15:46,788 - DEBUG - Final edge attributes tensor shape: torch.Size([71, 22])
2025-06-04 11:15:46,788 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 11:15:46,788 - INFO - Performing online update...
2025-06-04 11:15:46,788 - INFO - Starting online update for 50 steps.
2025-06-04 11:15:46,789 - DEBUG - Updated RunningStats: new_mean=[ 5.29356330e-10 -5.12138718e-10 -2.15876463e-09  2.37590259e-09
 -2.72854826e-08  1.46820202e-08 -1.05769196e-08 -2.30958921e-09
 -3.08468007e-09  9.24509046e-10  1.65078116e-09 -1.64163963e-09
  4.04294245e-09 -3.49571326e-09  9.77866595e-10  9.44721227e-10
 -4.01701615e-09  1.45756547e-09 -5.29918619e-09], new_M2=[174823.00516269 174823.00508869 174823.00028534 174823.00398216
 174822.99872141 174822.99837656 174822.99619736 174822.99842568
 174822.99348196 174822.99833062 174823.00186149 174822.99393442
 174822.99275608 139177.99641922 139178.00024892 139177.99904903
 139178.00005282 174823.00042907 174823.00739832], new_n=174823
2025-06-04 11:15:46,789 - DEBUG - Updated RunningStats: new_mean=[ 1.41902013e+00  5.52844660e+00  1.17552921e-10  3.26499062e-10
  1.66746958e-10 -1.56780739e-10 -1.35939015e-09  2.99392237e-10
  3.78470646e-10 -3.17256518e-10  4.82226507e-10 -3.99481783e-09
 -8.79871722e-10  8.53586926e-10  4.07953449e-10 -1.73198579e-10
 -1.73198579e-10 -1.73198579e-10 -1.73198579e-10 -1.73198579e-10
 -1.73198579e-10 -6.53692095e-11], new_M2=[  96800.49667583 1670357.37798722  377988.99912433  377989.00679562
  377989.00563193  377988.99377229  377989.00029269  377988.99923776
  377989.00169249  377988.999361    377988.99377964  377989.00893522
  377989.00114181  377988.99965812  377989.0019442   377988.99450724
  377988.99450724  377988.99450724  377988.99450724  377988.99450724
  377988.99450724  377988.99962833], new_n=377989
2025-06-04 11:15:46,790 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.00000001 0.99999998
 0.99999998 0.89224887 0.89224888 0.89224888 0.89224888 1.
 1.00000002]
2025-06-04 11:15:46,790 - DEBUG - Calculated standard deviation: [0.50605674 2.10215686 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 11:15:46,790 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 11:15:46,790 - DEBUG - Online update step: 1/50
2025-06-04 11:15:46,790 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,790 - DEBUG - Online update step: 2/50
2025-06-04 11:15:46,790 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,790 - DEBUG - Online update step: 3/50
2025-06-04 11:15:46,790 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,790 - DEBUG - Online update step: 4/50
2025-06-04 11:15:46,790 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,790 - DEBUG - Online update step: 5/50
2025-06-04 11:15:46,790 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,790 - DEBUG - Online update step: 6/50
2025-06-04 11:15:46,790 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,790 - DEBUG - Online update step: 7/50
2025-06-04 11:15:46,791 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,791 - DEBUG - Online update step: 8/50
2025-06-04 11:15:46,791 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,791 - DEBUG - Online update step: 9/50
2025-06-04 11:15:46,791 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,791 - DEBUG - Online update step: 10/50
2025-06-04 11:15:46,791 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,791 - DEBUG - Online update step: 11/50
2025-06-04 11:15:46,791 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,791 - DEBUG - Online update step: 12/50
2025-06-04 11:15:46,791 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,791 - DEBUG - Online update step: 13/50
2025-06-04 11:15:46,791 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,791 - DEBUG - Online update step: 14/50
2025-06-04 11:15:46,791 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,791 - DEBUG - Online update step: 15/50
2025-06-04 11:15:46,791 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,791 - DEBUG - Online update step: 16/50
2025-06-04 11:15:46,791 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,791 - DEBUG - Online update step: 17/50
2025-06-04 11:15:46,791 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,791 - DEBUG - Online update step: 18/50
2025-06-04 11:15:46,791 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,791 - DEBUG - Online update step: 19/50
2025-06-04 11:15:46,791 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,792 - DEBUG - Online update step: 20/50
2025-06-04 11:15:46,792 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,792 - DEBUG - Online update step: 21/50
2025-06-04 11:15:46,792 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,792 - DEBUG - Online update step: 22/50
2025-06-04 11:15:46,792 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,792 - DEBUG - Online update step: 23/50
2025-06-04 11:15:46,792 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,792 - DEBUG - Online update step: 24/50
2025-06-04 11:15:46,792 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,792 - DEBUG - Online update step: 25/50
2025-06-04 11:15:46,792 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,792 - DEBUG - Online update step: 26/50
2025-06-04 11:15:46,792 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,792 - DEBUG - Online update step: 27/50
2025-06-04 11:15:46,792 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,792 - DEBUG - Online update step: 28/50
2025-06-04 11:15:46,792 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,792 - DEBUG - Online update step: 29/50
2025-06-04 11:15:46,792 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,792 - DEBUG - Online update step: 30/50
2025-06-04 11:15:46,792 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,792 - DEBUG - Online update step: 31/50
2025-06-04 11:15:46,792 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,792 - DEBUG - Online update step: 32/50
2025-06-04 11:15:46,792 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,793 - DEBUG - Online update step: 33/50
2025-06-04 11:15:46,793 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,793 - DEBUG - Online update step: 34/50
2025-06-04 11:15:46,793 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,793 - DEBUG - Online update step: 35/50
2025-06-04 11:15:46,793 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,793 - DEBUG - Online update step: 36/50
2025-06-04 11:15:46,793 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,793 - DEBUG - Online update step: 37/50
2025-06-04 11:15:46,793 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,793 - DEBUG - Online update step: 38/50
2025-06-04 11:15:46,793 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,793 - DEBUG - Online update step: 39/50
2025-06-04 11:15:46,793 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,793 - DEBUG - Online update step: 40/50
2025-06-04 11:15:46,794 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,794 - DEBUG - Online update step: 41/50
2025-06-04 11:15:46,794 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,794 - DEBUG - Online update step: 42/50
2025-06-04 11:15:46,794 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,794 - DEBUG - Online update step: 43/50
2025-06-04 11:15:46,794 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,794 - DEBUG - Online update step: 44/50
2025-06-04 11:15:46,794 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,794 - DEBUG - Online update step: 45/50
2025-06-04 11:15:46,794 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,794 - DEBUG - Online update step: 46/50
2025-06-04 11:15:46,794 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,794 - DEBUG - Online update step: 47/50
2025-06-04 11:15:46,794 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,794 - DEBUG - Online update step: 48/50
2025-06-04 11:15:46,794 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,794 - DEBUG - Online update step: 49/50
2025-06-04 11:15:46,794 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,794 - DEBUG - Online update step: 50/50
2025-06-04 11:15:46,794 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:46,794 - WARNING - No successful steps during online update.
2025-06-04 11:15:46,796 - DEBUG - Current node mean: [-2.2075794e-08  2.2075794e-08  8.8303178e-09 -3.5321271e-08
  2.8698533e-08  1.4349267e-08 -2.7042848e-08 -3.0906111e-08
 -7.1746333e-09  0.0000000e+00 -2.8698533e-08  8.8303178e-09
 -8.8303178e-09 -9.1614545e-08 -3.3113693e-08  2.2075794e-08
  8.8303178e-09  2.6490953e-08 -5.2981907e-08], current edge mean: [ 1.1126760e+00  3.0845070e+00 -6.7160162e-09 -1.6790041e-08
  6.7160162e-09  3.3580081e-09 -6.7160162e-09  6.7160162e-09
  0.0000000e+00  6.7160162e-09  1.3432032e-08 -6.7160162e-09
  7.5555180e-09 -3.3580081e-09 -1.3432032e-08 -6.7160162e-09
 -6.7160162e-09 -6.7160162e-09 -6.7160162e-09 -6.7160162e-09
 -6.7160162e-09 -8.3950207e-09]
2025-06-04 11:15:46,796 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 1.1626
2025-06-04 11:15:46,796 - WARNING - Feature drift detected (3 consecutive)
2025-06-04 11:15:46,796 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-04 11:15:46,796 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-04 11:15:46,797 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-04 11:15:46,797 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-04 11:15:46,797 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-04 11:15:46,797 - INFO - Resetting parameters of module: autoencoder.node_decoder.3
2025-06-04 11:15:46,797 - INFO - Resetting parameters of module: autoencoder.node_decoder.4
2025-06-04 11:15:46,798 - INFO - Resetting parameters of module: autoencoder.node_decoder.5
2025-06-04 11:15:46,798 - INFO - Resetting parameters of module: autoencoder.node_decoder.6
2025-06-04 11:15:46,798 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-04 11:15:46,798 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-04 11:15:46,798 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-04 11:15:46,799 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-04 11:15:46,799 - INFO - Resetting parameters of module: autoencoder.edge_decoder.3
2025-06-04 11:15:46,799 - INFO - Resetting parameters of module: autoencoder.edge_decoder.4
2025-06-04 11:15:46,799 - INFO - Resetting parameters of module: autoencoder.edge_decoder.5
2025-06-04 11:15:46,799 - INFO - Resetting parameters of module: autoencoder.edge_decoder.6
2025-06-04 11:15:46,799 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-04 11:15:46,799 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-04 11:15:46,799 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-04 11:15:46,800 - INFO - Optimizer and scheduler reset.
2025-06-04 11:15:46,800 - DEBUG - Updated reference mean: node=[-2.2075794e-08  2.2075794e-08  8.8303178e-09 -3.5321271e-08
  2.8698533e-08  1.4349267e-08 -2.7042848e-08 -3.0906111e-08
 -7.1746333e-09  0.0000000e+00 -2.8698533e-08  8.8303178e-09
 -8.8303178e-09 -9.1614545e-08 -3.3113693e-08  2.2075794e-08
  8.8303178e-09  2.6490953e-08 -5.2981907e-08], edge=[ 1.1126760e+00  3.0845070e+00 -6.7160162e-09 -1.6790041e-08
  6.7160162e-09  3.3580081e-09 -6.7160162e-09  6.7160162e-09
  0.0000000e+00  6.7160162e-09  1.3432032e-08 -6.7160162e-09
  7.5555180e-09 -3.3580081e-09 -1.3432032e-08 -6.7160162e-09
 -6.7160162e-09 -6.7160162e-09 -6.7160162e-09 -6.7160162e-09
 -6.7160162e-09 -8.3950207e-09]
2025-06-04 11:15:46,801 - DEBUG - Updated reference std: node=[1.0093899 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899
 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899
 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899], edge=[0.36052722 2.1563625  1.0071175  1.0071175  1.0071175  1.0071175
 1.0071175  1.0071175  1.0071175  1.0071175  1.0071175  1.0071175
 1.0071175  1.0071175  1.0071175  1.0071175  1.0071175  1.0071175
 1.0071175  1.0071175  1.0071175  1.0071176 ]
2025-06-04 11:15:46,801 - INFO - Online update complete. Loss: 0.0000
2025-06-04 11:15:46,801 - INFO - Running anomaly detection...
2025-06-04 11:15:46,801 - INFO - Starting anomaly detection.
2025-06-04 11:15:47,290 - DEBUG - Node reconstruction errors: [   8.891122    15.401491   149.87094      8.891122     8.891122
    8.891122     8.891122     8.247111     8.891122    15.401491
    8.891122     7.8946347    8.891121     8.628156   391.74576
    7.8946347    8.628158    11.591677    39.701305     8.891122
    8.891122    12.895507     8.891122     8.247111     8.628156
    8.628156     8.628158     8.628156  1996.2758       8.628158
    8.891122     8.891122     8.628158   733.0157       8.891122
    8.628158     8.628158     8.891122     8.628158     8.891122
    8.045784     8.891121     8.628158     8.628158     8.891122
    8.628158     8.045784     6.511573     8.045784     8.247111
    8.045784     8.243824     8.891124     8.045784 ]
2025-06-04 11:15:47,291 - DEBUG - Edge reconstruction errors: [0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.19999999 0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8       ]
2025-06-04 11:15:47,339 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_111547_update_9.json
2025-06-04 11:15:47,340 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 11:15:47,352 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_111547_update_9.pth and as latest_checkpoint.pth
2025-06-04 11:15:47,352 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028339.dot): 0.0003
2025-06-04 11:15:47,352 - WARNING - Detected 1 anomalous nodes (reconstruction-based):
2025-06-04 11:15:47,352 - WARNING -   Node ID: 192.168.27.10, Recon Error: 1996.2758, MLP Score: 1.0000
2025-06-04 11:15:47,352 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 11:15:47,352 - INFO - 
--- Processing file: nw_graph_encoded_1749028354.dot ---
2025-06-04 11:15:47,352 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028354.dot
2025-06-04 11:15:47,352 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028354.dot file.
2025-06-04 11:15:47,355 - INFO - Parsed 58 nodes.
2025-06-04 11:15:47,357 - INFO - Parsed 81 edges.
2025-06-04 11:15:47,361 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 11:15:47,361 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 11:15:47,362 - DEBUG - Initial node features tensor shape: torch.Size([58, 19])
2025-06-04 11:15:47,363 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 11:15:47,363 - DEBUG - Node features tensor shape after scaling: torch.Size([58, 19])
2025-06-04 11:15:47,363 - DEBUG - Edge index tensor shape: torch.Size([2, 81])
2025-06-04 11:15:47,363 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 11:15:47,364 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-04 11:15:47,365 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-04 11:15:47,365 - DEBUG - Shape of encoded categorical edge features: torch.Size([81, 2])
2025-06-04 11:15:47,366 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 11:15:47,366 - DEBUG - Shape of scaled numerical edge features: torch.Size([81, 20])
2025-06-04 11:15:47,366 - DEBUG - Final edge attributes tensor shape: torch.Size([81, 22])
2025-06-04 11:15:47,366 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 11:15:47,366 - INFO - Performing online update...
2025-06-04 11:15:47,367 - INFO - Starting online update for 50 steps.
2025-06-04 11:15:47,367 - DEBUG - Updated RunningStats: new_mean=[ 5.30629293e-10 -5.13332184e-10 -2.15966761e-09  2.37818208e-09
 -2.72750699e-08  1.46791958e-08 -1.05754567e-08 -2.30780074e-09
 -3.08365702e-09  9.27781141e-10  1.65858400e-09 -1.63973185e-09
  4.04603238e-09 -3.49864385e-09  9.73111495e-10  9.35546334e-10
 -4.02318214e-09  1.45363749e-09 -5.29930325e-09], new_M2=[174881.00516259 174881.00508859 174881.00028638 174881.00398532
 174880.9987246  174880.99837659 174880.99619707 174880.99842467
 174880.99348614 174880.99832543 174881.00186168 174880.99393762
 174880.99275258 139235.99641959 139236.00025012 139235.99905073
 139236.0000566  174881.00043247 174881.00739648], new_n=174881
2025-06-04 11:15:47,368 - DEBUG - Updated RunningStats: new_mean=[ 1.41895152e+00  5.52793134e+00  1.16622451e-10  3.26232042e-10
  1.65597794e-10 -1.58000999e-10 -1.35868507e-09  3.00436606e-10
  3.78547215e-10 -3.15177213e-10  4.82202019e-10 -3.99386343e-09
 -8.81008501e-10  8.51591016e-10  4.10230873e-10 -1.73210739e-10
 -1.73210739e-10 -1.73210739e-10 -1.73210739e-10 -1.73210739e-10
 -1.73210739e-10 -6.56797329e-11], new_M2=[  96818.01238131 1671180.5450975   378069.99911808  378070.0067963
  378070.0056237   378069.99376479  378070.0002932   378069.99924134
  378070.00169391  378069.99936158  378069.99378007  378070.00893397
  378070.00114219  378069.9996606   378070.00194464  378069.99450813
  378069.99450813  378069.99450813  378069.99450813  378069.99450813
  378069.99450813  378069.99962585], new_n=378070
2025-06-04 11:15:47,368 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.00000001 0.99999998
 0.99999998 0.89228676 0.89228677 0.89228677 0.89228677 1.
 1.00000002]
2025-06-04 11:15:47,369 - DEBUG - Calculated standard deviation: [0.5060483  2.10244952 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 11:15:47,369 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 11:15:47,369 - DEBUG - Online update step: 1/50
2025-06-04 11:15:47,369 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,369 - DEBUG - Online update step: 2/50
2025-06-04 11:15:47,369 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,369 - DEBUG - Online update step: 3/50
2025-06-04 11:15:47,369 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,369 - DEBUG - Online update step: 4/50
2025-06-04 11:15:47,369 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,369 - DEBUG - Online update step: 5/50
2025-06-04 11:15:47,369 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,369 - DEBUG - Online update step: 6/50
2025-06-04 11:15:47,369 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,370 - DEBUG - Online update step: 7/50
2025-06-04 11:15:47,370 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,370 - DEBUG - Online update step: 8/50
2025-06-04 11:15:47,370 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,370 - DEBUG - Online update step: 9/50
2025-06-04 11:15:47,370 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,370 - DEBUG - Online update step: 10/50
2025-06-04 11:15:47,370 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,370 - DEBUG - Online update step: 11/50
2025-06-04 11:15:47,370 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,370 - DEBUG - Online update step: 12/50
2025-06-04 11:15:47,370 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,370 - DEBUG - Online update step: 13/50
2025-06-04 11:15:47,370 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,370 - DEBUG - Online update step: 14/50
2025-06-04 11:15:47,370 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,370 - DEBUG - Online update step: 15/50
2025-06-04 11:15:47,370 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,370 - DEBUG - Online update step: 16/50
2025-06-04 11:15:47,370 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,370 - DEBUG - Online update step: 17/50
2025-06-04 11:15:47,370 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,370 - DEBUG - Online update step: 18/50
2025-06-04 11:15:47,371 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,371 - DEBUG - Online update step: 19/50
2025-06-04 11:15:47,371 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,371 - DEBUG - Online update step: 20/50
2025-06-04 11:15:47,371 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,371 - DEBUG - Online update step: 21/50
2025-06-04 11:15:47,371 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,371 - DEBUG - Online update step: 22/50
2025-06-04 11:15:47,371 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,371 - DEBUG - Online update step: 23/50
2025-06-04 11:15:47,371 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,371 - DEBUG - Online update step: 24/50
2025-06-04 11:15:47,371 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,371 - DEBUG - Online update step: 25/50
2025-06-04 11:15:47,371 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,371 - DEBUG - Online update step: 26/50
2025-06-04 11:15:47,371 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,371 - DEBUG - Online update step: 27/50
2025-06-04 11:15:47,371 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,371 - DEBUG - Online update step: 28/50
2025-06-04 11:15:47,371 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,371 - DEBUG - Online update step: 29/50
2025-06-04 11:15:47,371 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,371 - DEBUG - Online update step: 30/50
2025-06-04 11:15:47,372 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,372 - DEBUG - Online update step: 31/50
2025-06-04 11:15:47,372 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,372 - DEBUG - Online update step: 32/50
2025-06-04 11:15:47,372 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,372 - DEBUG - Online update step: 33/50
2025-06-04 11:15:47,372 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,372 - DEBUG - Online update step: 34/50
2025-06-04 11:15:47,372 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,372 - DEBUG - Online update step: 35/50
2025-06-04 11:15:47,372 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,372 - DEBUG - Online update step: 36/50
2025-06-04 11:15:47,372 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,372 - DEBUG - Online update step: 37/50
2025-06-04 11:15:47,372 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,372 - DEBUG - Online update step: 38/50
2025-06-04 11:15:47,372 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,372 - DEBUG - Online update step: 39/50
2025-06-04 11:15:47,372 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,372 - DEBUG - Online update step: 40/50
2025-06-04 11:15:47,372 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,372 - DEBUG - Online update step: 41/50
2025-06-04 11:15:47,372 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,373 - DEBUG - Online update step: 42/50
2025-06-04 11:15:47,373 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,373 - DEBUG - Online update step: 43/50
2025-06-04 11:15:47,373 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,373 - DEBUG - Online update step: 44/50
2025-06-04 11:15:47,373 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,373 - DEBUG - Online update step: 45/50
2025-06-04 11:15:47,373 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,373 - DEBUG - Online update step: 46/50
2025-06-04 11:15:47,373 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,373 - DEBUG - Online update step: 47/50
2025-06-04 11:15:47,373 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,373 - DEBUG - Online update step: 48/50
2025-06-04 11:15:47,373 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,373 - DEBUG - Online update step: 49/50
2025-06-04 11:15:47,373 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,373 - DEBUG - Online update step: 50/50
2025-06-04 11:15:47,373 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,373 - WARNING - No successful steps during online update.
2025-06-04 11:15:47,374 - DEBUG - Current node mean: [-1.0276663e-08  1.0276663e-08 -2.4663992e-08  2.0553326e-08
  2.4663992e-08  1.6442661e-08  1.6442661e-08  0.0000000e+00
  4.1106651e-09  1.2331996e-08  1.6442661e-08  3.2885321e-08
 -1.4387328e-08 -3.2885321e-08  0.0000000e+00 -2.8774656e-08
 -2.0553326e-08 -8.2213303e-09  1.6442661e-08], current edge mean: [ 1.0987654e+00  3.1234567e+00 -1.1773757e-08  8.8303178e-09
 -5.8868785e-09  4.4151589e-09  5.8868785e-09 -5.8868785e-09
  0.0000000e+00  2.0604075e-08 -1.4717196e-08  0.0000000e+00
  0.0000000e+00  8.8303178e-09  1.7660636e-08  5.8868785e-09
  5.8868785e-09  5.8868785e-09  5.8868785e-09  5.8868785e-09
  5.8868785e-09 -5.8868785e-09]
2025-06-04 11:15:47,374 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 1.1437
2025-06-04 11:15:47,374 - WARNING - Feature drift detected (1 consecutive)
2025-06-04 11:15:47,375 - DEBUG - Updated reference mean: node=[-1.0276663e-08  1.0276663e-08 -2.4663992e-08  2.0553326e-08
  2.4663992e-08  1.6442661e-08  1.6442661e-08  0.0000000e+00
  4.1106651e-09  1.2331996e-08  1.6442661e-08  3.2885321e-08
 -1.4387328e-08 -3.2885321e-08  0.0000000e+00 -2.8774656e-08
 -2.0553326e-08 -8.2213303e-09  1.6442661e-08], edge=[ 1.0987654e+00  3.1234567e+00 -1.1773757e-08  8.8303178e-09
 -5.8868785e-09  4.4151589e-09  5.8868785e-09 -5.8868785e-09
  0.0000000e+00  2.0604075e-08 -1.4717196e-08  0.0000000e+00
  0.0000000e+00  8.8303178e-09  1.7660636e-08  5.8868785e-09
  5.8868785e-09  5.8868785e-09  5.8868785e-09  5.8868785e-09
  5.8868785e-09 -5.8868785e-09]
2025-06-04 11:15:47,375 - DEBUG - Updated reference std: node=[1.0087337 1.0087337 1.0087337 1.0087339 1.0087339 1.0087337 1.0087337
 1.0087337 1.0087339 1.0087337 1.0087337 1.0087339 1.0087337 1.0087337
 1.0087337 1.0087337 1.0087339 1.0087339 1.0087337], edge=[0.3392985 2.1058414 1.0062306 1.0062306 1.0062306 1.0062306 1.0062306
 1.0062306 1.0062306 1.0062306 1.0062306 1.0062306 1.0062306 1.0062306
 1.0062306 1.0062306 1.0062306 1.0062306 1.0062306 1.0062306 1.0062306
 1.0062306]
2025-06-04 11:15:47,375 - INFO - Online update complete. Loss: 0.0000
2025-06-04 11:15:47,375 - INFO - Running anomaly detection...
2025-06-04 11:15:47,376 - INFO - Starting anomaly detection.
2025-06-04 11:15:47,791 - DEBUG - Node reconstruction errors: [  10.528141   16.418427  133.91058    10.528141   10.528141   10.528141
   10.528141    9.405235   10.528141   16.418427   10.528141    9.269781
   10.528141   10.24838   424.65778    10.598093    9.269781   10.991727
   10.24838    12.86003    36.234863   10.528141   10.528141   13.856341
   10.528141    9.405235   10.24838    10.24838    10.24838   201.55098
   10.24838  1827.7482     10.24838    10.528141   10.528141   10.24838
  720.6775     10.528141   10.24838     9.839159   10.528141   10.24838
   10.528141    9.698135   10.598093   10.528141   10.24838    10.24838
   10.528141   10.24838     9.698135    8.062484    9.698135    9.405235
    9.698135    9.530337   10.528142    9.698134]
2025-06-04 11:15:47,792 - DEBUG - Edge reconstruction errors: [0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.19999999 0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8       ]
2025-06-04 11:15:47,908 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_111547_update_10.json
2025-06-04 11:15:47,908 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 11:15:47,921 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_111547_update_10.pth and as latest_checkpoint.pth
2025-06-04 11:15:47,921 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028354.dot): 0.0003
2025-06-04 11:15:47,921 - WARNING - Detected 2 anomalous nodes (reconstruction-based):
2025-06-04 11:15:47,921 - WARNING -   Node ID: 192.168.27.10, Recon Error: 1827.7482, MLP Score: 1.0000
2025-06-04 11:15:47,921 - WARNING -   Node ID: 192.168.27.12, Recon Error: 720.6775, MLP Score: 1.0000
2025-06-04 11:15:47,921 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 11:15:47,921 - INFO - 
--- Processing file: nw_graph_encoded_1749028369.dot ---
2025-06-04 11:15:47,922 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028369.dot
2025-06-04 11:15:47,922 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028369.dot file.
2025-06-04 11:15:47,926 - INFO - Parsed 68 nodes.
2025-06-04 11:15:47,927 - INFO - Parsed 92 edges.
2025-06-04 11:15:47,932 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 11:15:47,932 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 11:15:47,933 - DEBUG - Initial node features tensor shape: torch.Size([68, 19])
2025-06-04 11:15:47,934 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 11:15:47,934 - DEBUG - Node features tensor shape after scaling: torch.Size([68, 19])
2025-06-04 11:15:47,934 - DEBUG - Edge index tensor shape: torch.Size([2, 92])
2025-06-04 11:15:47,934 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 11:15:47,935 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-04 11:15:47,936 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-04 11:15:47,936 - DEBUG - Shape of encoded categorical edge features: torch.Size([92, 2])
2025-06-04 11:15:47,937 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 11:15:47,937 - DEBUG - Shape of scaled numerical edge features: torch.Size([92, 20])
2025-06-04 11:15:47,937 - DEBUG - Final edge attributes tensor shape: torch.Size([92, 22])
2025-06-04 11:15:47,937 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 11:15:47,937 - INFO - Performing online update...
2025-06-04 11:15:47,938 - INFO - Starting online update for 50 steps.
2025-06-04 11:15:47,938 - DEBUG - Updated RunningStats: new_mean=[ 5.30593394e-10 -5.13217834e-10 -2.16266103e-09  2.37649114e-09
 -2.72692383e-08  1.46724682e-08 -1.05699834e-08 -2.30673338e-09
 -3.08360830e-09  9.31594068e-10  1.66645676e-09 -1.63943521e-09
  4.04922951e-09 -3.49949851e-09  9.69496638e-10  9.35693747e-10
 -4.01344166e-09  1.44963357e-09 -5.29247373e-09], new_M2=[174949.0051692  174949.00509521 174949.00028858 174949.00398332
 174948.99872525 174948.99837503 174948.99619476 174948.99842185
 174948.99347918 174948.99832203 174949.00185407 174948.99394406
 174948.99275323 139303.99642723 139304.00025819 139303.99904885
 139304.00006233 174949.00043459 174949.00739426], new_n=174949
2025-06-04 11:15:47,939 - DEBUG - Updated RunningStats: new_mean=[ 1.41886810e+00  5.52736129e+00  1.16100911e-10  3.26339846e-10
  1.64211608e-10 -1.57942859e-10 -1.35748763e-09  3.01727884e-10
  3.78466203e-10 -3.14149911e-10  4.83522961e-10 -3.99031082e-09
 -8.80331169e-10  8.52487156e-10  4.08712520e-10 -1.74281768e-10
 -1.74281768e-10 -1.74281768e-10 -1.74281768e-10 -1.74281768e-10
 -1.74281768e-10 -6.63262369e-11], new_M2=[  96839.2923033  1672097.39273648  378161.99911631  378162.00679617
  378162.00561585  378161.99376501  378162.00029091  378161.99924602
  378162.0016953   378161.99936182  378161.99378692  378162.00893118
  378162.0011415   378161.99965945  378162.0019433   378161.99450064
  378161.99450064  378161.99450064  378161.99450064  378161.99450064
  378161.99450064  378161.99962189], new_n=378162
2025-06-04 11:15:47,940 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.00000001 0.99999998
 0.99999998 0.89233115 0.89233117 0.89233116 0.89233117 1.
 1.00000002]
2025-06-04 11:15:47,940 - DEBUG - Calculated standard deviation: [0.50604235 2.10277034 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 11:15:47,940 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 11:15:47,940 - DEBUG - Online update step: 1/50
2025-06-04 11:15:47,940 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,940 - DEBUG - Online update step: 2/50
2025-06-04 11:15:47,941 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,941 - DEBUG - Online update step: 3/50
2025-06-04 11:15:47,941 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,941 - DEBUG - Online update step: 4/50
2025-06-04 11:15:47,941 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,941 - DEBUG - Online update step: 5/50
2025-06-04 11:15:47,941 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,941 - DEBUG - Online update step: 6/50
2025-06-04 11:15:47,941 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,941 - DEBUG - Online update step: 7/50
2025-06-04 11:15:47,941 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,941 - DEBUG - Online update step: 8/50
2025-06-04 11:15:47,941 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,941 - DEBUG - Online update step: 9/50
2025-06-04 11:15:47,941 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,941 - DEBUG - Online update step: 10/50
2025-06-04 11:15:47,941 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,941 - DEBUG - Online update step: 11/50
2025-06-04 11:15:47,941 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,941 - DEBUG - Online update step: 12/50
2025-06-04 11:15:47,941 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,941 - DEBUG - Online update step: 13/50
2025-06-04 11:15:47,941 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,942 - DEBUG - Online update step: 14/50
2025-06-04 11:15:47,942 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,942 - DEBUG - Online update step: 15/50
2025-06-04 11:15:47,942 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,942 - DEBUG - Online update step: 16/50
2025-06-04 11:15:47,942 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,942 - DEBUG - Online update step: 17/50
2025-06-04 11:15:47,942 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,942 - DEBUG - Online update step: 18/50
2025-06-04 11:15:47,942 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,942 - DEBUG - Online update step: 19/50
2025-06-04 11:15:47,942 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,942 - DEBUG - Online update step: 20/50
2025-06-04 11:15:47,942 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,942 - DEBUG - Online update step: 21/50
2025-06-04 11:15:47,942 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,942 - DEBUG - Online update step: 22/50
2025-06-04 11:15:47,942 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,942 - DEBUG - Online update step: 23/50
2025-06-04 11:15:47,942 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,942 - DEBUG - Online update step: 24/50
2025-06-04 11:15:47,942 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,942 - DEBUG - Online update step: 25/50
2025-06-04 11:15:47,942 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,942 - DEBUG - Online update step: 26/50
2025-06-04 11:15:47,943 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,943 - DEBUG - Online update step: 27/50
2025-06-04 11:15:47,943 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,943 - DEBUG - Online update step: 28/50
2025-06-04 11:15:47,943 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,943 - DEBUG - Online update step: 29/50
2025-06-04 11:15:47,943 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,943 - DEBUG - Online update step: 30/50
2025-06-04 11:15:47,943 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,943 - DEBUG - Online update step: 31/50
2025-06-04 11:15:47,943 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,943 - DEBUG - Online update step: 32/50
2025-06-04 11:15:47,943 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,943 - DEBUG - Online update step: 33/50
2025-06-04 11:15:47,943 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,943 - DEBUG - Online update step: 34/50
2025-06-04 11:15:47,943 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,943 - DEBUG - Online update step: 35/50
2025-06-04 11:15:47,943 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,943 - DEBUG - Online update step: 36/50
2025-06-04 11:15:47,943 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,943 - DEBUG - Online update step: 37/50
2025-06-04 11:15:47,943 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,943 - DEBUG - Online update step: 38/50
2025-06-04 11:15:47,944 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,944 - DEBUG - Online update step: 39/50
2025-06-04 11:15:47,944 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,944 - DEBUG - Online update step: 40/50
2025-06-04 11:15:47,944 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,944 - DEBUG - Online update step: 41/50
2025-06-04 11:15:47,944 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,944 - DEBUG - Online update step: 42/50
2025-06-04 11:15:47,944 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,944 - DEBUG - Online update step: 43/50
2025-06-04 11:15:47,944 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,944 - DEBUG - Online update step: 44/50
2025-06-04 11:15:47,944 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,944 - DEBUG - Online update step: 45/50
2025-06-04 11:15:47,944 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,944 - DEBUG - Online update step: 46/50
2025-06-04 11:15:47,944 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,944 - DEBUG - Online update step: 47/50
2025-06-04 11:15:47,944 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,944 - DEBUG - Online update step: 48/50
2025-06-04 11:15:47,944 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,944 - DEBUG - Online update step: 49/50
2025-06-04 11:15:47,944 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,944 - DEBUG - Online update step: 50/50
2025-06-04 11:15:47,945 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 11:15:47,945 - WARNING - No successful steps during online update.
2025-06-04 11:15:47,945 - DEBUG - Current node mean: [ 0.0000000e+00  3.5061556e-09 -3.4185017e-08  2.8049245e-08
 -2.1036934e-08  1.7092509e-08  3.8567713e-08 -3.5061556e-09
 -3.3308478e-08 -9.6419281e-09  1.7530778e-09  2.4543089e-08
 -7.0123112e-09 -3.3308478e-08 -3.1555402e-08 -7.0123112e-09
  4.2073868e-08  0.0000000e+00  3.5061557e-08], current edge mean: [ 1.0760870e+00  3.1847825e+00  0.0000000e+00  1.2957532e-09
 -9.0702716e-09  2.5915063e-09  1.2957532e-09 -1.5549038e-08
  5.1830127e-09  6.4787655e-09  4.4055607e-08  9.0702716e-09
  0.0000000e+00 -1.2957531e-08  1.0366025e-08 -2.5915063e-09
 -2.5915063e-09 -2.5915063e-09 -2.5915063e-09 -2.5915063e-09
 -2.5915063e-09 -5.1830127e-09]
2025-06-04 11:15:47,945 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 1.1140
2025-06-04 11:15:47,946 - WARNING - Feature drift detected (2 consecutive)
2025-06-04 11:15:47,946 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  3.5061556e-09 -3.4185017e-08  2.8049245e-08
 -2.1036934e-08  1.7092509e-08  3.8567713e-08 -3.5061556e-09
 -3.3308478e-08 -9.6419281e-09  1.7530778e-09  2.4543089e-08
 -7.0123112e-09 -3.3308478e-08 -3.1555402e-08 -7.0123112e-09
  4.2073868e-08  0.0000000e+00  3.5061557e-08], edge=[ 1.0760870e+00  3.1847825e+00  0.0000000e+00  1.2957532e-09
 -9.0702716e-09  2.5915063e-09  1.2957532e-09 -1.5549038e-08
  5.1830127e-09  6.4787655e-09  4.4055607e-08  9.0702716e-09
  0.0000000e+00 -1.2957531e-08  1.0366025e-08 -2.5915063e-09
 -2.5915063e-09 -2.5915063e-09 -2.5915063e-09 -2.5915063e-09
 -2.5915063e-09 -5.1830127e-09]
2025-06-04 11:15:47,946 - DEBUG - Updated reference std: node=[1.0074351 1.0074351 1.0074351 1.0074351 1.0074351 1.0074351 1.0074351
 1.0074351 1.007435  1.007435  1.007435  1.0074351 1.0074351 1.0074351
 1.0074351 1.0074351 1.0074351 1.0074351 1.0074351], edge=[0.33915523 2.127421   1.0054795  1.0054795  1.0054795  1.0054795
 1.0054795  1.0054796  1.0054795  1.0054795  1.0054796  1.0054795
 1.0054795  1.0054795  1.0054795  1.0054795  1.0054795  1.0054795
 1.0054795  1.0054795  1.0054795  1.0054795 ]
2025-06-04 11:15:47,946 - INFO - Online update complete. Loss: 0.0000
2025-06-04 11:15:47,946 - INFO - Running anomaly detection...
2025-06-04 11:15:47,947 - INFO - Starting anomaly detection.
