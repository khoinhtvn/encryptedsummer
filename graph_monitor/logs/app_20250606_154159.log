2025-06-06 15:41:59,511 - INFO - Application logging to file: logs/app_20250606_154159.log
2025-06-06 15:41:59,511 - INFO - Starting to monitor directory: /home/lu/Desktop/output/ with log level: DEBUG
2025-06-06 15:41:59,512 - INFO - Starting to monitor directory: /home/lu/Desktop/output/ for new and existing files every 30 seconds.
2025-06-06 15:41:59,512 - INFO - Train Mode: train, Visualization Path: vis
2025-06-06 15:41:59,512 - INFO - Found 23 files to process.
2025-06-06 15:41:59,512 - INFO - 
--- Processing file: nw_graph_encoded_1749044168.dot ---
2025-06-06 15:41:59,512 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044168.dot
2025-06-06 15:41:59,512 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044168.dot file.
2025-06-06 15:41:59,512 - INFO - Parsed 20 nodes.
2025-06-06 15:41:59,513 - INFO - Parsed 27 edges.
2025-06-06 15:41:59,513 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:41:59,513 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:41:59,514 - DEBUG - Initial node features tensor shape: torch.Size([20, 19])
2025-06-06 15:41:59,514 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:41:59,515 - DEBUG - Node features tensor shape after scaling: torch.Size([20, 19])
2025-06-06 15:41:59,515 - DEBUG - Edge index tensor shape: torch.Size([2, 27])
2025-06-06 15:41:59,515 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:41:59,515 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 2
2025-06-06 15:41:59,516 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 5
2025-06-06 15:41:59,516 - DEBUG - Shape of encoded categorical edge features: torch.Size([27, 2])
2025-06-06 15:41:59,516 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:41:59,516 - DEBUG - Shape of scaled numerical edge features: torch.Size([27, 20])
2025-06-06 15:41:59,516 - DEBUG - Final edge attributes tensor shape: torch.Size([27, 22])
2025-06-06 15:41:59,516 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:41:59,516 - INFO - Initializing HybridGNNAnomalyDetector with node_dim=19, edge_dim=22, hidden_dim=128, embedding_dim=64, heads=4, num_gat_layers=3, gat_heads=4, recon_loss_type=mse, edge_recon_loss_type=bce
2025-06-06 15:41:59,517 - INFO - Initializing GraphAutoencoder with node_dim=19, edge_dim=22, hidden_dim=128, embedding_dim=64, num_gat_layers=3, gat_heads=4, use_batch_norm=True, use_residual=True
2025-06-06 15:41:59,559 - DEBUG - Encoder GATConv layers initialized with final embedding dimension: 64
2025-06-06 15:41:59,561 - DEBUG - Decoder MLP layers initialized with proper weight initialization.
2025-06-06 15:41:59,563 - DEBUG - Anomaly scoring MLPs initialized.
2025-06-06 15:41:59,564 - INFO - Optimizer (AdamW) and scheduler (CosineAnnealingWarmRestarts) initialized.
2025-06-06 15:41:59,564 - INFO - Replay buffer initialized with maxlen=2000, batch_size=16
2025-06-06 15:41:59,564 - INFO - RunningStats initialized.
2025-06-06 15:41:59,564 - INFO - RunningStats initialized.
2025-06-06 15:41:59,564 - INFO - Statistical controls initialized: drift_threshold=0.15
2025-06-06 15:41:59,564 - INFO - Using device: cpu
2025-06-06 15:41:59,564 - INFO - Initialized Hybrid GNN (node_dim=19, edge_dim=22)
2025-06-06 15:41:59,565 - ERROR - Error loading model or running stats during initial setup: name 'os' is not defined
2025-06-06 15:41:59,565 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow.py", line 369, in monitor_new_files
    start_epoch = load_checkpoint(gnn_model, gnn_model.optimizer, gnn_model.scheduler,
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 93, in load_checkpoint
    filepath = os.path.join(model_save_path, filename)
               ^^
NameError: name 'os' is not defined. Did you forget to import 'os'

2025-06-06 15:41:59,565 - ERROR - Cannot proceed without a working model. Skipping this file.
2025-06-06 15:41:59,565 - INFO - 
--- Processing file: nw_graph_encoded_1749044228.dot ---
2025-06-06 15:41:59,565 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044228.dot
2025-06-06 15:41:59,565 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044228.dot file.
2025-06-06 15:41:59,566 - INFO - Parsed 49 nodes.
2025-06-06 15:41:59,566 - INFO - Parsed 66 edges.
2025-06-06 15:41:59,568 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:41:59,568 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:41:59,568 - DEBUG - Initial node features tensor shape: torch.Size([49, 19])
2025-06-06 15:41:59,569 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:41:59,569 - DEBUG - Node features tensor shape after scaling: torch.Size([49, 19])
2025-06-06 15:41:59,569 - DEBUG - Edge index tensor shape: torch.Size([2, 66])
2025-06-06 15:41:59,569 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:41:59,570 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 2
2025-06-06 15:41:59,570 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-06 15:41:59,570 - DEBUG - Shape of encoded categorical edge features: torch.Size([66, 2])
2025-06-06 15:41:59,571 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:41:59,571 - DEBUG - Shape of scaled numerical edge features: torch.Size([66, 20])
2025-06-06 15:41:59,571 - DEBUG - Final edge attributes tensor shape: torch.Size([66, 22])
2025-06-06 15:41:59,571 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:41:59,571 - INFO - Performing online update...
2025-06-06 15:41:59,571 - INFO - Starting online update for 50 steps.
2025-06-06 15:41:59,572 - DEBUG - Initialized RunningStats with first batch: mean=[-3.76330346e-09  4.37151413e-09  6.08210661e-09 -1.82463198e-09
 -6.08210661e-09  4.86568529e-09  2.43284264e-09  3.64926397e-09
  1.27724239e-08  1.03395812e-08  9.73137058e-09 -1.15560026e-08
  3.64926397e-09 -3.04105330e-08  1.21642132e-09 -7.90673859e-09
  8.05879126e-09  1.06436866e-08 -1.94627412e-08], M2=[48.99999891 48.99999891 49.00000008 48.99999808 48.99999733 49.00000349
 49.00000321 49.00000157 49.0000008  48.99999987 48.9999992  48.99999829
 49.00000074 49.0000001  48.99999963 49.00000195 49.00000153 49.00000134
 49.00000365], n=49
2025-06-06 15:41:59,572 - DEBUG - Initialized RunningStats with first batch: mean=[ 1.36363636e-01  3.10606061e+00  1.40403934e-09  0.00000000e+00
  1.89086705e-09  4.09217495e-09  7.96563020e-09  2.08842032e-09
 -2.42708307e-09 -7.76102146e-10  6.09592958e-09  1.02608641e-08
 -1.26998533e-10  1.21918592e-08 -5.41860407e-09  3.80995599e-09
  3.80995599e-09  3.80995599e-09  3.80995599e-09  3.80995599e-09
  3.80995599e-09  1.69331377e-09], M2=[  7.77272727 306.25757576  65.99999913  65.99999922  66.00000101
  66.00000274  65.99999731  65.99999867  66.00000022  66.00000049
  66.00000279  65.99999825  65.9999992   65.99999966  65.99999808
  66.00000372  66.00000372  66.00000372  66.00000372  66.00000372
  66.00000372  66.00000052], n=66
2025-06-06 15:41:59,572 - DEBUG - Calculated standard deviation: [0.99999999 0.99999999 1.         0.99999998 0.99999997 1.00000004
 1.00000003 1.00000002 1.00000001 1.         0.99999999 0.99999998
 1.00000001 1.         1.         1.00000002 1.00000002 1.00000001
 1.00000004]
2025-06-06 15:41:59,572 - DEBUG - Calculated standard deviation: [0.34317429 2.15412774 0.99999999 0.99999999 1.00000001 1.00000002
 0.99999998 0.99999999 1.         1.         1.00000002 0.99999999
 0.99999999 1.         0.99999999 1.00000003 1.00000003 1.00000003
 1.00000003 1.00000003 1.00000003 1.        ]
2025-06-06 15:41:59,572 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:41:59,572 - DEBUG - Online update step: 1/50
2025-06-06 15:41:59,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,572 - DEBUG - Online update step: 2/50
2025-06-06 15:41:59,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,572 - DEBUG - Online update step: 3/50
2025-06-06 15:41:59,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,572 - DEBUG - Online update step: 4/50
2025-06-06 15:41:59,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,573 - DEBUG - Online update step: 5/50
2025-06-06 15:41:59,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,573 - DEBUG - Online update step: 6/50
2025-06-06 15:41:59,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,573 - DEBUG - Online update step: 7/50
2025-06-06 15:41:59,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,573 - DEBUG - Online update step: 8/50
2025-06-06 15:41:59,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,573 - DEBUG - Online update step: 9/50
2025-06-06 15:41:59,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,573 - DEBUG - Online update step: 10/50
2025-06-06 15:41:59,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,573 - DEBUG - Online update step: 11/50
2025-06-06 15:41:59,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,573 - DEBUG - Online update step: 12/50
2025-06-06 15:41:59,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,573 - DEBUG - Online update step: 13/50
2025-06-06 15:41:59,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,573 - DEBUG - Online update step: 14/50
2025-06-06 15:41:59,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,573 - DEBUG - Online update step: 15/50
2025-06-06 15:41:59,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,573 - DEBUG - Online update step: 16/50
2025-06-06 15:41:59,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,573 - DEBUG - Online update step: 17/50
2025-06-06 15:41:59,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,573 - DEBUG - Online update step: 18/50
2025-06-06 15:41:59,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,573 - DEBUG - Online update step: 19/50
2025-06-06 15:41:59,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,573 - DEBUG - Online update step: 20/50
2025-06-06 15:41:59,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,573 - DEBUG - Online update step: 21/50
2025-06-06 15:41:59,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,573 - DEBUG - Online update step: 22/50
2025-06-06 15:41:59,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,573 - DEBUG - Online update step: 23/50
2025-06-06 15:41:59,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,573 - DEBUG - Online update step: 24/50
2025-06-06 15:41:59,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,573 - DEBUG - Online update step: 25/50
2025-06-06 15:41:59,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,573 - DEBUG - Online update step: 26/50
2025-06-06 15:41:59,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,573 - DEBUG - Online update step: 27/50
2025-06-06 15:41:59,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,574 - DEBUG - Online update step: 28/50
2025-06-06 15:41:59,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,574 - DEBUG - Online update step: 29/50
2025-06-06 15:41:59,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,574 - DEBUG - Online update step: 30/50
2025-06-06 15:41:59,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,574 - DEBUG - Online update step: 31/50
2025-06-06 15:41:59,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,574 - DEBUG - Online update step: 32/50
2025-06-06 15:41:59,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,574 - DEBUG - Online update step: 33/50
2025-06-06 15:41:59,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,574 - DEBUG - Online update step: 34/50
2025-06-06 15:41:59,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,574 - DEBUG - Online update step: 35/50
2025-06-06 15:41:59,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,574 - DEBUG - Online update step: 36/50
2025-06-06 15:41:59,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,574 - DEBUG - Online update step: 37/50
2025-06-06 15:41:59,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,574 - DEBUG - Online update step: 38/50
2025-06-06 15:41:59,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,574 - DEBUG - Online update step: 39/50
2025-06-06 15:41:59,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,574 - DEBUG - Online update step: 40/50
2025-06-06 15:41:59,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,574 - DEBUG - Online update step: 41/50
2025-06-06 15:41:59,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,574 - DEBUG - Online update step: 42/50
2025-06-06 15:41:59,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,574 - DEBUG - Online update step: 43/50
2025-06-06 15:41:59,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,574 - DEBUG - Online update step: 44/50
2025-06-06 15:41:59,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,574 - DEBUG - Online update step: 45/50
2025-06-06 15:41:59,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,574 - DEBUG - Online update step: 46/50
2025-06-06 15:41:59,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,574 - DEBUG - Online update step: 47/50
2025-06-06 15:41:59,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,574 - DEBUG - Online update step: 48/50
2025-06-06 15:41:59,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,574 - DEBUG - Online update step: 49/50
2025-06-06 15:41:59,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,575 - DEBUG - Online update step: 50/50
2025-06-06 15:41:59,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,575 - WARNING - No successful steps during online update.
2025-06-06 15:41:59,575 - DEBUG - Current node mean: [-3.8925482e-08  3.8925482e-08 -9.7313704e-09 -1.7029899e-08
 -2.9194112e-08 -1.9462741e-08  0.0000000e+00  1.7029899e-08
  2.6761269e-08 -5.4738960e-09  0.0000000e+00 -1.4597056e-08
  1.4597056e-08 -2.4328427e-08  1.7029899e-08 -9.7313704e-09
  0.0000000e+00  0.0000000e+00 -1.9462741e-08], current edge mean: [ 1.3636364e-01  3.1060605e+00  9.9341078e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  2.5286820e-08 -3.6124028e-09
  7.2248056e-09  9.9341078e-09  3.2511625e-08  2.1674417e-08
 -1.1740309e-08  9.9341078e-09 -3.6124028e-08  3.6124028e-09
  3.6124028e-09  3.6124028e-09  3.6124028e-09  3.6124028e-09
  3.6124028e-09 -3.6124028e-09]
2025-06-06 15:41:59,575 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.0000
2025-06-06 15:41:59,575 - DEBUG - Updated reference mean: node=[-3.8925482e-08  3.8925482e-08 -9.7313704e-09 -1.7029899e-08
 -2.9194112e-08 -1.9462741e-08  0.0000000e+00  1.7029899e-08
  2.6761269e-08 -5.4738960e-09  0.0000000e+00 -1.4597056e-08
  1.4597056e-08 -2.4328427e-08  1.7029899e-08 -9.7313704e-09
  0.0000000e+00  0.0000000e+00 -1.9462741e-08], edge=[ 1.3636364e-01  3.1060605e+00  9.9341078e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  2.5286820e-08 -3.6124028e-09
  7.2248056e-09  9.9341078e-09  3.2511625e-08  2.1674417e-08
 -1.1740309e-08  9.9341078e-09 -3.6124028e-08  3.6124028e-09
  3.6124028e-09  3.6124028e-09  3.6124028e-09  3.6124028e-09
  3.6124028e-09 -3.6124028e-09]
2025-06-06 15:41:59,576 - DEBUG - Updated reference std: node=[1.010363 1.010363 1.010363 1.010363 1.010363 1.010363 1.010363 1.010363
 1.010363 1.010363 1.010363 1.010363 1.010363 1.010363 1.010363 1.010363
 1.010363 1.010363 1.010363], edge=[0.345804  2.1706347 1.0076629 1.0076629 1.007663  1.007663  1.0076629
 1.0076629 1.0076629 1.0076629 1.007663  1.0076629 1.0076629 1.0076629
 1.0076629 1.007663  1.007663  1.007663  1.007663  1.007663  1.007663
 1.0076629]
2025-06-06 15:41:59,576 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:41:59,576 - INFO - Running anomaly detection...
2025-06-06 15:41:59,576 - INFO - Starting anomaly detection.
2025-06-06 15:41:59,582 - DEBUG - Node reconstruction errors: [ 4.1972947  3.0207272  3.0241365  5.0038385  3.016415   3.4469228
  3.2379212  3.87422    3.1696198  2.7614174  3.7976387  3.2797806
 10.582141   2.8258655  3.4771214 11.000214  10.673793   3.8647244
  3.4895654  5.5359297  3.8731859  3.213414   3.853997   3.1068506
  3.913995   3.7679214 15.144376   3.8369627  4.6696196  3.3839564
  3.903649  12.197049   3.0479293  3.8726735  3.1550765  3.3773234
  3.5015178  3.794246   3.7074504  3.5530102  3.6090035  3.4309464
  4.573203   9.539013   3.7167559  3.7976227  3.2226305  5.0212564
  3.871751 ]
2025-06-06 15:41:59,582 - DEBUG - Edge reconstruction errors: [0.7997122  0.79998446 0.7999986  0.8        0.79879963 0.7998439
 0.7987041  0.79999965 0.8        0.8        0.79994416 0.7999996
 0.8        0.7999668  0.79970247 0.799943   0.7999997  0.79998916
 0.7999976  0.79999995 0.7999999  0.79992664 0.79958063 0.75266993
 0.61142385 0.7414084  0.19710004 0.5827291  0.7612671  0.799999
 0.7999756  0.7998599  0.79994565 0.6974815  0.76948774 0.7909146
 0.79958916 0.6672399  0.34853593 0.15517026 0.79999846 0.79999954
 0.79999983 0.7999897  0.7999813  0.7999953  0.79999876 0.78091574
 0.7999659  0.75205505 0.7878908  0.6908287  0.10714561 0.10801029
 0.7976706  0.7990899  0.7993903  0.79956007 0.8        0.7994064
 0.79928035 0.79999965 0.7993737  0.79997456 0.7999978  0.79949856]
2025-06-06 15:41:59,583 - ERROR - An error occurred while processing file nw_graph_encoded_1749044228.dot: name 'os' is not defined
2025-06-06 15:41:59,584 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow.py", line 429, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 9, in save_anomalies_to_file
    filename = os.path.join(anomaly_log_path, f"anomalies_{timestamp}_update_{processed_files_count}.json")
               ^^
NameError: name 'os' is not defined. Did you forget to import 'os'

2025-06-06 15:41:59,584 - INFO - 
--- Processing file: nw_graph_encoded_1749044288.dot ---
2025-06-06 15:41:59,584 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044288.dot
2025-06-06 15:41:59,584 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044288.dot file.
2025-06-06 15:41:59,585 - INFO - Parsed 65 nodes.
2025-06-06 15:41:59,586 - INFO - Parsed 89 edges.
2025-06-06 15:41:59,588 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:41:59,588 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:41:59,588 - DEBUG - Initial node features tensor shape: torch.Size([65, 19])
2025-06-06 15:41:59,589 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:41:59,589 - DEBUG - Node features tensor shape after scaling: torch.Size([65, 19])
2025-06-06 15:41:59,590 - DEBUG - Edge index tensor shape: torch.Size([2, 89])
2025-06-06 15:41:59,590 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:41:59,590 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:41:59,591 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-06 15:41:59,591 - DEBUG - Shape of encoded categorical edge features: torch.Size([89, 2])
2025-06-06 15:41:59,591 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:41:59,592 - DEBUG - Shape of scaled numerical edge features: torch.Size([89, 20])
2025-06-06 15:41:59,592 - DEBUG - Final edge attributes tensor shape: torch.Size([89, 22])
2025-06-06 15:41:59,592 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:41:59,592 - INFO - Performing online update...
2025-06-06 15:41:59,592 - INFO - Starting online update for 50 steps.
2025-06-06 15:41:59,592 - DEBUG - Updated RunningStats: new_mean=[-3.90501922e-09  4.29715504e-09 -2.28745896e-09 -6.27417313e-09
 -5.75132537e-09  2.61423881e-10  1.28097701e-08  2.61423881e-10
  5.48990149e-09  7.84271642e-10  2.14367582e-08 -8.10414030e-09
  1.72539761e-08 -1.51625851e-08  1.17640746e-09  1.82996716e-09
  1.89532313e-09  1.00648194e-08 -1.35940418e-08], new_M2=[113.9999971  113.9999971  113.99999572 113.99999326 113.99999948
 114.00000674 113.99999949 114.00000473 113.999999   114.00000497
 114.00000037 114.00000044 113.99999944 113.9999993  113.99999943
 114.00000069 114.00000014 114.00000036 114.00000542], new_n=114
2025-06-06 15:41:59,593 - DEBUG - Updated RunningStats: new_mean=[ 6.83870968e-01  3.18064516e+00  8.14156186e-10  3.60511964e-10
  1.60352717e-09  1.99633500e-09 -2.13603339e-09 -2.51457095e-09
 -3.45490633e-09 -1.17166388e-09  2.40341310e-09  2.35027513e-09
  3.01027490e-09  1.01904715e-08 -4.99909924e-09 -9.01279911e-11
 -9.01279911e-11 -9.01279911e-11 -9.01279911e-11 -9.01279911e-11
 -9.01279911e-11 -1.95277314e-09], new_M2=[ 51.50967742 694.94193548 154.99999941 154.99999998 155.00000441
 155.00000462 154.99999567 154.99999586 154.99999812 155.00000068
 155.00000057 154.99999931 154.99999981 154.99999826 154.99999737
 154.9999983  154.9999983  154.9999983  154.9999983  154.9999983
 154.9999983  154.99999444], new_n=155
2025-06-06 15:41:59,593 - DEBUG - Calculated standard deviation: [0.99999999 0.99999999 0.99999998 0.99999997 1.         1.00000003
 1.         1.00000002 1.         1.00000002 1.         1.
 1.         1.         1.         1.         1.         1.
 1.00000002]
2025-06-06 15:41:59,593 - DEBUG - Calculated standard deviation: [0.57647246 2.11742682 1.         1.         1.00000001 1.00000001
 0.99999999 0.99999999 0.99999999 1.         1.         1.
 1.         0.99999999 0.99999999 0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 0.99999998]
2025-06-06 15:41:59,593 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:41:59,593 - DEBUG - Online update step: 1/50
2025-06-06 15:41:59,593 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,593 - DEBUG - Online update step: 2/50
2025-06-06 15:41:59,593 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,593 - DEBUG - Online update step: 3/50
2025-06-06 15:41:59,593 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,593 - DEBUG - Online update step: 4/50
2025-06-06 15:41:59,593 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,593 - DEBUG - Online update step: 5/50
2025-06-06 15:41:59,593 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,593 - DEBUG - Online update step: 6/50
2025-06-06 15:41:59,593 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,593 - DEBUG - Online update step: 7/50
2025-06-06 15:41:59,593 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,593 - DEBUG - Online update step: 8/50
2025-06-06 15:41:59,593 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,594 - DEBUG - Online update step: 9/50
2025-06-06 15:41:59,594 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,594 - DEBUG - Online update step: 10/50
2025-06-06 15:41:59,594 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,594 - DEBUG - Online update step: 11/50
2025-06-06 15:41:59,594 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,594 - DEBUG - Online update step: 12/50
2025-06-06 15:41:59,594 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,594 - DEBUG - Online update step: 13/50
2025-06-06 15:41:59,594 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,594 - DEBUG - Online update step: 14/50
2025-06-06 15:41:59,594 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,594 - DEBUG - Online update step: 15/50
2025-06-06 15:41:59,594 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,594 - DEBUG - Online update step: 16/50
2025-06-06 15:41:59,594 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,594 - DEBUG - Online update step: 17/50
2025-06-06 15:41:59,594 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,594 - DEBUG - Online update step: 18/50
2025-06-06 15:41:59,594 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,594 - DEBUG - Online update step: 19/50
2025-06-06 15:41:59,594 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,594 - DEBUG - Online update step: 20/50
2025-06-06 15:41:59,594 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,594 - DEBUG - Online update step: 21/50
2025-06-06 15:41:59,594 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,594 - DEBUG - Online update step: 22/50
2025-06-06 15:41:59,594 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,594 - DEBUG - Online update step: 23/50
2025-06-06 15:41:59,594 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,594 - DEBUG - Online update step: 24/50
2025-06-06 15:41:59,594 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,594 - DEBUG - Online update step: 25/50
2025-06-06 15:41:59,594 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,594 - DEBUG - Online update step: 26/50
2025-06-06 15:41:59,594 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,594 - DEBUG - Online update step: 27/50
2025-06-06 15:41:59,594 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,595 - DEBUG - Online update step: 28/50
2025-06-06 15:41:59,595 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,595 - DEBUG - Online update step: 29/50
2025-06-06 15:41:59,595 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,595 - DEBUG - Online update step: 30/50
2025-06-06 15:41:59,595 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,595 - DEBUG - Online update step: 31/50
2025-06-06 15:41:59,595 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,595 - DEBUG - Online update step: 32/50
2025-06-06 15:41:59,595 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,595 - DEBUG - Online update step: 33/50
2025-06-06 15:41:59,595 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,595 - DEBUG - Online update step: 34/50
2025-06-06 15:41:59,595 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,595 - DEBUG - Online update step: 35/50
2025-06-06 15:41:59,595 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,595 - DEBUG - Online update step: 36/50
2025-06-06 15:41:59,595 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,595 - DEBUG - Online update step: 37/50
2025-06-06 15:41:59,595 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,595 - DEBUG - Online update step: 38/50
2025-06-06 15:41:59,595 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,595 - DEBUG - Online update step: 39/50
2025-06-06 15:41:59,595 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,595 - DEBUG - Online update step: 40/50
2025-06-06 15:41:59,595 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,595 - DEBUG - Online update step: 41/50
2025-06-06 15:41:59,595 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,595 - DEBUG - Online update step: 42/50
2025-06-06 15:41:59,595 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,595 - DEBUG - Online update step: 43/50
2025-06-06 15:41:59,595 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,595 - DEBUG - Online update step: 44/50
2025-06-06 15:41:59,595 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,595 - DEBUG - Online update step: 45/50
2025-06-06 15:41:59,595 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,595 - DEBUG - Online update step: 46/50
2025-06-06 15:41:59,595 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,595 - DEBUG - Online update step: 47/50
2025-06-06 15:41:59,595 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,596 - DEBUG - Online update step: 48/50
2025-06-06 15:41:59,596 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,596 - DEBUG - Online update step: 49/50
2025-06-06 15:41:59,596 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,596 - DEBUG - Online update step: 50/50
2025-06-06 15:41:59,596 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,596 - WARNING - No successful steps during online update.
2025-06-06 15:41:59,596 - DEBUG - Current node mean: [-2.9343825e-08  2.9343825e-08 -3.3928799e-08 -3.6679783e-08
  4.4015739e-08 -1.8339891e-08  2.8426831e-08 -4.4015739e-08
  3.6679781e-09 -2.5675847e-08  1.8339891e-08  3.6679783e-08
  3.6679783e-08  0.0000000e+00  0.0000000e+00  7.3359563e-09
  7.3359563e-09 -1.1003935e-08 -2.0173880e-08], current edge mean: [ 1.0898876e+00  3.2359550e+00  5.3577209e-09 -1.0715442e-08
  1.0715442e-08  1.0715442e-08 -1.6073162e-08  2.6788605e-09
 -1.0715442e-08  8.0365812e-09 -1.0715442e-08  0.0000000e+00
  1.3394303e-08 -2.6788605e-09 -1.0715442e-08 -5.3577209e-09
 -5.3577209e-09 -5.3577209e-09 -5.3577209e-09 -5.3577209e-09
 -5.3577209e-09 -5.3577209e-09]
2025-06-06 15:41:59,596 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.7043
2025-06-06 15:41:59,596 - WARNING - Feature drift detected (1 consecutive)
2025-06-06 15:41:59,596 - DEBUG - Updated reference mean: node=[-2.9343825e-08  2.9343825e-08 -3.3928799e-08 -3.6679783e-08
  4.4015739e-08 -1.8339891e-08  2.8426831e-08 -4.4015739e-08
  3.6679781e-09 -2.5675847e-08  1.8339891e-08  3.6679783e-08
  3.6679783e-08  0.0000000e+00  0.0000000e+00  7.3359563e-09
  7.3359563e-09 -1.1003935e-08 -2.0173880e-08], edge=[ 1.0898876e+00  3.2359550e+00  5.3577209e-09 -1.0715442e-08
  1.0715442e-08  1.0715442e-08 -1.6073162e-08  2.6788605e-09
 -1.0715442e-08  8.0365812e-09 -1.0715442e-08  0.0000000e+00
  1.3394303e-08 -2.6788605e-09 -1.0715442e-08 -5.3577209e-09
 -5.3577209e-09 -5.3577209e-09 -5.3577209e-09 -5.3577209e-09
 -5.3577209e-09 -5.3577209e-09]
2025-06-06 15:41:59,597 - DEBUG - Updated reference std: node=[1.0077822 1.0077822 1.0077822 1.0077822 1.0077822 1.0077822 1.0077822
 1.0077822 1.0077822 1.0077822 1.0077822 1.0077822 1.0077822 1.0077822
 1.0077822 1.0077822 1.0077822 1.0077822 1.0077822], edge=[0.32475337 2.0999053  1.0056658  1.0056658  1.0056658  1.0056658
 1.0056658  1.0056658  1.0056658  1.0056658  1.0056658  1.0056658
 1.0056658  1.0056658  1.0056658  1.0056658  1.0056658  1.0056658
 1.0056658  1.0056658  1.0056658  1.0056658 ]
2025-06-06 15:41:59,597 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:41:59,597 - INFO - Running anomaly detection...
2025-06-06 15:41:59,597 - INFO - Starting anomaly detection.
2025-06-06 15:41:59,601 - DEBUG - Node reconstruction errors: [ 3.8048737  3.8275788  3.807277   3.948619   3.8128357  3.6255815
 11.006182   3.8489661  3.2902222  3.8104038  3.1256824  3.7391827
  3.332762   4.7310243  3.8081565 11.916227   3.14967    4.2481117
  3.9564028 15.343496   3.76221    7.7891884  3.1576047  3.2755234
  3.2480705  3.4497364  3.9441206  3.9077206  3.8624325  3.7108788
  3.6541402  3.8395522  2.9946146  3.966533  12.870155   3.3344054
 11.039383   3.4485426  3.054702   3.8093438  5.5124726  2.9553936
  3.1090624  2.9019744  4.1646237  3.1477082  3.7369125  3.7523615
  3.3315253  3.2092519  4.695452  10.259991   3.4001968  3.0076473
  4.3231845  4.145333   4.3049254  2.9941747  4.920879   3.8331392
  3.0492072  3.5014918  1.760842   4.2058907  3.8044896]
2025-06-06 15:41:59,601 - DEBUG - Edge reconstruction errors: [0.7941183  0.7958273  0.796508   0.8        0.79694873 0.7932129
 0.79999614 0.79305995 0.79996556 0.7999988  0.7992188  0.78100383
 0.79973376 0.79187435 0.7999958  0.7760768  0.6364974  0.51114327
 0.77864003 0.7928838  0.8        0.8        0.7875177  0.79999995
 0.8        0.79997426 0.76064616 0.796227   0.7999887  0.7991416
 0.7999592  0.8        0.77505267 0.7951642  0.7999839  0.7998645
 0.79079825 0.7464995  0.7872623  0.19506854 0.7573555  0.7963352
 0.79999983 0.7999992  0.7999969  0.77861553 0.78678614 0.79699206
 0.79902565 0.79980093 0.7999975  0.78855294 0.7277979  0.16146731
 0.79999983 0.7999987  0.79999995 0.7999996  0.7999944  0.7999998
 0.79999995 0.7978863  0.7999982  0.79880464 0.798414   0.791614
 0.7715693  0.26231015 0.7573667  0.7960882  0.79993623 0.7999988
 0.11355019 0.79793626 0.7991626  0.79452807 0.78042614 0.7814719
 0.79797083 0.79893506 0.7999106  0.79996115 0.8        0.7987014
 0.799751   0.7985945  0.79896826 0.78057534 0.79999983]
2025-06-06 15:41:59,602 - ERROR - An error occurred while processing file nw_graph_encoded_1749044288.dot: name 'os' is not defined
2025-06-06 15:41:59,602 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow.py", line 429, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 9, in save_anomalies_to_file
    filename = os.path.join(anomaly_log_path, f"anomalies_{timestamp}_update_{processed_files_count}.json")
               ^^
NameError: name 'os' is not defined. Did you forget to import 'os'

2025-06-06 15:41:59,602 - INFO - 
--- Processing file: nw_graph_encoded_1749044348.dot ---
2025-06-06 15:41:59,602 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044348.dot
2025-06-06 15:41:59,602 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044348.dot file.
2025-06-06 15:41:59,603 - INFO - Parsed 77 nodes.
2025-06-06 15:41:59,605 - INFO - Parsed 106 edges.
2025-06-06 15:41:59,608 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:41:59,608 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:41:59,608 - DEBUG - Initial node features tensor shape: torch.Size([77, 19])
2025-06-06 15:41:59,609 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:41:59,609 - DEBUG - Node features tensor shape after scaling: torch.Size([77, 19])
2025-06-06 15:41:59,610 - DEBUG - Edge index tensor shape: torch.Size([2, 106])
2025-06-06 15:41:59,610 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:41:59,611 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:41:59,611 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-06 15:41:59,611 - DEBUG - Shape of encoded categorical edge features: torch.Size([106, 2])
2025-06-06 15:41:59,612 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:41:59,612 - DEBUG - Shape of scaled numerical edge features: torch.Size([106, 20])
2025-06-06 15:41:59,612 - DEBUG - Final edge attributes tensor shape: torch.Size([106, 22])
2025-06-06 15:41:59,612 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:41:59,612 - INFO - Performing online update...
2025-06-06 15:41:59,612 - INFO - Starting online update for 50 steps.
2025-06-06 15:41:59,613 - DEBUG - Updated RunningStats: new_mean=[-2.52578583e-09  2.83785203e-09  7.21653094e-09 -3.58876133e-09
 -1.24826481e-09  1.56033102e-10  1.04542178e-08  1.32628136e-09
  3.27669513e-09 -3.82281099e-09  6.24132406e-09 -3.43272823e-09
  1.15464495e-08 -7.64562197e-09 -6.94347302e-09  2.80859583e-09
  6.67041509e-09  1.07467799e-08 -9.36198609e-09], new_M2=[190.99999926 190.99999926 190.99999296 190.9999893  191.00000108
 191.00000916 191.00000201 191.00000235 191.00000348 190.99999873
 190.99999693 190.99999827 190.99999369 191.00000134 191.00000509
 191.00000224 191.00000049 190.99999847 191.00000631], new_n=191
2025-06-06 15:41:59,613 - DEBUG - Updated RunningStats: new_mean=[ 8.62068966e-01  3.26819923e+00  2.58879129e-09 -7.06520574e-10
  3.24312569e-09  2.06336122e-09 -8.88057110e-10 -5.79846431e-10
 -4.36869682e-09  1.08119058e-09 -5.99472002e-10 -2.28269928e-09
  2.67978258e-09 -6.28018288e-10 -1.14185143e-08 -4.53172287e-10
 -4.53172287e-10 -4.53172287e-10 -4.53172287e-10 -4.53172287e-10
 -4.53172287e-10  1.24890000e-10], new_M2=[  77.03448276 1139.22605364  261.0000066   260.9999946   261.00001265
  261.00001052  260.99999672  261.00000114  260.99999669  260.99999973
  260.99999185  261.00000245  261.00000034  261.00000071  260.99999655
  260.99999755  260.99999755  260.99999755  260.99999755  260.99999755
  260.99999755  260.99999886], new_n=261
2025-06-06 15:41:59,613 - DEBUG - Calculated standard deviation: [1.         1.         0.99999998 0.99999997 1.         1.00000002
 1.00000001 1.00000001 1.00000001 1.         0.99999999 1.
 0.99999998 1.         1.00000001 1.00000001 1.         1.
 1.00000002]
2025-06-06 15:41:59,613 - DEBUG - Calculated standard deviation: [0.54327827 2.08922253 1.00000001 0.99999999 1.00000002 1.00000002
 0.99999999 1.         0.99999999 1.         0.99999998 1.
 1.         1.         0.99999999 1.         1.         1.
 1.         1.         1.         1.        ]
2025-06-06 15:41:59,613 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:41:59,613 - DEBUG - Online update step: 1/50
2025-06-06 15:41:59,613 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,613 - DEBUG - Online update step: 2/50
2025-06-06 15:41:59,613 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,613 - DEBUG - Online update step: 3/50
2025-06-06 15:41:59,614 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,614 - DEBUG - Online update step: 4/50
2025-06-06 15:41:59,614 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,614 - DEBUG - Online update step: 5/50
2025-06-06 15:41:59,614 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,614 - DEBUG - Online update step: 6/50
2025-06-06 15:41:59,614 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,614 - DEBUG - Online update step: 7/50
2025-06-06 15:41:59,614 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,614 - DEBUG - Online update step: 8/50
2025-06-06 15:41:59,614 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,614 - DEBUG - Online update step: 9/50
2025-06-06 15:41:59,614 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,614 - DEBUG - Online update step: 10/50
2025-06-06 15:41:59,614 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,614 - DEBUG - Online update step: 11/50
2025-06-06 15:41:59,614 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,614 - DEBUG - Online update step: 12/50
2025-06-06 15:41:59,614 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,614 - DEBUG - Online update step: 13/50
2025-06-06 15:41:59,614 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,614 - DEBUG - Online update step: 14/50
2025-06-06 15:41:59,614 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,614 - DEBUG - Online update step: 15/50
2025-06-06 15:41:59,614 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,614 - DEBUG - Online update step: 16/50
2025-06-06 15:41:59,614 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,614 - DEBUG - Online update step: 17/50
2025-06-06 15:41:59,614 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,614 - DEBUG - Online update step: 18/50
2025-06-06 15:41:59,614 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,614 - DEBUG - Online update step: 19/50
2025-06-06 15:41:59,614 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,614 - DEBUG - Online update step: 20/50
2025-06-06 15:41:59,614 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,614 - DEBUG - Online update step: 21/50
2025-06-06 15:41:59,614 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,614 - DEBUG - Online update step: 22/50
2025-06-06 15:41:59,615 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,615 - DEBUG - Online update step: 23/50
2025-06-06 15:41:59,615 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,615 - DEBUG - Online update step: 24/50
2025-06-06 15:41:59,615 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,615 - DEBUG - Online update step: 25/50
2025-06-06 15:41:59,615 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,615 - DEBUG - Online update step: 26/50
2025-06-06 15:41:59,615 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,615 - DEBUG - Online update step: 27/50
2025-06-06 15:41:59,615 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,615 - DEBUG - Online update step: 28/50
2025-06-06 15:41:59,615 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,615 - DEBUG - Online update step: 29/50
2025-06-06 15:41:59,615 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,615 - DEBUG - Online update step: 30/50
2025-06-06 15:41:59,615 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,615 - DEBUG - Online update step: 31/50
2025-06-06 15:41:59,615 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,615 - DEBUG - Online update step: 32/50
2025-06-06 15:41:59,615 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,615 - DEBUG - Online update step: 33/50
2025-06-06 15:41:59,615 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,615 - DEBUG - Online update step: 34/50
2025-06-06 15:41:59,615 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,615 - DEBUG - Online update step: 35/50
2025-06-06 15:41:59,615 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,615 - DEBUG - Online update step: 36/50
2025-06-06 15:41:59,615 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,615 - DEBUG - Online update step: 37/50
2025-06-06 15:41:59,615 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,615 - DEBUG - Online update step: 38/50
2025-06-06 15:41:59,615 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,615 - DEBUG - Online update step: 39/50
2025-06-06 15:41:59,615 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,615 - DEBUG - Online update step: 40/50
2025-06-06 15:41:59,615 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,615 - DEBUG - Online update step: 41/50
2025-06-06 15:41:59,616 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,616 - DEBUG - Online update step: 42/50
2025-06-06 15:41:59,616 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,616 - DEBUG - Online update step: 43/50
2025-06-06 15:41:59,616 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,616 - DEBUG - Online update step: 44/50
2025-06-06 15:41:59,616 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,616 - DEBUG - Online update step: 45/50
2025-06-06 15:41:59,616 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,616 - DEBUG - Online update step: 46/50
2025-06-06 15:41:59,616 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,616 - DEBUG - Online update step: 47/50
2025-06-06 15:41:59,616 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,616 - DEBUG - Online update step: 48/50
2025-06-06 15:41:59,616 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,616 - DEBUG - Online update step: 49/50
2025-06-06 15:41:59,616 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,616 - DEBUG - Online update step: 50/50
2025-06-06 15:41:59,616 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,616 - WARNING - No successful steps during online update.
2025-06-06 15:41:59,616 - DEBUG - Current node mean: [-6.19269036e-09  6.19269036e-09  3.25116254e-08 -2.47707614e-08
  0.00000000e+00 -1.23853807e-08  1.85780706e-08  2.47707614e-08
  0.00000000e+00  0.00000000e+00 -3.09634522e-08  1.23853807e-08
 -6.19269036e-09 -1.47076396e-08 -4.10265741e-08  1.23853807e-08
  1.85780706e-08  6.19269036e-09  6.96677649e-09], current edge mean: [ 1.12264156e+00  3.39622641e+00  0.00000000e+00  1.01215436e-08
  4.49846382e-09  0.00000000e+00 -1.68692393e-09  1.12461596e-09
  8.99692765e-09  6.74769574e-09 -8.99692765e-09 -1.12461596e-08
 -1.34953915e-08 -1.57446234e-08 -2.24923191e-08 -2.24923191e-09
 -2.24923191e-09 -2.24923191e-09 -2.24923191e-09 -2.24923191e-09
 -2.24923191e-09  0.00000000e+00]
2025-06-06 15:41:59,617 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.4796
2025-06-06 15:41:59,617 - WARNING - Feature drift detected (2 consecutive)
2025-06-06 15:41:59,617 - DEBUG - Updated reference mean: node=[-6.19269036e-09  6.19269036e-09  3.25116254e-08 -2.47707614e-08
  0.00000000e+00 -1.23853807e-08  1.85780706e-08  2.47707614e-08
  0.00000000e+00  0.00000000e+00 -3.09634522e-08  1.23853807e-08
 -6.19269036e-09 -1.47076396e-08 -4.10265741e-08  1.23853807e-08
  1.85780706e-08  6.19269036e-09  6.96677649e-09], edge=[ 1.12264156e+00  3.39622641e+00  0.00000000e+00  1.01215436e-08
  4.49846382e-09  0.00000000e+00 -1.68692393e-09  1.12461596e-09
  8.99692765e-09  6.74769574e-09 -8.99692765e-09 -1.12461596e-08
 -1.34953915e-08 -1.57446234e-08 -2.24923191e-08 -2.24923191e-09
 -2.24923191e-09 -2.24923191e-09 -2.24923191e-09 -2.24923191e-09
 -2.24923191e-09  0.00000000e+00]
2025-06-06 15:41:59,617 - DEBUG - Updated reference std: node=[1.0065575 1.0065575 1.0065575 1.0065575 1.0065575 1.0065575 1.0065575
 1.0065575 1.0065575 1.0065575 1.0065575 1.0065575 1.0065575 1.0065575
 1.0065575 1.0065575 1.0065575 1.0065575 1.0065575], edge=[0.3573135 2.0502229 1.0047506 1.0047506 1.0047506 1.0047506 1.0047506
 1.0047506 1.0047506 1.0047506 1.0047506 1.0047506 1.0047506 1.0047506
 1.0047506 1.0047506 1.0047506 1.0047506 1.0047506 1.0047506 1.0047506
 1.0047506]
2025-06-06 15:41:59,617 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:41:59,617 - INFO - Running anomaly detection...
2025-06-06 15:41:59,617 - INFO - Starting anomaly detection.
2025-06-06 15:41:59,621 - DEBUG - Node reconstruction errors: [ 5.1573     4.523206   4.477384   4.5207753  4.9486637  4.154002
  4.516501   4.533714   4.518492   4.198256   4.0484233  3.7378492
 11.078144   4.5167685  4.1284537  4.0248303  4.0687857  3.9068475
  4.046408   5.211785   5.3300896 12.401019  15.661123   5.2732143
  3.8198898  4.94663    4.3864465  4.187092  17.324295   3.9720407
  8.878229   3.835009   3.5429053  3.5463924  4.5192885  3.669126
  4.6388607  4.2445045  4.0740743  3.9800344  3.9134886  3.895222
  3.3015084  4.2469063 10.81661    3.7501457 11.573489   3.786887
  3.2575653  4.0155396  6.659918   2.686548   3.7580013  3.2389457
  4.3041224  3.351188   3.9542372  4.212034   3.5422282  3.451934
  5.957982  12.57608    3.6114666  3.1565778  4.97422    4.144576
  5.6694303  4.399748   3.1532896  4.9414396  4.6538005  4.0479794
  3.204087   3.5621843  2.036097   4.2735767  4.5157256]
2025-06-06 15:41:59,622 - DEBUG - Edge reconstruction errors: [0.7996181  0.79956585 0.79982793 0.8        0.79891574 0.7980141
 0.79999864 0.78736895 0.7999429  0.7999991  0.79995215 0.7992508
 0.7999864  0.7996839  0.79999995 0.79966813 0.79514045 0.7999064
 0.79964    0.76427054 0.7995558  0.7996479  0.7997068  0.79076093
 0.79700017 0.79828376 0.8        0.7993872  0.79917675 0.8
 0.8        0.7952839  0.8        0.8        0.7999937  0.7958522
 0.7995853  0.79999906 0.79992104 0.79999673 0.8        0.78347915
 0.77608615 0.79996645 0.79983795 0.7903795  0.724513   0.78375447
 0.1990363  0.72957855 0.7966665  0.79999936 0.7999975  0.7999929
 0.7925635  0.78925914 0.7976954  0.7992827  0.7998418  0.8
 0.78599304 0.7101359  0.15888971 0.79999983 0.79924375 0.79999864
 0.8        0.7999999  0.7999981  0.79999995 0.8        0.7983331
 0.79999965 0.79837084 0.7987843  0.78949183 0.77389526 0.01471055
 0.79010683 0.7971152  0.79998696 0.7999998  0.02104872 0.7975193
 0.66220784 0.7999504  0.79951394 0.798145   0.7894043  0.6150147
 0.79927456 0.7997806  0.79850715 0.7971644  0.79733783 0.79960406
 0.7999375  0.79998904 0.79999804 0.8        0.7993597  0.7999277
 0.7994688  0.7996231  0.7922376  0.7999998 ]
2025-06-06 15:41:59,622 - ERROR - An error occurred while processing file nw_graph_encoded_1749044348.dot: name 'os' is not defined
2025-06-06 15:41:59,623 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow.py", line 429, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 9, in save_anomalies_to_file
    filename = os.path.join(anomaly_log_path, f"anomalies_{timestamp}_update_{processed_files_count}.json")
               ^^
NameError: name 'os' is not defined. Did you forget to import 'os'

2025-06-06 15:41:59,623 - INFO - 
--- Processing file: nw_graph_encoded_1749044408.dot ---
2025-06-06 15:41:59,623 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044408.dot
2025-06-06 15:41:59,623 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044408.dot file.
2025-06-06 15:41:59,624 - INFO - Parsed 131 nodes.
2025-06-06 15:41:59,626 - INFO - Parsed 188 edges.
2025-06-06 15:41:59,636 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:41:59,636 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:41:59,637 - DEBUG - Initial node features tensor shape: torch.Size([131, 19])
2025-06-06 15:41:59,637 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:41:59,638 - DEBUG - Node features tensor shape after scaling: torch.Size([131, 19])
2025-06-06 15:41:59,638 - DEBUG - Edge index tensor shape: torch.Size([2, 188])
2025-06-06 15:41:59,638 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:41:59,639 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:41:59,639 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-06 15:41:59,640 - DEBUG - Shape of encoded categorical edge features: torch.Size([188, 2])
2025-06-06 15:41:59,640 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:41:59,640 - DEBUG - Shape of scaled numerical edge features: torch.Size([188, 20])
2025-06-06 15:41:59,641 - DEBUG - Final edge attributes tensor shape: torch.Size([188, 22])
2025-06-06 15:41:59,641 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:41:59,641 - INFO - Performing online update...
2025-06-06 15:41:59,641 - INFO - Starting online update for 50 steps.
2025-06-06 15:41:59,641 - DEBUG - Updated RunningStats: new_mean=[-6.44984268e-10  8.85045676e-10  3.72529030e-09 -1.98990662e-09
 -4.44258222e-09 -1.00883638e-08  6.29365814e-09 -3.28565977e-09
  2.42953715e-09  5.09045879e-10  8.14473407e-09 -6.33993504e-09
  8.88516444e-09 -1.48548843e-08 -4.11864393e-09  1.22633780e-09
  2.91544458e-09  1.63704527e-09 -1.48086074e-08], new_M2=[321.99999523 321.99999523 321.99999863 321.99999455 321.99999856
 322.00000751 321.99999311 321.99999082 322.00001621 322.00000323
 322.00000185 321.99998759 321.99999512 322.0000072  322.00000962
 322.00000456 322.00000147 322.00000846 322.00001679], new_n=322
2025-06-06 15:41:59,642 - DEBUG - Updated RunningStats: new_mean=[ 1.01781737e+00  3.35857461e+00  1.55514276e-09 -1.49758329e-09
  2.64436496e-09  2.07473364e-09  4.41626320e-09 -2.30549007e-09
 -2.82209927e-09  5.10516189e-09  1.54321603e-09 -4.85619126e-09
  2.58758332e-09  1.29016178e-09 -5.60038074e-09  2.21422461e-10
  2.21422461e-10  2.21422461e-10  2.21422461e-10  2.21422461e-10
  2.21422461e-10 -3.50542350e-10], new_M2=[ 127.85746102 1905.26948775  449.00001597  448.9999865   449.00001748
  449.00001113  448.99999754  448.99999349  448.99999944  448.99999695
  449.00000829  449.00000971  448.99999991  449.00000464  449.00001413
  449.00000039  449.00000039  449.00000039  449.00000039  449.00000039
  449.00000039  448.9999978 ], new_n=449
2025-06-06 15:41:59,642 - DEBUG - Calculated standard deviation: [0.99999999 0.99999999 1.         0.99999999 1.         1.00000001
 0.99999999 0.99999999 1.00000003 1.00000001 1.         0.99999998
 0.99999999 1.00000001 1.00000001 1.00000001 1.         1.00000001
 1.00000003]
2025-06-06 15:41:59,642 - DEBUG - Calculated standard deviation: [0.53362955 2.05994221 1.00000002 0.99999998 1.00000002 1.00000001
 1.         0.99999999 1.         1.         1.00000001 1.00000001
 1.         1.00000001 1.00000002 1.         1.         1.
 1.         1.         1.         1.        ]
2025-06-06 15:41:59,642 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:41:59,642 - DEBUG - Online update step: 1/50
2025-06-06 15:41:59,642 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,642 - DEBUG - Online update step: 2/50
2025-06-06 15:41:59,642 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,642 - DEBUG - Online update step: 3/50
2025-06-06 15:41:59,642 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,642 - DEBUG - Online update step: 4/50
2025-06-06 15:41:59,642 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,642 - DEBUG - Online update step: 5/50
2025-06-06 15:41:59,642 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,642 - DEBUG - Online update step: 6/50
2025-06-06 15:41:59,642 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,643 - DEBUG - Online update step: 7/50
2025-06-06 15:41:59,643 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,643 - DEBUG - Online update step: 8/50
2025-06-06 15:41:59,643 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,643 - DEBUG - Online update step: 9/50
2025-06-06 15:41:59,643 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,643 - DEBUG - Online update step: 10/50
2025-06-06 15:41:59,643 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,643 - DEBUG - Online update step: 11/50
2025-06-06 15:41:59,643 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,643 - DEBUG - Online update step: 12/50
2025-06-06 15:41:59,643 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,643 - DEBUG - Online update step: 13/50
2025-06-06 15:41:59,643 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,643 - DEBUG - Online update step: 14/50
2025-06-06 15:41:59,643 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,643 - DEBUG - Online update step: 15/50
2025-06-06 15:41:59,643 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,643 - DEBUG - Online update step: 16/50
2025-06-06 15:41:59,643 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,643 - DEBUG - Online update step: 17/50
2025-06-06 15:41:59,643 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,643 - DEBUG - Online update step: 18/50
2025-06-06 15:41:59,643 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,643 - DEBUG - Online update step: 19/50
2025-06-06 15:41:59,643 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,643 - DEBUG - Online update step: 20/50
2025-06-06 15:41:59,643 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,643 - DEBUG - Online update step: 21/50
2025-06-06 15:41:59,643 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,643 - DEBUG - Online update step: 22/50
2025-06-06 15:41:59,643 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,643 - DEBUG - Online update step: 23/50
2025-06-06 15:41:59,643 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,643 - DEBUG - Online update step: 24/50
2025-06-06 15:41:59,643 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,644 - DEBUG - Online update step: 25/50
2025-06-06 15:41:59,644 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,644 - DEBUG - Online update step: 26/50
2025-06-06 15:41:59,644 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,644 - DEBUG - Online update step: 27/50
2025-06-06 15:41:59,644 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,644 - DEBUG - Online update step: 28/50
2025-06-06 15:41:59,644 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,644 - DEBUG - Online update step: 29/50
2025-06-06 15:41:59,644 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,644 - DEBUG - Online update step: 30/50
2025-06-06 15:41:59,644 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,644 - DEBUG - Online update step: 31/50
2025-06-06 15:41:59,644 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,644 - DEBUG - Online update step: 32/50
2025-06-06 15:41:59,644 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,644 - DEBUG - Online update step: 33/50
2025-06-06 15:41:59,644 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,644 - DEBUG - Online update step: 34/50
2025-06-06 15:41:59,644 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,644 - DEBUG - Online update step: 35/50
2025-06-06 15:41:59,644 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,644 - DEBUG - Online update step: 36/50
2025-06-06 15:41:59,644 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,644 - DEBUG - Online update step: 37/50
2025-06-06 15:41:59,644 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,644 - DEBUG - Online update step: 38/50
2025-06-06 15:41:59,644 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,644 - DEBUG - Online update step: 39/50
2025-06-06 15:41:59,644 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,644 - DEBUG - Online update step: 40/50
2025-06-06 15:41:59,644 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,644 - DEBUG - Online update step: 41/50
2025-06-06 15:41:59,644 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,644 - DEBUG - Online update step: 42/50
2025-06-06 15:41:59,644 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,644 - DEBUG - Online update step: 43/50
2025-06-06 15:41:59,644 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,645 - DEBUG - Online update step: 44/50
2025-06-06 15:41:59,645 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,645 - DEBUG - Online update step: 45/50
2025-06-06 15:41:59,645 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,645 - DEBUG - Online update step: 46/50
2025-06-06 15:41:59,645 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,645 - DEBUG - Online update step: 47/50
2025-06-06 15:41:59,645 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,645 - DEBUG - Online update step: 48/50
2025-06-06 15:41:59,645 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,645 - DEBUG - Online update step: 49/50
2025-06-06 15:41:59,645 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,645 - DEBUG - Online update step: 50/50
2025-06-06 15:41:59,645 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,645 - WARNING - No successful steps during online update.
2025-06-06 15:41:59,645 - DEBUG - Current node mean: [-3.6399783e-09  7.2799566e-09 -2.1839870e-08 -1.4559913e-08
 -1.2739924e-08 -5.4599674e-08  2.5479848e-08  1.4559913e-08
 -1.4559913e-08  1.2739924e-08  1.8199891e-08 -2.1839870e-08
 -2.5479848e-08 -4.0039762e-08 -7.2799566e-09 -3.6399783e-09
 -2.1839870e-08 -7.2799566e-09 -1.4559913e-08], current edge mean: [ 1.2340425e+00  3.4840426e+00  5.0727356e-09 -2.5363678e-09
  0.0000000e+00  2.5363678e-09  1.5218207e-08 -2.5363678e-09
 -7.6091036e-09  1.0145471e-08  0.0000000e+00 -1.0145471e-08
 -5.0727356e-09 -7.6091036e-09 -7.6091036e-09 -5.0727356e-09
 -5.0727356e-09 -5.0727356e-09 -5.0727356e-09 -5.0727356e-09
 -5.0727356e-09 -6.3409198e-09]
2025-06-06 15:41:59,645 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.4052
2025-06-06 15:41:59,645 - WARNING - Feature drift detected (3 consecutive)
2025-06-06 15:41:59,646 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-06 15:41:59,646 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-06 15:41:59,646 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-06 15:41:59,646 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-06 15:41:59,646 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-06 15:41:59,646 - INFO - Resetting parameters of module: autoencoder.node_decoder.3
2025-06-06 15:41:59,646 - INFO - Resetting parameters of module: autoencoder.node_decoder.4
2025-06-06 15:41:59,646 - INFO - Resetting parameters of module: autoencoder.node_decoder.5
2025-06-06 15:41:59,646 - INFO - Resetting parameters of module: autoencoder.node_decoder.6
2025-06-06 15:41:59,646 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-06 15:41:59,647 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-06 15:41:59,647 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-06 15:41:59,647 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-06 15:41:59,647 - INFO - Resetting parameters of module: autoencoder.edge_decoder.3
2025-06-06 15:41:59,647 - INFO - Resetting parameters of module: autoencoder.edge_decoder.4
2025-06-06 15:41:59,647 - INFO - Resetting parameters of module: autoencoder.edge_decoder.5
2025-06-06 15:41:59,647 - INFO - Resetting parameters of module: autoencoder.edge_decoder.6
2025-06-06 15:41:59,647 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-06 15:41:59,647 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-06 15:41:59,648 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-06 15:41:59,648 - INFO - Optimizer and scheduler reset.
2025-06-06 15:41:59,648 - DEBUG - Updated reference mean: node=[-3.6399783e-09  7.2799566e-09 -2.1839870e-08 -1.4559913e-08
 -1.2739924e-08 -5.4599674e-08  2.5479848e-08  1.4559913e-08
 -1.4559913e-08  1.2739924e-08  1.8199891e-08 -2.1839870e-08
 -2.5479848e-08 -4.0039762e-08 -7.2799566e-09 -3.6399783e-09
 -2.1839870e-08 -7.2799566e-09 -1.4559913e-08], edge=[ 1.2340425e+00  3.4840426e+00  5.0727356e-09 -2.5363678e-09
  0.0000000e+00  2.5363678e-09  1.5218207e-08 -2.5363678e-09
 -7.6091036e-09  1.0145471e-08  0.0000000e+00 -1.0145471e-08
 -5.0727356e-09 -7.6091036e-09 -7.6091036e-09 -5.0727356e-09
 -5.0727356e-09 -5.0727356e-09 -5.0727356e-09 -5.0727356e-09
 -5.0727356e-09 -6.3409198e-09]
2025-06-06 15:41:59,649 - DEBUG - Updated reference std: node=[1.0038388 1.0038388 1.0038388 1.0038388 1.0038388 1.0038388 1.0038388
 1.0038388 1.0038388 1.0038388 1.0038388 1.0038388 1.0038388 1.0038388
 1.0038388 1.0038388 1.0038388 1.0038388 1.0038388], edge=[0.43694445 2.0172415  1.0026703  1.0026702  1.0026703  1.0026703
 1.0026703  1.0026702  1.0026703  1.0026702  1.0026703  1.0026703
 1.0026703  1.0026703  1.0026703  1.0026703  1.0026703  1.0026703
 1.0026703  1.0026703  1.0026703  1.0026703 ]
2025-06-06 15:41:59,649 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:41:59,649 - INFO - Running anomaly detection...
2025-06-06 15:41:59,649 - INFO - Starting anomaly detection.
2025-06-06 15:41:59,654 - DEBUG - Node reconstruction errors: [10.585736   4.853439  10.514766   9.144483   5.9990635  7.0947533
  4.7911367  4.616133   8.749993   9.538243   4.5454445  9.553892
 10.020391  10.020391   8.57463    8.133682   4.5711856  8.512903
 13.0296755 10.227309   8.6046095  8.2439785 10.165772   9.034935
  7.749021   9.282733   4.2236824  9.195743  10.020391   7.707826
  9.084727  11.994621  10.874856   6.1693435  9.915424   8.63779
  9.674294  10.49084    9.560245   8.380058   9.216415   9.519345
  9.681324   8.552605   9.9405365 13.2098675  9.584548   8.70414
 10.24598   10.589687   9.957871  18.680933   9.512475   9.599144
 10.421141   9.892317  20.478662   9.497238   9.594575   4.7458463
 10.426041   9.28668    9.801674  10.179348   9.9469385 10.136286
  9.790708   9.926135  10.334974   4.924536   7.4017043 10.3586855
  8.3363085 10.682948   9.363281   9.732988  10.65198    7.2057743
 10.107932  10.365183   4.6292176  9.950676   9.533639   9.481608
  8.175275   9.894289   9.8575     9.504542   7.8778453 10.222505
  9.888784   4.278675   4.6879168  9.364174   4.3471484 10.349596
  4.6211166  8.932602  10.462272  10.313574  10.081704   9.674787
 10.198176   4.921808   4.9100423  4.2786736  8.169472   9.497883
  8.970124   4.69419    4.6286626  4.278674   4.637215   4.6732
  4.5893664 10.682842   4.581846   9.648734  10.478345  10.696307
  4.913361  10.286814  10.286814  10.504786  10.478509  10.87886
  9.7887    10.276142  10.416334   8.292334  10.864113 ]
2025-06-06 15:41:59,655 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999987 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999]
2025-06-06 15:41:59,656 - ERROR - An error occurred while processing file nw_graph_encoded_1749044408.dot: name 'os' is not defined
2025-06-06 15:41:59,656 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow.py", line 429, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 9, in save_anomalies_to_file
    filename = os.path.join(anomaly_log_path, f"anomalies_{timestamp}_update_{processed_files_count}.json")
               ^^
NameError: name 'os' is not defined. Did you forget to import 'os'

2025-06-06 15:41:59,656 - INFO - 
--- Processing file: nw_graph_encoded_1749044468.dot ---
2025-06-06 15:41:59,656 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044468.dot
2025-06-06 15:41:59,656 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044468.dot file.
2025-06-06 15:41:59,659 - INFO - Parsed 258 nodes.
2025-06-06 15:41:59,663 - INFO - Parsed 397 edges.
2025-06-06 15:41:59,699 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:41:59,699 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:41:59,701 - DEBUG - Initial node features tensor shape: torch.Size([258, 19])
2025-06-06 15:41:59,702 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:41:59,702 - DEBUG - Node features tensor shape after scaling: torch.Size([258, 19])
2025-06-06 15:41:59,703 - DEBUG - Edge index tensor shape: torch.Size([2, 397])
2025-06-06 15:41:59,703 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:41:59,705 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:41:59,706 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:41:59,706 - DEBUG - Shape of encoded categorical edge features: torch.Size([397, 2])
2025-06-06 15:41:59,707 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:41:59,707 - DEBUG - Shape of scaled numerical edge features: torch.Size([397, 20])
2025-06-06 15:41:59,707 - DEBUG - Final edge attributes tensor shape: torch.Size([397, 22])
2025-06-06 15:41:59,707 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:41:59,707 - INFO - Performing online update...
2025-06-06 15:41:59,708 - INFO - Starting online update for 50 steps.
2025-06-06 15:41:59,708 - DEBUG - Updated RunningStats: new_mean=[ 1.55755672e-10  2.34436372e-10 -7.28358482e-09 -5.72281665e-09
 -7.39919728e-09  7.70749717e-10  9.35176323e-09  2.13240755e-09
  1.34881200e-09  9.76282975e-10 -3.08299887e-09 -7.21935568e-09
  1.43873280e-09 -2.82608230e-09 -4.47034836e-09 -5.52370630e-10
 -3.82805693e-09  1.45679725e-09 -7.81026380e-09], new_M2=[579.99999143 579.99999133 580.00000413 579.99996606 579.99999334
 580.00000764 579.99999452 579.99999339 580.00002839 579.99999643
 579.9999921  579.99999108 579.99999403 580.00000041 579.99999386
 580.0000112  580.00000608 580.00001307 580.00001297], new_n=580
2025-06-06 15:41:59,709 - DEBUG - Updated RunningStats: new_mean=[ 1.16193853e+00  3.91843972e+00  2.26273681e-09  3.49383572e-10
  1.89388188e-09  3.40129517e-10  3.87514406e-09 -2.60407039e-09
 -1.90003979e-09  5.65646362e-09  5.06392889e-10 -5.48111820e-09
  1.15314468e-09 -2.19510309e-09 -2.29197825e-09  8.96095243e-10
  8.96095243e-10  8.96095243e-10  8.96095243e-10  8.96095243e-10
  8.96095243e-10  2.47141747e-10], new_M2=[ 236.8144208  4125.37234043  846.00002633  846.00002244  846.00003338
  845.99997859  845.99998299  845.99998938  845.99999038  845.99999217
  846.00003061  846.0000252   846.00000333  846.00000551  846.00000533
  846.00001671  846.00001671  846.00001671  846.00001671  846.00001671
  846.00001671  846.00000252], new_n=846
2025-06-06 15:41:59,709 - DEBUG - Calculated standard deviation: [0.99999999 0.99999999 1.         0.99999997 0.99999999 1.00000001
 1.         0.99999999 1.00000002 1.         0.99999999 0.99999999
 0.99999999 1.         0.99999999 1.00000001 1.00000001 1.00000001
 1.00000001]
2025-06-06 15:41:59,709 - DEBUG - Calculated standard deviation: [0.52907701 2.20824062 1.00000002 1.00000001 1.00000002 0.99999999
 0.99999999 0.99999999 0.99999999 1.         1.00000002 1.00000001
 1.         1.         1.         1.00000001 1.00000001 1.00000001
 1.00000001 1.00000001 1.00000001 1.        ]
2025-06-06 15:41:59,709 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:41:59,709 - DEBUG - Online update step: 1/50
2025-06-06 15:41:59,709 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,709 - DEBUG - Online update step: 2/50
2025-06-06 15:41:59,709 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,709 - DEBUG - Online update step: 3/50
2025-06-06 15:41:59,709 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,709 - DEBUG - Online update step: 4/50
2025-06-06 15:41:59,709 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,709 - DEBUG - Online update step: 5/50
2025-06-06 15:41:59,709 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,709 - DEBUG - Online update step: 6/50
2025-06-06 15:41:59,709 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,709 - DEBUG - Online update step: 7/50
2025-06-06 15:41:59,709 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,710 - DEBUG - Online update step: 8/50
2025-06-06 15:41:59,710 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,710 - DEBUG - Online update step: 9/50
2025-06-06 15:41:59,710 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,710 - DEBUG - Online update step: 10/50
2025-06-06 15:41:59,710 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,710 - DEBUG - Online update step: 11/50
2025-06-06 15:41:59,710 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,710 - DEBUG - Online update step: 12/50
2025-06-06 15:41:59,710 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,710 - DEBUG - Online update step: 13/50
2025-06-06 15:41:59,710 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,710 - DEBUG - Online update step: 14/50
2025-06-06 15:41:59,710 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,710 - DEBUG - Online update step: 15/50
2025-06-06 15:41:59,710 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,710 - DEBUG - Online update step: 16/50
2025-06-06 15:41:59,710 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,710 - DEBUG - Online update step: 17/50
2025-06-06 15:41:59,710 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,710 - DEBUG - Online update step: 18/50
2025-06-06 15:41:59,710 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,710 - DEBUG - Online update step: 19/50
2025-06-06 15:41:59,710 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,710 - DEBUG - Online update step: 20/50
2025-06-06 15:41:59,710 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,710 - DEBUG - Online update step: 21/50
2025-06-06 15:41:59,710 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,710 - DEBUG - Online update step: 22/50
2025-06-06 15:41:59,710 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,711 - DEBUG - Online update step: 23/50
2025-06-06 15:41:59,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,711 - DEBUG - Online update step: 24/50
2025-06-06 15:41:59,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,711 - DEBUG - Online update step: 25/50
2025-06-06 15:41:59,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,711 - DEBUG - Online update step: 26/50
2025-06-06 15:41:59,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,711 - DEBUG - Online update step: 27/50
2025-06-06 15:41:59,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,711 - DEBUG - Online update step: 28/50
2025-06-06 15:41:59,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,711 - DEBUG - Online update step: 29/50
2025-06-06 15:41:59,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,711 - DEBUG - Online update step: 30/50
2025-06-06 15:41:59,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,711 - DEBUG - Online update step: 31/50
2025-06-06 15:41:59,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,711 - DEBUG - Online update step: 32/50
2025-06-06 15:41:59,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,711 - DEBUG - Online update step: 33/50
2025-06-06 15:41:59,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,711 - DEBUG - Online update step: 34/50
2025-06-06 15:41:59,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,711 - DEBUG - Online update step: 35/50
2025-06-06 15:41:59,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,711 - DEBUG - Online update step: 36/50
2025-06-06 15:41:59,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,711 - DEBUG - Online update step: 37/50
2025-06-06 15:41:59,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,711 - DEBUG - Online update step: 38/50
2025-06-06 15:41:59,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,711 - DEBUG - Online update step: 39/50
2025-06-06 15:41:59,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,711 - DEBUG - Online update step: 40/50
2025-06-06 15:41:59,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,712 - DEBUG - Online update step: 41/50
2025-06-06 15:41:59,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,712 - DEBUG - Online update step: 42/50
2025-06-06 15:41:59,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,712 - DEBUG - Online update step: 43/50
2025-06-06 15:41:59,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,712 - DEBUG - Online update step: 44/50
2025-06-06 15:41:59,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,712 - DEBUG - Online update step: 45/50
2025-06-06 15:41:59,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,712 - DEBUG - Online update step: 46/50
2025-06-06 15:41:59,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,712 - DEBUG - Online update step: 47/50
2025-06-06 15:41:59,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,712 - DEBUG - Online update step: 48/50
2025-06-06 15:41:59,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,712 - DEBUG - Online update step: 49/50
2025-06-06 15:41:59,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,712 - DEBUG - Online update step: 50/50
2025-06-06 15:41:59,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,712 - WARNING - No successful steps during online update.
2025-06-06 15:41:59,713 - DEBUG - Current node mean: [ 4.0660534e-08 -3.8812328e-08 -9.2410302e-09 -2.2178472e-08
 -1.1089236e-08  1.4785648e-08 -6.4687211e-09  1.3861546e-08
  0.0000000e+00  3.5115914e-08 -2.0330267e-08 -2.0330267e-08
 -2.7723091e-08  1.6633855e-08  1.6633855e-08 -1.1089236e-08
  3.6964121e-09  0.0000000e+00  7.3928241e-09], current edge mean: [ 1.3249370e+00  4.5516372e+00  6.0055059e-09 -4.8044044e-09
  9.0082590e-09 -4.8044044e-09  4.8044044e-09 -6.6060561e-09
  8.4077083e-09  2.4022022e-09  1.5614315e-08 -2.4022022e-09
 -6.0055059e-09 -1.2011012e-08 -7.2066069e-09 -4.8044044e-09
 -4.8044044e-09 -4.8044044e-09 -4.8044044e-09 -4.8044044e-09
 -4.8044044e-09 -8.4077083e-09]
2025-06-06 15:41:59,713 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.3081
2025-06-06 15:41:59,713 - WARNING - Feature drift detected (1 consecutive)
2025-06-06 15:41:59,713 - DEBUG - Updated reference mean: node=[ 4.0660534e-08 -3.8812328e-08 -9.2410302e-09 -2.2178472e-08
 -1.1089236e-08  1.4785648e-08 -6.4687211e-09  1.3861546e-08
  0.0000000e+00  3.5115914e-08 -2.0330267e-08 -2.0330267e-08
 -2.7723091e-08  1.6633855e-08  1.6633855e-08 -1.1089236e-08
  3.6964121e-09  0.0000000e+00  7.3928241e-09], edge=[ 1.3249370e+00  4.5516372e+00  6.0055059e-09 -4.8044044e-09
  9.0082590e-09 -4.8044044e-09  4.8044044e-09 -6.6060561e-09
  8.4077083e-09  2.4022022e-09  1.5614315e-08 -2.4022022e-09
 -6.0055059e-09 -1.2011012e-08 -7.2066069e-09 -4.8044044e-09
 -4.8044044e-09 -4.8044044e-09 -4.8044044e-09 -4.8044044e-09
 -4.8044044e-09 -8.4077083e-09]
2025-06-06 15:41:59,713 - DEBUG - Updated reference std: node=[1.0019436 1.0019436 1.0019436 1.0019436 1.0019436 1.0019436 1.0019436
 1.0019436 1.0019437 1.0019436 1.0019436 1.0019436 1.0019436 1.0019436
 1.0019436 1.0019437 1.0019436 1.0019436 1.0019436], edge=[0.47429672 2.2020373  1.0012618  1.0012618  1.0012618  1.0012618
 1.0012618  1.0012618  1.0012618  1.0012618  1.0012618  1.0012618
 1.0012618  1.0012618  1.0012618  1.0012618  1.0012618  1.0012618
 1.0012618  1.0012618  1.0012618  1.0012618 ]
2025-06-06 15:41:59,714 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:41:59,714 - INFO - Running anomaly detection...
2025-06-06 15:41:59,714 - INFO - Starting anomaly detection.
2025-06-06 15:41:59,736 - DEBUG - Node reconstruction errors: [16.647669  18.416107  15.0260105 18.932583  16.802023  18.43791
 17.790289  18.533318  17.705914  18.86999   18.804565  16.617468
 18.4881    17.63273   19.136452  17.566612  17.524014  17.468033
 13.088962  17.70548   18.080164  18.906918  17.593391  18.56311
 17.359196  18.444216  18.735558  17.599262  18.431915  16.370266
 17.229776  18.686762  18.41424   16.904564  17.304428  17.296864
 17.903873  17.895767  18.356165  18.577572  18.804153  16.943161
 20.246637  17.2213    17.659063  17.434433  19.1144    17.599628
 18.191109  18.176634  17.287554  18.268543  17.42351   18.049044
 18.459335  17.552687  18.588627  17.82694   18.030645  18.524435
 18.657705  18.434542  18.604546  18.564735  18.443008  18.637815
 18.25459   18.019943  18.693499  17.481316  18.503693  17.757378
 19.311684  15.848834  17.631714  18.441452  19.474916  17.768126
 18.35007   16.724787  18.90228   17.544115  18.750654  17.94671
 18.094496  31.075699  19.051897  18.960325  18.827625  17.750494
 18.902977  18.550026  18.285233  17.752914  18.861605  18.991573
 16.60848   18.755407  18.306738  18.701136  15.67577   17.020496
 17.967096  16.460642  18.671162  16.497797  18.047768  18.29468
 14.791419  16.198797  17.745195  18.134386  17.310621  18.025843
 19.442863  17.888716  16.238075  18.603327  17.47687   17.47454
 18.658524  33.194912  19.231812  14.651372  16.421577  17.757772
 15.118326  17.463785  17.209032  17.704964  16.634308  18.657568
 19.103796  15.97037   16.847174  18.467466  17.500998  18.180496
 19.62231   15.849999  19.54614   18.510248  18.983309  15.433626
 17.361954  18.111744  18.037214  18.397676  19.455732  17.62847
 18.38249   17.743948  16.096994  17.963573  18.26286   18.806612
 17.275045  18.631117  17.930676  17.747755  18.546482  18.598495
 18.084532  17.705914  18.479904  14.7390375 17.42263   17.685228
 17.231186  17.879807  17.33931   18.907055  18.337805  17.157112
 17.78239   17.927464  18.96849   17.881271  17.721102  18.537317
 18.680807  17.136103  18.807987  18.504686  18.503426  18.171268
 18.658817  18.362158  19.056072  33.380543  17.829863  18.678946
 18.642317  17.742544  19.003122  18.491693  16.043852  18.982693
 18.326136  17.73847    9.321286  18.731676  18.460403  18.868078
 18.308355  19.322077  17.98644   16.746828  17.963573  18.214174
 18.235477  18.367386  18.525911  17.178888  16.514809  17.502003
 18.789091  18.028263  18.271093  18.028793  18.63126   18.21877
 17.963573  18.679491  17.317041  18.335684  17.879276  18.851887
 18.743     18.532684  18.479097  18.967682  18.71258   18.09326
 16.44137   18.53445   18.406357  17.808172  18.742819  17.803299
 18.583725  18.599245  18.768658  19.33772   18.665579  17.94317
 17.963573  18.90522   19.173399  16.163427  19.19243   18.443008
 17.703733  19.20873   17.26137   19.149836  19.244453  19.342482 ]
2025-06-06 15:41:59,738 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999]
2025-06-06 15:41:59,745 - ERROR - An error occurred while processing file nw_graph_encoded_1749044468.dot: name 'os' is not defined
2025-06-06 15:41:59,745 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow.py", line 429, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 9, in save_anomalies_to_file
    filename = os.path.join(anomaly_log_path, f"anomalies_{timestamp}_update_{processed_files_count}.json")
               ^^
NameError: name 'os' is not defined. Did you forget to import 'os'

2025-06-06 15:41:59,745 - INFO - 
--- Processing file: nw_graph_encoded_1749044528.dot ---
2025-06-06 15:41:59,745 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044528.dot
2025-06-06 15:41:59,745 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044528.dot file.
2025-06-06 15:41:59,750 - INFO - Parsed 365 nodes.
2025-06-06 15:41:59,756 - INFO - Parsed 656 edges.
2025-06-06 15:41:59,838 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:41:59,838 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:41:59,841 - DEBUG - Initial node features tensor shape: torch.Size([365, 19])
2025-06-06 15:41:59,844 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:41:59,845 - DEBUG - Node features tensor shape after scaling: torch.Size([365, 19])
2025-06-06 15:41:59,845 - DEBUG - Edge index tensor shape: torch.Size([2, 656])
2025-06-06 15:41:59,846 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:41:59,849 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:41:59,850 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:41:59,851 - DEBUG - Shape of encoded categorical edge features: torch.Size([656, 2])
2025-06-06 15:41:59,852 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:41:59,852 - DEBUG - Shape of scaled numerical edge features: torch.Size([656, 20])
2025-06-06 15:41:59,852 - DEBUG - Final edge attributes tensor shape: torch.Size([656, 22])
2025-06-06 15:41:59,852 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:41:59,852 - INFO - Performing online update...
2025-06-06 15:41:59,853 - INFO - Starting online update for 50 steps.
2025-06-06 15:41:59,853 - DEBUG - Updated RunningStats: new_mean=[ 3.56464947e-09 -3.16748228e-09 -6.45716985e-09 -2.53477425e-09
  2.52294793e-09  4.32054832e-09 -6.54679117e-09  1.84490567e-09
  8.27842289e-10  5.10896955e-09  2.69640060e-09 -4.19440093e-09
 -7.88421227e-10  4.38362202e-09 -3.46905340e-09 -3.39021128e-10
 -7.58461221e-09  1.44650657e-09 -1.00602549e-08], new_M2=[944.99999157 944.99999134 945.00001828 944.99998346 944.99998883
 944.99998871 944.99998599 945.00000337 945.00003147 945.00001633
 945.00000075 944.99998793 945.00002691 944.99998148 944.99998496
 945.0000052  945.00001674 944.99998454 945.00002454], new_n=945
2025-06-06 15:41:59,853 - DEBUG - Updated RunningStats: new_mean=[ 1.25765646e+00  4.28761651e+00 -2.99564060e-11 -5.42083063e-10
  1.26033925e-09 -6.09378405e-10 -9.57335819e-10 -4.70389207e-10
 -7.43271526e-10  2.66933667e-10 -1.60346217e-09 -1.37154223e-09
  1.55106752e-09 -5.52220962e-09 -2.03068005e-09  1.37388681e-09
  1.37388681e-09  1.37388681e-09  1.37388681e-09  1.37388681e-09
  1.37388681e-09 -4.28768016e-10], new_M2=[ 417.28695073 7027.74966711 1501.99999287 1501.9999764  1502.00004876
 1501.99995557 1501.99998953 1502.0000141  1501.99998456 1502.00000067
 1501.9999894  1502.00000755 1501.99999931 1502.00001357 1501.99997549
 1502.00005719 1502.00005719 1502.00005719 1502.00005719 1502.00005719
 1502.00005719 1501.99996955], new_n=1502
2025-06-06 15:41:59,854 - DEBUG - Calculated standard deviation: [1.         1.         1.00000001 0.99999999 0.99999999 0.99999999
 0.99999999 1.         1.00000002 1.00000001 1.         0.99999999
 1.00000001 0.99999999 0.99999999 1.         1.00000001 0.99999999
 1.00000001]
2025-06-06 15:41:59,854 - DEBUG - Calculated standard deviation: [0.52708716 2.16308296 1.         0.99999999 1.00000002 0.99999999
 1.         1.         0.99999999 1.         1.         1.
 1.         1.         0.99999999 1.00000002 1.00000002 1.00000002
 1.00000002 1.00000002 1.00000002 0.99999999]
2025-06-06 15:41:59,854 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:41:59,854 - DEBUG - Online update step: 1/50
2025-06-06 15:41:59,854 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,854 - DEBUG - Online update step: 2/50
2025-06-06 15:41:59,854 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,854 - DEBUG - Online update step: 3/50
2025-06-06 15:41:59,854 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,854 - DEBUG - Online update step: 4/50
2025-06-06 15:41:59,854 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,854 - DEBUG - Online update step: 5/50
2025-06-06 15:41:59,854 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,854 - DEBUG - Online update step: 6/50
2025-06-06 15:41:59,855 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,855 - DEBUG - Online update step: 7/50
2025-06-06 15:41:59,855 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,855 - DEBUG - Online update step: 8/50
2025-06-06 15:41:59,855 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,855 - DEBUG - Online update step: 9/50
2025-06-06 15:41:59,855 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,855 - DEBUG - Online update step: 10/50
2025-06-06 15:41:59,855 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,855 - DEBUG - Online update step: 11/50
2025-06-06 15:41:59,855 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,855 - DEBUG - Online update step: 12/50
2025-06-06 15:41:59,855 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,855 - DEBUG - Online update step: 13/50
2025-06-06 15:41:59,855 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,855 - DEBUG - Online update step: 14/50
2025-06-06 15:41:59,855 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,855 - DEBUG - Online update step: 15/50
2025-06-06 15:41:59,855 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,855 - DEBUG - Online update step: 16/50
2025-06-06 15:41:59,855 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,855 - DEBUG - Online update step: 17/50
2025-06-06 15:41:59,855 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,855 - DEBUG - Online update step: 18/50
2025-06-06 15:41:59,855 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,855 - DEBUG - Online update step: 19/50
2025-06-06 15:41:59,855 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,855 - DEBUG - Online update step: 20/50
2025-06-06 15:41:59,855 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,855 - DEBUG - Online update step: 21/50
2025-06-06 15:41:59,855 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,855 - DEBUG - Online update step: 22/50
2025-06-06 15:41:59,855 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,855 - DEBUG - Online update step: 23/50
2025-06-06 15:41:59,855 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,856 - DEBUG - Online update step: 24/50
2025-06-06 15:41:59,856 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,856 - DEBUG - Online update step: 25/50
2025-06-06 15:41:59,856 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,856 - DEBUG - Online update step: 26/50
2025-06-06 15:41:59,856 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,856 - DEBUG - Online update step: 27/50
2025-06-06 15:41:59,856 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,856 - DEBUG - Online update step: 28/50
2025-06-06 15:41:59,856 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,856 - DEBUG - Online update step: 29/50
2025-06-06 15:41:59,856 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,856 - DEBUG - Online update step: 30/50
2025-06-06 15:41:59,856 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,856 - DEBUG - Online update step: 31/50
2025-06-06 15:41:59,856 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,856 - DEBUG - Online update step: 32/50
2025-06-06 15:41:59,856 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,856 - DEBUG - Online update step: 33/50
2025-06-06 15:41:59,856 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,856 - DEBUG - Online update step: 34/50
2025-06-06 15:41:59,856 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,856 - DEBUG - Online update step: 35/50
2025-06-06 15:41:59,856 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,856 - DEBUG - Online update step: 36/50
2025-06-06 15:41:59,856 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,856 - DEBUG - Online update step: 37/50
2025-06-06 15:41:59,856 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,856 - DEBUG - Online update step: 38/50
2025-06-06 15:41:59,856 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,856 - DEBUG - Online update step: 39/50
2025-06-06 15:41:59,856 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,856 - DEBUG - Online update step: 40/50
2025-06-06 15:41:59,856 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,856 - DEBUG - Online update step: 41/50
2025-06-06 15:41:59,856 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,857 - DEBUG - Online update step: 42/50
2025-06-06 15:41:59,857 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,857 - DEBUG - Online update step: 43/50
2025-06-06 15:41:59,857 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,857 - DEBUG - Online update step: 44/50
2025-06-06 15:41:59,857 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,857 - DEBUG - Online update step: 45/50
2025-06-06 15:41:59,857 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,857 - DEBUG - Online update step: 46/50
2025-06-06 15:41:59,857 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,857 - DEBUG - Online update step: 47/50
2025-06-06 15:41:59,857 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,857 - DEBUG - Online update step: 48/50
2025-06-06 15:41:59,857 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,857 - DEBUG - Online update step: 49/50
2025-06-06 15:41:59,857 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,857 - DEBUG - Online update step: 50/50
2025-06-06 15:41:59,857 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:59,857 - WARNING - No successful steps during online update.
2025-06-06 15:41:59,858 - DEBUG - Current node mean: [ 3.3966483e-08 -3.3966483e-08 -3.1353675e-08 -3.3966483e-08
  1.5676838e-08  1.5676838e-08 -3.1353675e-08 -1.3064032e-09
  1.3064032e-09  3.9192094e-09  2.0902451e-08 -1.6983241e-08
 -1.1104427e-08 -1.3717234e-08 -2.8740869e-08  1.4370435e-08
 -4.5724109e-09 -4.7030515e-08  2.6128064e-09], current edge mean: [ 1.3810976e+00  4.7637196e+00  7.2688588e-10 -4.3613153e-09
  0.0000000e+00 -1.4537718e-09 -5.0882014e-09  1.8172148e-09
  8.7226306e-09  7.2688588e-10 -4.3613153e-09  4.3613153e-09
 -1.4537718e-09 -2.0352806e-08 -2.0352806e-08 -1.4537718e-09
 -1.4537718e-09 -1.4537718e-09 -1.4537718e-09 -1.4537718e-09
 -1.4537718e-09  2.9075435e-09]
2025-06-06 15:41:59,858 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.2342
2025-06-06 15:41:59,858 - WARNING - Feature drift detected (2 consecutive)
2025-06-06 15:41:59,858 - DEBUG - Updated reference mean: node=[ 3.3966483e-08 -3.3966483e-08 -3.1353675e-08 -3.3966483e-08
  1.5676838e-08  1.5676838e-08 -3.1353675e-08 -1.3064032e-09
  1.3064032e-09  3.9192094e-09  2.0902451e-08 -1.6983241e-08
 -1.1104427e-08 -1.3717234e-08 -2.8740869e-08  1.4370435e-08
 -4.5724109e-09 -4.7030515e-08  2.6128064e-09], edge=[ 1.3810976e+00  4.7637196e+00  7.2688588e-10 -4.3613153e-09
  0.0000000e+00 -1.4537718e-09 -5.0882014e-09  1.8172148e-09
  8.7226306e-09  7.2688588e-10 -4.3613153e-09  4.3613153e-09
 -1.4537718e-09 -2.0352806e-08 -2.0352806e-08 -1.4537718e-09
 -1.4537718e-09 -1.4537718e-09 -1.4537718e-09 -1.4537718e-09
 -1.4537718e-09  2.9075435e-09]
2025-06-06 15:41:59,858 - DEBUG - Updated reference std: node=[1.0013727 1.0013727 1.0013727 1.0013727 1.0013727 1.0013727 1.0013727
 1.0013727 1.0013727 1.0013727 1.0013727 1.0013727 1.0013727 1.0013727
 1.0013727 1.0013727 1.0013727 1.0013727 1.0013727], edge=[0.4984336 2.0070016 1.000763  1.000763  1.000763  1.000763  1.000763
 1.000763  1.000763  1.000763  1.000763  1.000763  1.000763  1.000763
 1.000763  1.000763  1.000763  1.000763  1.000763  1.000763  1.000763
 1.000763 ]
2025-06-06 15:41:59,859 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:41:59,859 - INFO - Running anomaly detection...
2025-06-06 15:41:59,859 - INFO - Starting anomaly detection.
2025-06-06 15:41:59,871 - DEBUG - Node reconstruction errors: [26.69582  27.834538 26.74486  24.543127 27.005152 27.039963 26.994225
 27.145794 26.883347 27.03756  25.958511 27.146744 27.47261  27.112661
 21.478834 25.464691 27.392452 20.585499 27.306885 26.233532 27.346869
 26.65123  25.402063 27.00692  22.76099  26.25941  26.944952 25.860039
 25.752033 26.25566  26.040777 26.393688 26.177149 21.3793   26.12451
 25.9175   26.292828 26.343203 27.021225 26.59641  27.59829  26.85578
 25.76286  24.304144 24.304144 24.304144 26.540623 26.626995 24.316345
 25.039776 25.039776 27.351637 25.973413 26.324211 26.380505 21.891125
 26.214012 25.868889 26.269873 26.406263 26.802921 27.380236 22.87913
 25.885141 26.89238  26.952543 26.178732 21.313774 26.162054 26.249804
 19.388708 25.830389 21.491552 26.912558 24.782185 25.584631 25.057802
 26.947046 22.355785 26.019548 26.46884  28.033123 26.391043 21.251799
 22.292166 22.059175 25.546747 21.931213 22.915747 21.88472  21.928656
 15.263881 26.858282 21.110556 21.459251 22.850729 25.10939  25.295614
 24.983948 22.229828 25.596325 24.359522 22.293053 19.579273 26.925901
 25.051325 26.169497 24.744492 27.158676 24.344812 25.047884 22.877813
 25.944069 25.498468 22.622452 26.139591 22.175497 24.877464 24.268026
 25.04645  24.941536 25.413404 27.045324 26.627443 24.737638 25.999538
 26.410782 25.015097 24.934668 26.629202 26.139055 25.588205 25.699663
 25.818403 25.621267 27.019743 24.74614  25.791143 25.13232  26.335758
 27.025629 26.338844 27.016846 25.268421 26.356026 26.42834  22.314259
 22.056246 25.870869 26.050179 25.016827 26.7004   22.967611 23.118196
 26.603498 22.336079 24.829636 21.023426 25.870373 24.6015   22.88648
 26.090971 26.458279 26.251474 25.582039 26.019308 43.581753 26.170248
 25.529303 26.597364 22.69456  25.633963 23.187891 25.36868  25.312881
 22.064548 23.854372 23.344637 23.934834 22.21716  26.944698 22.042057
 26.073128 22.439484 24.491245 25.346237 23.931934 26.249374 24.231857
 26.43199  26.044313 21.403728 23.54014  25.816748 20.636314 26.51623
 21.569168 21.413599 25.516113 22.370611 23.460701 26.882673 22.96691
 23.966621 26.232702 41.828644 23.113663 26.189308 25.858305 26.338537
 19.388792 25.063164 17.892775 24.972946 25.311192 28.006004 24.86569
 27.055298 24.759855 26.23166  27.323036 23.20131  24.650763 24.311241
 25.089329 21.11924  24.510931 26.410072 20.975224 22.708614 24.980076
 25.993    24.207266 24.378912 26.536266 26.140844 24.848875 23.159622
 26.396927 22.869379 26.257301 26.036316 25.20583  25.525072 21.905624
 24.968323 25.124426 25.793783 25.58005  26.369635 27.274752 22.404877
 25.130062 22.285757 24.040543 25.47268  26.196774 21.377367 24.187572
 25.283463 24.364994 26.199152 26.049124 26.097559 23.06746  25.075096
 26.802444 20.887173 23.470829 21.948717 22.594934 28.13811  20.951746
 22.154844 26.40584  23.266827 25.385578 22.701698 26.051275 22.350012
 22.047474 22.41589  21.838398 26.112305 45.08473  21.028648 23.081902
 22.503838 21.06156  26.40091  26.113388 22.92774  21.596107 26.035995
 19.947008 22.765944 26.624685 26.30932  26.124868 13.322315 22.317642
 22.154638 22.342922 22.183369 25.377949 26.43576  19.954115 24.710922
 21.59554  21.569992 22.04822  25.900072 25.70778  21.102236 24.534632
 25.315708 25.994196 25.33484  26.828655 26.070433 24.615862 27.651953
 24.710922 24.463089 26.692513 23.288284 25.704874 26.134243 22.706211
 26.325039 27.02532  25.431997 22.89503  25.751595 22.583414 25.341927
 23.116917 26.421206 26.087748 23.872936 22.093706 24.952707 27.177233
 26.681992 27.110018 22.043402 24.782366 26.163475 22.657923 24.414753
 22.534119 22.034134 24.710922 18.024544 25.624947 22.393145 22.773117
 23.131369 26.313599 25.805986 25.40527  24.852394 25.374472 26.69309
 23.12541 ]
2025-06-06 15:41:59,873 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999]
2025-06-06 15:41:59,875 - ERROR - An error occurred while processing file nw_graph_encoded_1749044528.dot: name 'os' is not defined
2025-06-06 15:41:59,876 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow.py", line 429, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 9, in save_anomalies_to_file
    filename = os.path.join(anomaly_log_path, f"anomalies_{timestamp}_update_{processed_files_count}.json")
               ^^
NameError: name 'os' is not defined. Did you forget to import 'os'

2025-06-06 15:41:59,876 - INFO - 
--- Processing file: nw_graph_encoded_1749044588.dot ---
2025-06-06 15:41:59,876 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044588.dot
2025-06-06 15:41:59,876 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044588.dot file.
2025-06-06 15:41:59,881 - INFO - Parsed 422 nodes.
2025-06-06 15:41:59,889 - INFO - Parsed 847 edges.
2025-06-06 15:42:00,001 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:42:00,002 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:42:00,005 - DEBUG - Initial node features tensor shape: torch.Size([422, 19])
2025-06-06 15:42:00,006 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:42:00,006 - DEBUG - Node features tensor shape after scaling: torch.Size([422, 19])
2025-06-06 15:42:00,007 - DEBUG - Edge index tensor shape: torch.Size([2, 847])
2025-06-06 15:42:00,007 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:42:00,012 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:42:00,013 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:42:00,013 - DEBUG - Shape of encoded categorical edge features: torch.Size([847, 2])
2025-06-06 15:42:00,015 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:42:00,015 - DEBUG - Shape of scaled numerical edge features: torch.Size([847, 20])
2025-06-06 15:42:00,015 - DEBUG - Final edge attributes tensor shape: torch.Size([847, 22])
2025-06-06 15:42:00,015 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:42:00,015 - INFO - Performing online update...
2025-06-06 15:42:00,015 - INFO - Starting online update for 50 steps.
2025-06-06 15:42:00,016 - DEBUG - Updated RunningStats: new_mean=[ 2.52962745e-09 -2.12426027e-09 -6.09890248e-09 -4.49650987e-10
  1.13366552e-09 -7.23801831e-09 -8.64620087e-09  1.24812213e-09
  2.00026560e-09  5.89179051e-09  1.39146542e-08 -8.50249139e-10
 -1.28627434e-09  3.21023553e-09 -4.11226266e-09 -6.52947736e-09
 -3.68986325e-09 -8.63534282e-11 -8.39348509e-09], new_M2=[1366.99994687 1366.99994646 1367.00000784 1366.99999695 1366.99999366
 1366.99998163 1366.99995823 1367.00001505 1367.00003354 1367.00003672
 1366.99999813 1366.99999058 1366.99999517 1367.00001087 1367.00001019
 1366.99998064 1367.00002172 1367.00001332 1367.00001729], new_n=1367
2025-06-06 15:42:00,016 - DEBUG - Updated RunningStats: new_mean=[ 1.31885909e+00  4.49510430e+00  7.24931937e-10 -3.25754751e-10
  4.94306692e-10  1.41334470e-10  4.86346194e-10 -8.50887467e-10
  8.09914131e-10 -5.76872859e-10  1.12462950e-10 -3.28831159e-09
  1.50234741e-09 -9.51939337e-09 -1.12242410e-09  7.09741943e-10
  7.09741943e-10  7.09741943e-10  7.09741943e-10  7.09741943e-10
  7.09741943e-10 -2.53961586e-10], new_M2=[  648.17454236 10161.19369945  2349.00002915  2349.00000915
  2349.00004322  2348.99999694  2348.99997364  2349.00001998
  2348.99999893  2349.00000629  2348.99999161  2349.00004552
  2348.99999584  2349.00002899  2348.99997131  2349.0000342
  2349.0000342   2349.0000342   2349.0000342   2349.0000342
  2349.0000342   2348.9999548 ], new_n=2349
2025-06-06 15:42:00,016 - DEBUG - Calculated standard deviation: [0.99999998 0.99999998 1.         1.         1.         0.99999999
 0.99999998 1.00000001 1.00000001 1.00000001 1.         1.
 1.         1.         1.         0.99999999 1.00000001 1.
 1.00000001]
2025-06-06 15:42:00,017 - DEBUG - Calculated standard deviation: [0.52529646 2.07984446 1.00000001 1.         1.00000001 1.
 0.99999999 1.         1.         1.         1.         1.00000001
 1.         1.00000001 0.99999999 1.00000001 1.00000001 1.00000001
 1.00000001 1.00000001 1.00000001 0.99999999]
2025-06-06 15:42:00,017 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:42:00,017 - DEBUG - Online update step: 1/50
2025-06-06 15:42:00,017 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,017 - DEBUG - Online update step: 2/50
2025-06-06 15:42:00,017 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,017 - DEBUG - Online update step: 3/50
2025-06-06 15:42:00,017 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,017 - DEBUG - Online update step: 4/50
2025-06-06 15:42:00,017 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,017 - DEBUG - Online update step: 5/50
2025-06-06 15:42:00,017 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,017 - DEBUG - Online update step: 6/50
2025-06-06 15:42:00,017 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,017 - DEBUG - Online update step: 7/50
2025-06-06 15:42:00,017 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,017 - DEBUG - Online update step: 8/50
2025-06-06 15:42:00,017 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,017 - DEBUG - Online update step: 9/50
2025-06-06 15:42:00,017 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,017 - DEBUG - Online update step: 10/50
2025-06-06 15:42:00,017 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,017 - DEBUG - Online update step: 11/50
2025-06-06 15:42:00,017 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,017 - DEBUG - Online update step: 12/50
2025-06-06 15:42:00,017 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,017 - DEBUG - Online update step: 13/50
2025-06-06 15:42:00,017 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,017 - DEBUG - Online update step: 14/50
2025-06-06 15:42:00,017 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,017 - DEBUG - Online update step: 15/50
2025-06-06 15:42:00,017 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,018 - DEBUG - Online update step: 16/50
2025-06-06 15:42:00,018 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,018 - DEBUG - Online update step: 17/50
2025-06-06 15:42:00,018 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,018 - DEBUG - Online update step: 18/50
2025-06-06 15:42:00,018 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,018 - DEBUG - Online update step: 19/50
2025-06-06 15:42:00,018 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,018 - DEBUG - Online update step: 20/50
2025-06-06 15:42:00,018 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,018 - DEBUG - Online update step: 21/50
2025-06-06 15:42:00,018 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,018 - DEBUG - Online update step: 22/50
2025-06-06 15:42:00,018 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,018 - DEBUG - Online update step: 23/50
2025-06-06 15:42:00,018 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,018 - DEBUG - Online update step: 24/50
2025-06-06 15:42:00,018 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,018 - DEBUG - Online update step: 25/50
2025-06-06 15:42:00,018 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,018 - DEBUG - Online update step: 26/50
2025-06-06 15:42:00,018 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,018 - DEBUG - Online update step: 27/50
2025-06-06 15:42:00,018 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,018 - DEBUG - Online update step: 28/50
2025-06-06 15:42:00,018 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,018 - DEBUG - Online update step: 29/50
2025-06-06 15:42:00,018 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,018 - DEBUG - Online update step: 30/50
2025-06-06 15:42:00,018 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,018 - DEBUG - Online update step: 31/50
2025-06-06 15:42:00,018 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,018 - DEBUG - Online update step: 32/50
2025-06-06 15:42:00,018 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,018 - DEBUG - Online update step: 33/50
2025-06-06 15:42:00,018 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,018 - DEBUG - Online update step: 34/50
2025-06-06 15:42:00,019 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,019 - DEBUG - Online update step: 35/50
2025-06-06 15:42:00,019 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,019 - DEBUG - Online update step: 36/50
2025-06-06 15:42:00,019 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,019 - DEBUG - Online update step: 37/50
2025-06-06 15:42:00,019 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,019 - DEBUG - Online update step: 38/50
2025-06-06 15:42:00,019 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,019 - DEBUG - Online update step: 39/50
2025-06-06 15:42:00,019 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,019 - DEBUG - Online update step: 40/50
2025-06-06 15:42:00,019 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,019 - DEBUG - Online update step: 41/50
2025-06-06 15:42:00,019 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,019 - DEBUG - Online update step: 42/50
2025-06-06 15:42:00,019 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,019 - DEBUG - Online update step: 43/50
2025-06-06 15:42:00,019 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,019 - DEBUG - Online update step: 44/50
2025-06-06 15:42:00,019 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,019 - DEBUG - Online update step: 45/50
2025-06-06 15:42:00,019 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,019 - DEBUG - Online update step: 46/50
2025-06-06 15:42:00,019 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,019 - DEBUG - Online update step: 47/50
2025-06-06 15:42:00,019 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,019 - DEBUG - Online update step: 48/50
2025-06-06 15:42:00,019 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,019 - DEBUG - Online update step: 49/50
2025-06-06 15:42:00,019 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,019 - DEBUG - Online update step: 50/50
2025-06-06 15:42:00,019 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,019 - WARNING - No successful steps during online update.
2025-06-06 15:42:00,020 - DEBUG - Current node mean: [ 3.1073512e-08 -3.0508538e-08 -4.5197837e-09  3.8418161e-08
 -3.8418161e-08 -2.9378592e-08 -2.9378592e-08 -9.0395673e-09
  2.2598918e-09 -1.5819243e-08  2.4858808e-08  2.2598918e-09
 -2.6271241e-08 -2.2598918e-08 -2.7118700e-08 -4.1807997e-08
  1.1864432e-08  1.3559350e-08  1.7231674e-08], current edge mean: [ 1.4273908e+00  4.8630462e+00  1.1259437e-09  4.5037747e-09
  2.2518873e-09 -2.2518873e-09  6.1926904e-09 -4.5037747e-09
  2.8148592e-10 -5.0667466e-09  9.0075494e-09 -6.7556623e-09
 -2.2518873e-09 -2.2237389e-08 -9.0075494e-09 -3.3778311e-09
 -3.3778311e-09 -3.3778311e-09 -3.3778311e-09 -3.3778311e-09
 -3.3778311e-09  0.0000000e+00]
2025-06-06 15:42:00,020 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.2066
2025-06-06 15:42:00,020 - WARNING - Feature drift detected (3 consecutive)
2025-06-06 15:42:00,021 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-06 15:42:00,021 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-06 15:42:00,021 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-06 15:42:00,021 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-06 15:42:00,021 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-06 15:42:00,021 - INFO - Resetting parameters of module: autoencoder.node_decoder.3
2025-06-06 15:42:00,021 - INFO - Resetting parameters of module: autoencoder.node_decoder.4
2025-06-06 15:42:00,021 - INFO - Resetting parameters of module: autoencoder.node_decoder.5
2025-06-06 15:42:00,021 - INFO - Resetting parameters of module: autoencoder.node_decoder.6
2025-06-06 15:42:00,021 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-06 15:42:00,022 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-06 15:42:00,022 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-06 15:42:00,022 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-06 15:42:00,022 - INFO - Resetting parameters of module: autoencoder.edge_decoder.3
2025-06-06 15:42:00,022 - INFO - Resetting parameters of module: autoencoder.edge_decoder.4
2025-06-06 15:42:00,022 - INFO - Resetting parameters of module: autoencoder.edge_decoder.5
2025-06-06 15:42:00,022 - INFO - Resetting parameters of module: autoencoder.edge_decoder.6
2025-06-06 15:42:00,022 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-06 15:42:00,023 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-06 15:42:00,023 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-06 15:42:00,023 - INFO - Optimizer and scheduler reset.
2025-06-06 15:42:00,024 - DEBUG - Updated reference mean: node=[ 3.1073512e-08 -3.0508538e-08 -4.5197837e-09  3.8418161e-08
 -3.8418161e-08 -2.9378592e-08 -2.9378592e-08 -9.0395673e-09
  2.2598918e-09 -1.5819243e-08  2.4858808e-08  2.2598918e-09
 -2.6271241e-08 -2.2598918e-08 -2.7118700e-08 -4.1807997e-08
  1.1864432e-08  1.3559350e-08  1.7231674e-08], edge=[ 1.4273908e+00  4.8630462e+00  1.1259437e-09  4.5037747e-09
  2.2518873e-09 -2.2518873e-09  6.1926904e-09 -4.5037747e-09
  2.8148592e-10 -5.0667466e-09  9.0075494e-09 -6.7556623e-09
 -2.2518873e-09 -2.2237389e-08 -9.0075494e-09 -3.3778311e-09
 -3.3778311e-09 -3.3778311e-09 -3.3778311e-09 -3.3778311e-09
 -3.3778311e-09  0.0000000e+00]
2025-06-06 15:42:00,024 - DEBUG - Updated reference std: node=[1.0011868 1.0011868 1.001187  1.001187  1.001187  1.001187  1.001187
 1.001187  1.001187  1.001187  1.001187  1.001187  1.0011868 1.001187
 1.001187  1.001187  1.001187  1.001187  1.001187 ], edge=[0.5044536 1.8686519 1.0005909 1.0005909 1.0005908 1.0005909 1.0005908
 1.0005908 1.0005908 1.0005908 1.0005908 1.0005909 1.0005908 1.0005908
 1.0005908 1.0005908 1.0005908 1.0005908 1.0005908 1.0005908 1.0005908
 1.0005908]
2025-06-06 15:42:00,024 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:42:00,024 - INFO - Running anomaly detection...
2025-06-06 15:42:00,024 - INFO - Starting anomaly detection.
2025-06-06 15:42:00,077 - DEBUG - Node reconstruction errors: [26.239233 26.437546 29.919806 29.956955 30.324106 24.48073  23.420856
 28.509132 26.941858 29.376497 26.47902  29.084736 25.450422 25.745075
 28.334402 29.307762 29.119995 26.627636 26.226273 29.503206 29.844141
 27.973038 28.933477 29.705875 29.440992 31.487719 31.603027 35.986954
 23.221266 27.264475 29.011593 30.207102 28.715046 27.249676 27.336187
 30.481361 24.001143 27.551254 27.57218  30.891422 25.500149 30.570288
 27.401138 26.44159  27.7006   27.979141 25.310104 28.3063   23.615927
 30.363989 27.535824 25.783289 29.949509 24.959162 30.762182 26.873098
 25.619734 30.73054  28.76593  26.114323 30.612709 30.37206  26.146053
 30.274761 30.153751 24.919567 26.279089 25.837414 21.77842  30.360031
 24.373123 30.383297 28.16363  28.229874 25.113493 26.30872  28.130033
 27.859056 29.839092 24.414364 30.129047 24.414364 29.951815 26.85731
 30.520502 28.447506 32.380688 28.285223 27.83397  30.622013 25.941492
 30.590357 28.402334 29.617188 27.97035  24.274137 28.257395 25.066418
 28.930246 25.937439 25.077368 32.724903 26.049757 25.382383 25.471167
 26.359066 29.850765 26.076767 26.169607 26.25442  26.278797 20.06222
 29.45121  27.13483  27.022987 24.958101 27.399094 32.85906  26.439154
 25.58924  29.072134 27.427372 37.777897 32.801567 32.768463 27.827875
 32.593655 23.05627  32.976772 37.763775 15.353636 27.369074 30.891739
 27.85332  28.500887 25.088135 28.16608  30.152405 29.176867 29.873705
 27.851784 22.424854 27.318985 30.514532 27.002813 27.736334 30.254751
 30.84669  30.95611  26.33335  30.19541  30.322895 31.712357 26.16207
 23.259401 32.61671  25.253738 28.019981 27.265902 29.970469 31.693012
 23.755943 27.221258 28.015362 27.914127 29.291378 28.382751 23.764023
 30.565561 28.884512 28.726896 24.964376 30.625341 23.733297 25.259394
 24.346952 25.372118 30.40812  27.559711 24.171463 29.014626 24.407904
 28.158106 23.584396 25.083923 29.462566 23.722153 24.373245 32.719315
 31.77525  24.181849 24.348913 29.5849   27.328463 27.219595 29.013634
 21.033792 28.889277 32.799625 31.504549 25.991735 24.166111 25.179525
 32.989483 28.579327 24.487602 25.314348 27.362051 30.17405  71.15896
 24.616474 27.88653  26.337194 24.905489 28.587427 25.700998 33.149086
 27.703182 23.75356  31.716558 28.941504 30.286974 21.3555   31.921942
 26.846136 32.374275 26.554344 21.76209  26.47817  28.255314 21.668913
 25.915483 29.945538 32.31588  24.80483  23.655252 19.072649 21.189825
 29.200048 25.499792 24.541346 32.89214  28.152277 27.93696  31.960068
 22.670858 30.131926 27.537752 32.92275  30.894804 24.525253 78.371414
 33.088978 24.639368 29.608938 26.833475 28.946264 28.40954  30.025846
 24.682419 23.796778 28.698946 28.071539 29.272474 28.344479 22.741182
 24.524202 27.8011   23.229507 29.25309  31.324633 27.459631 25.47606
 22.719427 30.073534 30.9184   27.44819  31.412836 24.449657 29.93279
 24.251144 30.327787 25.260353 30.140766 27.659575 29.221699 27.555588
 26.451313 26.336065 25.084595 28.624952 25.754442 31.948584 27.242775
 27.312181 30.333622 24.26061  30.19704  27.297358 27.71968  28.017328
 27.454035 32.380566 26.947811 27.817448 24.643753 19.117188 31.854914
 27.586294 24.056927 26.169718 29.965717 28.008774 33.025192 25.60696
 28.026312 30.36183  26.803877 31.619337 28.289291 28.490881 23.425476
 26.027994 32.433777 26.620993 27.007982 23.924393 28.338064 24.350021
 28.260443 31.666851 30.278908 28.843908 31.511591 24.565645 67.26814
 26.057474 31.856339 28.847357 27.231417 31.262743 26.567938 26.291235
 28.5942   31.348173 25.960949 25.901941 32.97898  29.995586 26.46784
 28.409061 24.083878 10.134163 32.047432 27.669611 32.095215 32.62362
 27.66332  24.799835 26.692255 26.98476  31.84464  33.5343   28.298536
 24.42831  26.048517 30.142555 24.935476 28.130621 30.192408 28.4649
 27.364233 25.96349  27.501596 28.130518 22.71999  30.236727 27.21699
 31.524025 23.95951  25.946823 29.085445 24.617006 25.09112  28.49146
 28.291546 28.239893 28.97475  23.7949   22.994017 24.937828 24.375738
 23.99856  28.365353 23.38373  31.820044 29.843956 27.653378 32.36828
 31.560059 28.834736 24.454226 28.994461 30.538977 25.386387 28.676266
 27.385456 28.159725 29.6039   26.19871  30.663202 28.64718  28.267492
 27.783756 33.05293  26.240284 25.75195  27.6814   27.184566 27.644451
 25.206373 33.853783]
2025-06-06 15:42:00,079 - DEBUG - Edge reconstruction errors: [0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8]
2025-06-06 15:42:00,080 - ERROR - An error occurred while processing file nw_graph_encoded_1749044588.dot: name 'os' is not defined
2025-06-06 15:42:00,081 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow.py", line 429, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 9, in save_anomalies_to_file
    filename = os.path.join(anomaly_log_path, f"anomalies_{timestamp}_update_{processed_files_count}.json")
               ^^
NameError: name 'os' is not defined. Did you forget to import 'os'

2025-06-06 15:42:00,081 - INFO - 
--- Processing file: nw_graph_encoded_1749044648.dot ---
2025-06-06 15:42:00,081 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044648.dot
2025-06-06 15:42:00,081 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044648.dot file.
2025-06-06 15:42:00,088 - INFO - Parsed 512 nodes.
2025-06-06 15:42:00,100 - INFO - Parsed 1046 edges.
2025-06-06 15:42:00,267 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:42:00,267 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:42:00,271 - DEBUG - Initial node features tensor shape: torch.Size([512, 19])
2025-06-06 15:42:00,272 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:42:00,273 - DEBUG - Node features tensor shape after scaling: torch.Size([512, 19])
2025-06-06 15:42:00,274 - DEBUG - Edge index tensor shape: torch.Size([2, 1046])
2025-06-06 15:42:00,274 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:42:00,279 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:42:00,280 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:42:00,282 - DEBUG - Shape of encoded categorical edge features: torch.Size([1046, 2])
2025-06-06 15:42:00,283 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:42:00,283 - DEBUG - Shape of scaled numerical edge features: torch.Size([1046, 20])
2025-06-06 15:42:00,283 - DEBUG - Final edge attributes tensor shape: torch.Size([1046, 22])
2025-06-06 15:42:00,283 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:42:00,283 - INFO - Performing online update...
2025-06-06 15:42:00,283 - INFO - Starting online update for 50 steps.
2025-06-06 15:42:00,284 - DEBUG - Updated RunningStats: new_mean=[-7.21167827e-10 -2.87773223e-09 -6.83201190e-09 -2.75580283e-10
  5.86847221e-09 -4.40928453e-09 -3.70493775e-09  2.77562875e-11
  1.88742755e-09  5.77330780e-09  1.16298845e-08 -3.64796921e-10
  1.03094782e-09  4.11189573e-09 -5.13293059e-09 -6.30935110e-09
 -4.30098544e-09  9.93154661e-10  3.12456493e-09], new_M2=[1878.99998654 1878.99998401 1879.00000702 1878.999997   1879.00000057
 1878.99996356 1878.99996001 1879.0000074  1879.00003607 1879.00006604
 1878.99998168 1878.99999394 1879.00000977 1879.00000371 1878.9999767
 1878.99999499 1879.00000776 1878.99998435 1878.9999797 ], new_n=1879
2025-06-06 15:42:00,284 - DEBUG - Updated RunningStats: new_mean=[ 1.34550810e+00  4.60412371e+00  1.61026908e-10  8.94246266e-11
  8.90431479e-11  3.79449226e-10  1.25868709e-09 -1.74045192e-09
  1.30992955e-09 -2.00590972e-09  4.95879550e-10 -2.90452799e-09
  8.69754471e-10 -8.73714993e-09 -1.94658763e-09  4.58918971e-10
  4.58918971e-10  4.58918971e-10  4.58918971e-10  4.58918971e-10
  4.58918971e-10 -1.50714122e-10], new_M2=[  915.71899853 14097.94226804  3394.99998574  3395.00006329
  3394.99999446  3395.00004036  3394.99997285  3394.99997966
  3394.99998371  3395.00002416  3394.9999554   3395.0000596
  3394.99999797  3395.00004882  3394.9999472   3395.00001719
  3395.00001719  3395.00001719  3395.00001719  3395.00001719
  3395.00001719  3394.99997058], new_n=3395
2025-06-06 15:42:00,285 - DEBUG - Calculated standard deviation: [1.         1.         1.         1.         1.         0.99999999
 0.99999999 1.         1.00000001 1.00000002 1.         1.
 1.         1.         0.99999999 1.         1.         1.
 0.99999999]
2025-06-06 15:42:00,285 - DEBUG - Calculated standard deviation: [0.5193513  2.03778319 1.         1.00000001 1.         1.00000001
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.00000001 0.99999999 1.         1.         1.
 1.         1.         1.         1.        ]
2025-06-06 15:42:00,285 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:42:00,285 - DEBUG - Online update step: 1/50
2025-06-06 15:42:00,285 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,285 - DEBUG - Online update step: 2/50
2025-06-06 15:42:00,285 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,285 - DEBUG - Online update step: 3/50
2025-06-06 15:42:00,285 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,285 - DEBUG - Online update step: 4/50
2025-06-06 15:42:00,285 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,285 - DEBUG - Online update step: 5/50
2025-06-06 15:42:00,285 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,285 - DEBUG - Online update step: 6/50
2025-06-06 15:42:00,285 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,285 - DEBUG - Online update step: 7/50
2025-06-06 15:42:00,285 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,285 - DEBUG - Online update step: 8/50
2025-06-06 15:42:00,285 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,285 - DEBUG - Online update step: 9/50
2025-06-06 15:42:00,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,286 - DEBUG - Online update step: 10/50
2025-06-06 15:42:00,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,286 - DEBUG - Online update step: 11/50
2025-06-06 15:42:00,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,286 - DEBUG - Online update step: 12/50
2025-06-06 15:42:00,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,286 - DEBUG - Online update step: 13/50
2025-06-06 15:42:00,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,286 - DEBUG - Online update step: 14/50
2025-06-06 15:42:00,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,286 - DEBUG - Online update step: 15/50
2025-06-06 15:42:00,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,286 - DEBUG - Online update step: 16/50
2025-06-06 15:42:00,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,286 - DEBUG - Online update step: 17/50
2025-06-06 15:42:00,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,286 - DEBUG - Online update step: 18/50
2025-06-06 15:42:00,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,286 - DEBUG - Online update step: 19/50
2025-06-06 15:42:00,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,286 - DEBUG - Online update step: 20/50
2025-06-06 15:42:00,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,286 - DEBUG - Online update step: 21/50
2025-06-06 15:42:00,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,286 - DEBUG - Online update step: 22/50
2025-06-06 15:42:00,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,286 - DEBUG - Online update step: 23/50
2025-06-06 15:42:00,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,286 - DEBUG - Online update step: 24/50
2025-06-06 15:42:00,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,286 - DEBUG - Online update step: 25/50
2025-06-06 15:42:00,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,286 - DEBUG - Online update step: 26/50
2025-06-06 15:42:00,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,286 - DEBUG - Online update step: 27/50
2025-06-06 15:42:00,287 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,287 - DEBUG - Online update step: 28/50
2025-06-06 15:42:00,287 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,287 - DEBUG - Online update step: 29/50
2025-06-06 15:42:00,287 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,287 - DEBUG - Online update step: 30/50
2025-06-06 15:42:00,287 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,287 - DEBUG - Online update step: 31/50
2025-06-06 15:42:00,287 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,287 - DEBUG - Online update step: 32/50
2025-06-06 15:42:00,287 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,287 - DEBUG - Online update step: 33/50
2025-06-06 15:42:00,287 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,287 - DEBUG - Online update step: 34/50
2025-06-06 15:42:00,287 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,287 - DEBUG - Online update step: 35/50
2025-06-06 15:42:00,287 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,287 - DEBUG - Online update step: 36/50
2025-06-06 15:42:00,287 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,287 - DEBUG - Online update step: 37/50
2025-06-06 15:42:00,287 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,287 - DEBUG - Online update step: 38/50
2025-06-06 15:42:00,287 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,287 - DEBUG - Online update step: 39/50
2025-06-06 15:42:00,287 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,287 - DEBUG - Online update step: 40/50
2025-06-06 15:42:00,287 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,287 - DEBUG - Online update step: 41/50
2025-06-06 15:42:00,287 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,287 - DEBUG - Online update step: 42/50
2025-06-06 15:42:00,287 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,287 - DEBUG - Online update step: 43/50
2025-06-06 15:42:00,287 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,287 - DEBUG - Online update step: 44/50
2025-06-06 15:42:00,287 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,287 - DEBUG - Online update step: 45/50
2025-06-06 15:42:00,287 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,287 - DEBUG - Online update step: 46/50
2025-06-06 15:42:00,288 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,288 - DEBUG - Online update step: 47/50
2025-06-06 15:42:00,288 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,288 - DEBUG - Online update step: 48/50
2025-06-06 15:42:00,288 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,288 - DEBUG - Online update step: 49/50
2025-06-06 15:42:00,288 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,288 - DEBUG - Online update step: 50/50
2025-06-06 15:42:00,288 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,288 - WARNING - No successful steps during online update.
2025-06-06 15:42:00,289 - DEBUG - Current node mean: [-1.4901161e-08  1.4901161e-08 -6.5192580e-09 -2.0256266e-08
  2.2817403e-08  1.5366822e-08 -1.1641532e-08 -7.6834112e-09
 -1.3969839e-08 -1.0710210e-08 -2.3283064e-10 -3.7252903e-08
  2.8871000e-08 -2.1420419e-08  2.7939677e-09 -1.8626451e-08
  1.8626451e-09  2.6077032e-08  2.9802322e-08], current edge mean: [ 1.40535378e+00  4.84894848e+00 -4.55867255e-09  4.55867261e-10
 -2.05140260e-09 -3.87487153e-09  5.47040724e-09 -1.59553544e-08
 -2.73520362e-09 -3.64693808e-09 -9.11734521e-10 -3.19107074e-09
  5.69834091e-09  5.35644018e-09 -1.09408145e-08 -4.55867255e-09
 -4.55867255e-09 -4.55867255e-09 -4.55867255e-09 -4.55867255e-09
 -4.55867255e-09  1.09408145e-08]
2025-06-06 15:42:00,289 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.1201
2025-06-06 15:42:00,289 - DEBUG - Updated reference mean: node=[-1.4901161e-08  1.4901161e-08 -6.5192580e-09 -2.0256266e-08
  2.2817403e-08  1.5366822e-08 -1.1641532e-08 -7.6834112e-09
 -1.3969839e-08 -1.0710210e-08 -2.3283064e-10 -3.7252903e-08
  2.8871000e-08 -2.1420419e-08  2.7939677e-09 -1.8626451e-08
  1.8626451e-09  2.6077032e-08  2.9802322e-08], edge=[ 1.40535378e+00  4.84894848e+00 -4.55867255e-09  4.55867261e-10
 -2.05140260e-09 -3.87487153e-09  5.47040724e-09 -1.59553544e-08
 -2.73520362e-09 -3.64693808e-09 -9.11734521e-10 -3.19107074e-09
  5.69834091e-09  5.35644018e-09 -1.09408145e-08 -4.55867255e-09
 -4.55867255e-09 -4.55867255e-09 -4.55867255e-09 -4.55867255e-09
 -4.55867255e-09  1.09408145e-08]
2025-06-06 15:42:00,289 - DEBUG - Updated reference std: node=[1.000978 1.000978 1.000978 1.000978 1.000978 1.000978 1.000978 1.000978
 1.000978 1.000978 1.000978 1.000978 1.000978 1.000978 1.000978 1.000978
 1.000978 1.000978 1.000978], edge=[0.50084144 1.9184657  1.0004784  1.0004784  1.0004784  1.0004784
 1.0004784  1.0004784  1.0004784  1.0004784  1.0004784  1.0004784
 1.0004784  1.0004784  1.0004784  1.0004784  1.0004784  1.0004784
 1.0004784  1.0004784  1.0004784  1.0004784 ]
2025-06-06 15:42:00,289 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:42:00,289 - INFO - Running anomaly detection...
2025-06-06 15:42:00,290 - INFO - Starting anomaly detection.
2025-06-06 15:42:00,320 - DEBUG - Node reconstruction errors: [37.325043 37.833977 28.165716 38.321224 37.597992 37.183685 39.601475
 37.371494 36.47346  35.78576  34.53767  37.60695  37.870277 37.96165
 29.88075  36.748352 37.393177 36.580257 37.462666 37.089268 37.579346
 37.502148 38.331818 35.002655 36.7247   35.537304 35.580048 38.69036
 36.78754  37.729584 35.347706 35.9383   37.242794 37.977283 32.16572
 38.688057 36.642376 35.90469  36.034813 34.49446  38.02823  38.145214
 38.825    38.99555  32.03578  32.051826 32.57267  32.070236 25.213362
 35.05108  35.061024 40.98677  35.599903 28.775892 36.828403 31.39616
 37.503162 37.28177  38.635002 37.652996 34.042564 30.6      36.77931
 37.1301   35.775738 39.31023  38.934685 41.037617 41.168606 37.06433
 39.77156  40.77269  34.921783 40.736416 38.491802 42.02648  35.75228
 33.674507 42.820972 23.697409 29.664824 37.264023 34.431377 38.889664
 37.052498 33.590958 29.519873 36.604393 26.020359 35.383236 33.84638
 38.723705 29.988102 35.941437 33.336475 39.71151  38.33259  27.73274
 32.94107  29.64884  28.787148 30.139118 38.35145  30.402594 33.230083
 30.76364  35.813564 36.19746  36.9057   39.609417 34.17756  32.070385
 32.276817 33.79836  36.987724 33.64824  33.14125  35.55264  37.946056
 35.982037 33.01488  32.792053 28.455393 32.675163 32.486607 33.09432
 31.696093 28.841463 33.966198 23.179947 32.770363 32.31139  32.756966
 36.78629  36.846226 33.339767 38.847633 30.572956 33.433685 32.09811
 32.550575 36.89018  32.550575 37.503872 38.845123 35.42793  32.95625
 37.1515   36.66527  38.949146 36.918365 36.435818 32.984264 28.154593
 33.05421  37.09852  40.53487  36.480423 32.152596 36.93667  33.133934
 36.819935 38.218006 27.564087 40.548885 28.656498 34.89452  32.92404
 33.672813 33.76212  28.982882 40.285404 33.95306  34.43857  34.59109
 39.41244  37.493298 34.55869  23.048183 37.343826 35.863567 35.265636
 33.062042 29.762114 39.98327  34.736176 33.670174 32.04916  35.471325
 44.760857 40.384106 39.93095  36.571247 39.69865  30.810598 39.03431
 49.45616  21.412756 29.791471 37.86547  33.68136  35.540344 33.246334
 35.793804 35.348267 39.90208  40.582104 40.597942 39.218483 31.515554
 34.23204  38.430218 29.482862 39.08634  33.038357 38.437695 33.407238
 34.99336  33.160717 32.335293 41.364346 28.816505 36.410057 40.10381
 37.807587 37.84422  33.249622 34.745296 35.899303 32.08198  37.964596
 26.511028 35.817608 30.78154  33.858654 37.2185   37.614227 32.010193
 33.01     36.736393 35.041363 39.54245  28.117731 33.012928 26.730162
 33.727245 33.267    28.159998 33.57871  31.493422 35.894135 32.001698
 36.95954  32.78764  29.559134 31.55581  28.276043 35.857975 40.132103
 33.0676   31.866943 27.439903 40.04663  39.98621  27.294237 34.67757
 37.945976 35.727776 39.04585  35.93994  29.631084 35.976826 24.109251
 31.839718 40.609253 38.157467 33.80574  34.803665 27.863869 40.1574
 30.658756 32.933643 28.308205 29.791265 32.949066 80.43068  32.653484
 38.786    37.91942  33.287365 35.44461  28.215506 40.319412 36.46376
 31.497623 39.775154 38.40379  39.551285 24.509531 40.29834  28.69627
 40.848957 28.924688 29.663458 35.210606 36.98137  36.85711  24.786724
 33.84642  32.128666 35.12733  27.961271 31.886404 21.313011 24.341528
 36.23097  37.667854 32.215786 27.718622 39.97003  36.612446 38.0959
 36.4398   36.003223 40.43351  25.88429  32.246544 30.045452 40.60194
 40.463497 32.823296 97.5095   41.11539  32.661346 32.424515 29.215265
 35.289074 37.814236 36.475903 36.90845  26.717594 26.753517 30.623976
 36.735775 35.94504  37.648357 25.71084  34.183453 34.67866  25.589697
 32.405895 39.55188  36.115555 30.652048 30.373056 42.869102 36.105297
 33.187256 38.34659  32.42929  32.065136 26.917547 40.156128 28.400795
 36.217014 36.722    36.198742 33.558765 33.4387   38.79849  28.057205
 35.387566 28.236322 35.982037 39.209743 34.00511  37.072437 33.4685
 32.159904 28.79417  36.935944 34.005215 30.02285  35.004223 36.119335
 40.09651  35.41923  36.562786 32.685253 21.433073 40.16575  36.29281
 32.16263  28.462091 32.564148 30.725721 40.205574 27.912771 33.07939
 37.505157 35.96945  34.373833 39.647614 35.7675   30.526148 31.034536
 32.37233  39.44796  29.263123 34.102367 26.928068 36.700962 37.74001
 34.961052 34.179657 34.817474 38.672283 32.51112  36.5649   40.454132
 32.570877 88.83494  34.16289  39.83479  35.236084 37.28701  38.150143
 29.186106 28.905582 35.675953 39.597088 38.76342  37.965973 32.86324
 40.09834  36.83758  29.304514 37.121494 27.243597 13.028827 40.599518
 36.030228 39.189102 39.708916 37.56496  27.961664 33.434402 34.18326
 35.493824 40.32182  46.091873 34.840755 33.39967  28.280077 36.82492
 27.188097 36.722126 32.66182  38.719803 36.39222  29.804245 31.696093
 33.859283 37.47722  30.521006 36.006214 38.127987 29.627916 39.801044
 33.56668  35.71726  35.720524 34.194927 28.313318 37.897346 38.28842
 36.481735 35.42563  31.54441  35.558846 33.128906 37.154026 31.970018
 34.91608  30.972132 34.118908 38.7948   33.565784 39.432938 41.33209
 31.1836   37.467937 35.669384 38.8195   27.90208  35.26543  33.645622
 38.112534 40.850403 37.99175  38.103493 37.458942 35.03811  35.37925
 40.13137  34.68081  34.100758 36.353634 35.79009  36.318813 34.226997
 40.95305 ]
2025-06-06 15:42:00,320 - DEBUG - Edge reconstruction errors: [0.8 0.8 0.8 ... 0.8 0.8 0.8]
2025-06-06 15:42:00,321 - ERROR - An error occurred while processing file nw_graph_encoded_1749044648.dot: name 'os' is not defined
2025-06-06 15:42:00,322 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow.py", line 429, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 9, in save_anomalies_to_file
    filename = os.path.join(anomaly_log_path, f"anomalies_{timestamp}_update_{processed_files_count}.json")
               ^^
NameError: name 'os' is not defined. Did you forget to import 'os'

2025-06-06 15:42:00,322 - INFO - 
--- Processing file: nw_graph_encoded_1749044708.dot ---
2025-06-06 15:42:00,322 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044708.dot
2025-06-06 15:42:00,322 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044708.dot file.
2025-06-06 15:42:00,330 - INFO - Parsed 640 nodes.
2025-06-06 15:42:00,343 - INFO - Parsed 1302 edges.
2025-06-06 15:42:00,605 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:42:00,605 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:42:00,609 - DEBUG - Initial node features tensor shape: torch.Size([640, 19])
2025-06-06 15:42:00,610 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:42:00,610 - DEBUG - Node features tensor shape after scaling: torch.Size([640, 19])
2025-06-06 15:42:00,611 - DEBUG - Edge index tensor shape: torch.Size([2, 1302])
2025-06-06 15:42:00,611 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:42:00,618 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:42:00,619 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:42:00,620 - DEBUG - Shape of encoded categorical edge features: torch.Size([1302, 2])
2025-06-06 15:42:00,622 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:42:00,622 - DEBUG - Shape of scaled numerical edge features: torch.Size([1302, 20])
2025-06-06 15:42:00,622 - DEBUG - Final edge attributes tensor shape: torch.Size([1302, 22])
2025-06-06 15:42:00,622 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:42:00,622 - INFO - Performing online update...
2025-06-06 15:42:00,622 - INFO - Starting online update for 50 steps.
2025-06-06 15:42:00,623 - DEBUG - Updated RunningStats: new_mean=[-6.44420503e-10 -2.04011035e-09 -6.42128244e-09  1.38274967e-09
 -2.93409129e-09  1.36648203e-09 -3.81658782e-09  6.74367755e-10
  2.56732988e-09  4.15860116e-09  5.65818209e-09  1.50253868e-09
 -1.45521463e-09  2.80690789e-09  2.29965320e-09 -6.77676742e-09
  1.51769717e-10 -1.00471183e-09  3.95155843e-09], new_M2=[2518.99992428 2518.99992175 2518.99999908 2519.00001744 2518.99994028
 2518.99994169 2518.99996106 2519.00003845 2518.99998813 2519.00001677
 2518.99995669 2519.00005278 2518.99999083 2519.00001757 2518.99996309
 2519.00000894 2519.0000176  2519.00000646 2518.99997711], new_n=2519
2025-06-06 15:42:00,623 - DEBUG - Updated RunningStats: new_mean=[ 1.36299766e+00  4.69853098e+00  4.70692650e-10 -2.86826397e-10
  2.07927877e-10  4.51281318e-10  1.05289009e-09 -1.23916513e-09
 -1.47093002e-10 -1.30810472e-09  2.03169150e-10  2.34783240e-10
  3.13592689e-10 -9.16887769e-09 -1.87154298e-09  4.89042872e-10
  4.89042872e-10  4.89042872e-10  4.89042872e-10  4.89042872e-10
  4.89042872e-10 -4.72257205e-10], new_M2=[ 1246.08899297 18561.11986374  4697.00003621  4696.99997324
  4697.00007506  4697.00010614  4696.99999277  4696.99996495
  4696.99999679  4697.00001863  4696.99991651  4697.00000249
  4696.9999947   4697.00007798  4696.99996485  4697.00005069
  4697.00005069  4697.00005069  4697.00005069  4697.00005069
  4697.00005069  4696.99991041], new_n=4697
2025-06-06 15:42:00,623 - DEBUG - Calculated standard deviation: [0.99999998 0.99999998 1.         1.         0.99999999 0.99999999
 0.99999999 1.00000001 1.         1.         0.99999999 1.00000001
 1.         1.         0.99999999 1.         1.         1.
 1.        ]
2025-06-06 15:42:00,623 - DEBUG - Calculated standard deviation: [0.51506762 1.98788752 1.         1.         1.00000001 1.00000001
 1.         1.         1.         1.         0.99999999 1.
 1.         1.00000001 1.         1.00000001 1.00000001 1.00000001
 1.00000001 1.00000001 1.00000001 0.99999999]
2025-06-06 15:42:00,624 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:42:00,624 - DEBUG - Online update step: 1/50
2025-06-06 15:42:00,624 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,624 - DEBUG - Online update step: 2/50
2025-06-06 15:42:00,624 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,624 - DEBUG - Online update step: 3/50
2025-06-06 15:42:00,624 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,624 - DEBUG - Online update step: 4/50
2025-06-06 15:42:00,624 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,624 - DEBUG - Online update step: 5/50
2025-06-06 15:42:00,624 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,624 - DEBUG - Online update step: 6/50
2025-06-06 15:42:00,624 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,624 - DEBUG - Online update step: 7/50
2025-06-06 15:42:00,624 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,624 - DEBUG - Online update step: 8/50
2025-06-06 15:42:00,624 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,624 - DEBUG - Online update step: 9/50
2025-06-06 15:42:00,624 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,624 - DEBUG - Online update step: 10/50
2025-06-06 15:42:00,624 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,624 - DEBUG - Online update step: 11/50
2025-06-06 15:42:00,624 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,624 - DEBUG - Online update step: 12/50
2025-06-06 15:42:00,624 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,624 - DEBUG - Online update step: 13/50
2025-06-06 15:42:00,624 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,624 - DEBUG - Online update step: 14/50
2025-06-06 15:42:00,624 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,624 - DEBUG - Online update step: 15/50
2025-06-06 15:42:00,624 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,624 - DEBUG - Online update step: 16/50
2025-06-06 15:42:00,624 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,624 - DEBUG - Online update step: 17/50
2025-06-06 15:42:00,624 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,625 - DEBUG - Online update step: 18/50
2025-06-06 15:42:00,625 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,625 - DEBUG - Online update step: 19/50
2025-06-06 15:42:00,625 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,625 - DEBUG - Online update step: 20/50
2025-06-06 15:42:00,625 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,625 - DEBUG - Online update step: 21/50
2025-06-06 15:42:00,625 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,625 - DEBUG - Online update step: 22/50
2025-06-06 15:42:00,625 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,625 - DEBUG - Online update step: 23/50
2025-06-06 15:42:00,625 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,625 - DEBUG - Online update step: 24/50
2025-06-06 15:42:00,625 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,625 - DEBUG - Online update step: 25/50
2025-06-06 15:42:00,625 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,625 - DEBUG - Online update step: 26/50
2025-06-06 15:42:00,625 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,625 - DEBUG - Online update step: 27/50
2025-06-06 15:42:00,625 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,625 - DEBUG - Online update step: 28/50
2025-06-06 15:42:00,625 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,625 - DEBUG - Online update step: 29/50
2025-06-06 15:42:00,625 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,625 - DEBUG - Online update step: 30/50
2025-06-06 15:42:00,625 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,625 - DEBUG - Online update step: 31/50
2025-06-06 15:42:00,625 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,625 - DEBUG - Online update step: 32/50
2025-06-06 15:42:00,625 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,625 - DEBUG - Online update step: 33/50
2025-06-06 15:42:00,625 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,625 - DEBUG - Online update step: 34/50
2025-06-06 15:42:00,625 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,625 - DEBUG - Online update step: 35/50
2025-06-06 15:42:00,625 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,625 - DEBUG - Online update step: 36/50
2025-06-06 15:42:00,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,626 - DEBUG - Online update step: 37/50
2025-06-06 15:42:00,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,626 - DEBUG - Online update step: 38/50
2025-06-06 15:42:00,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,626 - DEBUG - Online update step: 39/50
2025-06-06 15:42:00,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,626 - DEBUG - Online update step: 40/50
2025-06-06 15:42:00,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,626 - DEBUG - Online update step: 41/50
2025-06-06 15:42:00,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,626 - DEBUG - Online update step: 42/50
2025-06-06 15:42:00,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,626 - DEBUG - Online update step: 43/50
2025-06-06 15:42:00,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,626 - DEBUG - Online update step: 44/50
2025-06-06 15:42:00,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,626 - DEBUG - Online update step: 45/50
2025-06-06 15:42:00,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,626 - DEBUG - Online update step: 46/50
2025-06-06 15:42:00,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,626 - DEBUG - Online update step: 47/50
2025-06-06 15:42:00,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,626 - DEBUG - Online update step: 48/50
2025-06-06 15:42:00,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,626 - DEBUG - Online update step: 49/50
2025-06-06 15:42:00,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,626 - DEBUG - Online update step: 50/50
2025-06-06 15:42:00,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:00,626 - WARNING - No successful steps during online update.
2025-06-06 15:42:00,627 - DEBUG - Current node mean: [-3.1292437e-08  3.1292437e-08  5.9604646e-09  1.0430813e-08
 -8.9406971e-09  3.8743018e-08 -3.3527613e-08  1.3411045e-08
  1.1920929e-08 -5.9604646e-09 -1.5646219e-08 -3.7252903e-09
 -4.4703485e-09 -5.9604646e-09  4.4703484e-08 -1.1920929e-08
 -5.9604646e-09 -5.9604646e-09  2.9802322e-08], current edge mean: [ 1.4086021e+00  4.9447002e+00  1.4649375e-09  5.4935156e-10
 -1.4649375e-09 -5.4935159e-09  2.1974063e-09 -7.3246875e-09
 -2.5636406e-09  1.4649375e-09  1.4649375e-09  5.8597500e-09
 -1.4649375e-09 -4.3948125e-09 -1.2451969e-08  1.4649375e-09
  1.4649375e-09  1.4649375e-09  1.4649375e-09  1.4649375e-09
  1.4649375e-09  0.0000000e+00]
2025-06-06 15:42:00,627 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.1238
2025-06-06 15:42:00,627 - DEBUG - Updated reference mean: node=[-3.1292437e-08  3.1292437e-08  5.9604646e-09  1.0430813e-08
 -8.9406971e-09  3.8743018e-08 -3.3527613e-08  1.3411045e-08
  1.1920929e-08 -5.9604646e-09 -1.5646219e-08 -3.7252903e-09
 -4.4703485e-09 -5.9604646e-09  4.4703484e-08 -1.1920929e-08
 -5.9604646e-09 -5.9604646e-09  2.9802322e-08], edge=[ 1.4086021e+00  4.9447002e+00  1.4649375e-09  5.4935156e-10
 -1.4649375e-09 -5.4935159e-09  2.1974063e-09 -7.3246875e-09
 -2.5636406e-09  1.4649375e-09  1.4649375e-09  5.8597500e-09
 -1.4649375e-09 -4.3948125e-09 -1.2451969e-08  1.4649375e-09
  1.4649375e-09  1.4649375e-09  1.4649375e-09  1.4649375e-09
  1.4649375e-09  0.0000000e+00]
2025-06-06 15:42:00,628 - DEBUG - Updated reference std: node=[1.0007821 1.0007821 1.0007821 1.0007821 1.0007821 1.0007821 1.0007821
 1.0007821 1.0007821 1.0007821 1.0007821 1.0007823 1.0007821 1.0007821
 1.0007821 1.0007821 1.0007821 1.0007821 1.0007821], edge=[0.5010547 1.8293908 1.0003842 1.0003842 1.0003843 1.0003843 1.0003842
 1.0003842 1.0003842 1.0003842 1.0003842 1.0003842 1.0003842 1.0003842
 1.0003842 1.0003842 1.0003842 1.0003842 1.0003842 1.0003842 1.0003842
 1.0003842]
2025-06-06 15:42:00,628 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:42:00,628 - INFO - Running anomaly detection...
2025-06-06 15:42:00,628 - INFO - Starting anomaly detection.
2025-06-06 15:42:00,644 - DEBUG - Node reconstruction errors: [ 38.945705  46.571354  40.956852  41.122997  39.278194  40.941357
  41.110706  40.251175  39.39363   40.27746   37.26558   42.221645
  37.774403  39.76719   38.669434  39.94692   39.716217  40.028603
  39.906025  39.734406  38.99671   39.794113  39.224316  39.42443
  38.554634  39.804848  45.165314  40.5367    39.297752  41.323875
  46.470142  40.635326  45.297943  41.323875  40.635326  38.19067
  38.982727  37.541378  39.86348   37.084522  40.055763  39.403328
  40.271065  39.546104  40.078346  35.891125  39.761723  39.783676
  40.0558    37.9282    39.831104  39.41718   38.633373  38.54871
  38.435856  38.88982   40.116203  38.29169   39.55722   39.963497
  39.983986  46.783466  39.057648  37.505875  48.156364  43.35538
  42.86925   40.969757  46.14376   44.42273   46.580574  42.135983
  48.679363  47.898987  45.67794   40.6001    42.129284  35.895107
  46.03149   44.633183  46.130764  37.79243   41.994705  42.074932
  38.482243  40.70607   43.210762  44.762432  36.667416  41.176125
  40.47296   42.86105   38.155743  45.200985  42.82824   44.255436
  45.02161   38.159218  43.36634   45.48221   40.724277  38.60794
  36.4135    40.476215  41.911003  54.559967  47.34385   42.4074
  40.38138   36.396355  42.50081   44.411854  47.442036  43.008812
  16.574152  35.604385  47.350883  40.299927  44.895184  45.713837
  46.88491   37.38      41.131733  45.060352  44.441193  48.458134
 108.63687   39.70303   44.078835  42.84278   40.538433  48.37455
  45.901527  39.758263  41.136852  44.315292  43.830288  35.368656
  41.7039    45.17104   46.625217  47.33432   37.7493    44.461754
  42.366547  46.669567  41.418694  41.57893   47.421658  35.770164
  39.344765  40.52992   36.28415   47.55785   39.656364  40.70951
  36.05909   38.982506  43.378082  41.229748  43.674877  42.307957
  47.93345   42.475433  38.38769   44.849884  34.086407  39.211723
  42.06133   42.565346  43.87613   41.321987  42.221645  42.338547
  43.6402    36.57642   42.232166  36.449673  44.03628   45.937347
  38.930416  36.90843   36.50389   46.596615  41.76793   51.126743
  45.21891   37.1597    46.851566  32.96282   39.33714   41.864784
  39.262978  41.17229   33.958794  49.325912  43.052067  39.008724
  35.114246  34.546555  47.25407   43.328396  44.734093  37.531006
  41.60086   39.799812 119.08487   40.14828   47.668285  48.404556
  38.48119   40.246696  33.97333   38.84293   47.59423   42.783936
  42.69679   43.301678  42.99932   47.206627  39.007156  47.07589
  44.51618   43.01396   32.15643   27.389175  39.268116  36.378906
  40.121094  40.700962  46.73703   32.682827  42.366997  42.518887
  36.886017  37.211086  27.466566  48.005707  37.27957   48.139206
  45.007446  47.199104  45.20462   47.680027  36.54787   40.588074
  44.749626  47.94347   42.268017  41.13654   43.573708  40.62683
 102.00254   37.88787   36.81071   40.326694  39.84093   32.22127
  47.497807  35.61273   41.754578  40.291214  45.61323   45.6109
  39.85918   43.352886  42.975536  47.803356  45.899487  42.44032
  44.016193  41.638687  35.76103   46.707737  29.852694  35.726402
  39.546467  39.2285    42.07901   47.217167  49.847553  36.59665
  38.840015  41.794926  45.13091   40.13518   44.098003  38.984287
  40.681366  47.52505   39.643345  42.52505   35.243843  40.312305
  45.6472    35.05527   41.44184   41.07985   36.570724  45.74125
  41.883766  47.499317  45.083652  42.30382   41.578587  43.829853
  38.45258   41.081837  39.375954  45.204723  44.414604  41.807247
  39.445633  38.65973   45.264053  34.80375   40.057804  43.02735
  42.08673   48.742496  44.659233  49.26991   47.206448  43.623745
  40.95985   38.67581   38.730095  37.15133   48.604218  40.346436
  37.834183  46.44668   40.813488  44.75112   45.470863  40.97314
  48.063168  40.41751   45.107937  41.63634   37.83853   47.637142
  44.62547   48.38751   47.323803  42.103565  43.02268   40.016434
  40.387283  45.016712  38.155563  27.826176  47.61813   60.21412
  46.505463  37.686077  44.284107  47.02373   43.65205   47.31476
  56.27241   42.33767   40.964172  42.431324  37.30429   43.18838
  44.927258  47.271576  40.09332   38.12359   41.886696  43.079712
  44.541027  30.809181  34.911827  38.98398   41.698635  41.85577
  42.465405  49.481754  46.268932  41.46986   43.302837  40.69169
  47.578156  49.606827  37.448242  41.93466   41.006824  40.998962
  43.371582  43.220062  37.98276   37.099995  42.771984  47.617764
  40.980114  43.586468  35.24538   45.210773  43.807636  45.19396
  48.86447   44.06604   48.046154  47.5285    43.347736  41.153152
  36.284225  41.047035  45.55784   48.488937  45.851547  37.66661
  44.111046  48.7635    42.281765  40.287136  41.005188  42.443436
  45.69678   43.435993  46.080627  40.063774  41.536266  39.00408
  45.566216  43.775986  43.724293  41.81627   39.407074  39.394726
  40.837452  42.16627   28.789297  41.590965  43.12607   43.66838
  37.793026  39.903866  37.945786  40.484646  37.76415   46.726704
  40.730732  36.08085   36.63919   40.847073  41.10428   42.221645
  44.758724  49.06587   37.731144  42.999195  40.701782  43.761013
  41.225166  40.153187  44.188305  41.84099   47.348465  39.23081
  40.049816  41.43872   49.664867  31.968206  44.054146  42.976257
  41.15774   42.341442  38.838127  40.188602  39.458763  38.831394
  45.819904  43.757645  38.556988  37.0963    37.959915  39.239376
  43.647396  41.006393  44.840843  35.53657   45.228638  42.261265
  40.436726  41.886475  46.001827  41.42826   39.28447   42.712936
  38.398266  38.758053  48.98125   41.897266  41.653496  46.22616
  37.76565   41.61927   44.20006   45.049183  46.434036  41.624252
  44.29778   38.046703  30.683401  48.292538  49.975132  41.70029
  39.227425  43.356556  40.037548  49.429333  42.79273   47.205276
  41.49534   43.15722   48.005196  46.082497  48.294342  42.888657
  34.429256  41.7683    48.727898  45.669678  48.76247   42.881527
  33.871532  44.087574  38.577946  39.548153  45.356743  50.048283
  48.892445  45.376984  48.92181   46.3062    44.771835  39.440636
  49.461987  49.05811   37.00204   39.96924   38.91018   47.85297
  45.296     48.041084  44.78788   41.969296  41.78278   39.560413
  43.06894   32.473053  38.655273  40.60323   40.023457  46.638622
  40.008717  45.738007  43.387463  45.532307  44.09121   44.985016
  49.383537  45.225006  40.11646   45.95842   44.03221   42.649574
  49.25634   49.9581    38.52133   44.795803  44.610817  48.259922
  42.254868  44.805656  39.53889   49.080215  45.38239   39.24834
  42.267365  41.51625   38.851524  43.624496  38.771133  36.39259
  41.88177   46.459587  43.717945  44.551174  48.98041   47.823418
  49.034836  40.98514   44.50821   43.28225   45.096798  45.276363
  43.658245  37.961533  36.674095  37.866177  44.801994  40.055634
  44.9257    44.66078   40.886448  43.40876   48.38659   43.33356
  48.492725  44.205395  46.139496  46.53268   39.58462   43.8732
  44.34958   45.225952  30.011536  44.023636  42.38304   49.61323
  38.219444  43.741833  48.890907  47.271145  35.753258  41.610043
  39.235687  43.318523  41.423904  48.588192  39.373524  37.873547
  48.161922  38.982475  36.694298  37.31652 ]
2025-06-06 15:42:00,644 - DEBUG - Edge reconstruction errors: [0.8 0.8 0.8 ... 0.8 0.8 0.8]
2025-06-06 15:42:00,645 - ERROR - An error occurred while processing file nw_graph_encoded_1749044708.dot: name 'os' is not defined
2025-06-06 15:42:00,646 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow.py", line 429, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 9, in save_anomalies_to_file
    filename = os.path.join(anomaly_log_path, f"anomalies_{timestamp}_update_{processed_files_count}.json")
               ^^
NameError: name 'os' is not defined. Did you forget to import 'os'

2025-06-06 15:42:00,646 - INFO - 
--- Processing file: nw_graph_encoded_1749044768.dot ---
2025-06-06 15:42:00,646 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044768.dot
2025-06-06 15:42:00,646 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044768.dot file.
2025-06-06 15:42:00,655 - INFO - Parsed 693 nodes.
2025-06-06 15:42:00,670 - INFO - Parsed 1448 edges.
2025-06-06 15:42:00,981 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:42:00,981 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:42:00,985 - DEBUG - Initial node features tensor shape: torch.Size([693, 19])
2025-06-06 15:42:00,986 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:42:00,986 - DEBUG - Node features tensor shape after scaling: torch.Size([693, 19])
2025-06-06 15:42:00,988 - DEBUG - Edge index tensor shape: torch.Size([2, 1448])
2025-06-06 15:42:00,988 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:42:00,995 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:42:00,996 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:42:00,997 - DEBUG - Shape of encoded categorical edge features: torch.Size([1448, 2])
2025-06-06 15:42:00,998 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:42:00,998 - DEBUG - Shape of scaled numerical edge features: torch.Size([1448, 20])
2025-06-06 15:42:00,998 - DEBUG - Final edge attributes tensor shape: torch.Size([1448, 22])
2025-06-06 15:42:00,999 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:42:00,999 - INFO - Performing online update...
2025-06-06 15:42:00,999 - INFO - Starting online update for 50 steps.
2025-06-06 15:42:00,999 - DEBUG - Updated RunningStats: new_mean=[-1.38683558e-09 -7.18498549e-10 -1.19111866e-08  2.12244123e-10
 -5.75262761e-10  3.32863735e-09 -4.00449498e-09 -7.05160804e-10
  2.12592065e-09  2.95518047e-09  8.23692768e-09  1.56805495e-09
 -8.11862767e-10  1.70491181e-09 -1.06817944e-09 -6.48373903e-09
 -3.03564187e-09 -7.10524897e-10  3.78560010e-09], new_M2=[3211.99991034 3211.99990781 3212.00003317 3212.00000573 3211.99991743
 3211.99994826 3211.99994311 3212.00002054 3212.00003659 3212.00002307
 3211.99995267 3212.00004821 3211.9999918  3212.00002838 3211.99996378
 3212.00002739 3211.99999766 3212.00001033 3211.99994824], new_n=3212
2025-06-06 15:42:01,000 - DEBUG - Updated RunningStats: new_mean=[ 1.37624085e+00  4.76403580e+00  4.84899653e-10 -1.55783640e-10
  2.27497704e-10  2.65771965e-10  1.65453974e-09 -7.67460194e-10
  7.70467669e-10 -3.35454207e-10 -2.82560541e-10 -1.31688972e-09
 -1.38107029e-11 -7.86312088e-09 -1.14833437e-09  3.29024842e-10
  3.29024842e-10  3.29024842e-10  3.29024842e-10  3.29024842e-10
  3.29024842e-10 -3.93578985e-10], new_M2=[ 1620.13116355 23245.85191212  6145.00005731  6145.00001993
  6145.00010458  6145.00007508  6144.99999103  6145.00000529
  6144.9999947   6145.00000106  6144.99993232  6145.00006579
  6144.99998454  6145.00008303  6144.99999139  6145.00000315
  6145.00000315  6145.00000315  6145.00000315  6145.00000315
  6145.00000315  6144.99989019], new_n=6145
2025-06-06 15:42:01,000 - DEBUG - Calculated standard deviation: [0.99999999 0.99999999 1.00000001 1.         0.99999999 0.99999999
 0.99999999 1.         1.00000001 1.         0.99999999 1.00000001
 1.         1.         0.99999999 1.         1.         1.
 0.99999999]
2025-06-06 15:42:01,000 - DEBUG - Calculated standard deviation: [0.5134689  1.944965   1.         1.         1.00000001 1.00000001
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.00000001 1.         1.         1.         1.
 1.         1.         1.         0.99999999]
2025-06-06 15:42:01,000 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:42:01,000 - DEBUG - Online update step: 1/50
2025-06-06 15:42:01,000 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,000 - DEBUG - Online update step: 2/50
2025-06-06 15:42:01,000 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,000 - DEBUG - Online update step: 3/50
2025-06-06 15:42:01,000 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,000 - DEBUG - Online update step: 4/50
2025-06-06 15:42:01,000 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,000 - DEBUG - Online update step: 5/50
2025-06-06 15:42:01,000 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,001 - DEBUG - Online update step: 6/50
2025-06-06 15:42:01,001 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,001 - DEBUG - Online update step: 7/50
2025-06-06 15:42:01,001 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,001 - DEBUG - Online update step: 8/50
2025-06-06 15:42:01,001 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,001 - DEBUG - Online update step: 9/50
2025-06-06 15:42:01,001 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,001 - DEBUG - Online update step: 10/50
2025-06-06 15:42:01,001 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,001 - DEBUG - Online update step: 11/50
2025-06-06 15:42:01,001 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,001 - DEBUG - Online update step: 12/50
2025-06-06 15:42:01,001 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,001 - DEBUG - Online update step: 13/50
2025-06-06 15:42:01,001 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,001 - DEBUG - Online update step: 14/50
2025-06-06 15:42:01,001 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,001 - DEBUG - Online update step: 15/50
2025-06-06 15:42:01,001 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,001 - DEBUG - Online update step: 16/50
2025-06-06 15:42:01,001 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,001 - DEBUG - Online update step: 17/50
2025-06-06 15:42:01,001 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,001 - DEBUG - Online update step: 18/50
2025-06-06 15:42:01,001 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,001 - DEBUG - Online update step: 19/50
2025-06-06 15:42:01,001 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,001 - DEBUG - Online update step: 20/50
2025-06-06 15:42:01,001 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,001 - DEBUG - Online update step: 21/50
2025-06-06 15:42:01,001 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,001 - DEBUG - Online update step: 22/50
2025-06-06 15:42:01,001 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,001 - DEBUG - Online update step: 23/50
2025-06-06 15:42:01,001 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,001 - DEBUG - Online update step: 24/50
2025-06-06 15:42:01,002 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,002 - DEBUG - Online update step: 25/50
2025-06-06 15:42:01,002 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,002 - DEBUG - Online update step: 26/50
2025-06-06 15:42:01,002 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,002 - DEBUG - Online update step: 27/50
2025-06-06 15:42:01,002 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,002 - DEBUG - Online update step: 28/50
2025-06-06 15:42:01,002 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,002 - DEBUG - Online update step: 29/50
2025-06-06 15:42:01,002 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,002 - DEBUG - Online update step: 30/50
2025-06-06 15:42:01,002 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,002 - DEBUG - Online update step: 31/50
2025-06-06 15:42:01,002 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,002 - DEBUG - Online update step: 32/50
2025-06-06 15:42:01,002 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,002 - DEBUG - Online update step: 33/50
2025-06-06 15:42:01,002 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,002 - DEBUG - Online update step: 34/50
2025-06-06 15:42:01,002 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,002 - DEBUG - Online update step: 35/50
2025-06-06 15:42:01,002 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,002 - DEBUG - Online update step: 36/50
2025-06-06 15:42:01,002 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,002 - DEBUG - Online update step: 37/50
2025-06-06 15:42:01,002 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,002 - DEBUG - Online update step: 38/50
2025-06-06 15:42:01,002 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,002 - DEBUG - Online update step: 39/50
2025-06-06 15:42:01,002 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,002 - DEBUG - Online update step: 40/50
2025-06-06 15:42:01,002 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,002 - DEBUG - Online update step: 41/50
2025-06-06 15:42:01,003 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,003 - DEBUG - Online update step: 42/50
2025-06-06 15:42:01,003 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,003 - DEBUG - Online update step: 43/50
2025-06-06 15:42:01,003 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,003 - DEBUG - Online update step: 44/50
2025-06-06 15:42:01,003 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,003 - DEBUG - Online update step: 45/50
2025-06-06 15:42:01,003 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,003 - DEBUG - Online update step: 46/50
2025-06-06 15:42:01,003 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,003 - DEBUG - Online update step: 47/50
2025-06-06 15:42:01,003 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,003 - DEBUG - Online update step: 48/50
2025-06-06 15:42:01,003 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,003 - DEBUG - Online update step: 49/50
2025-06-06 15:42:01,003 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,003 - DEBUG - Online update step: 50/50
2025-06-06 15:42:01,003 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:42:01,003 - WARNING - No successful steps during online update.
2025-06-06 15:42:01,004 - DEBUG - Current node mean: [-1.1009227e-08  1.1009227e-08 -4.7821331e-08 -4.1284602e-09
  1.2041342e-08  2.1330377e-08 -3.5091912e-08 -1.3761534e-08
  2.0642301e-09  6.8807671e-10  2.3394609e-08  1.6513841e-08
 -1.9266148e-08 -2.4770761e-08 -3.9908450e-08 -2.0642301e-09
 -3.3715757e-08 -2.3394609e-08 -2.7523068e-09], current edge mean: [ 1.4191989e+00  4.9765191e+00  5.2689191e-09  0.0000000e+00
 -3.9516892e-09  2.6344595e-09  2.6344595e-09  2.6344595e-09
  2.6344595e-09  1.3172298e-09  1.6465371e-09 -9.2206083e-09
 -1.0537838e-08  1.3172297e-08 -6.5861488e-10  1.3172298e-09
  1.3172298e-09  1.3172298e-09  1.3172298e-09  1.3172298e-09
  1.3172298e-09 -6.5861488e-10]
2025-06-06 15:42:01,004 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.1092
2025-06-06 15:42:01,004 - DEBUG - Updated reference mean: node=[-1.1009227e-08  1.1009227e-08 -4.7821331e-08 -4.1284602e-09
  1.2041342e-08  2.1330377e-08 -3.5091912e-08 -1.3761534e-08
  2.0642301e-09  6.8807671e-10  2.3394609e-08  1.6513841e-08
 -1.9266148e-08 -2.4770761e-08 -3.9908450e-08 -2.0642301e-09
 -3.3715757e-08 -2.3394609e-08 -2.7523068e-09], edge=[ 1.4191989e+00  4.9765191e+00  5.2689191e-09  0.0000000e+00
 -3.9516892e-09  2.6344595e-09  2.6344595e-09  2.6344595e-09
  2.6344595e-09  1.3172298e-09  1.6465371e-09 -9.2206083e-09
 -1.0537838e-08  1.3172297e-08 -6.5861488e-10  1.3172298e-09
  1.3172298e-09  1.3172298e-09  1.3172298e-09  1.3172298e-09
  1.3172298e-09 -6.5861488e-10]
2025-06-06 15:42:01,005 - DEBUG - Updated reference std: node=[1.0007223 1.0007223 1.0007223 1.0007223 1.0007223 1.0007223 1.0007223
 1.0007223 1.0007223 1.0007223 1.0007223 1.0007223 1.0007223 1.0007223
 1.0007223 1.0007223 1.0007223 1.0007223 1.0007223], edge=[0.5060425 1.7828178 1.0003455 1.0003455 1.0003455 1.0003455 1.0003455
 1.0003455 1.0003455 1.0003455 1.0003455 1.0003455 1.0003455 1.0003455
 1.0003455 1.0003455 1.0003455 1.0003455 1.0003455 1.0003455 1.0003455
 1.0003455]
2025-06-06 15:42:01,005 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:42:01,005 - INFO - Running anomaly detection...
2025-06-06 15:42:01,005 - INFO - Starting anomaly detection.
2025-06-06 15:42:01,018 - DEBUG - Node reconstruction errors: [ 52.174007  43.51698   43.400948  43.711845  43.045     42.50205
  43.385345  43.113655  43.12005   43.318356  42.784714  37.44595
  41.155094  43.313698  42.880543  50.09723   42.644268  43.37678
  42.175995  43.59978   43.01129   43.1729    41.984406  43.700623
  44.063305  42.331856  42.884155  43.86147   44.428024  43.767952
  44.11567   52.934296  41.120575  52.510166  43.176746  43.31626
  41.48176   43.168324  43.323692  42.46867   41.59081   45.349556
  39.35657   48.332623  39.91009   42.068066  40.957443  42.233356
  42.016125  42.29054   42.17358   41.99621   41.294567  45.717213
  41.377827  41.7305    42.718597  44.85564   42.06604   51.516148
  43.24512   41.595875  44.01372   52.629425  43.352417  51.44631
  44.01372   43.352417  40.469017  41.274204  39.060257  42.158024
  39.263058  42.34433   42.655365  49.210957  45.011265  41.85033
  42.37688   37.830967  42.065712  42.08154   42.3201    40.02495
  42.05837   41.714684  40.925964  44.788567  31.852299  40.608925
  41.184647  42.299187  40.572475  41.86565   42.266766  43.09537
  53.1256    41.236866  39.61678   54.64856   45.184223  44.700848
  45.117645  52.56137   46.150906  52.89197   46.04362   53.08145
  54.302097  47.312695  46.79774   48.18808   38.233414  50.172516
  46.610493  49.270252  42.680496  48.31644   44.028656  40.607952
  46.977222  44.881058  50.944347  39.26991   43.25451   42.71126
  49.299572  40.469505  49.85225   44.71219   45.902985  46.646797
  40.610287  47.014362  51.658752  42.777916  40.88561   38.840183
  44.220856  48.225346  61.5356    53.68964   44.34449   46.345848
  39.00516   45.23568   46.130157  51.979183  49.32782   18.75385
  38.221672  53.838173  46.6382    46.627575  52.120007  51.527702
  39.890915  43.202114  53.57029   50.561447  53.03424  114.255974
  41.8616    45.90144   48.912476  42.637314  52.355495  52.280075
  42.01902   43.2043    50.49655   50.246857  37.978226  48.15776
  50.47877   53.00235   53.752964  39.854115  50.753704  48.317516
  52.963326  45.43808   43.551388  54.61314   37.70982   45.48737
  42.61034   38.80653   54.089508  45.109695  42.79278   38.015972
  40.916058  45.216675  43.175224  45.49228   46.145603  51.68933
  49.02947   40.801846  46.54027   35.886013  41.342457  44.586212
  45.01816   46.800037  47.723694  48.33261   49.332165  45.376728
  39.184982  44.044315  42.875378  38.422253  45.645977  49.671577
  41.34436   39.506886  38.668644  50.18188   45.154514  58.64792
  51.49818   42.90994   51.168545  35.233078  45.448723  45.036407
  43.708374  41.55873   43.254517  36.511166  53.652584  49.477028
  41.392334  37.71202   41.052216  36.5294    52.03688   49.650555
  47.70754   40.004932  50.005455  41.96052  134.96326   42.34612
  51.942192  54.73604   40.807564  42.298702  36.48375   41.027866
  53.92447   44.751415  47.516907  45.069916  49.004128  53.7444
  45.22366   53.44968   46.204945  49.26837   34.63325   29.085241
  41.446533  38.982906  42.23056   42.723114  53.167328  35.209465
  47.255054  44.43058   39.109486  39.68918   29.149591  54.408627
  39.79016   52.440693  49.728645  53.407673  50.38922   54.203106
  39.04705   42.750656  46.453083  51.522976  48.71375   43.07446
  52.534008  44.883617 108.71897   40.113567  39.40377   42.506565
  41.92511   34.702972  54.01445   37.820606  43.782536  46.1008
  52.505936  52.234394  42.044197  49.922394  44.798267  54.252937
  52.339912  48.62982   50.26506   43.66783   38.384323  51.512196
  31.860888  38.333485  50.976845  41.855835  41.405914  44.629875
  50.80643   56.200676  39.174732  40.99936   48.7973    52.382008
  42.32246   48.269054  43.120655  44.92045   46.57113   51.614517
  41.9444    45.03989   37.678436  44.112232  52.816113  44.531944
  37.657967  47.326622  43.112732  39.18511   49.500782  49.804394
  50.72688   47.50449   48.35836   47.34012   47.986034  40.601013
  43.124096  41.530094  46.8131    48.817043  43.422775  41.75153
  41.79895   47.209877  37.357018  42.100674  44.86639   40.961746
  44.62433   55.073326  56.24509   55.67701   41.266815  53.557648
  45.666332  42.91012   44.99191   40.96757   39.64403   54.127453
  45.484833  39.960533  52.883522  42.755318  47.747955  50.41031
  44.182617  52.318867  42.517548  41.326607  52.806984  48.114338
  39.766907  54.041306  50.942066  54.787437  51.16399   52.88119
  44.511883  49.595303  45.8355    46.594433  51.49708   40.616547
  30.45682   54.07623   65.47671   50.782463  39.85542   46.255444
  53.48786   45.491486  53.822514  60.269604  46.90758   43.578804
  44.376404  39.530586  45.017727  48.725735  53.74511   45.350456
  40.558502  43.726406  47.9298    49.034985  33.169243  36.760693
  41.168964  43.766293  43.924946  44.25036   55.77482   52.641365
  43.43863   45.07286   42.717846  53.565487  55.95427   39.953148
  48.341568  43.175213  43.088367  49.582912  45.060238  40.452595
  39.601425  49.26807   55.34424   43.020275  50.15202   37.368904
  49.375683  47.843822  46.863438  51.225468  45.84335   51.598507
  53.929115  45.11411   43.2046    49.753788  43.08774   47.18897
  52.914925  47.471294  40.152554  47.469532  52.03278   44.230076
  42.282444  43.033436  44.396942  52.094696  49.638092  48.201828
  42.108067  43.45838   41.432568  47.21015   49.804516  45.503826
  43.728012  42.524567  41.51468   42.890865  44.12333   30.321308
  43.551796  49.70199   45.89268   40.099667  42.206863  39.75195
  42.533436  40.27945   51.512074  42.781628  38.69514   39.09294
  42.89641   43.15401   48.332623  46.398224  54.71496   39.690468
  48.54673   42.752167  45.567158  43.267925  41.935978  47.538853
  43.809372  51.721302  41.546215  42.101208  43.5857    55.99121
  45.83906   34.422997  45.76937   44.85275   43.274628  44.160637
  41.18543   43.46803   41.686794  41.257298  52.10216   47.317627
  41.008636  39.56931   52.371662  40.37224   45.224636  45.36829
  43.0503    48.412704  37.797512  51.586746  44.16127   42.367977
  45.110695  52.26073   43.465187  45.548008  44.673664  40.845043
  40.894154  55.34219   43.893536  47.60632   50.52872   40.182636
  43.618313  45.785824  51.225323  52.79839   43.46125   50.757652
  42.707924  40.509605  32.637386  54.541183  55.58494   43.698288
  41.443714  46.340076  42.089157  55.73929   46.768     51.11148
  47.52815   49.76156   54.262928  50.105938  54.770233  44.613308
  35.64994   43.697094  54.97903   47.3178    51.037643  49.306732
  36.21307   48.293716  40.73679   41.704544  48.28408   56.253803
  55.291496  46.992878  55.28431   49.384064  46.4204    41.553352
  55.09267   55.317898  39.462383  45.679104  41.205654  54.030144
  51.66754   54.451263  46.448193  44.814636  56.18532   47.884556
  41.861645  49.219425  34.31939   40.71762   42.697414  42.05787
  49.88841   42.05194   47.39128   45.212555  47.769566  50.611275
  49.44398   55.159275  46.88346   42.044983  47.56208   45.834427
  48.874344  55.51924   56.329823  40.48096   48.83027   50.837498
  54.50935   44.307312  51.306385  41.755024  55.494602  51.688046
  41.43556   48.439888  42.549755  41.14095   49.972546  41.056072
  38.620495  43.057545  43.931324  52.84007   49.95641   51.03043
  55.386044  53.507843  55.440296  47.353653  50.983498  49.472015
  51.385002  51.649918  50.034233  40.306053  38.852325  40.41311
  51.12051   41.960182  51.421085  51.146732  42.593204  47.252422
  54.650944  49.661823  52.967785  50.487843  54.06448   52.414803
  52.823154  41.816616  50.10855   50.632404  51.58837   31.269556
  47.97028   48.4504    55.893322  45.17704   48.541042  55.821327
  53.404434  37.907185  44.960705  43.23832   41.500023  45.01861
  49.645985  52.829082  45.385506  39.970436  52.25341   41.12682
  43.69767   41.293133  40.150295]
2025-06-06 15:42:01,018 - DEBUG - Edge reconstruction errors: [0.8 0.8 0.8 ... 0.8 0.8 0.8]
2025-06-06 15:42:01,019 - ERROR - An error occurred while processing file nw_graph_encoded_1749044768.dot: name 'os' is not defined
2025-06-06 15:42:01,020 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow.py", line 429, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 9, in save_anomalies_to_file
    filename = os.path.join(anomaly_log_path, f"anomalies_{timestamp}_update_{processed_files_count}.json")
               ^^
NameError: name 'os' is not defined. Did you forget to import 'os'

2025-06-06 15:42:01,020 - INFO - 
--- Processing file: nw_graph_encoded_1749044828.dot ---
2025-06-06 15:42:01,020 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044828.dot
2025-06-06 15:42:01,020 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044828.dot file.
2025-06-06 15:42:01,029 - INFO - Parsed 715 nodes.
2025-06-06 15:42:01,045 - INFO - Parsed 1521 edges.
