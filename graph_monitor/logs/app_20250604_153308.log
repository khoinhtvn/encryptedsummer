2025-06-04 15:33:08,469 - INFO - Application logging to file: logs/app_20250604_153308.log
2025-06-04 15:33:08,470 - INFO - Starting to monitor directory: /home/lu/Desktop/output_/ with log level: DEBUG
2025-06-04 15:33:08,470 - INFO - Starting to monitor directory: /home/lu/Desktop/output_/ for new and existing files every 30 seconds.
2025-06-04 15:33:08,470 - INFO - Train Mode: train, Visualization Path: vis
2025-06-04 15:33:08,470 - INFO - Found 2 files to process.
2025-06-04 15:33:08,470 - INFO - 
--- Processing file: nw_graph_encoded_1749027962.dot ---
2025-06-04 15:33:08,470 - INFO - Processing update from: /home/lu/Desktop/output_/nw_graph_encoded_1749027962.dot
2025-06-04 15:33:08,470 - INFO - Processing /home/lu/Desktop/output_/nw_graph_encoded_1749027962.dot file.
2025-06-04 15:33:08,482 - INFO - Parsed 1010 nodes.
2025-06-04 15:33:08,499 - INFO - Parsed 2221 edges.
2025-06-04 15:33:09,189 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:33:09,190 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:33:09,195 - DEBUG - Initial node features tensor shape: torch.Size([1010, 19])
2025-06-04 15:33:09,197 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:33:09,197 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 19])
2025-06-04 15:33:09,198 - DEBUG - Edge index tensor shape: torch.Size([2, 2221])
2025-06-04 15:33:09,198 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:33:09,209 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-04 15:33:09,210 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-04 15:33:09,212 - DEBUG - Shape of encoded categorical edge features: torch.Size([2221, 2])
2025-06-04 15:33:09,214 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:33:09,214 - DEBUG - Shape of scaled numerical edge features: torch.Size([2221, 20])
2025-06-04 15:33:09,214 - DEBUG - Final edge attributes tensor shape: torch.Size([2221, 22])
2025-06-04 15:33:09,215 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:33:09,215 - INFO - Initializing HybridGNNAnomalyDetector with node_dim=19, edge_dim=22, hidden_dim=128, embedding_dim=64, heads=4, num_gat_layers=3, gat_heads=4, recon_loss_type=mse, edge_recon_loss_type=bce
2025-06-04 15:33:09,215 - INFO - Initializing GraphAutoencoder with node_dim=19, edge_dim=22, hidden_dim=128, embedding_dim=64, num_gat_layers=3, gat_heads=4, use_batch_norm=True, use_residual=True
2025-06-04 15:33:09,264 - DEBUG - Encoder GATConv layers initialized with final embedding dimension: 64
2025-06-04 15:33:09,266 - DEBUG - Decoder MLP layers initialized with proper weight initialization.
2025-06-04 15:33:09,269 - DEBUG - Anomaly scoring MLPs initialized.
2025-06-04 15:33:09,269 - INFO - Optimizer (AdamW) and scheduler (CosineAnnealingWarmRestarts) initialized.
2025-06-04 15:33:09,269 - INFO - Replay buffer initialized with maxlen=2000, batch_size=16
2025-06-04 15:33:09,269 - INFO - RunningStats initialized.
2025-06-04 15:33:09,269 - INFO - RunningStats initialized.
2025-06-04 15:33:09,269 - INFO - Statistical controls initialized: drift_threshold=0.15
2025-06-04 15:33:09,270 - INFO - Using device: cpu
2025-06-04 15:33:09,270 - INFO - Initialized Hybrid GNN (node_dim=19, edge_dim=22)
2025-06-04 15:33:09,282 - INFO - Checkpoint loaded from model_checkpoints/latest_checkpoint.pth at epoch 2
2025-06-04 15:33:09,282 - INFO - Resuming online updates from step: 2
2025-06-04 15:33:09,282 - INFO - Running statistics loaded from stats/running_stats.pkl
2025-06-04 15:33:09,282 - INFO - Performing online update...
2025-06-04 15:33:09,282 - INFO - Starting online update for 50 steps.
2025-06-04 15:33:09,283 - DEBUG - Updated RunningStats: new_mean=[ 5.39200395e-10 -5.23104395e-10 -2.55522905e-09  2.45728284e-09
 -2.74631168e-08  1.50890512e-08 -1.06753241e-08 -2.36525508e-09
 -3.12118100e-09  8.47109674e-10  1.63153377e-09 -1.67729758e-09
  4.06676830e-09 -3.43360336e-09  9.29321971e-10  9.23914741e-10
 -3.94971867e-09  1.41432405e-09 -5.25699709e-09], new_M2=[178760.00527941 178760.0052093  178760.00041325 178760.00427092
 178759.9986781  178759.9983656  178759.99595289 178759.99837883
 178759.99323198 178759.99820879 178760.00197368 178759.99371651
 178759.9925673  140031.99643628 140032.00026795 140031.99903983
 140032.00007233 178760.00042971 178760.0075449 ], new_n=178760
2025-06-04 15:33:09,284 - DEBUG - Updated RunningStats: new_mean=[ 1.41765401e+00  5.52435447e+00  1.17238539e-10  3.08379804e-10
  1.61542634e-10 -1.70589006e-10 -1.31860404e-09  2.56055963e-10
  2.92165968e-10 -2.99929086e-10  3.89270369e-10 -3.84805116e-09
 -9.36013678e-10  6.93573281e-10  3.68183434e-10 -1.71344454e-10
 -1.71344454e-10 -1.71344454e-10 -1.71344454e-10 -1.71344454e-10
 -1.71344454e-10 -7.30095108e-11], new_M2=[  99032.37382219 1713174.11669832  385883.99906012  385884.00651014
  385884.00552318  385883.99345773  385884.00033854  385883.99908679
  385884.00171728  385883.99937984  385883.99327929  385884.00875445
  385884.00114596  385883.99972909  385884.00181705  385883.9944651
  385883.9944651   385883.9944651   385883.9944651   385883.9944651
  385883.9944651   385883.99942257], new_n=385884
2025-06-04 15:33:09,284 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 0.99999999 1.00000001 0.99999998
 0.99999998 0.88507173 0.88507174 0.88507173 0.88507174 1.
 1.00000002]
2025-06-04 15:33:09,284 - DEBUG - Calculated standard deviation: [0.50659419 2.10703799 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:33:09,284 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:33:09,284 - DEBUG - Online update step: 1/50
2025-06-04 15:33:09,284 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,284 - DEBUG - Online update step: 2/50
2025-06-04 15:33:09,284 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,284 - DEBUG - Online update step: 3/50
2025-06-04 15:33:09,284 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,284 - DEBUG - Online update step: 4/50
2025-06-04 15:33:09,284 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,284 - DEBUG - Online update step: 5/50
2025-06-04 15:33:09,284 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,284 - DEBUG - Online update step: 6/50
2025-06-04 15:33:09,284 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,284 - DEBUG - Online update step: 7/50
2025-06-04 15:33:09,284 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,284 - DEBUG - Online update step: 8/50
2025-06-04 15:33:09,284 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,284 - DEBUG - Online update step: 9/50
2025-06-04 15:33:09,285 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,285 - DEBUG - Online update step: 10/50
2025-06-04 15:33:09,285 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,285 - DEBUG - Online update step: 11/50
2025-06-04 15:33:09,285 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,285 - DEBUG - Online update step: 12/50
2025-06-04 15:33:09,285 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,285 - DEBUG - Online update step: 13/50
2025-06-04 15:33:09,285 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,285 - DEBUG - Online update step: 14/50
2025-06-04 15:33:09,285 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,285 - DEBUG - Online update step: 15/50
2025-06-04 15:33:09,285 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,285 - DEBUG - Online update step: 16/50
2025-06-04 15:33:09,285 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,285 - DEBUG - Online update step: 17/50
2025-06-04 15:33:09,285 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,285 - DEBUG - Online update step: 18/50
2025-06-04 15:33:09,285 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,285 - DEBUG - Online update step: 19/50
2025-06-04 15:33:09,285 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,285 - DEBUG - Online update step: 20/50
2025-06-04 15:33:09,285 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,285 - DEBUG - Online update step: 21/50
2025-06-04 15:33:09,285 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,285 - DEBUG - Online update step: 22/50
2025-06-04 15:33:09,285 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,285 - DEBUG - Online update step: 23/50
2025-06-04 15:33:09,285 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,285 - DEBUG - Online update step: 24/50
2025-06-04 15:33:09,285 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,285 - DEBUG - Online update step: 25/50
2025-06-04 15:33:09,285 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,285 - DEBUG - Online update step: 26/50
2025-06-04 15:33:09,285 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,285 - DEBUG - Online update step: 27/50
2025-06-04 15:33:09,285 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,286 - DEBUG - Online update step: 28/50
2025-06-04 15:33:09,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,286 - DEBUG - Online update step: 29/50
2025-06-04 15:33:09,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,286 - DEBUG - Online update step: 30/50
2025-06-04 15:33:09,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,286 - DEBUG - Online update step: 31/50
2025-06-04 15:33:09,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,286 - DEBUG - Online update step: 32/50
2025-06-04 15:33:09,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,286 - DEBUG - Online update step: 33/50
2025-06-04 15:33:09,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,286 - DEBUG - Online update step: 34/50
2025-06-04 15:33:09,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,286 - DEBUG - Online update step: 35/50
2025-06-04 15:33:09,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,286 - DEBUG - Online update step: 36/50
2025-06-04 15:33:09,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,286 - DEBUG - Online update step: 37/50
2025-06-04 15:33:09,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,286 - DEBUG - Online update step: 38/50
2025-06-04 15:33:09,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,286 - DEBUG - Online update step: 39/50
2025-06-04 15:33:09,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,286 - DEBUG - Online update step: 40/50
2025-06-04 15:33:09,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,286 - DEBUG - Online update step: 41/50
2025-06-04 15:33:09,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,286 - DEBUG - Online update step: 42/50
2025-06-04 15:33:09,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,286 - DEBUG - Online update step: 43/50
2025-06-04 15:33:09,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,286 - DEBUG - Online update step: 44/50
2025-06-04 15:33:09,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,286 - DEBUG - Online update step: 45/50
2025-06-04 15:33:09,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,286 - DEBUG - Online update step: 46/50
2025-06-04 15:33:09,286 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,287 - DEBUG - Online update step: 47/50
2025-06-04 15:33:09,287 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,287 - DEBUG - Online update step: 48/50
2025-06-04 15:33:09,287 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,287 - DEBUG - Online update step: 49/50
2025-06-04 15:33:09,287 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,287 - DEBUG - Online update step: 50/50
2025-06-04 15:33:09,287 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:09,287 - WARNING - No successful steps during online update.
2025-06-04 15:33:09,288 - DEBUG - Current node mean: [ 2.0773104e-08 -2.0773104e-08 -3.6352933e-08  2.2425510e-08
 -5.3821225e-08  5.8542383e-08  4.2490438e-09  9.4423198e-09
  1.4163480e-09  9.4423198e-09  1.8884641e-09 -5.6653922e-09
 -2.2661569e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -2.1717335e-08  1.9828873e-08], current edge mean: [ 1.4218820e+00  5.7005854e+00 -2.7910325e-09  1.7175584e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.1469480e-09
 -8.3730978e-09  3.4351169e-09 -9.0171817e-09  2.7910325e-09
 -3.8645065e-09 -7.2996231e-09 -3.4351169e-09 -4.2938959e-09
 -4.2938959e-09 -4.2938959e-09 -4.2938959e-09 -4.2938959e-09
 -4.2938959e-09  5.1526752e-09]
2025-06-04 15:33:09,288 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.0836
2025-06-04 15:33:09,288 - DEBUG - Updated reference mean: node=[ 2.0773104e-08 -2.0773104e-08 -3.6352933e-08  2.2425510e-08
 -5.3821225e-08  5.8542383e-08  4.2490438e-09  9.4423198e-09
  1.4163480e-09  9.4423198e-09  1.8884641e-09 -5.6653922e-09
 -2.2661569e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -2.1717335e-08  1.9828873e-08], edge=[ 1.4218820e+00  5.7005854e+00 -2.7910325e-09  1.7175584e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.1469480e-09
 -8.3730978e-09  3.4351169e-09 -9.0171817e-09  2.7910325e-09
 -3.8645065e-09 -7.2996231e-09 -3.4351169e-09 -4.2938959e-09
 -4.2938959e-09 -4.2938959e-09 -4.2938959e-09 -4.2938959e-09
 -4.2938959e-09  5.1526752e-09]
2025-06-04 15:33:09,289 - DEBUG - Updated reference std: node=[1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954
 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 0.
 0.        0.        0.        1.0004954 1.0004954], edge=[0.5056868 2.1382287 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252]
2025-06-04 15:33:09,289 - INFO - Online update complete. Loss: 0.0000
2025-06-04 15:33:09,289 - INFO - Running anomaly detection...
2025-06-04 15:33:09,289 - INFO - Starting anomaly detection.
2025-06-04 15:33:09,322 - DEBUG - Node reconstruction errors: [0.08554234 0.45920774 0.45920774 ... 0.45920774 0.09546381 0.09546381]
2025-06-04 15:33:09,323 - DEBUG - Edge reconstruction errors: [0.8        0.8        0.19999927 ... 0.8        0.19999415 0.8       ]
2025-06-04 15:33:09,326 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_153309_update_1.json
2025-06-04 15:33:09,326 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 15:33:09,349 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_153309_update_1.pth and as latest_checkpoint.pth
2025-06-04 15:33:09,350 - INFO - 
Global anomaly score (after nw_graph_encoded_1749027962.dot): 0.0000
2025-06-04 15:33:09,350 - WARNING - Detected 10 anomalous nodes (reconstruction-based):
2025-06-04 15:33:09,350 - WARNING -   Node ID: 210.245.26.100, Recon Error: 96.2367, MLP Score: 0.0000
2025-06-04 15:33:09,350 - WARNING -   Node ID: ff02::fb, Recon Error: 94.9342, MLP Score: 0.0000
2025-06-04 15:33:09,350 - WARNING -   Node ID: 239.255.255.250, Recon Error: 96.2367, MLP Score: 0.0000
2025-06-04 15:33:09,350 - WARNING -   Node ID: 192.168.239.101, Recon Error: 21.2966, MLP Score: 0.0000
2025-06-04 15:33:09,350 - WARNING -   Node ID: 192.168.27.13, Recon Error: 26.3666, MLP Score: 0.0000
2025-06-04 15:33:09,350 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 15:33:09,372 - INFO - Starting 3D embedding visualization...
2025-06-04 15:33:10,293 - DEBUG - Loaded backend module://backend_interagg version unknown.
2025-06-04 15:33:10,318 - DEBUG - colorbar update normal <matplotlib.colors.Normalize object at 0x7d4cd4218d40> <matplotlib.colors.Normalize object at 0x7d4cd4218d40>
2025-06-04 15:33:10,319 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7d4ccf872ed0>
2025-06-04 15:33:10,322 - DEBUG - colorbar update normal <matplotlib.colors.Normalize object at 0x7d4cd4218d40> <matplotlib.colors.Normalize object at 0x7d4cd4218d40>
2025-06-04 15:33:10,323 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7d4ccf872ed0>
2025-06-04 15:33:10,325 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7d4cd435ad20>
2025-06-04 15:33:10,524 - INFO - 3D embeddings visualization saved to vis/embeddings_3d_1_updates_20250604_153309.png
2025-06-04 15:33:10,525 - INFO - Performing visualization of node and edge features.
2025-06-04 15:33:10,525 - INFO - Starting visualization of node features.
2025-06-04 15:33:10,525 - INFO - Graph has 1010 nodes and 19 features.
2025-06-04 15:33:10,525 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, http_ratio, ssl_ratio
2025-06-04 15:33:10,525 - INFO - Calculating feature statistics:
2025-06-04 15:33:10,525 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 4, 'mean': np.float32(7.553856e-09), 'std': np.float32(0.9999998), 'min': np.float32(-0.10731402), 'max': np.float32(9.494974)}
2025-06-04 15:33:10,525 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 4, 'mean': np.float32(-7.553856e-09), 'std': np.float32(0.9999998), 'min': np.float32(-9.494974), 'max': np.float32(0.10731402)}
2025-06-04 15:33:10,525 - INFO - - server_score: {'name': 'server_score', 'unique': 14, 'mean': np.float32(-3.776928e-08), 'std': np.float32(1.0), 'min': np.float32(-2.2924573), 'max': np.float32(3.179208)}
2025-06-04 15:33:10,526 - INFO - - client_score: {'name': 'client_score', 'unique': 8, 'mean': np.float32(2.2661569e-08), 'std': np.float32(1.0000001), 'min': np.float32(-0.07549707), 'max': np.float32(18.159897)}
2025-06-04 15:33:10,526 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 3, 'mean': np.float32(-5.287699e-08), 'std': np.float32(1.0), 'min': np.float32(-0.64383537), 'max': np.float32(3.5112681)}
2025-06-04 15:33:10,526 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 16, 'mean': np.float32(6.043085e-08), 'std': np.float32(1.0), 'min': np.float32(-0.65014666), 'max': np.float32(2.8871822)}
2025-06-04 15:33:10,526 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 14, 'mean': np.float32(3.776928e-09), 'std': np.float32(0.99999994), 'min': np.float32(-2.9084294), 'max': np.float32(0.63373893)}
2025-06-04 15:33:10,526 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 8, 'mean': np.float32(9.44232e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.07902002), 'max': np.float32(20.264761)}
2025-06-04 15:33:10,526 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 5, 'mean': np.float32(-1.888464e-09), 'std': np.float32(0.99999994), 'min': np.float32(-4.2803183), 'max': np.float32(21.025759)}
2025-06-04 15:33:10,526 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 7, 'mean': np.float32(9.44232e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.09293793), 'max': np.float32(11.41274)}
2025-06-04 15:33:10,526 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 16, 'mean': np.float32(-1.5107712e-08), 'std': np.float32(1.0), 'min': np.float32(-2.002014), 'max': np.float32(0.92043453)}
2025-06-04 15:33:10,527 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 6, 'mean': np.float32(-9.44232e-09), 'std': np.float32(1.0000001), 'min': np.float32(-0.1026304), 'max': np.float32(10.273981)}
2025-06-04 15:33:10,527 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 3, 'mean': np.float32(-2.2661569e-08), 'std': np.float32(0.9999998), 'min': np.float32(-8.024705), 'max': np.float32(0.12643686)}
2025-06-04 15:33:10,527 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-04 15:33:10,527 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-04 15:33:10,527 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-04 15:33:10,527 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-04 15:33:10,527 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 13, 'mean': np.float32(-1.6051944e-08), 'std': np.float32(1.0), 'min': np.float32(-7.4247913), 'max': np.float32(0.15153895)}
2025-06-04 15:33:10,527 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 16, 'mean': np.float32(1.5107712e-08), 'std': np.float32(0.99999994), 'min': np.float32(-4.1466002), 'max': np.float32(4.358143)}
2025-06-04 15:33:10,549 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7d4cd5126270>
2025-06-04 15:33:10,681 - DEBUG - Plotted correlation matrix of node features.
2025-06-04 15:33:10,718 - DEBUG - Plotted ranges of node feature values.
2025-06-04 15:33:10,737 - DEBUG - Plotted sparsity of node features.
2025-06-04 15:33:11,755 - INFO - Node feature visualization saved to vis/node_features_20250604_153310.png
2025-06-04 15:33:11,755 - INFO - Finished visualization of node features.
2025-06-04 15:33:11,755 - INFO - Performing additional feature analysis:
2025-06-04 15:33:11,756 - INFO - - Maximum correlation between different features: nan
2025-06-04 15:33:11,756 - INFO - Starting visualization of edge features.
2025-06-04 15:33:11,756 - INFO - Graph has 2221 edges and 22 edge features.
2025-06-04 15:33:11,756 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-04 15:33:11,756 - ERROR - Error during 2D feature visualization: Expected 22 names, got 10
2025-06-04 15:33:11,756 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 491, in monitor_new_files
    visualize_edge_features(main_data, save_path=visualization_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/visualization.py", line 197, in visualize_edge_features
    raise ValueError(f"Expected {num_features} names, got {len(edge_feature_names)}")
ValueError: Expected 22 names, got 10

2025-06-04 15:33:11,757 - INFO - 
--- Processing file: nw_graph_encoded_1749027962.dot ---
2025-06-04 15:33:11,757 - INFO - Processing update from: /home/lu/Desktop/output_/nw_graph_encoded_1749027962.dot
2025-06-04 15:33:11,757 - INFO - Processing /home/lu/Desktop/output_/nw_graph_encoded_1749027962.dot file.
2025-06-04 15:33:11,768 - INFO - Parsed 1010 nodes.
2025-06-04 15:33:11,788 - INFO - Parsed 2221 edges.
2025-06-04 15:33:12,453 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:33:12,453 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:33:12,458 - DEBUG - Initial node features tensor shape: torch.Size([1010, 19])
2025-06-04 15:33:12,459 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:33:12,459 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 19])
2025-06-04 15:33:12,558 - DEBUG - Edge index tensor shape: torch.Size([2, 2221])
2025-06-04 15:33:12,559 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:33:12,568 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-04 15:33:12,569 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-04 15:33:12,570 - DEBUG - Shape of encoded categorical edge features: torch.Size([2221, 2])
2025-06-04 15:33:12,572 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:33:12,572 - DEBUG - Shape of scaled numerical edge features: torch.Size([2221, 20])
2025-06-04 15:33:12,572 - DEBUG - Final edge attributes tensor shape: torch.Size([2221, 22])
2025-06-04 15:33:12,572 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:33:12,572 - INFO - Performing online update...
2025-06-04 15:33:12,572 - INFO - Starting online update for 50 steps.
2025-06-04 15:33:12,573 - DEBUG - Updated RunningStats: new_mean=[ 5.35176330e-10 -5.20497003e-10 -2.68485321e-09  2.48997848e-09
 -2.75720802e-08  1.52386899e-08 -1.07162243e-08 -2.38048060e-09
 -3.13331997e-09  8.19161848e-10  1.61671009e-09 -1.68731177e-09
  4.08006011e-09 -3.41431238e-09  9.24100771e-10  9.18723920e-10
 -3.92752800e-09  1.40571485e-09 -5.25415238e-09], new_M2=[179770.00530703 179770.0052382  179770.00044905 179770.00436445
 179769.99865632 179769.99836158 179769.9958676  179769.99837058
 179769.99315142 179769.998174   179770.00201385 179769.99364765
 179769.99249846 140031.99643628 140032.00026795 140031.99903983
 140032.00007233 179770.00042595 179770.00760036], new_n=179770
2025-06-04 15:33:12,573 - DEBUG - Updated RunningStats: new_mean=[ 1.41767821e+00  5.52536298e+00  1.18049940e-10  3.03255326e-10
  1.61646585e-10 -1.75251097e-10 -1.30707464e-09  2.39572774e-10
  2.64980142e-10 -2.95225404e-10  3.58397881e-10 -3.80447492e-09
 -9.51800635e-10  6.43357812e-10  3.58579881e-10 -1.70477289e-10
 -1.70477289e-10 -1.70477289e-10 -1.70477289e-10 -1.70477289e-10
 -1.70477289e-10 -7.46860848e-11], new_M2=[  99600.1098311  1723392.58948999  388104.99904181  388105.00641606
  388105.00549534  388104.99334967  388105.00035482  388104.99902641
  388105.00172422  388104.99938535  388104.99310766  388105.00869561
  388105.00114697  388104.99975184  388105.00177233  388104.9944515
  388104.9944515   388104.9944515   388104.9944515   388104.9944515
  388104.9944515   388104.99936172], new_n=388105
2025-06-04 15:33:12,573 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 0.99999999 1.00000001 0.99999998
 0.99999998 0.88258193 0.88258194 0.88258194 0.88258194 1.
 1.00000002]
2025-06-04 15:33:12,574 - DEBUG - Calculated standard deviation: [0.50658846 2.10725693 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:33:12,574 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:33:12,574 - DEBUG - Online update step: 1/50
2025-06-04 15:33:12,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,574 - DEBUG - Online update step: 2/50
2025-06-04 15:33:12,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,574 - DEBUG - Online update step: 3/50
2025-06-04 15:33:12,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,574 - DEBUG - Online update step: 4/50
2025-06-04 15:33:12,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,574 - DEBUG - Online update step: 5/50
2025-06-04 15:33:12,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,574 - DEBUG - Online update step: 6/50
2025-06-04 15:33:12,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,574 - DEBUG - Online update step: 7/50
2025-06-04 15:33:12,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,574 - DEBUG - Online update step: 8/50
2025-06-04 15:33:12,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,574 - DEBUG - Online update step: 9/50
2025-06-04 15:33:12,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,574 - DEBUG - Online update step: 10/50
2025-06-04 15:33:12,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,574 - DEBUG - Online update step: 11/50
2025-06-04 15:33:12,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,574 - DEBUG - Online update step: 12/50
2025-06-04 15:33:12,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,574 - DEBUG - Online update step: 13/50
2025-06-04 15:33:12,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,574 - DEBUG - Online update step: 14/50
2025-06-04 15:33:12,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,574 - DEBUG - Online update step: 15/50
2025-06-04 15:33:12,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,574 - DEBUG - Online update step: 16/50
2025-06-04 15:33:12,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,574 - DEBUG - Online update step: 17/50
2025-06-04 15:33:12,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,575 - DEBUG - Online update step: 18/50
2025-06-04 15:33:12,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,575 - DEBUG - Online update step: 19/50
2025-06-04 15:33:12,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,575 - DEBUG - Online update step: 20/50
2025-06-04 15:33:12,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,575 - DEBUG - Online update step: 21/50
2025-06-04 15:33:12,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,575 - DEBUG - Online update step: 22/50
2025-06-04 15:33:12,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,575 - DEBUG - Online update step: 23/50
2025-06-04 15:33:12,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,575 - DEBUG - Online update step: 24/50
2025-06-04 15:33:12,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,575 - DEBUG - Online update step: 25/50
2025-06-04 15:33:12,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,575 - DEBUG - Online update step: 26/50
2025-06-04 15:33:12,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,575 - DEBUG - Online update step: 27/50
2025-06-04 15:33:12,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,575 - DEBUG - Online update step: 28/50
2025-06-04 15:33:12,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,575 - DEBUG - Online update step: 29/50
2025-06-04 15:33:12,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,575 - DEBUG - Online update step: 30/50
2025-06-04 15:33:12,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,575 - DEBUG - Online update step: 31/50
2025-06-04 15:33:12,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,575 - DEBUG - Online update step: 32/50
2025-06-04 15:33:12,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,575 - DEBUG - Online update step: 33/50
2025-06-04 15:33:12,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,575 - DEBUG - Online update step: 34/50
2025-06-04 15:33:12,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,575 - DEBUG - Online update step: 35/50
2025-06-04 15:33:12,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,575 - DEBUG - Online update step: 36/50
2025-06-04 15:33:12,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,575 - DEBUG - Online update step: 37/50
2025-06-04 15:33:12,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,575 - DEBUG - Online update step: 38/50
2025-06-04 15:33:12,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,575 - DEBUG - Online update step: 39/50
2025-06-04 15:33:12,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,575 - DEBUG - Online update step: 40/50
2025-06-04 15:33:12,576 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,576 - DEBUG - Online update step: 41/50
2025-06-04 15:33:12,576 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,576 - DEBUG - Online update step: 42/50
2025-06-04 15:33:12,576 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,576 - DEBUG - Online update step: 43/50
2025-06-04 15:33:12,576 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,576 - DEBUG - Online update step: 44/50
2025-06-04 15:33:12,576 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,576 - DEBUG - Online update step: 45/50
2025-06-04 15:33:12,576 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,576 - DEBUG - Online update step: 46/50
2025-06-04 15:33:12,576 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,576 - DEBUG - Online update step: 47/50
2025-06-04 15:33:12,576 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,576 - DEBUG - Online update step: 48/50
2025-06-04 15:33:12,576 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,576 - DEBUG - Online update step: 49/50
2025-06-04 15:33:12,576 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,576 - DEBUG - Online update step: 50/50
2025-06-04 15:33:12,576 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:33:12,576 - WARNING - No successful steps during online update.
2025-06-04 15:33:12,576 - DEBUG - Current node mean: [ 2.0773104e-08 -2.0773104e-08 -3.6352933e-08  2.2425510e-08
 -5.3821225e-08  5.8542383e-08  4.2490438e-09  9.4423198e-09
  1.4163480e-09  9.4423198e-09  1.8884641e-09 -5.6653922e-09
 -2.2661569e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -2.1717335e-08  1.9828873e-08], current edge mean: [ 1.4218820e+00  5.7005854e+00 -2.7910325e-09  1.7175584e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.1469480e-09
 -8.3730978e-09  3.4351169e-09 -9.0171817e-09  2.7910325e-09
 -3.8645065e-09 -7.2996231e-09 -3.4351169e-09 -4.2938959e-09
 -4.2938959e-09 -4.2938959e-09 -4.2938959e-09 -4.2938959e-09
 -4.2938959e-09  5.1526752e-09]
2025-06-04 15:33:12,577 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.0832
2025-06-04 15:33:12,577 - DEBUG - Updated reference mean: node=[ 2.0773104e-08 -2.0773104e-08 -3.6352933e-08  2.2425510e-08
 -5.3821225e-08  5.8542383e-08  4.2490438e-09  9.4423198e-09
  1.4163480e-09  9.4423198e-09  1.8884641e-09 -5.6653922e-09
 -2.2661569e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -2.1717335e-08  1.9828873e-08], edge=[ 1.4218820e+00  5.7005854e+00 -2.7910325e-09  1.7175584e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.1469480e-09
 -8.3730978e-09  3.4351169e-09 -9.0171817e-09  2.7910325e-09
 -3.8645065e-09 -7.2996231e-09 -3.4351169e-09 -4.2938959e-09
 -4.2938959e-09 -4.2938959e-09 -4.2938959e-09 -4.2938959e-09
 -4.2938959e-09  5.1526752e-09]
2025-06-04 15:33:12,577 - DEBUG - Updated reference std: node=[1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954
 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 0.
 0.        0.        0.        1.0004954 1.0004954], edge=[0.5056868 2.1382287 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252]
2025-06-04 15:33:12,577 - INFO - Online update complete. Loss: 0.0000
2025-06-04 15:33:12,577 - INFO - Running anomaly detection...
2025-06-04 15:33:12,577 - INFO - Starting anomaly detection.
2025-06-04 15:33:12,601 - DEBUG - Node reconstruction errors: [0.08554234 0.45920774 0.45920774 ... 0.45920774 0.09546381 0.09546381]
2025-06-04 15:33:12,602 - DEBUG - Edge reconstruction errors: [0.8        0.8        0.19999927 ... 0.8        0.19999415 0.8       ]
2025-06-04 15:33:12,603 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_153312_update_2.json
2025-06-04 15:33:12,604 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 15:33:12,622 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_153312_update_2.pth and as latest_checkpoint.pth
2025-06-04 15:33:12,622 - INFO - 
Global anomaly score (after nw_graph_encoded_1749027962.dot): 0.0000
2025-06-04 15:33:12,622 - WARNING - Detected 10 anomalous nodes (reconstruction-based):
2025-06-04 15:33:12,622 - WARNING -   Node ID: 210.245.26.100, Recon Error: 96.2367, MLP Score: 0.0000
2025-06-04 15:33:12,623 - WARNING -   Node ID: ff02::fb, Recon Error: 94.9342, MLP Score: 0.0000
2025-06-04 15:33:12,623 - WARNING -   Node ID: 239.255.255.250, Recon Error: 96.2367, MLP Score: 0.0000
2025-06-04 15:33:12,623 - WARNING -   Node ID: 192.168.239.101, Recon Error: 21.2966, MLP Score: 0.0000
2025-06-04 15:33:12,623 - WARNING -   Node ID: 192.168.27.13, Recon Error: 26.3666, MLP Score: 0.0000
2025-06-04 15:33:12,623 - INFO - No significant edge anomalies detected (reconstruction-based)
