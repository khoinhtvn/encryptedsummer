2025-06-02 15:24:36,047 - INFO - Application logging to file: logs/app_20250602_152436.log
2025-06-02 15:24:36,047 - INFO - Starting to monitor directory: /home/lu/Desktop/output/ with log level: DEBUG
2025-06-02 15:24:36,049 - INFO - Starting processing of existing directory: /home/lu/Desktop/output/
2025-06-02 15:24:36,049 - INFO - 
--- Processing file: nw_graph_encoded_1748869125.dot (Timestamp: 2025-06-02 14:58:45) ---
2025-06-02 15:24:36,049 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869125.dot
2025-06-02 15:24:36,050 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869125.dot
2025-06-02 15:24:36,051 - INFO - Parsed 7 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869125.dot'.
2025-06-02 15:24:36,052 - INFO - Parsed 5 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869125.dot'.
2025-06-02 15:24:36,052 - DEBUG - Initial graph - Nodes: 7, Edges: 5
2025-06-02 15:24:36,053 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:24:36,053 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:24:36,055 - DEBUG - Initial node features tensor shape: torch.Size([7, 30])
2025-06-02 15:24:36,057 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:24:36,058 - DEBUG - Node features tensor shape after scaling: torch.Size([7, 30])
2025-06-02 15:24:36,058 - DEBUG - Edge index tensor shape: torch.Size([2, 5])
2025-06-02 15:24:36,059 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:24:36,059 - DEBUG - Initial edge attributes tensor shape: torch.Size([5, 10])
2025-06-02 15:24:36,061 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:24:36,061 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([5, 10])
2025-06-02 15:24:36,062 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:24:45,450 - DEBUG - Type of pytorch_data (initial): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:24:45,451 - INFO - Initialized main graph with 7 nodes and 5 edges.
2025-06-02 15:24:45,452 - INFO - Initializing HybridGNNAnomalyDetector with node_dim=30, edge_dim=10, hidden_dim=64, embedding_dim=32, heads=4
2025-06-02 15:24:45,452 - INFO - Initializing GraphAutoencoder with node_dim=30, edge_dim=10, hidden_dim=64, embedding_dim=32
2025-06-02 15:24:45,796 - DEBUG - Encoder GATConv layers initialized: conv1 out_channels=256, conv2 out_channels=32
2025-06-02 15:24:45,798 - DEBUG - Decoder MLP layers initialized.
2025-06-02 15:24:45,799 - DEBUG - Anomaly scoring MLPs initialized.
2025-06-02 15:24:45,800 - INFO - Optimizer and scheduler initialized.
2025-06-02 15:24:45,800 - INFO - Replay buffer initialized with maxlen=1000, batch_size=32
2025-06-02 15:24:45,801 - INFO - RunningStats initialized.
2025-06-02 15:24:45,801 - INFO - RunningStats initialized.
2025-06-02 15:24:45,801 - INFO - Statistical controls initialized: drift_threshold=0.15
2025-06-02 15:24:45,801 - INFO - Embedding export will occur every 5 updates, saving to vis
2025-06-02 15:24:45,803 - INFO - Using device: cpu
2025-06-02 15:24:45,804 - INFO - Initialized Hybrid GNN (node_dim=30, edge_dim=10)
2025-06-02 15:24:45,804 - INFO - Performing initial training for 50 epochs...
2025-06-02 15:24:45,816 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:45,816 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:45,817 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:45,825 - INFO - Epoch 1/50, Loss: 7.1000
2025-06-02 15:24:45,828 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:45,829 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:45,829 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:45,833 - INFO - Epoch 2/50, Loss: 6.8963
2025-06-02 15:24:45,837 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:45,838 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:45,838 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:45,842 - INFO - Epoch 3/50, Loss: 6.7017
2025-06-02 15:24:45,845 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:45,846 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:45,848 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:45,853 - INFO - Epoch 4/50, Loss: 6.5130
2025-06-02 15:24:45,856 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:45,856 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:45,857 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:45,861 - INFO - Epoch 5/50, Loss: 6.3344
2025-06-02 15:24:45,864 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:45,865 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:45,865 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:45,870 - INFO - Epoch 6/50, Loss: 6.1613
2025-06-02 15:24:45,873 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:45,874 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:45,874 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:45,879 - INFO - Epoch 7/50, Loss: 5.9982
2025-06-02 15:24:45,882 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:45,883 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:45,885 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:45,890 - INFO - Epoch 8/50, Loss: 5.9754
2025-06-02 15:24:45,893 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:45,894 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:45,894 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:45,901 - INFO - Epoch 9/50, Loss: 5.9520
2025-06-02 15:24:45,904 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:45,905 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:45,905 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:45,911 - INFO - Epoch 10/50, Loss: 5.8936
2025-06-02 15:24:45,914 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:45,914 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:45,915 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:45,919 - INFO - Epoch 11/50, Loss: 5.8042
2025-06-02 15:24:45,922 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:45,923 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:45,923 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:45,928 - INFO - Epoch 12/50, Loss: 5.6872
2025-06-02 15:24:45,931 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:45,931 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:45,932 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:45,936 - INFO - Epoch 13/50, Loss: 5.5457
2025-06-02 15:24:45,939 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:45,939 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:45,940 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:45,944 - INFO - Epoch 14/50, Loss: 5.3806
2025-06-02 15:24:45,947 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:45,948 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:45,950 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:45,954 - INFO - Epoch 15/50, Loss: 5.1931
2025-06-02 15:24:45,957 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:45,958 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:45,958 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:45,962 - INFO - Epoch 16/50, Loss: 4.9835
2025-06-02 15:24:45,969 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:45,969 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:45,970 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:45,982 - INFO - Epoch 17/50, Loss: 4.7675
2025-06-02 15:24:45,990 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:45,990 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:45,991 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:46,005 - INFO - Epoch 18/50, Loss: 4.6201
2025-06-02 15:24:46,011 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:46,012 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:46,013 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:46,028 - INFO - Epoch 19/50, Loss: 4.4528
2025-06-02 15:24:46,033 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:46,034 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:46,035 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:46,042 - INFO - Epoch 20/50, Loss: 4.2566
2025-06-02 15:24:46,046 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:46,047 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:46,047 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:46,054 - INFO - Epoch 21/50, Loss: 4.0321
2025-06-02 15:24:46,057 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:46,057 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:46,058 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:46,062 - INFO - Epoch 22/50, Loss: 3.7821
2025-06-02 15:24:46,065 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:46,065 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:46,066 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:46,070 - INFO - Epoch 23/50, Loss: 3.5095
2025-06-02 15:24:46,077 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:46,078 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:46,079 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:46,089 - INFO - Epoch 24/50, Loss: 3.2221
2025-06-02 15:24:46,096 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:46,097 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:46,098 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:46,109 - INFO - Epoch 25/50, Loss: 2.9951
2025-06-02 15:24:46,116 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:46,117 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:46,118 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:46,129 - INFO - Epoch 26/50, Loss: 2.7509
2025-06-02 15:24:46,135 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:46,136 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:46,137 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:46,147 - INFO - Epoch 27/50, Loss: 2.5135
2025-06-02 15:24:46,155 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:46,156 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:46,157 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:46,167 - INFO - Epoch 28/50, Loss: 2.2792
2025-06-02 15:24:46,173 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:46,174 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:46,175 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:46,185 - INFO - Epoch 29/50, Loss: 2.0551
2025-06-02 15:24:46,191 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:46,192 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:46,193 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:46,202 - INFO - Epoch 30/50, Loss: 1.8523
2025-06-02 15:24:46,209 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:46,209 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:46,211 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:46,222 - INFO - Epoch 31/50, Loss: 1.6918
2025-06-02 15:24:46,233 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:46,234 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:46,235 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:46,249 - INFO - Epoch 32/50, Loss: 1.6087
2025-06-02 15:24:46,257 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:46,258 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:46,259 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:46,269 - INFO - Epoch 33/50, Loss: 1.5488
2025-06-02 15:24:46,278 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:46,279 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:46,280 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:46,292 - INFO - Epoch 34/50, Loss: 1.5034
2025-06-02 15:24:46,298 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:46,299 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:46,300 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:46,313 - INFO - Epoch 35/50, Loss: 1.4739
2025-06-02 15:24:46,321 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:46,322 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:46,323 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:46,336 - INFO - Epoch 36/50, Loss: 1.4731
2025-06-02 15:24:46,344 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:46,345 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:46,346 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:46,353 - INFO - Epoch 37/50, Loss: 1.4470
2025-06-02 15:24:46,362 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:46,363 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:46,363 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:46,368 - INFO - Epoch 38/50, Loss: 1.4001
2025-06-02 15:24:46,375 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:46,376 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:46,376 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:46,381 - INFO - Epoch 39/50, Loss: 1.3487
2025-06-02 15:24:46,384 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:46,385 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:46,387 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:46,394 - INFO - Epoch 40/50, Loss: 1.2782
2025-06-02 15:24:46,399 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:46,399 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:46,400 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:46,406 - INFO - Epoch 41/50, Loss: 1.2172
2025-06-02 15:24:46,414 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:46,415 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:46,415 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:46,420 - INFO - Epoch 42/50, Loss: 1.1471
2025-06-02 15:24:46,427 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:46,427 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:46,428 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:46,439 - INFO - Epoch 43/50, Loss: 1.1003
2025-06-02 15:24:46,444 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:46,444 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:46,449 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:46,455 - INFO - Epoch 44/50, Loss: 1.0638
2025-06-02 15:24:46,460 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:46,460 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:46,461 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:46,468 - INFO - Epoch 45/50, Loss: 1.0261
2025-06-02 15:24:46,474 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:46,474 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:46,475 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:46,480 - INFO - Epoch 46/50, Loss: 1.0270
2025-06-02 15:24:46,483 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:46,484 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:46,484 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:46,492 - INFO - Epoch 47/50, Loss: 1.0280
2025-06-02 15:24:46,496 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:46,497 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:46,497 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:46,503 - INFO - Epoch 48/50, Loss: 1.0206
2025-06-02 15:24:46,507 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:46,507 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:46,508 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:46,512 - INFO - Epoch 49/50, Loss: 1.0281
2025-06-02 15:24:46,516 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:24:46,516 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:24:46,517 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:24:46,521 - INFO - Epoch 50/50, Loss: 1.0380
2025-06-02 15:24:46,521 - INFO - Initial training complete.
2025-06-02 15:24:46,521 - INFO - No checkpoint found. Starting from scratch.
2025-06-02 15:24:46,522 - INFO - Starting or resuming online updates from step: 0
2025-06-02 15:24:46,522 - INFO - No running statistics file found. Starting with new statistics.
2025-06-02 15:24:46,522 - INFO - Running anomaly detection...
2025-06-02 15:24:46,523 - INFO - Starting anomaly detection.
2025-06-02 15:24:46,528 - DEBUG - Node reconstruction errors: [0.27399737 0.8372325  0.90073705 0.31953964 0.31953952 0.21246196
 1.2253001 ]
2025-06-02 15:24:46,529 - DEBUG - Edge reconstruction errors: [ 7.294823  43.98708   44.206543  44.889122   5.8206224]
2025-06-02 15:24:46,530 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152446_update_1.json
2025-06-02 15:24:46,531 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:24:46,559 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152446_update_1.pth
2025-06-02 15:24:46,560 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869125.dot): 0.6157
2025-06-02 15:24:46,560 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-02 15:24:46,560 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-02 15:24:46,565 - DEBUG - Embedding standard deviations before t-SNE: [1.543184   0.         0.         0.41457394 0.         0.
 0.64084226 0.29906043 0.         0.42603308 0.         0.
 0.         0.         0.4102272  0.245215   0.         0.93411446
 0.         1.8299829  0.         0.6296526  0.         0.
 0.         0.         0.9909408  0.15700927 0.         0.
 0.856391   0.74150383]
2025-06-02 15:24:46,856 - DEBUG - Loaded backend module://backend_interagg version unknown.
2025-06-02 15:24:47,340 - INFO - Embeddings visualization saved to vis/embeddings_1_updates_20250602_152446.png
2025-06-02 15:24:47,340 - INFO - Performing visualization of node and edge features.
2025-06-02 15:24:47,340 - INFO - Starting visualization of node features.
2025-06-02 15:24:47,341 - INFO - Graph has 7 nodes and 30 features.
2025-06-02 15:24:47,341 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:24:47,341 - INFO - Calculating feature statistics:
2025-06-02 15:24:47,345 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:24:47,346 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:24:47,346 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:24:47,346 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:24:47,346 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:24:47,347 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:24:47,347 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:24:47,347 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:24:47,348 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:24:47,348 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 2, 'mean': np.float32(3.40598e-08), 'std': np.float32(1.0), 'min': np.float32(-1.5811388), 'max': np.float32(0.6324556)}
2025-06-02 15:24:47,348 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:24:47,349 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:24:47,349 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 2, 'mean': np.float32(2.5714285), 'std': np.float32(0.9035079), 'min': np.float32(2.0), 'max': np.float32(4.0)}
2025-06-02 15:24:47,349 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.4285715), 'std': np.float32(0.9035078), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:24:47,349 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 2, 'mean': np.float32(0.2857143), 'std': np.float32(0.45175397), 'min': np.float32(0.0), 'max': np.float32(1.0)}
2025-06-02 15:24:47,350 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 1, 'mean': np.float32(5.0), 'std': np.float32(0.0), 'min': np.float32(5.0), 'max': np.float32(5.0)}
2025-06-02 15:24:47,350 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 2, 'mean': np.float32(-3.40598e-08), 'std': np.float32(1.0), 'min': np.float32(-0.6324556), 'max': np.float32(1.5811388)}
2025-06-02 15:24:47,350 - INFO - - service_1: {'name': 'service_1', 'unique': 3, 'mean': np.float32(2.0), 'std': np.float32(0.75592893), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:24:47,351 - INFO - - service_2: {'name': 'service_2', 'unique': 2, 'mean': np.float32(7.142857), 'std': np.float32(2.0995626), 'min': np.float32(2.0), 'max': np.float32(8.0)}
2025-06-02 15:24:47,351 - INFO - - service_3: {'name': 'service_3', 'unique': 1, 'mean': np.float32(8.0), 'std': np.float32(0.0), 'min': np.float32(8.0), 'max': np.float32(8.0)}
2025-06-02 15:24:47,351 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 2, 'mean': np.float32(0.2857143), 'std': np.float32(0.45175397), 'min': np.float32(0.0), 'max': np.float32(1.0)}
2025-06-02 15:24:47,351 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 2, 'mean': np.float32(6.0), 'std': np.float32(3.1622777), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:24:47,352 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 2, 'mean': np.float32(-3.40598e-08), 'std': np.float32(1.0), 'min': np.float32(-0.6324556), 'max': np.float32(1.5811388)}
2025-06-02 15:24:47,352 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(-3.40598e-08), 'std': np.float32(1.0), 'min': np.float32(-0.6324556), 'max': np.float32(1.5811388)}
2025-06-02 15:24:47,353 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:24:47,353 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:24:47,354 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:24:47,354 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:24:47,354 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:24:47,355 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:24:47,449 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7f92a0251370>
2025-06-02 15:24:48,169 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:24:48,551 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:24:48,734 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:24:52,492 - INFO - Node feature visualization saved to vis/node_features_20250602_152449.png
2025-06-02 15:24:52,492 - INFO - Finished visualization of node features.
2025-06-02 15:24:52,492 - INFO - Performing additional feature analysis:
2025-06-02 15:24:52,493 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:24:52,493 - INFO - Starting visualization of edge features.
2025-06-02 15:24:52,494 - INFO - Graph has 5 edges and 10 edge features.
2025-06-02 15:24:52,494 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:24:52,494 - INFO - Calculating edge feature statistics:
2025-06-02 15:24:52,495 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:24:52,495 - INFO - - count: {'name': 'count', 'unique': 2, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.5), 'max': np.float32(2.0)}
2025-06-02 15:24:52,495 - INFO - - dst_port: {'name': 'dst_port', 'unique': 3, 'mean': np.float32(292.4), 'std': np.float32(184.64409), 'min': np.float32(53.0), 'max': np.float32(443.0)}
2025-06-02 15:24:52,496 - INFO - - protocol: {'name': 'protocol', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:24:52,496 - INFO - - service: {'name': 'service', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:24:52,496 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 5, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.9816251), 'max': np.float32(0.66214883)}
2025-06-02 15:24:52,496 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 5, 'mean': np.float32(-2.3841858e-08), 'std': np.float32(1.0), 'min': np.float32(-1.3328124), 'max': np.float32(1.2915914)}
2025-06-02 15:24:52,496 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 5, 'mean': np.float32(2.3841858e-08), 'std': np.float32(1.0), 'min': np.float32(-0.94280905), 'max': np.float32(1.8856181)}
2025-06-02 15:24:52,497 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 5, 'mean': np.float32(-1.1920929e-08), 'std': np.float32(1.0), 'min': np.float32(-0.9906747), 'max': np.float32(1.7452797)}
2025-06-02 15:24:52,497 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 5, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.9290494), 'max': np.float32(1.7669864)}
2025-06-02 15:24:52,497 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 4, 'mean': np.float32(4.7683717e-08), 'std': np.float32(1.0), 'min': np.float32(-1.0758876), 'max': np.float32(1.2000285)}
2025-06-02 15:24:52,566 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7f92a004fe90>
2025-06-02 15:24:52,771 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:24:52,849 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7f9291745400>
2025-06-02 15:24:53,184 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:24:53,680 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:24:54,318 - DEBUG - Plotted boxplots of the first 8 non-constant edge features.
2025-06-02 15:24:54,400 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:24:54,431 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:24:57,781 - INFO - Edge feature visualization saved to vis/edge_features_20250602_152454.png
2025-06-02 15:24:57,781 - INFO - Finished visualization of edge features.
2025-06-02 15:24:57,781 - INFO - Performing additional edge feature analysis:
2025-06-02 15:24:57,782 - INFO - - 2 out of 10 edge features are constant.
2025-06-02 15:24:57,782 - INFO - - Highest correlation (1.00) between features: 'total_resp_ip_bytes' and 'total_resp_bytes'.
2025-06-02 15:24:57,783 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:24:57,783 - INFO - Graph has 5 edges and 10 edge features.
2025-06-02 15:24:57,783 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:24:58,997 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_152457_summary.png
2025-06-02 15:24:59,615 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_152457_pca_3d.png
2025-06-02 15:25:00,080 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_152457_pca_variance.png
2025-06-02 15:25:00,081 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:25:00,081 - INFO - 
--- Processing file: nw_graph_encoded_1748869155.dot (Timestamp: 2025-06-02 14:59:15) ---
2025-06-02 15:25:00,081 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869155.dot
2025-06-02 15:25:00,081 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869155.dot'.
2025-06-02 15:25:00,081 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869155.dot
2025-06-02 15:25:00,082 - INFO - Parsed 19 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869155.dot'.
2025-06-02 15:25:00,084 - INFO - Parsed 26 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869155.dot'.
2025-06-02 15:25:00,084 - INFO - Processing node updates/additions.
2025-06-02 15:25:00,085 - INFO - Processing edge updates/additions.
2025-06-02 15:25:00,086 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:25:00,086 - INFO - Finished updating NetworkX graph.
2025-06-02 15:25:00,087 - DEBUG - Updated graph - Nodes: 19, Edges: 26
2025-06-02 15:25:00,087 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:25:00,087 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:25:00,091 - DEBUG - Initial node features tensor shape: torch.Size([19, 30])
2025-06-02 15:25:00,094 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:25:00,094 - DEBUG - Node features tensor shape after scaling: torch.Size([19, 30])
2025-06-02 15:25:00,095 - DEBUG - Edge index tensor shape: torch.Size([2, 26])
2025-06-02 15:25:00,095 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:25:00,096 - DEBUG - Initial edge attributes tensor shape: torch.Size([26, 10])
2025-06-02 15:25:00,098 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:25:00,099 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([26, 10])
2025-06-02 15:25:00,099 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:25:00,099 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:25:00,100 - INFO - Updated main graph to 19 nodes and 26 edges.
2025-06-02 15:25:00,100 - INFO - Performing online update...
2025-06-02 15:25:00,100 - INFO - Starting online update for 25 steps.
2025-06-02 15:25:00,106 - DEBUG - Initialized RunningStats with first batch: mean=1.1263157971072615, var=5.449233648754995, n=30
2025-06-02 15:25:00,107 - DEBUG - Updated RunningStats: new_mean=0.9033028665864676, new_var=177.90182608402392, new_n=60
2025-06-02 15:25:00,107 - DEBUG - Initialized RunningStats with first batch: mean=31.034616081072727, var=8668.326562534163, n=10
2025-06-02 15:25:00,107 - DEBUG - Updated RunningStats: new_mean=26.518711902774292, new_var=127579.09591087713, new_n=20
2025-06-02 15:25:00,108 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:25:00,108 - DEBUG - Online update step: 1/25
2025-06-02 15:25:00,108 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,108 - DEBUG - Online update step: 2/25
2025-06-02 15:25:00,109 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,109 - DEBUG - Online update step: 3/25
2025-06-02 15:25:00,109 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,109 - DEBUG - Online update step: 4/25
2025-06-02 15:25:00,109 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,109 - DEBUG - Online update step: 5/25
2025-06-02 15:25:00,110 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,110 - DEBUG - Online update step: 6/25
2025-06-02 15:25:00,110 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,110 - DEBUG - Online update step: 7/25
2025-06-02 15:25:00,110 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,110 - DEBUG - Online update step: 8/25
2025-06-02 15:25:00,111 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,111 - DEBUG - Online update step: 9/25
2025-06-02 15:25:00,111 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,111 - DEBUG - Online update step: 10/25
2025-06-02 15:25:00,111 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,111 - DEBUG - Online update step: 11/25
2025-06-02 15:25:00,112 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,112 - DEBUG - Online update step: 12/25
2025-06-02 15:25:00,112 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,113 - DEBUG - Online update step: 13/25
2025-06-02 15:25:00,113 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,113 - DEBUG - Online update step: 14/25
2025-06-02 15:25:00,113 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,114 - DEBUG - Online update step: 15/25
2025-06-02 15:25:00,114 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,114 - DEBUG - Online update step: 16/25
2025-06-02 15:25:00,114 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,114 - DEBUG - Online update step: 17/25
2025-06-02 15:25:00,114 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,115 - DEBUG - Online update step: 18/25
2025-06-02 15:25:00,115 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,115 - DEBUG - Online update step: 19/25
2025-06-02 15:25:00,115 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,115 - DEBUG - Online update step: 20/25
2025-06-02 15:25:00,115 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,115 - DEBUG - Online update step: 21/25
2025-06-02 15:25:00,116 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,116 - DEBUG - Online update step: 22/25
2025-06-02 15:25:00,116 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,116 - DEBUG - Online update step: 23/25
2025-06-02 15:25:00,116 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,117 - DEBUG - Online update step: 24/25
2025-06-02 15:25:00,117 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,117 - DEBUG - Online update step: 25/25
2025-06-02 15:25:00,117 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,117 - WARNING - No successful steps during online update.
2025-06-02 15:25:00,118 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -9.4112593e-09 -1.5685433e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.2741732e-09  1.2548346e-08  0.0000000e+00  3.7645037e-08
  2.5263157e+00  2.5789473e+00  2.1052632e-01  4.3157897e+00
 -1.2548346e-08  1.5789474e+00  7.3684211e+00  7.0000000e+00
  2.1052632e-01  8.0000000e+00  1.2548346e-08  1.2548346e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.8822519e-08  1.8822519e-08], current edge mean: [-3.2094810e-08  3.1034616e+02  0.0000000e+00  0.0000000e+00
 -1.3754918e-08 -1.1462432e-08 -9.1699457e-09 -1.3754918e-08
 -6.8774590e-09  9.1699457e-09]
2025-06-02 15:25:00,120 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -9.4112593e-09 -1.5685433e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.2741732e-09  1.2548346e-08  0.0000000e+00  3.7645037e-08
  2.5263157e+00  2.5789473e+00  2.1052632e-01  4.3157897e+00
 -1.2548346e-08  1.5789474e+00  7.3684211e+00  7.0000000e+00
  2.1052632e-01  8.0000000e+00  1.2548346e-08  1.2548346e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.8822519e-08  1.8822519e-08], edge=[-3.2094810e-08  3.1034616e+02  0.0000000e+00  0.0000000e+00
 -1.3754918e-08 -1.1462432e-08 -9.1699457e-09 -1.3754918e-08
 -6.8774590e-09  9.1699457e-09]
2025-06-02 15:25:00,121 - DEBUG - Updated reference std: node=[0.         0.         1.0274023  1.0274024  0.         0.
 0.         0.         1.0274024  1.0274024  1.0274023  1.0274024
 1.1239029  0.8377078  0.4188539  0.88522637 1.0274024  1.1212983
 1.9209524  2.3804762  0.4188539  0.         1.0274024  1.0274024
 0.         0.         0.         0.         1.0274024  1.0274024 ], edge=[  1.0198039 212.88945     0.          0.          1.0198039   1.0198039
   1.0198039   1.0198039   1.0198039   1.0198039]
2025-06-02 15:25:00,121 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:25:00,121 - INFO - Running anomaly detection...
2025-06-02 15:25:00,122 - INFO - Starting anomaly detection.
2025-06-02 15:25:00,126 - DEBUG - Node reconstruction errors: [0.7713298  1.7365487  2.084513   0.5377045  0.5377045  0.43563092
 2.0843558  0.9107545  0.9107545  1.0279583  0.9107545  0.87133443
 2.5046124  0.9309381  2.0582483  0.8713346  1.3276786  0.8713343
 1.0421176 ]
2025-06-02 15:25:00,127 - DEBUG - Edge reconstruction errors: [ 5.24909    7.6068215 44.159256   2.0567322 44.051464  44.166912
 44.453865   5.137297   2.0601528 58.819874  58.819874   5.57194
  7.186125   7.4578457 43.759995   8.276465  58.249367   2.030404
 46.247307  43.766228  43.759365  45.690456  44.64783   45.032375
 44.39883   44.1921   ]
2025-06-02 15:25:00,128 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152500_update_2.json
2025-06-02 15:25:00,128 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:25:00,143 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152500_update_2.pth
2025-06-02 15:25:00,143 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869155.dot): 0.6219
2025-06-02 15:25:00,143 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-02 15:25:00,143 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-02 15:25:00,144 - INFO - 
--- Processing file: nw_graph_encoded_1748869185.dot (Timestamp: 2025-06-02 14:59:45) ---
2025-06-02 15:25:00,144 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869185.dot
2025-06-02 15:25:00,144 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869185.dot'.
2025-06-02 15:25:00,144 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869185.dot
2025-06-02 15:25:00,146 - INFO - Parsed 32 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869185.dot'.
2025-06-02 15:25:00,149 - INFO - Parsed 45 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869185.dot'.
2025-06-02 15:25:00,149 - INFO - Processing node updates/additions.
2025-06-02 15:25:00,150 - INFO - Processing edge updates/additions.
2025-06-02 15:25:00,153 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:25:00,153 - INFO - Finished updating NetworkX graph.
2025-06-02 15:25:00,153 - DEBUG - Updated graph - Nodes: 32, Edges: 45
2025-06-02 15:25:00,154 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:25:00,154 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:25:00,161 - DEBUG - Initial node features tensor shape: torch.Size([32, 30])
2025-06-02 15:25:00,163 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:25:00,163 - DEBUG - Node features tensor shape after scaling: torch.Size([32, 30])
2025-06-02 15:25:00,164 - DEBUG - Edge index tensor shape: torch.Size([2, 45])
2025-06-02 15:25:00,164 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:25:00,166 - DEBUG - Initial edge attributes tensor shape: torch.Size([45, 10])
2025-06-02 15:25:00,168 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:25:00,169 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([45, 10])
2025-06-02 15:25:00,169 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:25:00,169 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:25:00,170 - INFO - Updated main graph to 32 nodes and 45 edges.
2025-06-02 15:25:00,170 - INFO - Performing online update...
2025-06-02 15:25:00,170 - INFO - Starting online update for 25 steps.
2025-06-02 15:25:00,171 - DEBUG - Updated RunningStats: new_mean=0.9831046891665598, new_var=10846.83337104342, new_n=90
2025-06-02 15:25:00,172 - DEBUG - Updated RunningStats: new_mean=0.8958028946660067, new_var=976227.2075093095, new_n=120
2025-06-02 15:25:00,172 - DEBUG - Updated RunningStats: new_mean=28.811734042174454, new_var=2652284.438954953, new_n=30
2025-06-02 15:25:00,172 - DEBUG - Updated RunningStats: new_mean=26.55844950795683, new_var=79601675.18801394, new_n=40
2025-06-02 15:25:00,173 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:25:00,173 - DEBUG - Online update step: 1/25
2025-06-02 15:25:00,173 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,173 - DEBUG - Online update step: 2/25
2025-06-02 15:25:00,173 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,174 - DEBUG - Online update step: 3/25
2025-06-02 15:25:00,174 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,174 - DEBUG - Online update step: 4/25
2025-06-02 15:25:00,174 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,174 - DEBUG - Online update step: 5/25
2025-06-02 15:25:00,174 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,175 - DEBUG - Online update step: 6/25
2025-06-02 15:25:00,175 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,175 - DEBUG - Online update step: 7/25
2025-06-02 15:25:00,175 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,175 - DEBUG - Online update step: 8/25
2025-06-02 15:25:00,175 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,176 - DEBUG - Online update step: 9/25
2025-06-02 15:25:00,176 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,176 - DEBUG - Online update step: 10/25
2025-06-02 15:25:00,176 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,176 - DEBUG - Online update step: 11/25
2025-06-02 15:25:00,176 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,177 - DEBUG - Online update step: 12/25
2025-06-02 15:25:00,177 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,177 - DEBUG - Online update step: 13/25
2025-06-02 15:25:00,177 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,177 - DEBUG - Online update step: 14/25
2025-06-02 15:25:00,177 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,178 - DEBUG - Online update step: 15/25
2025-06-02 15:25:00,178 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,178 - DEBUG - Online update step: 16/25
2025-06-02 15:25:00,178 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,178 - DEBUG - Online update step: 17/25
2025-06-02 15:25:00,178 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,179 - DEBUG - Online update step: 18/25
2025-06-02 15:25:00,179 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,179 - DEBUG - Online update step: 19/25
2025-06-02 15:25:00,179 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,179 - DEBUG - Online update step: 20/25
2025-06-02 15:25:00,179 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,179 - DEBUG - Online update step: 21/25
2025-06-02 15:25:00,180 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,180 - DEBUG - Online update step: 22/25
2025-06-02 15:25:00,180 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,180 - DEBUG - Online update step: 23/25
2025-06-02 15:25:00,180 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,180 - DEBUG - Online update step: 24/25
2025-06-02 15:25:00,181 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,181 - DEBUG - Online update step: 25/25
2025-06-02 15:25:00,181 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,181 - WARNING - No successful steps during online update.
2025-06-02 15:25:00,182 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -7.4505806e-09  7.4505806e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.9802322e-08  0.0000000e+00  2.9802322e-08 -2.9802322e-08
  2.5000000e+00  2.6875000e+00  1.2500000e-01  4.3125000e+00
  0.0000000e+00  1.5625000e+00  7.1875000e+00  7.7812500e+00
  1.2500000e-01  8.0000000e+00 -3.7252903e-08  4.4703484e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -7.4505806e-09  0.0000000e+00], current edge mean: [ 2.1192763e-08  3.3397778e+02  0.0000000e+00  0.0000000e+00
 -1.3245477e-08 -5.2981908e-09  0.0000000e+00  2.6490954e-09
  1.3245477e-09  0.0000000e+00]
2025-06-02 15:25:00,183 - DEBUG - Node drift difference: 0.3282, Edge drift difference: 0.1110
2025-06-02 15:25:00,183 - WARNING - Feature drift detected (1 consecutive)
2025-06-02 15:25:00,184 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -7.4505806e-09  7.4505806e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.9802322e-08  0.0000000e+00  2.9802322e-08 -2.9802322e-08
  2.5000000e+00  2.6875000e+00  1.2500000e-01  4.3125000e+00
  0.0000000e+00  1.5625000e+00  7.1875000e+00  7.7812500e+00
  1.2500000e-01  8.0000000e+00 -3.7252903e-08  4.4703484e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -7.4505806e-09  0.0000000e+00], edge=[ 2.1192763e-08  3.3397778e+02  0.0000000e+00  0.0000000e+00
 -1.3245477e-08 -5.2981908e-09  0.0000000e+00  2.6490954e-09
  1.3245477e-09  0.0000000e+00]
2025-06-02 15:25:00,185 - DEBUG - Updated reference std: node=[0.         0.         1.016001   1.016001   0.         0.
 0.         0.         1.016001   1.016001   1.016001   1.016001
 1.016001   0.73780406 0.33601075 0.89577866 1.016001   1.0757593
 2.206113   1.2374369  0.33601075 0.         1.016001   1.016001
 0.         0.         0.         0.         1.016001   1.016001  ], edge=[  1.0112998 190.90686     0.          0.          1.0112997   1.0112998
   1.0112997   1.0112998   1.0112998   1.0112998]
2025-06-02 15:25:00,185 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:25:00,185 - INFO - Running anomaly detection...
2025-06-02 15:25:00,186 - INFO - Starting anomaly detection.
2025-06-02 15:25:00,191 - DEBUG - Node reconstruction errors: [0.8154706  1.8258387  2.4121287  0.6459834  0.6459834  0.54324925
 2.5717547  1.0261608  1.0261607  1.137303   1.0261608  0.9611319
 3.5072033  0.86616683 0.8558777  0.96113163 1.4108065  0.9611319
 1.11898    0.89944464 0.96388954 0.8558777  1.0720347  0.89944464
 0.8558777  0.6393603  0.8558773  0.89460355 0.9638898  0.8558777
 0.8994445  1.0720351 ]
2025-06-02 15:25:00,192 - DEBUG - Edge reconstruction errors: [ 5.229706   7.793317  44.125893   2.2811213  5.068424  44.105556
 44.119164  44.154144   5.1687913  2.281235  58.564857  58.564857
 46.34927    7.7909937 44.11757   44.27825    5.6058693  7.0159564
  7.770536  44.072075   7.8918543 58.48987    2.2704606 46.312164
  7.790132  44.118996  44.074654  44.07201   44.3086    44.15405
 44.221165  44.12675   44.113716  46.23307   44.433647  44.23547
 44.145535  44.115383  44.123173  44.107338   9.998259  44.11975
 44.122047  44.716366  44.08366  ]
2025-06-02 15:25:00,193 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152500_update_3.json
2025-06-02 15:25:00,194 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:25:00,207 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152500_update_3.pth
2025-06-02 15:25:00,207 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869185.dot): 0.6098
2025-06-02 15:25:00,208 - WARNING - Detected 1 anomalous nodes (reconstruction-based):
2025-06-02 15:25:00,208 - WARNING -   Node ID: 192.168.27.10, Recon Error: 3.5072, MLP Score: 0.4822
2025-06-02 15:25:00,208 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-02 15:25:00,208 - INFO - 
--- Processing file: nw_graph_encoded_1748869215.dot (Timestamp: 2025-06-02 15:00:15) ---
2025-06-02 15:25:00,208 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869215.dot
2025-06-02 15:25:00,209 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869215.dot'.
2025-06-02 15:25:00,209 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869215.dot
2025-06-02 15:25:00,211 - INFO - Parsed 49 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869215.dot'.
2025-06-02 15:25:00,215 - INFO - Parsed 66 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869215.dot'.
2025-06-02 15:25:00,215 - INFO - Processing node updates/additions.
2025-06-02 15:25:00,217 - INFO - Processing edge updates/additions.
2025-06-02 15:25:00,221 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:25:00,222 - INFO - Finished updating NetworkX graph.
2025-06-02 15:25:00,223 - DEBUG - Updated graph - Nodes: 49, Edges: 66
2025-06-02 15:25:00,223 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:25:00,224 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:25:00,237 - DEBUG - Initial node features tensor shape: torch.Size([49, 30])
2025-06-02 15:25:00,239 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:25:00,240 - DEBUG - Node features tensor shape after scaling: torch.Size([49, 30])
2025-06-02 15:25:00,241 - DEBUG - Edge index tensor shape: torch.Size([2, 66])
2025-06-02 15:25:00,241 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:25:00,245 - DEBUG - Initial edge attributes tensor shape: torch.Size([66, 10])
2025-06-02 15:25:00,247 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:25:00,247 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([66, 10])
2025-06-02 15:25:00,248 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:25:00,248 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:25:00,248 - INFO - Updated main graph to 49 nodes and 66 edges.
2025-06-02 15:25:00,249 - INFO - Performing online update...
2025-06-02 15:25:00,249 - INFO - Starting online update for 25 steps.
2025-06-02 15:25:00,250 - DEBUG - Updated RunningStats: new_mean=0.948070886640343, new_var=117147441.79238482, new_n=150
2025-06-02 15:25:00,251 - DEBUG - Updated RunningStats: new_mean=0.9018458811016488, new_var=17572116280.104534, new_n=180
2025-06-02 15:25:00,251 - DEBUG - Updated RunningStats: new_mean=28.307668419444663, new_var=3184179796.4487815, new_n=50
2025-06-02 15:25:00,251 - DEBUG - Updated RunningStats: new_mean=26.60214037147173, new_var=159209017604.0077, new_n=60
2025-06-02 15:25:00,252 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:25:00,252 - DEBUG - Online update step: 1/25
2025-06-02 15:25:00,253 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,253 - DEBUG - Online update step: 2/25
2025-06-02 15:25:00,253 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,253 - DEBUG - Online update step: 3/25
2025-06-02 15:25:00,253 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,254 - DEBUG - Online update step: 4/25
2025-06-02 15:25:00,254 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,254 - DEBUG - Online update step: 5/25
2025-06-02 15:25:00,254 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,255 - DEBUG - Online update step: 6/25
2025-06-02 15:25:00,255 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,255 - DEBUG - Online update step: 7/25
2025-06-02 15:25:00,255 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,256 - DEBUG - Online update step: 8/25
2025-06-02 15:25:00,256 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,256 - DEBUG - Online update step: 9/25
2025-06-02 15:25:00,256 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,256 - DEBUG - Online update step: 10/25
2025-06-02 15:25:00,257 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,257 - DEBUG - Online update step: 11/25
2025-06-02 15:25:00,257 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,257 - DEBUG - Online update step: 12/25
2025-06-02 15:25:00,258 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,258 - DEBUG - Online update step: 13/25
2025-06-02 15:25:00,258 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,258 - DEBUG - Online update step: 14/25
2025-06-02 15:25:00,259 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,259 - DEBUG - Online update step: 15/25
2025-06-02 15:25:00,259 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,259 - DEBUG - Online update step: 16/25
2025-06-02 15:25:00,260 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,260 - DEBUG - Online update step: 17/25
2025-06-02 15:25:00,260 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,260 - DEBUG - Online update step: 18/25
2025-06-02 15:25:00,261 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,261 - DEBUG - Online update step: 19/25
2025-06-02 15:25:00,261 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,261 - DEBUG - Online update step: 20/25
2025-06-02 15:25:00,262 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,262 - DEBUG - Online update step: 21/25
2025-06-02 15:25:00,262 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,262 - DEBUG - Online update step: 22/25
2025-06-02 15:25:00,263 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,263 - DEBUG - Online update step: 23/25
2025-06-02 15:25:00,263 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,264 - DEBUG - Online update step: 24/25
2025-06-02 15:25:00,264 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,264 - DEBUG - Online update step: 25/25
2025-06-02 15:25:00,264 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,265 - WARNING - No successful steps during online update.
2025-06-02 15:25:00,267 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  1.3380634e-08  1.5813477e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -4.8656852e-09 -2.4328427e-08 -9.7313704e-09  3.8925482e-08
  2.7959185e+00  2.7959185e+00  1.0204082e-01  4.4489794e+00
  2.9194112e-08  1.3673469e+00  7.3673468e+00  7.7346940e+00
  1.0204082e-01  8.0000000e+00  9.7313704e-09 -4.8656855e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -4.8656852e-09  2.4328427e-08], current edge mean: [-1.4449611e-08  3.5304544e+02  0.0000000e+00  0.0000000e+00
  3.6124028e-09 -3.6124028e-09  9.0310071e-09 -7.2248056e-09
 -7.2248056e-09  0.0000000e+00]
2025-06-02 15:25:00,267 - DEBUG - Node drift difference: 0.2913, Edge drift difference: 0.0999
2025-06-02 15:25:00,268 - WARNING - Feature drift detected (2 consecutive)
2025-06-02 15:25:00,269 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  1.3380634e-08  1.5813477e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -4.8656852e-09 -2.4328427e-08 -9.7313704e-09  3.8925482e-08
  2.7959185e+00  2.7959185e+00  1.0204082e-01  4.4489794e+00
  2.9194112e-08  1.3673469e+00  7.3673468e+00  7.7346940e+00
  1.0204082e-01  8.0000000e+00  9.7313704e-09 -4.8656855e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -4.8656852e-09  2.4328427e-08], edge=[-1.4449611e-08  3.5304544e+02  0.0000000e+00  0.0000000e+00
  3.6124028e-09 -3.6124028e-09  9.0310071e-09 -7.2248056e-09
 -7.2248056e-09  0.0000000e+00]
2025-06-02 15:25:00,271 - DEBUG - Updated reference std: node=[0.         0.         1.010363   1.010363   0.         0.
 0.         1.010363   1.010363   1.010363   1.010363   1.010363
 1.6953317  0.61167777 0.30583888 0.81805724 1.010363   1.0346875
 1.9223887  1.3034492  0.30583888 0.         1.010363   1.010363
 0.         0.         0.         0.         1.010363   1.010363  ], edge=[  1.007663  173.69136     0.          0.          1.007663    1.007663
   1.0076629   1.0076629   1.007663    1.007663 ]
2025-06-02 15:25:00,271 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:25:00,271 - INFO - Running anomaly detection...
2025-06-02 15:25:00,272 - INFO - Starting anomaly detection.
2025-06-02 15:25:00,280 - DEBUG - Node reconstruction errors: [0.81209123 2.1504676  3.3452618  0.67380214 0.6738021  0.57263553
 3.15734    1.0976878  1.097688   1.2177835  1.097688   0.9897996
 5.519792   1.5439527  0.6896398  0.9897996  1.4365913  0.9897996
 1.2494303  0.7547228  0.86832744 0.68964005 0.9796898  0.7547228
 0.77560276 0.5543868  0.7756029  2.6265936  0.86832744 0.7756029
 0.7547228  0.97968966 1.0665005  0.39208928 0.51878065 1.009777
 0.41158783 0.7547228  0.69095194 0.91139483 1.2413427  1.009777
 0.7547228  0.7801717  0.7811479  1.0097774  1.8142751  2.7794254
 1.1762205 ]
2025-06-02 15:25:00,282 - DEBUG - Edge reconstruction errors: [ 5.2259207  7.8392277 44.15513    2.3295836  5.2343154 44.142467
 44.182304  44.14397   44.142395  44.146614  44.158154   5.284151
  2.3288803 58.57589   58.57589   46.36811    7.864713  44.201237
 44.211533   5.523584   6.7818985 44.141144   7.8273    44.12852
  7.8970585 58.537792   2.3214483 46.348408   7.837197  44.282722
 44.131355  44.1285    44.24311   44.16738   44.184544  44.156235
 44.14857   46.46783   44.31689   44.289158  44.16592   44.303673
 44.303673  44.141144  44.279842  44.151485  44.195576   8.638689
 44.15219   44.15155   44.423683  44.136005  10.820042  13.627206
  7.8417306 44.12747   44.1285    44.12852   44.13077   44.17232
 44.21737   44.149956  44.161457  44.151543  44.238262  44.130234 ]
2025-06-02 15:25:00,289 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152500_update_4.json
2025-06-02 15:25:00,290 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:25:00,321 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152500_update_4.pth
2025-06-02 15:25:00,321 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869215.dot): 0.6293
2025-06-02 15:25:00,322 - WARNING - Detected 1 anomalous nodes (reconstruction-based):
2025-06-02 15:25:00,323 - WARNING -   Node ID: 192.168.27.10, Recon Error: 5.5198, MLP Score: 0.4819
2025-06-02 15:25:00,324 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-02 15:25:00,325 - INFO - 
--- Processing file: nw_graph_encoded_1748869245.dot (Timestamp: 2025-06-02 15:00:45) ---
2025-06-02 15:25:00,325 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869245.dot
2025-06-02 15:25:00,325 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869245.dot'.
2025-06-02 15:25:00,326 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869245.dot
2025-06-02 15:25:00,329 - INFO - Parsed 54 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869245.dot'.
2025-06-02 15:25:00,337 - INFO - Parsed 71 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869245.dot'.
2025-06-02 15:25:00,337 - INFO - Processing node updates/additions.
2025-06-02 15:25:00,340 - INFO - Processing edge updates/additions.
2025-06-02 15:25:00,346 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:25:00,347 - INFO - Finished updating NetworkX graph.
2025-06-02 15:25:00,347 - DEBUG - Updated graph - Nodes: 54, Edges: 71
2025-06-02 15:25:00,347 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:25:00,348 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:25:00,359 - DEBUG - Initial node features tensor shape: torch.Size([54, 30])
2025-06-02 15:25:00,361 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:25:00,362 - DEBUG - Node features tensor shape after scaling: torch.Size([54, 30])
2025-06-02 15:25:00,362 - DEBUG - Edge index tensor shape: torch.Size([2, 71])
2025-06-02 15:25:00,363 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:25:00,366 - DEBUG - Initial edge attributes tensor shape: torch.Size([71, 10])
2025-06-02 15:25:00,369 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:25:00,369 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([71, 10])
2025-06-02 15:25:00,370 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:25:00,370 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:25:00,371 - INFO - Updated main graph to 54 nodes and 71 edges.
2025-06-02 15:25:00,371 - INFO - Performing online update...
2025-06-02 15:25:00,371 - INFO - Starting online update for 25 steps.
2025-06-02 15:25:00,372 - DEBUG - Updated RunningStats: new_mean=0.9395010550904108, new_var=1800000000176.674, new_n=210
2025-06-02 15:25:00,373 - DEBUG - Updated RunningStats: new_mean=0.9074599084831132, new_var=2100000000011.152, new_n=240
2025-06-02 15:25:00,373 - DEBUG - Updated RunningStats: new_mean=27.72758926003723, new_var=600000107532.0767, new_n=70
2025-06-02 15:25:00,374 - DEBUG - Updated RunningStats: new_mean=26.550317850891304, new_var=700000028422.51, new_n=80
2025-06-02 15:25:00,374 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:25:00,374 - DEBUG - Online update step: 1/25
2025-06-02 15:25:00,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,374 - DEBUG - Online update step: 2/25
2025-06-02 15:25:00,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,375 - DEBUG - Online update step: 3/25
2025-06-02 15:25:00,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,375 - DEBUG - Online update step: 4/25
2025-06-02 15:25:00,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,375 - DEBUG - Online update step: 5/25
2025-06-02 15:25:00,376 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,376 - DEBUG - Online update step: 6/25
2025-06-02 15:25:00,376 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,376 - DEBUG - Online update step: 7/25
2025-06-02 15:25:00,376 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,377 - DEBUG - Online update step: 8/25
2025-06-02 15:25:00,377 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,377 - DEBUG - Online update step: 9/25
2025-06-02 15:25:00,377 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,377 - DEBUG - Online update step: 10/25
2025-06-02 15:25:00,377 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,377 - DEBUG - Online update step: 11/25
2025-06-02 15:25:00,378 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,378 - DEBUG - Online update step: 12/25
2025-06-02 15:25:00,378 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,378 - DEBUG - Online update step: 13/25
2025-06-02 15:25:00,378 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,378 - DEBUG - Online update step: 14/25
2025-06-02 15:25:00,379 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,379 - DEBUG - Online update step: 15/25
2025-06-02 15:25:00,379 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,379 - DEBUG - Online update step: 16/25
2025-06-02 15:25:00,379 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,379 - DEBUG - Online update step: 17/25
2025-06-02 15:25:00,380 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,380 - DEBUG - Online update step: 18/25
2025-06-02 15:25:00,380 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,380 - DEBUG - Online update step: 19/25
2025-06-02 15:25:00,380 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,380 - DEBUG - Online update step: 20/25
2025-06-02 15:25:00,381 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,381 - DEBUG - Online update step: 21/25
2025-06-02 15:25:00,381 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,381 - DEBUG - Online update step: 22/25
2025-06-02 15:25:00,381 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,381 - DEBUG - Online update step: 23/25
2025-06-02 15:25:00,382 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,382 - DEBUG - Online update step: 24/25
2025-06-02 15:25:00,382 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,382 - DEBUG - Online update step: 25/25
2025-06-02 15:25:00,382 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,382 - WARNING - No successful steps during online update.
2025-06-02 15:25:00,384 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  4.8566747e-08 -6.6227384e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.3245477e-08
  0.0000000e+00 -2.6490953e-08  2.6490953e-08 -8.8303178e-09
  2.9444444e+00  2.8148148e+00  1.8518518e-01  4.4444447e+00
  2.6490953e-08  1.3333334e+00  7.2962961e+00  7.7592592e+00
  1.8518518e-01  8.0000000e+00  3.9736431e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -7.0642542e-08], current edge mean: [ 0.0000000e+00  3.4480283e+02  0.0000000e+00  0.0000000e+00
 -6.7160162e-09  1.0074024e-08  0.0000000e+00 -1.0074024e-08
 -6.7160162e-09  0.0000000e+00]
2025-06-02 15:25:00,384 - DEBUG - Node drift difference: 0.2719, Edge drift difference: 0.0475
2025-06-02 15:25:00,385 - WARNING - Feature drift detected (3 consecutive)
2025-06-02 15:25:00,385 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-02 15:25:00,385 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-02 15:25:00,385 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-02 15:25:00,386 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-02 15:25:00,386 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-02 15:25:00,386 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-02 15:25:00,387 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-02 15:25:00,387 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-02 15:25:00,387 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-02 15:25:00,387 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-02 15:25:00,388 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-02 15:25:00,388 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-02 15:25:00,389 - INFO - Optimizer and scheduler reset.
2025-06-02 15:25:00,390 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  4.8566747e-08 -6.6227384e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.3245477e-08
  0.0000000e+00 -2.6490953e-08  2.6490953e-08 -8.8303178e-09
  2.9444444e+00  2.8148148e+00  1.8518518e-01  4.4444447e+00
  2.6490953e-08  1.3333334e+00  7.2962961e+00  7.7592592e+00
  1.8518518e-01  8.0000000e+00  3.9736431e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -7.0642542e-08], edge=[ 0.0000000e+00  3.4480283e+02  0.0000000e+00  0.0000000e+00
 -6.7160162e-09  1.0074024e-08  0.0000000e+00 -1.0074024e-08
 -6.7160162e-09  0.0000000e+00]
2025-06-02 15:25:00,391 - DEBUG - Updated reference std: node=[0.         0.         1.0093899  1.0093899  0.         0.
 0.         1.0093899  1.0093899  1.0093899  1.0093899  1.0093899
 1.7420079  0.58516484 0.47875917 0.7930516  1.0093899  1.0279124
 2.0339537  1.2428693  0.47875917 0.         1.0093899  1.0093899
 0.         0.         0.         0.         1.0093899  1.0093899 ], edge=[  1.0071175 176.04436     0.          0.          1.0071175   1.0071175
   1.0071175   1.0071175   1.0071175   1.0071175]
2025-06-02 15:25:00,392 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:25:00,392 - INFO - Running anomaly detection...
2025-06-02 15:25:00,392 - INFO - Starting anomaly detection.
2025-06-02 15:25:00,397 - DEBUG - Node reconstruction errors: [12.940183  13.187517  14.966456  14.880442  14.880442  13.550112
 14.071944  13.846204  13.846203  15.041337  13.846204  11.298242
 12.490243   8.0111685 11.436629  11.298243  14.013803  11.29824
 11.39894   10.616212  13.174865  11.436629  14.393591  10.616211
 11.688448  16.055122  11.688449  10.88343   13.174867  11.68845
  7.886859  14.393591  10.469202  14.691576  16.594967  11.291713
 15.180879  10.616212  10.9845295 10.113999  13.213018  11.291713
 10.616212  12.637202  12.184954  13.064347  15.200967  17.716429
 13.075248  19.639212  20.31189   14.283331  15.8784685 10.832894 ]
2025-06-02 15:25:00,398 - DEBUG - Edge reconstruction errors: [ 4.24372    6.8325315 43.200138   1.412332   4.230937  43.133514
 43.172997  43.135014  43.133434  43.13773   43.149437   4.3490686
  1.4328444 57.566673  57.566673  45.358963   6.85785   43.19161
 43.20235   43.150635   5.371083   5.6711154 43.131416   6.82251
 43.119473   6.8899717 57.528645   1.5147067 45.339302   6.832633
 43.272003  43.121773  43.119453  43.233025  43.15865   43.17606
 43.147457  43.139675  45.50967   43.308556  43.279865  43.156483
 43.295506  43.295506  43.131416  43.270535  43.142548  43.18615
  7.6401906  7.289146  43.14338   43.142693  43.4202    43.126373
  9.851128  12.618259   6.837388  43.11843   43.119453  43.119473
 43.12124   43.163567  43.293346  43.141136  43.152718  43.194458
 43.23091   43.121147  43.144108   6.8279796 12.220121 ]
2025-06-02 15:25:00,401 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152500_update_5.json
2025-06-02 15:25:00,401 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:25:00,416 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152500_update_5.pth
2025-06-02 15:25:00,417 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869245.dot): 0.0004
2025-06-02 15:25:00,417 - WARNING - Detected 2 anomalous nodes (reconstruction-based):
2025-06-02 15:25:00,417 - WARNING -   Node ID: ff02::2, Recon Error: 19.6392, MLP Score: 0.0003
2025-06-02 15:25:00,417 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 20.3119, MLP Score: 0.0003
2025-06-02 15:25:00,418 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-02 15:25:00,418 - INFO - 
--- Processing file: nw_graph_encoded_1748869275.dot (Timestamp: 2025-06-02 15:01:15) ---
2025-06-02 15:25:00,418 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869275.dot
2025-06-02 15:25:00,418 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869275.dot'.
2025-06-02 15:25:00,418 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869275.dot
2025-06-02 15:25:00,421 - INFO - Parsed 62 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869275.dot'.
2025-06-02 15:25:00,428 - INFO - Parsed 86 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869275.dot'.
2025-06-02 15:25:00,428 - INFO - Processing node updates/additions.
2025-06-02 15:25:00,431 - INFO - Processing edge updates/additions.
2025-06-02 15:25:00,438 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:25:00,439 - INFO - Finished updating NetworkX graph.
2025-06-02 15:25:00,439 - DEBUG - Updated graph - Nodes: 62, Edges: 86
2025-06-02 15:25:00,439 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:25:00,440 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:25:00,453 - DEBUG - Initial node features tensor shape: torch.Size([62, 30])
2025-06-02 15:25:00,455 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:25:00,456 - DEBUG - Node features tensor shape after scaling: torch.Size([62, 30])
2025-06-02 15:25:00,456 - DEBUG - Edge index tensor shape: torch.Size([2, 86])
2025-06-02 15:25:00,457 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:25:00,461 - DEBUG - Initial edge attributes tensor shape: torch.Size([86, 10])
2025-06-02 15:25:00,463 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:25:00,463 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([86, 10])
2025-06-02 15:25:00,464 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:25:00,464 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:25:00,465 - INFO - Updated main graph to 62 nodes and 86 edges.
2025-06-02 15:25:00,465 - INFO - Performing online update...
2025-06-02 15:25:00,465 - INFO - Starting online update for 25 steps.
2025-06-02 15:25:00,466 - DEBUG - Updated RunningStats: new_mean=0.9345282815010671, new_var=2400000000173.375, new_n=270
2025-06-02 15:25:00,467 - DEBUG - Updated RunningStats: new_mean=0.9103535389801057, new_var=2700000000011.498, new_n=300
2025-06-02 15:25:00,467 - DEBUG - Updated RunningStats: new_mean=27.39446859625072, new_var=800000105458.7961, new_n=90
2025-06-02 15:25:00,468 - DEBUG - Updated RunningStats: new_mean=26.5187596297302, new_var=900000029383.9722, new_n=100
2025-06-02 15:25:00,468 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:25:00,468 - DEBUG - Online update step: 1/25
2025-06-02 15:25:00,468 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,469 - DEBUG - Online update step: 2/25
2025-06-02 15:25:00,469 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,469 - DEBUG - Online update step: 3/25
2025-06-02 15:25:00,469 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,469 - DEBUG - Online update step: 4/25
2025-06-02 15:25:00,469 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,470 - DEBUG - Online update step: 5/25
2025-06-02 15:25:00,470 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,470 - DEBUG - Online update step: 6/25
2025-06-02 15:25:00,470 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,470 - DEBUG - Online update step: 7/25
2025-06-02 15:25:00,470 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,470 - DEBUG - Online update step: 8/25
2025-06-02 15:25:00,471 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,471 - DEBUG - Online update step: 9/25
2025-06-02 15:25:00,471 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,471 - DEBUG - Online update step: 10/25
2025-06-02 15:25:00,471 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,471 - DEBUG - Online update step: 11/25
2025-06-02 15:25:00,472 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,472 - DEBUG - Online update step: 12/25
2025-06-02 15:25:00,472 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,472 - DEBUG - Online update step: 13/25
2025-06-02 15:25:00,472 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,472 - DEBUG - Online update step: 14/25
2025-06-02 15:25:00,473 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,473 - DEBUG - Online update step: 15/25
2025-06-02 15:25:00,473 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,473 - DEBUG - Online update step: 16/25
2025-06-02 15:25:00,473 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,473 - DEBUG - Online update step: 17/25
2025-06-02 15:25:00,474 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,474 - DEBUG - Online update step: 18/25
2025-06-02 15:25:00,474 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,474 - DEBUG - Online update step: 19/25
2025-06-02 15:25:00,474 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,474 - DEBUG - Online update step: 20/25
2025-06-02 15:25:00,475 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,475 - DEBUG - Online update step: 21/25
2025-06-02 15:25:00,475 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,475 - DEBUG - Online update step: 22/25
2025-06-02 15:25:00,475 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,475 - DEBUG - Online update step: 23/25
2025-06-02 15:25:00,475 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,476 - DEBUG - Online update step: 24/25
2025-06-02 15:25:00,476 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,476 - DEBUG - Online update step: 25/25
2025-06-02 15:25:00,476 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:00,476 - WARNING - No successful steps during online update.
2025-06-02 15:25:00,477 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00  4.03773406e-08  8.65228742e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00 -4.61455301e-08
 -1.53818434e-08  3.07636867e-08 -1.73045738e-08 -1.92273042e-08
  2.98387098e+00  2.74193549e+00  1.45161286e-01  4.45161295e+00
 -3.07636867e-08  1.25806451e+00  7.22580624e+00  7.58064508e+00
  1.45161286e-01  8.00000000e+00  3.84546084e-08  1.15363825e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  7.69092168e-09  5.76819126e-08], current edge mean: [-1.6633855e-08  3.4147675e+02  0.0000000e+00  0.0000000e+00
  4.1584638e-09 -4.1584638e-09  8.3169276e-09  7.6238500e-09
 -7.9703888e-09 -5.5446181e-09]
2025-06-02 15:25:00,478 - DEBUG - Node drift difference: 0.1437, Edge drift difference: 0.0189
2025-06-02 15:25:00,479 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00  4.03773406e-08  8.65228742e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00 -4.61455301e-08
 -1.53818434e-08  3.07636867e-08 -1.73045738e-08 -1.92273042e-08
  2.98387098e+00  2.74193549e+00  1.45161286e-01  4.45161295e+00
 -3.07636867e-08  1.25806451e+00  7.22580624e+00  7.58064508e+00
  1.45161286e-01  8.00000000e+00  3.84546084e-08  1.15363825e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  7.69092168e-09  5.76819126e-08], edge=[-1.6633855e-08  3.4147675e+02  0.0000000e+00  0.0000000e+00
  4.1584638e-09 -4.1584638e-09  8.3169276e-09  7.6238500e-09
 -7.9703888e-09 -5.5446181e-09]
2025-06-02 15:25:00,480 - DEBUG - Updated reference std: node=[0.         0.         1.0081633  1.0081635  0.         0.
 0.         1.0081633  1.0081635  1.0081635  1.0081635  1.0081635
 1.6936907  0.6759446  0.43783274 0.78254354 1.0081635  0.9907024
 2.051943   1.6149749  0.43783274 0.         1.0081635  1.0081633
 0.         0.         0.         0.         1.0081635  1.0081635 ], edge=[  1.0058651 179.33273     0.          0.          1.0058652   1.0058652
   1.0058652   1.0058652   1.0058651   1.0058651]
2025-06-02 15:25:00,480 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:25:00,480 - INFO - Running anomaly detection...
2025-06-02 15:25:00,481 - INFO - Starting anomaly detection.
2025-06-02 15:25:00,495 - DEBUG - Node reconstruction errors: [11.88783   12.341244  13.8272085 12.48589   12.48589   11.318521
  9.051185  13.955263  13.955263  15.147838  13.955263  10.49092
 12.033611   8.232281  11.723994  11.397688  14.128223  11.39769
 11.351839  10.860001  13.41818   11.723994  14.635238  10.860001
 11.836796  13.432151  11.836795  11.370101  13.418182  11.836795
  8.001485  14.635239  10.605372  14.133646  15.902835  11.471013
 14.532465  10.860001  11.247867  10.377626  13.389607  11.471014
 10.860001  12.924044  12.448362  13.183048  15.468202  17.833658
 13.1850605 19.64516   20.247507  14.398083  13.171245  10.993563
 12.010144  11.732071  10.8029    10.632552   9.930873  11.683585
  9.329946  13.414153 ]
2025-06-02 15:25:00,497 - DEBUG - Edge reconstruction errors: [ 4.375969   6.8334303 43.287804   1.4288222  4.2626953 43.1342
 43.17655   43.13582    6.828047  43.134117  43.13878   43.15148
  4.4012976  1.5374188 57.569542  57.569542  45.36133    6.9016533
 43.38584   43.208183  43.152763   6.8250875 43.13243   43.125065
 43.18415   43.139397   5.644187   5.738884  43.131626   6.822111
 43.119064   6.8934865 57.52883    1.5003016 45.34029    6.8333483
 43.281986  43.121387  43.192585  43.56428   43.24063   43.161293
 43.18023   43.149246  43.14083   45.71198   43.32263   43.291332
 43.1587    43.461063  43.461063  43.131626  43.281307  43.143894
 43.190517   7.7061725  7.3275456 43.144844  43.144096  43.445194
 43.12629   10.103212  12.617778   6.8380413 43.11796   43.119045
 43.119064  43.120842  43.166588  43.30593   43.14249   43.15493
 43.19966   43.239555  43.120846  43.145695   6.827819  43.119095
 43.172447  12.219735   1.4492171 57.522938   1.4326729 45.329697
 43.13199    6.825666 ]
2025-06-02 15:25:00,503 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152500_update_6.json
2025-06-02 15:25:00,503 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:25:00,517 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152500_update_6.pth
2025-06-02 15:25:00,517 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869275.dot): 0.0006
2025-06-02 15:25:00,517 - WARNING - Detected 2 anomalous nodes (reconstruction-based):
2025-06-02 15:25:00,518 - WARNING -   Node ID: ff02::2, Recon Error: 19.6452, MLP Score: 0.0003
2025-06-02 15:25:00,518 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 20.2475, MLP Score: 0.0003
2025-06-02 15:25:00,518 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-02 15:25:00,547 - DEBUG - Embedding standard deviations before t-SNE: [0.8550621  0.01339159 0.         0.6514239  0.         0.
 0.35391858 0.6278976  0.         0.8705124  0.         0.
 0.         0.         0.7865056  0.61120963 0.05173773 0.98009187
 0.         0.86338836 0.         0.69644994 0.         0.
 0.         0.         0.7536057  0.61273384 0.         0.
 0.9310528  0.54571486]
2025-06-02 15:25:01,002 - INFO - Embeddings visualization saved to vis/embeddings_6_updates_20250602_152500.png
2025-06-02 15:25:01,002 - INFO - Performing visualization of node and edge features.
2025-06-02 15:25:01,003 - INFO - Starting visualization of node features.
2025-06-02 15:25:01,003 - INFO - Graph has 62 nodes and 30 features.
2025-06-02 15:25:01,003 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:25:01,003 - INFO - Calculating feature statistics:
2025-06-02 15:25:01,004 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:01,004 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:01,005 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 4, 'mean': np.float32(1.9227304e-08), 'std': np.float32(1.0), 'min': np.float32(-1.1658509), 'max': np.float32(1.8922695)}
2025-06-02 15:25:01,005 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 4, 'mean': np.float32(3.845461e-09), 'std': np.float32(0.99999994), 'min': np.float32(-1.8845364), 'max': np.float32(1.1707802)}
2025-06-02 15:25:01,005 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:01,005 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:01,006 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:01,006 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(-1.2978431e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.18257418), 'max': np.float32(5.4772253)}
2025-06-02 15:25:01,006 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(-2.4995495e-08), 'std': np.float32(1.0), 'min': np.float32(-0.7679477), 'max': np.float32(1.3021721)}
2025-06-02 15:25:01,007 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 3, 'mean': np.float32(-1.15363825e-08), 'std': np.float32(1.0000001), 'min': np.float32(-3.3477669), 'max': np.float32(0.3117721)}
2025-06-02 15:25:01,007 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 4, 'mean': np.float32(-1.15363825e-08), 'std': np.float32(1.0), 'min': np.float32(-1.5117006), 'max': np.float32(1.3328699)}
2025-06-02 15:25:01,007 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 4, 'mean': np.float32(-3.0763687e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.3289211), 'max': np.float32(1.5174078)}
2025-06-02 15:25:01,007 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 7, 'mean': np.float32(2.983871), 'std': np.float32(1.6799763), 'min': np.float32(0.0), 'max': np.float32(10.0)}
2025-06-02 15:25:01,008 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.7419355), 'std': np.float32(0.67047125), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:25:01,008 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.14516129), 'std': np.float32(0.43428746), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:25:01,008 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.451613), 'std': np.float32(0.776207), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:25:01,009 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 3, 'mean': np.float32(7.690922e-09), 'std': np.float32(1.0000001), 'min': np.float32(-0.3117721), 'max': np.float32(3.3477669)}
2025-06-02 15:25:01,009 - INFO - - service_1: {'name': 'service_1', 'unique': 4, 'mean': np.float32(1.2580645), 'std': np.float32(0.98268044), 'min': np.float32(0.0), 'max': np.float32(3.0)}
2025-06-02 15:25:01,009 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(7.225806), 'std': np.float32(2.0353281), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:25:01,009 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.580645), 'std': np.float32(1.6018978), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:25:01,010 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.14516129), 'std': np.float32(0.43428746), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:25:01,010 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 1, 'mean': np.float32(8.0), 'std': np.float32(0.0), 'min': np.float32(8.0), 'max': np.float32(8.0)}
2025-06-02 15:25:01,010 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 3, 'mean': np.float32(-5.7681913e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.3601238), 'max': np.float32(3.699454)}
2025-06-02 15:25:01,011 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(4.806826e-09), 'std': np.float32(1.0), 'min': np.float32(-0.38490018), 'max': np.float32(2.598076)}
2025-06-02 15:25:01,011 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:01,011 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:01,011 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:01,012 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:01,012 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(6.7295565e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.6187041), 'max': np.float32(4.672282)}
2025-06-02 15:25:01,012 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 3, 'mean': np.float32(5.864328e-08), 'std': np.float32(1.0), 'min': np.float32(-0.72994643), 'max': np.float32(2.890588)}
2025-06-02 15:25:01,089 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7f92a026e8a0>
2025-06-02 15:25:01,867 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:25:02,243 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:25:02,418 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:25:07,088 - INFO - Node feature visualization saved to vis/node_features_20250602_152502.png
2025-06-02 15:25:07,088 - INFO - Finished visualization of node features.
2025-06-02 15:25:07,089 - INFO - Performing additional feature analysis:
2025-06-02 15:25:07,090 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:25:07,091 - INFO - Starting visualization of edge features.
2025-06-02 15:25:07,091 - INFO - Graph has 86 edges and 10 edge features.
2025-06-02 15:25:07,091 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:25:07,091 - INFO - Calculating edge feature statistics:
2025-06-02 15:25:07,092 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:25:07,093 - INFO - - count: {'name': 'count', 'unique': 9, 'mean': np.float32(4.505002e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.19846956), 'max': np.float32(6.581114)}
2025-06-02 15:25:07,093 - INFO - - dst_port: {'name': 'dst_port', 'unique': 8, 'mean': np.float32(341.47675), 'std': np.float32(178.28705), 'min': np.float32(25.0), 'max': np.float32(587.0)}
2025-06-02 15:25:07,093 - INFO - - protocol: {'name': 'protocol', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:07,093 - INFO - - service: {'name': 'service', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:07,093 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 67, 'mean': np.float32(8.316928e-09), 'std': np.float32(1.0), 'min': np.float32(-0.19461668), 'max': np.float32(9.082401)}
2025-06-02 15:25:07,093 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 76, 'mean': np.float32(-2.5990397e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.22627027), 'max': np.float32(9.036156)}
2025-06-02 15:25:07,094 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 48, 'mean': np.float32(9.010004e-09), 'std': np.float32(1.0), 'min': np.float32(-0.4426339), 'max': np.float32(5.668144)}
2025-06-02 15:25:07,094 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 64, 'mean': np.float32(-1.039616e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.19641176), 'max': np.float32(8.896037)}
2025-06-02 15:25:07,094 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 76, 'mean': np.float32(4.3317328e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.2043706), 'max': np.float32(8.886798)}
2025-06-02 15:25:07,094 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 51, 'mean': np.float32(-3.4653864e-09), 'std': np.float32(1.0), 'min': np.float32(-0.3688732), 'max': np.float32(7.6698503)}
2025-06-02 15:25:07,166 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7f92a011a600>
2025-06-02 15:25:07,504 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:25:07,572 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7f92911e92e0>
2025-06-02 15:25:07,895 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:25:08,341 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:25:08,934 - DEBUG - Plotted boxplots of the first 8 non-constant edge features.
2025-06-02 15:25:09,012 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:25:09,047 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:25:12,544 - INFO - Edge feature visualization saved to vis/edge_features_20250602_152509.png
2025-06-02 15:25:12,545 - INFO - Finished visualization of edge features.
2025-06-02 15:25:12,545 - INFO - Performing additional edge feature analysis:
2025-06-02 15:25:12,545 - INFO - - 2 out of 10 edge features are constant.
2025-06-02 15:25:12,545 - INFO - - Highest correlation (1.00) between features: 'total_resp_ip_bytes' and 'total_resp_bytes'.
2025-06-02 15:25:12,546 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:25:12,547 - INFO - Graph has 86 edges and 10 edge features.
2025-06-02 15:25:12,547 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:25:13,780 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_152512_summary.png
2025-06-02 15:25:14,413 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_152512_pca_3d.png
2025-06-02 15:25:14,878 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_152512_pca_variance.png
2025-06-02 15:25:14,878 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:25:14,879 - INFO - 
--- Processing file: nw_graph_encoded_1748869305.dot (Timestamp: 2025-06-02 15:01:45) ---
2025-06-02 15:25:14,879 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869305.dot
2025-06-02 15:25:14,879 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869305.dot'.
2025-06-02 15:25:14,879 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869305.dot
2025-06-02 15:25:14,882 - INFO - Parsed 70 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869305.dot'.
2025-06-02 15:25:14,887 - INFO - Parsed 95 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869305.dot'.
2025-06-02 15:25:14,888 - INFO - Processing node updates/additions.
2025-06-02 15:25:14,891 - INFO - Processing edge updates/additions.
2025-06-02 15:25:14,898 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:25:14,899 - INFO - Finished updating NetworkX graph.
2025-06-02 15:25:14,899 - DEBUG - Updated graph - Nodes: 70, Edges: 95
2025-06-02 15:25:14,899 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:25:14,900 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:25:14,914 - DEBUG - Initial node features tensor shape: torch.Size([70, 30])
2025-06-02 15:25:14,916 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:25:14,917 - DEBUG - Node features tensor shape after scaling: torch.Size([70, 30])
2025-06-02 15:25:14,918 - DEBUG - Edge index tensor shape: torch.Size([2, 95])
2025-06-02 15:25:14,918 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:25:14,923 - DEBUG - Initial edge attributes tensor shape: torch.Size([95, 10])
2025-06-02 15:25:14,925 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:25:14,925 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([95, 10])
2025-06-02 15:25:14,926 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:25:14,926 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:25:14,926 - INFO - Updated main graph to 70 nodes and 95 edges.
2025-06-02 15:25:14,926 - INFO - Performing online update...
2025-06-02 15:25:14,927 - INFO - Starting online update for 25 steps.
2025-06-02 15:25:14,928 - DEBUG - Updated RunningStats: new_mean=0.9322694510337768, new_var=3000000000173.692, new_n=330
2025-06-02 15:25:14,928 - DEBUG - Updated RunningStats: new_mean=0.911676146017906, new_var=3300000000011.2827, new_n=360
2025-06-02 15:25:14,929 - DEBUG - Updated RunningStats: new_mean=27.299733541448745, new_var=1000000111611.6686, new_n=110
2025-06-02 15:25:14,929 - DEBUG - Updated RunningStats: new_mean=26.526158374749798, new_var=1100000027525.33, new_n=120
2025-06-02 15:25:14,929 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:25:14,930 - DEBUG - Online update step: 1/25
2025-06-02 15:25:14,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:14,930 - DEBUG - Online update step: 2/25
2025-06-02 15:25:14,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:14,930 - DEBUG - Online update step: 3/25
2025-06-02 15:25:14,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:14,931 - DEBUG - Online update step: 4/25
2025-06-02 15:25:14,931 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:14,931 - DEBUG - Online update step: 5/25
2025-06-02 15:25:14,931 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:14,931 - DEBUG - Online update step: 6/25
2025-06-02 15:25:14,931 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:14,932 - DEBUG - Online update step: 7/25
2025-06-02 15:25:14,932 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:14,932 - DEBUG - Online update step: 8/25
2025-06-02 15:25:14,932 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:14,932 - DEBUG - Online update step: 9/25
2025-06-02 15:25:14,932 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:14,933 - DEBUG - Online update step: 10/25
2025-06-02 15:25:14,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:14,933 - DEBUG - Online update step: 11/25
2025-06-02 15:25:14,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:14,933 - DEBUG - Online update step: 12/25
2025-06-02 15:25:14,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:14,934 - DEBUG - Online update step: 13/25
2025-06-02 15:25:14,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:14,934 - DEBUG - Online update step: 14/25
2025-06-02 15:25:14,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:14,934 - DEBUG - Online update step: 15/25
2025-06-02 15:25:14,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:14,935 - DEBUG - Online update step: 16/25
2025-06-02 15:25:14,935 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:14,935 - DEBUG - Online update step: 17/25
2025-06-02 15:25:14,935 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:14,935 - DEBUG - Online update step: 18/25
2025-06-02 15:25:14,935 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:14,936 - DEBUG - Online update step: 19/25
2025-06-02 15:25:14,936 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:14,936 - DEBUG - Online update step: 20/25
2025-06-02 15:25:14,936 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:14,936 - DEBUG - Online update step: 21/25
2025-06-02 15:25:14,936 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:14,936 - DEBUG - Online update step: 22/25
2025-06-02 15:25:14,937 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:14,937 - DEBUG - Online update step: 23/25
2025-06-02 15:25:14,937 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:14,937 - DEBUG - Online update step: 24/25
2025-06-02 15:25:14,937 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:14,937 - DEBUG - Online update step: 25/25
2025-06-02 15:25:14,938 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:14,938 - WARNING - No successful steps during online update.
2025-06-02 15:25:14,939 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -4.0871758e-08 -6.8119597e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.3623919e-08
 -6.4713618e-08  5.4495676e-08  3.2356809e-08 -1.7029899e-08
  2.8714285e+00  2.7714286e+00  1.4285715e-01  4.4428573e+00
 -5.4495676e-08  1.3142858e+00  7.2285714e+00  7.6285715e+00
  1.4285715e-01  8.0000000e+00 -4.4277737e-08  3.4059799e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.4713618e-08 -5.4495676e-08], current edge mean: [ 2.5096694e-09  3.5109473e+02  0.0000000e+00  0.0000000e+00
  1.1293512e-08  1.2548347e-09  0.0000000e+00  8.7838421e-09
 -2.5096694e-09  2.5096694e-09]
2025-06-02 15:25:14,939 - DEBUG - Node drift difference: 0.0664, Edge drift difference: 0.0536
2025-06-02 15:25:14,940 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -4.0871758e-08 -6.8119597e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.3623919e-08
 -6.4713618e-08  5.4495676e-08  3.2356809e-08 -1.7029899e-08
  2.8714285e+00  2.7714286e+00  1.4285715e-01  4.4428573e+00
 -5.4495676e-08  1.3142858e+00  7.2285714e+00  7.6285715e+00
  1.4285715e-01  8.0000000e+00 -4.4277737e-08  3.4059799e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.4713618e-08 -5.4495676e-08], edge=[ 2.5096694e-09  3.5109473e+02  0.0000000e+00  0.0000000e+00
  1.1293512e-08  1.2548347e-09  0.0000000e+00  8.7838421e-09
 -2.5096694e-09  2.5096694e-09]
2025-06-02 15:25:14,941 - DEBUG - Updated reference std: node=[0.        0.        1.0072203 1.0072203 0.        0.        0.
 1.0072203 1.0072203 1.0072203 1.0072203 1.0072203 1.6233927 0.6409103
 0.4268426 0.8100047 1.0072203 0.9712215 2.0442314 1.5244046 0.4268426
 0.        1.0072203 1.0072203 0.        0.        0.        0.
 1.0072203 1.0072203], edge=[  1.0053052 173.13118     0.          0.          1.005305    1.005305
   1.005305    1.0053052   1.005305    1.005305 ]
2025-06-02 15:25:14,942 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:25:14,942 - INFO - Running anomaly detection...
2025-06-02 15:25:14,942 - INFO - Starting anomaly detection.
2025-06-02 15:25:14,947 - DEBUG - Node reconstruction errors: [11.336334  12.456924  14.075034  13.030222  13.030221  11.824134
  9.868436  14.104007  14.104007  15.301132  14.104007  10.542206
 12.46997    8.307371  11.875455  11.532262  14.270464  11.532262
 11.507412  11.010926  13.580881  11.875455  14.804748   8.374628
 11.958948  14.048633  11.958948  11.618223  13.580883  11.958947
  8.221462  14.804748  10.734726  14.24944   16.024035  11.603829
 14.6609125 11.010924  11.402919  10.534967  13.537127  11.603829
 11.010924  13.084944  12.606993  13.325343  15.621244  17.956043
 13.324027  20.023336  20.766726  14.54885   13.754887  11.123042
 12.465054  12.146737  11.007053  10.693301  10.291091  11.730372
  9.508979  13.496568  11.556981  10.693301  10.932978  12.465053
 12.146739  12.4650545 11.556981  11.556981 ]
2025-06-02 15:25:14,948 - DEBUG - Edge reconstruction errors: [ 4.2860723  6.829829  43.240986   1.422544   4.2100186 43.131126
 43.163597  43.13244    6.826398  43.131046  43.135094  43.145836
  6.959197   1.4935415 57.555504  57.555504  45.35003    6.875489
 43.313717  43.188553  43.146706   6.823941  43.12887   43.1222
 43.27485   43.135445  43.134422  43.129696  43.241295  43.12915
  5.217272   5.513982  43.12647    6.822036  43.118988   6.869573
 57.525482   1.4876626 45.334446   6.830272  43.236446  43.119827
 43.182083  43.497047  43.209923  43.15382   43.16924   43.144127
 43.136696  45.53057   43.28721   43.25521   43.149303  43.405758
 43.405758  43.12647   43.247505  43.138695  43.173855   7.545992
  8.183974  43.140423  43.139427  43.411606  43.12309   43.133274
  9.554289  12.618195   6.8347297 43.118263  43.11897   43.118988
 43.11961   43.157482  43.266785  43.138313  43.148582  43.183613
 43.224792  43.120117  43.14089    6.826356  43.119015  43.16626
 43.163506  43.156456  43.54973   43.160946  12.222734   1.4341283
 57.521606   1.4238328 45.326958  43.12886    6.82447  ]
2025-06-02 15:25:14,950 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152514_update_7.json
2025-06-02 15:25:14,950 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:25:14,964 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152514_update_7.pth
2025-06-02 15:25:14,964 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869305.dot): 0.0005
2025-06-02 15:25:14,964 - WARNING - Detected 2 anomalous nodes (reconstruction-based):
2025-06-02 15:25:14,964 - WARNING -   Node ID: ff02::2, Recon Error: 20.0233, MLP Score: 0.0003
2025-06-02 15:25:14,965 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 20.7667, MLP Score: 0.0003
2025-06-02 15:25:14,965 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-02 15:25:14,965 - INFO - 
--- Processing file: nw_graph_encoded_1748869335.dot (Timestamp: 2025-06-02 15:02:15) ---
2025-06-02 15:25:14,965 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869335.dot
2025-06-02 15:25:14,965 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869335.dot'.
2025-06-02 15:25:14,965 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869335.dot
2025-06-02 15:25:14,968 - INFO - Parsed 77 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869335.dot'.
2025-06-02 15:25:14,975 - INFO - Parsed 106 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869335.dot'.
2025-06-02 15:25:14,975 - INFO - Processing node updates/additions.
2025-06-02 15:25:14,978 - INFO - Processing edge updates/additions.
2025-06-02 15:25:14,987 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:25:14,987 - INFO - Finished updating NetworkX graph.
2025-06-02 15:25:14,988 - DEBUG - Updated graph - Nodes: 77, Edges: 106
2025-06-02 15:25:14,988 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:25:14,989 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:25:15,004 - DEBUG - Initial node features tensor shape: torch.Size([77, 30])
2025-06-02 15:25:15,006 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:25:15,007 - DEBUG - Node features tensor shape after scaling: torch.Size([77, 30])
2025-06-02 15:25:15,008 - DEBUG - Edge index tensor shape: torch.Size([2, 106])
2025-06-02 15:25:15,008 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:25:15,013 - DEBUG - Initial edge attributes tensor shape: torch.Size([106, 10])
2025-06-02 15:25:15,015 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:25:15,016 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([106, 10])
2025-06-02 15:25:15,016 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:25:15,017 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:25:15,017 - INFO - Updated main graph to 77 nodes and 106 edges.
2025-06-02 15:25:15,017 - INFO - Performing online update...
2025-06-02 15:25:15,018 - INFO - Starting online update for 25 steps.
2025-06-02 15:25:15,019 - DEBUG - Updated RunningStats: new_mean=0.9304583003668586, new_var=3600000000173.2173, new_n=390
2025-06-02 15:25:15,019 - DEBUG - Updated RunningStats: new_mean=0.9137070405847387, new_var=3900000000011.651, new_n=420
2025-06-02 15:25:15,019 - DEBUG - Updated RunningStats: new_mean=27.231475575348608, new_var=1200000115449.8408, new_n=130
2025-06-02 15:25:15,020 - DEBUG - Updated RunningStats: new_mean=26.54140910354053, new_var=1300000026236.8047, new_n=140
2025-06-02 15:25:15,020 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:25:15,020 - DEBUG - Online update step: 1/25
2025-06-02 15:25:15,020 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,021 - DEBUG - Online update step: 2/25
2025-06-02 15:25:15,021 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,021 - DEBUG - Online update step: 3/25
2025-06-02 15:25:15,021 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,021 - DEBUG - Online update step: 4/25
2025-06-02 15:25:15,021 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,022 - DEBUG - Online update step: 5/25
2025-06-02 15:25:15,022 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,022 - DEBUG - Online update step: 6/25
2025-06-02 15:25:15,022 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,022 - DEBUG - Online update step: 7/25
2025-06-02 15:25:15,022 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,023 - DEBUG - Online update step: 8/25
2025-06-02 15:25:15,023 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,023 - DEBUG - Online update step: 9/25
2025-06-02 15:25:15,023 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,023 - DEBUG - Online update step: 10/25
2025-06-02 15:25:15,023 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,023 - DEBUG - Online update step: 11/25
2025-06-02 15:25:15,024 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,024 - DEBUG - Online update step: 12/25
2025-06-02 15:25:15,024 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,024 - DEBUG - Online update step: 13/25
2025-06-02 15:25:15,024 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,024 - DEBUG - Online update step: 14/25
2025-06-02 15:25:15,025 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,025 - DEBUG - Online update step: 15/25
2025-06-02 15:25:15,025 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,025 - DEBUG - Online update step: 16/25
2025-06-02 15:25:15,025 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,026 - DEBUG - Online update step: 17/25
2025-06-02 15:25:15,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,026 - DEBUG - Online update step: 18/25
2025-06-02 15:25:15,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,026 - DEBUG - Online update step: 19/25
2025-06-02 15:25:15,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,027 - DEBUG - Online update step: 20/25
2025-06-02 15:25:15,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,027 - DEBUG - Online update step: 21/25
2025-06-02 15:25:15,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,027 - DEBUG - Online update step: 22/25
2025-06-02 15:25:15,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,028 - DEBUG - Online update step: 23/25
2025-06-02 15:25:15,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,028 - DEBUG - Online update step: 24/25
2025-06-02 15:25:15,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,028 - DEBUG - Online update step: 25/25
2025-06-02 15:25:15,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,028 - WARNING - No successful steps during online update.
2025-06-02 15:25:15,030 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00 -4.02524876e-08 -9.28903532e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00 -4.33488339e-08
 -2.01262438e-08  2.47707614e-08  1.08372085e-08  1.54817259e-09
  2.87012982e+00  2.79220772e+00  1.29870132e-01  4.41558456e+00
 -2.47707614e-08  1.53246748e+00  7.14285707e+00  7.66233778e+00
  1.29870132e-01  8.00000000e+00  1.23853807e-08 -2.78671060e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  6.19269036e-09 -2.16744169e-08], current edge mean: [-7.87231169e-09  3.56952820e+02  0.00000000e+00  0.00000000e+00
 -2.24923191e-09  4.49846382e-09 -1.34953915e-08 -8.99692765e-09
  1.57446234e-08  1.34953915e-08]
2025-06-02 15:25:15,030 - DEBUG - Node drift difference: 0.2246, Edge drift difference: 0.0338
2025-06-02 15:25:15,030 - WARNING - Feature drift detected (1 consecutive)
2025-06-02 15:25:15,031 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00 -4.02524876e-08 -9.28903532e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00 -4.33488339e-08
 -2.01262438e-08  2.47707614e-08  1.08372085e-08  1.54817259e-09
  2.87012982e+00  2.79220772e+00  1.29870132e-01  4.41558456e+00
 -2.47707614e-08  1.53246748e+00  7.14285707e+00  7.66233778e+00
  1.29870132e-01  8.00000000e+00  1.23853807e-08 -2.78671060e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  6.19269036e-09 -2.16744169e-08], edge=[-7.87231169e-09  3.56952820e+02  0.00000000e+00  0.00000000e+00
 -2.24923191e-09  4.49846382e-09 -1.34953915e-08 -8.99692765e-09
  1.57446234e-08  1.34953915e-08]
2025-06-02 15:25:15,032 - DEBUG - Updated reference std: node=[0.        0.        1.0065575 1.0065575 0.        0.        0.
 1.0065575 1.0065575 1.0065575 1.0065575 1.0065575 1.5757258 0.6142531
 0.408806  0.7838946 1.0065575 1.4196405 2.131927  1.4564773 0.408806
 0.        1.0065575 1.0065575 0.        0.        0.        0.
 1.0065575 1.0065575], edge=[  1.0047506 168.6722      0.          0.          1.0047506   1.0047506
   1.0047506   1.0047506   1.0047506   1.0047506]
2025-06-02 15:25:15,032 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:25:15,033 - INFO - Running anomaly detection...
2025-06-02 15:25:15,033 - INFO - Starting anomaly detection.
2025-06-02 15:25:15,038 - DEBUG - Node reconstruction errors: [11.107635 12.588035 14.188402 12.980138 12.980138 11.773142 10.129532
 13.638984 13.638982 14.821603 13.638982 10.159299 11.832027  8.063166
 11.543895 11.225489 13.905595 11.225489 11.274775 10.737765 13.143679
 11.543896 14.346982  8.069934 11.580832 14.000287 11.580834 10.85682
 13.143678 11.580834  8.045627 14.346982 10.441354 14.246613 15.998649
 11.238015 14.642807 10.737765 11.104241 10.232203 13.136765 11.238017
 10.737765 12.726251 12.278166 12.859691 15.265045 17.53188  12.862517
 20.006853 20.82368  14.065887 13.686839 10.799581 12.340418 13.785039
 11.094732 10.324656 10.229299 11.678395 10.563503 13.021001 11.118452
 10.324656 10.840927 12.340414 12.051291 12.340415 11.11845  11.11845
 12.407702 12.126921 13.568538 12.335079 14.917155 12.566446 11.189748]
2025-06-02 15:25:15,039 - DEBUG - Edge reconstruction errors: [ 4.257585   6.853357  43.217358   1.4438312  4.199906  43.154026
 43.17408   43.154858   6.8519983 43.153954  43.15658   43.163383
  8.570645   1.5121491 57.608856  57.608856  45.36457    6.877882
 43.318737  43.18908   43.163795   6.8500795 43.15203   43.147713
 43.393833  43.157402  43.165497  43.165497  43.15676   43.152542
 43.22396   43.15223   43.15855   43.186565  43.186302   4.3030868
 43.207626  43.151985   4.7229385  4.868592  43.149742   6.8493958
 43.14624    6.8758826 57.5494     1.5179851 45.35513    6.8544135
 43.26014   43.146538  43.19242   43.551704  43.201912  43.17057
 43.178368  43.164215  43.15834   45.144287  43.267033  43.237404
 43.16599   43.473747  43.473747  43.149742  43.232826  43.159046
 43.181725   7.303911   9.171736  43.161446  43.16009   43.369503
 43.14813   43.154964   8.553934  12.645954   6.857573  43.145893
 43.146225  43.14624   43.146446  43.171608  43.243538  43.15866
 43.16645   43.190453  43.22785   43.146782  43.160255   6.852176
 43.14626   43.18287   43.173603  43.174034  43.408314  43.171555
 43.162457  43.162457  43.15456   12.248055   1.446883  57.547558
  1.4419191 45.351128  43.152428   6.8503685]
2025-06-02 15:25:15,040 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152515_update_8.json
2025-06-02 15:25:15,041 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:25:15,054 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152515_update_8.pth
2025-06-02 15:25:15,055 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869335.dot): 0.0006
2025-06-02 15:25:15,055 - WARNING - Detected 2 anomalous nodes (reconstruction-based):
2025-06-02 15:25:15,055 - WARNING -   Node ID: ff02::2, Recon Error: 20.0069, MLP Score: 0.0003
2025-06-02 15:25:15,055 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 20.8237, MLP Score: 0.0003
2025-06-02 15:25:15,055 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-02 15:25:15,055 - INFO - 
--- Processing file: nw_graph_encoded_1748869365.dot (Timestamp: 2025-06-02 15:02:45) ---
2025-06-02 15:25:15,056 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869365.dot
2025-06-02 15:25:15,056 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869365.dot'.
2025-06-02 15:25:15,056 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869365.dot
2025-06-02 15:25:15,060 - INFO - Parsed 89 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869365.dot'.
2025-06-02 15:25:15,067 - INFO - Parsed 133 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869365.dot'.
2025-06-02 15:25:15,068 - INFO - Processing node updates/additions.
2025-06-02 15:25:15,071 - INFO - Processing edge updates/additions.
2025-06-02 15:25:15,081 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:25:15,081 - INFO - Finished updating NetworkX graph.
2025-06-02 15:25:15,082 - DEBUG - Updated graph - Nodes: 89, Edges: 133
2025-06-02 15:25:15,082 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:25:15,083 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:25:15,101 - DEBUG - Initial node features tensor shape: torch.Size([89, 30])
2025-06-02 15:25:15,103 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:25:15,104 - DEBUG - Node features tensor shape after scaling: torch.Size([89, 30])
2025-06-02 15:25:15,105 - DEBUG - Edge index tensor shape: torch.Size([2, 133])
2025-06-02 15:25:15,106 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:25:15,112 - DEBUG - Initial edge attributes tensor shape: torch.Size([133, 10])
2025-06-02 15:25:15,115 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:25:15,116 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([133, 10])
2025-06-02 15:25:15,116 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:25:15,116 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:25:15,117 - INFO - Updated main graph to 89 nodes and 133 edges.
2025-06-02 15:25:15,117 - INFO - Performing online update...
2025-06-02 15:25:15,118 - INFO - Starting online update for 25 steps.
2025-06-02 15:25:15,119 - DEBUG - Updated RunningStats: new_mean=0.9299467952461821, new_var=4200000000167.249, new_n=450
2025-06-02 15:25:15,119 - DEBUG - Updated RunningStats: new_mean=0.9179123252082413, new_var=4500000000014.057, new_n=480
2025-06-02 15:25:15,120 - DEBUG - Updated RunningStats: new_mean=27.230377825933452, new_var=1400000123381.9688, new_n=150
2025-06-02 15:25:15,120 - DEBUG - Updated RunningStats: new_mean=26.56403471085965, new_var=1500000023501.166, new_n=160
2025-06-02 15:25:15,121 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:25:15,121 - DEBUG - Online update step: 1/25
2025-06-02 15:25:15,121 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,121 - DEBUG - Online update step: 2/25
2025-06-02 15:25:15,121 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,121 - DEBUG - Online update step: 3/25
2025-06-02 15:25:15,122 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,122 - DEBUG - Online update step: 4/25
2025-06-02 15:25:15,122 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,122 - DEBUG - Online update step: 5/25
2025-06-02 15:25:15,122 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,122 - DEBUG - Online update step: 6/25
2025-06-02 15:25:15,123 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,123 - DEBUG - Online update step: 7/25
2025-06-02 15:25:15,123 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,123 - DEBUG - Online update step: 8/25
2025-06-02 15:25:15,123 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,123 - DEBUG - Online update step: 9/25
2025-06-02 15:25:15,124 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,124 - DEBUG - Online update step: 10/25
2025-06-02 15:25:15,124 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,124 - DEBUG - Online update step: 11/25
2025-06-02 15:25:15,124 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,124 - DEBUG - Online update step: 12/25
2025-06-02 15:25:15,125 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,125 - DEBUG - Online update step: 13/25
2025-06-02 15:25:15,125 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,125 - DEBUG - Online update step: 14/25
2025-06-02 15:25:15,125 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,126 - DEBUG - Online update step: 15/25
2025-06-02 15:25:15,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,126 - DEBUG - Online update step: 16/25
2025-06-02 15:25:15,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,126 - DEBUG - Online update step: 17/25
2025-06-02 15:25:15,126 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,127 - DEBUG - Online update step: 18/25
2025-06-02 15:25:15,127 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,127 - DEBUG - Online update step: 19/25
2025-06-02 15:25:15,127 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,127 - DEBUG - Online update step: 20/25
2025-06-02 15:25:15,127 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,128 - DEBUG - Online update step: 21/25
2025-06-02 15:25:15,128 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,128 - DEBUG - Online update step: 22/25
2025-06-02 15:25:15,128 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,128 - DEBUG - Online update step: 23/25
2025-06-02 15:25:15,128 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,129 - DEBUG - Online update step: 24/25
2025-06-02 15:25:15,129 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,129 - DEBUG - Online update step: 25/25
2025-06-02 15:25:15,129 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,129 - WARNING - No successful steps during online update.
2025-06-02 15:25:15,131 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -7.9026385e-08  4.6880057e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.2770314e-08
 -2.1430884e-08  3.2146325e-08  3.0806895e-08  6.8310939e-08
  2.7977529e+00  2.8202248e+00  2.1348314e-01  4.4044943e+00
 -3.2146325e-08  1.9662921e+00  6.7415729e+00  7.5617976e+00
  2.1348314e-01  8.0000000e+00 -3.7504048e-08 -5.3577209e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.6788605e-08  5.3577209e-09], current edge mean: [-1.43409675e-08  3.68759399e+02  0.00000000e+00  0.00000000e+00
 -8.96310404e-09  0.00000000e+00  0.00000000e+00 -3.58524188e-09
  0.00000000e+00  7.17048376e-09]
2025-06-02 15:25:15,131 - DEBUG - Node drift difference: 0.3056, Edge drift difference: 0.0700
2025-06-02 15:25:15,132 - WARNING - Feature drift detected (2 consecutive)
2025-06-02 15:25:15,133 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -7.9026385e-08  4.6880057e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.2770314e-08
 -2.1430884e-08  3.2146325e-08  3.0806895e-08  6.8310939e-08
  2.7977529e+00  2.8202248e+00  2.1348314e-01  4.4044943e+00
 -3.2146325e-08  1.9662921e+00  6.7415729e+00  7.5617976e+00
  2.1348314e-01  8.0000000e+00 -3.7504048e-08 -5.3577209e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.6788605e-08  5.3577209e-09], edge=[-1.43409675e-08  3.68759399e+02  0.00000000e+00  0.00000000e+00
 -8.96310404e-09  0.00000000e+00  0.00000000e+00 -3.58524188e-09
  0.00000000e+00  7.17048376e-09]
2025-06-02 15:25:15,134 - DEBUG - Updated reference std: node=[0.         0.         1.0056658  1.0056658  0.         0.
 0.         1.0056658  1.0056658  1.0056657  1.0056658  1.0056658
 1.5013614  0.5752825  0.46397272 0.7342142  1.0056657  2.2281742
 2.4426517  1.6442397  0.46397272 0.         1.0056658  1.0056658
 0.         0.         0.         0.         1.0056658  1.0056658 ], edge=[  1.0037808 158.66241     0.          0.          1.0037807   1.0037807
   1.0037808   1.0037807   1.0037807   1.0037807]
2025-06-02 15:25:15,134 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:25:15,134 - INFO - Running anomaly detection...
2025-06-02 15:25:15,135 - INFO - Starting anomaly detection.
2025-06-02 15:25:15,140 - DEBUG - Node reconstruction errors: [10.993032  12.569094   9.21924   13.131836  14.614307  11.930134
 11.764751  14.014422  14.0144205 15.236833  14.014422  10.498928
 12.719524   8.4707365 11.949779  11.568902  14.309381  11.568902
 11.62098   11.110703  13.5573015 11.949779  14.793402   8.393604
 11.968201  14.130717  11.9682    11.390958  13.5573015 11.968199
  8.3616705 14.793403  10.807872  12.479879  13.913852  11.648922
 12.663743  11.110704  11.492102  10.60171   13.60973   11.648924
 11.1107    13.181096  12.712156  13.253421  15.731333  18.013935
 13.26813   20.123589  21.079292  14.502175  13.818387  11.187785
 12.423348   9.510975  11.377139  10.662863  10.421995  10.243342
  9.383907  13.457762  11.495271   8.086896  10.980912  12.423348
 13.174659  12.4233465 11.495273  11.495271  12.413371  12.185175
 13.657357  12.414621  15.565044  12.590234  11.482966  13.193663
 13.193661  13.193664  12.008018  13.1936655 10.068692  14.368934
 10.7748575 11.275059  13.344835  13.193662  13.193661 ]
2025-06-02 15:25:15,142 - DEBUG - Edge reconstruction errors: [ 4.2837496  6.8590536 43.21972    1.5259846  5.127246  43.15948
 43.179626  43.160355   6.8554645 43.1515    43.18524   43.16207
 43.234745  43.15292   43.162754   4.454488   6.857356  43.19087
 43.159412  43.162205  43.191124  43.191124  43.169334   9.412804
  1.4938772 57.669624  57.669624  45.369072   6.8812113 43.383553
 43.195023  43.169724   6.8553133 43.15727   43.15292   43.393513
 43.16276   43.17122   43.17122   43.162086  43.15781   43.232246
 43.157486  43.163963  43.19201   43.191338   4.2998023 43.213192
 43.17036   43.164528  43.164528  43.16774   43.16774   43.175987
 43.175987  43.17548   43.17548   43.168533  43.168533  43.161415
 43.161415  43.226547  43.226547   4.772554   5.1587315 43.15473
  6.8547034 43.151627   6.879556  57.554474   1.4851649 45.360085
  6.859312  43.260536  43.151867  43.19858   43.56325   43.206078
 43.176064  43.184563  43.169563  43.163677  45.17704   43.27213
 43.242004  43.17109   43.48056   43.48056   43.15473   43.237373
 43.164417  43.186665   7.322384   9.273204  43.166817  43.165493
 43.379787  43.153297  43.160313   8.635272  12.651391   6.8629146
 43.151314  43.15161   43.151627  43.151787  43.1773    43.248558
 43.164356  43.17198   43.19552   43.233738  43.152107  43.166042
  6.8573833 43.15165   43.18861   43.178215  43.179287  43.165184
 43.411232  43.176723  43.168053  43.168053  43.159832  43.158154
 12.2532425  1.4749155 57.55282    1.468298  45.35637   43.157692
  6.8558054]
2025-06-02 15:25:15,149 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152515_update_9.json
2025-06-02 15:25:15,150 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:25:15,165 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152515_update_9.pth
2025-06-02 15:25:15,165 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869365.dot): 0.0006
2025-06-02 15:25:15,165 - WARNING - Detected 3 anomalous nodes (reconstruction-based):
2025-06-02 15:25:15,166 - WARNING -   Node ID: 150.171.28.10, Recon Error: 18.0139, MLP Score: 0.0008
2025-06-02 15:25:15,166 - WARNING -   Node ID: ff02::2, Recon Error: 20.1236, MLP Score: 0.0003
2025-06-02 15:25:15,166 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 21.0793, MLP Score: 0.0003
2025-06-02 15:25:15,166 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-02 15:25:15,166 - INFO - 
--- Processing file: nw_graph_encoded_1748869395.dot (Timestamp: 2025-06-02 15:03:15) ---
2025-06-02 15:25:15,167 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869395.dot
2025-06-02 15:25:15,167 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869395.dot'.
2025-06-02 15:25:15,167 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869395.dot
2025-06-02 15:25:15,172 - INFO - Parsed 129 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869395.dot'.
2025-06-02 15:25:15,183 - INFO - Parsed 186 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869395.dot'.
2025-06-02 15:25:15,184 - INFO - Processing node updates/additions.
2025-06-02 15:25:15,188 - INFO - Processing edge updates/additions.
2025-06-02 15:25:15,201 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:25:15,202 - INFO - Finished updating NetworkX graph.
2025-06-02 15:25:15,203 - DEBUG - Updated graph - Nodes: 129, Edges: 186
2025-06-02 15:25:15,203 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:25:15,204 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:25:15,230 - DEBUG - Initial node features tensor shape: torch.Size([129, 30])
2025-06-02 15:25:15,232 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:25:15,233 - DEBUG - Node features tensor shape after scaling: torch.Size([129, 30])
2025-06-02 15:25:15,234 - DEBUG - Edge index tensor shape: torch.Size([2, 186])
2025-06-02 15:25:15,235 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:25:15,243 - DEBUG - Initial edge attributes tensor shape: torch.Size([186, 10])
2025-06-02 15:25:15,245 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:25:15,246 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([186, 10])
2025-06-02 15:25:15,246 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:25:15,247 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:25:15,247 - INFO - Updated main graph to 129 nodes and 186 edges.
2025-06-02 15:25:15,248 - INFO - Performing online update...
2025-06-02 15:25:15,248 - INFO - Starting online update for 25 steps.
2025-06-02 15:25:15,249 - DEBUG - Updated RunningStats: new_mean=0.932225735956973, new_var=4800000000168.395, new_n=510
2025-06-02 15:25:15,249 - DEBUG - Updated RunningStats: new_mean=0.9207073983532016, new_var=5100000000014.268, new_n=540
2025-06-02 15:25:15,250 - DEBUG - Updated RunningStats: new_mean=27.594138884434205, new_var=1600000177727.1296, new_n=170
2025-06-02 15:25:15,250 - DEBUG - Updated RunningStats: new_mean=29.05691043393009, new_var=1700000260736.1067, new_n=180
2025-06-02 15:25:15,251 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:25:15,251 - DEBUG - Online update step: 1/25
2025-06-02 15:25:15,251 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,251 - DEBUG - Online update step: 2/25
2025-06-02 15:25:15,251 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,252 - DEBUG - Online update step: 3/25
2025-06-02 15:25:15,252 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,252 - DEBUG - Online update step: 4/25
2025-06-02 15:25:15,252 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,252 - DEBUG - Online update step: 5/25
2025-06-02 15:25:15,252 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,253 - DEBUG - Online update step: 6/25
2025-06-02 15:25:15,253 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,253 - DEBUG - Online update step: 7/25
2025-06-02 15:25:15,253 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,253 - DEBUG - Online update step: 8/25
2025-06-02 15:25:15,253 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,254 - DEBUG - Online update step: 9/25
2025-06-02 15:25:15,254 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,254 - DEBUG - Online update step: 10/25
2025-06-02 15:25:15,254 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,254 - DEBUG - Online update step: 11/25
2025-06-02 15:25:15,254 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,254 - DEBUG - Online update step: 12/25
2025-06-02 15:25:15,255 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,255 - DEBUG - Online update step: 13/25
2025-06-02 15:25:15,255 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,255 - DEBUG - Online update step: 14/25
2025-06-02 15:25:15,255 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,255 - DEBUG - Online update step: 15/25
2025-06-02 15:25:15,256 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,256 - DEBUG - Online update step: 16/25
2025-06-02 15:25:15,256 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,256 - DEBUG - Online update step: 17/25
2025-06-02 15:25:15,256 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,256 - DEBUG - Online update step: 18/25
2025-06-02 15:25:15,257 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,257 - DEBUG - Online update step: 19/25
2025-06-02 15:25:15,257 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,257 - DEBUG - Online update step: 20/25
2025-06-02 15:25:15,257 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,257 - DEBUG - Online update step: 21/25
2025-06-02 15:25:15,258 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,258 - DEBUG - Online update step: 22/25
2025-06-02 15:25:15,258 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,258 - DEBUG - Online update step: 23/25
2025-06-02 15:25:15,258 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,258 - DEBUG - Online update step: 24/25
2025-06-02 15:25:15,259 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,259 - DEBUG - Online update step: 25/25
2025-06-02 15:25:15,259 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,259 - WARNING - No successful steps during online update.
2025-06-02 15:25:15,260 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -3.6964121e-09 -2.2178472e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  6.3763110e-08
  3.3267710e-08  1.2937442e-08  4.6205151e-09 -3.4191810e-08
  2.6744187e+00  2.8759689e+00  2.0155039e-01  4.4263568e+00
 -1.2937442e-08  2.0930233e+00  6.6666665e+00  7.6976743e+00
  2.0155039e-01  8.0000000e+00 -1.4785648e-08  4.0660534e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -6.7459517e-08 -4.6205152e-08], current edge mean: [ 2.5636406e-09  4.4075806e+02  0.0000000e+00  0.0000000e+00
 -6.4091017e-09 -1.4100023e-08 -2.5636406e-09  2.5636406e-09
  2.5636406e-09 -8.9727425e-09]
2025-06-02 15:25:15,261 - DEBUG - Node drift difference: 0.0969, Edge drift difference: 0.4538
2025-06-02 15:25:15,261 - WARNING - Feature drift detected (3 consecutive)
2025-06-02 15:25:15,261 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-02 15:25:15,261 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-02 15:25:15,262 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-02 15:25:15,262 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-02 15:25:15,262 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-02 15:25:15,263 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-02 15:25:15,263 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-02 15:25:15,263 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-02 15:25:15,264 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-02 15:25:15,264 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-02 15:25:15,264 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-02 15:25:15,264 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-02 15:25:15,265 - INFO - Optimizer and scheduler reset.
2025-06-02 15:25:15,266 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -3.6964121e-09 -2.2178472e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  6.3763110e-08
  3.3267710e-08  1.2937442e-08  4.6205151e-09 -3.4191810e-08
  2.6744187e+00  2.8759689e+00  2.0155039e-01  4.4263568e+00
 -1.2937442e-08  2.0930233e+00  6.6666665e+00  7.6976743e+00
  2.0155039e-01  8.0000000e+00 -1.4785648e-08  4.0660534e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -6.7459517e-08 -4.6205152e-08], edge=[ 2.5636406e-09  4.4075806e+02  0.0000000e+00  0.0000000e+00
 -6.4091017e-09 -1.4100023e-08 -2.5636406e-09  2.5636406e-09
  2.5636406e-09 -8.9727425e-09]
2025-06-02 15:25:15,267 - DEBUG - Updated reference std: node=[0.         0.         1.0038986  1.0038986  0.         0.
 0.         1.0038986  1.0038987  1.0038986  1.0038986  1.0038986
 1.4040276  0.484248   0.43981254 0.7156203  1.0038986  2.3433478
 2.4947863  1.3784312  0.43981254 0.         1.0038986  1.0038986
 0.         0.         0.         0.         1.0038986  1.0038986 ], edge=[  1.002699  532.2214      0.          0.          1.002699    1.002699
   1.002699    1.0026991   1.002699    1.002699 ]
2025-06-02 15:25:15,268 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:25:15,268 - INFO - Running anomaly detection...
2025-06-02 15:25:15,268 - INFO - Starting anomaly detection.
2025-06-02 15:25:15,274 - DEBUG - Node reconstruction errors: [14.321566  13.054813  11.919267  15.79893   13.308949  14.975847
 11.880149  15.264905  15.264905  16.000677  15.264905  11.415377
 12.708362  11.281986  14.9180155 14.900893  16.841219  14.900894
 15.487987  14.548079  14.90627   14.9180155 15.65721   10.150156
 14.757073  15.667945  14.757073  13.43507   14.906271  14.757073
  9.812375  15.65721   14.291327  15.414068  15.654415  14.656078
 14.885938  14.54808   14.695979  14.966557  15.963837  14.656078
 14.548079  15.705545  15.502822  14.93691   17.88739   19.459593
 14.64689   24.985088  25.070812  15.717984  15.420789  14.432516
 14.179086  11.08257   13.079031  14.117282  14.568776  14.443502
 10.294297  15.803782  14.482975   9.989028  14.215387  14.179086
 14.737128  13.7268    14.482976  14.482975  14.112735  12.395817
 15.274149  12.387897  15.418382  12.387893  14.406832  13.276545
 13.276546  13.276546  14.92706   13.276545  13.754581  15.493971
 16.39385   14.576999  13.580839  13.276546  13.276545  14.169118
 14.118402  14.714921  14.714921  14.408659  14.408659  20.440014
 15.013459  14.408659  14.42684   14.076621  14.408659  15.013459
 14.13502   13.276546  13.776168  14.149148  14.102691  10.260226
 14.576999  20.1218    15.223751  14.92706    9.73544   14.576999
 14.1184025 14.13502   14.135021  13.334031  14.39996   14.408659
 14.949434  14.714921  14.714921  14.714921  13.334031  14.408659
 10.399235   9.911457  14.408659 ]
2025-06-02 15:25:15,276 - DEBUG - Edge reconstruction errors: [  5.2107      7.8527675  44.193394    2.3506825  11.64748    44.157196
  44.171955   44.157932    7.8513446  44.151367   44.173447   44.158405
  44.29433    44.152054   44.159008    6.2437735   7.8544126  44.21262
  44.18562    45.273968   44.151367   44.26868    44.489674   44.15136
  44.183987   44.151367   44.158417   44.28016    44.15898    44.15531
  44.215443   44.159283   44.158665   45.254032   44.15825     7.8660035
  44.15714    44.159584   44.81337    44.81337    44.16557     9.250749
   2.3504825  58.620445   58.620445   46.361794    7.8654747  44.295227
  44.184338   44.165867    7.851144   44.1552     44.15205    44.309227
  44.15901    44.165215   44.165215   44.158413   44.155655   44.216938
  44.155403   44.160007   44.170433   44.170433   44.179676   44.178204
  44.16963    44.16963     5.249567   44.19551    44.163822   44.163822
  44.163845   44.160408   44.160408   44.162914   44.162914   44.16893
  44.16893    44.16841    44.16841    44.16353    44.16353    44.157974
  44.157974   44.20531    44.20531    44.43555    44.43555    44.386505
  44.386505   44.156437   44.164936   44.15923    44.151367   44.378796
  44.15174    44.151367   44.15174    44.159912   44.159912   44.158752
  44.15205    44.160126   44.151367   44.15168    44.15844    44.200146
  44.18401    44.2        44.233143   44.15945    44.174595    5.578633
   5.84348    44.152966    7.8506093  44.15144     7.864705   58.552906
   2.350645   46.356564    7.852446   44.21846    44.151527   44.18467
  44.444317   44.18737    44.168247   44.177044   44.163315   44.15954
  45.4918     44.2309     44.21158    44.164253   44.373245   44.373245
  44.152973   44.208023   44.160366   44.17478     8.221312    9.860608
  44.16158    44.160988   44.3133     44.152267   44.157604    9.344298
  13.65108     7.856357   44.15128    44.15143    44.15144    44.1515
  44.170162   44.2179     44.161304   44.16576    44.1805     44.205708
  44.151676   44.162773    7.852091   44.151463   44.176228   44.168453
  44.169174   44.160698   44.332973   44.16914    44.193768   44.193768
  44.156727   44.155804  535.15155    44.171352   13.252172    2.3721411
  58.55207     2.3687537  46.354465   44.155426    7.8517866 535.1516   ]
2025-06-02 15:25:15,278 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152515_update_10.json
2025-06-02 15:25:15,278 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:25:15,292 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152515_update_10.pth
2025-06-02 15:25:15,292 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869395.dot): 0.2257
2025-06-02 15:25:15,292 - WARNING - Detected 4 anomalous nodes (reconstruction-based):
2025-06-02 15:25:15,293 - WARNING -   Node ID: ff02::2, Recon Error: 24.9851, MLP Score: 0.4468
2025-06-02 15:25:15,293 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 25.0708, MLP Score: 0.4428
2025-06-02 15:25:15,293 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 20.4400, MLP Score: 0.3599
2025-06-02 15:25:15,293 - WARNING -   Node ID: ff02::fb, Recon Error: 20.1218, MLP Score: 0.3827
2025-06-02 15:25:15,293 - WARNING - Detected 2 anomalous edges (reconstruction-based):
2025-06-02 15:25:15,294 - WARNING -   Source: 192.168.27.10, Target: 224.0.0.251, Recon Error: 535.1516, MLP Score: 0.0000
2025-06-02 15:25:15,294 - WARNING -   Source: fe80::eb4e:a54d:8c61:6ce1, Target: ff02::fb, Recon Error: 535.1516, MLP Score: 0.0000
2025-06-02 15:25:15,294 - INFO - 
--- Processing file: nw_graph_encoded_1748869425.dot (Timestamp: 2025-06-02 15:03:45) ---
2025-06-02 15:25:15,294 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869425.dot
2025-06-02 15:25:15,294 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869425.dot'.
2025-06-02 15:25:15,294 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869425.dot
2025-06-02 15:25:15,301 - INFO - Parsed 177 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869425.dot'.
2025-06-02 15:25:15,316 - INFO - Parsed 256 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869425.dot'.
2025-06-02 15:25:15,316 - INFO - Processing node updates/additions.
2025-06-02 15:25:15,325 - INFO - Processing edge updates/additions.
2025-06-02 15:25:15,343 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:25:15,345 - INFO - Finished updating NetworkX graph.
2025-06-02 15:25:15,345 - DEBUG - Updated graph - Nodes: 177, Edges: 256
2025-06-02 15:25:15,346 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:25:15,347 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:25:15,383 - DEBUG - Initial node features tensor shape: torch.Size([177, 30])
2025-06-02 15:25:15,386 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:25:15,386 - DEBUG - Node features tensor shape after scaling: torch.Size([177, 30])
2025-06-02 15:25:15,387 - DEBUG - Edge index tensor shape: torch.Size([2, 256])
2025-06-02 15:25:15,389 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:25:15,401 - DEBUG - Initial edge attributes tensor shape: torch.Size([256, 10])
2025-06-02 15:25:15,403 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:25:15,404 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([256, 10])
2025-06-02 15:25:15,404 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:25:15,404 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:25:15,405 - INFO - Updated main graph to 177 nodes and 256 edges.
2025-06-02 15:25:15,406 - INFO - Performing online update...
2025-06-02 15:25:15,406 - INFO - Starting online update for 25 steps.
2025-06-02 15:25:15,407 - DEBUG - Updated RunningStats: new_mean=0.9334048283173413, new_var=5400000000169.0205, new_n=570
2025-06-02 15:25:15,408 - DEBUG - Updated RunningStats: new_mean=0.9222412610521001, new_var=5700000000013.945, new_n=600
2025-06-02 15:25:15,408 - DEBUG - Updated RunningStats: new_mean=30.174165970498258, new_var=1800000231839.238, new_n=190
2025-06-02 15:25:15,408 - DEBUG - Updated RunningStats: new_mean=32.64598704704964, new_var=1900000582512.6309, new_n=200
2025-06-02 15:25:15,409 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:25:15,409 - DEBUG - Online update step: 1/25
2025-06-02 15:25:15,409 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,409 - DEBUG - Online update step: 2/25
2025-06-02 15:25:15,410 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,410 - DEBUG - Online update step: 3/25
2025-06-02 15:25:15,410 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,410 - DEBUG - Online update step: 4/25
2025-06-02 15:25:15,410 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,410 - DEBUG - Online update step: 5/25
2025-06-02 15:25:15,411 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,411 - DEBUG - Online update step: 6/25
2025-06-02 15:25:15,411 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,411 - DEBUG - Online update step: 7/25
2025-06-02 15:25:15,411 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,411 - DEBUG - Online update step: 8/25
2025-06-02 15:25:15,412 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,412 - DEBUG - Online update step: 9/25
2025-06-02 15:25:15,412 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,412 - DEBUG - Online update step: 10/25
2025-06-02 15:25:15,412 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,412 - DEBUG - Online update step: 11/25
2025-06-02 15:25:15,413 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,413 - DEBUG - Online update step: 12/25
2025-06-02 15:25:15,413 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,413 - DEBUG - Online update step: 13/25
2025-06-02 15:25:15,413 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,413 - DEBUG - Online update step: 14/25
2025-06-02 15:25:15,414 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,414 - DEBUG - Online update step: 15/25
2025-06-02 15:25:15,414 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,414 - DEBUG - Online update step: 16/25
2025-06-02 15:25:15,414 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,414 - DEBUG - Online update step: 17/25
2025-06-02 15:25:15,415 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,415 - DEBUG - Online update step: 18/25
2025-06-02 15:25:15,415 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,415 - DEBUG - Online update step: 19/25
2025-06-02 15:25:15,415 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,415 - DEBUG - Online update step: 20/25
2025-06-02 15:25:15,416 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,416 - DEBUG - Online update step: 21/25
2025-06-02 15:25:15,416 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,416 - DEBUG - Online update step: 22/25
2025-06-02 15:25:15,416 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,416 - DEBUG - Online update step: 23/25
2025-06-02 15:25:15,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,417 - DEBUG - Online update step: 24/25
2025-06-02 15:25:15,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,417 - DEBUG - Online update step: 25/25
2025-06-02 15:25:15,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:15,417 - WARNING - No successful steps during online update.
2025-06-02 15:25:15,419 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -5.2869655e-08  1.3806725e-07
  0.0000000e+00  0.0000000e+00  0.0000000e+00  4.8491913e-08
  2.6939952e-09  2.6939952e-09 -3.1654444e-08  1.4816973e-08
  2.6610169e+00  2.9096045e+00  1.8079096e-01  4.3785310e+00
  2.6939952e-09  2.1186440e+00  6.7175140e+00  7.7118645e+00
  1.8079096e-01  8.0000000e+00 -2.4245956e-08  5.3879905e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -4.0409930e-08  1.6163971e-08], current edge mean: [ 9.3132257e-09  5.0284766e+02  0.0000000e+00  0.0000000e+00
  1.3969839e-08  4.6566129e-09  4.1909516e-09 -3.7252903e-09
  9.3132257e-09 -4.6566129e-10]
2025-06-02 15:25:15,419 - DEBUG - Node drift difference: 0.0695, Edge drift difference: 0.1167
2025-06-02 15:25:15,421 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -5.2869655e-08  1.3806725e-07
  0.0000000e+00  0.0000000e+00  0.0000000e+00  4.8491913e-08
  2.6939952e-09  2.6939952e-09 -3.1654444e-08  1.4816973e-08
  2.6610169e+00  2.9096045e+00  1.8079096e-01  4.3785310e+00
  2.6939952e-09  2.1186440e+00  6.7175140e+00  7.7118645e+00
  1.8079096e-01  8.0000000e+00 -2.4245956e-08  5.3879905e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -4.0409930e-08  1.6163971e-08], edge=[ 9.3132257e-09  5.0284766e+02  0.0000000e+00  0.0000000e+00
  1.3969839e-08  4.6566129e-09  4.1909516e-09 -3.7252903e-09
  9.3132257e-09 -4.6566129e-10]
2025-06-02 15:25:15,422 - DEBUG - Updated reference std: node=[0.         0.         1.002837   1.0028368  0.         0.
 0.         1.002837   1.002837   1.0028368  1.002837   1.0028368
 1.3349775  0.4166538  0.41433606 0.65556365 1.0028368  2.234172
 2.4678338  1.3320888  0.41433606 0.         1.0028368  1.002837
 0.         0.         0.         0.         1.002837   1.002837  ], edge=[  1.0019588 789.09216     0.          0.          1.0019588   1.0019588
   1.0019588   1.0019588   1.0019588   1.0019588]
2025-06-02 15:25:15,422 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:25:15,422 - INFO - Running anomaly detection...
2025-06-02 15:25:15,423 - INFO - Starting anomaly detection.
2025-06-02 15:25:15,446 - DEBUG - Node reconstruction errors: [14.457331  13.4999    13.030814  16.329737  14.119668  14.350646
 14.37493   15.475019  15.475021  16.223854  15.475021  11.599978
 13.481602  11.440403  15.084951  15.144629  17.10106   15.1446295
 15.994913  14.723348  15.045633  15.084951  15.789181  10.272107
 14.882489  16.12119   14.882487  13.301182  15.045633  14.882489
  9.899134  15.789181  14.400907  15.728283  15.929242  14.769423
 15.147958  14.723348  10.855417  15.119703  16.077547  14.769423
 14.723348  15.446786  15.690268  15.006654  18.08368   19.617826
 14.7238245 25.270628  25.495747  15.792627  15.81199   14.546698
 14.520096  11.359949  13.467169  14.173077  15.035314  14.8640995
 10.766851  15.870109  14.541767  10.014591  14.557782  14.520096
 14.970088  13.987536  14.541765  14.541765  14.38367   13.070645
 15.59975   13.075069  15.282059  13.075068  15.70993   13.989812
 13.989812  13.98981   15.061221  13.570866  13.879835  15.456278
 16.285929  14.718118  14.339361  13.989812  13.989812  14.610221
 14.191046  14.856385  14.856384  14.138579  14.610219  20.742653
 15.2107725 14.610221  14.356983  14.1474495 14.610219  15.2107725
 14.191649  13.989812  13.835202  14.336812  14.191046  10.409191
 14.718119  20.700224  14.584002  15.061221   9.884139  14.718118
 14.23717   14.1916485 14.19165   11.559365  14.422459  14.610219
 15.019744  14.856384  14.856384  14.856384  13.990518  14.610219
 10.686382  10.218352  14.610219  15.2107725 15.418673  14.422461
 13.835203  10.6313505 14.422459  14.146876  15.71425   14.356983
 14.42246   14.422461  14.422459  15.019744  14.1916485 14.42246
 15.752487  14.42246   14.42246   14.42246   14.600339  14.422461
 17.339205   9.588612  15.260606  14.422461  15.276374  10.796159
 14.610219  14.422459  14.3711815 15.54892   14.422459  10.631334
 14.610219  15.418671  13.990519  10.532847  14.047778  15.210773
 10.631368  14.422459  14.610221  14.610219  14.1916485 20.708082
 14.610221  12.394878  14.422461 ]
2025-06-02 15:25:15,449 - DEBUG - Edge reconstruction errors: [  5.2025385   7.8661222  44.1942      2.364345   12.640416   44.17009
  44.181633   44.170734    7.865223   44.165592   44.180775   44.170475
  44.283348   44.166      44.17101    44.172066   44.172066   10.251483
   7.867077   44.214558   44.18572    45.06803    44.165592   44.284447
  44.42319    44.16559    44.1894     44.165592   44.170513   44.415703
  44.198143   44.16852    44.218327   44.171204   44.17072    45.110676
  44.170395    7.8739314  44.171165   44.908165   44.1707     44.171234
 535.16547     7.867773    7.864232   44.240284   44.165997   44.213146
 808.87164    44.171368   44.167152   44.2735     44.25808    44.274494
  44.39777    44.18677    12.165453   44.203472   44.569233   44.17046
  44.192783   44.17092    44.1701     44.322247   44.18151    44.182896
  44.181835   44.171394   44.16559    44.238483    7.865839   44.25634
  44.165997   44.170456   44.17043    44.170483   44.170155   44.170155
  44.170048   44.1722     44.706135   44.706135   44.177353    9.872662
   2.3645532  58.61031    58.61031    46.37237     7.874332   44.263798
  44.192123   44.17762     7.865265   44.168385   44.165997   44.276184
  44.171013   44.175438   44.175438   44.170475   44.168785   44.220676
  44.168575   44.171864   44.179245   44.179245   44.186375   44.184677
  44.178577   44.178577    5.717185   44.199074   44.174583   44.174583
  44.174725   44.17198    44.17198    44.174      44.174      44.178326
  44.178326   44.17797    44.17797    44.174362   44.174362   44.169796
  44.169796   44.205345   44.205345   44.403084   44.403084   44.58191
  44.58191    44.165592   44.169483   44.176743   44.171135   44.165592
  44.346985   44.16625    44.165592   44.16625    44.171833   44.171833
  44.170822   44.165997   44.18501    44.165592   44.16578    44.170513
  44.199642   44.188725   44.324894   44.222446   44.201275   44.198334
  44.189224   44.18421    44.26503    44.16559    44.245346   44.17101
  44.170425   44.170425   44.18265    44.18265    44.170597   12.165461
  44.170315   44.170563   44.18468     5.5788956   5.6618276  44.16653
   7.8648086  44.165646    7.8737516  58.56653     2.3642797  46.36908
   7.8659806  44.211254   44.165688   44.189606   44.379402   44.191196
  44.177586   44.186436   44.173668   44.17129    45.031685   44.219044
  44.207447   44.174522   44.317795   44.317795   44.16654    44.20453
  44.172222   44.182102    8.171612    9.587911   44.172585   44.172493
  44.28137    44.166138   44.17036     9.152992   13.665329    7.866996
  44.178257   44.178257   44.165546   44.165634   44.165646   44.165676
  44.20118    44.213566   44.173626   44.176117   44.18558    44.2014
  44.165775   44.174923    7.8658385  44.165665   44.182224   44.17734
  44.177044   44.18611    44.302525   44.179127   44.246704   44.246704
  44.175373   44.168568  535.16565    44.17981    44.3471     44.3471
  44.18668    44.18668    44.170902   44.185524   44.17029    44.18016
  44.17052    13.26604     2.3785603  58.56603     2.3765101  46.36772
  44.16845     7.8656893 535.1657    535.16547  ]
2025-06-02 15:25:15,451 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152515_update_11.json
2025-06-02 15:25:15,451 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:25:15,465 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152515_update_11.pth
2025-06-02 15:25:15,466 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869425.dot): 0.2186
2025-06-02 15:25:15,466 - WARNING - Detected 5 anomalous nodes (reconstruction-based):
2025-06-02 15:25:15,466 - WARNING -   Node ID: ff02::2, Recon Error: 25.2706, MLP Score: 0.4426
2025-06-02 15:25:15,466 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 25.4957, MLP Score: 0.4400
2025-06-02 15:25:15,467 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 20.7427, MLP Score: 0.3533
2025-06-02 15:25:15,467 - WARNING -   Node ID: ff02::fb, Recon Error: 20.7002, MLP Score: 0.3658
2025-06-02 15:25:15,467 - WARNING -   Node ID: fe80::3674:28:2588:1274, Recon Error: 20.7081, MLP Score: 0.3562
2025-06-02 15:25:15,467 - WARNING - Detected 5 anomalous edges (reconstruction-based):
2025-06-02 15:25:15,467 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.1655, MLP Score: 0.0000
2025-06-02 15:25:15,468 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.8716, MLP Score: 0.0000
2025-06-02 15:25:15,468 - WARNING -   Source: 192.168.27.10, Target: 224.0.0.251, Recon Error: 535.1656, MLP Score: 0.0000
2025-06-02 15:25:15,468 - WARNING -   Source: fe80::eb4e:a54d:8c61:6ce1, Target: ff02::fb, Recon Error: 535.1657, MLP Score: 0.0000
2025-06-02 15:25:15,468 - WARNING -   Source: fe80::3674:28:2588:1274, Target: ff02::fb, Recon Error: 535.1655, MLP Score: 0.0000
2025-06-02 15:25:15,473 - DEBUG - Embedding standard deviations before t-SNE: [0.8235775  0.01203785 0.         0.45430493 0.         0.
 0.33089387 0.58670706 0.         0.7971952  0.         0.
 0.         0.02141648 0.71648043 0.5619671  0.14919877 0.7845982
 0.         0.6968872  0.         0.68518853 0.         0.
 0.         0.         0.6808008  0.5928128  0.         0.
 0.7582274  0.4999497 ]
2025-06-02 15:25:16,299 - INFO - Embeddings visualization saved to vis/embeddings_11_updates_20250602_152515.png
2025-06-02 15:25:16,300 - INFO - Performing visualization of node and edge features.
2025-06-02 15:25:16,301 - INFO - Starting visualization of node features.
2025-06-02 15:25:16,302 - INFO - Graph has 177 nodes and 30 features.
2025-06-02 15:25:16,302 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:25:16,302 - INFO - Calculating feature statistics:
2025-06-02 15:25:16,303 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:16,303 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:16,303 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 6, 'mean': np.float32(-4.3103924e-08), 'std': np.float32(1.0), 'min': np.float32(-1.8533714), 'max': np.float32(0.91034335)}
2025-06-02 15:25:16,303 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 6, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.90634286), 'max': np.float32(1.8645692)}
2025-06-02 15:25:16,304 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:16,304 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:16,304 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:16,305 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(5.3879905e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.21757132), 'max': np.float32(4.5961943)}
2025-06-02 15:25:16,305 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(8.081986e-09), 'std': np.float32(1.0), 'min': np.float32(-1.064204), 'max': np.float32(0.9396695)}
2025-06-02 15:25:16,305 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 3, 'mean': np.float32(5.3879905e-09), 'std': np.float32(0.9999999), 'min': np.float32(-4.897244), 'max': np.float32(0.21041438)}
2025-06-02 15:25:16,305 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 6, 'mean': np.float32(-4.3103924e-08), 'std': np.float32(1.0), 'min': np.float32(-2.4087965), 'max': np.float32(0.73897755)}
2025-06-02 15:25:16,306 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 6, 'mean': np.float32(4.3103924e-08), 'std': np.float32(1.0), 'min': np.float32(-0.73631406), 'max': np.float32(2.423313)}
2025-06-02 15:25:16,306 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 7, 'mean': np.float32(2.661017), 'std': np.float32(1.3312011), 'min': np.float32(0.0), 'max': np.float32(10.0)}
2025-06-02 15:25:16,306 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.9096045), 'std': np.float32(0.4154752), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:25:16,307 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.18079096), 'std': np.float32(0.41316396), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:25:16,307 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.378531), 'std': np.float32(0.6537092), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:25:16,307 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 3, 'mean': np.float32(-5.3879905e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.21041438), 'max': np.float32(4.897244)}
2025-06-02 15:25:16,307 - INFO - - service_1: {'name': 'service_1', 'unique': 5, 'mean': np.float32(2.118644), 'std': np.float32(2.227852), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 15:25:16,308 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(6.717514), 'std': np.float32(2.4608526), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:25:16,308 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.7118645), 'std': np.float32(1.3283206), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:25:16,308 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.18079096), 'std': np.float32(0.41316396), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:25:16,309 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 1, 'mean': np.float32(8.0), 'std': np.float32(0.0), 'min': np.float32(8.0), 'max': np.float32(8.0)}
2025-06-02 15:25:16,309 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 3, 'mean': np.float32(-4.3103924e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.2046888), 'max': np.float32(6.382569)}
2025-06-02 15:25:16,309 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(5.3879905e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.21757132), 'max': np.float32(4.5961943)}
2025-06-02 15:25:16,309 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:16,310 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:16,310 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:16,310 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:16,311 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(-2.3572458e-08), 'std': np.float32(1.0), 'min': np.float32(-0.8935937), 'max': np.float32(5.248779)}
2025-06-02 15:25:16,311 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(-8.081986e-09), 'std': np.float32(1.0), 'min': np.float32(-0.99771225), 'max': np.float32(4.353653)}
2025-06-02 15:25:16,379 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7f929149e720>
2025-06-02 15:25:17,144 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:25:17,519 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:25:17,695 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:25:22,392 - INFO - Node feature visualization saved to vis/node_features_20250602_152518.png
2025-06-02 15:25:22,392 - INFO - Finished visualization of node features.
2025-06-02 15:25:22,392 - INFO - Performing additional feature analysis:
2025-06-02 15:25:22,392 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:25:22,394 - INFO - Starting visualization of edge features.
2025-06-02 15:25:22,395 - INFO - Graph has 256 edges and 10 edge features.
2025-06-02 15:25:22,395 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:25:22,395 - INFO - Calculating edge feature statistics:
2025-06-02 15:25:22,396 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:25:22,396 - INFO - - count: {'name': 'count', 'unique': 17, 'mean': np.float32(1.4901161e-08), 'std': np.float32(1.0000001), 'min': np.float32(-0.11696286), 'max': np.float32(11.802426)}
2025-06-02 15:25:22,397 - INFO - - dst_port: {'name': 'dst_port', 'unique': 11, 'mean': np.float32(502.84766), 'std': np.float32(787.54944), 'min': np.float32(25.0), 'max': np.float32(8090.0)}
2025-06-02 15:25:22,397 - INFO - - protocol: {'name': 'protocol', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:22,397 - INFO - - service: {'name': 'service', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:22,397 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 175, 'mean': np.float32(1.1175871e-08), 'std': np.float32(1.0), 'min': np.float32(-0.20738153), 'max': np.float32(10.820693)}
2025-06-02 15:25:22,397 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 204, 'mean': np.float32(3.7252903e-09), 'std': np.float32(1.0), 'min': np.float32(-0.18580021), 'max': np.float32(11.406377)}
2025-06-02 15:25:22,397 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 100, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.14294389), 'max': np.float32(11.675713)}
2025-06-02 15:25:22,398 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 180, 'mean': np.float32(-1.1175871e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.26953164), 'max': np.float32(7.8537865)}
2025-06-02 15:25:22,398 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 197, 'mean': np.float32(5.5879354e-09), 'std': np.float32(1.0), 'min': np.float32(-0.2646618), 'max': np.float32(8.580755)}
2025-06-02 15:25:22,398 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 104, 'mean': np.float32(-7.450581e-09), 'std': np.float32(1.0), 'min': np.float32(-0.15828094), 'max': np.float32(11.456623)}
2025-06-02 15:25:22,467 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7f9290b538f0>
2025-06-02 15:25:22,881 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:25:22,948 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7f92a290cce0>
2025-06-02 15:25:23,300 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:25:23,692 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:25:24,108 - DEBUG - Plotted boxplots of the first 8 non-constant edge features.
2025-06-02 15:25:24,195 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:25:24,493 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:25:28,223 - INFO - Edge feature visualization saved to vis/edge_features_20250602_152524.png
2025-06-02 15:25:28,223 - INFO - Finished visualization of edge features.
2025-06-02 15:25:28,223 - INFO - Performing additional edge feature analysis:
2025-06-02 15:25:28,224 - INFO - - 2 out of 10 edge features are constant.
2025-06-02 15:25:28,224 - INFO - - Highest correlation (1.00) between features: 'count' and 'total_orig_pkts'.
2025-06-02 15:25:28,226 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:25:28,227 - INFO - Graph has 256 edges and 10 edge features.
2025-06-02 15:25:28,227 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:25:29,662 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_152528_summary.png
2025-06-02 15:25:30,405 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_152528_pca_3d.png
2025-06-02 15:25:30,926 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_152528_pca_variance.png
2025-06-02 15:25:30,927 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:25:30,927 - INFO - 
--- Processing file: nw_graph_encoded_1748869455.dot (Timestamp: 2025-06-02 15:04:15) ---
2025-06-02 15:25:30,927 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869455.dot
2025-06-02 15:25:30,927 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869455.dot'.
2025-06-02 15:25:30,928 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869455.dot
2025-06-02 15:25:30,937 - INFO - Parsed 256 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869455.dot'.
2025-06-02 15:25:30,960 - INFO - Parsed 395 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869455.dot'.
2025-06-02 15:25:30,960 - INFO - Processing node updates/additions.
2025-06-02 15:25:30,969 - INFO - Processing edge updates/additions.
2025-06-02 15:25:30,994 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:25:30,995 - INFO - Finished updating NetworkX graph.
2025-06-02 15:25:30,996 - DEBUG - Updated graph - Nodes: 256, Edges: 395
2025-06-02 15:25:30,996 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:25:30,998 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:25:31,049 - DEBUG - Initial node features tensor shape: torch.Size([256, 30])
2025-06-02 15:25:31,054 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:25:31,055 - DEBUG - Node features tensor shape after scaling: torch.Size([256, 30])
2025-06-02 15:25:31,056 - DEBUG - Edge index tensor shape: torch.Size([2, 395])
2025-06-02 15:25:31,058 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:25:31,076 - DEBUG - Initial edge attributes tensor shape: torch.Size([395, 10])
2025-06-02 15:25:31,079 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:25:31,079 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([395, 10])
2025-06-02 15:25:31,080 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:25:31,080 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:25:31,081 - INFO - Updated main graph to 256 nodes and 395 edges.
2025-06-02 15:25:31,081 - INFO - Performing online update...
2025-06-02 15:25:31,082 - INFO - Starting online update for 25 steps.
2025-06-02 15:25:31,083 - DEBUG - Updated RunningStats: new_mean=0.9337999609244829, new_var=6000000000166.255, new_n=630
2025-06-02 15:25:31,083 - DEBUG - Updated RunningStats: new_mean=0.9242769022321714, new_var=6300000000015.69, new_n=660
2025-06-02 15:25:31,084 - DEBUG - Updated RunningStats: new_mean=33.37392370493514, new_var=2000000209004.109, new_n=210
2025-06-02 15:25:31,084 - DEBUG - Updated RunningStats: new_mean=34.78187597358649, new_var=2100000372864.2153, new_n=220
2025-06-02 15:25:31,084 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:25:31,085 - DEBUG - Online update step: 1/25
2025-06-02 15:25:31,085 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,085 - DEBUG - Online update step: 2/25
2025-06-02 15:25:31,085 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,085 - DEBUG - Online update step: 3/25
2025-06-02 15:25:31,085 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,086 - DEBUG - Online update step: 4/25
2025-06-02 15:25:31,086 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,086 - DEBUG - Online update step: 5/25
2025-06-02 15:25:31,086 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,086 - DEBUG - Online update step: 6/25
2025-06-02 15:25:31,086 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,086 - DEBUG - Online update step: 7/25
2025-06-02 15:25:31,087 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,087 - DEBUG - Online update step: 8/25
2025-06-02 15:25:31,087 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,087 - DEBUG - Online update step: 9/25
2025-06-02 15:25:31,087 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,087 - DEBUG - Online update step: 10/25
2025-06-02 15:25:31,088 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,088 - DEBUG - Online update step: 11/25
2025-06-02 15:25:31,088 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,088 - DEBUG - Online update step: 12/25
2025-06-02 15:25:31,088 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,088 - DEBUG - Online update step: 13/25
2025-06-02 15:25:31,089 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,089 - DEBUG - Online update step: 14/25
2025-06-02 15:25:31,089 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,089 - DEBUG - Online update step: 15/25
2025-06-02 15:25:31,089 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,089 - DEBUG - Online update step: 16/25
2025-06-02 15:25:31,090 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,090 - DEBUG - Online update step: 17/25
2025-06-02 15:25:31,090 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,090 - DEBUG - Online update step: 18/25
2025-06-02 15:25:31,090 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,090 - DEBUG - Online update step: 19/25
2025-06-02 15:25:31,091 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,091 - DEBUG - Online update step: 20/25
2025-06-02 15:25:31,091 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,091 - DEBUG - Online update step: 21/25
2025-06-02 15:25:31,091 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,091 - DEBUG - Online update step: 22/25
2025-06-02 15:25:31,092 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,092 - DEBUG - Online update step: 23/25
2025-06-02 15:25:31,092 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,092 - DEBUG - Online update step: 24/25
2025-06-02 15:25:31,092 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,092 - DEBUG - Online update step: 25/25
2025-06-02 15:25:31,093 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,093 - WARNING - No successful steps during online update.
2025-06-02 15:25:31,094 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -6.7055225e-08  7.4505806e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.6763806e-08
  1.8626451e-08  3.7252903e-09 -1.1175871e-08 -5.5879354e-09
  2.6054688e+00  2.9296875e+00  1.8750000e-01  4.3476562e+00
 -3.7252903e-09  2.5742188e+00  6.4804688e+00  7.6367188e+00
  1.8750000e-01  8.0000000e+00  4.4703484e-08 -2.4214387e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  3.2829121e-08  2.2351742e-08], current edge mean: [ 1.3279010e-08  4.7932657e+02  0.0000000e+00  0.0000000e+00
  2.4143654e-09 -3.6215480e-09  9.6574615e-09  6.0359135e-09
  0.0000000e+00 -4.8287307e-09]
2025-06-02 15:25:31,094 - DEBUG - Node drift difference: 0.2039, Edge drift difference: 0.0298
2025-06-02 15:25:31,094 - WARNING - Feature drift detected (1 consecutive)
2025-06-02 15:25:31,096 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -6.7055225e-08  7.4505806e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.6763806e-08
  1.8626451e-08  3.7252903e-09 -1.1175871e-08 -5.5879354e-09
  2.6054688e+00  2.9296875e+00  1.8750000e-01  4.3476562e+00
 -3.7252903e-09  2.5742188e+00  6.4804688e+00  7.6367188e+00
  1.8750000e-01  8.0000000e+00  4.4703484e-08 -2.4214387e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  3.2829121e-08  2.2351742e-08], edge=[ 1.3279010e-08  4.7932657e+02  0.0000000e+00  0.0000000e+00
  2.4143654e-09 -3.6215480e-09  9.6574615e-09  6.0359135e-09
  0.0000000e+00 -4.8287307e-09]
2025-06-02 15:25:31,097 - DEBUG - Updated reference std: node=[0.         0.         1.0019588  1.0019588  0.         0.
 0.         1.0019588  1.0019588  1.0019588  1.0019588  1.0019588
 1.209687   0.36907077 0.41064274 0.6137592  1.0019588  2.614132
 2.6151161  1.4622234  0.41064274 0.         1.0019588  1.0019588
 0.         0.         0.         0.         1.0019588  1.0019588 ], edge=[  1.0012683 636.47986     0.          0.          1.0012683   1.0012683
   1.0012683   1.0012683   1.0012681   1.0012683]
2025-06-02 15:25:31,097 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:25:31,097 - INFO - Running anomaly detection...
2025-06-02 15:25:31,097 - INFO - Starting anomaly detection.
2025-06-02 15:25:31,105 - DEBUG - Node reconstruction errors: [15.409522  14.734863  14.138314  16.880106  14.596349  14.7812395
 15.593997  15.946371  15.946368  16.724934  15.946368  12.037973
 16.871864  12.081515  15.463682  15.586208  17.581575  15.586208
 16.634638  15.09659   15.451862  15.463683  16.219225  10.621664
 15.229703  16.626085  15.229703  13.39112   15.451862  15.229703
 10.171907  16.219225  11.058125  16.210411  16.420197  15.080816
 15.630499  15.096589  11.164171  14.81251   16.423111  15.080816
 15.096589  15.689801  16.09371   15.317547  18.522646  20.044582
 15.05819   25.783407  26.475677  16.128962  16.24865   16.143988
 14.885898  11.683352  15.428525  14.425318  15.568777  15.3877735
 11.085244  16.14546   14.794681  10.230157  14.914276  14.6369915
 15.3630085 14.369336  14.794681  14.7946825 14.693084  13.4015665
 15.972251  13.436965  15.557785  13.436963  15.886907  14.282305
 14.282307  14.584196  15.354718  13.917615  14.163644  15.661169
 16.342216  10.860087  14.623989  14.282306  14.282305  13.291028
 14.433923  11.770466  15.080949  13.218974  14.844267  21.769808
 15.438796  14.844267  14.48292   14.406712  13.291027  15.438798
 14.402191  14.282305  14.043868  14.574167  14.401711  10.690913
 15.006687  21.211954  14.839197  15.354718  10.826655  11.516553
 13.82282   13.030217  13.060883  12.517195  14.2274    14.844267
 15.241744  15.080949  11.683972  15.080949  14.211079  14.844267
 10.9134865 10.448824  13.291026  15.438794  15.564174  14.643907
 14.043868  10.869491  14.643907  14.3708515 15.865067  14.48292
 14.643908  14.643906  14.643908  15.241744  14.402191  14.643908
 15.983183  14.643908  14.643907  14.643907  14.7353525 14.643908
 17.645153   9.802485  15.474279  14.643907  15.437973  11.625417
 14.844267  13.030411  14.596195  15.770955  14.643906  10.869494
 14.844267  15.564172  14.211079  10.750733  14.239256  15.438798
 10.36859   14.643907  14.844267  14.844267  14.402191  21.647417
 14.844267  12.836851  14.643908  14.012094  14.572421  14.817475
 14.5547905 15.068363  14.353825  10.465372  15.068361  14.012094
 14.378429  15.665707  14.37843   14.817474  14.572421  14.012094
 15.665707  14.806289  14.402191  15.665707  14.374009  14.40219
 10.912519  15.438796  14.48292   14.844267  10.931979  15.438796
 13.991054  15.080949  15.282617  10.9134865 14.48292   14.48292
 15.42248   14.621655  14.817475  13.991054  14.012094  14.596195
 14.0120945 13.991054  14.817475  14.844267  15.068361  14.37843
 14.37843   14.817474  14.844267  15.425867  14.012094  14.844267
 14.817475  14.892798  15.080949  14.572422  15.241743  13.991055
 13.991054  15.665706  15.172442  14.37843   14.844267  15.408939
 15.068361  14.482921  14.621655  14.643908  14.817474  14.643908
 14.817475  14.012095  14.621655  14.614515  14.402191  14.596195
 14.817475  14.844267  13.9910555 13.991058 ]
2025-06-02 15:25:31,109 - DEBUG - Edge reconstruction errors: [  5.2387066   5.2150564   7.9165573  44.22811     2.4150882  12.258759
  44.21803    44.221684   44.218193    7.915903   44.216553   44.222935
  44.218586   44.270603   44.21675    44.21871    44.21909    44.21909
   9.571588    7.916885   44.231277   44.22629    44.574856   44.216557
  44.281704   44.30434    44.216557   44.225407   44.24645    44.24645
  44.216557   44.239483   44.239483   44.218536   44.22129    44.22129
  44.326836   44.22983    44.21757    44.231537   44.339184   44.339184
  44.21878    44.21851    44.21851    44.218636   44.21862    44.21862
  44.45795    44.21853     7.920195   44.21891    44.518467   44.21862
  44.22012    44.22012    44.21873   535.2165      7.91626     7.914844
  44.236473   44.216747   44.229546  808.9189     44.21881    44.2173
  44.26122    44.255085   44.261703   44.310993   44.2251     12.216418
  44.228928   44.368076   44.21857    44.226086   44.218708   44.21848
  44.27987    44.223057   44.253788   44.2232     44.218803   44.216553
  44.247692    7.9163046  44.252724   44.216747   44.229145   44.22334
  44.22325    44.21837    44.21837    44.219273   44.223473   44.224445
  44.21675    44.21817    44.21817    44.21801    44.21801    44.230244
  44.231087   44.231087   44.218155   44.218155   44.22016    44.218155
  44.218155   44.218384   44.218384   44.22623    44.22623    44.218533
  44.224026   44.224026   44.219074   44.22333    44.22333    44.21895
  44.21895    44.222805   44.222805   44.22082    44.22082    44.220676
  44.220676   44.21847    44.219006   44.218742   44.223816   44.264526
  44.264526   44.218536   44.218586   44.221985   44.221985   44.219135
  44.219135   44.24833    44.24833    44.218616   44.21907    44.218014
  44.218536   44.374306   44.374306   44.219845   12.481746    2.4152725
  58.63622    58.63622    46.419544    7.9266887  44.26921    44.224415
  44.2199      7.9159694  44.217552   44.216747   44.272717   44.223625
  44.22055    44.22055    44.21859    44.22128    44.23142    44.217594
  44.21893    44.22201    44.22201    44.22422    44.22404    44.22177
  44.22177     6.990716   44.22798    44.220097   44.220097   44.219795
  44.21917    44.21917    44.219776   44.219776   44.218834   44.22153
  44.22153    44.221344   44.221344   44.220028   44.220028   44.21874
  44.21874    44.23142    44.23142    44.281796   44.281796   44.42635
  44.42635    44.216557   44.22295    44.217857   44.21972    44.218773
  44.216557   44.229767   44.229767   44.33096    44.253834   44.253834
  44.216877   44.216557   44.227634   44.227634   44.216877   44.218964
  44.218964   44.218647   44.216747   44.223988   44.216557   44.21664
  44.21859    44.230457   44.219116   44.219116   44.22569    44.280888
  44.240047   44.22206    44.22206    44.230537   44.224556   44.224556
  44.229797   44.22518    44.22376    44.24427    44.216557   44.249134
  44.21872    44.218616   44.218616   44.22328    44.22328    44.218613
  12.216425   44.21853    44.218594   44.22381    44.21908    44.22285
  44.216557   44.235275   44.216557   44.226788   44.218616   44.22278
  44.218666   44.2292     44.218723   44.216553   44.223583    7.916923
  44.218594   44.21859    44.218678   44.22074    44.218616   44.21675
  44.229336   44.23742    44.21853    44.218502   44.219612   44.21858
  44.26469    44.216557   44.227333   44.21894    44.216557   44.223576
  44.223576   44.216557   44.35836     7.920739   44.237522   44.216557
  44.222343   44.218735   44.22445    44.2242     44.225216   44.22621
  44.218567   44.218613   44.21863    44.216553   44.259743   44.218754
   5.408417    5.4256144  44.217003   44.221134   44.221134    7.9159408
  44.21657     7.9199824  58.616985    2.4150326  46.41799     7.9166145
  44.235016   44.2166     44.225986   44.298046   44.2264     44.221348
  44.222668   44.220127   44.21891    44.647507   44.24055    44.233856
  44.22025    44.341427   44.341427   44.217007   44.233044   44.218967
  44.22313     8.000728    8.3550005  44.219578   44.21924    44.263233
  44.2168     44.218132    8.240132   13.716564    7.916388   44.2218
  44.2218     44.21653    44.21657    44.21657    44.21659    44.229008
  44.234913   44.21894    44.22051    44.225075   44.233498   44.21664
  44.219803   44.219803   44.219246   12.65185    44.216576   44.22421
  44.221386   44.22217    44.224583   44.26319    44.221054   44.2515
  44.2515     44.220947   44.21792   535.2166     44.22218    44.32139
  44.32139    44.223984   44.223984   44.21858    44.22439    44.218395
  44.222095   44.21838    44.218372   44.218372   44.22184    44.218983
  44.21847    13.317014    2.4217236  58.618977    2.4207745  46.417427
  44.217678    7.91649    58.618385  535.2166    535.2165   ]
2025-06-02 15:25:31,112 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152531_update_12.json
2025-06-02 15:25:31,112 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:25:31,127 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152531_update_12.pth
2025-06-02 15:25:31,127 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869455.dot): 0.2053
2025-06-02 15:25:31,127 - WARNING - Detected 6 anomalous nodes (reconstruction-based):
2025-06-02 15:25:31,127 - WARNING -   Node ID: 150.171.28.10, Recon Error: 20.0446, MLP Score: 0.4193
2025-06-02 15:25:31,127 - WARNING -   Node ID: ff02::2, Recon Error: 25.7834, MLP Score: 0.4247
2025-06-02 15:25:31,128 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 26.4757, MLP Score: 0.4178
2025-06-02 15:25:31,128 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 21.7698, MLP Score: 0.3410
2025-06-02 15:25:31,128 - WARNING -   Node ID: ff02::fb, Recon Error: 21.2120, MLP Score: 0.3529
2025-06-02 15:25:31,128 - WARNING - Detected 5 anomalous edges (reconstruction-based):
2025-06-02 15:25:31,129 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2165, MLP Score: 0.0000
2025-06-02 15:25:31,129 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9189, MLP Score: 0.0000
2025-06-02 15:25:31,129 - WARNING -   Source: 192.168.27.10, Target: 224.0.0.251, Recon Error: 535.2166, MLP Score: 0.0000
2025-06-02 15:25:31,129 - WARNING -   Source: fe80::eb4e:a54d:8c61:6ce1, Target: ff02::fb, Recon Error: 535.2166, MLP Score: 0.0000
2025-06-02 15:25:31,129 - WARNING -   Source: fe80::3674:28:2588:1274, Target: ff02::fb, Recon Error: 535.2165, MLP Score: 0.0000
2025-06-02 15:25:31,130 - INFO - 
--- Processing file: nw_graph_encoded_1748869485.dot (Timestamp: 2025-06-02 15:04:45) ---
2025-06-02 15:25:31,130 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869485.dot
2025-06-02 15:25:31,130 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869485.dot'.
2025-06-02 15:25:31,130 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869485.dot
2025-06-02 15:25:31,147 - INFO - Parsed 300 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869485.dot'.
2025-06-02 15:25:31,182 - INFO - Parsed 503 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869485.dot'.
2025-06-02 15:25:31,182 - INFO - Processing node updates/additions.
2025-06-02 15:25:31,194 - INFO - Processing edge updates/additions.
2025-06-02 15:25:31,229 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:25:31,231 - INFO - Finished updating NetworkX graph.
2025-06-02 15:25:31,233 - DEBUG - Updated graph - Nodes: 300, Edges: 503
2025-06-02 15:25:31,233 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:25:31,235 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:25:31,295 - DEBUG - Initial node features tensor shape: torch.Size([300, 30])
2025-06-02 15:25:31,297 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:25:31,298 - DEBUG - Node features tensor shape after scaling: torch.Size([300, 30])
2025-06-02 15:25:31,299 - DEBUG - Edge index tensor shape: torch.Size([2, 503])
2025-06-02 15:25:31,303 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:25:31,325 - DEBUG - Initial edge attributes tensor shape: torch.Size([503, 10])
2025-06-02 15:25:31,327 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:25:31,328 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([503, 10])
2025-06-02 15:25:31,328 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:25:31,328 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:25:31,330 - INFO - Updated main graph to 300 nodes and 503 edges.
2025-06-02 15:25:31,330 - INFO - Performing online update...
2025-06-02 15:25:31,330 - INFO - Starting online update for 25 steps.
2025-06-02 15:25:31,331 - DEBUG - Updated RunningStats: new_mean=0.9347527855032551, new_var=6600000000164.882, new_n=690
2025-06-02 15:25:31,332 - DEBUG - Updated RunningStats: new_mean=0.9262884809244796, new_var=6900000000016.829, new_n=720
2025-06-02 15:25:31,332 - DEBUG - Updated RunningStats: new_mean=35.3009109654796, new_var=2200000197808.722, new_n=230
2025-06-02 15:25:31,332 - DEBUG - Updated RunningStats: new_mean=36.21617990654274, new_var=2300000291814.5024, new_n=240
2025-06-02 15:25:31,333 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:25:31,333 - DEBUG - Online update step: 1/25
2025-06-02 15:25:31,333 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,333 - DEBUG - Online update step: 2/25
2025-06-02 15:25:31,334 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,334 - DEBUG - Online update step: 3/25
2025-06-02 15:25:31,334 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,334 - DEBUG - Online update step: 4/25
2025-06-02 15:25:31,334 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,334 - DEBUG - Online update step: 5/25
2025-06-02 15:25:31,335 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,335 - DEBUG - Online update step: 6/25
2025-06-02 15:25:31,335 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,335 - DEBUG - Online update step: 7/25
2025-06-02 15:25:31,335 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,335 - DEBUG - Online update step: 8/25
2025-06-02 15:25:31,336 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,336 - DEBUG - Online update step: 9/25
2025-06-02 15:25:31,336 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,336 - DEBUG - Online update step: 10/25
2025-06-02 15:25:31,336 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,336 - DEBUG - Online update step: 11/25
2025-06-02 15:25:31,336 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,337 - DEBUG - Online update step: 12/25
2025-06-02 15:25:31,337 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,337 - DEBUG - Online update step: 13/25
2025-06-02 15:25:31,337 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,337 - DEBUG - Online update step: 14/25
2025-06-02 15:25:31,337 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,338 - DEBUG - Online update step: 15/25
2025-06-02 15:25:31,338 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,338 - DEBUG - Online update step: 16/25
2025-06-02 15:25:31,338 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,338 - DEBUG - Online update step: 17/25
2025-06-02 15:25:31,338 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,339 - DEBUG - Online update step: 18/25
2025-06-02 15:25:31,339 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,339 - DEBUG - Online update step: 19/25
2025-06-02 15:25:31,339 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,339 - DEBUG - Online update step: 20/25
2025-06-02 15:25:31,339 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,340 - DEBUG - Online update step: 21/25
2025-06-02 15:25:31,340 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,340 - DEBUG - Online update step: 22/25
2025-06-02 15:25:31,340 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,340 - DEBUG - Online update step: 23/25
2025-06-02 15:25:31,340 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,340 - DEBUG - Online update step: 24/25
2025-06-02 15:25:31,341 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,341 - DEBUG - Online update step: 25/25
2025-06-02 15:25:31,341 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,341 - WARNING - No successful steps during online update.
2025-06-02 15:25:31,342 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -4.4504802e-08  8.2651773e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.7815501e-08
  2.7020773e-08 -7.9472864e-09  2.2252401e-08  1.5894572e-09
  2.6233332e+00  2.9400001e+00  1.6666667e-01  4.3433332e+00
  9.5367430e-09  2.8033333e+00  6.3033333e+00  7.6100001e+00
  1.6666667e-01  8.0000000e+00 -4.1325887e-08 -7.9472864e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -1.5894573e-08 -3.2583873e-08], current edge mean: [ 1.1849830e-08  4.6719681e+02  0.0000000e+00  0.0000000e+00
  5.6879186e-09 -4.7399318e-10 -3.3179524e-09 -2.8439593e-09
  1.8959727e-09 -2.8439593e-09]
2025-06-02 15:25:31,343 - DEBUG - Node drift difference: 0.0876, Edge drift difference: 0.0191
2025-06-02 15:25:31,344 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -4.4504802e-08  8.2651773e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.7815501e-08
  2.7020773e-08 -7.9472864e-09  2.2252401e-08  1.5894572e-09
  2.6233332e+00  2.9400001e+00  1.6666667e-01  4.3433332e+00
  9.5367430e-09  2.8033333e+00  6.3033333e+00  7.6100001e+00
  1.6666667e-01  8.0000000e+00 -4.1325887e-08 -7.9472864e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -1.5894573e-08 -3.2583873e-08], edge=[ 1.1849830e-08  4.6719681e+02  0.0000000e+00  0.0000000e+00
  5.6879186e-09 -4.7399318e-10 -3.3179524e-09 -2.8439593e-09
  1.8959727e-09 -2.8439593e-09]
2025-06-02 15:25:31,345 - DEBUG - Updated reference std: node=[0.         0.         1.0016708  1.0016708  0.         0.
 0.         1.0016708  1.0016708  1.0016708  1.0016708  1.0016708
 1.1858089  0.34174448 0.39080855 0.5999907  1.0016708  2.8067029
 2.7072284  1.5051417  0.39080855 0.         1.0016708  1.0016708
 0.         0.         0.         0.         1.0016708  1.0016708 ], edge=[  1.0009955 565.6667      0.          0.          1.0009955   1.0009955
   1.0009955   1.0009954   1.0009955   1.0009955]
2025-06-02 15:25:31,345 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:25:31,345 - INFO - Running anomaly detection...
2025-06-02 15:25:31,346 - INFO - Starting anomaly detection.
2025-06-02 15:25:31,353 - DEBUG - Node reconstruction errors: [15.683145  15.233804  15.930745  17.107084  11.575315  14.792647
 15.930745  16.33293   16.33293   17.126863  16.33293   12.347523
 19.16451   12.991323  15.787432  15.971505  17.961693  15.971502
 17.224154  15.427072  15.780973  15.787432  15.815821  10.906251
 15.522823  16.815342  15.522824  13.336612  15.780973  15.522824
 10.424618  16.567999  11.297864  16.58628   16.815342  15.36087
 14.867919  15.42707   11.497629  15.004045  16.71721   15.36087
 15.42707   15.914534  16.42848   15.595423  18.864979  20.366594
 15.340417  26.102537  27.088428  16.41066   16.378674  16.525408
 14.670852  11.869719  16.04814   14.6636915 15.877775  15.877776
 11.162414  16.394062  15.033457  10.422889  15.0071    14.6708555
 14.62978   14.408583  15.033457  15.033456  14.734224  13.467597
 16.057362  13.367115  15.464621  13.522526  16.073149  14.154787
 13.311959  14.242038  15.611843  14.047244  14.400806  15.718572
 16.166693  10.972486  13.559274  13.31195   14.079484  13.296665
 14.6679325 12.848784  15.106352  14.153822  14.858307  22.358915
 15.469929  13.296665  14.646928  14.635725  13.296666  15.469929
 14.619599  14.313668  14.253264  14.591181  14.611556  10.92907
 15.251482  21.481436  15.072526  15.611841  11.052606  11.747718
 14.1340275 13.296565  13.351413  12.130707  14.205175  14.858311
 15.469929  15.106352  11.669786  15.106352  14.199922  14.858307
 10.953471  10.429773  13.296667  15.418126  15.72956   14.858307
 14.253263  12.52617   13.296666  14.59118   16.04125   14.646929
 14.858306  13.296665  14.858307  15.469929  14.619598  14.858307
 16.216646  14.858306  13.296666  14.858306  14.886862  14.858306
 17.789661   9.987447  14.4614315 14.858306  15.130552  12.137568
 14.858306  14.069937  13.296667  16.000935  14.858306  11.086416
 14.858306  15.729563  14.199921  11.698421  13.533588  14.205167
 10.516127  14.858306  14.2051735 14.858306  14.619601  22.169756
 13.296668  13.252124  13.296661  14.179046  14.559025  14.800645
 14.530531  10.934947  14.342907  10.444928  15.057729  14.179044
 14.559026  15.6488285 14.559025  14.800643  14.559026  13.321276
 15.6488285 14.807053  14.6196    15.648828  14.399041  14.619599
 10.933988  15.469929  14.646928  14.858306  11.024473  15.655745
 14.046999  15.106352  15.449639  11.94968   14.646928  15.250214
 15.413768  14.800644  15.6488285 14.199921  14.179045  14.619599
 14.179044  14.199921  14.800643  14.807052  15.057728  14.559025
 14.559025  15.648828  14.858306  15.081989  14.179046  14.858308
 14.800643  15.106354  10.933989  14.559027  13.296665  14.199922
 14.199922  15.6488285 15.081989  14.559027  14.858307  15.418127
 15.057729  14.646928  14.800644  14.858308  14.800644  13.296666
 14.800643  14.179045  14.800643  14.497128  14.619598  14.619599
 14.800643  14.858306  14.199922  14.199922  14.800643  14.581462
 14.559026  14.800643  14.365526  15.057731  15.057731  14.800643
 14.800645  14.800643  14.39967   15.057731  14.399672  15.6488285
 15.057729  15.057729  15.081989  16.00222   14.399671  15.6488285
 14.559025  15.648828  14.53053   14.800643  15.081989  14.559027
 15.413766  16.00222   14.800643  15.456863  14.179045  11.060699
 10.934949  14.342907  15.648828  15.413768  15.179434  14.800643
 14.342907  14.581462  14.800645  14.559025  15.648828  14.194141 ]
2025-06-02 15:25:31,358 - DEBUG - Edge reconstruction errors: [  5.2423153   5.219646    7.920924   44.23969     2.4194815  12.109304
  44.2223     44.22607    44.222477    7.920212   44.220787   44.227085
  44.2228     44.27738    44.22098    44.22294    44.22332    44.22332
   9.699672    7.9211526  44.236107   44.23016    44.577164   44.22079
  44.28543    44.310196   44.22079    44.229687   44.252087   44.252087
  44.22079    44.245235   44.245235   44.22275    44.225533   44.225533
  44.33364    44.23395    44.221825   44.236553   44.349483   44.349483
  44.223007   44.22275    44.22275    44.222855   44.222836   44.222836
  44.480183   44.222748    7.924336   44.22312    44.519985   44.222847
  44.23088    44.23088    44.22297   535.2207      7.9267716   7.9193816
  44.24201    44.277657   44.277657   44.22098    44.234566   44.22265
  44.22265   808.92316    44.223038   44.22151    44.264946   44.25884
  44.26541    44.314407   44.229267   44.22463    44.22463    12.220668
  44.233482   44.222412   44.222412   44.372715   44.22279    44.230453
  44.222935   44.222694   44.28359    44.22723    44.223473   44.223473
  44.257507   44.22738    44.223038   44.225037   44.225037   44.22079
  44.25144    44.224583   44.224583    7.9205885  44.256737   44.222477
  44.222477   44.220978   44.23323    44.227486   44.227406   44.2226
  44.2226     44.223476   44.22235    44.22235    44.227646   44.22866
  44.222622   44.222622   44.22098    44.22241    44.22241    44.22225
  44.22225    44.243664   44.235348   44.235348   44.222393   44.222393
  44.224365   44.222393   44.222393   44.22263    44.22263    44.230568
  44.230568   44.22274    44.228294   44.228294   44.223305   44.227604
  44.227604   44.223194   44.223194   44.226933   44.226933   44.22524
  44.22524    44.224842   44.224842   44.222694   44.223213   44.222958
  44.227993   44.271725   44.271725   44.22738    44.227425   44.226135
  44.226135   44.22335    44.22335    44.254566   44.254566   44.22285
  44.22331     7.923296    7.928785   44.23779    44.23779    44.24271
  44.24271    44.222862   44.22192    44.22192    44.23646    44.23646
  44.222294   44.22749    44.385944   44.385944   44.22079    44.224262
  13.423673    2.4194815  58.640026   58.640026   46.423714    7.9350424
  44.287937   44.228992   44.224323    7.920188   44.226856   44.220978
  44.3201     44.227806   44.224762   44.224762   44.24015    44.225563
  44.23659    44.225407   44.228504   44.22622    44.22622    44.228504
  44.228252   44.22598    44.22598    10.740885   44.232426   44.224323
  44.224323   44.224064   44.223385   44.223385   44.223152   44.22402
  44.22402    44.22786    44.225758   44.225758   44.223248   44.225574
  44.225574   44.26957    44.230415   44.230415   44.222893   44.222893
  44.22345    44.23572    44.23572    44.22408    44.289883   44.289883
  44.43697    44.43697    44.22079    44.22702    44.222122   44.224125
  44.223      44.22079    44.233982   44.233982   44.340645   44.26048
  44.26048    44.221096   44.22079    44.231697   44.231697   44.221096
  44.223198   44.223198   44.222878   44.220978   44.22822    44.22079
  44.220875   44.22704    44.234562   44.223354   44.223354   44.22989
  44.224957   44.224957   44.28462    44.24402    44.226215   44.226215
  44.234726   44.228703   44.228703   44.23393    44.22948    44.224445
  44.224445   44.227985   44.250057   44.2356     44.2356     44.22079
  44.253056   44.25872    44.25872    44.22294    44.222828   44.222828
  44.227497   44.227497   44.22707    44.223194   44.223194   12.220668
  44.222744   44.227036   44.246178   44.222767   44.222767   44.223225
  44.227016   44.22626    44.22626    44.22079    44.299137   44.22079
  44.231144   44.22282    44.22693    44.222878   44.263687   44.222946
  44.220787   44.227795    7.9211307  44.2228     44.222797   44.237812
  44.225048   44.222824   44.220978   44.223816   44.242664   44.25284
  44.222744   44.222713   44.223812   44.22279    44.268562   44.22079
  44.23217    44.223145   44.22079    44.227707   44.227707   44.22079
  44.36902     7.9248285  44.241497   44.220787   44.22329    44.232647
  44.222946   44.22866    44.2284     44.229504   44.230515   44.22735
  44.22745    44.222847   44.220787   44.264324   44.235607   44.231525
  44.22284    44.220787   44.22322    44.227657   44.22162    44.222958
  44.225307   44.247303   44.22831    44.223473   44.227356   44.23467
  44.23776    44.222965   44.230537   44.22079    44.22079    44.25143
  44.22752     7.92017    44.228977   44.227596   44.225124   44.22294
  44.222893    7.92017     7.92017     7.920258   44.228065   44.222958
  44.228893   44.223526   44.223526   44.22292     5.4622703   5.451073
  44.221226   44.232666   44.232666    7.920233   44.220818    7.924172
  58.62121     2.4194093  46.422215    7.9209332  44.239067   44.22084
  44.230198   44.302387   44.23063    44.225563   44.227184   44.2243
  44.22312    44.63745    44.244274   44.2379     44.224445   44.343548
  44.343548   44.221226   44.23705    44.23003    44.227333    8.010006
   8.392317   44.223763   44.223473   44.267166   44.22104    44.222404
   8.269697   13.7208185   7.921154   44.237648   44.237648   44.2671
  44.22077    44.220814   44.220818   44.22083    44.23342    44.239147
  44.223286   44.224754   44.229187   44.237267   44.220875   44.224014
  44.224014   44.223614   13.006366   44.22082    44.228264   44.22557
  44.22623    44.228794   44.268257   44.225388   44.255177   44.255177
  44.22509    44.31584   535.2208     44.226395   44.33179    44.33179
  44.384136   44.228317   44.228317   44.234005   44.22282    44.2286
  44.222626   44.22634    44.222626   44.222603   44.26727    44.26727
  44.222603   44.22605    44.223183   44.22271    44.224365   44.22458
  44.221924   44.22439    44.22439    44.230614   44.230614   44.223137
  44.223137   44.27755    44.27755    44.22271    44.224224   44.224113
  44.228153   13.321231    2.4258568  58.62316     2.4249375  46.421654
  44.221916    7.920783   58.62259   535.2208    535.2207   ]
2025-06-02 15:25:31,360 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152531_update_13.json
2025-06-02 15:25:31,361 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:25:31,375 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152531_update_13.pth
2025-06-02 15:25:31,375 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869485.dot): 0.1918
2025-06-02 15:25:31,375 - WARNING - Detected 6 anomalous nodes (reconstruction-based):
2025-06-02 15:25:31,375 - WARNING -   Node ID: 150.171.28.10, Recon Error: 20.3666, MLP Score: 0.4063
2025-06-02 15:25:31,376 - WARNING -   Node ID: ff02::2, Recon Error: 26.1025, MLP Score: 0.4166
2025-06-02 15:25:31,376 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 27.0884, MLP Score: 0.4121
2025-06-02 15:25:31,376 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 22.3589, MLP Score: 0.3360
2025-06-02 15:25:31,376 - WARNING -   Node ID: ff02::fb, Recon Error: 21.4814, MLP Score: 0.3468
2025-06-02 15:25:31,376 - WARNING - Detected 5 anomalous edges (reconstruction-based):
2025-06-02 15:25:31,377 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2207, MLP Score: 0.0000
2025-06-02 15:25:31,377 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9232, MLP Score: 0.0000
2025-06-02 15:25:31,377 - WARNING -   Source: 192.168.27.10, Target: 224.0.0.251, Recon Error: 535.2208, MLP Score: 0.0000
2025-06-02 15:25:31,377 - WARNING -   Source: fe80::eb4e:a54d:8c61:6ce1, Target: ff02::fb, Recon Error: 535.2208, MLP Score: 0.0000
2025-06-02 15:25:31,378 - WARNING -   Source: fe80::3674:28:2588:1274, Target: ff02::fb, Recon Error: 535.2207, MLP Score: 0.0000
2025-06-02 15:25:31,378 - INFO - 
--- Processing file: nw_graph_encoded_1748869515.dot (Timestamp: 2025-06-02 15:05:15) ---
2025-06-02 15:25:31,378 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869515.dot
2025-06-02 15:25:31,378 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869515.dot'.
2025-06-02 15:25:31,378 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869515.dot
2025-06-02 15:25:31,391 - INFO - Parsed 366 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869515.dot'.
2025-06-02 15:25:31,426 - INFO - Parsed 657 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869515.dot'.
2025-06-02 15:25:31,427 - INFO - Processing node updates/additions.
2025-06-02 15:25:31,441 - INFO - Processing edge updates/additions.
2025-06-02 15:25:31,485 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:25:31,487 - INFO - Finished updating NetworkX graph.
2025-06-02 15:25:31,489 - DEBUG - Updated graph - Nodes: 366, Edges: 657
2025-06-02 15:25:31,489 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:25:31,492 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:25:31,563 - DEBUG - Initial node features tensor shape: torch.Size([366, 30])
2025-06-02 15:25:31,566 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:25:31,566 - DEBUG - Node features tensor shape after scaling: torch.Size([366, 30])
2025-06-02 15:25:31,568 - DEBUG - Edge index tensor shape: torch.Size([2, 657])
2025-06-02 15:25:31,572 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:25:31,602 - DEBUG - Initial edge attributes tensor shape: torch.Size([657, 10])
2025-06-02 15:25:31,604 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:25:31,605 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([657, 10])
2025-06-02 15:25:31,605 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:25:31,606 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:25:31,607 - INFO - Updated main graph to 366 nodes and 657 edges.
2025-06-02 15:25:31,607 - INFO - Performing online update...
2025-06-02 15:25:31,608 - INFO - Starting online update for 25 steps.
2025-06-02 15:25:31,609 - DEBUG - Updated RunningStats: new_mean=0.935834391445297, new_var=7200000000163.704, new_n=750
2025-06-02 15:25:31,609 - DEBUG - Updated RunningStats: new_mean=0.9281153465791945, new_var=7500000000017.779, new_n=780
2025-06-02 15:25:31,610 - DEBUG - Updated RunningStats: new_mean=36.59835155798954, new_var=2400000189420.574, new_n=250
2025-06-02 15:25:31,610 - DEBUG - Updated RunningStats: new_mean=37.12717176287948, new_var=2500000222959.7417, new_n=260
2025-06-02 15:25:31,610 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:25:31,611 - DEBUG - Online update step: 1/25
2025-06-02 15:25:31,611 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,611 - DEBUG - Online update step: 2/25
2025-06-02 15:25:31,611 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,611 - DEBUG - Online update step: 3/25
2025-06-02 15:25:31,612 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,612 - DEBUG - Online update step: 4/25
2025-06-02 15:25:31,612 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,612 - DEBUG - Online update step: 5/25
2025-06-02 15:25:31,612 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,612 - DEBUG - Online update step: 6/25
2025-06-02 15:25:31,612 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,613 - DEBUG - Online update step: 7/25
2025-06-02 15:25:31,613 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,613 - DEBUG - Online update step: 8/25
2025-06-02 15:25:31,613 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,613 - DEBUG - Online update step: 9/25
2025-06-02 15:25:31,613 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,614 - DEBUG - Online update step: 10/25
2025-06-02 15:25:31,614 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,614 - DEBUG - Online update step: 11/25
2025-06-02 15:25:31,614 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,614 - DEBUG - Online update step: 12/25
2025-06-02 15:25:31,614 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,615 - DEBUG - Online update step: 13/25
2025-06-02 15:25:31,615 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,615 - DEBUG - Online update step: 14/25
2025-06-02 15:25:31,615 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,615 - DEBUG - Online update step: 15/25
2025-06-02 15:25:31,615 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,616 - DEBUG - Online update step: 16/25
2025-06-02 15:25:31,616 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,616 - DEBUG - Online update step: 17/25
2025-06-02 15:25:31,616 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,616 - DEBUG - Online update step: 18/25
2025-06-02 15:25:31,616 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,617 - DEBUG - Online update step: 19/25
2025-06-02 15:25:31,617 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,617 - DEBUG - Online update step: 20/25
2025-06-02 15:25:31,617 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,617 - DEBUG - Online update step: 21/25
2025-06-02 15:25:31,617 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,617 - DEBUG - Online update step: 22/25
2025-06-02 15:25:31,618 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,618 - DEBUG - Online update step: 23/25
2025-06-02 15:25:31,618 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,618 - DEBUG - Online update step: 24/25
2025-06-02 15:25:31,618 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,618 - DEBUG - Online update step: 25/25
2025-06-02 15:25:31,619 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,619 - WARNING - No successful steps during online update.
2025-06-02 15:25:31,620 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -1.7588256e-08  5.6021850e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.4753842e-08
 -3.9085013e-08 -2.6056675e-09  2.6056675e-08 -5.3090474e-08
  2.5655737e+00  2.9508197e+00  1.4480874e-01  4.3879781e+00
  2.6056675e-09  3.0710382e+00  6.0846996e+00  7.5983605e+00
  1.4480874e-01  8.0000000e+00  5.2113349e-09 -1.0422670e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.5176512e-08  1.6936839e-08], current edge mean: [ 2.1773385e-09  4.5770471e+02  0.0000000e+00  0.0000000e+00
  4.3546771e-09  7.2577953e-09  5.0804569e-09 -1.0160914e-08
  0.0000000e+00  4.3546771e-09]
2025-06-02 15:25:31,620 - DEBUG - Node drift difference: 0.0954, Edge drift difference: 0.0168
2025-06-02 15:25:31,622 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -1.7588256e-08  5.6021850e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.4753842e-08
 -3.9085013e-08 -2.6056675e-09  2.6056675e-08 -5.3090474e-08
  2.5655737e+00  2.9508197e+00  1.4480874e-01  4.3879781e+00
  2.6056675e-09  3.0710382e+00  6.0846996e+00  7.5983605e+00
  1.4480874e-01  8.0000000e+00  5.2113349e-09 -1.0422670e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.5176512e-08  1.6936839e-08], edge=[ 2.1773385e-09  4.5770471e+02  0.0000000e+00  0.0000000e+00
  4.3546771e-09  7.2577953e-09  5.0804569e-09 -1.0160914e-08
  0.0000000e+00  4.3546771e-09]
2025-06-02 15:25:31,622 - DEBUG - Updated reference std: node=[0.         0.         1.0013689  1.0013689  0.         0.
 0.         1.0013689  1.001369   1.0013689  1.001369   1.0013689
 1.1053125  0.31016898 0.38222542 0.589653   1.0013689  2.9452322
 2.8023348  1.5205975  0.38222542 0.         1.001369   1.001369
 0.         0.         0.         0.         1.0013689  1.0013689 ], edge=[  1.0007619 496.47144     0.          0.          1.0007619   1.0007619
   1.000762    1.0007619   1.0007619   1.000762 ]
2025-06-02 15:25:31,623 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:25:31,623 - INFO - Running anomaly detection...
2025-06-02 15:25:31,624 - INFO - Starting anomaly detection.
2025-06-02 15:25:31,635 - DEBUG - Node reconstruction errors: [15.681346  15.765942  16.630001  17.324993  12.541055  14.74582
 16.630001  16.199282  16.199282  16.9926    16.199282  12.218877
 19.337467  12.40595   15.598218  15.832614  12.404496  15.832613
 17.43849   15.250991  14.621067  15.598215  15.983112  10.416996
 15.30357   17.028692  15.30357   12.735702  15.616914  15.30357
 10.292136  16.399334  11.058499  16.767323  17.028688  15.874156
 14.937974  15.250991  11.953451  14.68452   16.479107  15.129531
 15.250991  16.047045  16.230871  15.374632  18.676855  11.621609
 15.137617  27.20348   27.472246  16.180403  16.542252  16.531729
 14.700413  11.916953  16.593184  14.398413  16.304634  16.304634
 11.23108   15.697859  14.757112  10.213044  15.113336  14.700412
 14.677634  14.45203   14.757112  14.757112  14.80685   13.614013
 16.173197  14.242166  14.986167  13.682565  15.70142   14.207445
 14.925603  14.151528  15.678245  14.142655  14.467782  15.330051
 15.949146  10.379643  13.637105  14.151517  14.925601  13.324224
 14.704169  12.677983  15.125364  14.06418   14.3204775 22.765516
 15.495096  13.364299  14.183573  14.680289  13.364299  15.495096
 15.925416  14.437158   9.987128  14.619372  14.586837  11.010024
 15.32173   21.406277  14.917706  15.473886  11.110978  11.81251
 14.2564125 13.364243  13.45087   11.950165  14.099208  14.887823
 14.5228615 15.125364  11.688139  10.943529  14.940656  14.887823
 10.999677  10.452071  13.3643    15.416003  15.24535   14.887823
 14.27361   12.588482  13.3643    14.619371  15.541841  14.282713
 14.887823  13.364301  14.887823  14.223339  14.644124  14.887823
 16.245516  13.364227  13.3643    14.887822  14.412678  14.099193
 17.80081    9.987136  14.008465  14.887823  15.028049  11.976892
 14.887823  14.141111  13.364301  16.02073   14.887823  11.152764
 14.887821  15.245351  14.265152  11.723373  13.303318  14.099206
 10.554883  13.36428   14.09921   14.810381  14.644124  21.433294
 13.364299  13.396824  13.364295  14.197066  13.327866  13.327868
 14.518332  10.930085  14.018056  11.023921  15.027079  14.197067
 14.5360365 13.344951  14.536035  14.789597  14.754591  14.734164
 15.63474   14.810381  14.644124  15.634739  14.419878  14.644125
 11.910958  15.495097  14.282713  14.887823  11.070524  14.099192
 14.117666  15.125364  14.972228  11.972399  14.135862  13.951333
 13.924808  13.327869  15.634741  13.3643    14.197064  14.644125
 14.197067  14.265152  13.227193  14.810381  10.976473  14.536035
 14.536035  15.634742  14.887823  14.932189  14.197064  14.887823
 14.051435  15.125364  10.943529  13.327867  13.364299  14.265152
 14.265152  15.63474   14.932188  14.536035  14.887823  15.416005
 12.625685  13.24907   14.789598  13.320663  14.789597  13.3643
 13.327755  14.197067  14.789597  14.47794   14.644124  14.644123
 13.227197  14.099209  14.265152  14.265152  14.789598  14.176373
 14.536035  14.789597  13.261836  15.027079  15.027079  14.789597
 14.789597  14.310353  13.261837  15.027079  13.261839  15.634741
 15.027079  15.027079  14.018481  15.526105  13.261835  15.634742
 14.5360365 15.634739  14.518332  14.789598  14.932188  14.536035
 15.394723  15.559087  14.789597  15.018794  11.653757  11.074073
 10.930085  14.318115  14.310212  15.394721  14.746619  14.789598
 14.318115  14.176373  14.789598  14.5360365 15.63474   14.168637
 15.623971  14.153443  14.153443  14.153443  14.153443  14.153443
 14.153443  14.153443  14.153443  14.15344   14.15344   14.153443
 14.15344   15.623971  13.778698  14.343634  14.167834  15.026008
 15.623965  15.610241  14.176373  14.176371  14.932189  14.153443
 14.536035  10.45324   14.123429  14.153443  13.316088  13.261838
 14.152943  15.623968  14.15344   13.261837  14.153443  14.153443
 14.769911  14.536035  14.123431  14.123428  14.15344   14.318116
 14.123431  13.261839  14.153443  13.261838  14.153443  14.978551
 14.858455  15.394721  14.153443  14.754591  15.027079  14.215333
 14.318115  15.63474   14.153443  14.153443  14.176371  14.176371
 14.197064  14.153443  14.123431  14.15344   14.15344   27.191532 ]
2025-06-02 15:25:31,644 - DEBUG - Edge reconstruction errors: [5.2461128e+00 5.2248707e+00 7.9260821e+00 4.4243015e+01 2.4245994e+00
 1.1593778e+01 4.4227238e+01 4.4230370e+01 4.4227371e+01 7.9253759e+00
 4.4225967e+01 4.4228165e+01 4.4237873e+01 4.4227795e+01 4.4271446e+01
 4.4226147e+01 4.4232307e+01 4.4228226e+01 4.4228226e+01 9.3747845e+00
 7.9262910e+00 4.4238445e+01 4.4234875e+01 4.4545704e+01 4.4225971e+01
 4.4284245e+01 4.4332985e+01 4.4225971e+01 4.4233780e+01 4.4251133e+01
 4.4251133e+01 4.4225971e+01 4.4244839e+01 4.4244839e+01 4.4227737e+01
 4.4230167e+01 4.4230167e+01 4.4349236e+01 4.4237873e+01 4.4226856e+01
 4.4238506e+01 4.4328922e+01 4.4328922e+01 4.4227955e+01 4.4227695e+01
 4.4227695e+01 4.4227833e+01 4.4227825e+01 4.4227825e+01 4.4926384e+01
 4.4232327e+01 7.9281673e+00 7.9251313e+00 4.4228096e+01 4.4496292e+01
 4.4227821e+01 4.4234577e+01 4.4234577e+01 4.4227905e+01 5.3522595e+02
 7.9375315e+00 7.9246435e+00 4.4242382e+01 4.4269535e+01 4.4269535e+01
 4.4226147e+01 4.4236740e+01 4.4227558e+01 4.4227558e+01 8.0892810e+02
 4.4227978e+01 4.4226650e+01 4.4266068e+01 4.4260593e+01 4.4228947e+01
 4.4228947e+01 4.4266510e+01 4.4310551e+01 4.4229576e+01 4.4229576e+01
 4.4233616e+01 4.4229416e+01 4.4229416e+01 1.2225846e+01 4.4236637e+01
 4.4227455e+01 4.4227455e+01 4.4359921e+01 4.4231422e+01 4.4231422e+01
 4.4227783e+01 4.4234299e+01 4.4227898e+01 4.4227711e+01 4.4231415e+01
 4.4231415e+01 4.4282604e+01 4.4231789e+01 4.4228382e+01 4.4228382e+01
 4.4259487e+01 4.4231926e+01 4.4227970e+01 4.4229767e+01 4.4229767e+01
 4.4225971e+01 4.4254055e+01 4.4229549e+01 4.4229549e+01 7.9257574e+00
 4.4258251e+01 4.4227451e+01 4.4227451e+01 4.4226143e+01 4.4237289e+01
 4.4232075e+01 4.4231995e+01 4.4227589e+01 4.4227589e+01 4.4228405e+01
 4.4227341e+01 4.4227341e+01 4.4232162e+01 4.4227741e+01 4.4227741e+01
 4.4232979e+01 4.4227543e+01 4.4227543e+01 4.4226147e+01 4.4227402e+01
 4.4227402e+01 4.4227253e+01 4.4227253e+01 4.4246834e+01 4.4238804e+01
 4.4238804e+01 4.4227386e+01 4.4227386e+01 4.4229195e+01 4.4227383e+01
 4.4227383e+01 4.4227577e+01 4.4227577e+01 4.4234459e+01 4.4234459e+01
 4.4227753e+01 4.4232571e+01 4.4232571e+01 4.4228203e+01 4.4231949e+01
 4.4231949e+01 4.4228077e+01 4.4228077e+01 4.4231632e+01 4.4231632e+01
 4.4229572e+01 4.4229572e+01 4.4229698e+01 4.4229698e+01 4.4227699e+01
 4.4228176e+01 4.4227940e+01 4.4232464e+01 4.4227467e+01 4.4227467e+01
 4.4265652e+01 4.4265652e+01 4.4231968e+01 4.4232018e+01 4.4230881e+01
 4.4230881e+01 4.4228283e+01 4.4228283e+01 4.4252224e+01 4.4252224e+01
 4.4227814e+01 4.4228207e+01 7.9282870e+00 7.9333105e+00 4.4239674e+01
 4.4239674e+01 4.4259716e+01 4.4259716e+01 2.2106548e-01 4.4227837e+01
 4.4226997e+01 4.4226997e+01 4.4238331e+01 4.4238331e+01 4.4228039e+01
 4.4227703e+01 4.4227703e+01 4.4232105e+01 4.4232105e+01 7.9297976e+00
 4.4227226e+01 4.4231663e+01 4.4493744e+01 4.4493744e+01 4.4225971e+01
 4.4228710e+01 1.5045812e+01 2.4245994e+00 5.8643726e+01 5.8643726e+01
 4.6428669e+01 7.9390926e+00 4.4318279e+01 4.4232605e+01 4.4228748e+01
 7.9253531e+00 4.4231197e+01 4.4226143e+01 4.4311073e+01 4.4232292e+01
 4.4229549e+01 4.4229549e+01 4.4241779e+01 4.4230099e+01 4.4238258e+01
 4.4230007e+01 4.4232819e+01 4.4241165e+01 4.4241165e+01 4.4232723e+01
 4.4232639e+01 4.4230640e+01 4.4230640e+01 1.1884644e+01 4.4235901e+01
 4.4229130e+01 4.4229130e+01 4.4228802e+01 4.4228310e+01 4.4228310e+01
 4.4228127e+01 4.4235180e+01 4.4235180e+01 4.4232513e+01 4.4238255e+01
 4.4238255e+01 4.4228199e+01 4.4237965e+01 4.4237965e+01 4.4270054e+01
 4.4234577e+01 4.4234577e+01 4.4227985e+01 4.4227985e+01 4.4228336e+01
 4.4250324e+01 4.4250324e+01 4.4228825e+01 4.4280121e+01 4.4280121e+01
 4.4405979e+01 4.4405979e+01 4.4225971e+01 4.4231796e+01 4.4227097e+01
 4.4228615e+01 4.4227959e+01 4.4225971e+01 4.4237724e+01 4.4237724e+01
 4.4322128e+01 4.4290310e+01 4.4290310e+01 4.4226261e+01 4.4225971e+01
 4.4235985e+01 4.4235985e+01 4.4226257e+01 4.4227859e+01 4.4236271e+01
 4.4236271e+01 4.4227844e+01 4.4226143e+01 4.4232559e+01 4.4225971e+01
 4.4226044e+01 4.4231647e+01 4.4238422e+01 4.4228237e+01 4.4228237e+01
 4.4234108e+01 4.4229694e+01 4.4229694e+01 4.4283512e+01 4.4247055e+01
 4.4230946e+01 4.4230946e+01 4.4238422e+01 4.4233166e+01 4.4233166e+01
 4.4237827e+01 4.4233555e+01 4.4229252e+01 4.4229252e+01 4.4232368e+01
 4.4249050e+01 4.4237961e+01 4.4237961e+01 4.4225971e+01 4.4255157e+01
 4.4256248e+01 4.4256248e+01 4.4227898e+01 4.4227829e+01 4.4227829e+01
 4.4231968e+01 4.4231968e+01 4.4238613e+01 4.4228111e+01 4.4228111e+01
 1.2225846e+01 4.4231483e+01 4.4231628e+01 4.4248493e+01 4.4233742e+01
 4.4233742e+01 4.4228275e+01 4.4231617e+01 4.4231117e+01 4.4231117e+01
 4.4225971e+01 4.4288643e+01 4.4244598e+01 4.4244598e+01 4.4225971e+01
 4.4234928e+01 4.4227821e+01 4.4231575e+01 4.4227856e+01 4.4262577e+01
 4.4227905e+01 4.4228813e+01 4.4228813e+01 4.4225971e+01 4.4232224e+01
 4.4299644e+01 4.4299644e+01 7.9262533e+00 4.4227806e+01 4.4227806e+01
 4.4241428e+01 4.4229618e+01 4.4227821e+01 4.4226143e+01 4.4228756e+01
 4.4245842e+01 4.4255123e+01 4.4227749e+01 4.4227718e+01 4.4241306e+01
 4.4227791e+01 4.4269009e+01 4.4229969e+01 4.4229969e+01 4.4225971e+01
 4.4229805e+01 4.4229805e+01 4.4234943e+01 4.4234688e+01 4.4234688e+01
 4.4228119e+01 4.4225971e+01 4.4232311e+01 4.4232311e+01 4.4225971e+01
 4.4235630e+01 4.4235630e+01 4.4345505e+01 4.4229206e+01 4.4229206e+01
 7.9297681e+00 4.4244812e+01 4.4225971e+01 4.4228245e+01 4.4236908e+01
 4.4227917e+01 4.4232990e+01 4.4229088e+01 4.4229088e+01 4.4232777e+01
 4.4228184e+01 4.4228184e+01 4.4233597e+01 4.4228798e+01 4.4228798e+01
 4.4234455e+01 4.4228947e+01 4.4228947e+01 4.4231934e+01 4.4232037e+01
 4.4227833e+01 4.4236771e+01 4.4236771e+01 4.4225971e+01 4.4263935e+01
 4.4228535e+01 4.4228535e+01 4.4239292e+01 4.4227814e+01 4.4227814e+01
 4.4243061e+01 4.4227814e+01 4.4239513e+01 4.4239513e+01 4.4225971e+01
 4.4228184e+01 4.4232231e+01 4.4226749e+01 4.4227913e+01 4.4229797e+01
 4.4268543e+01 4.4232773e+01 4.4228428e+01 4.4231884e+01 4.4238483e+01
 4.4240997e+01 4.4227898e+01 4.4234474e+01 4.4225971e+01 4.4225971e+01
 4.4250256e+01 4.4231983e+01 7.9253612e+00 4.4233265e+01 4.4238243e+01
 4.4229622e+01 4.4227898e+01 4.4227844e+01 7.9253612e+00 7.9253612e+00
 7.9254398e+00 4.4232555e+01 4.4227913e+01 4.4233402e+01 4.4228405e+01
 4.4228405e+01 4.4227879e+01 4.4232197e+01 7.9259081e+00 4.4225967e+01
 4.4252258e+01 8.7032671e+00 4.4232250e+01 4.4228260e+01 4.4233292e+01
 4.4247868e+01 4.4247868e+01 4.4233112e+01 4.4233112e+01 4.4226147e+01
 4.4231537e+01 4.4248928e+01 4.4269989e+01 4.4228786e+01 4.4226234e+01
 4.4231674e+01 4.4227779e+01 4.4235199e+01 4.4231621e+01 4.4229919e+01
 4.4229919e+01 4.4227901e+01 5.7114511e+00 5.5113106e+00 4.4226383e+01
 4.4236813e+01 4.4236813e+01 4.4227402e+01 7.9254088e+00 4.4225990e+01
 7.9290872e+00 5.8626362e+01 2.4242654e+00 4.6427261e+01 7.9260502e+00
 4.4242451e+01 4.4226013e+01 4.4228153e+01 4.4234379e+01 4.4298241e+01
 4.4234703e+01 4.4230263e+01 4.4231121e+01 4.4229214e+01 4.4228081e+01
 4.4623123e+01 4.4247780e+01 4.4241497e+01 4.4229282e+01 4.4338932e+01
 4.4338932e+01 4.4226383e+01 4.4240822e+01 4.4404045e+01 4.4231842e+01
 7.9960222e+00 8.2830420e+00 4.4228695e+01 4.4240398e+01 4.4267754e+01
 4.4226196e+01 4.4230167e+01 8.1884956e+00 1.3725984e+01 7.9262524e+00
 4.4241402e+01 4.4241402e+01 4.4408241e+01 4.4225948e+01 4.4225990e+01
 4.4225990e+01 4.4226002e+01 4.4247608e+01 4.4245670e+01 4.4253181e+01
 4.4227982e+01 4.4229462e+01 4.4233658e+01 4.4259190e+01 4.4226048e+01
 4.4236671e+01 4.4236671e+01 4.4230595e+01 4.4228230e+01 1.1787307e+01
 4.4225994e+01 4.4243584e+01 4.4230297e+01 4.4231133e+01 4.4233112e+01
 4.4266464e+01 4.4229858e+01 4.4316601e+01 4.4316601e+01 4.4229961e+01
 4.4299019e+01 5.3522601e+02 4.4236099e+01 4.4313015e+01 4.4313015e+01
 4.4350491e+01 4.4232468e+01 4.4232468e+01 4.4236732e+01 4.4227768e+01
 4.4248997e+01 4.4434429e+01 4.4254131e+01 4.4277695e+01 4.4236774e+01
 4.4268635e+01 4.4268635e+01 4.4237312e+01 4.4250923e+01 4.4228153e+01
 4.4232349e+01 4.4231483e+01 4.4231483e+01 4.4229221e+01 4.4243347e+01
 4.4231033e+01 4.4229080e+01 4.4229080e+01 4.4228474e+01 4.4234241e+01
 4.4234241e+01 4.4236938e+01 4.4228062e+01 4.4228062e+01 4.4234711e+01
 4.4270542e+01 4.4270542e+01 4.4281502e+01 4.4229099e+01 4.4229023e+01
 4.4232635e+01 4.4244167e+01 4.4244167e+01 4.4231770e+01 4.4230762e+01
 4.4230762e+01 4.4247208e+01 4.4229012e+01 4.4229012e+01 4.4232685e+01
 4.4229538e+01 4.4229538e+01 4.4231358e+01 4.4230930e+01 4.4230930e+01
 4.4231686e+01 4.4247936e+01 4.4232529e+01 4.4232529e+01 4.4238613e+01
 4.4227764e+01 4.4278610e+01 4.4227554e+01 4.4229828e+01 4.4232357e+01
 4.4233440e+01 4.4231789e+01 4.4232502e+01 4.4239021e+01 4.4232029e+01
 4.4227970e+01 4.4227970e+01 4.4228004e+01 4.4230934e+01 4.4234512e+01
 4.4230019e+01 4.4231041e+01 4.4227604e+01 4.4436256e+01 4.4237022e+01
 4.4229912e+01 4.4231514e+01 4.4250168e+01 4.4241356e+01 4.4227650e+01
 4.4228279e+01 4.4227806e+01 4.4230469e+01 4.4323284e+01 4.4227627e+01
 4.4228691e+01 4.4229397e+01 4.4228596e+01 4.4228100e+01 4.4227322e+01
 4.9124062e+01 4.4228935e+01 4.4237141e+01 4.4228279e+01 4.4230537e+01
 4.4227654e+01 4.4227848e+01 4.4227577e+01 4.4227966e+01 4.4239761e+01
 1.3326394e+01 2.4305556e+00 5.8628151e+01 2.4296942e+00 4.6426750e+01
 4.4226971e+01 7.9259491e+00 5.8627625e+01 5.3522607e+02 5.3522595e+02
 1.3325886e+01 1.3325895e+01]
2025-06-02 15:25:31,647 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152531_update_14.json
2025-06-02 15:25:31,647 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:25:31,661 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152531_update_14.pth
2025-06-02 15:25:31,661 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869515.dot): 0.1868
2025-06-02 15:25:31,661 - WARNING - Detected 6 anomalous nodes (reconstruction-based):
2025-06-02 15:25:31,661 - WARNING -   Node ID: ff02::2, Recon Error: 27.2035, MLP Score: 0.4199
2025-06-02 15:25:31,662 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 27.4722, MLP Score: 0.4099
2025-06-02 15:25:31,662 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 22.7655, MLP Score: 0.3313
2025-06-02 15:25:31,662 - WARNING -   Node ID: ff02::fb, Recon Error: 21.4063, MLP Score: 0.3720
2025-06-02 15:25:31,662 - WARNING -   Node ID: fe80::3674:28:2588:1274, Recon Error: 21.4333, MLP Score: 0.4528
2025-06-02 15:25:31,662 - WARNING - Detected 5 anomalous edges (reconstruction-based):
2025-06-02 15:25:31,663 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2260, MLP Score: 0.0000
2025-06-02 15:25:31,663 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9281, MLP Score: 0.0000
2025-06-02 15:25:31,663 - WARNING -   Source: 192.168.27.10, Target: 224.0.0.251, Recon Error: 535.2260, MLP Score: 0.0000
2025-06-02 15:25:31,663 - WARNING -   Source: fe80::eb4e:a54d:8c61:6ce1, Target: ff02::fb, Recon Error: 535.2261, MLP Score: 0.0000
2025-06-02 15:25:31,664 - WARNING -   Source: fe80::3674:28:2588:1274, Target: ff02::fb, Recon Error: 535.2260, MLP Score: 0.0000
2025-06-02 15:25:31,664 - INFO - 
--- Processing file: nw_graph_encoded_1748869545.dot (Timestamp: 2025-06-02 15:05:45) ---
2025-06-02 15:25:31,664 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869545.dot
2025-06-02 15:25:31,664 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869545.dot'.
2025-06-02 15:25:31,664 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869545.dot
2025-06-02 15:25:31,678 - INFO - Parsed 392 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869545.dot'.
2025-06-02 15:25:31,719 - INFO - Parsed 753 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869545.dot'.
2025-06-02 15:25:31,719 - INFO - Processing node updates/additions.
2025-06-02 15:25:31,735 - INFO - Processing edge updates/additions.
2025-06-02 15:25:31,791 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:25:31,794 - INFO - Finished updating NetworkX graph.
2025-06-02 15:25:31,796 - DEBUG - Updated graph - Nodes: 392, Edges: 753
2025-06-02 15:25:31,796 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:25:31,799 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:25:31,876 - DEBUG - Initial node features tensor shape: torch.Size([392, 30])
2025-06-02 15:25:31,879 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:25:31,880 - DEBUG - Node features tensor shape after scaling: torch.Size([392, 30])
2025-06-02 15:25:31,882 - DEBUG - Edge index tensor shape: torch.Size([2, 753])
2025-06-02 15:25:31,886 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:25:31,920 - DEBUG - Initial edge attributes tensor shape: torch.Size([753, 10])
2025-06-02 15:25:31,923 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:25:31,924 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([753, 10])
2025-06-02 15:25:31,924 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:25:31,924 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:25:31,926 - INFO - Updated main graph to 392 nodes and 753 edges.
2025-06-02 15:25:31,926 - INFO - Performing online update...
2025-06-02 15:25:31,927 - INFO - Starting online update for 25 steps.
2025-06-02 15:25:31,928 - DEBUG - Updated RunningStats: new_mean=0.9366923291696736, new_var=7800000000161.547, new_n=810
2025-06-02 15:25:31,929 - DEBUG - Updated RunningStats: new_mean=0.9296538844306128, new_var=8100000000018.608, new_n=840
2025-06-02 15:25:31,929 - DEBUG - Updated RunningStats: new_mean=37.47554815496984, new_var=2600000195733.5986, new_n=270
2025-06-02 15:25:31,929 - DEBUG - Updated RunningStats: new_mean=38.13658056873706, new_var=2700000277599.8237, new_n=280
2025-06-02 15:25:31,930 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:25:31,930 - DEBUG - Online update step: 1/25
2025-06-02 15:25:31,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,930 - DEBUG - Online update step: 2/25
2025-06-02 15:25:31,931 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,931 - DEBUG - Online update step: 3/25
2025-06-02 15:25:31,931 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,931 - DEBUG - Online update step: 4/25
2025-06-02 15:25:31,931 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,931 - DEBUG - Online update step: 5/25
2025-06-02 15:25:31,932 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,932 - DEBUG - Online update step: 6/25
2025-06-02 15:25:31,932 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,932 - DEBUG - Online update step: 7/25
2025-06-02 15:25:31,932 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,932 - DEBUG - Online update step: 8/25
2025-06-02 15:25:31,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,933 - DEBUG - Online update step: 9/25
2025-06-02 15:25:31,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,933 - DEBUG - Online update step: 10/25
2025-06-02 15:25:31,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,933 - DEBUG - Online update step: 11/25
2025-06-02 15:25:31,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,934 - DEBUG - Online update step: 12/25
2025-06-02 15:25:31,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,934 - DEBUG - Online update step: 13/25
2025-06-02 15:25:31,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,934 - DEBUG - Online update step: 14/25
2025-06-02 15:25:31,935 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,935 - DEBUG - Online update step: 15/25
2025-06-02 15:25:31,935 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,935 - DEBUG - Online update step: 16/25
2025-06-02 15:25:31,935 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,935 - DEBUG - Online update step: 17/25
2025-06-02 15:25:31,936 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,936 - DEBUG - Online update step: 18/25
2025-06-02 15:25:31,936 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,936 - DEBUG - Online update step: 19/25
2025-06-02 15:25:31,936 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,936 - DEBUG - Online update step: 20/25
2025-06-02 15:25:31,937 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,937 - DEBUG - Online update step: 21/25
2025-06-02 15:25:31,937 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,937 - DEBUG - Online update step: 22/25
2025-06-02 15:25:31,937 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,937 - DEBUG - Online update step: 23/25
2025-06-02 15:25:31,938 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,938 - DEBUG - Online update step: 24/25
2025-06-02 15:25:31,938 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,938 - DEBUG - Online update step: 25/25
2025-06-02 15:25:31,938 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:31,938 - WARNING - No successful steps during online update.
2025-06-02 15:25:31,940 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -3.1626954e-08  4.8656852e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.1626954e-08
 -3.8925482e-08  2.0679163e-08  4.8656852e-09 -2.7369479e-08
  2.4974489e+00  2.9540815e+00  1.3775510e-01  4.3596940e+00
  1.2164213e-09  3.2857144e+00  5.8392859e+00  7.5790815e+00
  1.3775510e-01  8.0000000e+00 -7.2985280e-09 -3.1626954e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.1556002e-08 -5.3218434e-09], current edge mean: [-6.3324990e-09  4.6533334e+02  0.0000000e+00  0.0000000e+00
 -2.5329996e-09 -1.2664998e-09 -4.4327493e-09  1.2664998e-09
 -5.0659992e-09  5.6992491e-09]
2025-06-02 15:25:31,940 - DEBUG - Node drift difference: 0.0876, Edge drift difference: 0.0154
2025-06-02 15:25:31,942 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -3.1626954e-08  4.8656852e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.1626954e-08
 -3.8925482e-08  2.0679163e-08  4.8656852e-09 -2.7369479e-08
  2.4974489e+00  2.9540815e+00  1.3775510e-01  4.3596940e+00
  1.2164213e-09  3.2857144e+00  5.8392859e+00  7.5790815e+00
  1.3775510e-01  8.0000000e+00 -7.2985280e-09 -3.1626954e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.1556002e-08 -5.3218434e-09], edge=[-6.3324990e-09  4.6533334e+02  0.0000000e+00  0.0000000e+00
 -2.5329996e-09 -1.2664998e-09 -4.4327493e-09  1.2664998e-09
 -5.0659992e-09  5.6992491e-09]
2025-06-02 15:25:31,943 - DEBUG - Updated reference std: node=[0.         0.         1.0012779  1.0012779  0.         0.
 0.         1.001278   1.0012779  1.0012779  1.0012779  1.0012779
 1.0559748  0.29992953 0.37355423 0.58165294 1.0012779  3.045268
 2.8914173  1.55179    0.37355423 0.         1.0012779  1.0012779
 0.         0.         0.         0.         1.0012779  1.0012779 ], edge=[  1.0006646 552.8399      0.          0.          1.0006647   1.0006647
   1.0006647   1.0006646   1.0006646   1.0006647]
2025-06-02 15:25:31,943 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:25:31,943 - INFO - Running anomaly detection...
2025-06-02 15:25:31,944 - INFO - Starting anomaly detection.
2025-06-02 15:25:31,956 - DEBUG - Node reconstruction errors: [15.783024  15.904728  16.982916  17.411367  13.112596  14.65003
 16.982916  16.28784   16.28784   17.09176   16.28784   12.317846
 19.934868  12.3637085 15.696368  15.939947  12.48081   15.939943
 17.654585  15.352128  14.663988  15.696368  14.612712  10.467956
 15.395264  17.11484   15.395264  12.591746  15.699901  15.395264
 10.387185  16.491655  11.121322  16.847368  17.11484   15.934918
 13.656352  15.352128  11.040186  14.733841  16.573627  15.216343
 15.352128  16.102385  16.330269  15.4072695 18.790405  11.675586
 15.211076  27.350475  27.77964   16.26186   16.613321  16.711662
 14.7268915 11.9535675 16.923779  14.475089  16.484842  16.484842
 11.275084  15.73888   14.832975  10.174107  15.172728  14.44663
 14.665873  14.487981  14.832975  14.832975  14.851837  13.674117
 16.22837   14.1411495 14.862534  13.750006  15.761659  14.232615
 13.98848   14.045121  15.728702  13.443876  10.061318  15.367773
 15.785571  10.406384  13.671057  13.9909725 14.817386  13.368003
 14.74508   12.551119  15.161853  13.975796  14.329575  23.046541
 15.532866  13.397563  14.214197  14.71188   13.397562  15.532865
 15.943669  14.485761  10.00932   14.64715   14.608564  11.049338
 11.023371  21.52673   14.953668  15.506183  11.0893135 11.107755
 13.3792515 13.397521  13.493915  12.492484  13.987447  14.913581
 14.540503  15.161855  11.701343  10.975037  14.818844  14.91358
 11.04341   10.478504  13.397564  15.443384  15.26604   14.913581
 14.308792  12.627362  13.397564  14.64715   15.571802  14.324474
 14.785911  13.397562  14.91358   14.258486  14.678939  14.785911
 14.785911  13.397519  13.344245  14.913581  14.421357  13.987442
 17.852264  10.009366  13.894784  14.913581  14.916073  11.801229
 14.91358   14.096932  13.397564  16.058514  14.913581  11.188342
 14.913581  15.26604   13.344247  11.745426  13.336351  13.9376
 10.576755  13.39755   13.987445  14.824018  14.678939  21.705173
 13.9376    13.44873   13.937589  14.207333  13.344258  13.34426
 14.529147  10.9539    14.027475  11.031991  11.644803  13.344248
 14.559243  13.37938   14.559241  14.798207  13.918731  14.600907
 15.643699  14.824018  14.540503  15.643699  14.453986  14.678939
 11.761498  15.532866  14.324474  14.913581  11.163767  13.9376
 14.160358  15.161853  14.990606  11.989649  14.15644   13.833828
 13.941884  13.344257  15.643699  13.927307  13.344258  14.678941
 14.207333  14.292874  13.249165  14.824018  11.045571  14.50936
 14.559243  15.643699  14.913581  14.804366  13.344254  14.913581
 13.926333  15.161855  10.975038  13.344257  13.397562  13.344244
 14.292873  15.643699  14.804366  14.559243  14.913581  15.443384
 11.745194  13.83383   14.798206  13.344244  14.798206  13.397563
 13.344176  14.207333  14.798206  14.487262  14.678939  14.678939
 13.249169  13.987448  14.292874  14.292874  14.798206  14.2009945
 14.559241  13.344256  13.8257885 15.044364  15.044364  14.798207
 13.926333  14.311649  14.583989  15.044364  14.583985  13.344258
 11.908822  11.644801  13.897831  15.554125  13.276033  13.344258
 14.559244  14.585404  14.529145  13.344257  14.653854  14.235265
 13.926331  15.596012  14.798205  15.055045  11.672309  11.091053
 10.953901  10.834745  14.311658  15.419269  14.740095  14.798206
 14.338674  14.2009945 13.344256  13.34307   15.643699  14.187311
 14.763857  14.165249  14.165247  14.165246  14.165249  14.165247
 14.165249  14.165247  14.165246  14.165249  14.165249  13.320258
 14.165247  15.619969  10.074832  14.336783  14.143876  15.025681
 15.619969  15.612529  14.2009945 14.2009945 14.755522  14.165247
 14.559243  10.469418  14.1396265 13.32026   13.825795  13.825795
 15.19982   15.619969  14.165249  13.276036  14.165247  13.320257
 14.763857  14.559241  14.139627  14.139627  14.165247  14.338674
 14.139627  13.825797  14.165249  13.276032  14.165249  15.004597
 14.725593  15.4192705 14.165247  14.755831  15.044364  14.202292
 14.338674  15.643699  14.165249  14.165247  14.2009945 14.2009945
 14.207333  14.165246  14.139627  14.165246  14.165246  27.456593
 14.516882  14.202292  14.763857  14.516881  15.627771  14.763856
 14.763857  14.763856  15.627771  14.165247  14.51688   15.255385
 14.7786255 14.165247  14.4402485 14.763857  14.763856  15.385156
 14.763856  14.202292  14.499985  10.012709  14.156727  14.165246
 16.154549  14.202292 ]
2025-06-02 15:25:31,964 - DEBUG - Edge reconstruction errors: [5.24444151e+00 5.22503662e+00 7.92606544e+00 4.42473793e+01
 2.42459464e+00 1.46470737e+01 4.42271690e+01 4.42299843e+01
 4.42272949e+01 7.92539644e+00 4.42260323e+01 4.42278519e+01
 4.42359352e+01 4.42360535e+01 4.42681961e+01 4.42261772e+01
 4.42313614e+01 4.42279434e+01 4.42279434e+01 1.14271755e+01
 7.92500353e+00 7.92907667e+00 4.42374649e+01 4.42331772e+01
 4.44961624e+01 4.42260323e+01 4.42280312e+01 4.42750664e+01
 4.43206711e+01 4.42260361e+01 4.42398796e+01 4.42493553e+01
 4.42493553e+01 4.42260361e+01 4.42441444e+01 4.42441444e+01
 4.42313652e+01 4.42310333e+01 4.42296181e+01 4.42296181e+01
 4.43349915e+01 4.42360229e+01 4.42268066e+01 4.42377586e+01
 4.43218765e+01 4.43218765e+01 4.42277107e+01 4.42275162e+01
 4.42275162e+01 4.42276039e+01 4.42275810e+01 4.42275810e+01
 4.49104271e+01 4.42313614e+01 7.92747307e+00 7.93047810e+00
 4.42278023e+01 4.44530792e+01 4.42316132e+01 4.42336159e+01
 4.42336159e+01 4.42276802e+01 5.35226013e+02 7.95802879e+00
 7.92463779e+00 4.42417488e+01 4.42681236e+01 4.42681236e+01
 4.42261772e+01 4.42362556e+01 4.42274284e+01 4.42274284e+01
 8.08927856e+02 4.42277374e+01 4.42265816e+01 4.42595673e+01
 4.42549400e+01 4.42284584e+01 4.42284584e+01 4.42599220e+01
 4.42970848e+01 4.42290878e+01 4.42290878e+01 4.42324638e+01
 4.42338295e+01 4.42338295e+01 1.22259111e+01 4.42355537e+01
 4.42272644e+01 4.42272644e+01 4.43408546e+01 4.42305527e+01
 4.42305527e+01 4.42347221e+01 4.42407417e+01 4.42276535e+01
 4.42274780e+01 4.42303734e+01 4.42303734e+01 4.42736740e+01
 4.42309189e+01 4.42280617e+01 4.42280617e+01 4.42655029e+01
 4.42310295e+01 4.42277336e+01 4.42292480e+01 4.42292480e+01
 4.42260361e+01 4.42493477e+01 4.42289276e+01 4.42289276e+01
 7.92574167e+00 4.42640800e+01 4.42273064e+01 4.42273064e+01
 4.42261734e+01 4.42354774e+01 4.42311249e+01 4.42310600e+01
 4.42274055e+01 4.42274055e+01 4.42278442e+01 4.42280693e+01
 4.42272072e+01 4.42272072e+01 4.42312355e+01 4.42275505e+01
 4.42275505e+01 4.42319908e+01 4.42274094e+01 4.42274094e+01
 4.42261772e+01 4.42272530e+01 4.42272530e+01 4.42271347e+01
 4.42271347e+01 4.42434158e+01 4.42370338e+01 4.42370338e+01
 4.42278748e+01 4.42272453e+01 4.42272453e+01 4.42287407e+01
 4.42272453e+01 4.42272453e+01 4.42274208e+01 4.42274208e+01
 4.42334061e+01 4.42334061e+01 4.42275200e+01 4.42317009e+01
 4.42317009e+01 4.42318153e+01 4.42311821e+01 4.42311821e+01
 4.42278519e+01 4.42278519e+01 4.42307129e+01 4.42307129e+01
 4.42260361e+01 4.42293510e+01 4.42293510e+01 4.42291145e+01
 4.42291145e+01 4.42278633e+01 4.42305832e+01 4.42278709e+01
 4.42276764e+01 4.42314949e+01 4.42273293e+01 4.42273293e+01
 4.42638206e+01 4.42638206e+01 4.42320480e+01 4.42310410e+01
 4.42310791e+01 4.42300987e+01 4.42300987e+01 4.42281647e+01
 4.42279778e+01 4.42279778e+01 4.42510796e+01 4.42510796e+01
 4.42278633e+01 4.42275925e+01 4.42279358e+01 7.92782450e+00
 7.93104601e+00 4.42274513e+01 4.42387085e+01 4.42387085e+01
 4.42570496e+01 4.42570496e+01 2.20831841e-01 4.42569923e+01
 4.42268257e+01 4.42268257e+01 4.42268867e+01 4.42268867e+01
 4.42376785e+01 4.42376785e+01 4.42277641e+01 4.42275200e+01
 4.42275200e+01 4.42309227e+01 4.42309227e+01 7.92904854e+00
 8.68733582e+02 7.92687368e+00 7.92446280e+00 4.42280350e+01
 4.42276077e+01 4.42358055e+01 4.42281075e+01 4.42386398e+01
 4.43143806e+01 4.42405319e+01 4.42277908e+01 4.42373581e+01
 4.42341156e+01 4.42332573e+01 4.42279930e+01 4.42317085e+01
 4.42276230e+01 4.42276611e+01 4.42280045e+01 4.42275925e+01
 4.42805672e+01 4.42274742e+01 4.42284317e+01 4.42271576e+01
 4.42310638e+01 4.47427254e+01 4.47427254e+01 4.42260361e+01
 4.42286110e+01 1.43822603e+01 2.42459464e+00 5.86406670e+01
 5.86406670e+01 4.64282608e+01 7.93680000e+00 4.43036499e+01
 4.42321434e+01 4.42286568e+01 7.92537975e+00 4.42305984e+01
 4.42261734e+01 4.43007431e+01 4.42313461e+01 4.42290459e+01
 4.42290459e+01 4.42404938e+01 4.42296295e+01 4.42377548e+01
 4.42295113e+01 4.42318611e+01 4.42387161e+01 4.42387161e+01
 4.42318573e+01 4.42316780e+01 4.42299652e+01 4.42299652e+01
 1.08746061e+01 4.42347832e+01 4.42287064e+01 4.42287064e+01
 4.42285004e+01 4.42280006e+01 4.42280006e+01 4.42278290e+01
 4.42337952e+01 4.42337952e+01 4.42314148e+01 4.42365608e+01
 4.42365608e+01 4.42278976e+01 4.43017807e+01 4.43017807e+01
 4.42630501e+01 4.42333260e+01 4.42333260e+01 4.42276382e+01
 4.42276382e+01 4.42280464e+01 4.42468719e+01 4.42468719e+01
 4.42285080e+01 4.42773323e+01 4.42773323e+01 4.49837151e+01
 4.49837151e+01 4.42260361e+01 4.42307892e+01 4.42270317e+01
 4.42285080e+01 4.42277069e+01 4.42260361e+01 4.42360268e+01
 4.42360268e+01 4.43152962e+01 4.42872353e+01 4.42872353e+01
 4.42262688e+01 4.42260361e+01 4.42343292e+01 4.42343292e+01
 4.42262688e+01 4.42276306e+01 4.42347450e+01 4.42347450e+01
 4.42276154e+01 4.42261772e+01 4.42316589e+01 4.42260361e+01
 4.42260933e+01 4.42307777e+01 4.42364807e+01 4.42279701e+01
 4.42279701e+01 4.42329178e+01 4.42291908e+01 4.42291908e+01
 4.42744522e+01 4.42436714e+01 4.42301559e+01 4.42301559e+01
 4.42365913e+01 4.42320442e+01 4.42320442e+01 4.42360039e+01
 4.42325821e+01 4.42288017e+01 4.42288017e+01 4.42314796e+01
 4.42477760e+01 4.42370796e+01 4.42370796e+01 4.42260361e+01
 4.42505188e+01 4.42714615e+01 4.42714615e+01 4.42276649e+01
 4.42275772e+01 4.42275772e+01 4.42311134e+01 4.42311134e+01
 4.42278938e+01 4.42365799e+01 4.42369957e+01 4.42369957e+01
 1.22259111e+01 4.42306252e+01 4.42307739e+01 4.42452431e+01
 4.42416878e+01 4.42416878e+01 4.42278862e+01 4.42307549e+01
 4.42302094e+01 4.42302094e+01 4.42260361e+01 4.42843666e+01
 4.42895470e+01 4.42895470e+01 4.42260361e+01 4.42338295e+01
 4.43488045e+01 4.43488045e+01 4.42275772e+01 4.42306976e+01
 4.42276192e+01 4.42582893e+01 4.42276573e+01 4.42284203e+01
 4.42284203e+01 4.42260361e+01 4.42313423e+01 4.42953682e+01
 4.42953682e+01 7.92616463e+00 4.42275620e+01 4.42275620e+01
 4.42389603e+01 4.42292328e+01 4.42275772e+01 4.42261772e+01
 4.42283325e+01 4.42426529e+01 4.42503777e+01 4.42275162e+01
 4.42274933e+01 4.42388649e+01 4.42301216e+01 4.42301216e+01
 4.42275505e+01 4.42622643e+01 4.42294273e+01 4.42294273e+01
 4.42260361e+01 4.42293167e+01 4.42293167e+01 4.42344818e+01
 4.42334557e+01 4.42334557e+01 4.42278175e+01 4.42260361e+01
 4.42372780e+01 4.42372780e+01 4.42312965e+01 4.42312965e+01
 4.42260361e+01 4.42339706e+01 4.42339706e+01 4.43365250e+01
 4.42288628e+01 4.42288628e+01 7.92902422e+00 4.42417603e+01
 4.42260361e+01 4.42279282e+01 4.42350616e+01 4.42276688e+01
 4.42319870e+01 4.42286530e+01 4.42286530e+01 4.42317963e+01
 4.42279282e+01 4.42279282e+01 4.42326088e+01 4.42283936e+01
 4.42283936e+01 4.42333641e+01 4.42285461e+01 4.42285461e+01
 4.42310104e+01 4.42310944e+01 4.42275887e+01 4.42352180e+01
 4.42352180e+01 4.42260361e+01 4.42588844e+01 4.42282181e+01
 4.42282181e+01 4.42372627e+01 4.42275620e+01 4.42275620e+01
 4.42505493e+01 4.42275848e+01 4.42381401e+01 4.42381401e+01
 4.42260361e+01 4.42278786e+01 4.42312469e+01 4.42266617e+01
 4.42276649e+01 4.42294312e+01 4.42631798e+01 4.46550026e+01
 4.46550026e+01 4.42317390e+01 4.42282333e+01 4.42282333e+01
 4.42280769e+01 4.42310066e+01 4.42297668e+01 4.42297668e+01
 4.42365646e+01 4.42388649e+01 4.42275314e+01 4.42275314e+01
 4.42276764e+01 4.42333870e+01 4.42292633e+01 4.42292633e+01
 4.42260361e+01 4.42434807e+01 4.42434807e+01 4.42260361e+01
 4.42277260e+01 4.42277260e+01 4.42488136e+01 4.42392616e+01
 4.42392616e+01 4.42311325e+01 7.92543268e+00 4.42322273e+01
 4.42296867e+01 4.42296867e+01 4.42363739e+01 4.42292824e+01
 4.42275314e+01 4.42275314e+01 4.42276649e+01 4.42276230e+01
 7.92543268e+00 7.92543268e+00 7.92549562e+00 4.42315483e+01
 4.42285194e+01 4.42285194e+01 4.42317200e+01 4.42322006e+01
 4.42281075e+01 4.42281075e+01 4.42276459e+01 4.42311134e+01
 4.42300911e+01 4.42300911e+01 7.92589140e+00 4.42260323e+01
 4.42498398e+01 8.68674469e+00 4.42313805e+01 4.42279549e+01
 4.42323837e+01 4.42623177e+01 4.42623177e+01 4.42324257e+01
 4.42324257e+01 4.42261772e+01 4.42306938e+01 4.42468643e+01
 4.42632561e+01 4.42286720e+01 4.42262459e+01 4.42371712e+01
 4.42275467e+01 4.42341537e+01 4.42307587e+01 4.42292747e+01
 4.42292747e+01 4.42276688e+01 4.42485657e+01 4.42485657e+01
 4.42278900e+01 4.42278900e+01 4.42290230e+01 4.42290230e+01
 4.42303619e+01 4.42303619e+01 4.42373581e+01 4.42373581e+01
 4.42278175e+01 4.42278175e+01 5.63287497e+00 5.52125406e+00
 4.42263680e+01 4.42427254e+01 4.42427254e+01 4.42272415e+01
 7.92548466e+00 4.42260513e+01 7.92847395e+00 5.86263542e+01
 2.42429090e+00 4.64271164e+01 7.92604685e+00 4.42398872e+01
 4.42260666e+01 4.42278900e+01 4.42331619e+01 4.42877693e+01
 4.42334747e+01 4.42296524e+01 4.42308006e+01 4.42287064e+01
 4.42278023e+01 4.45452385e+01 4.42439384e+01 4.42390289e+01
 4.42288094e+01 4.43477592e+01 4.43477592e+01 4.42263680e+01
 4.42383919e+01 4.46945610e+01 4.42309875e+01 7.99202347e+00
 8.27408504e+00 4.42282944e+01 4.42381935e+01 4.42612228e+01
 4.42262192e+01 4.42297401e+01 8.18341827e+00 1.37260199e+01
 7.92624474e+00 4.42388573e+01 4.42388573e+01 4.46007423e+01
 4.42260208e+01 4.42260513e+01 4.42260513e+01 4.42260628e+01
 4.43686104e+01 4.42430687e+01 4.42492599e+01 4.42278900e+01
 4.42290268e+01 4.42324181e+01 4.42529984e+01 4.42260933e+01
 4.42349701e+01 4.42349701e+01 4.42299538e+01 4.42281342e+01
 1.16842756e+01 4.42260551e+01 4.42404213e+01 4.42296600e+01
 4.42301979e+01 4.42392693e+01 4.42617149e+01 4.42294846e+01
 4.43013878e+01 4.43013878e+01 4.42293091e+01 4.42963943e+01
 5.35226135e+02 4.42345963e+01 4.43084564e+01 4.43084564e+01
 4.43468132e+01 4.42317047e+01 4.42317047e+01 4.42359009e+01
 4.42275696e+01 4.42660599e+01 4.44263382e+01 4.42511749e+01
 4.42751961e+01 4.42354088e+01 4.42614059e+01 4.42614059e+01
 4.42359543e+01 4.42464447e+01 4.42278481e+01 4.42314262e+01
 4.42386398e+01 4.42386398e+01 4.42287445e+01 4.42503510e+01
 4.42302475e+01 4.42287407e+01 4.42287407e+01 4.42281456e+01
 4.42546310e+01 4.42546310e+01 4.42357254e+01 4.42312088e+01
 4.42312088e+01 4.42331161e+01 4.43094749e+01 4.43094749e+01
 4.42784653e+01 4.42286453e+01 4.42285614e+01 4.42316208e+01
 4.42547379e+01 4.42547379e+01 4.42309265e+01 4.42366562e+01
 4.42366562e+01 4.42442322e+01 4.42286072e+01 4.42286072e+01
 4.42317543e+01 4.42354622e+01 4.42354622e+01 4.42305412e+01
 4.42370224e+01 4.42370224e+01 4.42309341e+01 4.42440071e+01
 4.42314644e+01 4.42314644e+01 4.42380867e+01 4.42275620e+01
 4.42768326e+01 4.42273674e+01 4.42294044e+01 4.42313728e+01
 4.42323494e+01 4.42285957e+01 4.42285957e+01 4.42309036e+01
 4.42316170e+01 4.42380295e+01 4.42311172e+01 4.42276878e+01
 4.42276878e+01 4.42276917e+01 4.42284431e+01 4.42305107e+01
 4.42340431e+01 4.42294083e+01 4.42285080e+01 4.42285080e+01
 4.42303238e+01 4.42274246e+01 4.43941422e+01 4.42476616e+01
 4.42292709e+01 4.42308998e+01 4.42485886e+01 4.42392235e+01
 4.42274666e+01 4.42324600e+01 4.42276154e+01 4.42301102e+01
 4.44249802e+01 4.42274475e+01 4.42283096e+01 4.42291031e+01
 4.42282257e+01 4.42278023e+01 4.42278023e+01 4.42279053e+01
 4.42271271e+01 4.90193672e+01 4.42285881e+01 4.42353516e+01
 4.42279892e+01 4.42383804e+01 4.42274666e+01 4.42276573e+01
 4.42274094e+01 4.42277069e+01 4.42320366e+01 4.42320366e+01
 4.42683220e+01 4.42280464e+01 4.43603401e+01 4.42274780e+01
 4.42512817e+01 4.42274971e+01 4.42276917e+01 4.42284546e+01
 4.42284546e+01 1.33263655e+01 2.42962146e+00 5.86278305e+01
 2.42892075e+00 4.64266891e+01 4.42268829e+01 7.92598248e+00
 5.86274033e+01 5.35226135e+02 5.35226013e+02 1.33259573e+01
 1.33259668e+01]
2025-06-02 15:25:31,967 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152531_update_15.json
2025-06-02 15:25:31,967 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:25:31,981 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152531_update_15.pth
2025-06-02 15:25:31,982 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869545.dot): 0.1824
2025-06-02 15:25:31,982 - WARNING - Detected 7 anomalous nodes (reconstruction-based):
2025-06-02 15:25:31,982 - WARNING -   Node ID: 192.168.27.10, Recon Error: 19.9349, MLP Score: 0.2258
2025-06-02 15:25:31,982 - WARNING -   Node ID: ff02::2, Recon Error: 27.3505, MLP Score: 0.4183
2025-06-02 15:25:31,982 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 27.7796, MLP Score: 0.4089
2025-06-02 15:25:31,983 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 23.0465, MLP Score: 0.3280
2025-06-02 15:25:31,983 - WARNING -   Node ID: ff02::fb, Recon Error: 21.5267, MLP Score: 0.3690
2025-06-02 15:25:31,983 - WARNING - Detected 6 anomalous edges (reconstruction-based):
2025-06-02 15:25:31,983 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2260, MLP Score: 0.0000
2025-06-02 15:25:31,984 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9279, MLP Score: 0.0000
2025-06-02 15:25:31,984 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7336, MLP Score: 0.0000
2025-06-02 15:25:31,984 - WARNING -   Source: 192.168.27.10, Target: 224.0.0.251, Recon Error: 535.2261, MLP Score: 0.0000
2025-06-02 15:25:31,984 - WARNING -   Source: fe80::eb4e:a54d:8c61:6ce1, Target: ff02::fb, Recon Error: 535.2261, MLP Score: 0.0000
2025-06-02 15:25:31,984 - INFO - 
--- Processing file: nw_graph_encoded_1748869575.dot (Timestamp: 2025-06-02 15:06:15) ---
2025-06-02 15:25:31,985 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869575.dot
2025-06-02 15:25:31,985 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869575.dot'.
2025-06-02 15:25:31,985 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869575.dot
2025-06-02 15:25:32,000 - INFO - Parsed 419 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869575.dot'.
2025-06-02 15:25:32,046 - INFO - Parsed 833 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869575.dot'.
2025-06-02 15:25:32,047 - INFO - Processing node updates/additions.
2025-06-02 15:25:32,064 - INFO - Processing edge updates/additions.
2025-06-02 15:25:32,130 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:25:32,132 - INFO - Finished updating NetworkX graph.
2025-06-02 15:25:32,134 - DEBUG - Updated graph - Nodes: 419, Edges: 833
2025-06-02 15:25:32,134 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:25:32,137 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:25:32,221 - DEBUG - Initial node features tensor shape: torch.Size([419, 30])
2025-06-02 15:25:32,223 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:25:32,224 - DEBUG - Node features tensor shape after scaling: torch.Size([419, 30])
2025-06-02 15:25:32,226 - DEBUG - Edge index tensor shape: torch.Size([2, 833])
2025-06-02 15:25:32,231 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:25:32,268 - DEBUG - Initial edge attributes tensor shape: torch.Size([833, 10])
2025-06-02 15:25:32,271 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:25:32,277 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([833, 10])
2025-06-02 15:25:32,278 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:25:32,279 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:25:32,281 - INFO - Updated main graph to 419 nodes and 833 edges.
2025-06-02 15:25:32,281 - INFO - Performing online update...
2025-06-02 15:25:32,282 - INFO - Starting online update for 25 steps.
2025-06-02 15:25:32,283 - DEBUG - Updated RunningStats: new_mean=0.9375496702229122, new_var=8400000000160.704, new_n=870
2025-06-02 15:25:32,284 - DEBUG - Updated RunningStats: new_mean=0.9310258721915188, new_var=8700000000019.0625, new_n=900
2025-06-02 15:25:32,284 - DEBUG - Updated RunningStats: new_mean=38.41121438723181, new_var=2800000191889.318, new_n=290
2025-06-02 15:25:32,285 - DEBUG - Updated RunningStats: new_mean=38.90906321110323, new_var=2900000250867.506, new_n=300
2025-06-02 15:25:32,285 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:25:32,285 - DEBUG - Online update step: 1/25
2025-06-02 15:25:32,286 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:32,286 - DEBUG - Online update step: 2/25
2025-06-02 15:25:32,286 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:32,286 - DEBUG - Online update step: 3/25
2025-06-02 15:25:32,286 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:32,286 - DEBUG - Online update step: 4/25
2025-06-02 15:25:32,287 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:32,287 - DEBUG - Online update step: 5/25
2025-06-02 15:25:32,287 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:32,287 - DEBUG - Online update step: 6/25
2025-06-02 15:25:32,287 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:32,288 - DEBUG - Online update step: 7/25
2025-06-02 15:25:32,288 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:32,288 - DEBUG - Online update step: 8/25
2025-06-02 15:25:32,288 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:32,288 - DEBUG - Online update step: 9/25
2025-06-02 15:25:32,288 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:32,289 - DEBUG - Online update step: 10/25
2025-06-02 15:25:32,289 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:32,289 - DEBUG - Online update step: 11/25
2025-06-02 15:25:32,289 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:32,289 - DEBUG - Online update step: 12/25
2025-06-02 15:25:32,289 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:32,290 - DEBUG - Online update step: 13/25
2025-06-02 15:25:32,290 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:32,290 - DEBUG - Online update step: 14/25
2025-06-02 15:25:32,290 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:32,290 - DEBUG - Online update step: 15/25
2025-06-02 15:25:32,290 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:32,291 - DEBUG - Online update step: 16/25
2025-06-02 15:25:32,291 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:32,291 - DEBUG - Online update step: 17/25
2025-06-02 15:25:32,291 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:32,291 - DEBUG - Online update step: 18/25
2025-06-02 15:25:32,291 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:32,292 - DEBUG - Online update step: 19/25
2025-06-02 15:25:32,292 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:32,292 - DEBUG - Online update step: 20/25
2025-06-02 15:25:32,292 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:32,292 - DEBUG - Online update step: 21/25
2025-06-02 15:25:32,292 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:32,293 - DEBUG - Online update step: 22/25
2025-06-02 15:25:32,293 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:32,293 - DEBUG - Online update step: 23/25
2025-06-02 15:25:32,293 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:32,293 - DEBUG - Online update step: 24/25
2025-06-02 15:25:32,293 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:32,293 - DEBUG - Online update step: 25/25
2025-06-02 15:25:32,294 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:32,294 - WARNING - No successful steps during online update.
2025-06-02 15:25:32,295 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -6.9420210e-08  4.7797521e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.8693230e-08
  9.1042898e-09 -1.5932507e-08  9.1042898e-09 -1.8208580e-08
  2.4582338e+00  2.9427207e+00  1.4081146e-01  4.3436756e+00
  1.5932507e-08  3.4797137e+00  5.6467781e+00  7.6062055e+00
  1.4081146e-01  8.0000000e+00 -2.2760724e-09  2.0484650e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.6174831e-08 -2.2760723e-08], current edge mean: [ 6.8692025e-09  4.6100961e+02  0.0000000e+00  0.0000000e+00
 -5.7243355e-10  2.2897342e-09 -2.2897342e-09  8.0140703e-09
  0.0000000e+00 -5.7243355e-10]
2025-06-02 15:25:32,296 - DEBUG - Node drift difference: 0.0666, Edge drift difference: 0.0078
2025-06-02 15:25:32,297 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -6.9420210e-08  4.7797521e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.8693230e-08
  9.1042898e-09 -1.5932507e-08  9.1042898e-09 -1.8208580e-08
  2.4582338e+00  2.9427207e+00  1.4081146e-01  4.3436756e+00
  1.5932507e-08  3.4797137e+00  5.6467781e+00  7.6062055e+00
  1.4081146e-01  8.0000000e+00 -2.2760724e-09  2.0484650e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.6174831e-08 -2.2760723e-08], edge=[ 6.8692025e-09  4.6100961e+02  0.0000000e+00  0.0000000e+00
 -5.7243355e-10  2.2897342e-09 -2.2897342e-09  8.0140703e-09
  0.0000000e+00 -5.7243355e-10]
2025-06-02 15:25:32,298 - DEBUG - Updated reference std: node=[0.        0.        1.0011954 1.0011954 0.        0.        0.
 1.0011954 1.0011954 1.0011954 1.0011954 1.0011954 1.0142751 0.3339817
 0.3747156 0.5714724 1.0011954 3.1244435 2.942724  1.5043986 0.3747156
 0.        1.0011954 1.0011955 0.        0.        0.        0.
 1.0011954 1.0011955], edge=[  1.0006008 526.4626      0.          0.          1.0006008   1.0006007
   1.0006008   1.0006008   1.0006008   1.0006008]
2025-06-02 15:25:32,298 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:25:32,299 - INFO - Running anomaly detection...
2025-06-02 15:25:32,299 - INFO - Starting anomaly detection.
2025-06-02 15:25:32,319 - DEBUG - Node reconstruction errors: [15.840883  15.802357  16.875353  17.549015  13.209116  14.710114
 16.875353  16.424809  16.42481   17.231718  16.42481   12.452128
 19.72726   12.390621  15.856211  16.085287  12.606015  16.085287
 17.518284  15.518069  14.8179035 15.856211  14.752758  10.565891
 15.562795  17.2705    15.562795  12.732774  15.856081  15.562797
 11.619521  16.654919  11.881578  17.002974  17.2705    16.106894
 13.721374  15.518068  11.1414    14.909986  16.757235  15.388977
 15.518068  16.252422  16.50227   15.549099  17.290833  11.888624
 15.377594  27.550789  28.155512  16.437588  16.78549   15.640233
 14.591315  12.062905  16.961443  14.660598  16.383371  16.383371
 11.374579  15.90138   15.011386  10.280286  15.347413  14.591314
 14.807858  14.591319  15.011383  15.011386  14.49113   13.773387
 16.403671  14.213772  14.88045   13.855338  15.9450035 14.316516
 14.054601  14.120322  15.899984  13.514218  10.176282  15.524814
 15.946176  10.527105  13.75191   14.051346  14.894358  13.422245
 14.912726  12.593713  11.0809145 14.063767  14.451371  23.397518
 15.694239  13.4718075 14.379146  14.88194   13.471807  15.694239
 16.082018  14.5882    10.123247  14.814632  14.736828  11.19112
 11.134058  21.714672  15.122768  15.664461  11.191878  11.234478
 13.4524145 13.471793  13.408666  12.577465  13.994768  14.909313
 14.681723  11.080916  11.118219  11.080915  14.904304  15.777406
 10.413142  10.549547  13.471808  15.598281  15.405256  14.924791
 14.476976  12.754392  13.471808  14.814634  15.728667  14.492072
 14.924791  13.4718075 15.076599  14.3405    14.842989  14.924791
 14.924791  13.471789  13.408665  15.076598  14.548368  14.062535
 18.02368   10.123287  13.99206   14.924791  15.012925  11.880694
 14.909313  13.427783  13.471803  16.22285   15.076598  11.324259
 14.909313  15.405256  13.408665  11.876001  13.423199  13.994769
 10.685947  13.471802  14.062543  14.978591  14.84299   22.035465
 13.99477   13.559655  13.99476   13.378006  13.400412  13.40041
 14.681341  11.077803  14.189412  11.128958  11.7587    13.400408
 14.644097  13.442007  14.644095  14.944655  13.957948  14.67712
 15.789741  14.97859   14.681723  15.789741  14.620984  14.662261
 11.855532  15.694239  14.49207   15.076599  11.292814  13.994771
 14.169103  15.332922  15.138425  12.125685  14.307202  13.917282
 14.00736   13.400413  15.789741  13.9934845 13.400411  14.84299
 13.400412  13.408667  13.30604   14.97859   11.165188  14.623642
 14.707729  15.789741  15.076598  14.728266  13.400408  15.076598
 13.982264  15.33292   11.106098  13.40041   13.471806  13.408666
 13.408665  15.789741  13.982265  14.707729  15.076598  15.598281
 11.834411  13.917289  14.944657  13.408665  14.944656  13.471806
 13.40038   14.27535   14.944654  14.63417   14.84299   14.842988
 13.306044  14.062543  14.173036  14.173034  14.944657  14.348024
 14.707729  13.400412  13.902743  10.721532  15.19833   14.944657
 13.982265  14.445694  14.655672  15.19833   14.655668  13.400411
 12.022034  11.758698  14.611969  15.701084  13.344678  13.400412
 14.707729  14.640882  14.681341  13.40041   14.718284  14.386506
 13.982263  15.756938  14.944657  15.214321  11.786477  11.208304
 11.077802  10.937603  14.44569   15.565344  14.862066  14.944657
 14.487707  14.348023  13.400414  13.399984  15.789741  14.339868
 13.405302  14.285049  13.340458  14.285049  14.285049  14.285049
 14.28505   13.375181  14.285049  14.2850485 14.28505   13.375179
 14.28505   15.732321  10.159611  13.9552965 14.16675   15.153547
 15.742849  15.744139  13.872589  14.348024  14.822106  13.340459
 14.707729  10.585179  14.276036  13.37518   13.902751  13.902751
 15.267893  15.74285   14.285049  13.34468   14.285049  13.37518
 14.887906  14.707729  14.276036  14.276036  14.28505   14.487707
 14.276037  13.902749  13.340459  14.655668  13.34046   15.14799
 14.801278  13.986639  14.2850485 13.400411  15.198331  14.247325
 14.428317  15.78974   14.285049  14.2850485 14.348024  14.348024
 14.275351  14.285049  14.276035  14.285049  14.2850485 27.790411
 14.622454  14.247325  14.887904  14.642227  15.761111  14.887904
 14.887904  14.887904  13.93096   14.285049  14.642228  14.547703
 14.681446  14.2850485 14.547701  14.887904  14.887905  15.506948
 14.887904  14.247326  14.623687  10.119964  14.195756  14.285049
 16.27438   14.247326  14.657116  14.903033  14.241404  14.241404
 14.241403  15.68678   14.296879  15.68678   14.903033  15.765151
 14.241404  14.29688   14.657116  14.903034  14.714559  14.608196
 15.765152  14.642226  14.241404  14.903033  14.296879  14.241403
 14.241404  14.448203  14.427997  14.241404  14.642226 ]
2025-06-02 15:25:32,328 - DEBUG - Edge reconstruction errors: [5.2469807e+00 5.2295928e+00 7.9305491e+00 4.4248650e+01 2.4291425e+00
 1.3705031e+01 4.4231461e+01 4.4233593e+01 4.4231548e+01 7.9299278e+00
 4.4230587e+01 4.4232162e+01 4.4239113e+01 4.4238270e+01 4.4260914e+01
 4.4230724e+01 4.4235104e+01 4.4232189e+01 4.4232189e+01 1.0747499e+01
 7.9294443e+00 7.9330049e+00 4.4238976e+01 4.4237087e+01 4.4457531e+01
 4.4230587e+01 4.4232273e+01 4.4272057e+01 4.4304340e+01 4.4230591e+01
 4.4241917e+01 4.4247375e+01 4.4247375e+01 4.4230591e+01 4.4242855e+01
 4.4242855e+01 4.4234512e+01 4.4234837e+01 4.4233551e+01 4.4233551e+01
 4.4336956e+01 4.4239075e+01 4.4233192e+01 4.4238895e+01 4.4299057e+01
 4.4299057e+01 4.4235729e+01 4.4231808e+01 4.4231808e+01 4.4234940e+01
 4.4231918e+01 4.4231918e+01 4.4679317e+01 4.4235134e+01 7.9316821e+00
 7.9387341e+00 4.4232121e+01 4.4423130e+01 4.4247082e+01 4.4236542e+01
 4.4236542e+01 4.4231964e+01 5.3523053e+02 7.9578433e+00 7.9291177e+00
 4.4241268e+01 4.4258766e+01 4.4258766e+01 4.4230724e+01 4.4237652e+01
 4.4231697e+01 4.4231697e+01 8.0893207e+02 4.4232018e+01 4.4231091e+01
 4.4259224e+01 4.4255344e+01 4.4232758e+01 4.4232758e+01 4.4259552e+01
 4.4290848e+01 4.4233154e+01 4.4233154e+01 4.4236027e+01 4.4237049e+01
 4.4237049e+01 1.2230466e+01 4.4237900e+01 4.4231667e+01 4.4231667e+01
 4.4324783e+01 4.4234512e+01 4.4234512e+01 4.4238045e+01 4.4242386e+01
 4.4231968e+01 4.4231838e+01 4.4234600e+01 4.4234600e+01 4.4270893e+01
 4.4234741e+01 4.4232307e+01 4.4232307e+01 4.4277779e+01 4.4234844e+01
 4.4232006e+01 4.4233292e+01 4.4233292e+01 4.4230591e+01 4.4250748e+01
 4.4233212e+01 4.4233212e+01 7.9302549e+00 4.4262684e+01 4.4231640e+01
 4.4231640e+01 4.4230721e+01 4.4238689e+01 4.4239815e+01 4.4239677e+01
 4.4231743e+01 4.4231743e+01 4.4232151e+01 4.4232334e+01 4.4231560e+01
 4.4231560e+01 4.4235004e+01 4.4231834e+01 4.4231834e+01 4.4235554e+01
 4.4231689e+01 4.4231689e+01 4.4230724e+01 4.4231606e+01 4.4231606e+01
 4.4236916e+01 4.4231495e+01 4.4231495e+01 4.4234795e+01 4.4245525e+01
 4.4239616e+01 4.4239616e+01 4.4232166e+01 4.4231586e+01 4.4231586e+01
 4.4232475e+01 4.4232891e+01 4.4231586e+01 4.4231586e+01 4.4231720e+01
 4.4231720e+01 4.4236515e+01 4.4236515e+01 4.4232548e+01 4.4244701e+01
 4.4235229e+01 4.4235229e+01 4.4232365e+01 4.4240616e+01 4.4234791e+01
 4.4234791e+01 4.4232075e+01 4.4232075e+01 4.4232780e+01 4.4234673e+01
 4.4234673e+01 4.4230591e+01 4.4232220e+01 4.4233009e+01 4.4233009e+01
 4.4232182e+01 4.4233280e+01 4.4233280e+01 4.4232155e+01 4.4244564e+01
 4.4235817e+01 4.4235367e+01 4.4235214e+01 4.4231647e+01 4.4231647e+01
 4.4256538e+01 4.4256538e+01 4.4235714e+01 4.4234882e+01 4.4234917e+01
 4.4234123e+01 4.4234123e+01 4.4232368e+01 4.4232243e+01 4.4232243e+01
 4.4232185e+01 4.4247738e+01 4.4247738e+01 4.4232151e+01 4.4231903e+01
 4.4232178e+01 7.9321089e+00 7.9347239e+00 4.4234592e+01 4.4239754e+01
 4.4239754e+01 4.4253239e+01 4.4253239e+01 2.2537051e-01 4.4251942e+01
 4.4231277e+01 4.4231277e+01 4.4231335e+01 4.4231335e+01 4.4238747e+01
 4.4238747e+01 4.4232079e+01 4.4231812e+01 4.4231812e+01 4.4235104e+01
 4.4235104e+01 7.9332170e+00 8.6873700e+02 7.9310632e+00 7.9289551e+00
 4.4232365e+01 4.4231926e+01 4.4239067e+01 4.4232357e+01 4.4239788e+01
 4.4289906e+01 4.4242138e+01 4.4232063e+01 4.4240517e+01 4.4237122e+01
 4.4235943e+01 4.4232262e+01 4.4235371e+01 4.4231941e+01 4.4231968e+01
 4.4232296e+01 4.4231853e+01 4.4276623e+01 4.4234787e+01 4.4232536e+01
 4.4232674e+01 4.4232147e+01 4.4250893e+01 4.4233292e+01 4.4232677e+01
 7.9307656e+00 4.4254524e+01 7.9300261e+00 4.4231453e+01 4.4234516e+01
 4.4827805e+01 4.4827805e+01 4.4230591e+01 4.4232403e+01 1.5749608e+01
 2.4291425e+00 5.8643360e+01 5.8643360e+01 4.6432537e+01 7.9431787e+00
 4.4309158e+01 4.4235043e+01 4.4232426e+01 7.9299107e+00 4.4234222e+01
 4.4230721e+01 4.4289505e+01 4.4235092e+01 4.4233143e+01 4.4233143e+01
 4.4241238e+01 4.4233463e+01 4.4238617e+01 4.4233421e+01 4.4235432e+01
 4.4241463e+01 4.4241463e+01 4.4235329e+01 4.4235310e+01 4.4233913e+01
 4.4233913e+01 1.0398905e+01 4.4237453e+01 4.4232834e+01 4.4232834e+01
 4.4232567e+01 4.4232262e+01 4.4232262e+01 4.4232136e+01 4.4237148e+01
 4.4237148e+01 4.4235317e+01 4.4239239e+01 4.4239239e+01 4.4232189e+01
 4.4289059e+01 4.4289059e+01 4.4261997e+01 4.4236694e+01 4.4236694e+01
 4.4232079e+01 4.4232079e+01 4.4232273e+01 4.4247749e+01 4.4247749e+01
 4.4232586e+01 4.4266140e+01 4.4266140e+01 4.4778652e+01 4.4778652e+01
 4.4230591e+01 4.4239868e+01 4.4231369e+01 4.4232346e+01 4.4235561e+01
 4.4230591e+01 4.4238907e+01 4.4238907e+01 4.4236877e+01 4.4294640e+01
 4.4272694e+01 4.4272694e+01 4.4230808e+01 4.4233318e+01 4.4230724e+01
 4.4237797e+01 4.4237797e+01 4.4235229e+01 4.4230808e+01 4.4242558e+01
 4.4237907e+01 4.4237907e+01 4.4235088e+01 4.4230721e+01 4.4247643e+01
 4.4230591e+01 4.4232708e+01 4.4230652e+01 4.4239231e+01 4.4239471e+01
 4.4232193e+01 4.4232193e+01 4.4236366e+01 4.4233234e+01 4.4233234e+01
 4.4271538e+01 4.4245644e+01 4.4234165e+01 4.4234165e+01 4.4245609e+01
 4.4235741e+01 4.4235741e+01 4.4245449e+01 4.4235901e+01 4.4232929e+01
 4.4232929e+01 4.4240334e+01 4.4245808e+01 4.4238621e+01 4.4238621e+01
 4.4230591e+01 4.4260002e+01 4.4263371e+01 4.4263371e+01 4.4238380e+01
 4.4231930e+01 4.4231930e+01 4.4234852e+01 4.4234852e+01 4.4232182e+01
 4.4239643e+01 4.4239861e+01 4.4239861e+01 1.2230466e+01 4.4234535e+01
 4.4234638e+01 4.4246487e+01 4.4255154e+01 4.4255154e+01 4.4232273e+01
 4.4234634e+01 4.4234337e+01 4.4234337e+01 4.4230591e+01 4.4272259e+01
 4.4274925e+01 4.4274925e+01 4.4230591e+01 4.4236835e+01 4.4315647e+01
 4.4315647e+01 4.4231926e+01 4.4234608e+01 4.4231945e+01 4.4255886e+01
 4.4231968e+01 4.4232624e+01 4.4232624e+01 4.4230591e+01 4.4235020e+01
 4.4279198e+01 4.4279198e+01 7.9306259e+00 4.4231911e+01 4.4231911e+01
 4.4241634e+01 4.4233120e+01 4.4231926e+01 4.4230721e+01 4.4232594e+01
 4.4244797e+01 4.4251434e+01 4.4231869e+01 4.4231846e+01 4.4241543e+01
 4.4239525e+01 4.4239525e+01 4.4231903e+01 4.4261211e+01 4.4233429e+01
 4.4233429e+01 4.4230591e+01 4.4233295e+01 4.4233295e+01 4.4236504e+01
 4.4236759e+01 4.4236759e+01 4.4234863e+01 4.4230591e+01 4.4238743e+01
 4.4238743e+01 4.4235149e+01 4.4235149e+01 4.4232182e+01 4.4230591e+01
 4.4237568e+01 4.4237568e+01 4.4310459e+01 4.4232838e+01 4.4232838e+01
 7.9331951e+00 4.4244072e+01 4.4230591e+01 4.4232227e+01 4.4238472e+01
 4.4231983e+01 4.4235569e+01 4.4232819e+01 4.4232819e+01 4.4235424e+01
 4.4232159e+01 4.4232159e+01 4.4235939e+01 4.4232624e+01 4.4232624e+01
 4.4236530e+01 4.4232712e+01 4.4232712e+01 4.4234859e+01 4.4234932e+01
 4.4231926e+01 4.4238232e+01 4.4238232e+01 4.4230591e+01 4.4257130e+01
 4.4232403e+01 4.4232403e+01 4.4240063e+01 4.4231922e+01 4.4231922e+01
 4.4250458e+01 4.4231907e+01 4.4239864e+01 4.4239864e+01 4.4230591e+01
 4.4232182e+01 4.4235073e+01 4.4231163e+01 4.4231972e+01 4.4233223e+01
 4.4260185e+01 4.4530079e+01 4.4530079e+01 4.4235447e+01 4.4232418e+01
 4.4232418e+01 4.4232361e+01 4.4234802e+01 4.4233837e+01 4.4233837e+01
 4.4239502e+01 4.4241184e+01 4.4231892e+01 4.4231892e+01 4.4231956e+01
 4.4236538e+01 4.4233223e+01 4.4233223e+01 4.4230591e+01 4.4242622e+01
 4.4242622e+01 4.4230591e+01 4.4232132e+01 4.4232132e+01 4.4246643e+01
 4.4240509e+01 4.4240509e+01 4.4234848e+01 7.9299808e+00 4.4235748e+01
 4.4233635e+01 4.4233635e+01 4.4239319e+01 4.4233097e+01 4.4231895e+01
 4.4231895e+01 4.4231964e+01 4.4231922e+01 7.9299808e+00 7.9288659e+00
 7.9292202e+00 7.9300332e+00 4.4235291e+01 4.4232697e+01 4.4232697e+01
 4.4235394e+01 4.4235931e+01 4.4293674e+01 4.4293674e+01 4.4231949e+01
 4.4235107e+01 4.4234280e+01 4.4234280e+01 7.9303842e+00 4.4230587e+01
 4.4248413e+01 8.6837673e+00 4.4235035e+01 4.4232224e+01 4.4235706e+01
 4.4233131e+01 4.4233131e+01 4.4258930e+01 4.4258930e+01 4.4235489e+01
 4.4235489e+01 4.4230724e+01 4.4234577e+01 4.4246143e+01 4.4243351e+01
 4.4243351e+01 4.4261810e+01 4.4232464e+01 4.4230785e+01 4.4240238e+01
 4.4236912e+01 4.4236912e+01 4.4234634e+01 4.4236973e+01 4.4232029e+01
 4.4232029e+01 4.4234631e+01 4.4233452e+01 4.4233452e+01 4.4231964e+01
 4.4249271e+01 4.4249271e+01 4.4232193e+01 4.4232193e+01 4.4233017e+01
 4.4233017e+01 4.4234245e+01 4.4234245e+01 4.4238663e+01 4.4238663e+01
 4.4232101e+01 4.4232101e+01 7.9302802e+00 4.4231922e+01 4.4342716e+01
 4.4235832e+01 4.4231937e+01 7.9300261e+00 4.4235466e+01 4.4234947e+01
 4.4234924e+01 4.4235382e+01 5.5982156e+00 5.4915209e+00 4.4230892e+01
 4.4244953e+01 4.4244953e+01 4.4231613e+01 7.9300385e+00 4.4230606e+01
 7.9326715e+00 5.8630878e+01 2.4288726e+00 4.6431515e+01 7.9305387e+00
 4.4242302e+01 4.4230621e+01 4.4232136e+01 4.4236561e+01 4.4281559e+01
 4.4236759e+01 4.4233639e+01 4.4234032e+01 4.4232933e+01 4.4232101e+01
 4.4521259e+01 4.4246349e+01 4.4241680e+01 4.4232960e+01 4.4363621e+01
 4.4363621e+01 4.4230892e+01 4.4241238e+01 4.4696846e+01 4.4234764e+01
 7.9763160e+00 1.1590051e+01 4.4232555e+01 4.4240860e+01 4.4260334e+01
 4.4230762e+01 4.4233490e+01 8.0981579e+00 1.3730570e+01 7.9304852e+00
 4.4241669e+01 4.4241669e+01 4.4582912e+01 4.4230671e+01 4.4230602e+01
 4.4230606e+01 4.4230618e+01 4.4419235e+01 4.4244377e+01 4.4249783e+01
 4.4231941e+01 4.4233051e+01 4.4236107e+01 4.4254761e+01 4.4230652e+01
 4.4247349e+01 4.4247349e+01 4.4233871e+01 4.4232094e+01 1.3754379e+01
 4.4230606e+01 4.4243362e+01 4.4233681e+01 4.4234364e+01 4.4241726e+01
 4.4258553e+01 4.4233269e+01 4.4387699e+01 4.4387699e+01 4.4233475e+01
 4.4277924e+01 5.3523065e+02 4.4237782e+01 4.4287750e+01 4.4287750e+01
 4.4310841e+01 4.4235111e+01 4.4235111e+01 4.4237827e+01 4.4231865e+01
 4.4264992e+01 4.4365917e+01 4.4249882e+01 4.4264454e+01 4.4238136e+01
 4.4261250e+01 4.4261250e+01 4.4238472e+01 4.4248665e+01 4.4232162e+01
 4.4235115e+01 4.4241688e+01 4.4241688e+01 4.4232918e+01 4.4251217e+01
 4.4234215e+01 4.4232761e+01 4.4232761e+01 4.4232376e+01 4.4253197e+01
 4.4253197e+01 4.4238163e+01 4.4234982e+01 4.4234982e+01 4.4236961e+01
 4.4288502e+01 4.4288502e+01 4.4267132e+01 4.4232838e+01 4.4232792e+01
 4.4235344e+01 4.4255692e+01 4.4255692e+01 4.4234711e+01 4.4239933e+01
 4.4239933e+01 4.4245537e+01 4.4232758e+01 4.4232758e+01 4.4235340e+01
 4.4238712e+01 4.4238712e+01 4.4234440e+01 4.4239929e+01 4.4239929e+01
 4.4234612e+01 4.4246498e+01 4.4245106e+01 4.4245106e+01 4.4238857e+01
 4.4231857e+01 4.4264648e+01 4.4258835e+01 4.4258835e+01 4.4231728e+01
 4.4233280e+01 4.4235157e+01 4.4235897e+01 4.4232746e+01 4.4232746e+01
 4.4234749e+01 4.4235199e+01 4.4239357e+01 4.4234917e+01 4.4232029e+01
 4.4232029e+01 4.4232059e+01 4.4232620e+01 4.4233971e+01 4.4236240e+01
 4.4233490e+01 4.4232685e+01 4.4232685e+01 4.4234192e+01 4.4234409e+01
 4.4234409e+01 4.4231747e+01 4.4233418e+01 4.4233418e+01 4.4384972e+01
 4.4249401e+01 4.4233437e+01 4.4234444e+01 4.4246666e+01 4.4241417e+01
 4.4231777e+01 4.4233738e+01 4.4233738e+01 4.4249256e+01 4.4231884e+01
 4.4233643e+01 4.4233345e+01 4.4233345e+01 4.4363472e+01 4.4231762e+01
 4.4234272e+01 4.4234272e+01 4.4232536e+01 4.4232933e+01 4.4232468e+01
 4.4232075e+01 4.4232075e+01 4.4232067e+01 4.4231586e+01 4.7364849e+01
 4.4232674e+01 4.4238586e+01 4.4232231e+01 4.4241776e+01 4.4231781e+01
 4.4231903e+01 4.4231731e+01 4.4233662e+01 4.4233662e+01 4.4232014e+01
 4.4235928e+01 4.4235928e+01 4.4262184e+01 4.4232330e+01 4.4501324e+01
 4.4231796e+01 4.4252880e+01 4.4231808e+01 4.4232002e+01 4.4232674e+01
 4.4232674e+01 4.4235538e+01 4.4235538e+01 4.4236889e+01 4.4236889e+01
 4.4234791e+01 4.4234791e+01 4.4236092e+01 4.4292038e+01 4.4292038e+01
 4.4237286e+01 4.4237286e+01 4.4273289e+01 4.4265522e+01 4.4265522e+01
 4.4253868e+01 4.4240059e+01 4.4240059e+01 4.4294781e+01 4.4294781e+01
 4.4270622e+01 4.4270622e+01 4.4282997e+01 4.4282997e+01 4.4323284e+01
 4.4323284e+01 1.3330898e+01 2.4335778e+00 5.8632160e+01 2.4329543e+00
 4.6431149e+01 4.4232773e+01 7.9305053e+00 5.8631783e+01 5.3523065e+02
 5.3523053e+02 1.3330522e+01 1.3330531e+01]
2025-06-02 15:25:32,334 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152532_update_16.json
2025-06-02 15:25:32,335 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:25:32,349 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152532_update_16.pth
2025-06-02 15:25:32,350 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869575.dot): 0.1855
2025-06-02 15:25:32,350 - WARNING - Detected 7 anomalous nodes (reconstruction-based):
2025-06-02 15:25:32,350 - WARNING -   Node ID: 192.168.27.10, Recon Error: 19.7273, MLP Score: 0.2243
2025-06-02 15:25:32,350 - WARNING -   Node ID: ff02::2, Recon Error: 27.5508, MLP Score: 0.4165
2025-06-02 15:25:32,350 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 28.1555, MLP Score: 0.4072
2025-06-02 15:25:32,351 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 23.3975, MLP Score: 0.3250
2025-06-02 15:25:32,351 - WARNING -   Node ID: ff02::fb, Recon Error: 21.7147, MLP Score: 0.3657
2025-06-02 15:25:32,351 - WARNING - Detected 6 anomalous edges (reconstruction-based):
2025-06-02 15:25:32,351 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2305, MLP Score: 0.0000
2025-06-02 15:25:32,352 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9321, MLP Score: 0.0000
2025-06-02 15:25:32,352 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7370, MLP Score: 0.0000
2025-06-02 15:25:32,352 - WARNING -   Source: 192.168.27.10, Target: 224.0.0.251, Recon Error: 535.2307, MLP Score: 0.0000
2025-06-02 15:25:32,352 - WARNING -   Source: fe80::eb4e:a54d:8c61:6ce1, Target: ff02::fb, Recon Error: 535.2307, MLP Score: 0.0000
2025-06-02 15:25:32,360 - DEBUG - Embedding standard deviations before t-SNE: [0.95132023 0.12311826 0.         0.41754133 0.05420984 0.
 0.37453794 0.62804276 0.         0.7537668  0.         0.
 0.         0.04007153 0.6015599  0.45457664 0.12290362 0.7524463
 0.         0.7712504  0.         0.5892192  0.         0.
 0.         0.         0.6009148  0.63935333 0.         0.
 0.666825   0.4218403 ]
2025-06-02 15:25:33,097 - INFO - Embeddings visualization saved to vis/embeddings_16_updates_20250602_152532.png
2025-06-02 15:25:33,097 - INFO - Performing visualization of node and edge features.
2025-06-02 15:25:33,100 - INFO - Starting visualization of node features.
2025-06-02 15:25:33,101 - INFO - Graph has 419 nodes and 30 features.
2025-06-02 15:25:33,101 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:25:33,101 - INFO - Calculating feature statistics:
2025-06-02 15:25:33,101 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:33,102 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:33,102 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 9, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.551785), 'max': np.float32(1.4956648)}
2025-06-02 15:25:33,102 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 9, 'mean': np.float32(-3.641716e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.4676753), 'max': np.float32(2.5807602)}
2025-06-02 15:25:33,103 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:33,103 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:33,103 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:33,104 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(-3.4141085e-08), 'std': np.float32(1.0), 'min': np.float32(-0.41278455), 'max': np.float32(2.4225714)}
2025-06-02 15:25:33,104 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(1.13803615e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.2852621), 'max': np.float32(0.77805144)}
2025-06-02 15:25:33,104 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 3, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-7.1329055), 'max': np.float32(0.14374286)}
2025-06-02 15:25:33,104 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 9, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-3.6133795), 'max': np.float32(1.0095472)}
2025-06-02 15:25:33,105 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 9, 'mean': np.float32(1.820858e-08), 'std': np.float32(1.0), 'min': np.float32(-0.9946777), 'max': np.float32(3.6515121)}
2025-06-02 15:25:33,105 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 6, 'mean': np.float32(2.4582338), 'std': np.float32(1.0130639), 'min': np.float32(0.0), 'max': np.float32(7.0)}
2025-06-02 15:25:33,105 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.9427207), 'std': np.float32(0.3335829), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:25:33,106 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.14081146), 'std': np.float32(0.37426817), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:25:33,106 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.3436756), 'std': np.float32(0.5707901), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:25:33,106 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 3, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.14374286), 'max': np.float32(7.1329055)}
2025-06-02 15:25:33,106 - INFO - - service_1: {'name': 'service_1', 'unique': 5, 'mean': np.float32(3.4797137), 'std': np.float32(3.120713), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 15:25:33,107 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.646778), 'std': np.float32(2.9392102), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:25:33,107 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.6062055), 'std': np.float32(1.5026023), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:25:33,107 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.14081146), 'std': np.float32(0.37426817), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:25:33,108 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 1, 'mean': np.float32(8.0), 'std': np.float32(0.0), 'min': np.float32(8.0), 'max': np.float32(8.0)}
2025-06-02 15:25:33,108 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(4.09693e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.15512793), 'max': np.float32(12.03211)}
2025-06-02 15:25:33,108 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(1.3656434e-08), 'std': np.float32(1.0000001), 'min': np.float32(-0.17170915), 'max': np.float32(5.823802)}
2025-06-02 15:25:33,108 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:33,109 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:33,109 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:33,109 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:33,110 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(-3.1865014e-08), 'std': np.float32(1.0), 'min': np.float32(-1.0751959), 'max': np.float32(8.647978)}
2025-06-02 15:25:33,110 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(-1.9346615e-08), 'std': np.float32(1.0), 'min': np.float32(-1.2040381), 'max': np.float32(4.401428)}
2025-06-02 15:25:33,178 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7f92913d1e20>
2025-06-02 15:25:33,931 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:25:34,307 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:25:34,488 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:25:39,211 - INFO - Node feature visualization saved to vis/node_features_20250602_152535.png
2025-06-02 15:25:39,211 - INFO - Finished visualization of node features.
2025-06-02 15:25:39,211 - INFO - Performing additional feature analysis:
2025-06-02 15:25:39,212 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:25:39,217 - INFO - Starting visualization of edge features.
2025-06-02 15:25:39,218 - INFO - Graph has 833 edges and 10 edge features.
2025-06-02 15:25:39,218 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:25:39,218 - INFO - Calculating edge feature statistics:
2025-06-02 15:25:39,219 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:25:39,220 - INFO - - count: {'name': 'count', 'unique': 21, 'mean': np.float32(9.158937e-09), 'std': np.float32(1.0), 'min': np.float32(-0.068577066), 'max': np.float32(19.334204)}
2025-06-02 15:25:39,220 - INFO - - dst_port: {'name': 'dst_port', 'unique': 13, 'mean': np.float32(461.0096), 'std': np.float32(526.1465), 'min': np.float32(3.0), 'max': np.float32(8688.0)}
2025-06-02 15:25:39,220 - INFO - - protocol: {'name': 'protocol', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:39,220 - INFO - - service: {'name': 'service', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:39,220 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 558, 'mean': np.float32(4.5794684e-09), 'std': np.float32(1.0), 'min': np.float32(-0.113668054), 'max': np.float32(19.650415)}
2025-06-02 15:25:39,221 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 595, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.103927135), 'max': np.float32(19.133986)}
2025-06-02 15:25:39,221 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 206, 'mean': np.float32(6.8692025e-09), 'std': np.float32(1.0), 'min': np.float32(-0.087794885), 'max': np.float32(19.02295)}
2025-06-02 15:25:39,221 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 570, 'mean': np.float32(2.2897342e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.10684508), 'max': np.float32(21.271181)}
2025-06-02 15:25:39,221 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 590, 'mean': np.float32(4.5794684e-09), 'std': np.float32(1.0), 'min': np.float32(-0.109008655), 'max': np.float32(21.061152)}
2025-06-02 15:25:39,221 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 222, 'mean': np.float32(-4.5794684e-09), 'std': np.float32(1.0), 'min': np.float32(-0.10469742), 'max': np.float32(18.49781)}
2025-06-02 15:25:39,311 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7f92908198b0>
2025-06-02 15:25:39,859 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:25:39,927 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7f92901086b0>
2025-06-02 15:25:40,305 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:25:40,880 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:25:41,278 - DEBUG - Plotted boxplots of the first 8 non-constant edge features.
2025-06-02 15:25:41,357 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:25:41,387 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:25:45,310 - INFO - Edge feature visualization saved to vis/edge_features_20250602_152541.png
2025-06-02 15:25:45,311 - INFO - Finished visualization of edge features.
2025-06-02 15:25:45,311 - INFO - Performing additional edge feature analysis:
2025-06-02 15:25:45,311 - INFO - - 2 out of 10 edge features are constant.
2025-06-02 15:25:45,312 - INFO - - Highest correlation (1.00) between features: 'total_resp_bytes' and 'total_resp_ip_bytes'.
2025-06-02 15:25:45,319 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:25:45,319 - INFO - Graph has 833 edges and 10 edge features.
2025-06-02 15:25:45,319 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:25:46,939 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_152545_summary.png
2025-06-02 15:25:47,724 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_152545_pca_3d.png
2025-06-02 15:25:48,210 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_152545_pca_variance.png
2025-06-02 15:25:48,211 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:25:48,211 - INFO - 
--- Processing file: nw_graph_encoded_1748869605.dot (Timestamp: 2025-06-02 15:06:45) ---
2025-06-02 15:25:48,211 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869605.dot
2025-06-02 15:25:48,211 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869605.dot'.
2025-06-02 15:25:48,211 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869605.dot
2025-06-02 15:25:48,230 - INFO - Parsed 439 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869605.dot'.
2025-06-02 15:25:48,278 - INFO - Parsed 919 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869605.dot'.
2025-06-02 15:25:48,278 - INFO - Processing node updates/additions.
2025-06-02 15:25:48,297 - INFO - Processing edge updates/additions.
2025-06-02 15:25:48,367 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:25:48,371 - INFO - Finished updating NetworkX graph.
2025-06-02 15:25:48,373 - DEBUG - Updated graph - Nodes: 439, Edges: 919
2025-06-02 15:25:48,373 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:25:48,377 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:25:48,464 - DEBUG - Initial node features tensor shape: torch.Size([439, 30])
2025-06-02 15:25:48,472 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:25:48,478 - DEBUG - Node features tensor shape after scaling: torch.Size([439, 30])
2025-06-02 15:25:48,481 - DEBUG - Edge index tensor shape: torch.Size([2, 919])
2025-06-02 15:25:48,487 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:25:48,528 - DEBUG - Initial edge attributes tensor shape: torch.Size([919, 10])
2025-06-02 15:25:48,534 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:25:48,540 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([919, 10])
2025-06-02 15:25:48,541 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:25:48,541 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:25:48,543 - INFO - Updated main graph to 439 nodes and 919 edges.
2025-06-02 15:25:48,543 - INFO - Performing online update...
2025-06-02 15:25:48,544 - INFO - Starting online update for 25 steps.
2025-06-02 15:25:48,545 - DEBUG - Updated RunningStats: new_mean=0.9383308154483265, new_var=9000000000159.291, new_n=930
2025-06-02 15:25:48,545 - DEBUG - Updated RunningStats: new_mean=0.9323558082069221, new_var=9300000000019.541, new_n=960
2025-06-02 15:25:48,546 - DEBUG - Updated RunningStats: new_mean=39.167474167402915, new_var=3000000198753.13, new_n=310
2025-06-02 15:25:48,546 - DEBUG - Updated RunningStats: new_mean=39.68736580816862, new_var=3100000275188.3403, new_n=320
2025-06-02 15:25:48,546 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:25:48,547 - DEBUG - Online update step: 1/25
2025-06-02 15:25:48,547 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,547 - DEBUG - Online update step: 2/25
2025-06-02 15:25:48,547 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,547 - DEBUG - Online update step: 3/25
2025-06-02 15:25:48,547 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,548 - DEBUG - Online update step: 4/25
2025-06-02 15:25:48,548 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,548 - DEBUG - Online update step: 5/25
2025-06-02 15:25:48,548 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,548 - DEBUG - Online update step: 6/25
2025-06-02 15:25:48,548 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,549 - DEBUG - Online update step: 7/25
2025-06-02 15:25:48,549 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,549 - DEBUG - Online update step: 8/25
2025-06-02 15:25:48,549 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,549 - DEBUG - Online update step: 9/25
2025-06-02 15:25:48,549 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,549 - DEBUG - Online update step: 10/25
2025-06-02 15:25:48,550 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,550 - DEBUG - Online update step: 11/25
2025-06-02 15:25:48,550 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,550 - DEBUG - Online update step: 12/25
2025-06-02 15:25:48,550 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,550 - DEBUG - Online update step: 13/25
2025-06-02 15:25:48,551 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,551 - DEBUG - Online update step: 14/25
2025-06-02 15:25:48,551 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,551 - DEBUG - Online update step: 15/25
2025-06-02 15:25:48,551 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,551 - DEBUG - Online update step: 16/25
2025-06-02 15:25:48,552 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,552 - DEBUG - Online update step: 17/25
2025-06-02 15:25:48,552 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,552 - DEBUG - Online update step: 18/25
2025-06-02 15:25:48,552 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,552 - DEBUG - Online update step: 19/25
2025-06-02 15:25:48,553 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,553 - DEBUG - Online update step: 20/25
2025-06-02 15:25:48,553 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,553 - DEBUG - Online update step: 21/25
2025-06-02 15:25:48,553 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,553 - DEBUG - Online update step: 22/25
2025-06-02 15:25:48,554 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,554 - DEBUG - Online update step: 23/25
2025-06-02 15:25:48,554 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,554 - DEBUG - Online update step: 24/25
2025-06-02 15:25:48,554 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,554 - DEBUG - Online update step: 25/25
2025-06-02 15:25:48,554 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,555 - WARNING - No successful steps during online update.
2025-06-02 15:25:48,556 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -2.3896167e-08 -2.8240924e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.6068546e-08
 -4.3447579e-09  1.1948083e-08 -2.0637598e-08 -3.2585682e-08
  2.4510250e+00  2.9453304e+00  1.6400911e-01  4.3280182e+00
 -2.0637598e-08  3.6173120e+00  5.4715261e+00  7.5831437e+00
  1.6400911e-01  8.0000000e+00 -1.3034273e-08 -2.4982358e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -6.7886838e-09 -2.4982358e-08], current edge mean: [ 1.0377305e-09  4.6919803e+02  0.0000000e+00  0.0000000e+00
 -3.1131915e-09  5.1886526e-09  5.1886523e-10  7.2641133e-09
 -8.3018437e-09 -3.1131915e-09]
2025-06-02 15:25:48,556 - DEBUG - Node drift difference: 0.0619, Edge drift difference: 0.0156
2025-06-02 15:25:48,558 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -2.3896167e-08 -2.8240924e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.6068546e-08
 -4.3447579e-09  1.1948083e-08 -2.0637598e-08 -3.2585682e-08
  2.4510250e+00  2.9453304e+00  1.6400911e-01  4.3280182e+00
 -2.0637598e-08  3.6173120e+00  5.4715261e+00  7.5831437e+00
  1.6400911e-01  8.0000000e+00 -1.3034273e-08 -2.4982358e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -6.7886838e-09 -2.4982358e-08], edge=[ 1.0377305e-09  4.6919803e+02  0.0000000e+00  0.0000000e+00
 -3.1131915e-09  5.1886526e-09  5.1886523e-10  7.2641133e-09
 -8.3018437e-09 -3.1131915e-09]
2025-06-02 15:25:48,558 - DEBUG - Updated reference std: node=[0.         0.         1.0011408  1.0011408  0.         0.
 0.         1.0011408  1.001141   1.001141   1.0011408  1.001141
 1.003074   0.3264865  0.39457318 0.56690574 1.001141   3.2002099
 2.9714756  1.5429286  0.39457318 0.         1.001141   1.0011408
 0.         0.         0.         0.         1.001141   1.001141  ], edge=[  1.0005445 551.03625     0.          0.          1.0005445   1.0005445
   1.0005445   1.0005445   1.0005445   1.0005445]
2025-06-02 15:25:48,559 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:25:48,559 - INFO - Running anomaly detection...
2025-06-02 15:25:48,559 - INFO - Starting anomaly detection.
2025-06-02 15:25:48,569 - DEBUG - Node reconstruction errors: [16.06518   15.942684  17.16327   17.593388  13.214388  14.639618
 17.16327   16.83714   16.837141  17.652927  16.837143  12.832416
 21.121935  12.983506  16.277721  16.484215  12.985071  16.484219
 17.940643  15.938436  15.256506  16.277721  15.181342  10.919171
 15.994993  17.334446  15.994991  13.200552  16.288782  15.994991
 12.079592  17.099024  13.047564  17.063946  17.334446  16.553394
 13.900588  15.938436  11.69523   11.553344  17.205683  15.823194
 15.938433  16.684732  16.93242   14.975092  17.713316  12.260306
 15.821837  27.441776  28.412062  16.897823  16.858572  16.086813
 14.65557   12.129282  17.1443    15.102094  16.52724   16.52724
 11.440151  16.342932  15.45192   10.627226  15.419484  14.65557
 14.872724  14.655566  15.451919  15.451919  14.553556  13.864255
 16.475267  14.267873  15.23454   13.9486265 16.405993  14.389424
 14.100572  14.170434  15.973395  13.592141  10.227757  15.982361
 15.862841  10.565825  13.829042  14.091984  14.944892  13.651263
 14.982886  12.609964  11.111777  14.00185   14.680426  23.637533
 15.761356  13.545752  14.814314  14.950479  13.545753  15.761356
 16.131264  14.67339   10.1721525 14.87761   14.776632  11.261052
 11.183925  21.769726  15.055999  15.728449  11.251735  11.43886
 13.520713  13.545742  13.474094  12.583409  14.030206  14.9438305
 14.733102  11.111777  11.160074  11.11178   14.944551  15.805277
 10.444781  10.580389  13.545753  15.565495  15.848607  14.968343
 14.543432  12.722319  13.437833  14.68033   16.173943  14.931262
 14.968344  11.386219  14.9438305 14.302344  14.700316  14.968343
 14.968343  13.545741  13.474092  15.140222  14.968309  13.995134
 18.116793  10.172194  14.380173  14.968344  15.060658  11.89159
 14.943831  13.48691   13.545751  16.292507  15.1402235 11.38763
 14.9438305 15.848606  13.474092  11.834579  13.802288  13.995138
 10.744532  13.995103  14.109118  14.943831  14.909917  22.265848
 13.995137  13.347251  13.995129  13.423841  13.4600725 13.460073
 14.733466  11.12746   14.239976  11.179786  11.801748  13.460071
 14.693261  13.510378  14.693261  14.995866  14.04787   14.723936
 15.8407    15.033163  14.733102  15.840701  14.686734  14.700316
 11.874347  15.565494  14.931262  15.140223  11.355563  14.030208
 14.239828  11.11178   15.579355  12.092655  14.737527  14.295992
 14.068343  13.460074  15.8407    14.039569  13.460076  14.909918
 13.460076  13.474093  13.366883  15.033162  11.372412  14.65779
 14.7631645 15.840701  15.140224  14.746225  13.460073  15.140224
 14.012667  15.399944  11.160701  13.460074  13.995137  13.474091
 13.4740925 15.840701  14.01267   14.763165  15.140222  15.658932
 11.863724  14.903163  14.995866  13.995135  14.995866  14.204307
 13.44969   14.33352   14.995866  14.692816  14.909918  14.909917
 13.366882  14.109119  13.437831  14.239798  14.995866  14.778912
 14.7631645 13.4600725 14.279806  10.763803  15.252219  14.995866
 14.012667  14.6854    15.054128  15.252219  15.05413   13.460076
 12.063163  11.801751  14.8752    16.145908  13.714938  13.460077
 14.407681  14.672723  14.733466  13.460074  15.283454  14.43856
 14.746206  16.210909  14.995866  15.668307  11.900096  11.263007
 11.1274605 11.000269  14.652047  15.621158  15.276768  14.995866
 14.540289  14.778912  13.460076  13.45968   15.840699  14.392881
 13.44299   14.701689  13.695256  13.695257  14.70169   14.701689
 14.70169   13.740862  14.70169   14.70169   14.70169   13.740864
 14.701689  15.756646  10.481338  14.058325  14.199078  15.189206
 15.777971  15.783368  15.008991  14.778912  14.845216  13.695255
 14.657791  11.141069  14.703602  13.740864  14.27981   14.279811
 15.658221  15.777971  14.70169   13.714936  14.701689  13.740863
 14.892171  14.7631645 14.703602  14.7036    14.70169   14.540289
 14.7036    15.008998  13.695257  15.054127  13.695255  15.5943365
 15.157606  14.033713  14.701687  13.423841  15.252217  14.287179
 14.474171  15.840701  14.70169   14.70169   14.778912  14.7789135
 14.333515  14.70169   14.7036    13.694934  13.69523   22.24091
 14.6500635 14.287179  13.442987  14.212332  13.992933  13.44299
 14.75506   11.1524315 14.163076  14.486716  14.684149  14.947786
 14.896683  14.70169   13.695256  14.926366  14.892171  14.638018
 14.926367  13.442988  14.661014  10.156549  14.508905  14.70169
 14.470133  13.44299   14.675942  14.9198675 14.536576  14.536575
 14.536575  15.762132  14.691803  15.762133  14.919869  15.781417
 14.536574  14.691804  14.675942  14.9198675 15.048852  14.650687
 15.781417  14.684152  14.536575  14.91987   14.691804  14.536574
 14.536575  14.464459  14.467961  14.536574  14.684152  14.675942
 14.675942  14.9198675 14.675942  14.9198675 10.466273  15.444599
 14.919869  15.5499325 11.231409  15.2008505 15.0983    14.66917
 14.536574  14.3108835 14.536574  14.536575  14.91987   14.3108835
 15.2008505]
2025-06-02 15:25:48,581 - DEBUG - Edge reconstruction errors: [5.24858427e+00 5.23039341e+00 7.93119097e+00 4.42485504e+01
 2.42980337e+00 1.39580498e+01 4.42320747e+01 4.42341690e+01
 4.42321548e+01 7.93055677e+00 4.42312202e+01 4.42327271e+01
 4.42393684e+01 4.42387466e+01 4.42748795e+01 4.42313423e+01
 4.42355423e+01 4.42327614e+01 4.42327614e+01 1.09623022e+01
 7.93006897e+00 7.93346262e+00 4.42395248e+01 4.42373543e+01
 4.44492760e+01 4.42312164e+01 4.42328339e+01 4.42710114e+01
 4.43032532e+01 4.42312202e+01 4.42421684e+01 4.42479134e+01
 4.42479134e+01 4.42312202e+01 4.42436028e+01 4.42436028e+01
 4.42350960e+01 4.42352867e+01 4.42340736e+01 4.42340736e+01
 4.43349266e+01 4.42393570e+01 4.42337379e+01 4.42395172e+01
 4.42994576e+01 4.42994576e+01 4.42361450e+01 4.42323952e+01
 4.42323952e+01 4.42353821e+01 4.42324905e+01 4.42324905e+01
 4.46880722e+01 4.42355728e+01 7.93218946e+00 7.93894005e+00
 4.42326775e+01 4.44158630e+01 4.42470169e+01 4.42427864e+01
 4.42427864e+01 4.42325401e+01 5.35231201e+02 7.95722866e+00
 7.92976284e+00 4.42419930e+01 4.42890663e+01 4.42890663e+01
 4.42313423e+01 4.42383156e+01 4.42341499e+01 4.42341499e+01
 8.08936279e+02 4.42325897e+01 4.42316895e+01 4.42586365e+01
 4.42549019e+01 4.42385292e+01 4.42385292e+01 4.42589493e+01
 4.43047523e+01 4.42450905e+01 4.42450905e+01 4.42364388e+01
 4.42374458e+01 4.42374458e+01 1.22310944e+01 4.42383804e+01
 4.42351379e+01 4.42351379e+01 4.43221931e+01 4.42349586e+01
 4.42349586e+01 4.42383499e+01 4.42426643e+01 4.42360687e+01
 4.42354355e+01 4.42349930e+01 4.42349930e+01 4.42816734e+01
 4.42394829e+01 4.42423286e+01 4.42423286e+01 2.25160718e-01
 4.42763519e+01 4.42401924e+01 4.42357063e+01 4.42338104e+01
 4.42338104e+01 4.42312202e+01 4.42606697e+01 4.42336922e+01
 4.42336922e+01 7.93088007e+00 4.42620354e+01 4.42350349e+01
 4.42350349e+01 4.42313385e+01 4.42389641e+01 4.42400284e+01
 4.42398911e+01 4.42323265e+01 4.42323265e+01 4.42327156e+01
 4.42328911e+01 4.42351456e+01 4.42351456e+01 4.42354546e+01
 4.42350807e+01 4.42350807e+01 4.42359962e+01 4.42345772e+01
 4.42345772e+01 4.42313423e+01 4.42321968e+01 4.42321968e+01
 4.42374077e+01 4.42320976e+01 4.42320976e+01 4.42352562e+01
 4.42455063e+01 4.42399330e+01 4.42399330e+01 4.42327309e+01
 4.42321815e+01 4.42321815e+01 4.42330208e+01 4.42334290e+01
 4.42321815e+01 4.42321815e+01 4.42323074e+01 4.42323074e+01
 4.42369690e+01 4.42369690e+01 4.42331085e+01 4.42447052e+01
 4.42357025e+01 4.42357025e+01 4.42404823e+01 4.42407913e+01
 4.42352791e+01 4.42352791e+01 4.42326508e+01 4.42326508e+01
 4.42333069e+01 4.42351112e+01 4.42351112e+01 4.42312202e+01
 4.42327843e+01 4.42336159e+01 4.42336159e+01 4.42327461e+01
 4.42337837e+01 4.42337837e+01 4.42327156e+01 4.42445793e+01
 4.42362137e+01 4.42357712e+01 4.42356529e+01 4.42322426e+01
 4.42322426e+01 4.42573318e+01 4.42573318e+01 4.42361336e+01
 4.42353249e+01 4.42353592e+01 4.42345886e+01 4.42345886e+01
 4.42329292e+01 4.42327995e+01 4.42327995e+01 4.42327461e+01
 4.42484894e+01 4.42484894e+01 4.42327156e+01 4.42324791e+01
 4.42327499e+01 7.93264389e+00 7.93521023e+00 4.42350044e+01
 4.42602844e+01 4.42602844e+01 4.42327728e+01 4.42784004e+01
 4.42784004e+01 2.26107523e-01 4.42357635e+01 4.42526855e+01
 4.42957382e+01 4.42957382e+01 4.42319298e+01 4.42319298e+01
 4.42393837e+01 4.42393837e+01 4.42360344e+01 4.42323952e+01
 4.42323952e+01 4.42354736e+01 4.42354736e+01 7.93369341e+00
 8.68737427e+02 7.93162394e+00 7.92961502e+00 4.42363625e+01
 4.42324944e+01 4.42360878e+01 4.42360878e+01 4.42393074e+01
 4.42319298e+01 4.42319298e+01 4.42329025e+01 4.42318726e+01
 4.42318726e+01 4.42605476e+01 4.42323265e+01 4.42323265e+01
 4.42312202e+01 4.42912407e+01 4.42424355e+01 4.42357979e+01
 4.42357979e+01 4.42364769e+01 4.42406731e+01 4.42341499e+01
 4.42341499e+01 4.42375488e+01 4.42328033e+01 4.42328033e+01
 4.42365074e+01 4.42342262e+01 4.42342262e+01 4.42328224e+01
 4.42322235e+01 4.42322235e+01 4.42358131e+01 4.42325134e+01
 4.42325401e+01 4.42328453e+01 4.42324448e+01 4.42754059e+01
 4.42318726e+01 4.42318726e+01 4.42352371e+01 4.42331047e+01
 4.42321472e+01 4.42321472e+01 4.42332535e+01 4.42327080e+01
 4.42504044e+01 4.42338104e+01 4.42332230e+01 7.93137026e+00
 4.42546616e+01 7.93065834e+00 4.42343750e+01 4.42343750e+01
 4.42333183e+01 4.43727760e+01 4.43727760e+01 4.42342873e+01
 4.42334938e+01 4.42388496e+01 4.42347450e+01 4.42347450e+01
 4.42422409e+01 4.42329941e+01 4.42328262e+01 4.42320671e+01
 4.42350578e+01 4.48231506e+01 4.48231506e+01 4.42312202e+01
 4.42330360e+01 1.60495338e+01 2.42980337e+00 5.86433945e+01
 5.86433945e+01 4.64330711e+01 7.94323826e+00 4.43066406e+01
 4.42356300e+01 4.42330589e+01 7.93054199e+00 4.42347527e+01
 4.42313385e+01 4.42886086e+01 4.42355347e+01 4.42336693e+01
 4.42336693e+01 4.42417526e+01 4.42340088e+01 4.42393036e+01
 4.42339592e+01 4.42358780e+01 4.42416191e+01 4.42416191e+01
 4.42358055e+01 4.42357635e+01 4.42344093e+01 4.42344093e+01
 1.19762821e+01 4.42379150e+01 4.42333755e+01 4.42333755e+01
 4.42331352e+01 4.42328224e+01 4.42328224e+01 4.42327003e+01
 4.42375107e+01 4.42375107e+01 4.42357216e+01 4.42395706e+01
 4.42395706e+01 4.42327499e+01 4.42884521e+01 4.42884521e+01
 4.42613335e+01 4.42370911e+01 4.42370911e+01 4.42326202e+01
 4.42326202e+01 4.42328339e+01 4.42477798e+01 4.42477798e+01
 4.42331543e+01 4.42669106e+01 4.42669106e+01 4.47758484e+01
 4.47758484e+01 4.42312202e+01 4.42400398e+01 4.42319794e+01
 4.42329712e+01 4.42359886e+01 4.42312202e+01 4.42392235e+01
 4.42392235e+01 4.42375031e+01 4.42949829e+01 4.42735710e+01
 4.42735710e+01 4.42314224e+01 4.42338905e+01 4.42313423e+01
 4.42380943e+01 4.42380943e+01 4.42356758e+01 4.42314224e+01
 4.42428322e+01 4.42382469e+01 4.42382469e+01 4.42355270e+01
 4.42313423e+01 4.42476540e+01 4.42312202e+01 4.42332649e+01
 4.42312737e+01 4.42394829e+01 4.42397308e+01 4.42327614e+01
 4.42327614e+01 4.42367706e+01 4.42337608e+01 4.42337608e+01
 4.42705116e+01 4.42456398e+01 4.42346344e+01 4.42346344e+01
 4.42619362e+01 4.42361488e+01 4.42361488e+01 4.42454605e+01
 4.42363625e+01 4.42334595e+01 4.42334595e+01 4.42406006e+01
 4.42464561e+01 4.42391930e+01 4.42391930e+01 4.42312202e+01
 4.42594032e+01 4.42638130e+01 4.42638130e+01 4.42388954e+01
 4.42324982e+01 4.42324982e+01 4.42353172e+01 4.42353172e+01
 4.42327461e+01 4.42466507e+01 4.42401161e+01 4.42401161e+01
 1.22310944e+01 4.42394066e+01 4.42396126e+01 4.42553940e+01
 4.42546883e+01 4.42546883e+01 4.42328148e+01 4.42478714e+01
 4.42347755e+01 4.42347755e+01 4.42312202e+01 4.42329445e+01
 4.42727509e+01 4.42756538e+01 4.42756538e+01 4.42312202e+01
 4.42372818e+01 4.43166275e+01 4.43166275e+01 4.42324905e+01
 4.42350616e+01 4.42355919e+01 4.42558899e+01 4.42325439e+01
 4.42331657e+01 4.42331657e+01 4.42312202e+01 4.42354774e+01
 4.42798843e+01 4.42798843e+01 7.93123627e+00 4.42324753e+01
 4.42324753e+01 4.42417908e+01 4.42336769e+01 4.42324905e+01
 4.42313423e+01 4.42331314e+01 4.42448196e+01 4.42511711e+01
 4.42324448e+01 4.42324181e+01 4.42417030e+01 4.42396927e+01
 4.42396927e+01 4.42324677e+01 4.42606087e+01 4.42339516e+01
 4.42339516e+01 4.42312202e+01 4.42338295e+01 4.42338295e+01
 4.42371445e+01 4.42371597e+01 4.42371597e+01 4.42352982e+01
 4.42312202e+01 4.42393112e+01 4.42393112e+01 4.42355690e+01
 4.42355690e+01 4.42327461e+01 4.42312202e+01 4.42378654e+01
 4.42378654e+01 4.43106003e+01 4.42334061e+01 4.42334061e+01
 7.93367290e+00 4.42441139e+01 4.42312202e+01 4.42327805e+01
 4.42387314e+01 4.42325554e+01 4.42360077e+01 4.42333527e+01
 4.42333527e+01 4.42358665e+01 4.42327309e+01 4.42327309e+01
 4.42363930e+01 4.42331581e+01 4.42331581e+01 4.42369728e+01
 4.42332535e+01 4.42332535e+01 4.42353096e+01 4.42353745e+01
 4.42324905e+01 4.42385750e+01 4.42385750e+01 4.42312202e+01
 4.42569389e+01 4.42329674e+01 4.42329674e+01 4.42403107e+01
 4.42324867e+01 4.42324867e+01 4.42504578e+01 4.42324829e+01
 4.42403145e+01 4.42403145e+01 4.42312202e+01 4.42327385e+01
 4.42355080e+01 4.42317581e+01 4.42325439e+01 4.42337952e+01
 4.42599831e+01 4.45313835e+01 4.45313835e+01 4.42358704e+01
 4.42329788e+01 4.42329788e+01 4.42329063e+01 4.42352600e+01
 4.42343178e+01 4.42343178e+01 4.42397652e+01 4.42414322e+01
 4.42324600e+01 4.42324600e+01 4.42325363e+01 4.42369843e+01
 4.42337646e+01 4.42337646e+01 4.42312202e+01 4.42433167e+01
 4.42433167e+01 4.42312202e+01 4.42326698e+01 4.42326698e+01
 4.42472725e+01 4.42409935e+01 4.42409935e+01 4.42353172e+01
 7.93062162e+00 4.42361870e+01 4.42341499e+01 4.42341499e+01
 4.42396011e+01 4.42336693e+01 4.42324677e+01 4.42324677e+01
 4.42325363e+01 4.42324982e+01 7.93062162e+00 7.92952013e+00
 7.92985821e+00 7.93067122e+00 4.42357178e+01 4.42332382e+01
 4.42332382e+01 4.42462234e+01 4.42363205e+01 4.42943344e+01
 4.42943344e+01 4.42325249e+01 4.42355080e+01 4.42347069e+01
 4.42347069e+01 7.93100691e+00 4.42312202e+01 4.42487869e+01
 4.44577560e+01 4.44577560e+01 8.69852543e+00 4.42354965e+01
 4.42327843e+01 4.42451859e+01 4.42336807e+01 4.42336807e+01
 4.42588882e+01 4.42588882e+01 4.42360191e+01 4.42360191e+01
 4.42313423e+01 4.42350311e+01 4.42465553e+01 4.42439003e+01
 4.42439003e+01 4.43250618e+01 4.42330894e+01 4.42314034e+01
 4.42404213e+01 4.42428207e+01 4.42428207e+01 4.42350845e+01
 4.42374382e+01 4.42325935e+01 4.42325935e+01 4.42390251e+01
 4.42339401e+01 4.42339401e+01 4.42325363e+01 4.42492142e+01
 4.42492142e+01 4.42327042e+01 4.42327499e+01 4.42327499e+01
 4.42335701e+01 4.42335701e+01 4.42330818e+01 4.42347260e+01
 4.42347260e+01 4.42392654e+01 4.42392654e+01 4.42419319e+01
 4.42419319e+01 7.93090582e+00 4.42324867e+01 4.43443298e+01
 4.42362442e+01 4.42325058e+01 7.93065882e+00 4.42358894e+01
 4.42354088e+01 4.42353897e+01 4.42358246e+01 1.36309233e+01
 4.42351723e+01 4.42313423e+01 4.42351036e+01 4.42326126e+01
 4.42324600e+01 4.42313461e+01 4.42312202e+01 4.42358093e+01
 4.42350883e+01 4.42313461e+01 4.42352486e+01 5.35231445e+02
 4.42444763e+01 4.42327194e+01 5.59356737e+00 5.52421713e+00
 4.42315063e+01 4.42449532e+01 4.42449532e+01 4.42321968e+01
 7.93070126e+00 4.42312355e+01 7.93319559e+00 5.86314926e+01
 2.42977715e+00 4.64321022e+01 7.93120289e+00 4.42424622e+01
 4.42312508e+01 4.42327080e+01 4.42369537e+01 4.42803764e+01
 4.42371597e+01 4.42341499e+01 4.42346497e+01 4.42334518e+01
 4.42326622e+01 4.45059280e+01 4.42462196e+01 4.42418442e+01
 4.42334938e+01 4.43891106e+01 4.43891106e+01 4.42315102e+01
 4.42413940e+01 4.46915359e+01 4.42352257e+01 7.97715855e+00
 1.16491957e+01 4.42330894e+01 4.42410698e+01 4.42597618e+01
 4.42313805e+01 4.42340469e+01 8.10215569e+00 1.37309675e+01
 7.93128586e+00 4.42863655e+01 4.42863655e+01 4.45752068e+01
 4.42312927e+01 4.42312355e+01 4.42312355e+01 4.42312393e+01
 4.44200249e+01 4.42445755e+01 4.42497292e+01 4.42325630e+01
 4.42335968e+01 4.42364922e+01 4.42541351e+01 4.42312775e+01
 4.42589417e+01 4.42589417e+01 4.42343750e+01 4.42327194e+01
 1.38495522e+01 4.42312393e+01 4.42433434e+01 4.42341843e+01
 4.42347908e+01 4.42493858e+01 4.42584953e+01 4.42338371e+01
 4.43814163e+01 4.43814163e+01 4.42339630e+01 4.42791023e+01
 5.35231262e+02 4.42381325e+01 4.42886086e+01 4.42886086e+01
 4.43126450e+01 4.42356148e+01 4.42356148e+01 4.42383881e+01
 4.42324448e+01 4.42641220e+01 4.43679581e+01 4.42501259e+01
 4.42652702e+01 4.42385445e+01 4.42604828e+01 4.42604828e+01
 4.42388840e+01 4.42483940e+01 4.42327156e+01 4.42355728e+01
 4.42417831e+01 4.42417831e+01 4.42334480e+01 4.42509995e+01
 4.42346878e+01 4.42333298e+01 4.42333298e+01 4.42329330e+01
 4.42532272e+01 4.42532272e+01 4.42386093e+01 4.42354355e+01
 4.42354355e+01 4.42372551e+01 4.42893448e+01 4.42893448e+01
 4.42678604e+01 4.42333603e+01 4.42333145e+01 4.42357788e+01
 4.42551346e+01 4.42551346e+01 4.42351761e+01 4.42401161e+01
 4.42401161e+01 4.42456589e+01 4.42332993e+01 4.42332993e+01
 4.42357903e+01 4.42544136e+01 4.42544136e+01 4.42349052e+01
 4.42401733e+01 4.42401733e+01 4.42351036e+01 4.42463379e+01
 4.42450447e+01 4.42450447e+01 4.42395363e+01 4.42324409e+01
 4.42657013e+01 4.42943382e+01 4.42943382e+01 4.42323036e+01
 4.42338295e+01 4.42355881e+01 4.42363167e+01 4.42332840e+01
 4.42332840e+01 4.42352066e+01 4.42356644e+01 4.42399025e+01
 4.42353630e+01 4.42325935e+01 4.42325935e+01 4.42326202e+01
 4.42375221e+01 4.42345390e+01 4.42368698e+01 4.42339935e+01
 4.42332344e+01 4.42332344e+01 4.42346878e+01 4.42348671e+01
 4.42348671e+01 4.42323380e+01 4.42339249e+01 4.42339249e+01
 4.43768806e+01 4.42491684e+01 4.42339325e+01 4.42349701e+01
 4.42472496e+01 4.42416649e+01 4.42323647e+01 4.42342300e+01
 4.42342300e+01 4.42489967e+01 4.42324677e+01 4.42971001e+01
 4.42971001e+01 4.42342339e+01 4.42338600e+01 4.42338600e+01
 4.43658676e+01 4.42323532e+01 4.42347641e+01 4.42347641e+01
 4.42330818e+01 4.42335167e+01 4.42330132e+01 4.42326508e+01
 4.42326508e+01 4.42326546e+01 4.42424507e+01 4.42424507e+01
 4.42321587e+01 4.74244690e+01 4.42332382e+01 4.42388687e+01
 4.42327995e+01 4.42417984e+01 4.42323685e+01 4.42343750e+01
 4.42343750e+01 4.42324905e+01 4.44981499e+01 4.44981499e+01
 4.42323189e+01 4.42341537e+01 4.42341537e+01 4.42325897e+01
 4.42362938e+01 4.42362938e+01 4.42623787e+01 4.42328720e+01
 4.44874916e+01 4.42323837e+01 4.42407150e+01 4.42407150e+01
 4.42524185e+01 4.42323952e+01 4.42354240e+01 4.42354240e+01
 4.42325706e+01 4.42331047e+01 4.42331047e+01 4.42332115e+01
 4.42332115e+01 4.42359581e+01 4.42359581e+01 4.42372589e+01
 4.42372589e+01 4.42353020e+01 4.42353020e+01 4.42364731e+01
 4.42936783e+01 4.42936783e+01 4.42378120e+01 4.42378120e+01
 4.42991486e+01 4.42666321e+01 4.42666321e+01 4.42534294e+01
 4.42405167e+01 4.42405167e+01 4.42962608e+01 4.42962608e+01
 4.42716026e+01 4.42716026e+01 4.42843666e+01 4.42843666e+01
 4.43253212e+01 4.43253212e+01 4.42392426e+01 4.42392426e+01
 4.42868729e+01 4.42868729e+01 4.43937302e+01 4.43937302e+01
 4.42344322e+01 4.42344322e+01 4.42363358e+01 4.42363358e+01
 4.42382698e+01 4.42382698e+01 1.33315039e+01 2.43767142e+00
 5.86327209e+01 2.43688536e+00 4.64317551e+01 4.42333145e+01
 7.93114185e+00 5.86323624e+01 5.35231262e+02 5.35231201e+02
 1.33311481e+01 1.33311491e+01 5.35231506e+02]
2025-06-02 15:25:48,583 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152548_update_17.json
2025-06-02 15:25:48,584 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:25:48,597 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152548_update_17.pth
2025-06-02 15:25:48,597 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869605.dot): 0.1822
2025-06-02 15:25:48,598 - WARNING - Detected 7 anomalous nodes (reconstruction-based):
2025-06-02 15:25:48,598 - WARNING -   Node ID: 192.168.27.10, Recon Error: 21.1219, MLP Score: 0.2212
2025-06-02 15:25:48,598 - WARNING -   Node ID: ff02::2, Recon Error: 27.4418, MLP Score: 0.4056
2025-06-02 15:25:48,598 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 28.4121, MLP Score: 0.4069
2025-06-02 15:25:48,598 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 23.6375, MLP Score: 0.3229
2025-06-02 15:25:48,599 - WARNING -   Node ID: ff02::fb, Recon Error: 21.7697, MLP Score: 0.3801
2025-06-02 15:25:48,599 - WARNING - Detected 8 anomalous edges (reconstruction-based):
2025-06-02 15:25:48,599 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2312, MLP Score: 0.0000
2025-06-02 15:25:48,599 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9363, MLP Score: 0.0000
2025-06-02 15:25:48,599 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7374, MLP Score: 0.0000
2025-06-02 15:25:48,600 - WARNING -   Source: 192.168.27.12, Target: 224.0.0.251, Recon Error: 535.2314, MLP Score: 0.0000
2025-06-02 15:25:48,600 - WARNING -   Source: 192.168.27.10, Target: 224.0.0.251, Recon Error: 535.2313, MLP Score: 0.0000
2025-06-02 15:25:48,600 - INFO - 
--- Processing file: nw_graph_encoded_1748869635.dot (Timestamp: 2025-06-02 15:07:15) ---
2025-06-02 15:25:48,600 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869635.dot
2025-06-02 15:25:48,600 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869635.dot'.
2025-06-02 15:25:48,601 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869635.dot
2025-06-02 15:25:48,620 - INFO - Parsed 511 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869635.dot'.
2025-06-02 15:25:48,676 - INFO - Parsed 1044 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869635.dot'.
2025-06-02 15:25:48,677 - INFO - Processing node updates/additions.
2025-06-02 15:25:48,697 - INFO - Processing edge updates/additions.
2025-06-02 15:25:48,778 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:25:48,782 - INFO - Finished updating NetworkX graph.
2025-06-02 15:25:48,784 - DEBUG - Updated graph - Nodes: 511, Edges: 1044
2025-06-02 15:25:48,785 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:25:48,789 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:25:48,893 - DEBUG - Initial node features tensor shape: torch.Size([511, 30])
2025-06-02 15:25:48,898 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:25:48,902 - DEBUG - Node features tensor shape after scaling: torch.Size([511, 30])
2025-06-02 15:25:48,906 - DEBUG - Edge index tensor shape: torch.Size([2, 1044])
2025-06-02 15:25:48,913 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:25:48,962 - DEBUG - Initial edge attributes tensor shape: torch.Size([1044, 10])
2025-06-02 15:25:48,969 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:25:48,974 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1044, 10])
2025-06-02 15:25:48,975 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:25:48,976 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:25:48,978 - INFO - Updated main graph to 511 nodes and 1044 edges.
2025-06-02 15:25:48,979 - INFO - Performing online update...
2025-06-02 15:25:48,979 - INFO - Starting online update for 25 steps.
2025-06-02 15:25:48,981 - DEBUG - Updated RunningStats: new_mean=0.939023237065151, new_var=9600000000159.58, new_n=990
2025-06-02 15:25:48,981 - DEBUG - Updated RunningStats: new_mean=0.9331223368345892, new_var=9900000000019.148, new_n=1020
2025-06-02 15:25:48,982 - DEBUG - Updated RunningStats: new_mean=39.91711702253569, new_var=3200000201650.9946, new_n=330
2025-06-02 15:25:48,982 - DEBUG - Updated RunningStats: new_mean=40.43603532013441, new_var=3300000293202.361, new_n=340
2025-06-02 15:25:48,983 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:25:48,983 - DEBUG - Online update step: 1/25
2025-06-02 15:25:48,983 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,983 - DEBUG - Online update step: 2/25
2025-06-02 15:25:48,984 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,984 - DEBUG - Online update step: 3/25
2025-06-02 15:25:48,984 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,984 - DEBUG - Online update step: 4/25
2025-06-02 15:25:48,984 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,985 - DEBUG - Online update step: 5/25
2025-06-02 15:25:48,985 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,985 - DEBUG - Online update step: 6/25
2025-06-02 15:25:48,985 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,985 - DEBUG - Online update step: 7/25
2025-06-02 15:25:48,985 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,986 - DEBUG - Online update step: 8/25
2025-06-02 15:25:48,986 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,986 - DEBUG - Online update step: 9/25
2025-06-02 15:25:48,986 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,986 - DEBUG - Online update step: 10/25
2025-06-02 15:25:48,986 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,987 - DEBUG - Online update step: 11/25
2025-06-02 15:25:48,987 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,987 - DEBUG - Online update step: 12/25
2025-06-02 15:25:48,987 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,987 - DEBUG - Online update step: 13/25
2025-06-02 15:25:48,987 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,988 - DEBUG - Online update step: 14/25
2025-06-02 15:25:48,988 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,988 - DEBUG - Online update step: 15/25
2025-06-02 15:25:48,988 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,988 - DEBUG - Online update step: 16/25
2025-06-02 15:25:48,988 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,988 - DEBUG - Online update step: 17/25
2025-06-02 15:25:48,989 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,989 - DEBUG - Online update step: 18/25
2025-06-02 15:25:48,989 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,989 - DEBUG - Online update step: 19/25
2025-06-02 15:25:48,989 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,989 - DEBUG - Online update step: 20/25
2025-06-02 15:25:48,990 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,990 - DEBUG - Online update step: 21/25
2025-06-02 15:25:48,990 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,990 - DEBUG - Online update step: 22/25
2025-06-02 15:25:48,990 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,990 - DEBUG - Online update step: 23/25
2025-06-02 15:25:48,991 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,991 - DEBUG - Online update step: 24/25
2025-06-02 15:25:48,991 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,991 - DEBUG - Online update step: 25/25
2025-06-02 15:25:48,991 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:48,991 - WARNING - No successful steps during online update.
2025-06-02 15:25:48,993 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -2.4261773e-08  4.2924675e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.3593224e-08
  4.2924675e-08  1.3064032e-08  6.5320158e-09  1.8662902e-09
  2.4637964e+00  2.9491193e+00  1.2915851e-01  4.3170257e+00
 -1.3064032e-08  3.3874755e+00  5.5890412e+00  7.6066537e+00
  1.2915851e-01  8.0000000e+00  2.9860644e-08 -1.4930322e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.7994354e-09 -4.3857820e-08], current edge mean: [-4.5674056e-09  4.7269156e+02  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -2.2837028e-09 -4.5674056e-10 -7.3078490e-09
 -1.8269622e-09  1.3702217e-09]
2025-06-02 15:25:48,993 - DEBUG - Node drift difference: 0.0883, Edge drift difference: 0.0063
2025-06-02 15:25:48,995 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -2.4261773e-08  4.2924675e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.3593224e-08
  4.2924675e-08  1.3064032e-08  6.5320158e-09  1.8662902e-09
  2.4637964e+00  2.9491193e+00  1.2915851e-01  4.3170257e+00
 -1.3064032e-08  3.3874755e+00  5.5890412e+00  7.6066537e+00
  1.2915851e-01  8.0000000e+00  2.9860644e-08 -1.4930322e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.7994354e-09 -4.3857820e-08], edge=[-4.5674056e-09  4.7269156e+02  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -2.2837028e-09 -4.5674056e-10 -7.3078490e-09
 -1.8269622e-09  1.3702217e-09]
2025-06-02 15:25:48,996 - DEBUG - Updated reference std: node=[0.         0.         1.0009799  1.0009799  0.         0.
 0.         1.0009799  1.0009799  1.0009799  1.0009799  1.0009799
 0.99121654 0.31522512 0.3527915  0.5612344  1.0009799  3.1126812
 2.953794   1.5002859  0.3527915  0.         1.0009799  1.0009799
 0.         0.         0.         0.         1.0009799  1.0009799 ], edge=[  1.0004792 568.60004     0.          0.          1.0004793   1.0004792
   1.0004793   1.0004792   1.0004792   1.0004792]
2025-06-02 15:25:48,996 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:25:48,996 - INFO - Running anomaly detection...
2025-06-02 15:25:48,997 - INFO - Starting anomaly detection.
2025-06-02 15:25:49,057 - DEBUG - Node reconstruction errors: [16.389753  16.427319  19.719128  17.807001  12.876247  15.207278
 18.110329  17.051632  17.05163   17.869373  17.05163   13.065688
 22.28607   13.279444  16.483986  16.669798  13.184463  16.669798
 18.249916  16.147606  15.471814  16.483986  15.374569  11.077025
 16.204866  17.594307  16.204863  13.429234  16.527128  16.204866
 12.405294  17.337458  13.284048  17.623213  17.948336  16.750076
 14.851637  16.147604  11.944148  11.734346  17.432436  16.039295
 16.147604  16.854906  17.143698  15.193453  17.865335  12.457697
 16.069014  28.237616  29.35834   17.150629  17.131319  16.393127
 15.0557575 11.904257  18.0295    15.324155  16.896046  17.20126
 11.798422  16.528889  15.670928  10.8001375 15.659153  15.055754
 15.272369  15.055782  15.670928  15.670928  14.953275  14.167672
 15.322876  14.604354  15.510519  14.257324  16.615124  14.64911
 14.449271  14.503094  16.542576  14.087339   9.712442  16.198832
 16.468184  10.931353  14.100587  14.40851   15.282739  13.907211
 15.521093  13.092912  11.2795105 14.525865  14.893788  24.537733
 15.980961  13.813439  15.003118  15.277294  13.81344   15.980964
 16.664288  14.958064  10.576189  14.868096  15.238721  11.784789
 11.614792  21.786316  15.419163  16.272627  11.998559  11.9750805
 14.114218  14.008173  14.066767  12.812586  14.721064  15.128949
 15.2342615 11.279513  11.367418  11.279511  15.247436  15.992094
 10.613109  10.771455  13.813442  15.734938  16.042322  15.512392
 15.08018   13.222432  14.008178  15.202804  16.345446  15.129958
 10.994816  12.267975  15.459232  14.889943  15.1769905 15.438471
 15.512392  14.15968   14.066766  15.72012   15.161678  14.659672
 18.57256   10.528764  14.681981  15.512392  15.376574  12.298861
 15.128953  13.975504  13.813441  16.85455   15.72012   11.652143
 15.128949  16.042322  13.726183  12.637841  14.046174  14.2774515
 11.061316  14.659673  14.430753  15.128951  15.444815  23.132015
 14.366501  14.135757  14.659674  13.98749   13.69841   13.69841
 14.800447  11.327253  14.5923195 11.393996  11.335752  14.047195
 15.1250925 13.925132  15.105012  15.063287  14.539862  14.463054
 16.053335  15.256138  10.818851  15.934906  12.084442  15.15652
 12.085752  15.73494   14.821718  15.128949  11.838183  14.3357525
 14.708349  11.279511  15.77438   12.299916  14.911823  14.582688
 13.644305  14.047199  16.053333  14.589576  14.047195  14.849725
 14.047194  14.066768  13.608699  15.256138  11.749852  15.1250925
 15.274373  16.053333  15.128949  15.021011  11.853625  15.375928
 14.293593  15.956669  11.372798  13.743461  14.659674  14.066767
 14.066766  15.934907  15.278665  15.274373  15.128949  15.865714
 12.3321085 15.423554  15.552069  14.659673  15.205621  14.008174
 13.768261  14.809489  15.55207   15.090548  15.444815  15.126447
 13.608701  14.277452  14.008177  14.885228  15.205619  14.955923
 14.953694  13.698409  14.540643  10.951032  15.446504  15.205621
 14.2935915 14.906164  15.322372  15.446504  15.322374  13.698409
 12.261845  12.000184  14.550237  16.304577  13.92931   13.698409
 14.743817  14.972746  14.944925  13.698408  15.870067  14.796786
 15.455808  16.385773  15.205619  15.843235  12.76402   11.489091
 11.327255  11.824664  14.852174  15.814332  15.449206  15.205621
 10.494983  14.955922  13.698412  13.698303  16.053333  14.583058
 15.01011   14.843979  13.871774  13.871771  14.843979  14.843979
 14.843979  13.934848  14.786776  14.843979  14.843979  13.943502
 14.843979  15.916541  10.608903  14.309684  15.240586  11.223948
 15.955481  15.939139  15.25911   14.919405  15.115289  13.871774
 15.151239  11.335772  14.864029  13.934848  14.540644  14.540645
 15.953838  15.955481  14.843979  13.929312  14.843979  13.934848
 15.049725  14.953694  14.864029  14.864029  14.843978  14.729241
 14.864029  15.25911   13.871771  15.322373  13.871772  15.756809
 15.419394  14.238771  14.843979  13.644305  15.446504  13.621151
 14.644833  16.053335  14.843979  14.843978  14.955922  14.955923
 13.644304  14.843979  14.864029  13.871697  13.871764  17.901007
 15.100842  12.029048  13.994147  14.81851   14.6290045 13.994146
 15.450082  11.85097   14.534519  14.657764  15.158859  15.10606
 15.175747  14.843979  13.87177   10.971949  15.382335  15.291068
 11.600483  13.641999  15.189811  10.541391  14.673161  14.843979
 15.026318  13.641998  13.646816  13.646818  14.653179  14.653179
 14.65318   15.9913435 14.790851  16.306665  15.053863  14.618186
 14.65318   14.79085   13.667164  13.646804  15.254853  15.0291
 13.646817  10.823583  14.653179  13.646818  14.790851  14.65318
 14.65318   14.889575  14.62303   14.65318   15.1588545 15.104996
 14.960433  15.053863  15.104996  15.393033  10.576147  15.783206
 15.053863  15.663621  11.374003  15.307919  15.276331  14.793267
 14.653179  14.81037   14.65318   14.65318   15.0538645 14.81037
 15.307919  15.117365  15.117365  15.97684   16.027895  16.027895
 16.027895  11.045314  16.300272  16.300272  16.300274  15.403353
 15.090211  15.117366  15.403357  14.800825  15.117365  16.04054
 15.364269  15.393032  16.00394   15.393033  15.393033  15.364267
 15.393033  14.137319  15.364267  15.364267  14.790043  16.282328
 11.624584  16.282328  14.790041  15.39303   15.364267  11.624586
 16.30027   15.39303   15.39303   15.393033  15.117366  15.403353
 16.00394   11.669416  15.104996  15.403353  11.619929  14.802003
 15.117365  11.624583  15.674235  16.282326  15.393032  15.117366
 15.403353  15.104996  15.403353  15.364269  15.403353  16.878782
 14.800824  15.403353  15.403353  15.084408  15.403353  14.707421
 14.802003  15.674235  14.800825  16.329214  16.855097  15.117366
 15.674232 ]
2025-06-02 15:25:49,058 - DEBUG - Edge reconstruction errors: [  5.2502756   5.2416773   7.942081  ...  13.342202   13.342204
 535.24255  ]
2025-06-02 15:25:49,061 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152549_update_18.json
2025-06-02 15:25:49,061 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:25:49,076 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152549_update_18.pth
2025-06-02 15:25:49,076 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869635.dot): 0.1768
2025-06-02 15:25:49,076 - WARNING - Detected 7 anomalous nodes (reconstruction-based):
2025-06-02 15:25:49,077 - WARNING -   Node ID: 192.168.27.13, Recon Error: 19.7191, MLP Score: 0.2430
2025-06-02 15:25:49,077 - WARNING -   Node ID: 192.168.27.10, Recon Error: 22.2861, MLP Score: 0.2218
2025-06-02 15:25:49,077 - WARNING -   Node ID: ff02::2, Recon Error: 28.2376, MLP Score: 0.4013
2025-06-02 15:25:49,077 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 29.3583, MLP Score: 0.4014
2025-06-02 15:25:49,077 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 24.5377, MLP Score: 0.3162
2025-06-02 15:25:49,078 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-02 15:25:49,078 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2423, MLP Score: 0.0000
2025-06-02 15:25:49,078 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9448, MLP Score: 0.0000
2025-06-02 15:25:49,078 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0429, MLP Score: 0.0000
2025-06-02 15:25:49,079 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7453, MLP Score: 0.0000
2025-06-02 15:25:49,079 - WARNING -   Source: 192.168.27.12, Target: 224.0.0.251, Recon Error: 535.2425, MLP Score: 0.0000
2025-06-02 15:25:49,079 - INFO - 
--- Processing file: nw_graph_encoded_1748869665.dot (Timestamp: 2025-06-02 15:07:45) ---
2025-06-02 15:25:49,079 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869665.dot
2025-06-02 15:25:49,080 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869665.dot'.
2025-06-02 15:25:49,080 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869665.dot
2025-06-02 15:25:49,105 - INFO - Parsed 547 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869665.dot'.
2025-06-02 15:25:49,167 - INFO - Parsed 1118 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869665.dot'.
2025-06-02 15:25:49,167 - INFO - Processing node updates/additions.
2025-06-02 15:25:49,190 - INFO - Processing edge updates/additions.
2025-06-02 15:25:49,282 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:25:49,286 - INFO - Finished updating NetworkX graph.
2025-06-02 15:25:49,288 - DEBUG - Updated graph - Nodes: 547, Edges: 1118
2025-06-02 15:25:49,289 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:25:49,293 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:25:49,407 - DEBUG - Initial node features tensor shape: torch.Size([547, 30])
2025-06-02 15:25:49,414 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:25:49,415 - DEBUG - Node features tensor shape after scaling: torch.Size([547, 30])
2025-06-02 15:25:49,421 - DEBUG - Edge index tensor shape: torch.Size([2, 1118])
2025-06-02 15:25:49,440 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:25:49,496 - DEBUG - Initial edge attributes tensor shape: torch.Size([1118, 10])
2025-06-02 15:25:49,504 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:25:49,508 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1118, 10])
2025-06-02 15:25:49,509 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:25:49,510 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:25:49,512 - INFO - Updated main graph to 547 nodes and 1118 edges.
2025-06-02 15:25:49,513 - INFO - Performing online update...
2025-06-02 15:25:49,513 - INFO - Starting online update for 25 steps.
2025-06-02 15:25:49,515 - DEBUG - Updated RunningStats: new_mean=0.9394032845836933, new_var=10200000000160.22, new_n=1050
2025-06-02 15:25:49,515 - DEBUG - Updated RunningStats: new_mean=0.9337921956015183, new_var=10500000000018.914, new_n=1080
2025-06-02 15:25:49,516 - DEBUG - Updated RunningStats: new_mean=40.6256522762116, new_var=3400000199852.774, new_n=350
2025-06-02 15:25:49,516 - DEBUG - Updated RunningStats: new_mean=41.04298277805461, new_var=3500000273174.6226, new_n=360
2025-06-02 15:25:49,517 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:25:49,517 - DEBUG - Online update step: 1/25
2025-06-02 15:25:49,517 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:49,517 - DEBUG - Online update step: 2/25
2025-06-02 15:25:49,517 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:49,518 - DEBUG - Online update step: 3/25
2025-06-02 15:25:49,518 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:49,518 - DEBUG - Online update step: 4/25
2025-06-02 15:25:49,518 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:49,518 - DEBUG - Online update step: 5/25
2025-06-02 15:25:49,518 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:49,519 - DEBUG - Online update step: 6/25
2025-06-02 15:25:49,519 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:49,519 - DEBUG - Online update step: 7/25
2025-06-02 15:25:49,519 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:49,519 - DEBUG - Online update step: 8/25
2025-06-02 15:25:49,519 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:49,520 - DEBUG - Online update step: 9/25
2025-06-02 15:25:49,520 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:49,520 - DEBUG - Online update step: 10/25
2025-06-02 15:25:49,520 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:49,520 - DEBUG - Online update step: 11/25
2025-06-02 15:25:49,521 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:49,522 - DEBUG - Online update step: 12/25
2025-06-02 15:25:49,522 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:49,522 - DEBUG - Online update step: 13/25
2025-06-02 15:25:49,523 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:49,523 - DEBUG - Online update step: 14/25
2025-06-02 15:25:49,523 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:49,523 - DEBUG - Online update step: 15/25
2025-06-02 15:25:49,524 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:49,524 - DEBUG - Online update step: 16/25
2025-06-02 15:25:49,524 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:49,524 - DEBUG - Online update step: 17/25
2025-06-02 15:25:49,525 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:49,525 - DEBUG - Online update step: 18/25
2025-06-02 15:25:49,525 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:49,525 - DEBUG - Online update step: 19/25
2025-06-02 15:25:49,526 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:49,526 - DEBUG - Online update step: 20/25
2025-06-02 15:25:49,526 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:49,526 - DEBUG - Online update step: 21/25
2025-06-02 15:25:49,527 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:49,527 - DEBUG - Online update step: 22/25
2025-06-02 15:25:49,527 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:49,527 - DEBUG - Online update step: 23/25
2025-06-02 15:25:49,527 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:49,528 - DEBUG - Online update step: 24/25
2025-06-02 15:25:49,528 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:49,528 - DEBUG - Online update step: 25/25
2025-06-02 15:25:49,528 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:49,529 - WARNING - No successful steps during online update.
2025-06-02 15:25:49,531 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -4.7073502e-08 -9.5890469e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.3947705e-08
  2.2665020e-08  4.3586578e-08 -1.7761531e-08  2.0485691e-08
  2.4442413e+00  2.9524679e+00  1.2065814e-01  4.3254113e+00
 -4.3586578e-08  3.3436928e+00  5.6709323e+00  7.6106033e+00
  1.2065814e-01  8.0000000e+00 -1.7434632e-08  2.7895410e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.1793289e-08  6.7995060e-08], current edge mean: [ 1.2795273e-09  4.7072629e+02  0.0000000e+00  0.0000000e+00
 -2.7723090e-09 -1.2795273e-09 -4.2650909e-09 -8.5301816e-10
 -4.2650908e-10 -5.1181090e-09]
2025-06-02 15:25:49,531 - DEBUG - Node drift difference: 0.0277, Edge drift difference: 0.0035
2025-06-02 15:25:49,533 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -4.7073502e-08 -9.5890469e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.3947705e-08
  2.2665020e-08  4.3586578e-08 -1.7761531e-08  2.0485691e-08
  2.4442413e+00  2.9524679e+00  1.2065814e-01  4.3254113e+00
 -4.3586578e-08  3.3436928e+00  5.6709323e+00  7.6106033e+00
  1.2065814e-01  8.0000000e+00 -1.7434632e-08  2.7895410e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.1793289e-08  6.7995060e-08], edge=[ 1.2795273e-09  4.7072629e+02  0.0000000e+00  0.0000000e+00
 -2.7723090e-09 -1.2795273e-09 -4.2650909e-09 -8.5301816e-10
 -4.2650908e-10 -5.1181090e-09]
2025-06-02 15:25:49,535 - DEBUG - Updated reference std: node=[0.         0.         1.0009154  1.0009153  0.         0.
 0.         1.0009153  1.0009153  1.0009153  1.0009153  1.0009153
 1.0682304  0.30491748 0.34246618 0.56139016 1.0009153  3.063846
 2.9354372  1.4923851  0.34246618 0.         1.0009153  1.0009153
 0.         0.         0.         0.         1.0009153  1.0009153 ], edge=[  1.0004476 549.4924      0.          0.          1.0004475   1.0004475
   1.0004475   1.0004476   1.0004475   1.0004475]
2025-06-02 15:25:49,535 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:25:49,535 - INFO - Running anomaly detection...
2025-06-02 15:25:49,536 - INFO - Starting anomaly detection.
2025-06-02 15:25:49,590 - DEBUG - Node reconstruction errors: [16.428564  16.720713  20.297794  17.928997  12.967095  15.314794
 18.66752   16.827723  16.82772   17.651815  16.827723  12.9112835
 22.045153  12.881958  16.268522  16.44873   13.009853  16.448732
 18.189386  15.931103  15.238196  16.26852   15.031447  10.862213
 15.9883795 17.738468  15.9883795 13.083246  16.30841   15.9883795
 12.342071  17.12218   12.900747  17.763483  18.103548  16.504398
 14.91051   15.931103  11.509443  11.667443  17.21293   15.821843
 15.931103  16.528023  16.921791  15.098602  17.585766  11.050829
 15.852769  28.516972  29.84344   16.930536  17.277884  16.30984
 15.193149  12.695107  18.505123  15.102854  17.143776  17.45941
 11.938608  16.270197  15.449031  10.588715  15.79021   15.193147
 15.412831  15.193171  15.449033  15.449031  15.087713  14.335543
 15.426424  14.772589  15.214235  14.4298315 16.373798  14.798662
 14.599367  14.669847  16.683683  14.25005    9.86186   16.198833
 16.577293  11.039831  14.255918  14.657925  15.451858  14.46932
 15.655555  13.226113  11.368108  14.683507  14.818515  24.997398
 16.104427  13.80131   14.752163  15.398333  13.963131  16.104427
 16.781973  15.306035  10.685938  14.969006  15.340228  11.93404
 11.735111  21.884653  15.3668585 16.403627  12.143244  11.927614
 14.257171  14.138538  14.205851  12.169757  14.872742  15.229059
 15.352138  11.368107  11.48643   11.366337  15.399926  16.092693
 10.703071  10.864083  13.96313   15.809627  15.785181  15.639055
 15.210592  13.358817  14.138534  15.3225975 16.00517   14.887685
 11.0916815 12.422782  15.577781  15.027385  15.288865  15.547204
 15.639055  14.306437  14.205848  15.857744  14.908161  14.80086
 18.726625  10.611166  14.4903555 15.639055  15.53513   12.425573
 15.229059  14.081409  13.963131  16.989063  15.857745  11.755452
 15.22906   15.785181  13.868831  12.769573  13.879596  14.386317
 11.160633  14.800862  14.592773  15.20673   15.576419  23.575039
 14.5027685 14.29005   14.800861  14.112918  13.833985  13.833984
 14.888219  11.4336815 14.701064  11.514438  12.127801  14.180344
 15.198658  14.07335   15.234228  15.148467  14.611559  14.600261
 16.17058   15.375584  11.0915785 16.019217  12.252187  15.254098
 12.205274  15.833436  14.723024  15.229059  11.865076  14.489379
 14.862922  11.368109  15.516285  12.409228  14.64961   14.38008
 13.771701  14.180346  16.17058   14.625457  14.180341  14.935264
 14.180345  14.20585   13.750438  15.375584  11.746901  15.198658
 15.395349  16.17058   15.229059  15.161589  11.980027  15.503472
 14.439222  16.089306  11.484289  14.045317  14.762441  14.2058525
 14.205848  16.019217  15.432536  15.395349  15.229059  15.983491
 12.4587    14.653739  15.680915  14.80086   15.321313  14.138532
 14.045047  14.936464  15.680917  15.122897  15.576419  15.24741
 13.750439  14.420797  14.138532  15.027648  15.148467  14.494882
 15.062286  13.833985  14.217142  11.050755  15.555439  15.148467
 14.439221  14.741452  15.088816  15.555439  15.088817  13.833985
 11.634711  11.412057  14.510995  14.494882  13.74402   13.833987
 14.8452635 15.121838  14.888219  13.73885   15.22212   14.9064
 15.592604  16.120825  15.321311  15.581076  12.902866  11.458522
 11.4336815 11.8381605 16.067333  15.749743  15.183001  15.321311
 10.572368  14.696883  14.343754  13.833945  16.019217  14.689773
 15.141985  14.569111  13.665049  13.665054  14.569111  14.569111
 14.569111  13.73972   14.499337  14.569112  14.569111  14.585661
 14.569112  16.006495  10.3607235 14.357249  15.365057  11.289203
 16.056574  16.019217  15.008669  14.891241  15.252227  13.665051
 15.270216  11.448857  14.595469  13.739717  14.330184  14.330183
 15.73809   16.056574  14.569111  13.744017  14.569112  13.739717
 15.115113  15.062286  14.595469  14.595469  14.569112  14.836272
 14.595469  15.008667  15.009867  15.088816  13.665052  15.483653
 15.218247  14.372824  14.569111  13.866935  10.822674  13.728564
 14.742301  15.148465  14.465733  14.569112  14.696885  14.696885
 13.7717    14.569111  14.595469  13.664978  13.665043  18.269619
 15.201655  11.499681  14.112127  14.074756  14.640166  14.112131
 15.57916   11.9300165 14.424397  14.4276905 15.270141  14.836994
 15.131745  14.569112  13.6650505 11.065721  15.49363   15.41937
 11.691828  13.761252  15.305668  10.640119  14.489116  14.569112
 15.149324  13.761255  13.744043  13.744047  14.45159   14.45159
 14.451592  16.178791  14.500378  16.50584   15.139738  14.718785
 14.451591  14.500378  13.775874  13.744038  15.022943  15.144346
 13.744042  10.907428  14.45159   13.744043  14.500378  14.45159
 14.45159   14.979596  14.713403  14.451592  15.270141  15.197236
 15.049268  15.139738  15.197238  15.493287  11.411133  15.883221
 15.107317  14.368452  11.458533  15.379727  15.033498  14.8766985
 14.45159   14.926542  14.451592  14.45159   15.139738  14.90375
 12.018336  15.185962  15.185962  14.775318  16.096197  16.096197
 16.096197  11.103524  16.377577  16.377577  16.377577  15.484065
 15.168118  15.185962  15.484064  14.488654  15.185962  16.115152
 15.457012  15.493289  16.096235  15.493287  15.493289  15.457014
 15.493287  20.13819   15.457014  15.457014  14.868561  16.381254
 11.723003  16.381252  14.868561  15.493287  15.457014  11.723003
 16.377577  15.493287  15.493287  15.493287  15.185962  15.484064
 16.07026   11.738739  15.197237  15.484063  11.70156   14.857534
 15.185962  11.722999  15.734774  16.381252  15.493289  15.185962
 15.484065  15.197236  15.484066  15.457014  15.484063  16.738956
 14.488654  15.484065  15.484063  15.164492  15.484064  14.779365
 14.857535  15.734774  14.488656  16.41532   16.929785  15.185962
 15.7347765 14.488656  14.775318  15.185962  14.488654  15.185962
 14.488656  14.488656  15.185962  14.775318  14.488654  15.647576
 14.488654  16.377579  14.857535  15.185962  14.775318  10.904392
 14.488654  15.168118  15.185962  14.488654  14.488654  15.484067
 15.484065  14.567823  15.657129  15.484064  14.488654  14.567822
 14.488656  14.567823  15.185962  14.488656  14.775317  14.775318
 14.488653 ]
2025-06-02 15:25:49,591 - DEBUG - Edge reconstruction errors: [  5.2514577   5.244401    7.9447284 ...  13.344851   13.344852
 535.24524  ]
2025-06-02 15:25:49,600 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152549_update_19.json
2025-06-02 15:25:49,601 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:25:49,615 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152549_update_19.pth
2025-06-02 15:25:49,615 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869665.dot): 0.1712
2025-06-02 15:25:49,616 - WARNING - Detected 8 anomalous nodes (reconstruction-based):
2025-06-02 15:25:49,616 - WARNING -   Node ID: 192.168.27.13, Recon Error: 20.2978, MLP Score: 0.2452
2025-06-02 15:25:49,616 - WARNING -   Node ID: 192.168.27.10, Recon Error: 22.0452, MLP Score: 0.2253
2025-06-02 15:25:49,616 - WARNING -   Node ID: ff02::2, Recon Error: 28.5170, MLP Score: 0.3997
2025-06-02 15:25:49,616 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 29.8434, MLP Score: 0.3998
2025-06-02 15:25:49,617 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 24.9974, MLP Score: 0.3128
2025-06-02 15:25:49,617 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-02 15:25:49,617 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2449, MLP Score: 0.0000
2025-06-02 15:25:49,617 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9471, MLP Score: 0.0000
2025-06-02 15:25:49,618 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0455, MLP Score: 0.0000
2025-06-02 15:25:49,618 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7474, MLP Score: 0.0000
2025-06-02 15:25:49,618 - WARNING -   Source: 192.168.27.12, Target: 224.0.0.251, Recon Error: 535.2452, MLP Score: 0.0000
2025-06-02 15:25:49,618 - INFO - 
--- Processing file: nw_graph_encoded_1748869695.dot (Timestamp: 2025-06-02 15:08:15) ---
2025-06-02 15:25:49,619 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869695.dot
2025-06-02 15:25:49,619 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869695.dot'.
2025-06-02 15:25:49,619 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869695.dot
2025-06-02 15:25:49,645 - INFO - Parsed 640 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869695.dot'.
2025-06-02 15:25:49,715 - INFO - Parsed 1300 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869695.dot'.
2025-06-02 15:25:49,716 - INFO - Processing node updates/additions.
2025-06-02 15:25:49,740 - INFO - Processing edge updates/additions.
2025-06-02 15:25:49,836 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:25:49,840 - INFO - Finished updating NetworkX graph.
2025-06-02 15:25:49,843 - DEBUG - Updated graph - Nodes: 640, Edges: 1300
2025-06-02 15:25:49,843 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:25:49,848 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:25:49,977 - DEBUG - Initial node features tensor shape: torch.Size([640, 30])
2025-06-02 15:25:49,984 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:25:49,989 - DEBUG - Node features tensor shape after scaling: torch.Size([640, 30])
2025-06-02 15:25:49,993 - DEBUG - Edge index tensor shape: torch.Size([2, 1300])
2025-06-02 15:25:50,002 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:25:50,065 - DEBUG - Initial edge attributes tensor shape: torch.Size([1300, 10])
2025-06-02 15:25:50,072 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:25:50,077 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1300, 10])
2025-06-02 15:25:50,078 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:25:50,078 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:25:50,081 - INFO - Updated main graph to 640 nodes and 1300 edges.
2025-06-02 15:25:50,081 - INFO - Performing online update...
2025-06-02 15:25:50,082 - INFO - Starting online update for 25 steps.
2025-06-02 15:25:50,083 - DEBUG - Updated RunningStats: new_mean=0.9398242755673138, new_var=10800000000161.262, new_n=1110
2025-06-02 15:25:50,084 - DEBUG - Updated RunningStats: new_mean=0.9344638998201199, new_var=11100000000018.777, new_n=1140
2025-06-02 15:25:50,084 - DEBUG - Updated RunningStats: new_mean=41.19303106203751, new_var=3600000195696.4204, new_n=370
2025-06-02 15:25:50,085 - DEBUG - Updated RunningStats: new_mean=41.469599332045526, new_var=3700000234474.8716, new_n=380
2025-06-02 15:25:50,085 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:25:50,085 - DEBUG - Online update step: 1/25
2025-06-02 15:25:50,086 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,086 - DEBUG - Online update step: 2/25
2025-06-02 15:25:50,086 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,086 - DEBUG - Online update step: 3/25
2025-06-02 15:25:50,086 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,086 - DEBUG - Online update step: 4/25
2025-06-02 15:25:50,087 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,087 - DEBUG - Online update step: 5/25
2025-06-02 15:25:50,087 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,087 - DEBUG - Online update step: 6/25
2025-06-02 15:25:50,087 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,087 - DEBUG - Online update step: 7/25
2025-06-02 15:25:50,088 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,088 - DEBUG - Online update step: 8/25
2025-06-02 15:25:50,088 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,088 - DEBUG - Online update step: 9/25
2025-06-02 15:25:50,088 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,088 - DEBUG - Online update step: 10/25
2025-06-02 15:25:50,089 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,089 - DEBUG - Online update step: 11/25
2025-06-02 15:25:50,089 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,089 - DEBUG - Online update step: 12/25
2025-06-02 15:25:50,089 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,089 - DEBUG - Online update step: 13/25
2025-06-02 15:25:50,090 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,090 - DEBUG - Online update step: 14/25
2025-06-02 15:25:50,090 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,090 - DEBUG - Online update step: 15/25
2025-06-02 15:25:50,090 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,090 - DEBUG - Online update step: 16/25
2025-06-02 15:25:50,091 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,091 - DEBUG - Online update step: 17/25
2025-06-02 15:25:50,091 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,091 - DEBUG - Online update step: 18/25
2025-06-02 15:25:50,091 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,091 - DEBUG - Online update step: 19/25
2025-06-02 15:25:50,092 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,092 - DEBUG - Online update step: 20/25
2025-06-02 15:25:50,092 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,092 - DEBUG - Online update step: 21/25
2025-06-02 15:25:50,092 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,092 - DEBUG - Online update step: 22/25
2025-06-02 15:25:50,092 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,093 - DEBUG - Online update step: 23/25
2025-06-02 15:25:50,093 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,093 - DEBUG - Online update step: 24/25
2025-06-02 15:25:50,093 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,093 - DEBUG - Online update step: 25/25
2025-06-02 15:25:50,093 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,094 - WARNING - No successful steps during online update.
2025-06-02 15:25:50,095 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -8.9406971e-09 -2.9802323e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.7136335e-08
  4.4703484e-08  5.9604646e-09 -2.9802323e-09  2.9802323e-09
  2.3671875e+00  2.9562500e+00  1.2968750e-01  4.3890624e+00
 -5.9604646e-09  3.3890624e+00  5.7390623e+00  7.6093750e+00
  1.2968750e-01  8.0000000e+00  2.9057265e-08 -3.3527612e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -5.2154064e-08  2.9802322e-08], current edge mean: [-9.5367430e-09  4.6594769e+02  0.0000000e+00  0.0000000e+00
 -1.4671913e-09  2.9343825e-09  1.4671913e-09 -1.0270338e-08
  1.4671913e-09 -1.4671913e-09]
2025-06-02 15:25:50,096 - DEBUG - Node drift difference: 0.1134, Edge drift difference: 0.0087
2025-06-02 15:25:50,097 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -8.9406971e-09 -2.9802323e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.7136335e-08
  4.4703484e-08  5.9604646e-09 -2.9802323e-09  2.9802323e-09
  2.3671875e+00  2.9562500e+00  1.2968750e-01  4.3890624e+00
 -5.9604646e-09  3.3890624e+00  5.7390623e+00  7.6093750e+00
  1.2968750e-01  8.0000000e+00  2.9057265e-08 -3.3527612e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -5.2154064e-08  2.9802322e-08], edge=[-9.5367430e-09  4.6594769e+02  0.0000000e+00  0.0000000e+00
 -1.4671913e-09  2.9343825e-09  1.4671913e-09 -1.0270338e-08
  1.4671913e-09 -1.4671913e-09]
2025-06-02 15:25:50,098 - DEBUG - Updated reference std: node=[0.         0.         1.0007821  1.0007823  0.         0.
 0.         1.0007821  1.0007821  1.0007821  1.0007821  1.0007821
 1.0366606  0.29277956 0.3543513  0.5707029  1.0007821  3.053545
 2.915992   1.4961315  0.3543513  0.         1.0007821  1.0007821
 0.         0.         0.         0.         1.0007821  1.0007821 ], edge=[  1.0003848 510.02356     0.          0.          1.0003848   1.0003848
   1.0003848   1.0003848   1.0003848   1.0003848]
2025-06-02 15:25:50,099 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:25:50,099 - INFO - Running anomaly detection...
2025-06-02 15:25:50,099 - INFO - Starting anomaly detection.
2025-06-02 15:25:50,204 - DEBUG - Node reconstruction errors: [16.787718  15.33714   21.486628  18.157223  13.2537985 15.608127
 19.850788  17.08629   17.08629   17.917044  17.08629   13.193525
 23.536041  13.252455  16.508848  16.66336   13.287828  16.663359
 18.5734    16.172232  15.5512705 16.508848  15.291836  11.1114435
 16.242235  18.040394  16.242235  13.389661  16.59425   16.242235
 12.849448  17.41447   13.195113  18.024305  18.41482   15.124727
 15.923779  16.172232  11.910538  11.9243145 17.476704  16.081522
 16.172234  16.763153  17.167576  15.397944  17.831825  11.336055
 16.158539  29.279818  30.982016  17.238295  17.597939  16.749565
 15.53625   13.028299  19.619764  15.369772  17.590607  17.921278
 12.289768  14.975161  15.714673  10.842542  16.06302   15.536241
 15.752225  15.536292  15.714675  15.714676  15.423833  14.698572
 15.710753  15.129437  15.49685   14.797827  16.646904  15.1383
 14.934379  15.025976  16.971865  14.634878  10.228893  16.508472
 16.851465  11.304465  14.609861  15.003491  15.813113  14.8430805
 15.939333  13.498951  11.600809  15.051899  15.137791  26.086817
 16.374912  14.129179  15.016313  15.700635  14.310795  16.374912
 17.051266  15.658204  10.954716  15.247355  15.570075  12.27605
 12.010376  22.407804  15.655519  16.687107  12.480841  12.2719965
 14.588961  14.45311   14.53176   12.451236  15.208179  15.076761
 15.6186075 11.600811  11.799358  10.933994  15.717633  15.076721
 10.933522  11.126928  14.101914  16.037859  16.08806   15.947497
 15.487487  13.701437  14.453105  15.621111  16.237955  15.154909
 11.369627  12.806522  15.876369  14.568037  15.54241   15.829371
 15.947497  14.641073  14.531758  16.178085  15.209318  15.124812
 19.048176  10.836444  14.830434  15.947499  15.877254  12.735894
 15.507071  14.431355  14.310794  17.272657  16.178085  12.041289
 15.507071  16.08806   14.206455  13.075027  14.209108  14.702495
 11.447332  15.070532  14.944315  15.466792  15.855887  24.625652
 14.96162   14.692831  15.0218115 14.417445  14.16153   14.161528
 15.141569  11.689021  14.978095  11.830832  12.39961   14.496195
 15.43054   14.426961  15.51285   15.400112  14.982069  14.935213
 16.46911   15.675408  11.369494  16.274015  12.141119  15.494109
 12.499765  16.078638  14.985301  15.507071  12.18651   14.833016
 15.226581  11.60081   15.820124  12.712848  14.907871  14.711522
 14.087422  14.496194  16.46911   14.935962  14.496192  15.15765
 14.330595  14.531757  14.093052  15.675408  12.088582  15.430541
 15.661761  16.46911   15.5070715 15.484753  12.947723  15.807767
 14.773349  16.371641  11.756444  15.67218   15.045817  14.531758
 14.531759  16.274015  15.790713  15.661762  15.507071  16.249092
 12.766553  15.010716  15.988353  15.124811  15.61159   15.888537
 14.385967  15.194141  15.988354  15.42422   15.8558855 15.513445
 14.093052  14.753275  14.453103  15.36468   15.400114  14.718238
 15.313459  14.161528  14.480694  11.301135  15.81294   15.400114
 14.773349  15.038513  15.412263  15.041074  15.412262  14.1615305
 11.921067  11.699758  14.848454  14.698716  14.054133  14.16153
 15.110051  15.461374  15.141569  14.039977  14.080812  15.18373
 15.912098  16.380537  15.018673  15.840399  13.860439  11.718578
 11.689021  12.207515  15.017916  15.972431  15.470368  15.61159
 10.789311  14.95404   14.644266  14.161544  16.274017  14.938941
 14.598865  14.808889  13.952177  13.952176  14.808887  14.808887
 14.808887  14.03607   14.72784   14.808889  14.808889  14.890548
 14.808889  16.265306  10.560544  14.675585  15.680154  11.483605
 16.330112  16.274017  15.320448  15.219509  15.570845  13.952177
 15.49038   11.751775  14.8469095 14.036069  14.653651  14.653649
 16.084805  16.225039  14.808887  14.054134  14.808887  14.036067
 14.98559   15.313459  14.8469095 14.8469095 14.808889  15.086081
 14.84691   15.320446  15.331624  15.412262  13.952178  15.736346
 15.517156  14.694213  14.808887  14.35751   11.089899  14.037267
 14.981225  15.400116  14.659047  14.808887  14.954039  14.954039
 14.08742   14.970138  15.911938  15.557675  13.952174  19.225197
 15.439734  13.416925  14.404157  14.326822  14.936756  14.998184
 15.704856  12.18309   14.718485  14.717673  15.51917   15.119593
 15.472641  14.808888  13.952177  11.339869  15.703164  15.733078
 11.9559965 14.064814  15.595454  10.881158  14.752908  14.808887
 15.456809  14.064816  14.014977  14.014975  14.685088  14.685086
 14.685086  16.55389   14.714535  16.896002  15.38096   14.985628
 14.685086  14.714535  14.062049  14.014975  15.289124  15.44999
 14.014976  11.168237  14.685086  14.014975  14.714535  14.685088
 14.685088  15.199673  14.94078   14.685086  15.519171  15.349917
 15.311401  15.38096   14.3348675 15.758142  11.670541  16.166399
 15.336321  14.644025  11.708121  15.576379  15.283751  15.120488
 14.685086  15.188847  14.685086  14.685086  15.380962  15.764332
 12.248677  14.888455  15.354181  14.988949  16.279768  16.279766
 16.279768  11.318523  14.992802  16.60804   16.60804   15.713358
 15.406843  15.373324  15.713358  14.670711  15.373325  16.342724
 15.7055645 15.684218  16.31847   14.3348675 14.359103  15.705564
 15.758142  12.189121  15.684219  15.705564  15.074338  14.334867
 11.990701  16.64511   15.074338  14.359102  14.979616  12.182839
 15.82079   14.33508   14.359103  14.359103  15.354184  15.713357
 16.272907  12.165881  15.42101   15.713359  12.209874  15.0277
 15.373324  11.945463  15.911113  14.9646845 14.334867  15.354183
 15.003939  15.42101   14.364827  15.684218  14.364827  17.127337
 14.67071   15.713358  15.713358  15.349918  15.713358  15.002504
 15.0277    15.911113  14.647772  15.504208  17.154024  15.373325
 15.911111  14.966659  14.966659  15.373325  13.887442  15.373324
 14.647772  14.67071   15.373325  14.850601  14.67071   14.988953
 14.647772  16.60804   15.027701  15.373324  15.856995  11.06998
 14.67071   15.406843  15.373324  14.67071   14.67071   15.713358
 14.364831  14.7873745 15.871616  15.003934  14.67071   14.787378
 14.67071   14.787377  14.90123   14.67071   14.966658  14.966659
 14.966659  14.675905  14.790732  14.675905  14.675905  14.675905
 14.675905  14.675905  14.675905  14.675905  14.675905  15.003052
 15.936148  14.675905  14.675905  14.675905  14.675905  14.675905
 14.675905  14.675905  14.675905  14.675905  14.675905  14.675905
 14.675905  14.675905  14.675905  15.373324  12.913118  14.67071
 13.398103  15.1153345 17.599632  17.599632  15.78055   13.398103
 14.67071   14.647771  14.647772  14.67071   14.647772  14.67071
 14.67071   14.675905  14.988952  14.67071   14.966659  14.67071
 14.67071   14.647771  14.67071   14.647772  14.67071   14.67071
 14.647772  14.647772  14.67071   14.647772  14.67071   14.67071
 14.67071   15.244434  15.132053  15.132053  14.675905  14.735373
 12.723917  14.67071   14.647772  14.675905  14.675905  14.647772
 15.804667  14.67071   14.67071   14.67071   15.381481  15.261164
 15.132053  14.67071   14.675905  14.647772  14.647772  10.568329
 14.675905  14.647772  14.67071   14.675905  14.675905  14.675905
 14.67071   14.67071   15.604239  15.132054 ]
2025-06-02 15:25:50,205 - DEBUG - Edge reconstruction errors: [  5.2523084   5.249064   44.245308  ...  13.345232   13.345235
 535.24567  ]
2025-06-02 15:25:50,210 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152550_update_20.json
2025-06-02 15:25:50,210 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:25:50,224 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152550_update_20.pth
2025-06-02 15:25:50,225 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869695.dot): 0.1633
2025-06-02 15:25:50,225 - WARNING - Detected 9 anomalous nodes (reconstruction-based):
2025-06-02 15:25:50,225 - WARNING -   Node ID: 192.168.27.13, Recon Error: 21.4866, MLP Score: 0.2423
2025-06-02 15:25:50,225 - WARNING -   Node ID: 192.168.27.12, Recon Error: 19.8508, MLP Score: 0.2768
2025-06-02 15:25:50,225 - WARNING -   Node ID: 192.168.27.10, Recon Error: 23.5360, MLP Score: 0.2205
2025-06-02 15:25:50,226 - WARNING -   Node ID: ff02::2, Recon Error: 29.2798, MLP Score: 0.3927
2025-06-02 15:25:50,226 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 30.9820, MLP Score: 0.3920
2025-06-02 15:25:50,226 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-02 15:25:50,226 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2452, MLP Score: 0.0000
2025-06-02 15:25:50,227 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9476, MLP Score: 0.0000
2025-06-02 15:25:50,227 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0460, MLP Score: 0.0000
2025-06-02 15:25:50,227 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7479, MLP Score: 0.0000
2025-06-02 15:25:50,227 - WARNING -   Source: 192.168.27.12, Target: 224.0.0.251, Recon Error: 535.2457, MLP Score: 0.0000
2025-06-02 15:25:50,228 - INFO - 
--- Processing file: nw_graph_encoded_1748869725.dot (Timestamp: 2025-06-02 15:08:45) ---
2025-06-02 15:25:50,228 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869725.dot
2025-06-02 15:25:50,228 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869725.dot'.
2025-06-02 15:25:50,228 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869725.dot
2025-06-02 15:25:50,255 - INFO - Parsed 653 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869725.dot'.
2025-06-02 15:25:50,327 - INFO - Parsed 1355 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869725.dot'.
2025-06-02 15:25:50,328 - INFO - Processing node updates/additions.
2025-06-02 15:25:50,357 - INFO - Processing edge updates/additions.
2025-06-02 15:25:50,473 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:25:50,478 - INFO - Finished updating NetworkX graph.
2025-06-02 15:25:50,481 - DEBUG - Updated graph - Nodes: 653, Edges: 1355
2025-06-02 15:25:50,481 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:25:50,486 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:25:50,617 - DEBUG - Initial node features tensor shape: torch.Size([653, 30])
2025-06-02 15:25:50,622 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:25:50,623 - DEBUG - Node features tensor shape after scaling: torch.Size([653, 30])
2025-06-02 15:25:50,627 - DEBUG - Edge index tensor shape: torch.Size([2, 1355])
2025-06-02 15:25:50,636 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:25:50,697 - DEBUG - Initial edge attributes tensor shape: torch.Size([1355, 10])
2025-06-02 15:25:50,700 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:25:50,700 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1355, 10])
2025-06-02 15:25:50,701 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:25:50,701 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:25:50,704 - INFO - Updated main graph to 653 nodes and 1355 edges.
2025-06-02 15:25:50,704 - INFO - Performing online update...
2025-06-02 15:25:50,705 - INFO - Starting online update for 25 steps.
2025-06-02 15:25:50,706 - DEBUG - Updated RunningStats: new_mean=0.9401717470158093, new_var=11400000000160.668, new_n=1170
2025-06-02 15:25:50,706 - DEBUG - Updated RunningStats: new_mean=0.935138272560361, new_var=11700000000019.045, new_n=1200
2025-06-02 15:25:50,707 - DEBUG - Updated RunningStats: new_mean=41.59544081049852, new_var=3800000193812.523, new_n=390
2025-06-02 15:25:50,707 - DEBUG - Updated RunningStats: new_mean=41.82345538560301, new_var=3900000225254.5874, new_n=400
2025-06-02 15:25:50,708 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:25:50,708 - DEBUG - Online update step: 1/25
2025-06-02 15:25:50,708 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,708 - DEBUG - Online update step: 2/25
2025-06-02 15:25:50,708 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,709 - DEBUG - Online update step: 3/25
2025-06-02 15:25:50,709 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,709 - DEBUG - Online update step: 4/25
2025-06-02 15:25:50,709 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,709 - DEBUG - Online update step: 5/25
2025-06-02 15:25:50,709 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,710 - DEBUG - Online update step: 6/25
2025-06-02 15:25:50,710 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,710 - DEBUG - Online update step: 7/25
2025-06-02 15:25:50,710 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,710 - DEBUG - Online update step: 8/25
2025-06-02 15:25:50,710 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,711 - DEBUG - Online update step: 9/25
2025-06-02 15:25:50,711 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,711 - DEBUG - Online update step: 10/25
2025-06-02 15:25:50,711 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,711 - DEBUG - Online update step: 11/25
2025-06-02 15:25:50,711 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,712 - DEBUG - Online update step: 12/25
2025-06-02 15:25:50,712 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,712 - DEBUG - Online update step: 13/25
2025-06-02 15:25:50,712 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,712 - DEBUG - Online update step: 14/25
2025-06-02 15:25:50,712 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,713 - DEBUG - Online update step: 15/25
2025-06-02 15:25:50,713 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,713 - DEBUG - Online update step: 16/25
2025-06-02 15:25:50,713 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,713 - DEBUG - Online update step: 17/25
2025-06-02 15:25:50,713 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,713 - DEBUG - Online update step: 18/25
2025-06-02 15:25:50,714 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,714 - DEBUG - Online update step: 19/25
2025-06-02 15:25:50,714 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,714 - DEBUG - Online update step: 20/25
2025-06-02 15:25:50,714 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,714 - DEBUG - Online update step: 21/25
2025-06-02 15:25:50,715 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,715 - DEBUG - Online update step: 22/25
2025-06-02 15:25:50,715 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,715 - DEBUG - Online update step: 23/25
2025-06-02 15:25:50,715 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,715 - DEBUG - Online update step: 24/25
2025-06-02 15:25:50,716 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,716 - DEBUG - Online update step: 25/25
2025-06-02 15:25:50,716 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:25:50,716 - WARNING - No successful steps during online update.
2025-06-02 15:25:50,717 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -2.4827662e-08 -3.1399690e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.0223155e-08
  4.5273971e-08  5.8418030e-09  6.2069154e-09 -2.8478789e-08
  2.3614089e+00  2.9571209e+00  1.3935682e-01  4.3767228e+00
 -5.8418030e-09  3.4747319e+00  5.6738133e+00  7.5895867e+00
  1.3935682e-01  8.0000000e+00  2.5557888e-08  3.6511267e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.8843901e-08 -4.3813522e-08], current edge mean: [-4.9267306e-09  4.6377417e+02  0.0000000e+00  0.0000000e+00
  3.5190935e-09  1.0557281e-09 -1.4076373e-09  2.8152747e-09
  0.0000000e+00 -5.8065042e-09]
2025-06-02 15:25:50,718 - DEBUG - Node drift difference: 0.0281, Edge drift difference: 0.0043
2025-06-02 15:25:50,723 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -2.4827662e-08 -3.1399690e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.0223155e-08
  4.5273971e-08  5.8418030e-09  6.2069154e-09 -2.8478789e-08
  2.3614089e+00  2.9571209e+00  1.3935682e-01  4.3767228e+00
 -5.8418030e-09  3.4747319e+00  5.6738133e+00  7.5895867e+00
  1.3935682e-01  8.0000000e+00  2.5557888e-08  3.6511267e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.8843901e-08 -4.3813522e-08], edge=[-4.9267306e-09  4.6377417e+02  0.0000000e+00  0.0000000e+00
  3.5190935e-09  1.0557281e-09 -1.4076373e-09  2.8152747e-09
  0.0000000e+00 -5.8065042e-09]
2025-06-02 15:25:50,724 - DEBUG - Updated reference std: node=[0.         0.         1.0007665  1.0007666  0.         0.
 0.         1.0007665  1.0007665  1.0007665  1.0007665  1.0007666
 1.0142448  0.28991058 0.3638549  0.56661487 1.0007665  3.0958197
 2.9316137  1.5298709  0.3638549  0.         1.0007666  1.0007666
 0.         0.         0.         0.         1.0007666  1.0007665 ], edge=[  1.0003692 500.15765     0.          0.          1.0003692   1.0003692
   1.0003692   1.0003692   1.0003692   1.0003692]
2025-06-02 15:25:50,724 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:25:50,725 - INFO - Running anomaly detection...
2025-06-02 15:25:50,725 - INFO - Starting anomaly detection.
2025-06-02 15:25:50,856 - DEBUG - Node reconstruction errors: [16.892221  15.4353285 21.709679  18.175158  13.284788  15.647309
 20.04934   17.108181  17.108181  17.940552  17.108181  13.233603
 23.820726  13.30705   16.53753   16.685938  13.326766  16.68594
 18.631836  16.20037   15.585588  16.537533  15.510125  11.14507
 16.274237  18.062773  16.274237  13.428797  16.621693  16.274235
 12.938523  17.443869  13.203595  18.053476  18.443098  15.140533
 15.968134  16.20037   11.856739  11.955627  17.511412  16.114305
 16.20037   16.792822  17.197052  15.423351  17.86311   11.360325
 16.190453  29.329348  31.124878  17.27175   17.624594  16.820328
 15.576172  13.066439  19.630896  15.405178  17.656725  17.993353
 12.331654  15.002317  15.750116  10.84259   16.0926    15.576167
 15.787555  15.576211  15.750116  15.750117  15.462093  14.7394705
 15.735473  15.173799  15.531702  14.83917   16.350517  15.176144
 14.976935  15.070585  17.009296  14.681191  10.284945  16.543402
 16.882923  11.343284  14.650014  15.0474    15.858071  14.891219
 15.976237  13.537612  11.631092  15.099862  15.170981  26.22162
 16.406923  14.2671795 15.052746  15.733225  14.351302  16.406923
 17.087309  16.10535   10.996389  15.271328  15.5979185 12.315774
 12.050564  22.355495  15.671981  16.724758  12.522204  12.313543
 14.629564  14.491326  14.571706  12.479172  15.253358  15.103958
 15.65344   11.631092  11.828248  10.9602    15.760511  15.10387
 10.963281  11.153127  14.136663  16.063658  16.122221  15.979619
 15.523602  13.746497  14.49132   15.6530485 16.268867  15.191548
 11.400189  12.859308  15.907064  14.603455  15.575926  15.858956
 15.837861  14.682802  14.571706  16.211906  15.242712  15.16801
 19.091562  10.865687  14.876135  15.979616  15.918164  12.643368
 15.531409  14.473325  14.351304  17.310675  16.211906  12.07304
 15.531409  16.122221  14.245127  13.115846  14.249722  14.741032
 11.477174  15.1112    14.987884  15.4881935 15.892279  24.768267
 15.003415  14.745862  15.068651  14.4543495 14.198912  14.198911
 15.162287  11.722536  15.014376  11.860781  12.426211  14.534836
 15.461294  14.469868  15.54166   15.420335  15.032248  14.979033
 16.49805   15.703348  11.400056  16.296022  12.144576  15.525873
 12.529246  16.10732   15.021949  15.531409  12.224274  14.875967
 15.270367  11.631092  15.853506  12.741702  14.94321   14.756272
 14.122974  14.534839  16.49805   14.984129  14.534837  15.181728
 14.366236  14.571707  14.130645  15.703348  12.127552  15.461294
 15.696864  16.49805   15.531409  15.525228  12.981993  15.836481
 14.814682  16.40978   11.791517  15.714744  15.926428  14.571703
 14.571707  16.296022  15.837725  15.696864  15.531409  16.280682
 12.806078  15.060561  16.020884  15.168009  15.638693  15.926426
 14.426658  15.229882  16.020884  15.455553  15.892279  15.545234
 14.130643  14.794223  14.49132   15.406299  15.420335  14.74866
 15.34329   14.198909  14.515608  11.334479  15.843     15.420335
 14.814683  15.068362  15.455942  15.185148  15.455939  14.198908
 11.946379  11.725128  14.896933  14.940135  14.092358  14.198909
 15.142622  15.503705  15.162287  14.073541  14.120131  15.218396
 15.034118  16.417624  15.045234  15.876796  13.911525  11.742725
 11.722536  12.264326  15.044399  15.997411  15.50301   15.638692
 10.821381  14.989796  14.680742  14.198938  16.296022  14.968055
 14.629693  14.842548  13.986886  13.986889  14.842548  14.84255
 14.84255   14.072529  14.760006  14.84255   14.84255   14.933918
 14.84255   16.289211  10.581854  14.715707  15.722139  11.50734
 16.356134  16.296022  15.36324   15.256535  15.608825  13.986888
 15.516954  11.779652  14.881499  14.072529  14.697282  14.697282
 16.135983  16.241055  14.84255   14.092355  14.84255   14.072528
 15.009897  15.343291  14.881499  14.881499  14.84255   15.115247
 14.881499  15.363241  15.366175  15.455942  13.986888  15.771881
 15.555292  14.733531  14.842548  14.394822  12.048266  14.06801
 15.009035  15.420335  14.684482  14.84255   14.989795  14.989796
 14.122974  14.993739  15.939187  15.5733185 13.986889  19.337955
 15.471963  13.35653   14.439359  14.356765  14.933918  15.034905
 14.955005  12.213492  14.759345  14.752557  15.552218  15.150864
 15.5170355 14.84255   13.986886  11.371008  15.727936  15.776671
 11.985607  14.098674  15.626598  10.91981   14.783307  14.84255
 15.497698  14.098674  14.044628  14.044627  14.712145  14.712145
 14.712143  16.613134  14.744475  16.960674  15.401294  15.017781
 14.712143  14.744475  14.093891  14.044628  15.322766  15.480728
 14.044627  11.196367  14.712143  14.044627  14.744475  14.712143
 14.712143  15.229049  14.966873  14.712143  15.552216  15.3739605
 15.335841  15.401295  14.362651  15.786218  11.692599  16.199398
 15.354598  14.674304  11.731921  15.599674  15.31571   15.141262
 14.712145  15.219866  14.712143  14.712145  15.401294  15.796565
 12.266842  14.913204  15.375552  15.011244  16.305128  16.305128
 16.305124  11.3416    15.018734  16.631023  16.631023  15.736379
 15.43334   15.398723  15.710778  14.695632  15.398722  16.365915
 15.73097   15.707088  16.349916  14.36265   14.390262  15.73097
 15.786218  12.218014  15.7070875 15.730969  15.098587  14.362653
 12.02133   16.672062  15.098589  14.390264  15.010875  12.339686
 15.85107   14.362902  14.390264  14.3902645 15.375553  15.736377
 16.300924  12.191275  15.451433  15.736377  12.241932  15.046733
 15.398722  11.967713  15.934492  12.939486  14.362653  15.375553
 15.03278   15.3739605 14.390013  15.707088  14.3900175 17.193983
 14.695632  15.736378  15.736377  15.3739605 15.736377  15.027381
 15.046735  15.934492  14.669865  13.804815  15.710778  15.398722
 15.934492  14.985279  14.985279  15.398722  13.912945  15.398724
 14.669865  13.912943  15.398723  14.883271  13.912939  15.011243
 14.669865  16.631023  15.046735  14.390015  15.87651   11.094977
 13.91294   15.433338  15.398722  14.695632  14.695631  15.736377
 14.390013  14.80929   14.495607  15.851077  14.695631  14.80929
 14.695631  14.80929   14.936179  13.912942  14.985279  14.98528
 14.985281  14.6957445 14.829712  14.695744  14.695742  14.695744
 14.695744  14.695742  14.6957445 14.695744  14.695744  15.018938
 15.952602  14.695742  14.695744  14.695742  14.695742  14.6957445
 14.695744  14.695744  14.6957445 14.695744  14.695744  14.695744
 14.695744  13.956364  14.695744  15.398724  12.930076  14.695632
 13.408416  15.134807  17.612389  17.612389  15.810264  13.408416
 14.695632  14.669865  14.669865  14.69563   14.669865  14.695632
 14.9119005 14.6957445 15.011242  14.695631  14.985279  14.695631
 14.695632  14.669865  14.695632  14.669865  14.695628  14.695632
 14.669865  14.669863  14.695631  14.669863  14.695631  14.695631
 14.695631  15.241562  15.154885  15.154885  14.695742  14.752649
 12.73962   14.69563   14.669865  14.695742  14.695744  14.669865
 15.826446  14.695632  14.69563   14.695632  15.400098  15.280387
 15.154882  14.69563   13.956364  14.669865  14.669865  10.585769
 14.695744  14.669865  13.912942  14.695744  14.695744  14.695744
 14.695632  14.695632  15.62686   15.154882  14.695744  15.280385
 15.94153   14.709844  14.709846  12.946295  15.400098  14.6957445
 14.695744  14.709844  15.280383  14.835585  15.400099 ]
2025-06-02 15:25:50,857 - DEBUG - Edge reconstruction errors: [  5.252101    5.2494354  44.2451    ...  13.345019   13.345021
 535.2456   ]
2025-06-02 15:25:50,859 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152550_update_21.json
2025-06-02 15:25:50,860 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:25:50,887 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152550_update_21.pth
2025-06-02 15:25:50,888 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869725.dot): 0.1625
2025-06-02 15:25:50,888 - WARNING - Detected 9 anomalous nodes (reconstruction-based):
2025-06-02 15:25:50,888 - WARNING -   Node ID: 192.168.27.13, Recon Error: 21.7097, MLP Score: 0.2426
2025-06-02 15:25:50,888 - WARNING -   Node ID: 192.168.27.12, Recon Error: 20.0493, MLP Score: 0.2775
2025-06-02 15:25:50,889 - WARNING -   Node ID: 192.168.27.10, Recon Error: 23.8207, MLP Score: 0.2195
2025-06-02 15:25:50,889 - WARNING -   Node ID: ff02::2, Recon Error: 29.3293, MLP Score: 0.3926
2025-06-02 15:25:50,889 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 31.1249, MLP Score: 0.3920
2025-06-02 15:25:50,889 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-02 15:25:50,889 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2450, MLP Score: 0.0000
2025-06-02 15:25:50,890 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9474, MLP Score: 0.0000
2025-06-02 15:25:50,890 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0457, MLP Score: 0.0000
2025-06-02 15:25:50,890 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7479, MLP Score: 0.0000
2025-06-02 15:25:50,890 - WARNING -   Source: 192.168.27.12, Target: 224.0.0.251, Recon Error: 535.2455, MLP Score: 0.0000
2025-06-02 15:25:50,948 - DEBUG - Embedding standard deviations before t-SNE: [0.94195855 0.1641413  0.         0.49150062 0.09526148 0.
 0.44781396 0.6185503  0.         0.6701056  0.         0.
 0.         0.02198351 0.5983996  0.42005855 0.15247852 0.6594343
 0.         0.7343185  0.         0.5978485  0.         0.
 0.         0.         0.51943415 0.6881191  0.0052319  0.
 0.57270336 0.37467897]
2025-06-02 15:25:53,118 - INFO - Embeddings visualization saved to vis/embeddings_21_updates_20250602_152550.png
2025-06-02 15:25:53,119 - INFO - Performing visualization of node and edge features.
2025-06-02 15:25:53,124 - INFO - Starting visualization of node features.
2025-06-02 15:25:53,124 - INFO - Graph has 653 nodes and 30 features.
2025-06-02 15:25:53,124 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:25:53,124 - INFO - Calculating feature statistics:
2025-06-02 15:25:53,125 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:53,125 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:53,125 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 11, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.5793545), 'max': np.float32(1.4206686)}
2025-06-02 15:25:53,126 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 11, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.3954121), 'max': np.float32(2.629857)}
2025-06-02 15:25:53,126 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:53,126 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:53,127 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:53,127 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(-1.1683606e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.4277511), 'max': np.float32(2.337808)}
2025-06-02 15:25:53,127 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(4.6734424e-08), 'std': np.float32(1.0), 'min': np.float32(-1.1985687), 'max': np.float32(0.8343284)}
2025-06-02 15:25:53,128 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 3, 'mean': np.float32(-2.9209015e-09), 'std': np.float32(0.9999999), 'min': np.float32(-8.865789), 'max': np.float32(0.11624347)}
2025-06-02 15:25:53,128 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 11, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-3.7988932), 'max': np.float32(0.8994265)}
2025-06-02 15:25:53,128 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 11, 'mean': np.float32(-2.3367212e-08), 'std': np.float32(1.0), 'min': np.float32(-0.88663286), 'max': np.float32(3.8624964)}
2025-06-02 15:25:53,128 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 8, 'mean': np.float32(2.361409), 'std': np.float32(1.0134679), 'min': np.float32(0.0), 'max': np.float32(11.0)}
2025-06-02 15:25:53,129 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.957121), 'std': np.float32(0.28968853), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:25:53,129 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.13935682), 'std': np.float32(0.36357617), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:25:53,129 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.376723), 'std': np.float32(0.5661809), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:25:53,130 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 3, 'mean': np.float32(2.9209015e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.11624347), 'max': np.float32(8.865789)}
2025-06-02 15:25:53,130 - INFO - - service_1: {'name': 'service_1', 'unique': 5, 'mean': np.float32(3.474732), 'std': np.float32(3.0934484), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 15:25:53,131 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.6738133), 'std': np.float32(2.9293683), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:25:53,131 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.5895867), 'std': np.float32(1.528699), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:25:53,131 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.13935682), 'std': np.float32(0.36357617), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:25:53,132 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 1, 'mean': np.float32(8.0), 'std': np.float32(0.0), 'min': np.float32(8.0), 'max': np.float32(8.0)}
2025-06-02 15:25:53,132 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(-2.9209015e-09), 'std': np.float32(1.0), 'min': np.float32(-0.1343134), 'max': np.float32(14.483462)}
2025-06-02 15:25:53,132 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(5.841803e-09), 'std': np.float32(1.0), 'min': np.float32(-0.14801767), 'max': np.float32(6.75595)}
2025-06-02 15:25:53,132 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:53,133 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:53,133 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:53,133 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:53,134 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(-1.1683606e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.0165796), 'max': np.float32(8.674318)}
2025-06-02 15:25:53,134 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(-5.8418028e-08), 'std': np.float32(1.0), 'min': np.float32(-1.1326946), 'max': np.float32(4.414677)}
2025-06-02 15:25:53,205 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7f9291512210>
2025-06-02 15:25:54,076 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:25:54,462 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:25:54,640 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:25:59,348 - INFO - Node feature visualization saved to vis/node_features_20250602_152555.png
2025-06-02 15:25:59,349 - INFO - Finished visualization of node features.
2025-06-02 15:25:59,349 - INFO - Performing additional feature analysis:
2025-06-02 15:25:59,349 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:25:59,358 - INFO - Starting visualization of edge features.
2025-06-02 15:25:59,358 - INFO - Graph has 1355 edges and 10 edge features.
2025-06-02 15:25:59,359 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:25:59,359 - INFO - Calculating edge feature statistics:
2025-06-02 15:25:59,360 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:25:59,360 - INFO - - count: {'name': 'count', 'unique': 24, 'mean': np.float32(-4.2229122e-09), 'std': np.float32(1.0), 'min': np.float32(-0.047597624), 'max': np.float32(27.940474)}
2025-06-02 15:25:59,361 - INFO - - dst_port: {'name': 'dst_port', 'unique': 15, 'mean': np.float32(463.77417), 'std': np.float32(499.97305), 'min': np.float32(3.0), 'max': np.float32(8688.0)}
2025-06-02 15:25:59,361 - INFO - - protocol: {'name': 'protocol', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:59,361 - INFO - - service: {'name': 'service', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:25:59,361 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 904, 'mean': np.float32(-1.4076373e-09), 'std': np.float32(1.0), 'min': np.float32(-0.07276706), 'max': np.float32(27.607315)}
2025-06-02 15:25:59,361 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 960, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.06579117), 'max': np.float32(27.892584)}
2025-06-02 15:25:59,361 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 316, 'mean': np.float32(1.4076373e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.056002725), 'max': np.float32(27.88871)}
2025-06-02 15:25:59,362 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 937, 'mean': np.float32(2.1114561e-09), 'std': np.float32(1.0), 'min': np.float32(-0.12164314), 'max': np.float32(19.201406)}
2025-06-02 15:25:59,362 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 955, 'mean': np.float32(2.8152747e-09), 'std': np.float32(1.0), 'min': np.float32(-0.11973842), 'max': np.float32(18.085634)}
2025-06-02 15:25:59,362 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 353, 'mean': np.float32(-1.4076373e-09), 'std': np.float32(1.0), 'min': np.float32(-0.06595535), 'max': np.float32(27.347694)}
2025-06-02 15:25:59,431 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7f929122e7e0>
2025-06-02 15:25:59,888 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:25:59,954 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7f92a054b800>
2025-06-02 15:26:00,332 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:26:00,764 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:26:01,231 - DEBUG - Plotted boxplots of the first 8 non-constant edge features.
2025-06-02 15:26:01,341 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:26:01,375 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:26:05,154 - INFO - Edge feature visualization saved to vis/edge_features_20250602_152601.png
2025-06-02 15:26:05,154 - INFO - Finished visualization of edge features.
2025-06-02 15:26:05,155 - INFO - Performing additional edge feature analysis:
2025-06-02 15:26:05,155 - INFO - - 2 out of 10 edge features are constant.
2025-06-02 15:26:05,155 - INFO - - Highest correlation (1.00) between features: 'total_orig_bytes' and 'total_orig_ip_bytes'.
2025-06-02 15:26:05,164 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:26:05,164 - INFO - Graph has 1355 edges and 10 edge features.
2025-06-02 15:26:05,164 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:26:06,664 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_152605_summary.png
2025-06-02 15:26:07,567 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_152605_pca_3d.png
2025-06-02 15:26:08,086 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_152605_pca_variance.png
2025-06-02 15:26:08,086 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:26:08,086 - INFO - 
--- Processing file: nw_graph_encoded_1748869755.dot (Timestamp: 2025-06-02 15:09:15) ---
2025-06-02 15:26:08,086 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869755.dot
2025-06-02 15:26:08,087 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869755.dot'.
2025-06-02 15:26:08,087 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869755.dot
2025-06-02 15:26:08,116 - INFO - Parsed 693 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869755.dot'.
2025-06-02 15:26:08,205 - INFO - Parsed 1448 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869755.dot'.
2025-06-02 15:26:08,205 - INFO - Processing node updates/additions.
2025-06-02 15:26:08,235 - INFO - Processing edge updates/additions.
2025-06-02 15:26:08,354 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:26:08,360 - INFO - Finished updating NetworkX graph.
2025-06-02 15:26:08,363 - DEBUG - Updated graph - Nodes: 693, Edges: 1448
2025-06-02 15:26:08,363 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:26:08,368 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:26:08,506 - DEBUG - Initial node features tensor shape: torch.Size([693, 30])
2025-06-02 15:26:08,514 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:26:08,515 - DEBUG - Node features tensor shape after scaling: torch.Size([693, 30])
2025-06-02 15:26:08,522 - DEBUG - Edge index tensor shape: torch.Size([2, 1448])
2025-06-02 15:26:08,538 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:26:08,613 - DEBUG - Initial edge attributes tensor shape: torch.Size([1448, 10])
2025-06-02 15:26:08,617 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:26:08,619 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1448, 10])
2025-06-02 15:26:08,619 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:26:08,620 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:26:08,623 - INFO - Updated main graph to 693 nodes and 1448 edges.
2025-06-02 15:26:08,623 - INFO - Performing online update...
2025-06-02 15:26:08,624 - INFO - Starting online update for 25 steps.
2025-06-02 15:26:08,625 - DEBUG - Updated RunningStats: new_mean=0.940599945244928, new_var=12000000000161.371, new_n=1230
2025-06-02 15:26:08,625 - DEBUG - Updated RunningStats: new_mean=0.9357146834184095, new_var=12300000000018.945, new_n=1260
2025-06-02 15:26:08,626 - DEBUG - Updated RunningStats: new_mean=41.93008753559372, new_var=4000000192247.603, new_n=410
2025-06-02 15:26:08,626 - DEBUG - Updated RunningStats: new_mean=42.1009306896671, new_var=4100000210703.012, new_n=420
2025-06-02 15:26:08,627 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:26:08,627 - DEBUG - Online update step: 1/25
2025-06-02 15:26:08,627 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:08,627 - DEBUG - Online update step: 2/25
2025-06-02 15:26:08,627 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:08,628 - DEBUG - Online update step: 3/25
2025-06-02 15:26:08,628 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:08,628 - DEBUG - Online update step: 4/25
2025-06-02 15:26:08,628 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:08,628 - DEBUG - Online update step: 5/25
2025-06-02 15:26:08,628 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:08,629 - DEBUG - Online update step: 6/25
2025-06-02 15:26:08,629 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:08,629 - DEBUG - Online update step: 7/25
2025-06-02 15:26:08,629 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:08,629 - DEBUG - Online update step: 8/25
2025-06-02 15:26:08,629 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:08,630 - DEBUG - Online update step: 9/25
2025-06-02 15:26:08,630 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:08,630 - DEBUG - Online update step: 10/25
2025-06-02 15:26:08,630 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:08,630 - DEBUG - Online update step: 11/25
2025-06-02 15:26:08,630 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:08,631 - DEBUG - Online update step: 12/25
2025-06-02 15:26:08,631 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:08,631 - DEBUG - Online update step: 13/25
2025-06-02 15:26:08,631 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:08,631 - DEBUG - Online update step: 14/25
2025-06-02 15:26:08,632 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:08,632 - DEBUG - Online update step: 15/25
2025-06-02 15:26:08,632 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:08,632 - DEBUG - Online update step: 16/25
2025-06-02 15:26:08,632 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:08,632 - DEBUG - Online update step: 17/25
2025-06-02 15:26:08,633 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:08,633 - DEBUG - Online update step: 18/25
2025-06-02 15:26:08,633 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:08,633 - DEBUG - Online update step: 19/25
2025-06-02 15:26:08,633 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:08,633 - DEBUG - Online update step: 20/25
2025-06-02 15:26:08,633 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:08,634 - DEBUG - Online update step: 21/25
2025-06-02 15:26:08,634 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:08,634 - DEBUG - Online update step: 22/25
2025-06-02 15:26:08,634 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:08,634 - DEBUG - Online update step: 23/25
2025-06-02 15:26:08,634 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:08,635 - DEBUG - Online update step: 24/25
2025-06-02 15:26:08,635 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:08,635 - DEBUG - Online update step: 25/25
2025-06-02 15:26:08,635 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:08,635 - WARNING - No successful steps during online update.
2025-06-02 15:26:08,637 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -4.7133256e-08  3.0619415e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -5.0229598e-08
  4.1284602e-09  5.5046137e-09  3.0275377e-08 -3.0275377e-08
  2.3362193e+00  2.9595959e+00  1.3708514e-01  4.3939395e+00
 -5.5046137e-09  3.4992785e+00  5.6955266e+00  7.6132755e+00
  1.3708514e-01  8.0000000e+00 -3.3027682e-08  1.6513841e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.4403836e-08  1.5137688e-08], current edge mean: [-1.3172298e-09  4.6195374e+02  0.0000000e+00  0.0000000e+00
 -1.3172298e-09  4.9396114e-09 -1.3172298e-09  2.6344595e-09
 -3.9516892e-09  9.8792230e-10]
2025-06-02 15:26:08,637 - DEBUG - Node drift difference: 0.0304, Edge drift difference: 0.0036
2025-06-02 15:26:08,639 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -4.7133256e-08  3.0619415e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -5.0229598e-08
  4.1284602e-09  5.5046137e-09  3.0275377e-08 -3.0275377e-08
  2.3362193e+00  2.9595959e+00  1.3708514e-01  4.3939395e+00
 -5.5046137e-09  3.4992785e+00  5.6955266e+00  7.6132755e+00
  1.3708514e-01  8.0000000e+00 -3.3027682e-08  1.6513841e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.4403836e-08  1.5137688e-08], edge=[-1.3172298e-09  4.6195374e+02  0.0000000e+00  0.0000000e+00
 -1.3172298e-09  4.9396114e-09 -1.3172298e-09  2.6344595e-09
 -3.9516892e-09  9.8792230e-10]
2025-06-02 15:26:08,640 - DEBUG - Updated reference std: node=[0.         0.         1.0007223  1.0007223  0.         0.
 0.         1.0007223  1.0007223  1.0007224  1.0007223  1.0007223
 0.98739225 0.28158483 0.36058903 0.565704   1.0007224  3.083906
 2.926053   1.4880826  0.36058903 0.         1.0007223  1.0007223
 0.         0.         0.         0.         1.0007223  1.0007223 ], edge=[  1.0003455 484.05258     0.          0.          1.0003455   1.0003455
   1.0003455   1.0003455   1.0003455   1.0003455]
2025-06-02 15:26:08,640 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:26:08,641 - INFO - Running anomaly detection...
2025-06-02 15:26:08,641 - INFO - Starting anomaly detection.
2025-06-02 15:26:08,659 - DEBUG - Node reconstruction errors: [17.042933  15.7224455 22.354471  18.227169  13.428506  15.805738
 20.664978  17.167463  17.167463  17.999897  17.167463  13.337911
 24.611826  13.533191  16.602285  16.729107  13.4418545 16.729103
 18.790081  16.265095  15.707981  16.602285  15.6338625 11.258173
 16.351276  18.146801  16.351274  13.58102   16.704567  16.351276
 13.201765  17.526701  13.332659  18.127016  18.531132  15.233181
 16.150064  16.265093  12.044504  12.075016  17.598362  16.196657
 16.265093  16.88608   17.265835  15.554018  17.96119   11.884903
 16.291037  29.67465   31.643799  17.37043   17.725716  17.041876
 15.725386  12.493692  20.167408  15.502591  17.86917   18.21216
 12.497695  15.096994  15.8451185 10.942277  16.189089  15.725377
 15.935435  15.725424  15.845119  15.845119  15.609208  14.891722
 15.848408  15.344735  15.6834345 14.990443  16.447462  15.321307
 15.152778  15.244231  17.11977   14.860891  10.396321  16.68082
 17.01808   11.469832  14.803791  15.228932  16.037798  15.082286
 16.087786  13.704276  11.737744  15.296739  15.319369  26.712988
 16.51415   14.420596  15.165074  15.853987  14.5061245 16.51415
 17.200079  16.282696  10.965735  15.384088  15.68704   12.45241
 12.17241   22.582043  15.800413  16.840067  12.429302  12.4700985
 14.780701  14.638015  14.721555  12.623594  15.4313135 15.236037
 15.764337  11.732797  11.874207  11.070887  15.9401    15.23595
 11.069171  11.2670355 14.371711  14.908983  16.249456  16.10433
 15.633915  13.911371  14.638005  15.772339  16.37371   15.301443
 11.519254  13.082673  16.02745   14.748332  15.682511  15.973544
 15.943067  14.836412  14.721553  16.336525  15.372752  15.342826
 19.222836  10.965892  15.0493965 16.10433   16.08034   12.7984495
 15.645785  14.636754  14.506124  17.424822  16.336525  12.196176
 15.645787  16.249456  14.395822  13.275059  14.404443  14.901415
 11.619022  15.281109  15.1619215 15.2327795 16.003246  25.260933
 15.183712  14.96765   15.248276  14.597873  14.347122  14.347122
 15.267576  11.841156  15.141406  12.005673  12.570386  14.682063
 15.558353  14.636641  15.653924  15.525886  15.235248  15.167307
 16.392792  15.823378  11.519097  16.403532  12.3565035 15.593957
 12.680334  16.209772  15.147563  15.645785  12.377466  15.04771
 15.440904  11.737746  15.981343  12.879481  15.055667  14.928388
 14.266987  14.682063  16.618015  15.177966  14.682065  15.275584
 14.552371  14.721553  14.282381  15.823378  12.289697  15.558356
 15.806915  16.618015  15.645785  15.698471  13.126178  15.954807
 14.986517  16.523197  11.713843  15.89956   15.1963625 14.721553
 14.721552  16.403532  15.124032  15.806915  15.645783  16.13785
 12.974638  15.253875  16.144611  15.342822  15.756144  16.089619
 14.594029  15.370795  16.144611  15.592554  16.003246  15.651377
 14.28238   14.876097  14.638006  15.563341  15.525886  14.84791
 15.17168   14.347121  14.663565  11.451634  15.949981  15.174658
 14.947163  15.206084  15.630184  15.498082  15.630183  14.224828
 12.081878  11.859952  15.084978  15.05496   14.239328  14.34712
 15.2679615 15.676102  15.267574  14.212188  14.2051325 15.348859
 15.188177  16.530214  14.146045  15.98941   14.136139  11.857576
 11.841157  12.380798  15.16878   16.091124  15.630641  15.756144
 10.921065  15.103023  15.583462  14.347181  16.403532  15.071638
 14.771422  14.952544  14.125774  14.125774  14.952545  14.952542
 14.952542  14.216222  14.865887  14.952545  14.952545  15.092639
 14.952542  15.453297  10.681301  14.8870125 15.87883   11.600532
 16.470764  16.385368  15.533983  15.407007  15.769291  14.125775
 15.620484  11.920322  14.992858  14.216223  14.867166  14.8671665
 16.32646   16.335173  14.952542  14.239329  14.952545  14.216226
 15.1310835 15.447657  14.992858  14.992857  14.952542  15.21951
 14.992858  15.409898  15.547916  15.630184  14.125773  15.883272
 15.713899  14.899108  14.952542  14.553442  12.155014  14.20823
 15.112231  15.525886  14.772741  14.952544  15.103024  15.1030245
 14.266988  15.098798  16.079592  15.750995  14.125773  19.782246
 15.572537  13.5131445 14.578471  14.482889  15.107671  15.191289
 15.09279   12.336275  14.921781  14.894421  15.656501  15.275146
 15.701084  14.952545  14.125772  11.495139  15.827637  15.95007
 12.10292   14.238728  15.747477  10.876669  14.911303  14.952545
 15.648547  14.238726  14.173648  14.134202  14.831503  14.831503
 14.831503  16.818342  14.8458805 17.172953  15.420857  15.146792
 14.831503  14.84588   14.2369995 14.173651  15.472602  15.6218195
 14.173647  11.311249  14.831503  14.173649  14.8458805 14.831503
 14.831503  15.232234  15.064905  14.831503  15.65651   15.453431
 15.460016  15.503566  14.48208   15.89461   11.817426  16.32623
 15.450861  14.806482  11.845958  15.689788  15.4588175 15.243971
 14.0123005 15.351224  14.831503  14.831503  15.503568  15.934069
 12.375403  15.014914  15.447995  15.113501  16.387154  16.387156
 16.387156  11.44711   15.131699  16.727198  16.727198  15.8313055
 15.56605   15.481164  15.796617  14.784835  15.481165  16.46107
 15.833086  15.801193  16.447168  14.48208   14.518306  15.833084
 15.89461   12.313285  15.801193  15.833086  15.187389  14.482078
 12.139944  16.781729  15.187389  14.518306  15.152391  12.533828
 15.992539  14.482524  14.518306  14.518308  15.447995  15.831304
 16.391756  13.0411005 15.546732  15.831305  12.3682    15.122312
 15.481165  12.069273  16.014894  13.135788  14.467885  15.447996
 15.166882  15.453431  14.50198   15.801193  14.501985  17.407043
 14.784835  15.831307  15.831307  15.453432  15.831304  15.1407175
 15.122311  16.014894  14.749268  14.0146265 15.796616  15.481167
 16.014896  15.07862   15.07862   15.481165  14.027484  15.481164
 14.74927   14.027484  16.92749   14.989956  14.027482  15.113501
 14.749268  16.727198  15.122311  14.501982  15.966746  11.1776905
 14.027484  15.56605   15.481167  14.784836  14.784835  15.8313055
 14.50198   14.152341  14.626857  15.992536  14.784835  14.920321
 14.784835  14.920321  15.02759   14.027482  15.07862   15.078622
 15.07862   14.76747   15.023389  14.767471  14.767471  14.76747
 14.767471  14.76747   14.767469  14.767471  14.0627165 15.103817
 16.012815  14.76747   14.767471  14.767469  14.76747   14.767471
 14.767471  14.767471  14.76747   14.76747   14.04609   14.767471
 14.767471  14.062718  14.767469  15.481165  12.934726  14.784836
 13.4001    15.230546  17.594921  17.594921  15.940716  13.4001
 14.784835  14.74927   14.74927   14.784835  14.749268  14.784835
 15.29934   14.76747   15.113502  14.784834  15.078622  14.784834
 14.784834  14.749268  14.784835  14.749268  14.784834  14.784835
 14.027484  14.749268  14.784834  14.749268  14.784835  14.784834
 14.784835  15.364221  15.259457  15.259457  14.767471  14.842712
 12.744689  14.784834  14.749268  15.387349  14.767471  14.749268
 15.9356985 14.740022  14.784836  14.784835  14.541112  15.390958
 15.259457  14.784834  14.06272   14.74927   14.749268  10.671469
 14.767471  14.749268  14.027484  14.767471  14.767471  14.062719
 14.784834  14.784835  15.7447    15.259457  14.767471  15.390958
 15.997349  14.798554  14.798553  12.933637  15.463738  14.767471
 14.767471  14.798554  15.390959  14.928507  15.463738  15.497632
 14.795971  14.795971  14.795966  14.795971  14.795971  14.795971
 14.795969  14.795968  14.795968  14.767471  14.76747   14.767471
 14.798554  15.381707  14.798554  15.249466  14.798554  14.767469
 14.76747   14.76747   14.767471  14.76747   14.798554  15.105999
 14.755412  14.755416  14.795971  15.105999  14.928507  15.28822
 14.76747   14.767471  14.795966  15.497631  14.755412  14.755413
 15.497631  15.143098  14.795969 ]
2025-06-02 15:26:08,660 - DEBUG - Edge reconstruction errors: [  5.252405   5.25101   44.245228 ...  13.345146  13.345149 535.2458  ]
2025-06-02 15:26:08,667 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152608_update_22.json
2025-06-02 15:26:08,667 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:26:08,682 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152608_update_22.pth
2025-06-02 15:26:08,682 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869755.dot): 0.1608
2025-06-02 15:26:08,683 - WARNING - Detected 10 anomalous nodes (reconstruction-based):
2025-06-02 15:26:08,683 - WARNING -   Node ID: 192.168.27.13, Recon Error: 22.3545, MLP Score: 0.2381
2025-06-02 15:26:08,683 - WARNING -   Node ID: 192.168.27.12, Recon Error: 20.6650, MLP Score: 0.2735
2025-06-02 15:26:08,683 - WARNING -   Node ID: 192.168.27.10, Recon Error: 24.6118, MLP Score: 0.2146
2025-06-02 15:26:08,684 - WARNING -   Node ID: ff02::2, Recon Error: 29.6747, MLP Score: 0.3899
2025-06-02 15:26:08,684 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 31.6438, MLP Score: 0.3887
2025-06-02 15:26:08,684 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-02 15:26:08,684 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2452, MLP Score: 0.0000
2025-06-02 15:26:08,684 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9476, MLP Score: 0.0000
2025-06-02 15:26:08,685 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0458, MLP Score: 0.0000
2025-06-02 15:26:08,685 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7480, MLP Score: 0.0000
2025-06-02 15:26:08,685 - WARNING -   Source: 192.168.27.12, Target: 224.0.0.251, Recon Error: 535.2457, MLP Score: 0.0000
2025-06-02 15:26:08,686 - INFO - 
--- Processing file: nw_graph_encoded_1748869785.dot (Timestamp: 2025-06-02 15:09:45) ---
2025-06-02 15:26:08,686 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869785.dot
2025-06-02 15:26:08,686 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869785.dot'.
2025-06-02 15:26:08,686 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869785.dot
2025-06-02 15:26:08,716 - INFO - Parsed 700 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869785.dot'.
2025-06-02 15:26:08,796 - INFO - Parsed 1476 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869785.dot'.
2025-06-02 15:26:08,796 - INFO - Processing node updates/additions.
2025-06-02 15:26:08,826 - INFO - Processing edge updates/additions.
2025-06-02 15:26:08,957 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:26:08,962 - INFO - Finished updating NetworkX graph.
2025-06-02 15:26:08,965 - DEBUG - Updated graph - Nodes: 700, Edges: 1476
2025-06-02 15:26:08,965 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:26:08,970 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:26:09,113 - DEBUG - Initial node features tensor shape: torch.Size([700, 30])
2025-06-02 15:26:09,116 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:26:09,117 - DEBUG - Node features tensor shape after scaling: torch.Size([700, 30])
2025-06-02 15:26:09,124 - DEBUG - Edge index tensor shape: torch.Size([2, 1476])
2025-06-02 15:26:09,140 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:26:09,210 - DEBUG - Initial edge attributes tensor shape: torch.Size([1476, 10])
2025-06-02 15:26:09,214 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:26:09,215 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1476, 10])
2025-06-02 15:26:09,215 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:26:09,216 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:26:09,219 - INFO - Updated main graph to 700 nodes and 1476 edges.
2025-06-02 15:26:09,219 - INFO - Performing online update...
2025-06-02 15:26:09,219 - INFO - Starting online update for 25 steps.
2025-06-02 15:26:09,220 - DEBUG - Updated RunningStats: new_mean=0.9408962908400099, new_var=12600000000160.984, new_n=1290
2025-06-02 15:26:09,221 - DEBUG - Updated RunningStats: new_mean=0.9362716635058301, new_var=12900000000019.05, new_n=1320
2025-06-02 15:26:09,221 - DEBUG - Updated RunningStats: new_mean=42.19462086323534, new_var=4200000191673.1953, new_n=430
2025-06-02 15:26:09,222 - DEBUG - Updated RunningStats: new_mean=42.34154735289656, new_var=4300000206746.0786, new_n=440
2025-06-02 15:26:09,222 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:26:09,222 - DEBUG - Online update step: 1/25
2025-06-02 15:26:09,222 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,223 - DEBUG - Online update step: 2/25
2025-06-02 15:26:09,223 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,223 - DEBUG - Online update step: 3/25
2025-06-02 15:26:09,223 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,223 - DEBUG - Online update step: 4/25
2025-06-02 15:26:09,223 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,224 - DEBUG - Online update step: 5/25
2025-06-02 15:26:09,224 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,224 - DEBUG - Online update step: 6/25
2025-06-02 15:26:09,224 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,224 - DEBUG - Online update step: 7/25
2025-06-02 15:26:09,224 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,224 - DEBUG - Online update step: 8/25
2025-06-02 15:26:09,225 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,225 - DEBUG - Online update step: 9/25
2025-06-02 15:26:09,225 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,225 - DEBUG - Online update step: 10/25
2025-06-02 15:26:09,225 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,225 - DEBUG - Online update step: 11/25
2025-06-02 15:26:09,226 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,226 - DEBUG - Online update step: 12/25
2025-06-02 15:26:09,226 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,226 - DEBUG - Online update step: 13/25
2025-06-02 15:26:09,226 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,226 - DEBUG - Online update step: 14/25
2025-06-02 15:26:09,227 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,227 - DEBUG - Online update step: 15/25
2025-06-02 15:26:09,227 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,227 - DEBUG - Online update step: 16/25
2025-06-02 15:26:09,227 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,227 - DEBUG - Online update step: 17/25
2025-06-02 15:26:09,227 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,228 - DEBUG - Online update step: 18/25
2025-06-02 15:26:09,228 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,228 - DEBUG - Online update step: 19/25
2025-06-02 15:26:09,228 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,229 - DEBUG - Online update step: 20/25
2025-06-02 15:26:09,229 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,229 - DEBUG - Online update step: 21/25
2025-06-02 15:26:09,229 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,229 - DEBUG - Online update step: 22/25
2025-06-02 15:26:09,230 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,230 - DEBUG - Online update step: 23/25
2025-06-02 15:26:09,230 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,230 - DEBUG - Online update step: 24/25
2025-06-02 15:26:09,230 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,230 - DEBUG - Online update step: 25/25
2025-06-02 15:26:09,230 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,231 - WARNING - No successful steps during online update.
2025-06-02 15:26:09,232 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -2.1798270e-08  5.1770890e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.8392290e-08
  4.7683717e-08 -2.4523054e-08 -8.1743510e-09 -1.2261527e-08
  2.3414285e+00  2.9600000e+00  1.4000000e-01  4.3857141e+00
  2.4523054e-08  3.5214286e+00  5.6671429e+00  7.5999999e+00
  1.4000000e-01  8.0000000e+00 -1.8392290e-08  5.3133284e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.7683715e-09 -8.1743510e-09], current edge mean: [-3.8767247e-09  4.6129608e+02  0.0000000e+00  0.0000000e+00
 -4.5228457e-09 -1.9383624e-09  6.4612082e-10  2.5844833e-09
 -2.5844833e-09 -2.2614228e-09]
2025-06-02 15:26:09,232 - DEBUG - Node drift difference: 0.0145, Edge drift difference: 0.0014
2025-06-02 15:26:09,234 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -2.1798270e-08  5.1770890e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.8392290e-08
  4.7683717e-08 -2.4523054e-08 -8.1743510e-09 -1.2261527e-08
  2.3414285e+00  2.9600000e+00  1.4000000e-01  4.3857141e+00
  2.4523054e-08  3.5214286e+00  5.6671429e+00  7.5999999e+00
  1.4000000e-01  8.0000000e+00 -1.8392290e-08  5.3133284e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.7683715e-09 -8.1743510e-09], edge=[-3.8767247e-09  4.6129608e+02  0.0000000e+00  0.0000000e+00
 -4.5228457e-09 -1.9383624e-09  6.4612082e-10  2.5844833e-09
 -2.5844833e-09 -2.2614228e-09]
2025-06-02 15:26:09,235 - DEBUG - Updated reference std: node=[0.         0.         1.000715   1.000715   0.         0.
 0.         1.0007151  1.000715   1.000715   1.000715   1.0007151
 0.9945478  0.2802002  0.36725795 0.5633757  1.000715   3.0975275
 2.9325864  1.5110466  0.36725795 0.         1.000715   1.000715
 0.         0.         0.         0.         1.000715   1.000715  ], edge=[  1.0003389 479.5915      0.          0.          1.0003389   1.0003389
   1.0003389   1.0003389   1.0003389   1.0003389]
2025-06-02 15:26:09,235 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:26:09,235 - INFO - Running anomaly detection...
2025-06-02 15:26:09,235 - INFO - Starting anomaly detection.
2025-06-02 15:26:09,251 - DEBUG - Node reconstruction errors: [17.066399  15.769345  22.476294  18.208773  13.400212  15.829894
 20.76989   17.150951  17.150951  17.984537  17.150951  13.3520355
 24.76896   13.515137  16.599775  16.714533  13.463664  16.714535
 18.79425   16.261724  15.730075  16.599773  15.641779  11.278214
 16.356565  18.139273  16.356565  13.607294  16.699553  16.356565
 13.25875   17.523035  13.349794  18.124775  18.527199  15.244215
 16.176386  16.261726  12.075943  12.094851  17.605742  16.203066
 16.261724  16.904873  17.264004  15.568038  17.979967  11.895951
 16.295618  29.834991  31.291845  17.376795  17.727846  17.085558
 15.751256  12.51066   20.246494  15.5160055 17.89918   18.245396
 12.52518   15.10899   15.85948   10.95627   16.199902  15.75125
 15.958954  15.751298  15.859481  15.859481  15.45145   14.912626
 15.867031  15.374128  15.7079525 15.011038  16.46393   15.347146
 15.182022  15.274006  17.139774  14.89129   10.425629  16.702122
 17.041058  11.495815  14.51884   15.258948  16.067122  15.039444
 16.110863  13.731217  11.759532  15.329025  15.341146  26.779558
 16.534773  14.444757  15.190736  15.877711  14.532887  16.534773
 17.225748  16.312017  10.98174   15.402701  15.701185  12.477173
 12.199942  22.619076  15.824901  16.865763  12.452652  12.498705
 14.808967  14.665344  14.749609  12.642458  15.464428  15.253382
 15.789944  11.74287   11.888488  11.084765  15.969376  15.253322
 11.090759  11.286335  14.3947115 14.924673  16.273867  16.127214
 15.656683  13.941674  14.665334  15.795026  16.395346  15.324983
 11.541677  13.118926  16.04999   14.772778  15.708016  15.995651
 15.961858  14.864391  14.749607  16.35729   15.396682  15.375095
 19.251293  10.981886  15.080862  16.127214  16.105795  12.819874
 15.664567  14.660383  14.532888  17.448702  16.35729   12.218233
 15.664566  16.273865  14.42259   13.304538  14.431937  14.92915
 11.640504  15.257273  15.190645  15.244236  16.026754  25.340506
 15.211325  15.0036125 15.28076   15.314728  14.373305  14.373301
 15.2838335 11.863971  15.167279  12.025645  12.541188  14.709483
 15.582571  14.665903  15.675961  15.541904  15.270002  15.197297
 16.400255  15.842861  11.541519  16.420097  10.318161  15.613117
 12.701436  16.232166  15.173774  15.664567  12.403594  15.0782385
 15.471618  11.759532  16.004326  12.898866  15.081934  14.960715
 14.292468  14.709478  16.638786  15.183894  16.04393   15.294363
 14.575541  14.749606  14.308356  15.842861  12.316286  15.582571
 15.831677  16.638788  15.664567  15.727115  13.150222  15.97301
 15.01503   16.547203  11.720748  15.927145  15.220621  14.749607
 14.749607  16.420097  15.150715  15.8316765 15.664567  16.148958
 13.002716  15.212267  16.167055  15.3750925 15.775816  16.114552
 14.621493  15.396626  16.167055  15.616102  16.026752  15.67203
 14.3083515 14.896541  14.549605  15.593631  15.541905  14.871779
 15.182413  14.373302  14.689264  11.4750185 15.971843  15.1915655
 14.973241  15.227099  15.663044  15.5526285 15.663043  14.2411785
 12.099163  11.87736   15.119149  15.06013   14.266671  14.373307
 15.290904  15.705991  15.2838335 14.235872  14.22425   15.37314
 15.213599  16.55609   14.163186  16.014904  14.170339  11.8742
 11.86397   12.410996  15.180546  16.110838  15.654505  15.775814
 10.945902  15.127506  14.841853  14.373367  16.420097  15.092901
 14.792486  14.978102  14.151744  14.151742  14.978102  14.978102
 14.978102  14.242582  14.890752  14.978102  14.978102  15.116947
 14.978102  15.465999  10.95661   14.915814  15.908656  11.616616
 16.490986  16.397764  15.566024  15.431917  15.797141  14.151743
 15.640586  11.939479  15.01819   14.24258   14.899103  14.899103
 16.361753  16.34709   14.978102  14.266668  14.978102  14.242581
 15.142228  15.470205  15.018188  15.018188  14.978102  15.24122
 15.01819   15.430409  15.573249  15.663042  14.151744  15.910017
 15.740301  14.927553  14.978102  14.557833  12.177346  14.228255
 15.134578  15.541904  14.791139  14.978102  15.127506  15.127506
 14.29247   15.115838  16.098436  15.857319  14.151744  19.848993
 15.598538  13.534686  14.604473  14.503953  15.136853  15.217679
 15.117113  12.269831  14.953426  14.92015   15.681882  15.298788
 15.731817  14.978102  14.151742  11.519289  15.846693  15.980785
 12.124625  14.263319  15.770694  10.891432  14.933547  14.978102
 15.677595  14.157927  14.19557   14.147718  14.851762  14.851762
 14.851762  16.858904  14.869778  17.215292  15.42747   15.170354
 14.851764  14.869778  14.259265  14.195572  15.498432  15.459505
 14.195568  11.332664  14.851762  14.19557   14.869778  14.851762
 14.851762  15.239871  15.086172  14.851762  15.68188   15.472447
 15.479539  15.52113   14.502072  15.806284  11.832859  16.272177
 15.46533   14.782656  11.863865  15.709371  15.483476  15.170102
 14.032574  15.373675  14.851764  14.851762  15.42747   15.958862
 12.455121  15.03184   15.465716  15.131733  16.40884   16.408838
 16.40884   11.466293  15.150123  16.745613  16.745611  15.850878
 15.586542  15.502778  15.81253   14.805274  15.502778  16.479662
 15.854059  15.818621  16.472937  14.502074  14.541697  15.854059
 15.91604   12.33295   15.818621  15.854061  15.208555  14.502067
 12.091516  16.717066  15.208555  14.5417    15.173826  13.140677
 16.013344  14.502543  14.541699  14.541698  15.465717  15.850877
 16.415073  13.056306  15.571799  15.850879  12.391613  15.139975
 15.502776  12.084467  16.033903  13.164707  14.485522  15.465717
 15.186798  15.472447  14.520291  15.818621  14.520292  17.450888
 14.805274  15.850877  15.850877  15.472447  15.850877  15.159802
 15.139974  11.875962  14.76594   14.04571   15.81253   15.502779
 16.033903  15.0928755 15.0928755 15.502777  14.046199  15.502778
 14.76594   14.046201  16.939764  15.015985  14.046198  15.131733
 14.765939  16.745613  15.139972  14.52029   15.980883  11.197571
 14.046201  15.586541  15.502779  14.805276  14.805274  15.850879
 14.520288  14.1691885 14.648458  16.013344  14.805274  14.936505
 14.805274  14.936505  15.057007  14.046198  15.0928755 15.0928755
 15.0928755 14.784493  15.050454  14.784493  14.784493  14.784493
 14.784493  14.784493  14.784493  14.784493  14.079546  15.116473
 16.02626   14.784493  14.784493  14.784493  14.784493  14.784493
 14.784493  14.784493  14.784493  14.784493  14.058195  14.784493
 14.784493  14.07955   14.784493  15.502779  12.949323  14.805276
 13.408413  15.245002  17.605022  17.605022  15.96404   13.408413
 14.805274  14.765939  14.76594   14.805276  14.765939  14.805274
 15.310105  14.784493  15.131733  14.805274  15.0928755 14.805276
 14.805274  14.765939  14.805276  14.765939  14.805274  14.805274
 14.046198  14.765939  14.805276  14.76594   14.805274  14.805276
 14.805274  15.382122  14.50503   15.277379  14.784493  14.853816
 12.757891  14.805274  14.765939  15.400339  14.784493  14.765939
 15.9536495 14.752465  14.805276  14.805274  14.556506  15.407256
 15.277379  14.805274  14.07955   14.76594   14.765939  10.682234
 14.784493  14.765939  14.046201  14.784493  14.784493  14.079551
 14.805274  14.805274  15.762056  15.27738   14.058193  15.407256
 16.008755  14.811825  14.811826  12.941962  15.47949   14.784493
 15.102662  14.811826  15.407256  14.939058  15.47949   15.505509
 14.804954  14.804954  14.804954  14.804956  14.804956  14.804956
 14.111307  14.804954  14.804956  14.784493  14.784493  14.784493
 14.811825  15.391509  14.811825  15.263661  14.811826  14.058192
 14.058195  14.784493  14.058194  14.784493  14.811826  15.117709
 14.767133  14.767133  14.804954  15.117709  14.939058  15.294908
 14.784493  14.784493  14.804954  15.50551   14.767133  14.767133
 15.50551   15.146918  14.804956  15.026844  16.047245  14.7924795
 15.462439  15.505509  15.462439  15.146918 ]
2025-06-02 15:26:09,252 - DEBUG - Edge reconstruction errors: [  5.251247   5.250575  44.24412  ...  13.344049  13.344051 535.2446  ]
2025-06-02 15:26:09,255 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152609_update_23.json
2025-06-02 15:26:09,255 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:26:09,269 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152609_update_23.pth
2025-06-02 15:26:09,269 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869785.dot): 0.1598
2025-06-02 15:26:09,269 - WARNING - Detected 10 anomalous nodes (reconstruction-based):
2025-06-02 15:26:09,270 - WARNING -   Node ID: 192.168.27.13, Recon Error: 22.4763, MLP Score: 0.2391
2025-06-02 15:26:09,270 - WARNING -   Node ID: 192.168.27.12, Recon Error: 20.7699, MLP Score: 0.2748
2025-06-02 15:26:09,270 - WARNING -   Node ID: 192.168.27.10, Recon Error: 24.7690, MLP Score: 0.2151
2025-06-02 15:26:09,270 - WARNING -   Node ID: ff02::2, Recon Error: 29.8350, MLP Score: 0.3697
2025-06-02 15:26:09,270 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 31.2918, MLP Score: 0.3676
2025-06-02 15:26:09,270 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-02 15:26:09,271 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2440, MLP Score: 0.0000
2025-06-02 15:26:09,271 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9466, MLP Score: 0.0000
2025-06-02 15:26:09,271 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0448, MLP Score: 0.0000
2025-06-02 15:26:09,272 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7469, MLP Score: 0.0000
2025-06-02 15:26:09,272 - WARNING -   Source: 192.168.27.12, Target: 224.0.0.251, Recon Error: 535.2446, MLP Score: 0.0000
2025-06-02 15:26:09,272 - INFO - 
--- Processing file: nw_graph_encoded_1748869815.dot (Timestamp: 2025-06-02 15:10:15) ---
2025-06-02 15:26:09,272 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869815.dot
2025-06-02 15:26:09,272 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869815.dot'.
2025-06-02 15:26:09,272 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869815.dot
2025-06-02 15:26:09,302 - INFO - Parsed 715 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869815.dot'.
2025-06-02 15:26:09,383 - INFO - Parsed 1521 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869815.dot'.
2025-06-02 15:26:09,383 - INFO - Processing node updates/additions.
2025-06-02 15:26:09,417 - INFO - Processing edge updates/additions.
2025-06-02 15:26:09,541 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:26:09,545 - INFO - Finished updating NetworkX graph.
2025-06-02 15:26:09,548 - DEBUG - Updated graph - Nodes: 715, Edges: 1521
2025-06-02 15:26:09,548 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:26:09,553 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:26:09,696 - DEBUG - Initial node features tensor shape: torch.Size([715, 30])
2025-06-02 15:26:09,699 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:26:09,699 - DEBUG - Node features tensor shape after scaling: torch.Size([715, 30])
2025-06-02 15:26:09,703 - DEBUG - Edge index tensor shape: torch.Size([2, 1521])
2025-06-02 15:26:09,713 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:26:09,787 - DEBUG - Initial edge attributes tensor shape: torch.Size([1521, 10])
2025-06-02 15:26:09,790 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:26:09,790 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1521, 10])
2025-06-02 15:26:09,791 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:26:09,791 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:26:09,794 - INFO - Updated main graph to 715 nodes and 1521 edges.
2025-06-02 15:26:09,794 - INFO - Performing online update...
2025-06-02 15:26:09,795 - INFO - Starting online update for 25 steps.
2025-06-02 15:26:09,796 - DEBUG - Updated RunningStats: new_mean=0.9411957479889629, new_var=13200000000160.975, new_n=1350
2025-06-02 15:26:09,796 - DEBUG - Updated RunningStats: new_mean=0.9367650206579131, new_var=13500000000019.027, new_n=1380
2025-06-02 15:26:09,797 - DEBUG - Updated RunningStats: new_mean=42.42399321903783, new_var=4400000191002.168, new_n=450
2025-06-02 15:26:09,797 - DEBUG - Updated RunningStats: new_mean=42.54423701092599, new_var=4500000200612.566, new_n=460
2025-06-02 15:26:09,798 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:26:09,798 - DEBUG - Online update step: 1/25
2025-06-02 15:26:09,798 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,798 - DEBUG - Online update step: 2/25
2025-06-02 15:26:09,798 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,798 - DEBUG - Online update step: 3/25
2025-06-02 15:26:09,799 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,799 - DEBUG - Online update step: 4/25
2025-06-02 15:26:09,799 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,799 - DEBUG - Online update step: 5/25
2025-06-02 15:26:09,799 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,799 - DEBUG - Online update step: 6/25
2025-06-02 15:26:09,800 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,800 - DEBUG - Online update step: 7/25
2025-06-02 15:26:09,800 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,800 - DEBUG - Online update step: 8/25
2025-06-02 15:26:09,800 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,800 - DEBUG - Online update step: 9/25
2025-06-02 15:26:09,801 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,801 - DEBUG - Online update step: 10/25
2025-06-02 15:26:09,801 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,801 - DEBUG - Online update step: 11/25
2025-06-02 15:26:09,801 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,801 - DEBUG - Online update step: 12/25
2025-06-02 15:26:09,801 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,802 - DEBUG - Online update step: 13/25
2025-06-02 15:26:09,802 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,802 - DEBUG - Online update step: 14/25
2025-06-02 15:26:09,802 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,802 - DEBUG - Online update step: 15/25
2025-06-02 15:26:09,802 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,803 - DEBUG - Online update step: 16/25
2025-06-02 15:26:09,803 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,803 - DEBUG - Online update step: 17/25
2025-06-02 15:26:09,803 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,803 - DEBUG - Online update step: 18/25
2025-06-02 15:26:09,803 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,803 - DEBUG - Online update step: 19/25
2025-06-02 15:26:09,804 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,804 - DEBUG - Online update step: 20/25
2025-06-02 15:26:09,804 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,804 - DEBUG - Online update step: 21/25
2025-06-02 15:26:09,804 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,804 - DEBUG - Online update step: 22/25
2025-06-02 15:26:09,805 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,805 - DEBUG - Online update step: 23/25
2025-06-02 15:26:09,805 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,805 - DEBUG - Online update step: 24/25
2025-06-02 15:26:09,805 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,805 - DEBUG - Online update step: 25/25
2025-06-02 15:26:09,806 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:09,806 - WARNING - No successful steps during online update.
2025-06-02 15:26:09,807 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00  2.00071533e-08 -1.09705894e-07
  0.00000000e+00  0.00000000e+00  0.00000000e+00 -2.00071537e-09
 -2.13409646e-08 -1.20042918e-08 -2.93438251e-08 -2.66762057e-09
  2.31608391e+00  2.96083927e+00  1.39860138e-01  4.39300680e+00
  1.20042918e-08  3.52027965e+00  5.65734243e+00  7.60839176e+00
  1.39860138e-01  8.00000000e+00 -1.80064390e-08  2.66762057e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  3.96808559e-08 -2.13409646e-08], current edge mean: [ 8.7780672e-09  4.6051611e+02  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.2540097e-09  2.5080193e-09  1.2540097e-09
  0.0000000e+00  0.0000000e+00]
2025-06-02 15:26:09,807 - DEBUG - Node drift difference: 0.0255, Edge drift difference: 0.0016
2025-06-02 15:26:09,809 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00  2.00071533e-08 -1.09705894e-07
  0.00000000e+00  0.00000000e+00  0.00000000e+00 -2.00071537e-09
 -2.13409646e-08 -1.20042918e-08 -2.93438251e-08 -2.66762057e-09
  2.31608391e+00  2.96083927e+00  1.39860138e-01  4.39300680e+00
  1.20042918e-08  3.52027965e+00  5.65734243e+00  7.60839176e+00
  1.39860138e-01  8.00000000e+00 -1.80064390e-08  2.66762057e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  3.96808559e-08 -2.13409646e-08], edge=[ 8.7780672e-09  4.6051611e+02  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.2540097e-09  2.5080193e-09  1.2540097e-09
  0.0000000e+00  0.0000000e+00]
2025-06-02 15:26:09,810 - DEBUG - Updated reference std: node=[0.         0.         1.0007     1.0007     0.         0.
 0.         1.0007     1.0007     1.0007001  1.0007     1.0007
 1.017057   0.27730066 0.3667061  0.56330985 1.0007001  3.0911584
 2.9346402  1.4961902  0.3667061  0.         1.0007001  1.0007
 0.         0.         0.         0.         1.0007     1.0007    ], edge=[  1.0003289 472.54977     0.          0.          1.0003289   1.0003289
   1.0003289   1.0003289   1.0003289   1.0003289]
2025-06-02 15:26:09,810 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:26:09,810 - INFO - Running anomaly detection...
2025-06-02 15:26:09,811 - INFO - Starting anomaly detection.
2025-06-02 15:26:09,825 - DEBUG - Node reconstruction errors: [17.099329  15.857937  22.660736  18.178988  13.424609  15.870707
 20.959812  17.119051  17.119051  17.94923   17.119051  13.373048
 24.99792   13.547391  16.587     16.680159  13.50432   16.680157
 18.800854  16.249613  15.772454  16.587     15.672727  11.325534
 16.358763  18.131073  16.358763  13.65176   16.689785  16.358763
 13.360988  16.36508   13.375917  18.114843  18.517218  15.26289
 16.19029   16.249615  12.141724  12.143542  17.612915  16.208477
 16.249613  16.935621  17.254477  15.612569  18.01412   11.932544
 16.305534  29.94167   31.482052  17.382538  17.73791   17.172539
 15.806665  12.546075  20.468132  15.538975  17.967054  18.312016
 12.587298  15.130731  15.879991  10.997562  16.22319   15.806659
 16.013622  15.806703  15.879989  15.879991  15.484559  14.959745
 15.910382  15.425927  15.688625  15.056722  16.496283  15.39996
 15.239223  15.3276205 17.172699  14.962634  10.476823  16.749626
 17.077196  11.552064  14.556287  15.319147  16.123991  15.100077
 16.149267  13.783716  11.806869  15.397787  15.402167  26.97271
 16.574133  15.228402  15.234567  15.921811  14.5904255 16.574135
 17.268904  16.371504  11.004525  15.447524  15.727338  12.52498
 12.249529  22.73205   15.869902  16.908684  12.398594  12.559559
 14.867443  14.588011  14.8061695 12.690404  15.521417  15.302459
 15.8342705 11.776136  11.938726  11.13496   16.026974  15.302396
 11.137313  11.330022  14.462228  14.960969  16.320446  16.173855
 15.6960125 13.157546  14.721159  15.838687  16.435116  15.36412
 11.5881605 13.205721  15.975002  14.824901  15.750721  16.036654
 15.975006  14.920521  14.806166  16.400473  15.44686   15.430526
 19.295383  11.146488  15.13397   16.173855  15.66521   12.869609
 15.710054  14.720149  14.5904255 17.488287  15.975006  11.547442
 15.710056  16.320446  14.479438  13.353017  14.490758  14.979282
 11.659221  15.295037  15.2473135 15.2845745 16.06578   25.545237
 15.239944  14.973422  15.336466  15.363105  14.429834  14.429831
 15.324931  11.914523  15.220481  12.083383  12.572982  14.764476
 15.620508  14.729413  15.716475  15.583002  15.342082  15.262634
 16.423063  15.8885    11.587995  16.459574  10.3971195 15.644715
 12.753262  15.296265  15.225074  15.710056  12.462526  15.134739
 15.537176  11.806867  16.053474  14.327956  15.127411  15.015849
 14.347468  14.764475  16.683317  15.240982  16.08192   15.333648
 14.627808  14.806166  14.365052  15.8885    12.382935  15.620509
 15.874341  16.683317  15.710056  15.784842  13.18993   16.015905
 15.073574  12.028977  11.741699  15.987966  15.251881  14.806169
 14.806165  16.459574  15.210195  15.874341  15.710056  16.17124
 12.912353  15.263992  16.212513  15.430523  15.821138  16.14163
 14.686614  15.446858  16.212511  15.667612  16.065783  15.711374
 14.36505   14.940013  14.588008  15.652493  15.583003  14.912451
 15.206244  14.4298315 14.736134  11.526881  16.016031  15.24039
 15.028817  15.282346  15.722092  15.678195  15.722091  14.381837
 12.155685  11.933313  15.185364  15.096408  14.323702  14.429834
 15.34625   15.762431  15.324931  14.996953  14.265759  15.429343
 15.259628  16.599405  14.214784  16.058456  14.200853  11.918452
 11.914524  12.492737  15.22028   16.148933  15.704988  15.821135
 10.95052   14.84983   14.888128  14.429908  16.459574  15.137114
 14.834903  15.023869  14.206258  14.206255  15.0238695 15.023869
 15.023869  14.299803  14.935782  15.0238695 15.0238695 15.164557
 15.023869  15.498974  10.991379  14.976095  15.201863  11.655552
 16.535145  16.430136  15.62419   15.43328   15.84923   14.206255
 15.675175  11.997897  15.065964  14.299805  14.954158  14.954161
 16.420328  16.378521  15.023869  14.323699  15.023869  14.299803
 15.185575  15.513233  15.065963  15.065963  15.0238695 15.285049
 15.065964  15.470178  15.637921  15.722093  14.206255  15.954988
 15.791363  14.983586  15.023869  14.610242  12.232126  14.280768
 15.179788  15.583001  14.826306  15.023869  15.173681  16.419062
 14.34747   15.152681  16.141161  15.908774  14.206263  20.02891
 15.639425  13.620597  14.656789  14.549077  15.1646385 15.932949
 15.164744  12.308032  15.007273  14.978359  15.723846  15.34786
 15.797468  15.0238695 14.206258  11.479982  15.880139  15.206954
 11.479984  14.317248  15.816969  10.914767  14.982545  15.023869
 15.733531  14.193579  14.244695  14.181438  14.897631  14.897633
 14.897631  16.945953  14.912946  17.302357  15.449687  15.218065
 14.897632  14.912946  14.315771  14.244699  15.548611  15.494494
 14.244693  11.377798  14.897631  14.244692  14.912946  14.897633
 14.897633  15.259593  15.12973   14.897633  15.723838  15.500939
 15.470813  15.562985  14.544471  15.828778  11.81709   15.470661
 15.449688  14.817703  11.910276  15.748694  15.531793  15.192923
 14.819387  15.421585  14.897631  14.897633  15.449687  15.998975
 12.487096  15.072522  15.49155   15.171936  16.392553  15.474082
 15.474082  11.461615  15.168819  16.778608  16.778608  15.81976
 15.627486  15.535675  15.841231  14.842809  15.535675  15.572152
 15.828778  15.849619  16.39682   14.54447   14.589297  15.892007
 15.829275  12.370215  15.84962   15.892003  15.247754  14.544467
 12.135218  16.738302  15.247754  14.589298  15.214667  12.599279
 15.204486  14.545202  14.52125   14.589296  15.49155   15.885881
 16.449636  13.080308  15.483052  15.885879  12.363147  15.172747
 15.535675  12.119563  16.065891  13.246548  14.57006   15.4915495
 15.2248125 15.500939  14.535872  15.849619  14.558932  17.53758
 14.842809  15.885881  15.885879  15.50094   15.820465  15.20877
 15.172747  11.893023  14.797647  13.44347   15.841233  15.535675
 11.914337  15.126898  15.126898  15.535675  14.833507  15.535675
 14.797649  14.090285  16.955212  15.142571  14.090282  15.171938
 14.797647  16.778608  15.172747  14.558927  16.009813  11.231397
 14.090282  15.627486  15.535675  14.842809  14.842809  15.885879
 14.558928  14.209172  14.688     16.054737  14.842809  14.979379
 14.842809  14.979379  15.089298  14.090285  15.126898  15.126898
 15.126898  14.812641  15.132066  14.812639  14.812639  14.812641
 14.812641  14.812641  14.812641  14.812641  14.121173  15.1475725
 16.048086  14.812641  14.812641  14.812641  14.812639  14.812639
 14.812641  14.812639  14.812641  14.812641  14.090199  14.812641
 14.812641  14.12117   14.812641  15.535675  12.946431  14.842809
 13.394953  14.534409  17.577908  17.577908  16.001581  13.394953
 14.842809  14.797649  14.797649  14.842809  14.797648  14.842809
 15.342856  14.812641  15.171938  14.842809  15.126898  14.842809
 14.842809  14.797647  14.842809  14.797647  14.842809  14.842809
 14.090283  14.797648  14.842809  14.797649  14.842809  14.842809
 14.842809  15.418303  14.5358715 14.535874  14.812641  14.888121
 12.755853  14.842809  14.797647  15.433166  14.812641  14.797649
 15.982701  14.774989  14.842809  14.842809  14.591683  15.4399805
 15.314994  14.842809  14.121173  14.797647  14.797648  10.717569
 14.812641  14.797649  14.090287  14.81264   14.812641  14.121172
 14.842809  14.842809  15.793066  15.314994  14.856524  15.439976
 16.030119  14.843637  14.843637  12.929231  15.502219  14.812641
 15.124234  14.813084  15.439976  14.971574  15.502222  15.512738
 14.818212  14.81821   14.818212  14.818212  14.818212  14.131169
 14.91771   14.81821   14.818212  14.812641  14.812641  14.812639
 14.843637  15.414407  14.843637  15.285497  14.843637  14.090196
 14.090197  14.812641  14.090196  14.812641  14.843637  15.14049
 14.785857  14.785857  14.818212  15.140487  14.971572  15.303218
 14.812641  14.812639  14.818212  15.512737  14.785857  14.785857
 15.512738  15.154744  14.131171  15.09681   15.162356  14.8007965
 15.473416  15.512738  15.473416  15.154748  15.571323  15.571325
 14.943787  14.871611  14.873467  15.512739  15.512738  15.512738
 15.518752  15.512737  15.512737  15.571325  15.512737  15.512738
 15.512738 ]
2025-06-02 15:26:09,826 - DEBUG - Edge reconstruction errors: [  5.2502217   5.250306   44.24307   ...  13.3429985  13.343001
 535.2436   ]
2025-06-02 15:26:09,829 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152609_update_24.json
2025-06-02 15:26:09,829 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:26:09,843 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152609_update_24.pth
2025-06-02 15:26:09,843 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869815.dot): 0.1605
2025-06-02 15:26:09,843 - WARNING - Detected 10 anomalous nodes (reconstruction-based):
2025-06-02 15:26:09,844 - WARNING -   Node ID: 192.168.27.13, Recon Error: 22.6607, MLP Score: 0.2366
2025-06-02 15:26:09,844 - WARNING -   Node ID: 192.168.27.12, Recon Error: 20.9598, MLP Score: 0.2725
2025-06-02 15:26:09,844 - WARNING -   Node ID: 192.168.27.10, Recon Error: 24.9979, MLP Score: 0.2129
2025-06-02 15:26:09,844 - WARNING -   Node ID: ff02::2, Recon Error: 29.9417, MLP Score: 0.3704
2025-06-02 15:26:09,844 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 31.4821, MLP Score: 0.3682
2025-06-02 15:26:09,844 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-02 15:26:09,845 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2430, MLP Score: 0.0000
2025-06-02 15:26:09,845 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9481, MLP Score: 0.0000
2025-06-02 15:26:09,845 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0468, MLP Score: 0.0000
2025-06-02 15:26:09,846 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7458, MLP Score: 0.0000
2025-06-02 15:26:09,846 - WARNING -   Source: 192.168.27.12, Target: 224.0.0.251, Recon Error: 535.2436, MLP Score: 0.0000
2025-06-02 15:26:09,846 - INFO - 
--- Processing file: nw_graph_encoded_1748869845.dot (Timestamp: 2025-06-02 15:10:45) ---
2025-06-02 15:26:09,846 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869845.dot
2025-06-02 15:26:09,846 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869845.dot'.
2025-06-02 15:26:09,847 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869845.dot
2025-06-02 15:26:09,880 - INFO - Parsed 723 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869845.dot'.
2025-06-02 15:26:09,966 - INFO - Parsed 1547 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869845.dot'.
2025-06-02 15:26:09,967 - INFO - Processing node updates/additions.
2025-06-02 15:26:10,011 - INFO - Processing edge updates/additions.
2025-06-02 15:26:10,155 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:26:10,162 - INFO - Finished updating NetworkX graph.
2025-06-02 15:26:10,165 - DEBUG - Updated graph - Nodes: 723, Edges: 1547
2025-06-02 15:26:10,166 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:26:10,171 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:26:10,316 - DEBUG - Initial node features tensor shape: torch.Size([723, 30])
2025-06-02 15:26:10,320 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:26:10,321 - DEBUG - Node features tensor shape after scaling: torch.Size([723, 30])
2025-06-02 15:26:10,326 - DEBUG - Edge index tensor shape: torch.Size([2, 1547])
2025-06-02 15:26:10,335 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:26:10,405 - DEBUG - Initial edge attributes tensor shape: torch.Size([1547, 10])
2025-06-02 15:26:10,408 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:26:10,408 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1547, 10])
2025-06-02 15:26:10,409 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:26:10,410 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:26:10,412 - INFO - Updated main graph to 723 nodes and 1547 edges.
2025-06-02 15:26:10,413 - INFO - Performing online update...
2025-06-02 15:26:10,413 - INFO - Starting online update for 25 steps.
2025-06-02 15:26:10,414 - DEBUG - Updated RunningStats: new_mean=0.9414760517616573, new_var=13800000000160.807, new_n=1410
2025-06-02 15:26:10,415 - DEBUG - Updated RunningStats: new_mean=0.9372416511682102, new_var=14100000000019.094, new_n=1440
2025-06-02 15:26:10,415 - DEBUG - Updated RunningStats: new_mean=42.61773635225704, new_var=4600000190546.081, new_n=470
2025-06-02 15:26:10,416 - DEBUG - Updated RunningStats: new_mean=42.72083880305888, new_var=4700000197267.158, new_n=480
2025-06-02 15:26:10,416 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:26:10,416 - DEBUG - Online update step: 1/25
2025-06-02 15:26:10,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:10,417 - DEBUG - Online update step: 2/25
2025-06-02 15:26:10,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:10,417 - DEBUG - Online update step: 3/25
2025-06-02 15:26:10,417 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:10,417 - DEBUG - Online update step: 4/25
2025-06-02 15:26:10,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:10,418 - DEBUG - Online update step: 5/25
2025-06-02 15:26:10,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:10,418 - DEBUG - Online update step: 6/25
2025-06-02 15:26:10,418 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:10,418 - DEBUG - Online update step: 7/25
2025-06-02 15:26:10,419 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:10,419 - DEBUG - Online update step: 8/25
2025-06-02 15:26:10,419 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:10,419 - DEBUG - Online update step: 9/25
2025-06-02 15:26:10,419 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:10,419 - DEBUG - Online update step: 10/25
2025-06-02 15:26:10,420 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:10,420 - DEBUG - Online update step: 11/25
2025-06-02 15:26:10,420 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:10,420 - DEBUG - Online update step: 12/25
2025-06-02 15:26:10,420 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:10,420 - DEBUG - Online update step: 13/25
2025-06-02 15:26:10,420 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:10,421 - DEBUG - Online update step: 14/25
2025-06-02 15:26:10,421 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:10,421 - DEBUG - Online update step: 15/25
2025-06-02 15:26:10,421 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:10,421 - DEBUG - Online update step: 16/25
2025-06-02 15:26:10,421 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:10,422 - DEBUG - Online update step: 17/25
2025-06-02 15:26:10,422 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:10,422 - DEBUG - Online update step: 18/25
2025-06-02 15:26:10,422 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:10,422 - DEBUG - Online update step: 19/25
2025-06-02 15:26:10,422 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:10,423 - DEBUG - Online update step: 20/25
2025-06-02 15:26:10,423 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:10,423 - DEBUG - Online update step: 21/25
2025-06-02 15:26:10,423 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:10,423 - DEBUG - Online update step: 22/25
2025-06-02 15:26:10,423 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:10,423 - DEBUG - Online update step: 23/25
2025-06-02 15:26:10,424 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:10,424 - DEBUG - Online update step: 24/25
2025-06-02 15:26:10,424 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:10,424 - DEBUG - Online update step: 25/25
2025-06-02 15:26:10,424 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:10,424 - WARNING - No successful steps during online update.
2025-06-02 15:26:10,426 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  2.9019136e-08  3.4295343e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.1871465e-08
  1.8466723e-08 -6.5952581e-09 -1.3190516e-09  2.9019136e-08
  2.3098202e+00  2.9612725e+00  1.4661135e-01  4.3900414e+00
  6.5952581e-09  3.5532503e+00  5.6334715e+00  7.6044259e+00
  1.4661135e-01  8.0000000e+00  0.0000000e+00 -3.2976292e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.9678662e-09 -1.8466723e-08], current edge mean: [-8.6305372e-09  4.5998706e+02  0.0000000e+00  0.0000000e+00
  0.0000000e+00  2.4658677e-09 -2.4658677e-09 -1.5411673e-09
 -4.3152686e-09  2.4658677e-09]
2025-06-02 15:26:10,427 - DEBUG - Node drift difference: 0.0184, Edge drift difference: 0.0011
2025-06-02 15:26:10,428 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  2.9019136e-08  3.4295343e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.1871465e-08
  1.8466723e-08 -6.5952581e-09 -1.3190516e-09  2.9019136e-08
  2.3098202e+00  2.9612725e+00  1.4661135e-01  4.3900414e+00
  6.5952581e-09  3.5532503e+00  5.6334715e+00  7.6044259e+00
  1.4661135e-01  8.0000000e+00  0.0000000e+00 -3.2976292e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.9678662e-09 -1.8466723e-08], edge=[-8.6305372e-09  4.5998706e+02  0.0000000e+00  0.0000000e+00
  0.0000000e+00  2.4658677e-09 -2.4658677e-09 -1.5411673e-09
 -4.3152686e-09  2.4658677e-09]
2025-06-02 15:26:10,429 - DEBUG - Updated reference std: node=[0.         0.         1.0006922  1.0006922  0.         0.
 0.         1.0006924  1.0006922  1.0006924  1.0006922  1.0006922
 1.0100604  0.27579054 0.37301496 0.5619617  1.0006924  3.101849
 2.9398093  1.5029361  0.37301496 0.         1.0006922  1.0006924
 0.         0.         0.         0.         1.0006922  1.0006924 ], edge=[  1.0003234 468.66428     0.          0.          1.0003234   1.0003233
   1.0003234   1.0003234   1.0003234   1.0003234]
2025-06-02 15:26:10,429 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:26:10,429 - INFO - Running anomaly detection...
2025-06-02 15:26:10,430 - INFO - Starting anomaly detection.
2025-06-02 15:26:10,461 - DEBUG - Node reconstruction errors: [17.175024  15.895319  22.786009  18.173674  13.428418  15.8826475
 21.072529  17.11645   17.11645   17.947601  17.11645   13.386552
 25.15985   13.566015  16.592472  16.67672   13.520746  16.676723
 18.82102   16.254236  15.79297   16.592472  15.688819  11.344054
 16.368496  18.134918  16.368494  13.665515  16.695372  16.368498
 13.417416  16.375294  13.387477  18.121096  18.523895  15.278483
 16.202732  16.254236  12.170613  12.162164  17.626024  16.220537
 16.254236  16.952354  17.260551  15.631463  18.030413  11.951557
 16.31801   29.944878  31.570803  17.396107  17.748583  17.21726
 15.832577  12.566485  20.476454  15.555806  18.00482   18.352507
 12.618078  15.147777  15.897098  11.02138   16.237772  15.832574
 16.037779  15.83262   15.897098  15.897098  15.505711  14.984986
 15.930926  15.444528  15.69917   15.080998  16.516817  15.426402
 15.259646  15.347107  17.194445  14.995627  10.505476  16.774714
 17.088896  11.57961   14.579224  15.340415  16.14287   15.132001
 16.17254   13.803239  11.829759  15.421405  15.428848  27.06211
 16.59544   15.247     15.25955   15.946252  14.61917   16.595442
 17.294228  16.404215  11.027451  15.469081  15.744509  11.510437
 12.275217  22.611996  15.868362  16.933294  12.423854  12.589801
 14.897414  14.612624  14.83557   12.702435  15.542749  15.327257
 15.859209  11.793628  11.959113  11.154905  16.04788   15.327195
 11.16046   11.353788  14.490638  14.98284   16.34665   16.198929
 15.719243  13.184921  14.750317  15.863317  16.458506  15.387117
 11.61521   13.236289  15.993378  14.852894  15.775728  16.060593
 15.997132  14.950071  14.835572  16.42457   15.472379  15.451559
 19.32406   11.172354  15.155809  16.19893   15.681412  12.886152
 15.73167   14.751081  14.619166  17.512415  15.997132  11.568273
 15.73167   16.34665   14.507995  13.371733  14.519429  14.998522
 11.677431  15.3104105 15.265233  15.30629   16.08967   25.645172
 15.258782  15.007219  15.359373  15.391967  14.458043  14.45804
 15.345613  11.937789  15.246055  12.106932  12.581555  14.607219
 15.645526  14.76059   15.741125  15.603501  15.368972  15.28504
 16.439629  15.910486  11.615049  16.480541  10.429603  15.667472
 12.76645   15.315252  15.251474  15.73167   12.492114  15.153784
 15.568961  11.82976   16.07891   14.336     15.152966  15.037685
 14.375401  14.793438  16.70655   15.264192  16.09657   15.354492
 14.658113  14.835572  14.393812  15.910486  12.41296   15.645527
 15.89896   16.70655   15.731669  15.804473  13.205937  16.037521
 15.091941  12.044422  11.75598   16.009975  15.270127  14.83557
 14.835573  16.480541  15.2310095 15.89896   15.73167   16.18861
 12.926932  15.285406  16.237328  15.451559  15.843312  16.152838
 14.717463  15.474424  16.237328  15.692312  16.08967   15.732467
 14.393807  14.955512  14.61262   15.682871  15.603501  14.936655
 15.223403  14.458042  14.75537   11.55108   16.03809   15.26515
 15.048771  15.308053  15.745698  15.789616  15.745697  14.407771
 12.177645  11.955063  15.211477  15.113017  14.352645  14.45804
 15.369758  15.782629  15.345614  15.008917  14.283533  15.45365
 15.277575  16.62496   14.240141  16.083935  14.230181  11.939526
 11.937788  12.526708  15.242959  16.170519  15.730564  15.843312
 10.973262  14.86937   14.903853  14.458123  16.480541  14.920505
 14.849272  15.048565  14.234194  14.234197  15.048565  15.048565
 15.048568  14.327847  14.9601965 15.048565  15.048565  15.186175
 15.048565  15.516931  11.018031  14.996794  15.225087  11.674618
 16.557943  16.449427  15.6476555 15.454327  15.866614  14.234193
 15.699415  12.021069  15.090746  14.327847  14.975918  14.975919
 16.446423  16.397373  15.048568  14.352646  15.048565  14.327844
 15.204444  15.535615  15.090744  15.090746  15.048568  15.307208
 15.090746  15.479842  15.659927  15.745697  14.234195  15.980915
 15.807978  15.001657  15.048565  14.637453  12.25993   14.305984
 15.201989  15.603502  14.847417  15.048565  15.198001  16.436827
 14.3754    15.174846  16.151005  15.932395  14.234197  20.105425
 15.664987  13.632036  14.684588  14.574629  15.186265  15.955892
 15.186373  12.332232  15.029547  15.040804  15.748565  15.373082
 15.563642  15.048568  14.234191  11.496542  15.903556  15.221196
 11.496547  14.344317  15.841616  10.937383  15.005721  15.048565
 15.76385   14.215942  14.269738  14.202389  14.918189  14.918189
 14.918192  16.990284  14.93628   17.348244  15.46561   15.244008
 14.918192  14.936278  14.341291  14.269743  15.565015  15.514792
 14.269742  11.405095  14.918189  14.269736  14.93628   14.918192
 14.918189  15.277778  15.151042  14.918192  15.748562  15.522688
 15.490032  15.583439  14.568527  15.849396  11.829629  15.489875
 15.46561   14.838776  11.93118   15.769166  15.546954  15.208783
 14.841822  15.445817  14.918192  14.918192  15.46561   16.014278
 12.50252   15.092222  15.511809  15.192989  16.405912  15.487865
 15.487863  11.479002  15.188817  16.800497  16.800497  15.838523
 15.639581  15.557699  15.861814  14.863576  15.557699  15.586401
 15.849396  15.871295  16.412369  14.568525  14.615004  15.915968
 15.846569  12.391439  15.871293  15.915967  15.268078  14.568526
 12.149659  16.75752   15.268076  14.615008  15.229884  12.631221
 15.214842  14.569292  14.542923  14.615006  15.511808  15.908306
 16.47377   13.090459  15.49858   15.908306  12.385272  15.191461
 15.557699  12.141509  16.086     13.2799635 14.596631  15.511809
 15.238173  15.522688  14.555299  15.871293  14.580296  17.585104
 14.863576  15.908306  15.908306  15.522686  15.836211  15.229638
 15.191461  11.908631  14.816679  13.46933   15.861812  15.557702
 11.926221  15.146132  15.146134  15.557702  14.853855  15.557699
 14.816679  14.112769  16.972631  15.161834  14.112772  15.192988
 14.816679  16.800495  15.191461  14.580291  16.029596  11.253355
 14.112769  15.639581  15.557702  14.863576  14.863576  15.908306
 14.580293  14.230586  14.703746  16.067896  14.863576  14.99858
 14.863576  14.998582  15.112429  14.112772  15.146133  15.146134
 15.146134  14.8295965 15.163833  14.8296    14.8295965 14.8295965
 14.8296    14.8295965 14.8295965 14.8296    14.141461  15.163227
 16.064154  14.8295965 14.8295965 14.8295965 14.8296    14.8296
 14.8295965 14.8296    14.8295965 14.8295965 14.107993  14.8295965
 14.8296    14.14146   14.8295965 15.557699  12.938572  14.863574
 13.383334  14.550933  17.564568  17.564568  16.015081  13.383334
 14.863574  14.816679  14.816679  14.863576  14.816679  14.863576
 15.361553  14.8295965 15.192989  14.863576  15.146134  14.863575
 14.863576  14.816679  14.863575  14.816679  14.863576  14.863576
 14.112772  14.816678  14.863575  14.816679  14.863576  14.863576
 14.863576  15.429347  14.555298  14.555299  14.8295965 14.905842
 12.748143  14.863576  14.816679  15.443804  14.8296    14.816679
 15.99086   14.792254  14.863576  14.863576  14.595304  15.448716
 15.334966  14.863576  14.14146   14.816679  14.816679  10.733332
 14.8295965 14.816679  14.112771  14.8296    14.8295965 14.141462
 14.863575  14.863575  15.800839  15.334964  14.871477  15.448716
 16.0452    14.859128  14.859128  12.916966  15.520204  14.8295965
 15.138356  14.823329  15.448715  14.229053  15.520204  15.525481
 14.831275  14.831272  14.831275  14.831275  14.831275  14.142924
 14.932308  14.831275  14.831272  14.8296    14.8295965 14.8296
 14.859128  15.420889  14.859128  15.302783  14.859128  14.107995
 14.107995  14.8295965 14.107996  14.8295965 14.859127  15.154918
 14.801789  14.801791  14.831274  15.154918  15.618637  15.314834
 14.8295965 14.8296    14.831275  15.525481  14.801791  14.801789
 15.525481  15.16367   14.142925  15.123627  15.167935  13.285706
 15.059653  15.525481  15.483232  15.16367   15.577314  15.577316
 14.946972  14.878153  14.883503  15.525481  15.525482  15.525481
 15.527911  15.525481  15.525482  15.577315  15.525481  15.525481
 15.525481  15.08074   15.215938  15.6904745 15.690474  15.08074
 15.935935  15.577317  15.08074  ]
2025-06-02 15:26:10,462 - DEBUG - Edge reconstruction errors: [  5.2505517   5.2514286  44.243492  ...  13.343422   13.343424
 535.2442   ]
2025-06-02 15:26:10,465 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152610_update_25.json
2025-06-02 15:26:10,465 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:26:10,481 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152610_update_25.pth
2025-06-02 15:26:10,482 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869845.dot): 0.1596
2025-06-02 15:26:10,482 - WARNING - Detected 10 anomalous nodes (reconstruction-based):
2025-06-02 15:26:10,482 - WARNING -   Node ID: 192.168.27.13, Recon Error: 22.7860, MLP Score: 0.2371
2025-06-02 15:26:10,482 - WARNING -   Node ID: 192.168.27.12, Recon Error: 21.0725, MLP Score: 0.2733
2025-06-02 15:26:10,482 - WARNING -   Node ID: 192.168.27.10, Recon Error: 25.1598, MLP Score: 0.2129
2025-06-02 15:26:10,483 - WARNING -   Node ID: ff02::2, Recon Error: 29.9449, MLP Score: 0.3707
2025-06-02 15:26:10,483 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 31.5708, MLP Score: 0.3685
2025-06-02 15:26:10,483 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-02 15:26:10,483 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2434, MLP Score: 0.0000
2025-06-02 15:26:10,484 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9484, MLP Score: 0.0000
2025-06-02 15:26:10,484 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0472, MLP Score: 0.0000
2025-06-02 15:26:10,484 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7462, MLP Score: 0.0000
2025-06-02 15:26:10,484 - WARNING -   Source: 192.168.27.12, Target: 224.0.0.251, Recon Error: 535.2442, MLP Score: 0.0000
2025-06-02 15:26:10,484 - INFO - 
--- Processing file: nw_graph_encoded_1748869875.dot (Timestamp: 2025-06-02 15:11:15) ---
2025-06-02 15:26:10,485 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869875.dot
2025-06-02 15:26:10,485 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869875.dot'.
2025-06-02 15:26:10,485 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869875.dot
2025-06-02 15:26:10,513 - INFO - Parsed 730 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869875.dot'.
2025-06-02 15:26:10,596 - INFO - Parsed 1559 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869875.dot'.
2025-06-02 15:26:10,597 - INFO - Processing node updates/additions.
2025-06-02 15:26:10,629 - INFO - Processing edge updates/additions.
2025-06-02 15:26:10,772 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:26:10,777 - INFO - Finished updating NetworkX graph.
2025-06-02 15:26:10,780 - DEBUG - Updated graph - Nodes: 730, Edges: 1559
2025-06-02 15:26:10,781 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:26:10,786 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:26:10,931 - DEBUG - Initial node features tensor shape: torch.Size([730, 30])
2025-06-02 15:26:10,934 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:26:10,935 - DEBUG - Node features tensor shape after scaling: torch.Size([730, 30])
2025-06-02 15:26:10,940 - DEBUG - Edge index tensor shape: torch.Size([2, 1559])
2025-06-02 15:26:10,949 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:26:11,020 - DEBUG - Initial edge attributes tensor shape: torch.Size([1559, 10])
2025-06-02 15:26:11,023 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:26:11,023 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1559, 10])
2025-06-02 15:26:11,024 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:26:11,024 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:26:11,027 - INFO - Updated main graph to 730 nodes and 1559 edges.
2025-06-02 15:26:11,027 - INFO - Performing online update...
2025-06-02 15:26:11,028 - INFO - Starting online update for 25 steps.
2025-06-02 15:26:11,029 - DEBUG - Updated RunningStats: new_mean=0.9417411459336562, new_var=14400000000160.809, new_n=1470
2025-06-02 15:26:11,029 - DEBUG - Updated RunningStats: new_mean=0.9376691856178527, new_var=14700000000019.037, new_n=1500
2025-06-02 15:26:11,030 - DEBUG - Updated RunningStats: new_mean=42.79806008047822, new_var=4800000194781.938, new_n=490
2025-06-02 15:26:11,030 - DEBUG - Updated RunningStats: new_mean=42.98318271685465, new_var=4900000237473.236, new_n=500
2025-06-02 15:26:11,030 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:26:11,031 - DEBUG - Online update step: 1/25
2025-06-02 15:26:11,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:11,031 - DEBUG - Online update step: 2/25
2025-06-02 15:26:11,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:11,031 - DEBUG - Online update step: 3/25
2025-06-02 15:26:11,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:11,032 - DEBUG - Online update step: 4/25
2025-06-02 15:26:11,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:11,032 - DEBUG - Online update step: 5/25
2025-06-02 15:26:11,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:11,032 - DEBUG - Online update step: 6/25
2025-06-02 15:26:11,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:11,033 - DEBUG - Online update step: 7/25
2025-06-02 15:26:11,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:11,033 - DEBUG - Online update step: 8/25
2025-06-02 15:26:11,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:11,033 - DEBUG - Online update step: 9/25
2025-06-02 15:26:11,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:11,033 - DEBUG - Online update step: 10/25
2025-06-02 15:26:11,034 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:11,034 - DEBUG - Online update step: 11/25
2025-06-02 15:26:11,034 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:11,034 - DEBUG - Online update step: 12/25
2025-06-02 15:26:11,034 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:11,034 - DEBUG - Online update step: 13/25
2025-06-02 15:26:11,035 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:11,035 - DEBUG - Online update step: 14/25
2025-06-02 15:26:11,035 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:11,035 - DEBUG - Online update step: 15/25
2025-06-02 15:26:11,035 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:11,035 - DEBUG - Online update step: 16/25
2025-06-02 15:26:11,036 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:11,036 - DEBUG - Online update step: 17/25
2025-06-02 15:26:11,036 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:11,036 - DEBUG - Online update step: 18/25
2025-06-02 15:26:11,036 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:11,036 - DEBUG - Online update step: 19/25
2025-06-02 15:26:11,037 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:11,037 - DEBUG - Online update step: 20/25
2025-06-02 15:26:11,037 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:11,037 - DEBUG - Online update step: 21/25
2025-06-02 15:26:11,037 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:11,037 - DEBUG - Online update step: 22/25
2025-06-02 15:26:11,037 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:11,038 - DEBUG - Online update step: 23/25
2025-06-02 15:26:11,038 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:11,038 - DEBUG - Online update step: 24/25
2025-06-02 15:26:11,038 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:11,038 - DEBUG - Online update step: 25/25
2025-06-02 15:26:11,038 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:11,039 - WARNING - No successful steps during online update.
2025-06-02 15:26:11,040 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -6.5320158e-08  1.1757629e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  6.2054153e-09
 -4.1804903e-08 -3.9192094e-09 -7.8384188e-09  6.5320158e-09
  2.3013699e+00  2.9589040e+00  1.4657535e-01  4.3876715e+00
  3.9192094e-09  3.5342467e+00  5.6561642e+00  7.5999999e+00
  1.4657535e-01  8.0000000e+00  1.1104427e-08  2.4168459e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.1151701e-08  0.0000000e+00], current edge mean: [ 1.2234437e-09  4.6504681e+02  0.0000000e+00  0.0000000e+00
  3.6703309e-09 -4.8937747e-09  1.2234437e-09 -4.8937747e-09
  4.8937747e-09  0.0000000e+00]
2025-06-02 15:26:11,040 - DEBUG - Node drift difference: 0.0086, Edge drift difference: 0.0108
2025-06-02 15:26:11,042 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -6.5320158e-08  1.1757629e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  6.2054153e-09
 -4.1804903e-08 -3.9192094e-09 -7.8384188e-09  6.5320158e-09
  2.3013699e+00  2.9589040e+00  1.4657535e-01  4.3876715e+00
  3.9192094e-09  3.5342467e+00  5.6561642e+00  7.5999999e+00
  1.4657535e-01  8.0000000e+00  1.1104427e-08  2.4168459e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.1151701e-08  0.0000000e+00], edge=[ 1.2234437e-09  4.6504681e+02  0.0000000e+00  0.0000000e+00
  3.6703309e-09 -4.8937747e-09  1.2234437e-09 -4.8937747e-09
  4.8937747e-09  0.0000000e+00]
2025-06-02 15:26:11,043 - DEBUG - Updated reference std: node=[0.         0.         1.0006856  1.0006857  0.         0.
 0.         1.0006856  1.0006857  1.0006857  1.0006856  1.0006856
 1.0018492  0.28392488 0.37280026 0.56569636 1.0006857  3.0937886
 2.9347494  1.5104574  0.37280026 0.         1.0006857  1.0006857
 0.         0.         0.         0.         1.0006856  1.0006856 ], edge=[  1.0003209 513.5397      0.          0.          1.0003209   1.0003209
   1.0003208   1.0003208   1.0003209   1.0003209]
2025-06-02 15:26:11,043 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:26:11,043 - INFO - Running anomaly detection...
2025-06-02 15:26:11,044 - INFO - Starting anomaly detection.
2025-06-02 15:26:11,060 - DEBUG - Node reconstruction errors: [17.160007  15.846402  22.633915  18.15005   13.427026  15.874722
 20.93225   17.087887  17.087887  17.912664  17.087887  13.374615
 24.90929   13.544995  16.581842  16.650824  13.530356  16.650826
 18.687857  16.242832  15.811437  16.581842  15.707374  11.362257
 16.366552  18.119894  16.366552  13.681013  16.681692  16.366552
 13.317537  15.715657  13.401771  18.110073  18.505373  15.301708
 16.187319  16.24283   12.182461  12.185682  17.627285  16.220514
 16.24283   16.975431  17.250061  15.659299  18.055534  11.96152
 16.316721  29.99185   31.655148  17.391401  17.74565   17.141989
 15.858126  12.576032  20.483543  15.568357  17.908875  17.426935
 12.626999  15.174584  15.90702   11.038834  16.252253  15.85812
 16.065035  15.858164  15.907018  15.90702   15.532207  14.981841
 15.959482  15.4436865 15.700208  15.075678  16.546747  15.432131
 15.259886  15.347412  17.213484  15.002425  10.528229  16.78795
 17.112526  11.596871  14.582688  15.344382  16.140127  15.139232
 16.196575  13.8191395 11.856237  15.424046  15.462005  27.13749
 16.620295  15.243954  15.287504  15.972342  14.625829  16.620295
 17.324316  16.402922  11.053137  15.502772  15.778649  11.527688
 12.300833  22.656725  15.89279   16.960754  12.449479  12.616886
 14.902818  14.620667  14.841207  12.721281  15.544146  15.357038
 15.891593  11.821174  11.981876  11.188696  16.054955  15.35698
 11.18939   11.372152  14.506054  15.015714  16.37463   16.229198
 15.745846  13.18919   14.757322  15.892816  16.4904    15.4126005
 11.638861  13.251821  16.01076   14.861669  15.807452  16.088078
 16.017504  14.953493  14.8412075 16.449617  15.501416  15.454222
 19.34328   11.204671  15.154836  16.229198  13.480079  12.911709
 15.765477  14.761401  14.625826  17.537138  16.017504  11.589744
 15.765477  16.37463   14.516371  13.381993  14.522796  15.0033655
 11.695408  15.312067  15.266141  15.33479   16.115147  25.737444
 15.258427  15.0253935 15.36224   15.398464  14.467198  14.467195
 15.38024   11.963758  15.286632  12.13483   12.595136  14.612184
 15.676282  14.768655  15.769168  15.638046  15.371703  15.288798
 16.466713  15.940423  11.638718  16.511606  10.4566965 15.6975565
 12.787228  15.352294  15.283627  15.765475  12.512676  15.157816
 15.576243  11.356733  16.10926   14.119109  15.183925  15.040725
 14.385453  14.799285  16.73343   15.266768  16.107077  15.38856
 14.66847   14.841206  14.402094  15.940423  12.445682  15.676282
 15.929732  16.73343   15.765475  15.807654  13.216399  16.062838
 15.094972  12.05935   11.778046  16.01285   15.270357  14.841206
 14.841206  16.511606  15.233824  15.92973   15.765475  16.21542
 12.938548  15.288408  16.265324  15.45422   15.873267  16.151781
 14.726629  15.482295  16.265322  15.724057  16.115147  15.75822
 14.402094  14.957773  14.620663  15.6900625 15.638045  14.969912
 15.253867  14.467197  14.764216  11.577735  16.071209  15.295386
 15.055053  15.338772  15.749608  15.736989  15.74961   14.421707
 12.205536  11.981974  15.219966  15.143588  14.3606415 14.467196
 15.414237  15.788533  15.38024   15.005839  14.296736  15.49618
 15.282058  16.653091  14.253744  16.112646  14.24115   11.962966
 11.963757  12.553859  15.270649  16.203182  15.758794  15.873267
 10.999891  14.901168  14.911911  14.467276  16.511606  14.952606
 14.852702  15.078272  14.245533  14.245533  15.078272  15.078272
 15.078272  14.334754  14.991552  15.078272  15.078272  15.189908
 15.078272  15.550135  11.038792  15.00601   15.218122  11.7036085
 16.587368  16.47918   15.6540575 15.475295  15.873029  14.245534
 15.724275  12.04965   15.121238  14.334759  14.980506  14.980503
 16.442638  16.427208  15.078272  14.360641  15.078272  14.334752
 15.224894  15.5656    15.121238  15.121238  15.078272  15.339512
 15.121238  15.486278  15.675597  15.749608  14.245538  16.012463
 15.813461  15.00689   15.078272  14.643786  12.290345  14.315505
 15.237012  15.638046  14.879811  15.078272  15.227601  16.45128
 14.385456  15.203837  16.181545  15.939908  14.245543  20.18316
 15.695493  13.64998   14.691172  14.581355  15.189927  15.957754
 15.190033  12.347593  15.034292  15.0545635 15.779742  15.4021635
 15.575954  15.078272  14.245538  11.515253  15.928371  15.222377
 11.51525   15.003261  15.871495  10.964393  15.014301  15.078272
 15.775128  14.222524  14.2793255 14.208495  14.926647  14.926647
 14.926647  16.920017  14.967012  17.279194  15.4934    15.253837
 14.926647  14.967011  14.352419  14.279329  15.574933  15.544984
 14.279325  11.430242  14.926647  14.279327  14.967011  14.926647
 14.926647  15.306978  15.186112  14.926647  15.779749  15.551469
 15.519841  15.616297  14.573642  15.870863  11.8560915 15.519693
 15.4934    14.844372  11.953824  15.803882  15.5564785 15.23771
 14.855977  15.452393  14.926648  14.926648  15.4934    16.01911
 11.8560915 15.125037  15.539821  15.223281  16.427124  15.510966
 15.510966  11.499447  15.19611   16.82675   16.768862  15.859156
 15.648072  15.58667   15.888321  14.893697  15.58667   15.602339
 15.870865  15.897783  16.433498  14.573643  14.620158  15.944516
 15.864492  12.419152  15.864492  15.944517  15.301638  14.573642
 12.161237  16.781603  15.30164   14.620161  15.23195   12.623781
 15.213677  14.574359  14.547195  14.620158  15.539821  15.935214
 16.500631  13.094833  15.522963  15.935214  12.398471  15.222683
 15.586669  12.1618805 16.117075  13.307718  14.603515  15.539823
 15.238824  15.551471  14.557034  15.897783  14.583416  17.516762
 14.893696  15.935214  16.794775  15.551471  15.853129  15.274005
 15.222683  11.927719  14.846157  13.479107  15.888321  15.58667
 11.940847  15.1755085 15.1755085 15.586669  14.866378  15.58667
 14.846154  14.1235485 16.995428  15.168631  14.123546  15.22328
 14.846155  16.82675   15.222683  14.583416  16.056818  11.279901
 14.1235485 15.64807   15.58667   14.893697  14.893696  15.935214
 14.583416  14.237978  14.7111    16.071539  14.893697  15.008091
 14.893696  15.008091  15.149716  14.123545  15.1755085 15.1755085
 15.175509  14.855524  15.1914425 14.855521  14.855521  14.855524
 14.855521  14.855524  14.855521  14.855524  14.148527  15.19137
 16.091784  14.855524  14.855521  14.855524  14.855524  14.855521
 14.855521  14.855521  14.855521  14.855524  14.115718  14.855521
 14.855521  14.148528  14.855524  15.58667   12.959576  14.893697
 13.402003  14.550695  17.574947  17.574947  16.018885  13.402003
 14.893696  14.846155  14.846154  14.893696  14.846157  14.893697
 15.400348  14.855521  15.22328   14.893696  15.1755085 14.893696
 14.893696  14.846157  14.893696  14.846154  14.893696  14.893696
 14.1235485 14.846154  14.893696  14.846157  14.893696  14.893697
 14.893697  15.437568  14.557032  14.557028  14.855521  14.934957
 12.770781  14.893696  14.846154  15.451589  14.855521  14.846154
 15.991534  14.817825  14.893696  14.893697  14.594455  15.454672
 15.342299  14.893697  14.148526  14.846155  14.846157  10.760531
 14.855521  14.846154  14.1235485 14.855521  14.855521  14.148525
 14.893696  14.893696  15.822199  15.342299  14.879989  15.454669
 16.070127  14.860631  14.860633  12.933301  15.546225  14.855524
 15.164581  14.822281  15.454672  14.228388  15.546225  15.546317
 14.850768  14.850772  14.850769  14.850772  14.85077   14.145735
 14.938186  14.850772  14.850772  14.855521  14.855524  14.855524
 14.860631  15.425211  14.860633  15.329616  14.860633  14.232188
 14.115716  14.855524  14.115718  14.855521  14.860633  15.183337
 14.823894  14.823894  14.850772  15.183337  15.611742  15.33748
 14.855521  14.855521  14.850772  15.546319  14.8238945 14.8238945
 15.546317  15.186396  14.145734  15.148752  15.187263  13.292367
 15.057408  15.546317  15.504954  15.186396  15.590635  15.590635
 14.940701  14.890634  14.882749  15.546317  15.546317  15.546317
 15.544889  15.546317  15.546317  15.590635  15.546319  15.546317
 15.54632   15.073481  15.231963  15.682824  15.7043085 15.073481
 15.94452   15.590635  15.704311  16.92323   15.675446  15.315797
 15.67545   15.113485  15.113484  15.590633 ]
2025-06-02 15:26:11,061 - DEBUG - Edge reconstruction errors: [  5.2512536   5.252081   44.244698  ...  13.344632   13.344634
 535.24536  ]
2025-06-02 15:26:11,064 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152611_update_26.json
2025-06-02 15:26:11,065 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:26:11,081 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152611_update_26.pth
2025-06-02 15:26:11,081 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869875.dot): 0.1623
2025-06-02 15:26:11,081 - WARNING - Detected 10 anomalous nodes (reconstruction-based):
2025-06-02 15:26:11,082 - WARNING -   Node ID: 192.168.27.13, Recon Error: 22.6339, MLP Score: 0.2353
2025-06-02 15:26:11,082 - WARNING -   Node ID: 192.168.27.12, Recon Error: 20.9322, MLP Score: 0.2697
2025-06-02 15:26:11,082 - WARNING -   Node ID: 192.168.27.10, Recon Error: 24.9093, MLP Score: 0.2113
2025-06-02 15:26:11,082 - WARNING -   Node ID: ff02::2, Recon Error: 29.9918, MLP Score: 0.3711
2025-06-02 15:26:11,082 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 31.6551, MLP Score: 0.3688
2025-06-02 15:26:11,083 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 15:26:11,083 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2447, MLP Score: 0.0000
2025-06-02 15:26:11,083 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9493, MLP Score: 0.0000
2025-06-02 15:26:11,083 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0482, MLP Score: 0.0000
2025-06-02 15:26:11,084 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7473, MLP Score: 0.0000
2025-06-02 15:26:11,084 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7456, MLP Score: 0.0000
2025-06-02 15:26:11,091 - DEBUG - Embedding standard deviations before t-SNE: [9.7164971e-01 1.5860574e-01 0.0000000e+00 5.1009333e-01 9.9382170e-02
 0.0000000e+00 4.4471803e-01 6.2395591e-01 0.0000000e+00 6.5065700e-01
 0.0000000e+00 0.0000000e+00 0.0000000e+00 2.1501198e-02 5.7463646e-01
 4.0707645e-01 1.4987707e-01 6.6322494e-01 0.0000000e+00 7.3608112e-01
 0.0000000e+00 5.8632994e-01 0.0000000e+00 0.0000000e+00 0.0000000e+00
 0.0000000e+00 5.0661135e-01 7.0071721e-01 4.3870360e-03 4.4284551e-04
 5.6945932e-01 3.6742684e-01]
2025-06-02 15:26:12,029 - INFO - Embeddings visualization saved to vis/embeddings_26_updates_20250602_152611.png
2025-06-02 15:26:12,030 - INFO - Performing visualization of node and edge features.
2025-06-02 15:26:12,035 - INFO - Starting visualization of node features.
2025-06-02 15:26:12,035 - INFO - Graph has 730 nodes and 30 features.
2025-06-02 15:26:12,036 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:26:12,036 - INFO - Calculating feature statistics:
2025-06-02 15:26:12,036 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:26:12,037 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:26:12,037 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 14, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.5024931), 'max': np.float32(2.2060432)}
2025-06-02 15:26:12,037 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 14, 'mean': np.float32(-4.1804903e-08), 'std': np.float32(0.99999994), 'min': np.float32(-2.137797), 'max': np.float32(2.5623133)}
2025-06-02 15:26:12,038 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:26:12,038 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:26:12,038 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:26:12,039 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(-5.225613e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.43019173), 'max': np.float32(2.3245447)}
2025-06-02 15:26:12,039 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(-4.7030515e-08), 'std': np.float32(1.0), 'min': np.float32(-1.1705256), 'max': np.float32(0.8543171)}
2025-06-02 15:26:12,039 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 3, 'mean': np.float32(1.0451226e-08), 'std': np.float32(1.0), 'min': np.float32(-9.39341), 'max': np.float32(0.10967602)}
2025-06-02 15:26:12,039 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 14, 'mean': np.float32(2.0902451e-08), 'std': np.float32(0.99999994), 'min': np.float32(-3.5601614), 'max': np.float32(1.563953)}
2025-06-02 15:26:12,040 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 14, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.5274093), 'max': np.float32(3.6428556)}
2025-06-02 15:26:12,040 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 8, 'mean': np.float32(2.30137), 'std': np.float32(1.0011629), 'min': np.float32(0.0), 'max': np.float32(11.0)}
2025-06-02 15:26:12,040 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.958904), 'std': np.float32(0.28373036), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:26:12,041 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.14657535), 'std': np.float32(0.37254483), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:26:12,041 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.3876715), 'std': np.float32(0.56530875), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:26:12,041 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 3, 'mean': np.float32(-1.0451226e-08), 'std': np.float32(1.0), 'min': np.float32(-0.10967602), 'max': np.float32(9.39341)}
2025-06-02 15:26:12,042 - INFO - - service_1: {'name': 'service_1', 'unique': 5, 'mean': np.float32(3.5342467), 'std': np.float32(3.091669), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 15:26:12,042 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.656164), 'std': np.float32(2.9327388), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:26:12,042 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.6), 'std': np.float32(1.5094225), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:26:12,043 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.14657535), 'std': np.float32(0.37254483), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:26:12,043 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 1, 'mean': np.float32(8.0), 'std': np.float32(0.0), 'min': np.float32(8.0), 'max': np.float32(8.0)}
2025-06-02 15:26:12,043 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(-7.838419e-09), 'std': np.float32(1.0), 'min': np.float32(-0.13171281), 'max': np.float32(15.049921)}
2025-06-02 15:26:12,043 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(2.874087e-08), 'std': np.float32(1.0), 'min': np.float32(-0.14484136), 'max': np.float32(6.904105)}
2025-06-02 15:26:12,044 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:26:12,044 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:26:12,044 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:26:12,045 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:26:12,045 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(3.6579287e-08), 'std': np.float32(0.9999999), 'min': np.float32(-1.0050753), 'max': np.float32(8.777658)}
2025-06-02 15:26:12,045 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(5.225613e-09), 'std': np.float32(1.0), 'min': np.float32(-1.108116), 'max': np.float32(4.419843)}
2025-06-02 15:26:12,114 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7f929162f020>
2025-06-02 15:26:12,905 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:26:13,296 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:26:13,476 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:26:18,157 - INFO - Node feature visualization saved to vis/node_features_20250602_152614.png
2025-06-02 15:26:18,158 - INFO - Finished visualization of node features.
2025-06-02 15:26:18,158 - INFO - Performing additional feature analysis:
2025-06-02 15:26:18,158 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:26:18,169 - INFO - Starting visualization of edge features.
2025-06-02 15:26:18,169 - INFO - Graph has 1559 edges and 10 edge features.
2025-06-02 15:26:18,169 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:26:18,170 - INFO - Calculating edge feature statistics:
2025-06-02 15:26:18,171 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:26:18,171 - INFO - - count: {'name': 'count', 'unique': 25, 'mean': np.float32(2.4468874e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.045147676), 'max': np.float32(30.35215)}
2025-06-02 15:26:18,172 - INFO - - dst_port: {'name': 'dst_port', 'unique': 16, 'mean': np.float32(465.0468), 'std': np.float32(513.37494), 'min': np.float32(3.0), 'max': np.float32(8898.0)}
2025-06-02 15:26:18,172 - INFO - - protocol: {'name': 'protocol', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:26:18,172 - INFO - - service: {'name': 'service', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:26:18,172 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 1049, 'mean': np.float32(2.4468874e-09), 'std': np.float32(1.0), 'min': np.float32(-0.0737332), 'max': np.float32(29.76732)}
2025-06-02 15:26:18,172 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 1107, 'mean': np.float32(-2.4468874e-09), 'std': np.float32(1.0), 'min': np.float32(-0.06559564), 'max': np.float32(30.237577)}
2025-06-02 15:26:18,172 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 347, 'mean': np.float32(-2.4468874e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.053769764), 'max': np.float32(30.348267)}
2025-06-02 15:26:18,173 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 1081, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.12731944), 'max': np.float32(19.250559)}
2025-06-02 15:26:18,173 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 1095, 'mean': np.float32(1.2234437e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.124131665), 'max': np.float32(20.257381)}
2025-06-02 15:26:18,173 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 404, 'mean': np.float32(-2.4468874e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.06376676), 'max': np.float32(29.849796)}
2025-06-02 15:26:18,245 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7f9290345ca0>
2025-06-02 15:26:18,706 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:26:18,772 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7f92906d89b0>
2025-06-02 15:26:19,156 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:26:19,717 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:26:20,141 - DEBUG - Plotted boxplots of the first 8 non-constant edge features.
2025-06-02 15:26:20,220 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:26:20,252 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:26:24,025 - INFO - Edge feature visualization saved to vis/edge_features_20250602_152620.png
2025-06-02 15:26:24,026 - INFO - Finished visualization of edge features.
2025-06-02 15:26:24,026 - INFO - Performing additional edge feature analysis:
2025-06-02 15:26:24,026 - INFO - - 2 out of 10 edge features are constant.
2025-06-02 15:26:24,027 - INFO - - Highest correlation (1.00) between features: 'count' and 'total_orig_pkts'.
2025-06-02 15:26:24,037 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:26:24,037 - INFO - Graph has 1559 edges and 10 edge features.
2025-06-02 15:26:24,037 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:26:25,516 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_152624_summary.png
2025-06-02 15:26:26,396 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_152624_pca_3d.png
2025-06-02 15:26:26,913 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_152624_pca_variance.png
2025-06-02 15:26:26,914 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:26:26,914 - INFO - 
--- Processing file: nw_graph_encoded_1748869905.dot (Timestamp: 2025-06-02 15:11:45) ---
2025-06-02 15:26:26,915 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869905.dot
2025-06-02 15:26:26,915 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869905.dot'.
2025-06-02 15:26:26,915 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869905.dot
2025-06-02 15:26:26,948 - INFO - Parsed 736 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869905.dot'.
2025-06-02 15:26:27,037 - INFO - Parsed 1571 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869905.dot'.
2025-06-02 15:26:27,037 - INFO - Processing node updates/additions.
2025-06-02 15:26:27,069 - INFO - Processing edge updates/additions.
2025-06-02 15:26:27,201 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:26:27,207 - INFO - Finished updating NetworkX graph.
2025-06-02 15:26:27,210 - DEBUG - Updated graph - Nodes: 736, Edges: 1571
2025-06-02 15:26:27,211 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:26:27,216 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:26:27,364 - DEBUG - Initial node features tensor shape: torch.Size([736, 30])
2025-06-02 15:26:27,374 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:26:27,375 - DEBUG - Node features tensor shape after scaling: torch.Size([736, 30])
2025-06-02 15:26:27,382 - DEBUG - Edge index tensor shape: torch.Size([2, 1571])
2025-06-02 15:26:27,392 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:26:27,464 - DEBUG - Initial edge attributes tensor shape: torch.Size([1571, 10])
2025-06-02 15:26:27,468 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:26:27,470 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1571, 10])
2025-06-02 15:26:27,470 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:26:27,471 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:26:27,474 - INFO - Updated main graph to 736 nodes and 1571 edges.
2025-06-02 15:26:27,474 - INFO - Performing online update...
2025-06-02 15:26:27,475 - INFO - Starting online update for 25 steps.
2025-06-02 15:26:27,476 - DEBUG - Updated RunningStats: new_mean=0.9419710684142605, new_var=15000000000160.754, new_n=1530
2025-06-02 15:26:27,477 - DEBUG - Updated RunningStats: new_mean=0.9380401861293707, new_var=15300000000019.012, new_n=1560
2025-06-02 15:26:27,477 - DEBUG - Updated RunningStats: new_mean=43.05190152233215, new_var=5000000194621.167, new_n=510
2025-06-02 15:26:27,478 - DEBUG - Updated RunningStats: new_mean=43.221247961653724, new_var=5100000235586.076, new_n=520
2025-06-02 15:26:27,478 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:26:27,478 - DEBUG - Online update step: 1/25
2025-06-02 15:26:27,478 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:27,479 - DEBUG - Online update step: 2/25
2025-06-02 15:26:27,479 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:27,479 - DEBUG - Online update step: 3/25
2025-06-02 15:26:27,479 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:27,479 - DEBUG - Online update step: 4/25
2025-06-02 15:26:27,479 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:27,480 - DEBUG - Online update step: 5/25
2025-06-02 15:26:27,480 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:27,480 - DEBUG - Online update step: 6/25
2025-06-02 15:26:27,480 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:27,480 - DEBUG - Online update step: 7/25
2025-06-02 15:26:27,480 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:27,481 - DEBUG - Online update step: 8/25
2025-06-02 15:26:27,481 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:27,481 - DEBUG - Online update step: 9/25
2025-06-02 15:26:27,481 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:27,481 - DEBUG - Online update step: 10/25
2025-06-02 15:26:27,481 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:27,482 - DEBUG - Online update step: 11/25
2025-06-02 15:26:27,482 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:27,482 - DEBUG - Online update step: 12/25
2025-06-02 15:26:27,482 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:27,482 - DEBUG - Online update step: 13/25
2025-06-02 15:26:27,482 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:27,483 - DEBUG - Online update step: 14/25
2025-06-02 15:26:27,483 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:27,483 - DEBUG - Online update step: 15/25
2025-06-02 15:26:27,483 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:27,483 - DEBUG - Online update step: 16/25
2025-06-02 15:26:27,483 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:27,484 - DEBUG - Online update step: 17/25
2025-06-02 15:26:27,484 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:27,484 - DEBUG - Online update step: 18/25
2025-06-02 15:26:27,484 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:27,484 - DEBUG - Online update step: 19/25
2025-06-02 15:26:27,484 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:27,485 - DEBUG - Online update step: 20/25
2025-06-02 15:26:27,485 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:27,485 - DEBUG - Online update step: 21/25
2025-06-02 15:26:27,485 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:27,485 - DEBUG - Online update step: 22/25
2025-06-02 15:26:27,485 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:27,486 - DEBUG - Online update step: 23/25
2025-06-02 15:26:27,486 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:27,486 - DEBUG - Online update step: 24/25
2025-06-02 15:26:27,486 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:27,486 - DEBUG - Online update step: 25/25
2025-06-02 15:26:27,486 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:27,487 - WARNING - No successful steps during online update.
2025-06-02 15:26:27,488 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  4.7942866e-08 -1.6844790e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.1266424e-09
  2.9802322e-08 -9.0702716e-09  1.1661778e-08  2.5915063e-09
  2.2975543e+00  2.9592392e+00  1.4673913e-01  4.3885870e+00
  9.0702716e-09  3.5027175e+00  5.6752715e+00  7.5951085e+00
  1.4673913e-01  8.0000000e+00  2.4619309e-08 -8.4223952e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.4985334e-08 -6.4787656e-08], current edge mean: [-6.6775412e-09  4.6487842e+02  0.0000000e+00  0.0000000e+00
 -3.0352461e-09  1.2140984e-09 -2.4281968e-09 -3.0352461e-09
  2.4281968e-09  4.8563935e-09]
2025-06-02 15:26:27,489 - DEBUG - Node drift difference: 0.0102, Edge drift difference: 0.0003
2025-06-02 15:26:27,491 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  4.7942866e-08 -1.6844790e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.1266424e-09
  2.9802322e-08 -9.0702716e-09  1.1661778e-08  2.5915063e-09
  2.2975543e+00  2.9592392e+00  1.4673913e-01  4.3885870e+00
  9.0702716e-09  3.5027175e+00  5.6752715e+00  7.5951085e+00
  1.4673913e-01  8.0000000e+00  2.4619309e-08 -8.4223952e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.4985334e-08 -6.4787656e-08], edge=[-6.6775412e-09  4.6487842e+02  0.0000000e+00  0.0000000e+00
 -3.0352461e-09  1.2140984e-09 -2.4281968e-09 -3.0352461e-09
  2.4281968e-09  4.8563935e-09]
2025-06-02 15:26:27,492 - DEBUG - Updated reference std: node=[0.         0.         1.0006801  1.0006801  0.         0.
 0.         1.00068    1.00068    1.0006801  1.00068    1.0006801
 0.9868769  0.2827878  0.37280363 0.5652814  1.0006801  3.0891504
 2.9303455  1.5187457  0.37280363 0.         1.0006801  1.0006801
 0.         0.         0.         0.         1.0006801  1.0006801 ], edge=[  1.0003184 511.57693     0.          0.          1.0003184   1.0003184
   1.0003184   1.0003184   1.0003184   1.0003184]
2025-06-02 15:26:27,492 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:26:27,492 - INFO - Running anomaly detection...
2025-06-02 15:26:27,493 - INFO - Starting anomaly detection.
2025-06-02 15:26:27,540 - DEBUG - Node reconstruction errors: [17.200062  15.852176  22.723372  18.114817  13.427933  15.879933
 21.01685   17.055922  17.055922  17.881292  17.055922  13.369574
 25.025204  13.550112  16.561745  16.617052  13.537229  16.617054
 18.669874  16.221886  15.8250265 16.561745  15.721176  11.374699
 16.355013  18.100786  16.355015  13.687323  16.662565  16.355015
 13.355504  15.734599  13.409651  18.091587  18.488262  15.31596
 16.195597  16.221886  12.203932  12.198681  17.619959  16.21102
 16.221886  16.989286  17.23188   15.676174  18.067549  11.97818
 16.308931  30.03177   31.731192  17.384947  17.737816  17.173656
 15.880175  12.5965185 20.54613   15.568595  17.923546  17.453548
 12.651068  15.190597  15.9076805 11.0475645 16.251545  15.880172
 16.08617   15.880209  15.9076805 15.90768   15.552508  14.993949
 15.978262  15.45074   15.706619  15.086619  16.566069  15.451921
 15.271795  15.355165  17.222698  15.028345  10.550123  15.881847
 17.11931   11.606961  14.605824  15.357939  16.147705  15.146777
 16.21012   13.831943  11.874741  15.438919  15.485181  27.199657
 16.633022  15.25791   15.304961  15.9961405 14.647879  16.633022
 17.344753  16.432253  11.075118  15.523793  15.791247  11.565656
 12.320749  22.695576  15.912717  16.97793   12.47397   12.642974
 14.927397  14.6455145 14.866166  12.73131   15.555361  15.380601
 15.911779  11.836521  12.004376  11.205555  16.068071  15.380545
 11.209026  11.396028  14.531906  15.036268  16.397432  16.251167
 15.759437  13.215884  14.783355  15.917341  16.512064  15.425223
 11.664963  13.271981  16.030733  14.887989  15.829185  16.112984
 16.040455  14.975691  14.866168  16.465557  15.523535  15.466865
 19.361998  11.22952   15.164069  16.251167  13.48054   12.923792
 15.786387  14.79076   14.647883  17.551577  16.040457  11.610753
 15.786387  16.39743   14.541001  13.393569  14.54273   15.016613
 11.712582  15.322263  15.274546  15.355819  16.129274  25.818747
 15.2586565 15.054413  15.378493  15.4262085 14.491423  14.491424
 15.401814  11.979196  15.30653   12.154959  12.60267   16.001448
 15.69977   14.793313  15.794454  15.6593895 15.204441  15.304377
 16.485418  15.957675  11.664835  16.533438  10.482111  15.719107
 12.796942  15.370745  15.305556  15.786387  12.540198  15.168985
 15.601722  11.369202  16.131422  14.118988  15.203785  15.05274
 14.411137  14.823071  16.752487  15.284183  16.109623  15.407664
 14.696823  14.866167  14.427807  15.957675  12.471951  15.699773
 15.947562  16.752487  15.786387  15.82055   13.227812  16.076883
 15.106275  12.07278   11.789632  16.02902   15.28299   14.866163
 14.866166  16.53344   15.248949  15.947562  15.786387  16.23332
 12.948728  15.303693  16.285498  15.466868  15.891054  16.158926
 14.754485  15.5075035 16.285498  15.748475  16.129274  15.770297
 14.427805  14.969519  14.645509  15.713968  15.6593895 14.991159
 15.271817  14.491425  14.777174  11.597051  16.086987  15.3192005
 15.070317  15.364034  15.763896  15.803392  15.763896  14.446172
 12.2280245 12.004913  15.237912  15.158403  14.384135  14.491423
 15.433529  15.799868  15.401814  15.013277  14.358521  15.51402
 15.293988  16.67174   14.430289  16.131222  14.263896  11.984643
 11.979196  12.580617  15.292594  16.223797  15.780851  15.891056
 11.021923  14.920397  14.9238825 14.4915    16.533443  14.968807
 14.86487   15.097851  14.270301  14.270298  15.097851  15.097851
 15.097851  14.358047  15.012613  15.097851  15.097851  12.926894
 15.097851  15.570218  11.074112  15.020122  15.241253  11.720783
 16.608377  16.50016   15.669476  15.496095  15.88284   14.270297
 15.7501955 12.071273  15.141164  14.358048  14.992745  14.992747
 16.458641  16.44804   15.097851  14.384131  15.097851  14.3580475
 15.258676  15.581664  15.141164  15.141164  15.097851  15.355062
 15.141164  15.496003  15.692398  15.763895  14.270296  16.033472
 15.819342  15.019803  15.097851  14.66971   12.317187  14.341435
 15.255061  15.6593895 14.899992  15.097851  15.244561  16.46573
 14.411137  15.226697  16.186281  15.956171  14.270303  20.255077
 15.718381  13.659095  14.715341  14.605944  15.204654  15.974064
 15.204756  12.353502  15.049929  15.076048  15.800003  15.424085
 15.585336  15.097851  14.270296  11.532527  15.95401   15.232138
 11.53253   15.023671  15.893117  10.985834  15.033589  15.097851
 15.802206  14.245737  14.303485  14.230475  14.945452  14.945455
 14.945452  16.95631   14.987254  17.316061  15.512531  15.279587
 14.945455  14.987255  14.3775    14.303488  15.585059  15.565991
 14.303484  11.457531  14.945452  14.303483  14.987255  14.945453
 14.945452  15.325835  15.2036295 14.945452  15.8       15.573275
 15.539979  15.636873  14.596563  15.893947  11.868371  15.53984
 15.51253   14.866157  11.973886  15.822579  15.565656  15.256556
 14.877173  15.474936  14.945452  14.945452  15.51253   16.029972
 11.868367  15.143426  15.560421  15.24465   16.791243  15.52602
 15.526018  11.517444  15.225753  15.881848  16.785673  15.880901
 15.656603  15.607977  15.9111185 14.912984  15.607977  15.619609
 15.893948  15.9227085 16.449179  14.596564  14.643461  15.96929
 15.8845005 12.437797  15.8845005 15.96929   15.320884  14.596566
 12.176615  16.80323   15.320884  14.643466  15.242929  12.646057
 15.220631  14.597262  14.567526  14.643464  15.560421  15.958788
 16.523626  13.102319  15.539279  16.801472  12.421247  15.241497
 15.607975  12.184348  16.136621  13.336608  14.627445  15.560423
 15.247624  15.573275  14.575734  15.9227085 14.604597  17.554409
 14.912984  15.958788  16.79124   15.573275  15.871875  15.292512
 15.241497  11.942483  14.864812  13.4994335 15.911117  15.60798
 11.980748  15.196168  15.196168  15.538237  14.885708  15.607977
 14.864812  14.146002  17.013336  15.183433  14.146     15.244648
 14.864811  16.84969   15.241497  14.604595  16.077934  11.300389
 14.146005  15.656603  15.60798   14.912984  14.912984  15.958788
 14.604596  14.260085  14.7220335 16.079176  14.912984  15.027966
 14.912984  15.0279665 15.1730795 14.146001  15.196167  15.196168
 15.196168  14.873934  15.218841  14.873934  14.873935  14.873934
 14.873934  14.873937  14.873935  14.873935  14.168742  15.209225
 16.108345  14.873935  14.873934  14.873935  14.873937  14.873935
 14.873937  14.873935  14.873934  14.873935  14.133933  14.873934
 14.873935  14.168745  14.873935  15.607977  12.933989  14.912982
 13.375061  14.566242  17.535515  17.535515  16.02821   13.375061
 14.912984  14.864811  14.864811  14.912984  14.864811  14.912984
 15.414063  14.873934  15.244649  14.912981  15.196167  14.912984
 14.912984  14.864811  14.912984  14.864813  14.912984  14.912984
 14.146     14.864811  14.912984  14.86481   14.912984  14.912984
 14.912982  15.445449  14.575734  14.575735  14.873934  14.955352
 12.745803  14.912982  14.864812  15.458888  14.873935  14.864813
 15.997234  14.83568   14.912984  14.912984  14.61086   15.460465
 15.362241  14.912984  14.168744  14.86481   14.864811  10.774705
 14.873937  14.864811  14.146005  14.873935  14.873934  14.168745
 14.912984  14.912984  15.82646   15.362243  14.894441  15.460465
 16.087858  14.874411  14.8744135 12.904989  15.565065  14.873935
 15.180985  14.833821  15.460467  14.24348   15.565065  15.560826
 14.865323  14.865323  14.865322  14.865323  14.865322  14.157551
 14.952709  14.865322  14.865323  14.873934  14.873935  14.873937
 14.874411  15.429294  14.8744135 15.347356  14.8744135 14.245014
 14.133936  14.873935  14.133936  14.873934  14.8744135 15.199297
 14.840771  14.840771  14.865323  15.199297  15.614036  15.350788
 14.873935  14.873934  14.865322  15.560828  14.840771  14.840771
 15.560826  15.197787  14.157551  15.172528  15.1954775 13.299875
 15.06952   15.560826  15.518919  15.197787  15.598962  15.59896
 14.946035  14.899044  14.893072  15.560828  15.560827  15.560826
 15.555554  15.560828  15.560826  15.59896   15.560828  15.560827
 15.560827  15.07843   15.237332  15.67763   15.695096  15.07843
 15.955166  15.598959  15.695096  16.937252  15.675277  15.313108
 15.675272  15.112072  15.112072  15.598962  12.359839  16.913095
 15.675273  14.970754  16.255241  15.869948 ]
2025-06-02 15:26:27,541 - DEBUG - Edge reconstruction errors: [  5.251095   5.251899  44.24491  ...  13.344845  13.344847 535.2455  ]
2025-06-02 15:26:27,548 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152627_update_27.json
2025-06-02 15:26:27,549 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:26:27,573 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152627_update_27.pth
2025-06-02 15:26:27,574 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869905.dot): 0.1611
2025-06-02 15:26:27,574 - WARNING - Detected 10 anomalous nodes (reconstruction-based):
2025-06-02 15:26:27,574 - WARNING -   Node ID: 192.168.27.13, Recon Error: 22.7234, MLP Score: 0.2361
2025-06-02 15:26:27,574 - WARNING -   Node ID: 192.168.27.12, Recon Error: 21.0168, MLP Score: 0.2709
2025-06-02 15:26:27,574 - WARNING -   Node ID: 192.168.27.10, Recon Error: 25.0252, MLP Score: 0.2112
2025-06-02 15:26:27,575 - WARNING -   Node ID: ff02::2, Recon Error: 30.0318, MLP Score: 0.3714
2025-06-02 15:26:27,575 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 31.7312, MLP Score: 0.3691
2025-06-02 15:26:27,575 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 15:26:27,575 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2449, MLP Score: 0.0000
2025-06-02 15:26:27,576 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9493, MLP Score: 0.0000
2025-06-02 15:26:27,576 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0483, MLP Score: 0.0000
2025-06-02 15:26:27,576 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7474, MLP Score: 0.0000
2025-06-02 15:26:27,576 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7457, MLP Score: 0.0000
2025-06-02 15:26:27,577 - INFO - 
--- Processing file: nw_graph_encoded_1748869935.dot (Timestamp: 2025-06-02 15:12:15) ---
2025-06-02 15:26:27,577 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869935.dot
2025-06-02 15:26:27,577 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869935.dot'.
2025-06-02 15:26:27,577 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869935.dot
2025-06-02 15:26:27,611 - INFO - Parsed 762 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869935.dot'.
2025-06-02 15:26:27,700 - INFO - Parsed 1619 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869935.dot'.
2025-06-02 15:26:27,700 - INFO - Processing node updates/additions.
2025-06-02 15:26:27,735 - INFO - Processing edge updates/additions.
2025-06-02 15:26:27,874 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:26:27,880 - INFO - Finished updating NetworkX graph.
2025-06-02 15:26:27,883 - DEBUG - Updated graph - Nodes: 762, Edges: 1619
2025-06-02 15:26:27,883 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:26:27,890 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:26:28,048 - DEBUG - Initial node features tensor shape: torch.Size([762, 30])
2025-06-02 15:26:28,051 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:26:28,052 - DEBUG - Node features tensor shape after scaling: torch.Size([762, 30])
2025-06-02 15:26:28,056 - DEBUG - Edge index tensor shape: torch.Size([2, 1619])
2025-06-02 15:26:28,066 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:26:28,142 - DEBUG - Initial edge attributes tensor shape: torch.Size([1619, 10])
2025-06-02 15:26:28,146 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:26:28,146 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1619, 10])
2025-06-02 15:26:28,147 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:26:28,147 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:26:28,150 - INFO - Updated main graph to 762 nodes and 1619 edges.
2025-06-02 15:26:28,150 - INFO - Performing online update...
2025-06-02 15:26:28,151 - INFO - Starting online update for 25 steps.
2025-06-02 15:26:28,152 - DEBUG - Updated RunningStats: new_mean=0.9421525034829301, new_var=15600000000160.803, new_n=1590
2025-06-02 15:26:28,152 - DEBUG - Updated RunningStats: new_mean=0.9383199389642939, new_var=15900000000018.898, new_n=1620
2025-06-02 15:26:28,153 - DEBUG - Updated RunningStats: new_mean=43.281234894827485, new_var=5200000193870.212, new_n=530
2025-06-02 15:26:28,153 - DEBUG - Updated RunningStats: new_mean=43.426096402709874, new_var=5300000228543.337, new_n=540
2025-06-02 15:26:28,154 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:26:28,154 - DEBUG - Online update step: 1/25
2025-06-02 15:26:28,154 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,154 - DEBUG - Online update step: 2/25
2025-06-02 15:26:28,155 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,155 - DEBUG - Online update step: 3/25
2025-06-02 15:26:28,155 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,155 - DEBUG - Online update step: 4/25
2025-06-02 15:26:28,155 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,155 - DEBUG - Online update step: 5/25
2025-06-02 15:26:28,156 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,156 - DEBUG - Online update step: 6/25
2025-06-02 15:26:28,156 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,156 - DEBUG - Online update step: 7/25
2025-06-02 15:26:28,156 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,156 - DEBUG - Online update step: 8/25
2025-06-02 15:26:28,157 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,157 - DEBUG - Online update step: 9/25
2025-06-02 15:26:28,157 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,157 - DEBUG - Online update step: 10/25
2025-06-02 15:26:28,157 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,157 - DEBUG - Online update step: 11/25
2025-06-02 15:26:28,158 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,158 - DEBUG - Online update step: 12/25
2025-06-02 15:26:28,158 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,158 - DEBUG - Online update step: 13/25
2025-06-02 15:26:28,158 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,158 - DEBUG - Online update step: 14/25
2025-06-02 15:26:28,159 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,159 - DEBUG - Online update step: 15/25
2025-06-02 15:26:28,159 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,159 - DEBUG - Online update step: 16/25
2025-06-02 15:26:28,159 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,159 - DEBUG - Online update step: 17/25
2025-06-02 15:26:28,160 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,160 - DEBUG - Online update step: 18/25
2025-06-02 15:26:28,160 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,160 - DEBUG - Online update step: 19/25
2025-06-02 15:26:28,160 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,161 - DEBUG - Online update step: 20/25
2025-06-02 15:26:28,161 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,161 - DEBUG - Online update step: 21/25
2025-06-02 15:26:28,161 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,161 - DEBUG - Online update step: 22/25
2025-06-02 15:26:28,161 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,162 - DEBUG - Online update step: 23/25
2025-06-02 15:26:28,162 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,162 - DEBUG - Online update step: 24/25
2025-06-02 15:26:28,162 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,162 - DEBUG - Online update step: 25/25
2025-06-02 15:26:28,162 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,162 - WARNING - No successful steps during online update.
2025-06-02 15:26:28,164 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -3.1288529e-08 -4.8810104e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  3.5043151e-08
 -2.2527740e-08  3.7546233e-09 -8.1350171e-09 -2.0024657e-08
  2.2979002e+00  2.9606299e+00  1.4041995e-01  4.3923883e+00
 -3.7546233e-09  3.4475067e+00  5.7073493e+00  7.5931759e+00
  1.4041995e-01  8.0000000e+00 -6.8834760e-09  7.5092466e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.2515411e-08  3.0036986e-08], current edge mean: [ 3.5343088e-09  4.6400555e+02  0.0000000e+00  0.0000000e+00
 -1.7671544e-09  5.8905147e-09 -3.5343088e-09  0.0000000e+00
 -2.3562059e-09 -2.3562059e-09]
2025-06-02 15:26:28,164 - DEBUG - Node drift difference: 0.0179, Edge drift difference: 0.0017
2025-06-02 15:26:28,166 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -3.1288529e-08 -4.8810104e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  3.5043151e-08
 -2.2527740e-08  3.7546233e-09 -8.1350171e-09 -2.0024657e-08
  2.2979002e+00  2.9606299e+00  1.4041995e-01  4.3923883e+00
 -3.7546233e-09  3.4475067e+00  5.7073493e+00  7.5931759e+00
  1.4041995e-01  8.0000000e+00 -6.8834760e-09  7.5092466e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.2515411e-08  3.0036986e-08], edge=[ 3.5343088e-09  4.6400555e+02  0.0000000e+00  0.0000000e+00
 -1.7671544e-09  5.8905147e-09 -3.5343088e-09  0.0000000e+00
 -2.3562059e-09 -2.3562059e-09]
2025-06-02 15:26:28,167 - DEBUG - Updated reference std: node=[0.         0.         1.0006568  1.0006568  0.         0.
 0.         1.0006568  1.0006567  1.0006567  1.0006568  1.0006568
 0.97361827 0.27801365 0.36245453 0.5658664  1.0006567  3.0614383
 2.9225075  1.5215856  0.36245453 0.         1.0006568  1.0006568
 0.         0.         0.         0.         1.0006568  1.0006568 ], edge=[  1.000309  504.0354      0.          0.          1.0003089   1.000309
   1.000309    1.000309    1.000309    1.000309 ]
2025-06-02 15:26:28,167 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:26:28,167 - INFO - Running anomaly detection...
2025-06-02 15:26:28,168 - INFO - Starting anomaly detection.
2025-06-02 15:26:28,182 - DEBUG - Node reconstruction errors: [17.36596   16.011961  23.015802  18.174     13.679751  15.991611
 22.079702  16.955217  16.955217  17.777788  16.955217  13.350985
 25.419695  13.599364  16.493536  16.508854  13.5523205 16.508854
 18.629253  16.155972  15.855925  16.493536  15.750237  11.417688
 16.311083  18.22005   16.311083  13.724006  16.602993  16.311079
 13.478842  15.789224  13.446118  18.031507  18.427525  15.344097
 16.399347  16.155972  12.290793  12.1955    17.590813  16.17636
 16.155972  17.014454  13.159049  15.840147  18.089392  12.026548
 16.28378   30.186268  32.019886  17.358921  17.894283  17.277727
 16.082125  12.80657   20.86134   15.565588  18.150208  17.542183
 12.854147  15.226575  15.903211  11.08507   16.41285   16.08212
 16.285728  16.08214   15.903208  15.90321   15.756575  15.200848
 16.206795  15.690291  15.760337  15.28696   16.61366   15.673782
 15.504551  15.604951  17.24301   15.2397785 10.651871  15.914418
 17.166313  11.751314  14.836257  15.584569  16.427145  15.350032
 16.241493  14.135975  12.06798   15.669296  15.679931  27.456432
 16.84553   15.462852  15.351959  16.054323  14.882248  16.845528
 17.395447  16.63707   11.155308  15.766898  11.520459  11.602781
 12.376531  22.847845  16.072365  17.01936   12.543439  12.717561
 15.006303  14.722615  14.94646   13.064094  15.627719  15.568191
 15.961738  12.00151   12.330279  11.399252  16.277662  15.568076
 11.388488  11.5927305 15.381974  15.195481  16.45904   16.308178
 15.793176  13.283517  14.866068  15.976518  16.566784  15.462483
 11.676422  13.379908  16.077204  14.975057  15.882581  16.175032
 16.097118  15.048132  14.946459  16.508036  15.585599  15.5434475
 19.55343   11.302073  15.230731  16.308176  13.654722  13.171101
 16.027561  14.983033  14.88225   17.586885  16.097122  11.671141
 16.027565  16.45904   14.781864  13.450458  14.61556   15.2799425
 11.84819   15.390876  15.531394  15.537477  16.164146  26.127096
 15.45981   15.174449  15.461865  15.51775   14.732742  14.73274
 15.647738  12.16946   15.507875  12.480447  12.928936  15.41458
 15.755962  15.019942  15.858214  15.902637  15.392057  15.536984
 16.723333  16.191378  11.67628   16.784485  10.597599  15.770829
 13.130209  15.560229  15.371688  16.027565  12.804598  15.431292
 15.806474  11.529403  16.192951  14.429371  15.2559595 15.12773
 14.655425  14.901033  16.995527  15.478358  16.15968   15.627115
 14.789418  14.946463  14.675537  16.191378  12.691046  15.755962
 15.992682  16.995527  16.027565  16.136507  13.2852125 16.30059
 15.373381  12.109369  11.962839  16.270346  15.346937  14.946458
 14.94646   16.784487  15.47969   15.992682  16.027561  16.448545
 13.233459  15.388199  16.337618  15.543444  16.127415  15.36778
 14.973278  15.590145  16.337614  15.887042  16.164146  15.973522
 14.675537  15.201364  14.722616  15.794671  15.902637  15.050446
 15.482862  14.732742  14.8565035 11.786965  16.306728  15.514411
 15.226077  15.562472  15.841333  16.083145  15.841334  14.655686
 12.56023   12.331441  15.382035  15.207842  14.464014  14.732745
 15.641302  16.059456  15.647739  15.241533  14.572213  15.718524
 15.36905   16.719542  14.619337  16.17941   14.37978   12.192026
 12.169457  12.701081  15.48274   16.454172  15.844554  16.127415
 10.862019  14.969133  15.157451  14.732841  16.784485  15.152805
 15.129529  15.151883  14.353605  14.353601  15.151883  15.151883
 15.151883  14.437179  15.070524  15.151883  15.151883  12.974044
 15.151883  15.810034  11.114566  15.260609  15.314327  11.910733
 16.859547  16.74695   15.751807  15.663892  16.128462  14.353605
 11.489889  12.397966  15.195985  14.437181  15.068853  15.068854
 16.541906  16.69634   15.151883  14.464007  15.151883  14.4371805
 15.42605   15.797029  15.195988  15.195983  15.151881  15.569531
 15.195985  15.562891  15.928278  15.027821  14.353604  16.087313
 15.877655  15.289106  15.151883  14.8827505 12.481524  14.570212
 15.476123  15.902637  14.9562235 15.151883  15.292963  16.513803
 14.655429  15.290866  16.240791  16.043312  14.353608  20.529764
 15.773022  13.854467  14.795066  14.684979  15.2865305 16.058102
 15.286621  12.5671835 15.130661  15.251087  15.850573  15.486178
 15.78475   15.151881  14.353603  11.58372   16.015945  15.297849
 11.592783  15.91572   15.951428  11.0415    15.1031275 15.151883
 15.88597   14.483117  14.546118  14.465566  15.010483  15.010485
 15.010485  17.247753  15.042352  17.439144  15.743831  15.357545
 15.010485  15.042352  14.603697  14.54613   15.654222  15.778197
 14.546116  11.5322275 15.010485  14.546118  15.042352  15.010485
 15.010485  15.369162  15.424382  15.010485  15.8505745 15.623626
 15.751584  15.742106  14.671731  15.948154  12.162554  15.7515135
 15.743833  15.107684  12.185843  16.050222  15.631044  15.488208
 14.952942  15.549142  15.010485  15.010483  15.743831  16.096058
 12.162559  15.198202  15.606419  15.302873  16.80959   15.556246
 15.556293  11.569552  15.262882  15.910319  16.82236   15.929926
 16.041306  15.656357  15.964094  14.96401   15.656356  15.656032
 15.948153  15.98017   16.483145  14.671728  14.719815  16.029444
 15.9297285 12.493502  15.9297285 16.029444  15.543226  14.671729
 12.21931   16.853933  15.543226  14.719824  15.310818  12.729925
 15.277797  14.672331  14.628528  14.719814  15.606419  16.014389
 16.576712  13.143182  15.574023  15.910321  12.458104  16.286821
 15.656356  12.266839  16.182894  13.455483  14.707059  15.6064205
 15.2766075 15.623626  14.639507  15.980167  14.673564  17.676863
 14.96401   16.014389  16.80959   15.623626  16.80959   15.498993
 15.4591    11.983899  14.913763  13.607919  15.964096  15.656356
 11.996958  15.252112  15.252112  15.556291  14.955558  15.556293
 14.913764  14.22183   17.049772  15.257253  14.221832  15.302873
 14.913763  16.903902  15.4591    14.673563  16.130524  11.354417
 14.22183   15.907407  15.572248  14.964011  14.96401   16.01439
 14.673563  14.497332  14.789764  16.14382   14.96401   15.262284
 14.964011  15.262284  15.228182  14.221828  15.203344  15.252111
 15.216192  14.916301  15.3349285 14.916301  14.916301  14.916299
 14.916301  14.916301  14.9163    14.916299  14.237119  15.216548
 16.14297   14.916301  14.916301  14.916301  14.916301  14.9163
 14.916301  14.916301  14.916299  14.916299  14.197402  14.916299
 14.916301  14.237119  14.916301  11.996952  12.968057  14.96401
 13.399751  15.468194  17.560968  17.560968  16.087486  13.399751
 14.96401   14.913763  14.913763  14.964011  14.913763  15.775222
 15.434911  14.916301  15.302874  14.964011  15.252112  14.96401
 14.964011  14.857499  14.964011  14.913763  14.964011  14.964011
 14.221828  14.913764  14.964011  14.913763  14.96401   14.964011
 14.964011  15.504919  14.639506  14.639507  14.916301  15.010075
 12.77947   14.964011  14.913764  15.51802   14.916301  14.913764
 16.047108  14.8793    14.96401   14.96401   14.819571  15.513044
 15.422841  14.964011  14.237119  14.857498  14.913763  10.82922
 14.916301  14.913763  14.221829  14.916299  14.916301  14.237119
 14.857498  14.964011  15.869407  15.42284   14.9479065 15.513048
 16.268408  14.926083  14.926082  12.928296  15.6045265 14.916299
 15.2231865 14.872248  15.513044  14.459883  15.604525  15.584916
 14.895401  14.895401  14.895401  14.895401  14.895401  14.203225
 15.005231  14.895401  14.895401  14.916301  14.87167   14.916299
 14.926083  15.477978  14.926081  15.384647  14.926083  15.094301
 14.197402  14.916301  14.197403  14.916301  14.926083  15.407634
 14.879895  14.879894  14.895401  15.407636  15.878425  15.372405
 14.916301  14.916301  14.895401  15.584914  14.879895  14.856845
 15.584914  15.388356  14.203227  13.272658  15.396621  13.6761675
 15.306054  15.584916  15.735198  15.388356  15.60139   15.60139
 14.963287  14.907542  14.928681  15.584915  15.584915  15.584916
 15.569016  15.584916  15.584916  15.60139   15.584915  15.584916
 15.584915  15.364888  15.405412  15.884387  15.88876   15.269182
 15.961852  15.60139   15.88876   17.15562   15.651992  15.45667
 15.6519985 15.094043  15.094043  15.60139   12.3365    16.894167
 15.651997  14.954149  16.225502  13.6935425 15.54163   15.54163
 15.54163   15.034252  15.736835  12.2281885 16.532082  16.894169
 16.608278  15.671444  15.332331  14.954149  16.019655  16.92071
 15.651997  16.92071   15.6519985 16.894169  14.954152  15.502054
 15.671444  15.337197  15.54163   15.034255  15.6519985 15.315871 ]
2025-06-02 15:26:28,183 - DEBUG - Edge reconstruction errors: [  5.252858    5.2535768  44.24769   ...  13.347634   13.347636
 535.24817  ]
2025-06-02 15:26:28,186 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152628_update_28.json
2025-06-02 15:26:28,186 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:26:28,201 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152628_update_28.pth
2025-06-02 15:26:28,201 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869935.dot): 0.1607
2025-06-02 15:26:28,201 - WARNING - Detected 10 anomalous nodes (reconstruction-based):
2025-06-02 15:26:28,202 - WARNING -   Node ID: 192.168.27.13, Recon Error: 23.0158, MLP Score: 0.2361
2025-06-02 15:26:28,202 - WARNING -   Node ID: 192.168.27.12, Recon Error: 22.0797, MLP Score: 0.2558
2025-06-02 15:26:28,202 - WARNING -   Node ID: 192.168.27.10, Recon Error: 25.4197, MLP Score: 0.2109
2025-06-02 15:26:28,202 - WARNING -   Node ID: ff02::2, Recon Error: 30.1863, MLP Score: 0.3723
2025-06-02 15:26:28,202 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 32.0199, MLP Score: 0.3699
2025-06-02 15:26:28,203 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 15:26:28,203 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2476, MLP Score: 0.0000
2025-06-02 15:26:28,203 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9515, MLP Score: 0.0000
2025-06-02 15:26:28,203 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0506, MLP Score: 0.0000
2025-06-02 15:26:28,204 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7497, MLP Score: 0.0000
2025-06-02 15:26:28,204 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7484, MLP Score: 0.0000
2025-06-02 15:26:28,204 - INFO - 
--- Processing file: nw_graph_encoded_1748869965.dot (Timestamp: 2025-06-02 15:12:45) ---
2025-06-02 15:26:28,204 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869965.dot
2025-06-02 15:26:28,204 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869965.dot'.
2025-06-02 15:26:28,205 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869965.dot
2025-06-02 15:26:28,237 - INFO - Parsed 768 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869965.dot'.
2025-06-02 15:26:28,326 - INFO - Parsed 1644 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869965.dot'.
2025-06-02 15:26:28,326 - INFO - Processing node updates/additions.
2025-06-02 15:26:28,362 - INFO - Processing edge updates/additions.
2025-06-02 15:26:28,499 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:26:28,504 - INFO - Finished updating NetworkX graph.
2025-06-02 15:26:28,507 - DEBUG - Updated graph - Nodes: 768, Edges: 1644
2025-06-02 15:26:28,508 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:26:28,513 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:26:28,666 - DEBUG - Initial node features tensor shape: torch.Size([768, 30])
2025-06-02 15:26:28,669 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:26:28,670 - DEBUG - Node features tensor shape after scaling: torch.Size([768, 30])
2025-06-02 15:26:28,674 - DEBUG - Edge index tensor shape: torch.Size([2, 1644])
2025-06-02 15:26:28,684 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:26:28,759 - DEBUG - Initial edge attributes tensor shape: torch.Size([1644, 10])
2025-06-02 15:26:28,762 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:26:28,763 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1644, 10])
2025-06-02 15:26:28,763 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:26:28,764 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:26:28,767 - INFO - Updated main graph to 768 nodes and 1644 edges.
2025-06-02 15:26:28,767 - INFO - Performing online update...
2025-06-02 15:26:28,767 - INFO - Starting online update for 25 steps.
2025-06-02 15:26:28,768 - DEBUG - Updated RunningStats: new_mean=0.9422744119933412, new_var=16200000000160.84, new_n=1650
2025-06-02 15:26:28,769 - DEBUG - Updated RunningStats: new_mean=0.9385665205305781, new_var=16500000000018.895, new_n=1680
2025-06-02 15:26:28,769 - DEBUG - Updated RunningStats: new_mean=43.47959669847244, new_var=5400000193589.352, new_n=550
2025-06-02 15:26:28,770 - DEBUG - Updated RunningStats: new_mean=43.608880197122424, new_var=5500000224989.786, new_n=560
2025-06-02 15:26:28,770 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:26:28,770 - DEBUG - Online update step: 1/25
2025-06-02 15:26:28,770 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,771 - DEBUG - Online update step: 2/25
2025-06-02 15:26:28,771 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,771 - DEBUG - Online update step: 3/25
2025-06-02 15:26:28,771 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,771 - DEBUG - Online update step: 4/25
2025-06-02 15:26:28,771 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,772 - DEBUG - Online update step: 5/25
2025-06-02 15:26:28,772 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,772 - DEBUG - Online update step: 6/25
2025-06-02 15:26:28,772 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,772 - DEBUG - Online update step: 7/25
2025-06-02 15:26:28,772 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,773 - DEBUG - Online update step: 8/25
2025-06-02 15:26:28,773 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,773 - DEBUG - Online update step: 9/25
2025-06-02 15:26:28,773 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,773 - DEBUG - Online update step: 10/25
2025-06-02 15:26:28,773 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,774 - DEBUG - Online update step: 11/25
2025-06-02 15:26:28,774 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,774 - DEBUG - Online update step: 12/25
2025-06-02 15:26:28,774 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,774 - DEBUG - Online update step: 13/25
2025-06-02 15:26:28,774 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,775 - DEBUG - Online update step: 14/25
2025-06-02 15:26:28,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,775 - DEBUG - Online update step: 15/25
2025-06-02 15:26:28,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,775 - DEBUG - Online update step: 16/25
2025-06-02 15:26:28,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,775 - DEBUG - Online update step: 17/25
2025-06-02 15:26:28,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,776 - DEBUG - Online update step: 18/25
2025-06-02 15:26:28,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,776 - DEBUG - Online update step: 19/25
2025-06-02 15:26:28,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,776 - DEBUG - Online update step: 20/25
2025-06-02 15:26:28,777 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,777 - DEBUG - Online update step: 21/25
2025-06-02 15:26:28,777 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,777 - DEBUG - Online update step: 22/25
2025-06-02 15:26:28,777 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,777 - DEBUG - Online update step: 23/25
2025-06-02 15:26:28,778 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,778 - DEBUG - Online update step: 24/25
2025-06-02 15:26:28,778 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,778 - DEBUG - Online update step: 25/25
2025-06-02 15:26:28,778 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:28,778 - WARNING - No successful steps during online update.
2025-06-02 15:26:28,780 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -3.2285850e-08 -1.9868216e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.1044085e-08
  2.6077032e-08 -3.7252903e-09  1.2417635e-09 -2.2351742e-08
  2.2838542e+00  2.9609375e+00  1.4062500e-01  4.3932290e+00
  3.7252903e-09  3.4492188e+00  5.7096353e+00  7.5963540e+00
  1.4062500e-01  8.0000000e+00  1.2417635e-09 -3.2906730e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.4835269e-09  4.9670539e-09], current edge mean: [-1.7402816e-09  4.6368613e+02  0.0000000e+00  0.0000000e+00
 -3.4805632e-09 -2.9004694e-09 -5.8009386e-10 -4.3507038e-09
 -3.1905163e-09  3.7706100e-09]
2025-06-02 15:26:28,780 - DEBUG - Node drift difference: 0.0144, Edge drift difference: 0.0006
2025-06-02 15:26:28,782 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -3.2285850e-08 -1.9868216e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.1044085e-08
  2.6077032e-08 -3.7252903e-09  1.2417635e-09 -2.2351742e-08
  2.2838542e+00  2.9609375e+00  1.4062500e-01  4.3932290e+00
  3.7252903e-09  3.4492188e+00  5.7096353e+00  7.5963540e+00
  1.4062500e-01  8.0000000e+00  1.2417635e-09 -3.2906730e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.4835269e-09  4.9670539e-09], edge=[-1.7402816e-09  4.6368613e+02  0.0000000e+00  0.0000000e+00
 -3.4805632e-09 -2.9004694e-09 -5.8009386e-10 -4.3507038e-09
 -3.1905163e-09  3.7706100e-09]
2025-06-02 15:26:28,783 - DEBUG - Updated reference std: node=[0.         0.         1.0006517  1.0006517  0.         0.
 0.         1.0006517  1.0006517  1.0006516  1.0006517  1.0006516
 0.96356016 0.27694583 0.362543   0.56546044 1.0006516  3.062159
 2.921897   1.5160462  0.362543   0.         1.0006517  1.0006517
 0.         0.         0.         0.         1.0006517  1.0006516 ], edge=[  1.0003042 500.1926      0.          0.          1.0003042   1.0003042
   1.0003042   1.0003042   1.0003043   1.0003043]
2025-06-02 15:26:28,783 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:26:28,783 - INFO - Running anomaly detection...
2025-06-02 15:26:28,784 - INFO - Starting anomaly detection.
2025-06-02 15:26:28,798 - DEBUG - Node reconstruction errors: [17.376102  16.032686  23.090124  18.128487  13.690338  16.006542
 22.15624   16.910147  16.910147  17.73331   16.910147  13.3387785
 25.521769  13.610908  16.461256  16.461445  13.5556    16.461443
 18.598219  16.123167  15.865677  16.461256  15.764173  11.427481
 16.28965   18.190971  16.28965   13.73526   16.572855  16.28965
 13.497025  15.966954  13.461108  18.003008  18.39864   15.357824
 16.417765  16.123167  12.315065  12.199779  17.574167  16.158146
 16.123167  17.026701  13.182587  11.834974  18.099213  12.045919
 16.266747  30.22165   32.091076  17.343319  17.87786   17.306389
 16.103273  12.827014  20.93866   15.557458  18.158298  17.569979
 12.874501  15.241866  15.895802  11.123203  16.405176  16.103275
 16.306398  16.10329   15.895802  15.895801  15.770605  15.208739
 16.224474  15.702975  15.775651  15.293713  16.63148   15.691893
 15.521853  15.617716  17.245125  15.263042  10.673353  15.925147
 16.548613  11.591036  14.86169   15.605988  16.439888  15.376024
 16.249352  14.155777  12.086915  15.691037  15.700647  27.504698
 16.853315  15.485282  15.364061  16.075153  14.902835  16.853315
 17.412249  16.66638   11.163834  15.786899  11.524155  11.616175
 12.392355  22.894087  16.0894    17.031897  12.566317  12.739639
 15.030553  14.750418  14.968804  13.082291  15.645944  15.591827
 15.978663  12.018552  12.354437  11.417672  16.29889   15.591729
 11.409482  11.618866  15.394301  15.215011  16.479172  16.327423
 15.800903  13.308445  14.89093   15.997713  16.587036  15.4697695
 11.689656  13.401378  16.099424  15.002378  15.90181   16.19684
 16.120075  15.066524  14.968805  16.518316  15.605072  15.564285
 19.568449  11.324062  15.246516  16.327421  13.663767  13.187848
 16.047525  15.011975  14.902837  17.595587  16.120075  11.691345
 16.047523  16.479172  14.806378  13.467128  14.633575  15.300875
 11.861364  15.410736  15.54458   15.558887  16.172764  26.199022
 15.478353  15.203371  15.485719  15.546178  14.756802  14.7568035
 15.6691885 12.18364   15.52483   12.500683  12.946372  15.426068
 15.777224  15.042364  15.881025  15.923898  15.406368  15.560227
 16.752262  16.206196  11.689516  16.806875  10.621871  15.751321
 13.14741   15.578771  15.391455  16.047525  12.830157  15.448369
 15.829487  11.544246  16.212017  14.435691  15.272723  15.14691
 14.68187   14.92303   17.011915  15.502508  16.18236   15.646402
 14.77448   14.968809  14.700274  16.206198  12.71451   15.777225
 16.006462  17.011915  16.047525  16.146639  13.303628  16.310335
 15.390599  12.122055  11.320753  16.29336   15.363779  14.968804
 14.968802  16.806873  15.503423  16.006462  16.047523  16.469551
 13.252265  15.411135  16.353708  16.24217   16.14249   15.38161
 15.000373  15.615513  16.353708  15.897945  16.17276   15.981464
 14.700274  15.223135  14.750418  15.816649  15.923898  15.069937
 15.493223  14.756803  14.879985  11.80607   16.320433  15.538298
 15.243079  15.587164  15.860682  16.121082  15.860678  14.682764
 12.583484  12.355384  15.405607  15.223802  14.485178  14.756804
 15.659344  16.078667  15.6691885 15.255045  14.587389  15.734222
 15.390922  16.733772  16.078825  16.193462  14.406142  12.2161255
 12.183642  12.726981  15.491726  16.474417  15.864089  16.142488
 13.114667  14.988166  15.179118  14.756884  16.806875  15.165615
 15.15005   15.168273  14.376328  14.3763275 15.168274  15.168274
 15.168273  14.45664   15.089268  15.168273  15.168275  12.980787
 15.168274  15.830789  11.142755  15.2819805 15.352062  11.928691
 16.878992  16.768684  15.774011  15.684462  16.146076  14.376326
 11.504301  12.420685  15.212536  14.456643  15.088143  15.0881405
 16.562962  16.718065  15.168275  14.485175  15.168274  14.45664
 15.440099  15.810004  15.212536  15.212534  15.168273  15.581954
 15.212534  15.5808    15.952378  16.068333  14.3763275 16.105145
 15.889279  15.30897   15.168273  14.909495  12.506572  14.597205
 15.492036  15.923898  14.975515  15.168273  15.305841  16.528559
 14.681872  15.313608  16.253294  16.066202  14.376332  20.596315
 15.792359  13.859797  14.818902  14.7099285 15.308778  16.082335
 15.308856  12.58542   15.153916  15.35303   15.867841  15.505441
 15.801536  15.168275  14.376326  11.601035  16.039488  15.316809
 11.605619  15.923772  15.970194  11.063065  15.122313  15.168274
 15.911993  14.509027  14.572188  14.490694  15.03013   15.03013
 15.03013   17.28396   15.06047   17.474293  15.7644005 15.383087
 15.03013   15.060469  14.630451  14.572194  15.6721525 15.800975
 14.572188  11.5582485 15.03013   14.572188  15.060469  15.030132
 15.03013   15.387772  15.440049  15.03013   15.867848  15.644991
 15.773685  15.753291  14.695982  15.971536  12.178461  15.7736225
 15.753292  15.131234  12.2066965 16.069088  15.648164  15.509084
 14.975679  15.57237   15.03013   15.03013   15.764402  16.116665
 12.178461  15.214463  15.578537  15.323423  16.819511  15.572651
 15.568049  11.72401   15.282755  15.926479  16.840246  15.951146
 16.048096  15.676766  15.9869995 14.982219  15.676766  15.676703
 15.971533  16.00382   16.50007   14.695982  14.743436  16.052618
 15.950886  12.50978   15.950887  16.052618  15.561603  14.695982
 12.23503   16.875582  15.561603  14.743439  15.330591  13.3457365
 15.293304  14.696468  14.640199  14.743437  15.626779  16.037264
 16.598675  13.1583395 15.590918  15.926479  12.469008  15.383109
 15.6767645 12.271668  16.202213  13.483111  14.731594  15.626779
 15.281906  15.644992  14.660619  16.00382   14.695884  17.712254
 14.98222   16.037264  16.81951   15.644992  16.819511  15.517386
 15.478425  11.998532  14.931924  13.632467  15.9869995 15.676766
 12.003328  15.272746  15.272744  15.5680485 14.9779825 15.568049
 14.931924  14.244655  17.067604  15.277811  14.244656  15.323425
 14.931925  16.925848  15.478426  14.695886  16.151714  11.373855
 14.244655  15.925971  15.578537  14.982222  14.982219  16.037266
 14.695886  14.521989  14.810654  16.16128   14.982222  15.284024
 14.98222   15.284024  15.233623  14.244656  15.215372  15.272746
 15.226279  14.933034  15.361063  14.933034  14.933034  14.933033
 14.933034  14.933034  14.933034  14.933034  14.259269  15.224347
 16.15929   14.933034  14.933033  14.933033  14.933034  14.933033
 14.933034  14.933034  14.933034  14.933034  14.218745  14.933034
 14.933033  14.259274  14.933034  12.003332  12.968412  14.982221
 13.402049  15.476609  17.556065  17.556065  16.106321  13.402049
 14.982221  14.931926  14.931925  14.982222  14.931926  15.787237
 15.453296  14.933033  15.323423  14.982222  15.272745  14.982219
 14.982219  14.868961  14.982222  14.931925  14.982219  14.982222
 14.244654  14.931925  14.982219  14.931926  14.982219  14.982221
 14.982222  15.52223   14.660618  14.660621  14.933033  15.0302105
 12.779896  14.982222  14.931925  15.535581  14.933034  14.931926
 16.064085  14.895802  14.982219  14.982222  14.830777  15.5285
 14.579593  14.982219  14.259274  14.868961  14.931926  10.842744
 14.933033  14.931925  14.244655  14.933033  14.933034  14.259275
 14.868961  14.982219  15.882656  15.444545  14.966321  15.528502
 16.275778  14.943301  14.943303  12.927415  15.623476  14.933034
 15.240563  14.885348  15.528503  14.478793  15.623476  15.600443
 14.91103   14.91103   14.91103   14.911028  14.91103   14.220326
 15.023437  14.91103   14.91103   14.933034  14.875868  14.933034
 14.943301  15.49193   14.943303  15.402719  14.943301  15.827807
 14.218741  14.933033  14.218745  14.933033  14.943301  15.425427
 14.896806  14.896806  14.91103   15.425427  15.891293  15.386755
 14.933033  14.933034  14.91103   15.600443  14.896806  14.866227
 15.600443  15.398091  14.220325  13.285845  15.39809   12.874919
 14.508397  15.600443  15.752269  15.4026575 15.611307  15.611309
 14.970762  14.917786  14.941985  15.600443  15.600443  15.600443
 15.581809  15.600443  15.600443  15.611308  15.600443  15.600443
 15.600443  14.550005  15.41394   15.891333  15.95979   15.280002
 15.974768  15.623562  15.891751  17.175995  15.655032  15.4581175
 15.655028  15.095083  15.095083  15.611308  13.292575  15.355967
 15.655029  14.957524  16.224531  13.684518  15.531794  15.5317955
 15.531795  15.026673  15.728175  12.215719  16.522337  16.894648
 16.603642  15.668444  15.327784  14.957524  16.023382  14.790175
 15.655028  16.924574  15.65503   16.894648  14.957524  15.505496
 15.668444  15.325952  15.531794  15.026673  15.655028  15.316535
 15.174796  15.026672  15.026672  15.026674  15.401082  15.401082 ]
2025-06-02 15:26:28,799 - DEBUG - Edge reconstruction errors: [  5.253127    5.2543635  44.24805   ...  13.347992   13.347994
 535.2486   ]
2025-06-02 15:26:28,802 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152628_update_29.json
2025-06-02 15:26:28,803 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:26:28,820 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152628_update_29.pth
2025-06-02 15:26:28,821 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869965.dot): 0.1592
2025-06-02 15:26:28,821 - WARNING - Detected 10 anomalous nodes (reconstruction-based):
2025-06-02 15:26:28,821 - WARNING -   Node ID: 192.168.27.13, Recon Error: 23.0901, MLP Score: 0.2376
2025-06-02 15:26:28,822 - WARNING -   Node ID: 192.168.27.12, Recon Error: 22.1562, MLP Score: 0.2573
2025-06-02 15:26:28,822 - WARNING -   Node ID: 192.168.27.10, Recon Error: 25.5218, MLP Score: 0.2116
2025-06-02 15:26:28,822 - WARNING -   Node ID: ff02::2, Recon Error: 30.2216, MLP Score: 0.3729
2025-06-02 15:26:28,822 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 32.0911, MLP Score: 0.3705
2025-06-02 15:26:28,822 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 15:26:28,823 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2480, MLP Score: 0.0000
2025-06-02 15:26:28,823 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9515, MLP Score: 0.0000
2025-06-02 15:26:28,823 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0507, MLP Score: 0.0000
2025-06-02 15:26:28,823 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7500, MLP Score: 0.0000
2025-06-02 15:26:28,824 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7487, MLP Score: 0.0000
2025-06-02 15:26:28,824 - INFO - 
--- Processing file: nw_graph_encoded_1748869995.dot (Timestamp: 2025-06-02 15:13:15) ---
2025-06-02 15:26:28,824 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869995.dot
2025-06-02 15:26:28,824 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869995.dot'.
2025-06-02 15:26:28,824 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869995.dot
2025-06-02 15:26:28,857 - INFO - Parsed 780 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869995.dot'.
2025-06-02 15:26:28,946 - INFO - Parsed 1667 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869995.dot'.
2025-06-02 15:26:28,947 - INFO - Processing node updates/additions.
2025-06-02 15:26:28,981 - INFO - Processing edge updates/additions.
2025-06-02 15:26:29,126 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:26:29,131 - INFO - Finished updating NetworkX graph.
2025-06-02 15:26:29,134 - DEBUG - Updated graph - Nodes: 780, Edges: 1667
2025-06-02 15:26:29,135 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:26:29,141 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:26:29,296 - DEBUG - Initial node features tensor shape: torch.Size([780, 30])
2025-06-02 15:26:29,302 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:26:29,309 - DEBUG - Node features tensor shape after scaling: torch.Size([780, 30])
2025-06-02 15:26:29,316 - DEBUG - Edge index tensor shape: torch.Size([2, 1667])
2025-06-02 15:26:29,333 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:26:29,413 - DEBUG - Initial edge attributes tensor shape: torch.Size([1667, 10])
2025-06-02 15:26:29,417 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:26:29,417 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1667, 10])
2025-06-02 15:26:29,418 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:26:29,419 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:26:29,424 - INFO - Updated main graph to 780 nodes and 1667 edges.
2025-06-02 15:26:29,424 - INFO - Performing online update...
2025-06-02 15:26:29,425 - INFO - Starting online update for 25 steps.
2025-06-02 15:26:29,427 - DEBUG - Updated RunningStats: new_mean=0.9423680974794084, new_var=16800000000160.652, new_n=1710
2025-06-02 15:26:29,427 - DEBUG - Updated RunningStats: new_mean=0.9389637560575538, new_var=17100000000018.463, new_n=1740
2025-06-02 15:26:29,429 - DEBUG - Updated RunningStats: new_mean=43.65564973143083, new_var=5600000192791.492, new_n=570
2025-06-02 15:26:29,429 - DEBUG - Updated RunningStats: new_mean=43.77193341232553, new_var=5700000222060.272, new_n=580
2025-06-02 15:26:29,430 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:26:29,430 - DEBUG - Online update step: 1/25
2025-06-02 15:26:29,431 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:29,431 - DEBUG - Online update step: 2/25
2025-06-02 15:26:29,431 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:29,432 - DEBUG - Online update step: 3/25
2025-06-02 15:26:29,432 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:29,432 - DEBUG - Online update step: 4/25
2025-06-02 15:26:29,433 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:29,433 - DEBUG - Online update step: 5/25
2025-06-02 15:26:29,433 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:29,433 - DEBUG - Online update step: 6/25
2025-06-02 15:26:29,434 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:29,434 - DEBUG - Online update step: 7/25
2025-06-02 15:26:29,434 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:29,435 - DEBUG - Online update step: 8/25
2025-06-02 15:26:29,435 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:29,435 - DEBUG - Online update step: 9/25
2025-06-02 15:26:29,436 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:29,436 - DEBUG - Online update step: 10/25
2025-06-02 15:26:29,436 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:29,437 - DEBUG - Online update step: 11/25
2025-06-02 15:26:29,437 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:29,437 - DEBUG - Online update step: 12/25
2025-06-02 15:26:29,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:29,438 - DEBUG - Online update step: 13/25
2025-06-02 15:26:29,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:29,439 - DEBUG - Online update step: 14/25
2025-06-02 15:26:29,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:29,439 - DEBUG - Online update step: 15/25
2025-06-02 15:26:29,440 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:29,440 - DEBUG - Online update step: 16/25
2025-06-02 15:26:29,440 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:29,441 - DEBUG - Online update step: 17/25
2025-06-02 15:26:29,441 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:29,441 - DEBUG - Online update step: 18/25
2025-06-02 15:26:29,441 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:29,442 - DEBUG - Online update step: 19/25
2025-06-02 15:26:29,442 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:29,442 - DEBUG - Online update step: 20/25
2025-06-02 15:26:29,443 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:29,443 - DEBUG - Online update step: 21/25
2025-06-02 15:26:29,443 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:29,444 - DEBUG - Online update step: 22/25
2025-06-02 15:26:29,444 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:29,444 - DEBUG - Online update step: 23/25
2025-06-02 15:26:29,445 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:29,445 - DEBUG - Online update step: 24/25
2025-06-02 15:26:29,445 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:29,446 - DEBUG - Online update step: 25/25
2025-06-02 15:26:29,446 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:29,447 - WARNING - No successful steps during online update.
2025-06-02 15:26:29,449 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  5.2574354e-08 -8.3140840e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.2924864e-08
 -2.4453188e-09 -3.1789146e-08 -1.8339891e-09 -6.7246266e-09
  2.2884614e+00  2.9564102e+00  1.4230770e-01  4.3961539e+00
  2.9343825e-08  3.4333334e+00  5.7128205e+00  7.5948720e+00
  1.4230770e-01  7.9910254e+00 -4.2793080e-09 -1.0545437e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.2226594e-08 -4.5238398e-08], current edge mean: [-4.5767212e-09  4.6274744e+02  0.0000000e+00  0.0000000e+00
 -2.0023156e-09  0.0000000e+00  3.7185861e-09  0.0000000e+00
  0.0000000e+00  6.4360144e-09]
2025-06-02 15:26:29,450 - DEBUG - Node drift difference: 8974.5518, Edge drift difference: 0.0019
2025-06-02 15:26:29,451 - WARNING - Feature drift detected (1 consecutive)
2025-06-02 15:26:29,454 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  5.2574354e-08 -8.3140840e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.2924864e-08
 -2.4453188e-09 -3.1789146e-08 -1.8339891e-09 -6.7246266e-09
  2.2884614e+00  2.9564102e+00  1.4230770e-01  4.3961539e+00
  2.9343825e-08  3.4333334e+00  5.7128205e+00  7.5948720e+00
  1.4230770e-01  7.9910254e+00 -4.2793080e-09 -1.0545437e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.2226594e-08 -4.5238398e-08], edge=[-4.5767212e-09  4.6274744e+02  0.0000000e+00  0.0000000e+00
 -2.0023156e-09  0.0000000e+00  3.7185861e-09  0.0000000e+00
  0.0000000e+00  6.4360144e-09]
2025-06-02 15:26:29,455 - DEBUG - Updated reference std: node=[0.         0.         1.0006417  1.0006417  0.         0.
 0.         1.0006417  1.0006416  1.0006417  1.0006416  1.0006417
 1.0045444  0.29221377 0.36398143 0.5649002  1.0006417  3.058592
 2.92255    1.5183852  0.36398143 0.2506402  1.0006417  1.0006417
 0.         0.         0.         0.         1.0006417  1.0006417 ], edge=[  1.0003  496.99893   0.        0.        1.0003    1.0003    1.0003
   1.0003    1.0003    1.0003 ]
2025-06-02 15:26:29,456 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:26:29,456 - INFO - Running anomaly detection...
2025-06-02 15:26:29,457 - INFO - Starting anomaly detection.
2025-06-02 15:26:29,479 - DEBUG - Node reconstruction errors: [17.376667  15.940847  22.890514  18.118177  13.730151  16.033823
 21.96004   16.905571  16.905571  17.72533   16.905571  13.335344
 25.129833  13.625314  16.470116  16.448717  13.57536   16.448713
 18.393461  16.131485  15.923212  16.470116  15.835099  11.460906
 16.308455  18.199306  16.308455  13.801102  16.587416  16.308456
 13.304121  15.99576   13.495617  18.014828  18.407814  15.422701
 16.437225  16.131483  12.351529  12.237372  17.603416  16.185064
 16.131483  17.086391  13.192954  11.870856  18.156984  12.09173
 16.300407  30.302834  32.2392    17.37417   17.90711   17.181526
 16.169533  12.876477  20.948772  15.596505  17.99918   17.447
 12.918793  15.312511  15.937133  11.152542  16.448881  16.169535
 16.368713  16.16955   15.937133  15.937133  15.834493  15.22795
 16.29991   15.736568  15.820768  15.309674  16.718082  15.727015
 15.556375  15.651952  17.298288  15.291858  10.719517  15.960534
 16.612486  11.638072  14.899065  15.646213  16.471842  15.407261
 16.310526  14.220257  12.146613  15.724405  15.772868  27.6286
 16.91546   15.519976  15.429875  16.1519    14.937949  16.91546
 17.483843  16.697176  11.22019   15.869826  11.598658  11.672803
 12.448004  22.981407  16.155558  17.097828  12.638192  12.808766
 15.070858  14.795837  15.010097  13.142607  15.686185  15.665568
 16.051535  12.079375  12.4099    11.475877  16.344364  15.66548
 11.471515  11.678911  15.419676  15.291733  16.553617  16.405766
 15.865336  13.358685  14.935305  16.077755  16.66138   15.530771
 11.744311  13.447314  16.17058   15.041136  15.977729  16.27667
 16.194727  15.101938  15.010096  16.588198  15.679234  15.607785
 19.637125  11.359927  15.284826  16.405766  13.73525   13.253694
 16.129744  15.048993  14.937952  17.657898  16.194725  11.755259
 16.129744  16.553616  14.846269  13.525342  14.663917  15.347455
 11.913079  15.457821  15.579106  15.632849  16.23684   26.352787
 15.501404  15.250384  15.53292   15.586424  14.797393  14.797394
 15.755607  12.237881  15.605149  12.553468  13.19258   15.46166
 15.856034  15.071795  15.9625225 16.009266  15.441491  15.597166
 16.813375  16.280554  11.744163  16.887474  10.67235   15.811316
 13.206366  15.65939   15.465164  16.129744  12.888912  15.488351
 15.862521  11.592251  16.28617   14.475713  15.341885  15.190915
 14.725036  14.962717  17.08509   15.536717  16.218945  15.7246
 14.807431  15.010096  14.742616  16.280554  12.782595  15.856035
 16.076578  17.08509   16.129744  16.177877  13.3638    16.378578
 15.42994   12.174005  11.365794  16.335657  15.394833  15.010096
 15.010097  16.887474  15.5407    16.076578  16.129744  16.529993
 13.312565  15.453704  16.428587  16.27816   16.218212  15.425869
 15.036735  15.570006  16.428589  15.9619255 16.23684   16.043907
 14.742616  15.267016  14.795837  15.851328  16.009266  15.145522
 15.5603695 14.797391  14.93472   11.866124  16.38912   15.607838
 15.281909  15.655793  15.905167  16.020624  15.905166  14.723775
 12.635891  12.412447  15.449939  15.297204  14.520646  14.797395
 15.742682  16.123482  15.755607  15.290224  14.642122  15.814748
 15.437983  16.803602  16.109827  16.260685  14.459355  12.274122
 12.237884  12.77601   15.551679  16.55158   15.937846  16.21821
 13.153894  15.0639515 15.222562  14.797442  16.887474  15.243225
 15.195606  15.237096  14.414039  14.414041  15.237096  15.237095
 15.237098  14.490275  15.161401  15.237096  15.237095  13.060486
 15.237098  15.916673  11.186739  15.326889  15.381087  11.992238
 16.956997  16.849068  15.823165  15.752485  16.196745  14.4140415
 11.5766115 12.476275  15.280925  14.490275  15.134008  15.134007
 16.599524  16.799309  15.237095  14.520642  15.237096  14.490275
 15.503106  15.880765  15.280926  15.280926  15.237096  15.6542015
 15.280926  15.628889  16.001076  16.102995  14.414041  16.177528
 15.935314  15.352372  15.237095  14.945948  12.581689  14.638045
 15.568574  16.009266  15.050532  15.237096  15.369686  16.575182
 14.725037  15.394497  16.339392  16.113012  14.414045  20.738472
 15.870608  13.917357  14.859441  14.754881  15.3532    16.125551
 15.353256  12.639016  15.200273  15.387963  15.943034  15.580006
 15.843273  15.237096  14.414041  11.6627035 16.120518  15.360625
 11.662387  15.95712   16.04972   11.136548  15.159519  15.237096
 15.958349  14.553873  14.615699  14.534726  15.066242  15.066242
 15.066242  17.16528   15.13203   17.359947  15.847773  15.428656
 15.066245  15.13203   14.669539  14.615698  15.727061  15.880397
 14.615698  11.629205  15.06624   14.615694  15.1320305 15.066242
 15.066242  15.467085  15.51692   15.066242  15.943038  15.679768
 15.852762  15.818896  14.737533  16.049135  12.228877  15.852826
 15.818896  15.171492  12.264964  16.145628  15.701609  15.592558
 15.013045  15.610372  15.066245  15.066241  15.8477745 16.16944
 12.22864   15.285283  15.6446295 15.399919  16.901373  15.646781
 15.639251  11.767164  15.31067   15.996044  16.917524  16.02927
 16.08012   15.754004  16.069313  15.054174  15.754004  15.751603
 16.049135  16.086214  16.572523  14.737533  14.783197  16.136665
 16.02556   12.572481  16.02556   16.136665  15.639779  14.676814
 12.291326  16.955763  15.639779  14.783197  16.148418  13.410046
 15.333649  14.7377825 14.676812  14.783195  15.7044    16.118668
 16.67291   13.216574  15.666757  15.996044  12.513842  15.449291
 15.754004  11.656429  16.279497  13.39484   14.773161  15.704398
 15.31021   15.723865  14.698141  16.086214  14.7333    17.419718
 15.0541725 16.11867   16.901373  15.723865  16.901373  15.602757
 15.556309  12.053737  15.004461  13.682046  16.069313  15.754004
 12.049606  15.35061   15.35061   15.63925   15.013027  15.639249
 15.004461  14.281315  17.13952   15.321123  14.281317  15.39992
 15.004462  17.007013  15.556308  14.7333    16.233068  11.4408865
 14.281322  15.978427  15.644628  15.054173  15.0541725 16.118668
 14.733303  14.564535  14.86173   16.205023  15.0541725 15.3267
 15.054173  15.326701  15.311086  14.281317  15.288577  16.616522
 15.291836  15.003408  15.424654  15.003408  15.003408  15.003408
 15.003408  15.003408  15.003408  15.0034075 14.292321  15.288439
 16.234291  15.0034075 15.003408  15.003408  15.003408  15.003408
 15.003408  15.003408  15.0034075 15.003408  14.252268  15.003408
 15.0034075 11.748516  15.0034075 11.388897  13.005245  15.0541725
 13.437194  15.502725  17.58121   17.58121   16.157017  13.437194
 15.0541725 15.004462  15.004462  15.054173  15.004462  15.854512
 15.549253  15.0034075 15.39992   15.0541725 15.35061   15.0541725
 15.054173  14.935228  15.054173  15.004462  15.0541725 15.0541725
 14.281315  15.004461  15.0541725 15.004464  15.0541725 15.0541725
 15.0541725 15.575994  14.698144  14.69814   15.003408  15.111903
 12.819146  15.0541725 15.004464  15.543958  15.003408  15.004462
 16.112438  14.967595  15.054173  15.0541725 14.8499155 15.578605
 14.612568  15.054173  14.292324  14.935228  15.004462  10.89505
 15.003408  15.004462  14.281318  15.0034075 15.003408  14.292321
 14.935228  15.0541725 15.961436  15.487139  14.999461  15.578605
 16.340544  14.973759  14.973759  12.960358  15.659928  15.003408
 15.314961  14.913251  15.578605  14.515155  15.699046  15.671404
 14.974791  14.974791  14.974791  14.9747925 14.974791  14.250797
 15.0546255 14.974791  14.974791  15.003408  14.933219  15.003408
 14.973759  15.541118  14.973759  15.47857   14.973759  15.8627205
 14.252273  15.003408  14.252271  15.003408  14.973759  15.501448
 14.965063  14.965063  14.974791  15.501448  15.929012  15.457888
 15.003408  15.003408  14.974791  15.671404  14.965063  14.928655
 15.671404  15.456366  14.2508    13.339559  15.456366  12.9157295
 14.532354  15.671404  15.828115  15.474101  15.674332  15.674332
 14.985445  14.974096  14.965964  15.671404  15.671405  15.671403
 15.650076  15.671403  15.671404  15.674332  15.671404  15.671404
 15.671403  14.569137  15.477756  15.977656  15.977654  15.307705
 16.04202   15.678202  15.996519  17.044687  15.709085  15.512521
 15.718005  15.140601  15.1406    15.674332  13.325746  15.370085
 15.709083  15.00459   16.27641   13.722981  15.57488   15.57488
 15.57488   15.062974  15.793912  12.23475   16.564226  16.95864
 16.64908   15.740225  15.371658  15.004592  16.075521  14.796561
 15.718005  16.981152  15.7090845 15.3700075 15.004592  15.529942
 15.718005  15.367192  15.57488   15.062973  15.718005  15.365024
 15.205076  15.062973  15.062973  15.062973  15.454632  15.434873
  9.371669  15.57488   16.22675   15.062973  15.598103  15.531448
 17.599468  15.531448  15.062974  15.155965  15.531448  15.771306 ]
2025-06-02 15:26:29,480 - DEBUG - Edge reconstruction errors: [  5.255604    5.2566023  44.250782  ...  13.350729   13.350731
 535.25134  ]
2025-06-02 15:26:29,483 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152629_update_30.json
2025-06-02 15:26:29,484 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:26:29,498 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152629_update_30.pth
2025-06-02 15:26:29,498 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869995.dot): 0.1615
2025-06-02 15:26:29,499 - WARNING - Detected 10 anomalous nodes (reconstruction-based):
2025-06-02 15:26:29,499 - WARNING -   Node ID: 192.168.27.13, Recon Error: 22.8905, MLP Score: 0.2369
2025-06-02 15:26:29,499 - WARNING -   Node ID: 192.168.27.12, Recon Error: 21.9600, MLP Score: 0.2562
2025-06-02 15:26:29,499 - WARNING -   Node ID: 192.168.27.10, Recon Error: 25.1298, MLP Score: 0.2130
2025-06-02 15:26:29,499 - WARNING -   Node ID: ff02::2, Recon Error: 30.3028, MLP Score: 0.3736
2025-06-02 15:26:29,500 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 32.2392, MLP Score: 0.3712
2025-06-02 15:26:29,500 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 15:26:29,500 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2507, MLP Score: 0.0000
2025-06-02 15:26:29,500 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9538, MLP Score: 0.0000
2025-06-02 15:26:29,501 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0529, MLP Score: 0.0000
2025-06-02 15:26:29,501 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7526, MLP Score: 0.0000
2025-06-02 15:26:29,501 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7513, MLP Score: 0.0000
2025-06-02 15:26:29,501 - INFO - 
--- Processing file: nw_graph_encoded_1748870025.dot (Timestamp: 2025-06-02 15:13:45) ---
2025-06-02 15:26:29,502 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870025.dot
2025-06-02 15:26:29,502 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870025.dot'.
2025-06-02 15:26:29,502 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870025.dot
2025-06-02 15:26:29,542 - INFO - Parsed 799 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870025.dot'.
2025-06-02 15:26:29,634 - INFO - Parsed 1718 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870025.dot'.
2025-06-02 15:26:29,634 - INFO - Processing node updates/additions.
2025-06-02 15:26:29,669 - INFO - Processing edge updates/additions.
2025-06-02 15:26:29,812 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:26:29,818 - INFO - Finished updating NetworkX graph.
2025-06-02 15:26:29,822 - DEBUG - Updated graph - Nodes: 799, Edges: 1718
2025-06-02 15:26:29,822 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:26:29,828 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:26:29,992 - DEBUG - Initial node features tensor shape: torch.Size([799, 30])
2025-06-02 15:26:29,999 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:26:30,003 - DEBUG - Node features tensor shape after scaling: torch.Size([799, 30])
2025-06-02 15:26:30,009 - DEBUG - Edge index tensor shape: torch.Size([2, 1718])
2025-06-02 15:26:30,020 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:26:30,099 - DEBUG - Initial edge attributes tensor shape: torch.Size([1718, 10])
2025-06-02 15:26:30,106 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:26:30,114 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1718, 10])
2025-06-02 15:26:30,115 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:26:30,116 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:26:30,124 - INFO - Updated main graph to 799 nodes and 1718 edges.
2025-06-02 15:26:30,125 - INFO - Performing online update...
2025-06-02 15:26:30,126 - INFO - Starting online update for 25 steps.
2025-06-02 15:26:30,127 - DEBUG - Updated RunningStats: new_mean=0.942642110264984, new_var=17400000000160.617, new_n=1770
2025-06-02 15:26:30,128 - DEBUG - Updated RunningStats: new_mean=0.9393541601867237, new_var=17700000000018.457, new_n=1800
2025-06-02 15:26:30,129 - DEBUG - Updated RunningStats: new_mean=43.81154408349425, new_var=5800000191396.974, new_n=590
2025-06-02 15:26:30,129 - DEBUG - Updated RunningStats: new_mean=43.90972650801738, new_var=5900000215767.278, new_n=600
2025-06-02 15:26:30,130 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:26:30,130 - DEBUG - Online update step: 1/25
2025-06-02 15:26:30,130 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:30,130 - DEBUG - Online update step: 2/25
2025-06-02 15:26:30,130 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:30,131 - DEBUG - Online update step: 3/25
2025-06-02 15:26:30,131 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:30,131 - DEBUG - Online update step: 4/25
2025-06-02 15:26:30,131 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:30,131 - DEBUG - Online update step: 5/25
2025-06-02 15:26:30,132 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:30,132 - DEBUG - Online update step: 6/25
2025-06-02 15:26:30,132 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:30,132 - DEBUG - Online update step: 7/25
2025-06-02 15:26:30,132 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:30,133 - DEBUG - Online update step: 8/25
2025-06-02 15:26:30,133 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:30,133 - DEBUG - Online update step: 9/25
2025-06-02 15:26:30,133 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:30,133 - DEBUG - Online update step: 10/25
2025-06-02 15:26:30,133 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:30,134 - DEBUG - Online update step: 11/25
2025-06-02 15:26:30,134 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:30,134 - DEBUG - Online update step: 12/25
2025-06-02 15:26:30,134 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:30,134 - DEBUG - Online update step: 13/25
2025-06-02 15:26:30,135 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:30,135 - DEBUG - Online update step: 14/25
2025-06-02 15:26:30,135 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:30,135 - DEBUG - Online update step: 15/25
2025-06-02 15:26:30,135 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:30,135 - DEBUG - Online update step: 16/25
2025-06-02 15:26:30,136 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:30,136 - DEBUG - Online update step: 17/25
2025-06-02 15:26:30,136 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:30,136 - DEBUG - Online update step: 18/25
2025-06-02 15:26:30,136 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:30,136 - DEBUG - Online update step: 19/25
2025-06-02 15:26:30,137 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:30,137 - DEBUG - Online update step: 20/25
2025-06-02 15:26:30,137 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:30,137 - DEBUG - Online update step: 21/25
2025-06-02 15:26:30,137 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:30,137 - DEBUG - Online update step: 22/25
2025-06-02 15:26:30,138 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:30,138 - DEBUG - Online update step: 23/25
2025-06-02 15:26:30,138 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:30,138 - DEBUG - Online update step: 24/25
2025-06-02 15:26:30,138 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:30,138 - DEBUG - Online update step: 25/25
2025-06-02 15:26:30,139 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:30,139 - WARNING - No successful steps during online update.
2025-06-02 15:26:30,140 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -1.4323018e-08  2.1484528e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -4.2670660e-08
 -3.5807545e-08  1.6710189e-08  2.3871698e-08 -2.6258867e-08
  2.2966208e+00  2.9574468e+00  1.5018773e-01  4.3942428e+00
 -1.9097358e-08  3.4367959e+00  5.7058825e+00  7.5969963e+00
  1.5018773e-01  7.9912391e+00  1.1935849e-08  6.8631132e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.0145471e-08 -8.5938112e-08], current edge mean: [-8.8817167e-09  4.6108963e+02  0.0000000e+00  0.0000000e+00
 -3.0530900e-09 -2.2204292e-09  2.2204292e-09  5.5510729e-10
 -3.8857508e-09  1.1102146e-09]
2025-06-02 15:26:30,141 - DEBUG - Node drift difference: 0.0216, Edge drift difference: 0.0033
2025-06-02 15:26:30,143 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -1.4323018e-08  2.1484528e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -4.2670660e-08
 -3.5807545e-08  1.6710189e-08  2.3871698e-08 -2.6258867e-08
  2.2966208e+00  2.9574468e+00  1.5018773e-01  4.3942428e+00
 -1.9097358e-08  3.4367959e+00  5.7058825e+00  7.5969963e+00
  1.5018773e-01  7.9912391e+00  1.1935849e-08  6.8631132e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.0145471e-08 -8.5938112e-08], edge=[-8.8817167e-09  4.6108963e+02  0.0000000e+00  0.0000000e+00
 -3.0530900e-09 -2.2204292e-09  2.2204292e-09  5.5510729e-10
 -3.8857508e-09  1.1102146e-09]
2025-06-02 15:26:30,144 - DEBUG - Updated reference std: node=[0.         0.         1.0006263  1.0006263  0.         0.
 0.         1.0006263  1.0006263  1.0006263  1.0006263  1.0006263
 1.0016909  0.28879055 0.37459666 0.5672931  1.0006264  3.0588543
 2.925534   1.5144387  0.37459666 0.2476422  1.0006263  1.0006263
 0.         0.         0.         0.         1.0006263  1.0006263 ], edge=[  1.0002911 490.02286     0.          0.          1.0002911   1.0002911
   1.0002912   1.0002911   1.0002911   1.0002911]
2025-06-02 15:26:30,144 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:26:30,145 - INFO - Running anomaly detection...
2025-06-02 15:26:30,145 - INFO - Starting anomaly detection.
2025-06-02 15:26:30,176 - DEBUG - Node reconstruction errors: [17.11102   15.608038  22.382809  17.867662  13.5184765 15.812241
 20.604296  16.633173  16.633173  17.451132  16.633173  13.132648
 24.771334  13.3454895 16.239815  16.199537  13.391835  16.199537
 18.205744  15.904796  15.723694  16.239815  15.621058  11.307291
 16.092176  17.950266  16.092176  13.393682  16.338371  16.092176
 13.165975  15.787771  13.273648  17.790737  18.162333  15.280606
 16.199528  15.904796  12.12289   12.020803  17.389929  15.977081
 15.904796  16.89964   12.955867  11.606063  17.970068  11.876538
 16.073055  30.127558  31.501488  17.145906  17.67923   17.075802
 15.968326  12.68773   20.286709  15.409903  17.878696  17.345396
 12.67784   15.14371   15.745419  10.993167  16.259447  15.968324
 16.168928  15.968344  15.745418  15.745418  15.625612  15.019018
 16.12543   15.528765  15.654157  15.095171  16.526936  15.556211
 15.36509   15.453523  17.120943  15.096293  10.498066  15.783565
 15.013382  11.3995    14.729661  15.282165  16.280462  15.1692705
 16.140585  14.028701  11.949433  15.531387  15.592115  26.898916
 16.746504  15.321865  15.272269  15.984638  14.746996  16.746504
 17.323822  16.521135  11.029541  15.701475  11.410965  11.485801
 12.285595  22.73791   15.968496  16.931488  12.44208   12.610309
 14.903482  14.629771  14.849156  12.967169  15.510688  15.486431
 15.896859  11.860979  12.239549  11.222468  16.160389  15.486344
 11.239362  11.444795  15.206301  15.120865  16.37895   16.236864
 15.703901  13.198699  14.774527  15.911498  16.503496  15.366827
 11.565456  13.2303095 16.007814  14.881389  15.825787  16.113482
 16.032238  14.938475  14.849157  16.408314  15.509337  15.434256
 19.423958  11.175171  15.114836  16.236864  13.525143  13.060784
 15.965722  14.836283  14.746998  17.488888  16.03224   11.582231
 15.965719  16.378948  14.6596985 13.353134  14.5115    15.162751
 11.708243  15.279436  15.388674  15.449831  16.070627  25.605991
 15.3031025 15.034257  15.343111  15.407933  14.613935  14.6139345
 15.59011   12.026231  15.428889  12.375551  13.665597  15.25765
 15.707559  14.889977  15.80047   15.848883  15.226761  15.40916
 16.633104  16.111898  11.565318  16.717909  10.45683   15.650507
 13.028518  15.481553  15.302367  15.965722  12.702838  15.022707
 15.685592  11.364819  16.112825  14.28952   15.18863   15.025012
 14.543567  14.806154  16.909477  15.335137  16.029148  15.5742445
 14.6099825 14.849155  14.551349  16.111897  12.572737  15.707559
 15.91983   16.909477  15.965719  15.984116  13.196216  16.204496
 15.24871   12.01264   11.145313  16.147587  15.18925   14.849155
 14.8491535 16.717913  15.354356  15.919832  15.965719  16.357365
 13.132432  15.258628  16.258236  16.083277  16.052341  15.230954
 14.853469  15.38403   16.258236  15.760502  16.070627  15.8810625
 14.55135   15.068278  14.6189785 15.696292  15.848883  14.998474
 15.395788  14.613934  14.772511  11.595563  16.232237  15.434716
 15.079515  15.483261  15.734746  15.852505  15.734746  14.509282
 12.474298  12.241099  15.252221  16.526333  14.374604  14.613937
 15.566158  15.942809  15.59011   15.102242  14.429797  15.635646
 15.267459  16.638597  15.896337  16.100225  14.238872  12.074687
 12.026234  12.563359  15.3594265 16.397417  15.772834  16.052341
 12.920859  14.912601  15.021408  14.613958  16.717913  11.143989
 15.020719  15.089161  14.270649  15.401406  15.089161  15.08916
 15.089161  14.344855  15.016056  15.089161  15.089161  12.841008
 15.089161  15.757059  11.044704  15.131622  15.19755   11.79982
 16.786129  16.677847  15.6546    15.559572  16.0208    14.270651
 11.386909  12.302405  15.132401  14.344854  14.970139  14.970141
 16.43199   16.63003   15.08916   14.3746    15.089161  14.344855
 15.320078  15.726506  15.1324    15.132401  15.089161  15.499378
 15.132401  15.446943  15.792643  15.88736   14.270648  16.019648
 15.7752905 15.17336   15.08916   14.762059  12.380514  15.160977
 15.417522  15.848883  14.905313  15.08916   15.217087  15.523205
 14.543563  15.230218  16.163826  15.909621  14.27065   20.033567
 15.721029  13.658756  14.705964  14.599694  15.158843  15.930048
 15.845804  12.455061  15.034365  15.161047  15.790958  15.413575
 15.651672  15.08916   14.270648  11.490378  15.960617  15.1897955
 11.485656  15.771841  15.885241  10.955038  15.027814  15.08916
 15.78547   14.374857  14.437916  14.356074  14.934568  14.934568
 14.934567  17.084774  14.985927  17.273268  15.689977  15.263913
 14.934567  14.985928  14.478055  14.437918  15.401408  15.693724
 14.437914  11.454252  14.934568  14.437914  14.985927  14.934568
 14.934567  15.319193  15.366947  14.934568  15.790965  15.512626
 15.664948  15.652986  14.584054  15.8911295 12.047385  15.644205
 15.652986  15.003691  12.058227  11.76081   15.548495  15.431821
 14.865455  15.458951  14.934568  14.934568  15.689976  16.00594
 12.051819  15.125619  15.479361  15.236497  16.204107  15.493434
 15.480093  11.958184  15.125129  15.828248  16.747372  15.867916
 15.839932  15.605981  15.906186  14.907104  15.605982  15.588027
 15.8911295 15.926703  16.417717  14.584051  14.631321  15.972634
 15.864924  12.421878  15.864924  15.972632  15.493591  14.501857
 12.121994  16.79098   15.493591  14.631323  15.964588  13.178773
 15.165186  14.584257  14.501855  14.631321  15.55621   15.956091
 16.52541   13.044362  15.515069  15.828248  12.342669  15.286691
 15.605982  11.472162  16.127752  13.165674  14.585952  15.556212
 15.124968  15.577821  14.543019  15.926702  14.580812  17.3077
 14.907103  15.956094  16.716837  15.57782   16.716837  15.427246
 15.412784  11.895567  14.857107  13.475702  15.906187  15.605983
 11.884628  15.185971  15.185971  15.480096  14.863184  15.480094
 14.857108  14.137198  16.982477  15.122766  14.137198  15.236497
 14.857106  16.839117  15.412785  14.5808115 16.060234  11.272857
 14.1372    15.808341  15.479361  14.907104  14.907104  15.956094
 14.580812  14.386539  14.695934  16.034925  14.907104  15.16747
 14.907103  15.167471  15.132001  14.137201  15.110586  16.438831
 11.012173  14.852695  15.185751  14.852696  14.852696  14.852695
 14.852695  14.852695  14.852695  14.852695  14.144849  15.106787
 16.078777  14.852696  14.852695  14.852696  14.852696  14.852696
 14.852695  14.852696  14.852695  14.852695  14.103154  14.852696
 14.852696  11.559695  14.852696  11.208072  12.956725  14.907103
 13.390407  15.329632  17.52973   17.52973   15.993591  13.390407
 14.907104  14.857108  14.857108  14.907104  14.857106  15.687939
 15.34991   14.852696  15.236497  14.907103  15.185971  14.907103
 14.907104  14.780776  14.907103  14.857106  14.907103  14.907103
 14.137201  14.857106  14.907104  14.857106  14.907104  14.907104
 14.907104  15.42162   14.543019  14.543015  14.852695  14.943682
 12.769629  14.907104  14.857105  15.350896  14.852696  14.857108
 15.945684  14.818542  14.907104  14.907103  14.654436  15.421037
 14.430986  14.907103  14.144843  14.780775  14.857105  10.761928
 14.852696  14.857108  14.1372    14.852695  14.852695  14.144848
 14.780777  14.907103  15.791126  15.339351  15.353624  15.421039
 16.170893  14.839895  14.839895  12.907587  15.481628  14.852696
 15.145509  14.762239  15.421037  14.330871  15.547381  15.513198
 14.821798  14.821795  14.821797  14.821797  14.821798  14.090829
 14.066045  14.821797  14.821797  14.852696  14.768309  14.852696
 14.839895  15.381328  14.839894  15.327714  14.839895  15.63812
 14.103155  15.042943  14.103154  14.852696  14.839895  15.354814
 14.81415   14.814152  14.821798  15.354814  15.751962  15.297521
 14.852696  14.852696  14.821798  15.513196  14.814152  14.772395
 15.513198  15.284332  14.090829  13.10411   15.28433   12.724686
 14.333715  15.513196  15.633631  15.321524  15.50508   15.50508
 14.83766   14.811695  14.826652  15.513196  15.513196  15.513199
 15.48807   15.513196  15.513196  15.505078  15.513198  15.513198
 15.513198  14.365851  15.313851  15.778699  15.704092  15.131069
 15.847656  15.494828  15.790697  16.931818  15.525544  15.335261
 15.527226  14.953103  14.953103  15.505078  13.117193  15.157395
 15.52555   14.82896   16.089848  13.510696  15.382659  15.382659
 15.382659  14.871894  15.585728  12.028029  16.341509  16.75355
 16.45368   15.541223  15.170826  14.82896   15.878835  14.607638
 15.527226  16.777939  15.525548  15.157379  14.82896   15.343567
 15.527226  15.172285  15.382659  14.871896  15.527226  15.173909
 15.004174  14.871893  14.871893  14.871894  15.239553  14.195231
  9.202531  15.382659  16.012506  14.871896  15.403412  15.309338
 17.441492  15.309338  14.871893  14.93985   15.309338  15.571875
 14.93985   15.309338  31.262428  15.872034  15.01604   15.309338
 15.016039  15.081348  15.662296  15.551213  14.93985   15.643484
 15.643487  15.551212  16.101067  14.939851  15.309339  15.662294
 15.30934  ]
2025-06-02 15:26:30,177 - DEBUG - Edge reconstruction errors: [  5.255437    5.2569914  44.250576  ...  13.350522  535.2511
  13.350528 ]
2025-06-02 15:26:30,180 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152630_update_31.json
2025-06-02 15:26:30,181 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:26:30,195 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152630_update_31.pth
2025-06-02 15:26:30,195 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870025.dot): 0.1638
2025-06-02 15:26:30,196 - WARNING - Detected 11 anomalous nodes (reconstruction-based):
2025-06-02 15:26:30,196 - WARNING -   Node ID: 192.168.27.13, Recon Error: 22.3828, MLP Score: 0.2364
2025-06-02 15:26:30,196 - WARNING -   Node ID: 192.168.27.12, Recon Error: 20.6043, MLP Score: 0.2229
2025-06-02 15:26:30,196 - WARNING -   Node ID: 192.168.27.10, Recon Error: 24.7713, MLP Score: 0.2102
2025-06-02 15:26:30,196 - WARNING -   Node ID: ff02::2, Recon Error: 30.1276, MLP Score: 0.3986
2025-06-02 15:26:30,197 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 31.5015, MLP Score: 0.3767
2025-06-02 15:26:30,197 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 15:26:30,197 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2505, MLP Score: 0.0000
2025-06-02 15:26:30,197 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9537, MLP Score: 0.0000
2025-06-02 15:26:30,198 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0527, MLP Score: 0.0000
2025-06-02 15:26:30,198 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7523, MLP Score: 0.0000
2025-06-02 15:26:30,198 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7513, MLP Score: 0.0000
2025-06-02 15:26:30,211 - DEBUG - Embedding standard deviations before t-SNE: [9.8701435e-01 1.7030120e-01 0.0000000e+00 5.1894689e-01 1.0391824e-01
 0.0000000e+00 4.5564353e-01 6.3012177e-01 0.0000000e+00 6.6119730e-01
 0.0000000e+00 0.0000000e+00 0.0000000e+00 1.2937942e-02 5.9529281e-01
 4.1847762e-01 1.4829575e-01 7.0510358e-01 0.0000000e+00 7.6432544e-01
 0.0000000e+00 5.7092178e-01 0.0000000e+00 0.0000000e+00 0.0000000e+00
 0.0000000e+00 5.2141052e-01 7.1709603e-01 5.1965751e-03 9.5938944e-05
 5.9310228e-01 3.6999089e-01]
2025-06-02 15:26:42,275 - INFO - Embeddings visualization saved to vis/embeddings_31_updates_20250602_152630.png
2025-06-02 15:26:42,275 - INFO - Performing visualization of node and edge features.
2025-06-02 15:26:42,281 - INFO - Starting visualization of node features.
2025-06-02 15:26:42,282 - INFO - Graph has 799 nodes and 30 features.
2025-06-02 15:26:42,282 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:26:42,282 - INFO - Calculating feature statistics:
2025-06-02 15:26:42,282 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:26:42,283 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:26:42,283 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 16, 'mean': np.float32(0.0), 'std': np.float32(0.9999999), 'min': np.float32(-2.2631247), 'max': np.float32(2.2575989)}
2025-06-02 15:26:42,283 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 16, 'mean': np.float32(3.8194717e-08), 'std': np.float32(0.9999999), 'min': np.float32(-2.1910229), 'max': np.float32(2.3384998)}
2025-06-02 15:26:42,284 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:26:42,284 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:26:42,284 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:26:42,285 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(-3.8194717e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.4509027), 'max': np.float32(2.2177732)}
2025-06-02 15:26:42,285 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(-3.8194717e-08), 'std': np.float32(1.0), 'min': np.float32(-1.1530161), 'max': np.float32(0.86729056)}
2025-06-02 15:26:42,285 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 4, 'mean': np.float32(2.8646037e-08), 'std': np.float32(1.0), 'min': np.float32(-9.285732), 'max': np.float32(0.11055708)}
2025-06-02 15:26:42,286 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 16, 'mean': np.float32(3.8194717e-08), 'std': np.float32(1.0), 'min': np.float32(-3.0355306), 'max': np.float32(1.4744775)}
2025-06-02 15:26:42,286 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 16, 'mean': np.float32(-1.9097358e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.4472969), 'max': np.float32(3.1356149)}
2025-06-02 15:26:42,286 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 9, 'mean': np.float32(2.2966208), 'std': np.float32(1.0010638), 'min': np.float32(0.0), 'max': np.float32(11.0)}
2025-06-02 15:26:42,287 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.9574468), 'std': np.float32(0.28860977), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:26:42,287 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.15018773), 'std': np.float32(0.37436214), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:26:42,287 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.394243), 'std': np.float32(0.566938), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:26:42,288 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 4, 'mean': np.float32(-1.9097358e-08), 'std': np.float32(1.0), 'min': np.float32(-0.11055708), 'max': np.float32(9.285733)}
2025-06-02 15:26:42,288 - INFO - - service_1: {'name': 'service_1', 'unique': 5, 'mean': np.float32(3.436796), 'std': np.float32(3.0569396), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 15:26:42,288 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.7058825), 'std': np.float32(2.923703), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:26:42,288 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.5969963), 'std': np.float32(1.5134907), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:26:42,289 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.15018773), 'std': np.float32(0.37436214), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:26:42,289 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 2, 'mean': np.float32(7.991239), 'std': np.float32(0.24748717), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:26:42,289 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(-2.3871698e-09), 'std': np.float32(1.0), 'min': np.float32(-0.13463752), 'max': np.float32(15.2332735)}
2025-06-02 15:26:42,290 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(-4.7743396e-09), 'std': np.float32(1.0), 'min': np.float32(-0.14744195), 'max': np.float32(6.78233)}
2025-06-02 15:26:42,290 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:26:42,290 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:26:42,291 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:26:42,291 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:26:42,291 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(-1.9097358e-08), 'std': np.float32(1.0), 'min': np.float32(-0.98786825), 'max': np.float32(8.7366495)}
2025-06-02 15:26:42,292 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(-5.7292073e-08), 'std': np.float32(1.0), 'min': np.float32(-1.096277), 'max': np.float32(4.459275)}
2025-06-02 15:26:42,364 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7f9290d26450>
2025-06-02 15:26:43,184 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:26:43,589 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:26:43,766 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:26:48,587 - INFO - Node feature visualization saved to vis/node_features_20250602_152644.png
2025-06-02 15:26:48,588 - INFO - Finished visualization of node features.
2025-06-02 15:26:48,588 - INFO - Performing additional feature analysis:
2025-06-02 15:26:48,588 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:26:48,599 - INFO - Starting visualization of edge features.
2025-06-02 15:26:48,599 - INFO - Graph has 1718 edges and 10 edge features.
2025-06-02 15:26:48,599 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:26:48,600 - INFO - Calculating edge feature statistics:
2025-06-02 15:26:48,601 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:26:48,601 - INFO - - count: {'name': 'count', 'unique': 28, 'mean': np.float32(-4.4408583e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.04193423), 'max': np.float32(32.319332)}
2025-06-02 15:26:48,601 - INFO - - dst_port: {'name': 'dst_port', 'unique': 17, 'mean': np.float32(461.08963), 'std': np.float32(489.88022), 'min': np.float32(0.0), 'max': np.float32(8898.0)}
2025-06-02 15:26:48,602 - INFO - - protocol: {'name': 'protocol', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:26:48,602 - INFO - - service: {'name': 'service', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:26:48,602 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 1147, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.07043896), 'max': np.float32(30.815102)}
2025-06-02 15:26:48,602 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 1215, 'mean': np.float32(-4.4408583e-09), 'std': np.float32(1.0), 'min': np.float32(-0.06402924), 'max': np.float32(31.744682)}
2025-06-02 15:26:48,602 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 393, 'mean': np.float32(2.2204292e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.052897945), 'max': np.float32(32.174114)}
2025-06-02 15:26:48,602 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 1192, 'mean': np.float32(1.1102146e-09), 'std': np.float32(1.0), 'min': np.float32(-0.0993745), 'max': np.float32(26.157906)}
2025-06-02 15:26:48,603 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 1209, 'mean': np.float32(-4.9959654e-09), 'std': np.float32(1.0), 'min': np.float32(-0.09994788), 'max': np.float32(25.52512)}
2025-06-02 15:26:48,603 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 446, 'mean': np.float32(-1.1102146e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.065954395), 'max': np.float32(31.160322)}
2025-06-02 15:26:48,674 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7f92a0efc650>
2025-06-02 15:26:49,131 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:26:49,198 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7f9290e2f7a0>
2025-06-02 15:26:49,576 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:26:50,022 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:26:50,433 - DEBUG - Plotted boxplots of the first 8 non-constant edge features.
2025-06-02 15:26:50,515 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:26:50,546 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:26:54,358 - INFO - Edge feature visualization saved to vis/edge_features_20250602_152650.png
2025-06-02 15:26:54,359 - INFO - Finished visualization of edge features.
2025-06-02 15:26:54,359 - INFO - Performing additional edge feature analysis:
2025-06-02 15:26:54,359 - INFO - - 2 out of 10 edge features are constant.
2025-06-02 15:26:54,360 - INFO - - Highest correlation (1.00) between features: 'total_resp_ip_bytes' and 'total_resp_bytes'.
2025-06-02 15:26:54,370 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:26:54,371 - INFO - Graph has 1718 edges and 10 edge features.
2025-06-02 15:26:54,371 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:26:55,860 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_152654_summary.png
2025-06-02 15:26:56,803 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_152654_pca_3d.png
2025-06-02 15:26:57,311 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_152654_pca_variance.png
2025-06-02 15:26:57,311 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:26:57,311 - INFO - 
--- Processing file: nw_graph_encoded_1748870055.dot (Timestamp: 2025-06-02 15:14:15) ---
2025-06-02 15:26:57,311 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870055.dot
2025-06-02 15:26:57,312 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870055.dot'.
2025-06-02 15:26:57,312 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870055.dot
2025-06-02 15:26:57,342 - INFO - Parsed 805 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870055.dot'.
2025-06-02 15:26:57,441 - INFO - Parsed 1734 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870055.dot'.
2025-06-02 15:26:57,441 - INFO - Processing node updates/additions.
2025-06-02 15:26:57,481 - INFO - Processing edge updates/additions.
2025-06-02 15:26:57,628 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:26:57,634 - INFO - Finished updating NetworkX graph.
2025-06-02 15:26:57,637 - DEBUG - Updated graph - Nodes: 805, Edges: 1734
2025-06-02 15:26:57,637 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:26:57,644 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:26:57,804 - DEBUG - Initial node features tensor shape: torch.Size([805, 30])
2025-06-02 15:26:57,807 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:26:57,808 - DEBUG - Node features tensor shape after scaling: torch.Size([805, 30])
2025-06-02 15:26:57,813 - DEBUG - Edge index tensor shape: torch.Size([2, 1734])
2025-06-02 15:26:57,824 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:26:57,903 - DEBUG - Initial edge attributes tensor shape: torch.Size([1734, 10])
2025-06-02 15:26:57,907 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:26:57,910 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1734, 10])
2025-06-02 15:26:57,911 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:26:57,911 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:26:57,915 - INFO - Updated main graph to 805 nodes and 1734 edges.
2025-06-02 15:26:57,915 - INFO - Performing online update...
2025-06-02 15:26:57,916 - INFO - Starting online update for 25 steps.
2025-06-02 15:26:57,917 - DEBUG - Updated RunningStats: new_mean=0.9429041022205888, new_var=18000000000160.73, new_n=1830
2025-06-02 15:26:57,917 - DEBUG - Updated RunningStats: new_mean=0.9397072950483281, new_var=18300000000018.41, new_n=1860
2025-06-02 15:26:57,918 - DEBUG - Updated RunningStats: new_mean=43.94550595787562, new_var=6000000191251.641, new_n=610
2025-06-02 15:26:57,918 - DEBUG - Updated RunningStats: new_mean=44.0347084341112, new_var=6100000213737.563, new_n=620
2025-06-02 15:26:57,919 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:26:57,919 - DEBUG - Online update step: 1/25
2025-06-02 15:26:57,919 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:57,919 - DEBUG - Online update step: 2/25
2025-06-02 15:26:57,920 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:57,920 - DEBUG - Online update step: 3/25
2025-06-02 15:26:57,920 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:57,920 - DEBUG - Online update step: 4/25
2025-06-02 15:26:57,920 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:57,921 - DEBUG - Online update step: 5/25
2025-06-02 15:26:57,921 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:57,921 - DEBUG - Online update step: 6/25
2025-06-02 15:26:57,921 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:57,921 - DEBUG - Online update step: 7/25
2025-06-02 15:26:57,921 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:57,922 - DEBUG - Online update step: 8/25
2025-06-02 15:26:57,922 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:57,922 - DEBUG - Online update step: 9/25
2025-06-02 15:26:57,922 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:57,922 - DEBUG - Online update step: 10/25
2025-06-02 15:26:57,922 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:57,923 - DEBUG - Online update step: 11/25
2025-06-02 15:26:57,923 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:57,923 - DEBUG - Online update step: 12/25
2025-06-02 15:26:57,923 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:57,923 - DEBUG - Online update step: 13/25
2025-06-02 15:26:57,923 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:57,924 - DEBUG - Online update step: 14/25
2025-06-02 15:26:57,924 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:57,924 - DEBUG - Online update step: 15/25
2025-06-02 15:26:57,924 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:57,924 - DEBUG - Online update step: 16/25
2025-06-02 15:26:57,924 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:57,925 - DEBUG - Online update step: 17/25
2025-06-02 15:26:57,925 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:57,925 - DEBUG - Online update step: 18/25
2025-06-02 15:26:57,925 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:57,925 - DEBUG - Online update step: 19/25
2025-06-02 15:26:57,925 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:57,926 - DEBUG - Online update step: 20/25
2025-06-02 15:26:57,926 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:57,926 - DEBUG - Online update step: 21/25
2025-06-02 15:26:57,926 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:57,926 - DEBUG - Online update step: 22/25
2025-06-02 15:26:57,926 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:57,927 - DEBUG - Online update step: 23/25
2025-06-02 15:26:57,927 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:57,927 - DEBUG - Online update step: 24/25
2025-06-02 15:26:57,927 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:57,927 - DEBUG - Online update step: 25/25
2025-06-02 15:26:57,927 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:26:57,927 - WARNING - No successful steps during online update.
2025-06-02 15:26:57,929 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  5.9234428e-10 -3.9094722e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.5470804e-08
  2.0139707e-08  2.6063150e-08 -2.3693771e-09  1.8955017e-08
  2.2968943e+00  2.9577639e+00  1.4658386e-01  4.3987579e+00
 -1.8955017e-08  3.4161491e+00  5.7304349e+00  7.5925465e+00
  1.4658386e-01  7.9913044e+00  2.0732051e-08 -2.3693772e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -6.2196150e-09 -4.7387543e-09], current edge mean: [ 3.2999112e-09  4.6092273e+02  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -2.1999407e-09  4.3998813e-09 -2.7499258e-09
 -1.2374667e-09  0.0000000e+00]
2025-06-02 15:26:57,929 - DEBUG - Node drift difference: 0.0096, Edge drift difference: 0.0003
2025-06-02 15:26:57,931 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  5.9234428e-10 -3.9094722e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.5470804e-08
  2.0139707e-08  2.6063150e-08 -2.3693771e-09  1.8955017e-08
  2.2968943e+00  2.9577639e+00  1.4658386e-01  4.3987579e+00
 -1.8955017e-08  3.4161491e+00  5.7304349e+00  7.5925465e+00
  1.4658386e-01  7.9913044e+00  2.0732051e-08 -2.3693772e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -6.2196150e-09 -4.7387543e-09], edge=[ 3.2999112e-09  4.6092273e+02  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -2.1999407e-09  4.3998813e-09 -2.7499258e-09
 -1.2374667e-09  0.0000000e+00]
2025-06-02 15:26:57,932 - DEBUG - Updated reference std: node=[0.         0.         1.0006217  1.0006217  0.         0.
 0.         1.0006217  1.0006218  1.0006217  1.0006217  1.0006217
 1.0000262  0.28773427 0.3710666  0.5675718  1.0006218  3.0480378
 2.9194205  1.52196    0.3710666  0.24671759 1.0006217  1.0006217
 0.         0.         0.         0.         1.0006217  1.0006217 ], edge=[  1.0002885 487.75858     0.          0.          1.0002885   1.0002885
   1.0002885   1.0002885   1.0002885   1.0002885]
2025-06-02 15:26:57,932 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:26:57,932 - INFO - Running anomaly detection...
2025-06-02 15:26:57,933 - INFO - Starting anomaly detection.
2025-06-02 15:26:57,954 - DEBUG - Node reconstruction errors: [17.114428  15.643587  22.455158  17.828636  13.53164   15.82846
 20.668653  16.58981   16.589808  17.405893  16.58981   13.116796
 24.863125  13.363242  16.207249  16.154913  13.391614  16.154913
 18.173426  15.872935  15.727099  16.207247  15.633448  11.322362
 16.069391  17.919424  16.069395  13.411816  16.307629  16.069391
 13.185039  15.802069  13.27742   17.762878  18.129667  15.280804
 16.219362  15.872935  12.153701  12.029128  17.370457  15.95678
 15.872935  16.90524   12.992581  11.931144  17.974918  11.877822
 16.055971  30.15269   31.574778  17.12641   17.661497  17.096224
 15.979798  12.705352  20.360365  15.398569  17.881033  17.367296
 12.696934  15.15402   15.735292  11.004934  16.251606  15.979798
 16.17864   15.979813  15.735292  15.735292  15.634745  15.020553
 16.139086  15.5434    15.677018  15.0949955 16.525118  15.566374
 15.390149  15.469422  17.11916   15.118556  10.463056  15.794873
 15.027737  11.411558  14.74718   15.299028  16.297039  15.196604
 16.142588  14.051971  11.966465  15.558568  15.614878  26.105677
 16.751682  15.349212  15.282741  15.997574  14.759355  16.751684
 17.334194  16.54888   11.033655  15.718335  11.437707  11.5126295
 12.296783  23.236944  15.9649315 16.937906  12.400502  12.631192
 14.920743  14.650674  14.867062  12.988425  15.530982  15.509238
 15.906591  11.879187  12.25938   11.245036  16.18807   15.50916
 11.2540865 11.461429  15.226355  15.141862  16.390562  16.248158
 15.707476  13.218688  14.794291  15.925289  16.516613  15.373278
 11.577737  13.270095  16.019812  14.905421  15.837808  16.128513
 16.045773  14.611808  14.867062  16.413555  15.523206  15.456943
 19.42687   11.185317  15.132041  16.248158  13.67638   13.088269
 15.982386  14.865041  14.759353  17.492563  16.045774  11.599832
 15.982386  16.390562  14.675306  13.372863  14.527066  15.186804
 11.725696  15.304009  15.405589  15.47207   16.074179  25.676632
 15.324388  14.95416   15.367437  15.435364  14.630223  14.630222
 15.608085  12.039962  15.445044  12.392073  13.679869  15.274064
 15.721695  14.913147  15.8154    15.86745   15.255105  15.438569
 16.64048   16.123138  11.577621  16.73517   10.501066  15.65459
 13.048458  15.500085  15.323281  15.9823885 12.724577  15.043594
 15.520971  11.430829  16.125385  14.329843  15.201252  15.045671
 14.561504  14.824753  16.92091   15.366366  16.047451  15.589861
 14.633094  14.867057  14.569956  16.12314   12.5969515 15.721699
 15.927124  16.920908  15.982386  16.007236  13.218357  16.211393
 15.269919  12.023316  11.149558  16.17939   15.212885  14.867062
 14.867061  16.73517   15.384155  15.927124  15.982386  16.362146
 13.1560335 15.288468  16.267162  16.100893  16.064247  15.248529
 14.880651  15.395695  16.26716   15.771755  16.074179  15.885781
 14.569956  15.094962  14.635179  15.714727  15.86745   15.016386
 15.403304  14.630225  14.798616  11.610028  16.240452  15.458206
 15.094156  15.505933  15.756872  15.897446  15.756872  14.538115
 12.497343  12.261194  15.282507  16.52824   14.395153  14.630221
 15.584986  15.96253   15.608085  15.139942  14.450146  15.652324
 15.293006  16.647488  15.9183235 16.108896  14.285056  12.09262
 12.039964  12.609793  15.37554   16.412378  15.787976  16.064249
 12.9669485 14.929372  15.051386  14.630247  16.735167  11.1517935
 15.046436  15.103019  14.293359  15.414446  15.103019  15.103019
 15.103017  14.365942  15.032289  15.103017  15.103017  12.857281
 15.103017  15.776113  11.056554  15.158014  15.214388  11.81849
 16.80072   16.695406  15.679288  15.579844  16.038385  14.293356
 11.396758  12.3211975 15.14584   14.365942  14.99155   14.991551
 16.456806  16.647573  15.103019  14.395147  15.103019  14.365943
 15.339589  15.736425  15.145841  15.14584   15.103019  15.5100155
 15.145842  15.459977  15.824447  15.912731  14.293356  16.030401
 15.7927265 15.197122  15.103019  14.789185  12.406048  15.180186
 15.431302  15.86745   14.92405   15.103017  15.22726   15.524812
 14.561506  15.249456  16.188332  15.942007  14.29336   20.10099
 15.734097  13.67546   14.726557  14.621863  15.189717  15.959747
 15.867593  12.4738245 15.057466  15.180263  15.801688  15.428484
 15.681299  15.103017  14.293359  11.505823  15.976897  15.215209
 11.498742  15.811571  15.89925   10.968403  15.046149  15.103019
 15.805064  14.394018  14.4569025 14.374993  14.954237  14.954237
 14.954237  17.113008  15.002077  17.302204  15.707244  15.284251
 14.954236  15.002075  14.501764  14.45691   15.414446  15.713738
 14.456905  11.472477  14.954237  14.456903  15.002077  14.954237
 14.954237  15.332896  15.380833  14.954237  15.801687  15.513619
 15.684767  15.662195  14.605903  15.905365  12.060255  15.651827
 15.662194  15.023136  12.075258  11.761664  15.571624  15.448866
 14.891964  15.480388  14.954237  14.954239  15.707245  16.025753
 12.068093  15.147159  15.484064  15.255131  16.234385  15.503933
 15.4881935 11.969495  13.805114  15.837506  16.759134  15.881524
 15.858928  15.618555  15.920503  14.924146  15.618556  15.600252
 15.905365  15.941538  16.428482  14.53566   14.652907  15.988085
 15.877411  12.440654  15.877411  15.988085  15.509099  14.516956
 12.136602  16.804504  15.509098  14.652905  15.983268  13.217847
 15.188085  14.606101  14.53566   14.652902  15.569187  15.970256
 16.537935  13.065192  15.526235  15.837507  12.368216  15.294007
 15.618555  11.481737  16.142052  13.205687  14.61331   15.569188
 15.140591  15.591463  14.5639305 15.941539  14.601922  17.325108
 14.924149  15.970259  16.730005  15.591462  16.730005  15.447537
 15.428019  11.909558  14.874643  13.521764  15.852537  15.618555
 11.893251  15.205037  15.205037  15.488194  14.888846  15.488194
 14.874643  14.160981  16.993069  15.152279  14.160981  15.255131
 14.874643  16.853573  15.428016  14.601915  16.075382  11.286774
 14.16098   15.828828  15.484063  14.924146  14.924148  15.970256
 14.601913  14.405311  14.71991   16.060858  14.924149  15.184668
 14.924146  15.184668  15.163774  14.16098   15.124527  16.448383
 11.02407   14.869175  15.232614  14.869175  14.869175  14.869175
 14.869175  14.869175  14.869175  14.869175  14.168101  15.116523
 16.090986  14.869175  14.869175  14.869175  14.869175  14.869175
 14.869178  14.86918   14.869178  14.869175  14.125283  14.869175
 14.869175  11.572706  14.869175  11.211338  12.9593    14.924146
 13.390548  15.343541  17.530514  17.530514  16.012754  13.390548
 14.924146  14.874643  14.874643  14.924146  14.874643  15.697253
 15.362903  14.869175  15.255131  14.924149  15.205037  14.924146
 14.924146  14.793403  14.924146  14.874643  14.924148  14.924146
 14.16098   14.874643  14.924149  14.874643  14.924146  14.924146
 14.924146  15.4457035 14.56393   14.563932  14.869175  14.961929
 12.771834  14.924146  14.874643  15.367871  14.869175  14.874643
 15.167267  14.83563   14.924146  14.924146  14.673202  15.444203
 14.444668  14.924146  14.1681    14.793403  14.874643  10.785094
 14.869175  14.874643  14.16098   14.869175  14.869175  14.1681
 14.793405  14.924146  15.812256  15.355956  15.3747835 15.4442
 16.179522  14.860057  14.860057  12.908798  15.4806    14.869178
 15.163128  14.771354  15.444203  14.346706  15.559255  15.523028
 14.836489  14.836489  14.836489  14.836489  14.836489  14.109757
 14.076669  14.836489  14.836489  14.869175  14.776753  14.869175
 14.860057  15.404019  14.860057  15.339966  14.860057  15.661985
 14.12528   15.0512705 14.125281  14.869175  14.860057  15.369035
 14.830287  14.83029   14.836489  15.369036  15.773405  15.306935
 14.869175  14.869175  14.836489  15.485248  14.830288  14.783996
 15.523026  15.287946  14.109757  13.126952  15.287948  12.736048
 14.342041  15.523028  15.634886  15.333694  15.510831  15.51083
 14.851948  14.822042  14.844484  15.523026  15.523028  15.523026
 15.495777  15.523026  15.523026  15.51083   15.523026  15.523028
 15.523028  14.373845  15.322279  15.788423  15.717436  15.141095
 15.844328  15.493548  15.795866  16.948252  15.525272  15.33781
 15.5233755 14.959654  14.959654  15.51083   13.124613  15.166401
 15.525275  14.833325  16.08939   12.808636  15.378759  15.378758
 15.378759  14.869765  15.574412  12.02238   16.337776  16.761826
 16.448761  15.532868  15.174417  14.833325  15.881256  14.613894
 15.523377  16.779997  15.525273  15.166383  14.833325  15.455112
 15.523377  15.168843  15.378758  14.869763  15.523377  15.183116
 15.004197  14.869765  14.869763  14.869763  15.234793  14.197875
  9.217472  15.378758  16.014061  14.869763  15.401094  15.301114
 17.44399   15.301114  14.869763  14.929114  15.301116  15.565065
 14.929113  15.301114  31.300148  15.858002  15.011692  15.301114
 15.011692  15.073701  15.648348  15.549212  14.929113  15.627644
 15.6276455 15.549212  16.098064  14.929113  15.301114  15.648348
 15.301114  15.722905  15.722905  15.722902  15.627646  15.722903
 15.722905 ]
2025-06-02 15:26:57,955 - DEBUG - Edge reconstruction errors: [  5.2557573   5.2566953  44.250813  ...  13.350765  535.25134
  13.350771 ]
2025-06-02 15:26:57,958 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152657_update_32.json
2025-06-02 15:26:57,958 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:26:57,972 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152657_update_32.pth
2025-06-02 15:26:57,973 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870055.dot): 0.1649
2025-06-02 15:26:57,973 - WARNING - Detected 11 anomalous nodes (reconstruction-based):
2025-06-02 15:26:57,973 - WARNING -   Node ID: 192.168.27.13, Recon Error: 22.4552, MLP Score: 0.2342
2025-06-02 15:26:57,973 - WARNING -   Node ID: 192.168.27.12, Recon Error: 20.6687, MLP Score: 0.2212
2025-06-02 15:26:57,974 - WARNING -   Node ID: 192.168.27.10, Recon Error: 24.8631, MLP Score: 0.2087
2025-06-02 15:26:57,974 - WARNING -   Node ID: ff02::2, Recon Error: 30.1527, MLP Score: 0.3988
2025-06-02 15:26:57,974 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 31.5748, MLP Score: 0.3773
2025-06-02 15:26:57,974 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 15:26:57,974 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2509, MLP Score: 0.0000
2025-06-02 15:26:57,975 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9537, MLP Score: 0.0000
2025-06-02 15:26:57,975 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0548, MLP Score: 0.0000
2025-06-02 15:26:57,975 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7526, MLP Score: 0.0000
2025-06-02 15:26:57,975 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7513, MLP Score: 0.0000
2025-06-02 15:26:57,976 - INFO - 
--- Processing file: nw_graph_encoded_1748870085.dot (Timestamp: 2025-06-02 15:14:45) ---
2025-06-02 15:26:57,976 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870085.dot
2025-06-02 15:26:57,976 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870085.dot'.
2025-06-02 15:26:57,976 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870085.dot
2025-06-02 15:26:58,009 - INFO - Parsed 818 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870085.dot'.
2025-06-02 15:26:58,102 - INFO - Parsed 1761 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870085.dot'.
2025-06-02 15:26:58,102 - INFO - Processing node updates/additions.
2025-06-02 15:26:58,138 - INFO - Processing edge updates/additions.
2025-06-02 15:26:58,289 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:26:58,295 - INFO - Finished updating NetworkX graph.
2025-06-02 15:26:58,298 - DEBUG - Updated graph - Nodes: 818, Edges: 1761
2025-06-02 15:26:58,298 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:26:58,304 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:26:58,474 - DEBUG - Initial node features tensor shape: torch.Size([818, 30])
2025-06-02 15:26:58,477 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:26:58,478 - DEBUG - Node features tensor shape after scaling: torch.Size([818, 30])
2025-06-02 15:26:58,482 - DEBUG - Edge index tensor shape: torch.Size([2, 1761])
2025-06-02 15:26:58,493 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:26:58,570 - DEBUG - Initial edge attributes tensor shape: torch.Size([1761, 10])
2025-06-02 15:26:58,573 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:26:58,574 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1761, 10])
2025-06-02 15:26:58,574 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:26:58,575 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:26:58,578 - INFO - Updated main graph to 818 nodes and 1761 edges.
2025-06-02 15:26:58,578 - INFO - Performing online update...
2025-06-02 15:26:58,579 - INFO - Starting online update for 25 steps.
2025-06-02 15:26:58,580 - DEBUG - Updated RunningStats: new_mean=0.9431474725346277, new_var=18600000000160.938, new_n=1890
2025-06-02 15:26:58,580 - DEBUG - Updated RunningStats: new_mean=0.9400313981362496, new_var=18900000000018.375, new_n=1920
2025-06-02 15:26:58,581 - DEBUG - Updated RunningStats: new_mean=44.066580447277005, new_var=6200000190832.944, new_n=630
2025-06-02 15:26:58,581 - DEBUG - Updated RunningStats: new_mean=44.1453949573977, new_var=6300000210496.594, new_n=640
2025-06-02 15:26:58,581 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:26:58,582 - DEBUG - Online update step: 1/25
2025-06-02 15:26:58,596 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:26:58,679 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:26:58,691 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:26:58,693 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:26:59,001 - DEBUG - Step 1: Loss=19.3833
2025-06-02 15:26:59,002 - DEBUG - Online update step: 2/25
2025-06-02 15:26:59,014 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:26:59,131 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:26:59,137 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:26:59,140 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:26:59,558 - DEBUG - Step 2: Loss=17.4599
2025-06-02 15:26:59,559 - DEBUG - Online update step: 3/25
2025-06-02 15:26:59,585 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:26:59,703 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:26:59,708 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:26:59,710 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:00,038 - DEBUG - Step 3: Loss=15.8512
2025-06-02 15:27:00,039 - DEBUG - Online update step: 4/25
2025-06-02 15:27:00,060 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:00,188 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:27:00,195 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:27:00,199 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:00,545 - DEBUG - Step 4: Loss=14.4672
2025-06-02 15:27:00,545 - DEBUG - Online update step: 5/25
2025-06-02 15:27:00,554 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:00,704 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:27:00,709 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:27:00,712 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:01,029 - DEBUG - Step 5: Loss=13.2697
2025-06-02 15:27:01,029 - DEBUG - Online update step: 6/25
2025-06-02 15:27:01,040 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:01,188 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:27:01,193 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:27:01,195 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:01,495 - DEBUG - Step 6: Loss=12.2497
2025-06-02 15:27:01,495 - DEBUG - Online update step: 7/25
2025-06-02 15:27:01,507 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:01,590 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:27:01,595 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:27:01,596 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:01,828 - DEBUG - Step 7: Loss=11.3779
2025-06-02 15:27:01,829 - DEBUG - Online update step: 8/25
2025-06-02 15:27:01,842 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:01,924 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:27:01,928 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:27:01,929 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:02,118 - DEBUG - Step 8: Loss=10.6129
2025-06-02 15:27:02,119 - DEBUG - Online update step: 9/25
2025-06-02 15:27:02,133 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:02,223 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:27:02,227 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:27:02,228 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:02,440 - DEBUG - Step 9: Loss=9.9181
2025-06-02 15:27:02,441 - DEBUG - Online update step: 10/25
2025-06-02 15:27:02,456 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:02,548 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:27:02,553 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:27:02,555 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:02,761 - DEBUG - Step 10: Loss=9.2632
2025-06-02 15:27:02,762 - DEBUG - Online update step: 11/25
2025-06-02 15:27:02,775 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:02,871 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:27:02,875 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:27:02,876 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:03,063 - DEBUG - Step 11: Loss=8.6361
2025-06-02 15:27:03,064 - DEBUG - Online update step: 12/25
2025-06-02 15:27:03,077 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:03,158 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:27:03,163 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:27:03,165 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:03,372 - DEBUG - Step 12: Loss=8.0276
2025-06-02 15:27:03,373 - DEBUG - Online update step: 13/25
2025-06-02 15:27:03,389 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:03,476 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:27:03,480 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:27:03,481 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:03,663 - DEBUG - Step 13: Loss=7.4441
2025-06-02 15:27:03,664 - DEBUG - Online update step: 14/25
2025-06-02 15:27:03,677 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:03,789 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:27:03,794 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:27:03,795 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:03,993 - DEBUG - Step 14: Loss=6.8814
2025-06-02 15:27:03,994 - DEBUG - Online update step: 15/25
2025-06-02 15:27:04,006 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:04,085 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:27:04,088 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:27:04,090 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:04,254 - DEBUG - Step 15: Loss=6.3324
2025-06-02 15:27:04,254 - DEBUG - Online update step: 16/25
2025-06-02 15:27:04,268 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:04,363 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:27:04,366 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:27:04,368 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:04,564 - DEBUG - Step 16: Loss=5.7977
2025-06-02 15:27:04,565 - DEBUG - Online update step: 17/25
2025-06-02 15:27:04,578 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:04,665 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:27:04,669 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:27:04,671 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:04,835 - DEBUG - Step 17: Loss=5.2698
2025-06-02 15:27:04,836 - DEBUG - Online update step: 18/25
2025-06-02 15:27:04,852 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:04,959 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:27:04,963 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:27:04,965 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:05,198 - DEBUG - Step 18: Loss=4.7442
2025-06-02 15:27:05,199 - DEBUG - Online update step: 19/25
2025-06-02 15:27:05,211 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:05,295 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:27:05,298 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:27:05,300 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:05,516 - DEBUG - Step 19: Loss=4.2199
2025-06-02 15:27:05,516 - DEBUG - Online update step: 20/25
2025-06-02 15:27:05,530 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:05,803 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:27:05,807 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:27:05,808 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:05,933 - DEBUG - Step 20: Loss=3.7968
2025-06-02 15:27:05,934 - DEBUG - Online update step: 21/25
2025-06-02 15:27:05,941 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:06,025 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:27:06,032 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:27:06,036 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:06,207 - DEBUG - Step 21: Loss=3.8377
2025-06-02 15:27:06,207 - DEBUG - Online update step: 22/25
2025-06-02 15:27:06,216 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:06,367 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:27:06,375 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:27:06,377 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:06,506 - DEBUG - Step 22: Loss=3.8647
2025-06-02 15:27:06,506 - DEBUG - Online update step: 23/25
2025-06-02 15:27:06,514 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:06,602 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:27:06,609 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:27:06,610 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:06,786 - DEBUG - Step 23: Loss=3.8416
2025-06-02 15:27:06,787 - DEBUG - Online update step: 24/25
2025-06-02 15:27:06,795 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:06,919 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:27:06,922 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:27:06,923 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:07,055 - DEBUG - Step 24: Loss=3.7746
2025-06-02 15:27:07,056 - DEBUG - Online update step: 25/25
2025-06-02 15:27:07,064 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:07,155 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:27:07,165 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:27:07,167 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:07,338 - DEBUG - Step 25: Loss=3.6761
2025-06-02 15:27:07,338 - INFO - Online update finished. Average loss: 8.5599, Learning rate: 0.001000
2025-06-02 15:27:07,341 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -1.9819637e-08  3.3227039e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  5.4795468e-08
  3.0312385e-08 -9.3268886e-09 -2.7980665e-08  0.0000000e+00
  2.3019559e+00  2.9584353e+00  1.4303179e-01  4.4034228e+00
  2.7980665e-08  3.4156480e+00  5.7371640e+00  7.5990219e+00
  1.4303179e-01  7.9914427e+00 -1.9819637e-08 -3.8327681e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -5.8293054e-10  2.4483082e-08], current edge mean: [-2.1662108e-09  4.6042645e+02  0.0000000e+00  0.0000000e+00
  1.6246581e-09 -5.4155269e-10 -2.7077636e-09  4.7385862e-10
  3.2493161e-09 -1.0831054e-09]
2025-06-02 15:27:07,341 - DEBUG - Node drift difference: 0.0096, Edge drift difference: 0.0010
2025-06-02 15:27:07,344 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -1.9819637e-08  3.3227039e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  5.4795468e-08
  3.0312385e-08 -9.3268886e-09 -2.7980665e-08  0.0000000e+00
  2.3019559e+00  2.9584353e+00  1.4303179e-01  4.4034228e+00
  2.7980665e-08  3.4156480e+00  5.7371640e+00  7.5990219e+00
  1.4303179e-01  7.9914427e+00 -1.9819637e-08 -3.8327681e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -5.8293054e-10  2.4483082e-08], edge=[-2.1662108e-09  4.6042645e+02  0.0000000e+00  0.0000000e+00
  1.6246581e-09 -5.4155269e-10 -2.7077636e-09  4.7385862e-10
  3.2493161e-09 -1.0831054e-09]
2025-06-02 15:27:07,346 - DEBUG - Updated reference std: node=[0.         0.         1.0006118  1.0006118  0.         0.
 0.         1.0006119  1.0006119  1.0006118  1.0006118  1.0006118
 1.0033096  0.28548482 0.36737394 0.5672308  1.0006118  3.0404615
 2.9175723  1.5106635  0.36737394 0.24474926 1.0006118  1.0006118
 0.         0.         0.         0.         1.0006118  1.0006118 ], edge=[  1.000284  484.1051      0.          0.          1.0002841   1.0002841
   1.0002841   1.0002841   1.0002841   1.0002841]
2025-06-02 15:27:07,347 - INFO - Online update complete. Loss: 8.5599
2025-06-02 15:27:07,347 - INFO - Running anomaly detection...
2025-06-02 15:27:07,348 - INFO - Starting anomaly detection.
2025-06-02 15:27:07,376 - DEBUG - Node reconstruction errors: [ 2.2982504  6.3997335 17.913412   2.6333346  2.8281333  2.5450675
 17.470264   2.749508   2.7495074  3.1104243  2.7495074  2.7657804
 21.564655   4.4481153  2.2106922  2.5560195  2.9668503  2.5560195
  4.4454236  2.4423454  2.3238637  2.2106922  2.2860365  1.9151314
  2.1302025  2.852299   2.1302025  3.3490648  2.6329832  2.1302025
  4.3976774  2.9802032  3.2396626  2.5019815  2.8466973  2.3762987
  2.960652   2.4423447  3.8199623  1.9655155  2.6940207  2.1133075
  2.4423454  2.4235017  4.524908   2.4019966  3.381251   2.3614695
  2.5349467  4.582428   9.952302   2.7890894  2.7491467  3.928312
  2.1974168  2.7486985 11.3328905  2.2733853  4.047736   3.8031774
  2.4751713  1.7957633  2.035179   2.094648   2.0168352  2.1974165
  2.0731432  2.1974158  2.035179   2.0351787  2.2782445  2.4484947
  2.112697   2.6949387  2.8099294  2.4630864  2.525028   2.4991298
  2.437124   2.503918   2.2535932  2.315026   4.8997808  5.171931
  2.6015947  1.9264699  2.2408037  2.670334   2.6653483  2.739702
  1.8890743  3.032115   2.1882331  2.4518886  2.1000872  7.908525
  2.2240186  2.514663   1.8889921  2.2166138  2.3431633  2.2240183
  2.3858473  2.726742   2.0498037  2.2324893  2.0225706  2.1670065
  2.1525352  2.747784   1.9437085  2.1580632  3.0203931  2.7043393
  2.2727396  2.2331688  2.2693605  2.747769   2.650909   2.0930736
  1.8189818  2.2525728  2.6315525  1.881358   2.592711   2.093068
  1.8558285  1.9488347  2.6855595  1.7684177  2.5350757  2.1374867
  4.4809923  3.2328389  2.2455165  2.2253826  2.4115114  1.9339992
  2.1360037  3.7897198  2.1126032  2.2051585  1.7934779  2.266446
  2.0991368  2.418585   2.2693605  2.2163408  2.177101   2.4206836
  2.685276   2.170364   2.4870617  2.1374867  3.121218   2.8374586
  2.1209114  2.3401613  2.3431647  2.4606397  2.0991366  1.9073546
  2.1209114  2.535076   2.3082736  2.7829425  2.3238547  2.436556
  2.0563262  2.4191244  2.5029883  2.1042864  1.8991839  9.484269
  2.5806682  3.0262218  2.4183555  2.4239116  2.3129344  2.3129356
  2.2393813  2.2367668  1.8974184  2.6473036  3.3213048  2.641652
  1.7968687  2.3134875  2.2298896  2.1260154  2.7570543  2.7093325
  2.5415413  2.1782694  2.136002   2.4603987  4.6557956  1.9401526
  2.7435026  1.7417245  1.7534794  2.1209114  2.7121973  2.7397993
  2.6375258  2.1996827  2.649142   4.0134044  1.853812   2.4554873
  2.287144   2.2750242  2.5313523  2.5212653  2.687198   1.7882999
  2.4930885  2.2693603  2.5252717  2.1782694  2.7701328  1.7968687
  1.874641   2.5313523  2.1209114  2.8640418  2.8304598  2.22194
  2.478882   2.1669688  1.9625973  2.6266382  2.7040014  2.2693608
  2.2693608  2.4603987  2.4595292  1.874641   2.1209114  2.181916
  2.876656   2.4717674  2.1908326  2.6236246  2.197643   2.5110908
  2.2844694  2.5349946  2.1908326  2.159518   1.8991838  1.9101304
  2.5252712  2.4560153  2.4063408  2.4318318  2.126016   1.8354734
  1.8765429  2.312934   2.43708    2.3532639  2.4410198  2.1180394
  2.7459447  2.116784   2.6148112  4.5620456  2.614812   2.3067296
  2.59984    2.6421962  2.467338   2.5281794  2.3004067  2.3129346
  1.7729858  2.831665   2.2393813  2.6745362  3.9704142  1.7954786
  2.418626   2.5019047  2.8372338  2.2424862  4.422238   2.3256865
  2.236767   3.4174201  2.2193286  2.1269028  2.1652036  2.1976428
  4.475786   1.8332604  2.480563   2.3129342  2.4603987  2.1781433
  2.463394   1.9103457  2.2957664  2.7569318  1.9103454  1.9103457
  1.9103457  2.3206775  1.8844463  1.9103454  1.9103458  3.239682
  1.9103454  2.1501489  2.227505   2.484099   2.7202334  2.204021
  2.5256655  2.456832   2.593012   2.144399   2.6508932  2.2957666
  2.105497   2.6397474  1.8770168  2.3206763  2.468985   2.4689844
  2.9854362  2.4830906  1.9103458  2.3004065  1.9103456  2.3206773
  2.2126927  1.8845347  1.8770164  1.8770167  1.9103456  1.9766366
  1.8770167  2.7336395  2.7501597  2.7307534  2.295767   2.209618
  2.646034   2.4567747  1.9103456  2.293173   2.7777364  2.6140988
  1.9417248  2.1260154  1.8622257  1.9103456  1.9123974  5.0397186
  2.2871432  2.1907234  2.2971003  2.651538   2.2957664  8.050332
  1.8424141  3.4742055  2.2651644  2.2447112  2.5021937  2.6346133
  2.8062701  2.8828657  2.463885   2.6141086  1.8686955  2.234128
  2.6562161  1.9103457  2.2957659  1.9493792  2.1373923  2.4469562
  1.986041   2.8384933  2.296035   1.955822   2.4753728  1.9103456
  2.8518624  2.2846086  2.3076663  2.3069751  2.4769416  2.4769416
  2.4769425  3.884371   1.9276477  3.865973   2.1915784  2.598815
  2.4769416  1.9276482  2.3166945  2.3076665  2.8189187  2.1269915
  2.3076675  2.2487733  2.4769423  2.3076665  1.9276477  2.4769425
  2.4769425  1.9460176  1.9696753  2.4769425  1.8686956  1.968552
  2.17022    2.2630875  2.2690094  2.1768146  2.8771942  2.3059604
  2.3589768  2.6436837  2.3705325  2.4094408  2.6423104  2.3091161
  2.4692461  2.4451947  2.4769423  2.4769425  2.1915781  2.6513028
  2.8259566  1.9095904  2.0641344  2.2906528  2.5980477  1.9206989
  1.9426206  3.1032083  3.650912   2.2564805  2.5670404  2.2223043
  2.9711459  1.9134178  2.2193325  1.9634603  1.9134178  2.3542945
  2.176814   2.173474   2.1922958  2.4548879  2.274404   2.1796803
  2.1895401  2.431081   2.1895401  2.1796803  1.8917267  2.3519595
  2.3445692  2.5084176  1.891727   2.2744038  2.734823   4.364213
  2.5154374  2.2690141  2.4548876  2.2744043  1.9062488  2.2258635
  2.1793435  3.254478   1.8732594  2.2564805  3.0447845  1.988722
  1.9134176  2.056563   2.458604   4.364213   2.3514087  1.9062494
  2.6004014  1.8581718  2.3073683  2.173474   2.3027322  4.3936386
  1.9634603  2.2258637  2.4307199  1.8581718  2.43072    1.8351222
  1.9244355  2.2262623  1.9567313  4.444987   2.3812003  1.9134177
  2.2870252  2.2856748  2.2856748  1.9426208  2.506724   2.0641344
  1.9567316  2.3457732  2.4778738  2.5789115  2.345773   2.290653
  1.9567316  2.5542898  1.9244355  2.302733   2.638934   1.8654639
  2.345773   2.7048216  2.0641344  1.9634603  1.9634603  2.2258637
  2.302733   2.334302   2.5352495  2.677747   1.9634603  2.5012372
  1.9634603  2.5012372  2.1263099  2.3457725  2.3273528  5.992291
  2.2199707  2.018508   5.774856   2.018508   2.018508   2.018508
  2.018508   2.018508   2.0185082  2.0185082  2.3950026  2.418981
  2.5093908  2.018508   2.0185082  2.0185082  2.018508   2.0185082
  2.018508   2.018508   2.018508   2.018508   2.4008374  2.018508
  2.018508   3.1097066  2.018508   1.9790709  2.2796068  1.9634603
  2.7660356  2.5584688  5.2085557  5.2085557  2.690745   2.7660356
  1.9634603  1.9567316  1.9567316  1.9634603  1.9567313  2.336439
  2.3920796  2.0185082  2.290653   1.9634603  2.2856748  1.9634603
  1.9634603  1.9947312  1.9634603  1.9567313  1.9634603  1.9634603
  2.3457735  1.9567316  1.9634603  1.9567316  1.9634603  1.9634603
  1.9634603  2.6688623  2.3073683  2.3073685  2.018508   2.3905666
  2.3436003  1.9634603  1.9567313  2.8346264  2.0185082  1.9567313
  2.752443   1.9595991  1.9634603  1.9634602  2.5075386  2.7209458
  2.3944542  1.9634603  2.3950028  1.9947315  1.9567316  1.925682
  2.0185082  1.956732   2.3457744  2.018508   2.018508   2.3950016
  1.9947314  1.9634603  2.5502133  2.4793897  2.9461832  2.7209458
  2.3341625  2.5386076  2.538607   2.309544   2.0702105  2.018508
  2.3500366  2.6656535  2.7209458  2.3958457  1.9638975  2.0334349
  2.0929174  2.0929172  2.0929172  2.0929174  2.0929174  2.4761534
  2.803837   2.0929174  2.0929174  2.0185082  2.0882354  2.0185082
  2.538607   2.728829   2.5386076  2.048698   2.5386076  2.891704
  2.4008365  2.1048148  2.400838   2.018508   2.5386074  1.9760323
  2.0214946  2.021495   2.0929174  1.9760323  2.7681987  2.1186213
  2.0185082  2.018508   2.0929174  2.136036   2.0214946  2.0561998
  2.0334349  2.1121044  2.476153   4.765605   2.1121044  3.2248185
  2.508344   2.0334344  2.4662356  2.0467286  2.1214986  2.1214986
  2.6797028  2.18662    2.5990245  2.0334344  2.0334349  2.0334349
  2.0454268  2.0334349  2.0334344  2.1214986  2.0334344  2.0334344
  2.0334349  2.5693808  2.136159   2.9530416  3.0456781  2.6714325
  2.5183148  2.1721485  3.0016303  4.2165136  2.2272503  2.243116
  2.2574136  2.7329977  2.7329977  2.1214986  3.4541514  3.1660075
  2.2272525  2.2994857  2.7768044  3.5372229  2.368747   2.368747
  2.3687472  2.430812   2.392038   2.6621058  3.1493144  2.7247245
  2.578475   2.3458407  2.650932   2.2994857  2.6515372  2.7158504
  2.2574136  2.866971   2.2272525  3.166007   2.2994864  2.7158504
  2.3458407  2.4600263  2.3687472  2.4308121  2.257414   2.6192033
  2.864031   2.4308124  2.4308126  2.4308126  2.7884727  2.8238518
  4.2168555  2.368747   3.0950682  2.4308124  2.8653705  2.8937006
  4.950168   2.8937004  2.4308124  2.5804589  2.8937006  2.352359
  2.5804589  2.8937004 10.554415   2.9286094  3.0953305  2.8937006
  3.0392263  3.0146086  3.0166407  3.2510583  2.9800436  2.4963503
  2.4963503  3.2510583  3.1035576  2.580459   2.8937004  3.0166407
  2.8937004  2.6588514  2.6588514  2.6588511  2.49635    2.6588514
  2.6588514  2.6588516  2.6588519  3.3706362  2.6588514  2.6588519
  2.7484603  2.9841828  3.389821   3.389821   2.6588516  2.9578545
  3.3706362  2.658851 ]
2025-06-02 15:27:07,377 - DEBUG - Edge reconstruction errors: [  5.2570443   5.257984   44.25256   ...  13.352533  535.2529
  13.352534 ]
2025-06-02 15:27:07,392 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152707_update_33.json
2025-06-02 15:27:07,393 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:27:07,450 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152707_update_33.pth
2025-06-02 15:27:07,450 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870085.dot): 0.8092
2025-06-02 15:27:07,450 - WARNING - Detected 11 anomalous nodes (reconstruction-based):
2025-06-02 15:27:07,451 - WARNING -   Node ID: 192.168.239.101, Recon Error: 6.3997, MLP Score: 0.4513
2025-06-02 15:27:07,451 - WARNING -   Node ID: 192.168.27.13, Recon Error: 17.9134, MLP Score: 0.7076
2025-06-02 15:27:07,451 - WARNING -   Node ID: 192.168.27.12, Recon Error: 17.4703, MLP Score: 0.7371
2025-06-02 15:27:07,451 - WARNING -   Node ID: 192.168.27.10, Recon Error: 21.5647, MLP Score: 0.7465
2025-06-02 15:27:07,452 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 9.9523, MLP Score: 0.3629
2025-06-02 15:27:07,452 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 15:27:07,452 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2526, MLP Score: 0.0000
2025-06-02 15:27:07,453 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9551, MLP Score: 0.0000
2025-06-02 15:27:07,453 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0562, MLP Score: 0.0000
2025-06-02 15:27:07,453 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7540, MLP Score: 0.0000
2025-06-02 15:27:07,453 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7531, MLP Score: 0.0000
2025-06-02 15:27:07,454 - INFO - 
--- Processing file: nw_graph_encoded_1748870115.dot (Timestamp: 2025-06-02 15:15:15) ---
2025-06-02 15:27:07,454 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870115.dot
2025-06-02 15:27:07,454 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870115.dot'.
2025-06-02 15:27:07,454 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870115.dot
2025-06-02 15:27:07,499 - INFO - Parsed 836 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870115.dot'.
2025-06-02 15:27:07,593 - INFO - Parsed 1786 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870115.dot'.
2025-06-02 15:27:07,594 - INFO - Processing node updates/additions.
2025-06-02 15:27:07,631 - INFO - Processing edge updates/additions.
2025-06-02 15:27:07,780 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:27:07,786 - INFO - Finished updating NetworkX graph.
2025-06-02 15:27:07,789 - DEBUG - Updated graph - Nodes: 836, Edges: 1786
2025-06-02 15:27:07,790 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:27:07,795 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:27:07,962 - DEBUG - Initial node features tensor shape: torch.Size([836, 30])
2025-06-02 15:27:07,969 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:27:07,973 - DEBUG - Node features tensor shape after scaling: torch.Size([836, 30])
2025-06-02 15:27:07,981 - DEBUG - Edge index tensor shape: torch.Size([2, 1786])
2025-06-02 15:27:07,992 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:27:08,074 - DEBUG - Initial edge attributes tensor shape: torch.Size([1786, 10])
2025-06-02 15:27:08,082 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:27:08,087 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1786, 10])
2025-06-02 15:27:08,088 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:27:08,089 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:27:08,093 - INFO - Updated main graph to 836 nodes and 1786 edges.
2025-06-02 15:27:08,093 - INFO - Performing online update...
2025-06-02 15:27:08,094 - INFO - Starting online update for 25 steps.
2025-06-02 15:27:08,095 - DEBUG - Updated RunningStats: new_mean=0.9433641257131974, new_var=19200000000161.137, new_n=1950
2025-06-02 15:27:08,096 - DEBUG - Updated RunningStats: new_mean=0.940316357224152, new_var=19500000000018.273, new_n=1980
2025-06-02 15:27:08,096 - DEBUG - Updated RunningStats: new_mean=44.1754632219865, new_var=6400000191305.117, new_n=650
2025-06-02 15:27:08,097 - DEBUG - Updated RunningStats: new_mean=44.24691834900959, new_var=6500000208562.447, new_n=660
2025-06-02 15:27:08,097 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:27:08,097 - DEBUG - Online update step: 1/25
2025-06-02 15:27:08,105 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:08,211 - DEBUG - Node anomaly scores shape: torch.Size([15069, 1])
2025-06-02 15:27:08,217 - DEBUG - Edge anomaly scores shape: torch.Size([30892, 1])
2025-06-02 15:27:08,219 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:08,427 - DEBUG - Step 1: Loss=3.5528
2025-06-02 15:27:08,428 - DEBUG - Online update step: 2/25
2025-06-02 15:27:08,438 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:08,522 - DEBUG - Node anomaly scores shape: torch.Size([14423, 1])
2025-06-02 15:27:08,525 - DEBUG - Edge anomaly scores shape: torch.Size([29451, 1])
2025-06-02 15:27:08,527 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:08,671 - DEBUG - Step 2: Loss=3.3984
2025-06-02 15:27:08,672 - DEBUG - Online update step: 3/25
2025-06-02 15:27:08,682 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:08,820 - DEBUG - Node anomaly scores shape: torch.Size([14431, 1])
2025-06-02 15:27:08,824 - DEBUG - Edge anomaly scores shape: torch.Size([29477, 1])
2025-06-02 15:27:08,826 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:08,992 - DEBUG - Step 3: Loss=3.2215
2025-06-02 15:27:08,993 - DEBUG - Online update step: 4/25
2025-06-02 15:27:09,001 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:09,085 - DEBUG - Node anomaly scores shape: torch.Size([14446, 1])
2025-06-02 15:27:09,090 - DEBUG - Edge anomaly scores shape: torch.Size([29522, 1])
2025-06-02 15:27:09,091 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:09,272 - DEBUG - Step 4: Loss=3.0254
2025-06-02 15:27:09,273 - DEBUG - Online update step: 5/25
2025-06-02 15:27:09,288 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:09,385 - DEBUG - Node anomaly scores shape: torch.Size([14506, 1])
2025-06-02 15:27:09,389 - DEBUG - Edge anomaly scores shape: torch.Size([29698, 1])
2025-06-02 15:27:09,391 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:09,579 - DEBUG - Step 5: Loss=2.8156
2025-06-02 15:27:09,580 - DEBUG - Online update step: 6/25
2025-06-02 15:27:09,594 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:09,682 - DEBUG - Node anomaly scores shape: torch.Size([15092, 1])
2025-06-02 15:27:09,686 - DEBUG - Edge anomaly scores shape: torch.Size([30927, 1])
2025-06-02 15:27:09,688 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:09,865 - DEBUG - Step 6: Loss=2.5915
2025-06-02 15:27:09,866 - DEBUG - Online update step: 7/25
2025-06-02 15:27:09,874 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:09,963 - DEBUG - Node anomaly scores shape: torch.Size([14453, 1])
2025-06-02 15:27:09,967 - DEBUG - Edge anomaly scores shape: torch.Size([29550, 1])
2025-06-02 15:27:09,968 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:10,114 - DEBUG - Step 7: Loss=2.3571
2025-06-02 15:27:10,115 - DEBUG - Online update step: 8/25
2025-06-02 15:27:10,127 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:10,216 - DEBUG - Node anomaly scores shape: torch.Size([14347, 1])
2025-06-02 15:27:10,221 - DEBUG - Edge anomaly scores shape: torch.Size([29280, 1])
2025-06-02 15:27:10,222 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:10,370 - DEBUG - Step 8: Loss=2.1160
2025-06-02 15:27:10,370 - DEBUG - Online update step: 9/25
2025-06-02 15:27:10,380 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:10,470 - DEBUG - Node anomaly scores shape: torch.Size([14410, 1])
2025-06-02 15:27:10,473 - DEBUG - Edge anomaly scores shape: torch.Size([29427, 1])
2025-06-02 15:27:10,475 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:10,663 - DEBUG - Step 9: Loss=1.9509
2025-06-02 15:27:10,664 - DEBUG - Online update step: 10/25
2025-06-02 15:27:10,673 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:10,739 - DEBUG - Node anomaly scores shape: torch.Size([14446, 1])
2025-06-02 15:27:10,743 - DEBUG - Edge anomaly scores shape: torch.Size([29522, 1])
2025-06-02 15:27:10,745 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:10,889 - DEBUG - Step 10: Loss=1.9991
2025-06-02 15:27:10,889 - DEBUG - Online update step: 11/25
2025-06-02 15:27:10,897 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:10,979 - DEBUG - Node anomaly scores shape: torch.Size([14727, 1])
2025-06-02 15:27:10,984 - DEBUG - Edge anomaly scores shape: torch.Size([30165, 1])
2025-06-02 15:27:10,986 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:11,133 - DEBUG - Step 11: Loss=1.9858
2025-06-02 15:27:11,134 - DEBUG - Online update step: 12/25
2025-06-02 15:27:11,148 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:11,291 - DEBUG - Node anomaly scores shape: torch.Size([15069, 1])
2025-06-02 15:27:11,295 - DEBUG - Edge anomaly scores shape: torch.Size([30892, 1])
2025-06-02 15:27:11,297 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:11,482 - DEBUG - Step 12: Loss=1.9313
2025-06-02 15:27:11,483 - DEBUG - Online update step: 13/25
2025-06-02 15:27:11,495 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:11,586 - DEBUG - Node anomaly scores shape: torch.Size([14969, 1])
2025-06-02 15:27:11,589 - DEBUG - Edge anomaly scores shape: torch.Size([30742, 1])
2025-06-02 15:27:11,591 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:11,744 - DEBUG - Step 13: Loss=1.8339
2025-06-02 15:27:11,745 - DEBUG - Online update step: 14/25
2025-06-02 15:27:11,753 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:11,882 - DEBUG - Node anomaly scores shape: torch.Size([14328, 1])
2025-06-02 15:27:11,886 - DEBUG - Edge anomaly scores shape: torch.Size([29237, 1])
2025-06-02 15:27:11,888 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:12,057 - DEBUG - Step 14: Loss=1.7150
2025-06-02 15:27:12,058 - DEBUG - Online update step: 15/25
2025-06-02 15:27:12,066 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:12,149 - DEBUG - Node anomaly scores shape: torch.Size([14410, 1])
2025-06-02 15:27:12,153 - DEBUG - Edge anomaly scores shape: torch.Size([29427, 1])
2025-06-02 15:27:12,154 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:12,287 - DEBUG - Step 15: Loss=1.5690
2025-06-02 15:27:12,288 - DEBUG - Online update step: 16/25
2025-06-02 15:27:12,296 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:12,409 - DEBUG - Node anomaly scores shape: torch.Size([14328, 1])
2025-06-02 15:27:12,414 - DEBUG - Edge anomaly scores shape: torch.Size([29237, 1])
2025-06-02 15:27:12,415 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:12,569 - DEBUG - Step 16: Loss=1.5487
2025-06-02 15:27:12,570 - DEBUG - Online update step: 17/25
2025-06-02 15:27:12,579 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:12,671 - DEBUG - Node anomaly scores shape: torch.Size([14341, 1])
2025-06-02 15:27:12,675 - DEBUG - Edge anomaly scores shape: torch.Size([29264, 1])
2025-06-02 15:27:12,676 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:12,823 - DEBUG - Step 17: Loss=1.5940
2025-06-02 15:27:12,824 - DEBUG - Online update step: 18/25
2025-06-02 15:27:12,831 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:12,936 - DEBUG - Node anomaly scores shape: torch.Size([14384, 1])
2025-06-02 15:27:12,939 - DEBUG - Edge anomaly scores shape: torch.Size([29379, 1])
2025-06-02 15:27:12,940 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:13,097 - DEBUG - Step 18: Loss=1.6109
2025-06-02 15:27:13,099 - DEBUG - Online update step: 19/25
2025-06-02 15:27:13,110 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:13,200 - DEBUG - Node anomaly scores shape: torch.Size([14423, 1])
2025-06-02 15:27:13,203 - DEBUG - Edge anomaly scores shape: torch.Size([29451, 1])
2025-06-02 15:27:13,204 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:13,356 - DEBUG - Step 19: Loss=1.5978
2025-06-02 15:27:13,357 - DEBUG - Online update step: 20/25
2025-06-02 15:27:13,379 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:13,519 - DEBUG - Node anomaly scores shape: torch.Size([14416, 1])
2025-06-02 15:27:13,526 - DEBUG - Edge anomaly scores shape: torch.Size([29439, 1])
2025-06-02 15:27:13,528 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:14,060 - DEBUG - Step 20: Loss=1.5533
2025-06-02 15:27:14,061 - DEBUG - Online update step: 21/25
2025-06-02 15:27:14,073 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:14,248 - DEBUG - Node anomaly scores shape: torch.Size([14410, 1])
2025-06-02 15:27:14,254 - DEBUG - Edge anomaly scores shape: torch.Size([29427, 1])
2025-06-02 15:27:14,257 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:14,495 - DEBUG - Step 21: Loss=1.4839
2025-06-02 15:27:14,499 - DEBUG - Online update step: 22/25
2025-06-02 15:27:14,510 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:14,611 - DEBUG - Node anomaly scores shape: torch.Size([15017, 1])
2025-06-02 15:27:14,615 - DEBUG - Edge anomaly scores shape: torch.Size([30812, 1])
2025-06-02 15:27:14,616 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:14,787 - DEBUG - Step 22: Loss=1.4126
2025-06-02 15:27:14,788 - DEBUG - Online update step: 23/25
2025-06-02 15:27:14,796 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:14,881 - DEBUG - Node anomaly scores shape: torch.Size([15127, 1])
2025-06-02 15:27:14,885 - DEBUG - Edge anomaly scores shape: torch.Size([30972, 1])
2025-06-02 15:27:14,886 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:15,048 - DEBUG - Step 23: Loss=1.4438
2025-06-02 15:27:15,048 - DEBUG - Online update step: 24/25
2025-06-02 15:27:15,057 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:15,158 - DEBUG - Node anomaly scores shape: torch.Size([14366, 1])
2025-06-02 15:27:15,163 - DEBUG - Edge anomaly scores shape: torch.Size([29331, 1])
2025-06-02 15:27:15,165 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:15,348 - DEBUG - Step 24: Loss=1.4814
2025-06-02 15:27:15,349 - DEBUG - Online update step: 25/25
2025-06-02 15:27:15,358 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:15,451 - DEBUG - Node anomaly scores shape: torch.Size([14493, 1])
2025-06-02 15:27:15,454 - DEBUG - Edge anomaly scores shape: torch.Size([29643, 1])
2025-06-02 15:27:15,456 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:15,723 - DEBUG - Step 25: Loss=1.4773
2025-06-02 15:27:15,724 - INFO - Online update finished. Average loss: 2.0507, Learning rate: 0.001000
2025-06-02 15:27:15,726 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -2.4811502e-08  5.5611988e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -5.7750911e-09
  7.0727040e-08  5.5897178e-08  1.9392898e-08  1.9392898e-08
  2.2930622e+00  2.9593301e+00  1.4593302e-01  4.3971291e+00
  1.1407587e-09  3.3947368e+00  5.7643542e+00  7.6076555e+00
  1.4593302e-01  7.9916267e+00 -1.9392898e-08 -1.5400243e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.3955934e-08 -5.9319454e-08], current edge mean: [ 1.0679444e-09  4.6099832e+02  0.0000000e+00  0.0000000e+00
  2.6698610e-09  3.2038332e-09  2.1358888e-09 -2.1358888e-09
  8.5435552e-09  8.0095823e-09]
2025-06-02 15:27:15,727 - DEBUG - Node drift difference: 0.0111, Edge drift difference: 0.0012
2025-06-02 15:27:15,730 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -2.4811502e-08  5.5611988e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -5.7750911e-09
  7.0727040e-08  5.5897178e-08  1.9392898e-08  1.9392898e-08
  2.2930622e+00  2.9593301e+00  1.4593302e-01  4.3971291e+00
  1.1407587e-09  3.3947368e+00  5.7643542e+00  7.6076555e+00
  1.4593302e-01  7.9916267e+00 -1.9392898e-08 -1.5400243e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.3955934e-08 -5.9319454e-08], edge=[ 1.0679444e-09  4.6099832e+02  0.0000000e+00  0.0000000e+00
  2.6698610e-09  3.2038332e-09  2.1358888e-09 -2.1358888e-09
  8.5435552e-09  8.0095823e-09]
2025-06-02 15:27:15,731 - DEBUG - Updated reference std: node=[0.         0.         1.0005987  1.0005985  0.         0.
 0.         1.0005987  1.0005987  1.0005987  1.0005987  1.0005987
 0.99652076 0.2824555  0.36981332 0.5666934  1.0005987  3.0259826
 2.9103527  1.4954265  0.36981332 0.24210006 1.0005987  1.0005987
 0.         0.         0.         0.         1.0005987  1.0005987 ], edge=[  1.0002801 481.91306     0.          0.          1.00028     1.0002801
   1.0002801   1.00028     1.0002801   1.00028  ]
2025-06-02 15:27:15,732 - INFO - Online update complete. Loss: 2.0507
2025-06-02 15:27:15,732 - INFO - Running anomaly detection...
2025-06-02 15:27:15,733 - INFO - Starting anomaly detection.
2025-06-02 15:27:15,758 - DEBUG - Node reconstruction errors: [ 0.89029616  6.319423   16.378942    1.0479381   1.6623886   1.2022129
 15.79485     1.001655    1.001655    1.0475565   1.001655    1.5495915
 21.140942    1.4705504   0.82766545  1.170152    1.5644314   1.1701523
  3.7159333   1.0204351   0.57417625  0.8276653   0.54998815  1.080942
  0.7509832   0.90596855  0.7509832   1.8803436   0.8608498   0.7509831
  3.954628    1.269067    1.6872541   0.905953    0.91887885  0.54180586
  1.2503313   1.0204351   1.4713      1.1982859   0.79311156  0.6969631
  1.0204351   0.5555523   1.4369336   1.0378639   1.0975556   1.071378
  0.7375406   1.8624134   6.9887605   0.7331393   0.7710093   3.0883887
  0.4575533   1.5565635  10.188985    0.77510047  3.2871308   2.9764245
  1.1499194   0.33858308  0.58361167  1.0462501   0.63228565  0.45755276
  0.40724793  0.4575533   0.58361167  0.5836118   0.4406627   0.9577347
  0.39545533  1.1154562   1.1519598   1.0148269   0.48927024  0.8994104
  0.93338114  1.0177639   0.54453     0.8418262   2.9714484   2.5554059
  1.0071685   1.1054937   0.82284683  1.0129184   1.064131    0.8677043
  0.48945457  1.5170732   0.96728766  0.909195    0.32043967  6.273954
  0.4500022   1.0667548   0.36435023  0.4004862   0.811124    0.45000207
  0.46940348  0.9237652   1.1055844   0.36313882  1.0482466   0.7665036
  1.0136596   1.385588    0.82638085  0.44545138  1.7454565   1.4622378
  0.81869715  0.7185263   0.7705489   1.4461137   1.0154684   0.29959458
  0.37668136  0.96459514  1.4278657   0.9078808   1.1116804   0.2995926
  0.90959847  0.68368524  0.9693083   0.3265253   0.38153255  0.36894882
  1.9182063   2.0116265   0.7440441   0.37228897  0.37958556  0.40849134
  0.7918793   1.4787183   0.31615004  0.7841086   0.34842646  0.4309985
  0.43099818  0.9071004   0.77054906  0.4309985   0.35270676  1.0218277
  1.0877857   1.2383575   0.96648103  0.36894882  1.6388346   1.4361165
  0.33032742  0.7602905   0.8111235   0.55218107  0.30937058  0.7918807
  0.3303273   0.38153255  0.7751209   1.4894799   0.82002205  0.8911969
  0.7148962   1.0761697   0.97372633  0.30186898  0.45928335  6.889898
  1.0679721   0.8564959   0.88861984  0.7281986   0.7362194   0.7362193
  0.32545242  1.0072588   0.45184425  1.4396092   1.6392268   0.9311974
  0.30599958  0.7484119   0.33338872  0.29214275  0.9767417   0.9759783
  0.36150628  0.39400655  0.7918783   0.32168758  2.72261     0.42077008
  1.4528445   0.34630337  0.34177163  0.33032742  1.4688326   1.0113999
  0.89064115  0.8001629   0.42948672  2.1086588   0.32877102  0.930341
  0.709177    0.7318427   0.4045931   0.8847261   0.9525222   0.31734407
  1.0252923   0.7705491   0.81455904  0.39400655  1.444606    0.30599964
  0.39258903  0.4045931   0.3303273   1.0150778   1.4759954   0.43883273
  0.90192807  0.91302997  0.90513     0.88668555  1.0629946   0.7705494
  0.77054876  0.32168743  0.8440122   0.39258903  0.3303273   0.351409
  1.4726567   0.87664247  0.3869654   1.1241423   0.37599176  1.1241422
  0.7076186   0.80629236  0.38696536  0.36224583  0.45928335  0.4482564
  0.8145591   0.8751948   0.8199503   0.8147873   0.29214275  0.2636941
  0.3169423   0.7362198   0.8386262   1.1774514   0.55252683  0.44271597
  0.9738377   0.29003602  0.9421111   3.627219    0.9421109   0.7075441
  1.4718096   1.4149595   0.8527445   0.49958038  0.74537456  0.7362191
  0.35094595  0.94201154  0.32545242  0.9753966   2.0256305   0.37611806
  0.84972614  0.44121382  0.96821594  0.35025725  1.7382092   0.73666155
  1.00726     1.3055826   0.3422495   0.2989589   0.363584    0.37599164
  1.6483408   0.25062153  0.83886015  0.7362193   0.32168764  1.1547259
  0.81806844  0.301361    0.68849933  0.93941253  0.301361    0.301361
  0.3013609   0.71639097  0.27329448  0.301361    0.301361    1.719881
  0.30136093  0.27109036  0.77245814  0.8441778   0.7808324   0.89779454
  0.35813892  0.31174582  0.913981    0.30956012  0.9579691   0.6884993
  0.65849245  1.4228095   0.3103601   0.7163907   0.89568025  0.89568037
  1.0069538   0.3008815   0.301361    0.74537474  0.301361    0.7163908
  0.4661921   0.38235256  0.3103601   0.31036016  0.301361    0.4464863
  0.3103601   0.96746176  0.94296306  0.93276143  0.6884989   0.3144037
  0.9810894   0.87418336  0.301361    0.6966179   1.4349899   0.7831188
  0.40770754  0.29214275  0.242405    0.301361    0.3463511   2.5737066
  0.709177    0.2819318   0.34993955  0.8565422   0.6884992   6.485869
  0.31425726  1.783503    0.67536354  0.64879537  0.8138736   0.85744166
  0.9393463   1.5170493   0.8439134   0.7831228   0.34350923  0.33277556
  0.86163     0.301361    0.68849903  0.6110391   0.2800978   0.8222959
  0.6293768   0.9929949   0.37116137  1.0053804   0.7447062   0.301361
  0.82699007  0.6520455   0.6406033   0.6308158   0.69691193  0.69691193
  0.69691193  2.883788    0.2732243   2.9017975   0.26737696  0.67440325
  0.6969117   0.2732243   0.649192    0.64060366  0.9827913   0.27674097
  0.6406036   0.71698296  0.69691193  0.6406039   0.2732243   0.69691193
  0.69691193  0.3278897   0.39706933  0.69691205  0.34350955  0.335278
  0.2770713   0.31149015  0.62842005  0.27533472  1.5106528   0.36839002
  0.38433507  0.67642623  0.7229366   0.94159615  0.8744276   0.30039513
  0.67483497  0.6793693   0.69691205  0.69691193  0.26737702  0.87782323
  1.474663    0.3086268   0.42132732  0.3051923   0.4805362   0.27824825
  0.28970233  1.5799327   1.8585812   0.3019711   0.31935674  0.28261825
  0.95254844  0.29513308  0.28626746  0.2615928   0.29513308  0.31816685
  0.27533472  0.27846143  0.28284952  0.75888944  0.637427    0.2904543
  0.2809971   0.98117733  0.28099677  0.2904543   0.30174747  0.75888973
  0.72253215  0.30498633  0.30174747  0.6374269   0.9054606   1.7995222
  1.0262517   0.62841874  0.75888973  0.63742703  0.28106776  0.29860917
  0.2942725   1.6583635   0.3728838   0.30197105  1.642913    0.3010569
  0.29513305  0.6438688   0.46080297  1.7995222   0.65880954  0.2810678
  0.8490595   0.27574113  0.61686885  0.27846143  0.61735064  2.8909135
  0.2615927   0.29860884  0.4155035   0.27574113  0.41550365  0.3202419
  0.2862831   0.8439818   0.24939987  1.7190437   0.39675918  0.29513305
  0.8627053   0.2955074   0.29550758  0.2897023   0.6626847   0.37579072
  0.24939995  0.62896174  0.3780695   0.7886093   0.6289618   0.30519244
  0.24939995  0.32505637  0.2862831   0.6173504   0.32213414  0.79986346
  0.6289616   0.85948443  0.37579092  0.26159257  0.26159257  0.29860884
  0.6173506   0.61964524  0.7877249   0.8483565   0.2615927   0.6679047
  0.2615927   0.66790473  0.47642353  0.62896156  0.31850213  2.972041
  0.71204937  0.26652732  2.4261537   0.2665272   0.2665272   0.2665272
  0.2665272   0.2665272   0.26652732  0.26652727  0.62750804  0.36079532
  0.461866    0.26652738  0.2665272   0.2665272   0.2665272   0.26652732
  0.2665272   0.2665272   0.2665272   0.2665272   0.62578285  0.2665272
  0.2665272   1.5433515   0.2665272   0.8193478   0.42255077  0.26159257
  0.60538906  0.8319531   2.2126868   2.2126868   0.86968416  0.60538906
  0.2615927   0.24939987  0.24939987  0.26159266  0.24939987  0.27387565
  0.38089117  0.2665272   0.3051923   0.26159257  0.29550758  0.2615927
  0.26159257  0.26341316  0.26159266  0.24939987  0.26159266  0.2615927
  0.62896174  0.24939995  0.26159257  0.24939995  0.26159257  0.2615927
  0.26159266  0.8361244   0.6168693   0.6168695   0.2665272   0.33777103
  0.47226706  0.2615927   0.24939986  0.87698036  0.2665273   0.42697802
  0.927291    0.24565443  0.2615927   0.26159278  0.67449665  0.8373385
  0.66721404  0.2615928   0.62750775  0.26341328  0.24939995  0.786807
  0.2665272   0.42421016  0.6289615   0.2665272   0.2665272   0.6275079
  0.26341328  0.26159257  0.40386862  0.6685754   0.9524718   0.8373385
  0.424127    0.6540925   0.6540925   0.41276798  0.35145417  0.2665272
  0.314541    0.7316285   0.83733857  0.6235159   0.38818258  0.31270877
  0.2880235   0.28802365  0.28802365  0.28802365  0.28802365  0.63993704
  0.78291625  0.28802365  0.2880235   0.2665272   0.30081084  0.2665272
  0.6540925   0.83472407  0.65409243  0.35553378  0.6540925   0.8736847
  0.6257832   0.4011098   0.625783    0.26652738  0.65409243  0.28755838
  0.26247346  0.26247346  0.2880235   0.28755838  0.84242904  0.3729222
  0.2665272   0.26652732  0.2880235   0.3735457   0.26247334  0.27941644
  0.31270877  0.3375022   0.6399372   2.012676    0.3375022   1.6232916
  0.66917354  0.31270877  0.39055252  0.30548504  0.3471464   0.4423317
  0.67951924  0.326149    0.6582152   0.31270877  0.31270877  0.31270874
  0.3148796   0.31270877  0.31270877  0.34714642  0.31270877  0.31270877
  0.31270877  0.6830479   0.34039545  0.9087689   0.9315897   0.67824763
  0.42895985  0.3778011   0.94210684  2.9497313   0.40071294  0.39404488
  0.4198841   0.48941046  0.48941025  0.34714642  1.7548743   1.0375777
  0.4007134   0.3830518   0.5750607   1.8210105   0.46481815  0.46481815
  0.46481833  0.457017    0.49848738  1.0094515   0.5665319   0.55114
  0.4365531   0.48366204  0.46756762  0.38305202  0.5099129   0.78256583
  0.41988403  0.45115757  0.40071344  1.0375793   0.38305178  0.78256583
  0.48366204  0.5271965   0.46481833  0.457017    0.4198841   0.44565538
  0.56460553  0.457017    0.45701665  0.457017    0.55074036  0.782699
  4.29025     0.46481815  0.9967089   0.457017    0.7725419   0.61227757
  3.1323426   0.61227745  0.457017    0.5474828   0.6504468   0.47108892
  0.54748315  0.61227745  6.978536    0.56722146  0.88503206  0.61227745
  0.8456023   0.6558837   0.6314027   1.0475605   0.86433214  0.5581914
  0.55819154  1.0475606   0.78046316  0.5474828   0.61227745  0.6314024
  0.61227757  0.66211224  0.66211224  0.66211224  0.5937602   1.1573424
  0.66211224  0.6621123   0.6621123   0.7792739   0.66211224  0.66211224
  0.6550856   0.7234154   1.1644337   1.1644338   0.66211224  0.6904771
  0.7792739   0.66211224  0.7826815   0.6904771   0.66211224  0.6621123
  0.9545772   0.6904774   0.66211253  0.6904771   0.7362843   1.2719429
  0.81106764  0.66211224  1.2049708   0.6904771   0.6904771   0.72341526
  0.7792356   0.6904774 ]
2025-06-02 15:27:15,760 - DEBUG - Edge reconstruction errors: [  5.258096   5.258133  44.253212 ...  13.353189 535.2537    13.353189]
2025-06-02 15:27:15,764 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152715_update_34.json
2025-06-02 15:27:15,765 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:27:15,821 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152715_update_34.pth
2025-06-02 15:27:15,821 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870115.dot): 0.8655
2025-06-02 15:27:15,821 - WARNING - Detected 11 anomalous nodes (reconstruction-based):
2025-06-02 15:27:15,822 - WARNING -   Node ID: 192.168.239.101, Recon Error: 6.3194, MLP Score: 0.4097
2025-06-02 15:27:15,822 - WARNING -   Node ID: 192.168.27.13, Recon Error: 16.3789, MLP Score: 0.4766
2025-06-02 15:27:15,822 - WARNING -   Node ID: 192.168.27.12, Recon Error: 15.7949, MLP Score: 0.4686
2025-06-02 15:27:15,822 - WARNING -   Node ID: 192.168.27.10, Recon Error: 21.1409, MLP Score: 0.4559
2025-06-02 15:27:15,822 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 6.9888, MLP Score: 0.4901
2025-06-02 15:27:15,823 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:27:15,823 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2532, MLP Score: 0.0000
2025-06-02 15:27:15,823 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9556, MLP Score: 0.0000
2025-06-02 15:27:15,824 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0565, MLP Score: 0.0000
2025-06-02 15:27:15,824 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7545, MLP Score: 0.0000
2025-06-02 15:27:15,824 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7537, MLP Score: 0.0000
2025-06-02 15:27:15,825 - INFO - 
--- Processing file: nw_graph_encoded_1748870145.dot (Timestamp: 2025-06-02 15:15:45) ---
2025-06-02 15:27:15,825 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870145.dot
2025-06-02 15:27:15,825 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870145.dot'.
2025-06-02 15:27:15,825 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870145.dot
2025-06-02 15:27:15,857 - INFO - Parsed 845 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870145.dot'.
2025-06-02 15:27:15,953 - INFO - Parsed 1818 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870145.dot'.
2025-06-02 15:27:15,954 - INFO - Processing node updates/additions.
2025-06-02 15:27:15,992 - INFO - Processing edge updates/additions.
2025-06-02 15:27:16,143 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:27:16,149 - INFO - Finished updating NetworkX graph.
2025-06-02 15:27:16,153 - DEBUG - Updated graph - Nodes: 845, Edges: 1818
2025-06-02 15:27:16,153 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:27:16,159 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:27:16,330 - DEBUG - Initial node features tensor shape: torch.Size([845, 30])
2025-06-02 15:27:16,334 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:27:16,334 - DEBUG - Node features tensor shape after scaling: torch.Size([845, 30])
2025-06-02 15:27:16,339 - DEBUG - Edge index tensor shape: torch.Size([2, 1818])
2025-06-02 15:27:16,350 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:27:16,432 - DEBUG - Initial edge attributes tensor shape: torch.Size([1818, 10])
2025-06-02 15:27:16,436 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:27:16,437 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1818, 10])
2025-06-02 15:27:16,438 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:27:16,438 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:27:16,442 - INFO - Updated main graph to 845 nodes and 1818 edges.
2025-06-02 15:27:16,442 - INFO - Performing online update...
2025-06-02 15:27:16,443 - INFO - Starting online update for 25 steps.
2025-06-02 15:27:16,444 - DEBUG - Updated RunningStats: new_mean=0.9435463496370878, new_var=19800000000161.184, new_n=2010
2025-06-02 15:27:16,444 - DEBUG - Updated RunningStats: new_mean=0.9405838327777333, new_var=20100000000018.215, new_n=2040
2025-06-02 15:27:16,445 - DEBUG - Updated RunningStats: new_mean=44.27410093866763, new_var=6600000191037.39, new_n=670
2025-06-02 15:27:16,445 - DEBUG - Updated RunningStats: new_mean=44.33574414481712, new_var=6700000204846.448, new_n=680
2025-06-02 15:27:16,446 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:27:16,446 - DEBUG - Online update step: 1/25
2025-06-02 15:27:16,454 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:16,529 - DEBUG - Node anomaly scores shape: torch.Size([14639, 1])
2025-06-02 15:27:16,532 - DEBUG - Edge anomaly scores shape: torch.Size([29964, 1])
2025-06-02 15:27:16,534 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:16,680 - DEBUG - Step 1: Loss=1.4377
2025-06-02 15:27:16,681 - DEBUG - Online update step: 2/25
2025-06-02 15:27:16,690 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:16,841 - DEBUG - Node anomaly scores shape: torch.Size([15005, 1])
2025-06-02 15:27:16,846 - DEBUG - Edge anomaly scores shape: torch.Size([30862, 1])
2025-06-02 15:27:16,848 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:17,091 - DEBUG - Step 2: Loss=1.3714
2025-06-02 15:27:17,091 - DEBUG - Online update step: 3/25
2025-06-02 15:27:17,104 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:17,187 - DEBUG - Node anomaly scores shape: torch.Size([15111, 1])
2025-06-02 15:27:17,191 - DEBUG - Edge anomaly scores shape: torch.Size([30969, 1])
2025-06-02 15:27:17,192 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:17,381 - DEBUG - Step 3: Loss=1.3619
2025-06-02 15:27:17,386 - DEBUG - Online update step: 4/25
2025-06-02 15:27:17,410 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:17,563 - DEBUG - Node anomaly scores shape: torch.Size([15122, 1])
2025-06-02 15:27:17,567 - DEBUG - Edge anomaly scores shape: torch.Size([31003, 1])
2025-06-02 15:27:17,568 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:17,769 - DEBUG - Step 4: Loss=1.3908
2025-06-02 15:27:17,770 - DEBUG - Online update step: 5/25
2025-06-02 15:27:17,777 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:17,857 - DEBUG - Node anomaly scores shape: torch.Size([15918, 1])
2025-06-02 15:27:17,861 - DEBUG - Edge anomaly scores shape: torch.Size([32719, 1])
2025-06-02 15:27:17,862 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:18,008 - DEBUG - Step 5: Loss=1.3921
2025-06-02 15:27:18,008 - DEBUG - Online update step: 6/25
2025-06-02 15:27:18,023 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:18,159 - DEBUG - Node anomaly scores shape: torch.Size([15153, 1])
2025-06-02 15:27:18,162 - DEBUG - Edge anomaly scores shape: torch.Size([31077, 1])
2025-06-02 15:27:18,164 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:18,341 - DEBUG - Step 6: Loss=1.3635
2025-06-02 15:27:18,342 - DEBUG - Online update step: 7/25
2025-06-02 15:27:18,354 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:18,450 - DEBUG - Node anomaly scores shape: torch.Size([15221, 1])
2025-06-02 15:27:18,455 - DEBUG - Edge anomaly scores shape: torch.Size([31262, 1])
2025-06-02 15:27:18,456 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:18,641 - DEBUG - Step 7: Loss=1.3148
2025-06-02 15:27:18,642 - DEBUG - Online update step: 8/25
2025-06-02 15:27:18,652 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:18,740 - DEBUG - Node anomaly scores shape: torch.Size([15121, 1])
2025-06-02 15:27:18,743 - DEBUG - Edge anomaly scores shape: torch.Size([31112, 1])
2025-06-02 15:27:18,745 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:18,897 - DEBUG - Step 8: Loss=1.3010
2025-06-02 15:27:18,898 - DEBUG - Online update step: 9/25
2025-06-02 15:27:18,924 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:19,025 - DEBUG - Node anomaly scores shape: torch.Size([15020, 1])
2025-06-02 15:27:19,029 - DEBUG - Edge anomaly scores shape: torch.Size([30900, 1])
2025-06-02 15:27:19,030 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:19,284 - DEBUG - Step 9: Loss=1.3234
2025-06-02 15:27:19,285 - DEBUG - Online update step: 10/25
2025-06-02 15:27:19,297 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:19,383 - DEBUG - Node anomaly scores shape: torch.Size([15034, 1])
2025-06-02 15:27:19,387 - DEBUG - Edge anomaly scores shape: torch.Size([30893, 1])
2025-06-02 15:27:19,389 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:19,564 - DEBUG - Step 10: Loss=1.3088
2025-06-02 15:27:19,565 - DEBUG - Online update step: 11/25
2025-06-02 15:27:19,581 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:19,683 - DEBUG - Node anomaly scores shape: torch.Size([15792, 1])
2025-06-02 15:27:19,686 - DEBUG - Edge anomaly scores shape: torch.Size([32535, 1])
2025-06-02 15:27:19,688 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:19,898 - DEBUG - Step 11: Loss=1.2645
2025-06-02 15:27:19,898 - DEBUG - Online update step: 12/25
2025-06-02 15:27:19,910 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:19,993 - DEBUG - Node anomaly scores shape: torch.Size([15114, 1])
2025-06-02 15:27:19,997 - DEBUG - Edge anomaly scores shape: torch.Size([30953, 1])
2025-06-02 15:27:19,998 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:20,213 - DEBUG - Step 12: Loss=1.2564
2025-06-02 15:27:20,214 - DEBUG - Online update step: 13/25
2025-06-02 15:27:20,228 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:20,307 - DEBUG - Node anomaly scores shape: torch.Size([14845, 1])
2025-06-02 15:27:20,311 - DEBUG - Edge anomaly scores shape: torch.Size([30492, 1])
2025-06-02 15:27:20,312 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:20,436 - DEBUG - Step 13: Loss=1.2677
2025-06-02 15:27:20,439 - DEBUG - Online update step: 14/25
2025-06-02 15:27:20,451 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:20,565 - DEBUG - Node anomaly scores shape: torch.Size([14458, 1])
2025-06-02 15:27:20,569 - DEBUG - Edge anomaly scores shape: torch.Size([29534, 1])
2025-06-02 15:27:20,570 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:20,746 - DEBUG - Step 14: Loss=1.2576
2025-06-02 15:27:20,746 - DEBUG - Online update step: 15/25
2025-06-02 15:27:20,755 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:20,834 - DEBUG - Node anomaly scores shape: torch.Size([14608, 1])
2025-06-02 15:27:20,837 - DEBUG - Edge anomaly scores shape: torch.Size([29902, 1])
2025-06-02 15:27:20,838 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:20,972 - DEBUG - Step 15: Loss=1.2252
2025-06-02 15:27:20,973 - DEBUG - Online update step: 16/25
2025-06-02 15:27:20,982 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:21,098 - DEBUG - Node anomaly scores shape: torch.Size([15375, 1])
2025-06-02 15:27:21,103 - DEBUG - Edge anomaly scores shape: torch.Size([31641, 1])
2025-06-02 15:27:21,105 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:21,288 - DEBUG - Step 16: Loss=1.2071
2025-06-02 15:27:21,288 - DEBUG - Online update step: 17/25
2025-06-02 15:27:21,297 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:21,380 - DEBUG - Node anomaly scores shape: torch.Size([15052, 1])
2025-06-02 15:27:21,384 - DEBUG - Edge anomaly scores shape: torch.Size([30941, 1])
2025-06-02 15:27:21,385 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:21,532 - DEBUG - Step 17: Loss=1.2216
2025-06-02 15:27:21,533 - DEBUG - Online update step: 18/25
2025-06-02 15:27:21,542 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:21,644 - DEBUG - Node anomaly scores shape: torch.Size([15082, 1])
2025-06-02 15:27:21,648 - DEBUG - Edge anomaly scores shape: torch.Size([31066, 1])
2025-06-02 15:27:21,650 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:21,814 - DEBUG - Step 18: Loss=1.2033
2025-06-02 15:27:21,814 - DEBUG - Online update step: 19/25
2025-06-02 15:27:21,823 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:21,907 - DEBUG - Node anomaly scores shape: torch.Size([14568, 1])
2025-06-02 15:27:21,913 - DEBUG - Edge anomaly scores shape: torch.Size([29809, 1])
2025-06-02 15:27:21,915 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:22,132 - DEBUG - Step 19: Loss=1.1821
2025-06-02 15:27:22,134 - DEBUG - Online update step: 20/25
2025-06-02 15:27:22,147 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:22,243 - DEBUG - Node anomaly scores shape: torch.Size([15498, 1])
2025-06-02 15:27:22,246 - DEBUG - Edge anomaly scores shape: torch.Size([31826, 1])
2025-06-02 15:27:22,248 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:22,431 - DEBUG - Step 20: Loss=1.1869
2025-06-02 15:27:22,431 - DEBUG - Online update step: 21/25
2025-06-02 15:27:22,439 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:22,541 - DEBUG - Node anomaly scores shape: torch.Size([14792, 1])
2025-06-02 15:27:22,547 - DEBUG - Edge anomaly scores shape: torch.Size([30316, 1])
2025-06-02 15:27:22,553 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:22,797 - DEBUG - Step 21: Loss=1.1787
2025-06-02 15:27:22,797 - DEBUG - Online update step: 22/25
2025-06-02 15:27:22,805 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:22,885 - DEBUG - Node anomaly scores shape: torch.Size([14912, 1])
2025-06-02 15:27:22,889 - DEBUG - Edge anomaly scores shape: torch.Size([30597, 1])
2025-06-02 15:27:22,890 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:23,063 - DEBUG - Step 22: Loss=1.1542
2025-06-02 15:27:23,063 - DEBUG - Online update step: 23/25
2025-06-02 15:27:23,071 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:23,185 - DEBUG - Node anomaly scores shape: torch.Size([15228, 1])
2025-06-02 15:27:23,189 - DEBUG - Edge anomaly scores shape: torch.Size([31273, 1])
2025-06-02 15:27:23,191 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:23,399 - DEBUG - Step 23: Loss=1.1624
2025-06-02 15:27:23,400 - DEBUG - Online update step: 24/25
2025-06-02 15:27:23,413 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:23,501 - DEBUG - Node anomaly scores shape: torch.Size([15096, 1])
2025-06-02 15:27:23,504 - DEBUG - Edge anomaly scores shape: torch.Size([30949, 1])
2025-06-02 15:27:23,506 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:23,694 - DEBUG - Step 24: Loss=1.1520
2025-06-02 15:27:23,695 - DEBUG - Online update step: 25/25
2025-06-02 15:27:23,707 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:23,803 - DEBUG - Node anomaly scores shape: torch.Size([15281, 1])
2025-06-02 15:27:23,808 - DEBUG - Edge anomaly scores shape: torch.Size([31421, 1])
2025-06-02 15:27:23,810 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:24,037 - DEBUG - Step 25: Loss=1.1306
2025-06-02 15:27:24,038 - INFO - Online update finished. Average loss: 1.2646, Learning rate: 0.001000
2025-06-02 15:27:24,039 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -1.5236218e-08  3.9783455e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.6929130e-09
 -9.0288692e-09  1.6929130e-08 -5.6430434e-09  3.3858261e-09
  2.2899408e+00  2.9597633e+00  1.4792900e-01  4.3940830e+00
 -9.0288692e-09  3.3775148e+00  5.7952662e+00  7.5976334e+00
  1.4792900e-01  7.9917159e+00 -5.6430434e-09  2.8497368e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -9.0288692e-09  3.1601044e-08], current edge mean: [ 4.1965866e-09  4.6068152e+02  0.0000000e+00  0.0000000e+00
 -3.1474401e-09  1.0491467e-09 -4.1965866e-09  3.1474401e-09
  3.1474401e-09  2.0982933e-09]
2025-06-02 15:27:24,040 - DEBUG - Node drift difference: 0.0106, Edge drift difference: 0.0007
2025-06-02 15:27:24,042 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -1.5236218e-08  3.9783455e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.6929130e-09
 -9.0288692e-09  1.6929130e-08 -5.6430434e-09  3.3858261e-09
  2.2899408e+00  2.9597633e+00  1.4792900e-01  4.3940830e+00
 -9.0288692e-09  3.3775148e+00  5.7952662e+00  7.5976334e+00
  1.4792900e-01  7.9917159e+00 -5.6430434e-09  2.8497368e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -9.0288692e-09  3.1601044e-08], edge=[ 4.1965866e-09  4.6068152e+02  0.0000000e+00  0.0000000e+00
 -3.1474401e-09  1.0491467e-09 -4.1965866e-09  3.1474401e-09
  3.1474401e-09  2.0982933e-09]
2025-06-02 15:27:24,044 - DEBUG - Updated reference std: node=[0.         0.         1.0005922  1.0005922  0.         0.
 0.         1.0005922  1.0005922  1.0005922  1.0005922  1.0005922
 0.9916503  0.28097653 0.3715423  0.5695371  1.0005922  3.015083
 2.9019485  1.5126619  0.3715423  0.24080732 1.0005922  1.0005922
 0.         0.         0.         0.         1.0005922  1.0005922 ], edge=[  1.0002751 477.65646     0.          0.          1.0002751   1.0002751
   1.0002751   1.0002751   1.0002751   1.0002751]
2025-06-02 15:27:24,044 - INFO - Online update complete. Loss: 1.2646
2025-06-02 15:27:24,044 - INFO - Running anomaly detection...
2025-06-02 15:27:24,045 - INFO - Starting anomaly detection.
2025-06-02 15:27:24,067 - DEBUG - Node reconstruction errors: [ 0.78962016  5.424744   13.838208    0.86494064  1.1461309   0.8231049
 13.109241    0.8840196   0.88401973  1.005082    0.8840196   1.5091615
 18.117453    1.3046889   0.626459    0.81445736  1.5508254   0.8144573
  3.3897965   0.68318903  0.4990549   0.62645876  0.47400016  0.9590119
  0.5567577   0.81098855  0.5567576   1.4247601   0.75939405  0.55675757
  3.653135    0.9750444   1.3829312   0.734698    0.81582314  0.45571545
  0.8755853   0.68318903  1.2542331   0.9729439   0.70879465  0.51087415
  0.68318903  0.48087656  1.3157893   0.9364004   0.96259534  0.96990496
  0.6500903   1.4395943   5.711767    0.68830425  0.69633424  2.7893136
  0.38827747  1.0670906   9.417984    0.46742323  2.9964213   2.6477876
  1.0827929   0.17387837  0.4105416   0.86343545  0.4389445   0.3882778
  0.31070742  0.38827768  0.41054145  0.41054145  0.36043313  0.62044275
  0.29467884  0.8065407   0.80767936  0.66591334  0.40326732  0.57222176
  0.60529304  0.6864149   0.4161988   0.5052634   1.9007337   2.6627834
  0.6744859   0.8602038   0.43465605  0.6755258   0.7374516   0.4690207
  0.30019903  1.0806326   0.8785299   0.59103584  0.24584815  5.0622416
  0.33734906  0.7174192   0.21136737  0.33032265  0.48798242  0.33734903
  0.38221756  0.49613115  0.9684877   0.3057536   0.83352244  0.7423832
  0.92598987  0.946833    0.63758534  0.3205382   1.2442173   1.0039855
  0.48540434  0.3834634   0.447381    0.9780897   0.71360195  0.22412382
  0.195088    0.8506426   0.97511804  0.7503834   0.751679    0.22412185
  0.78117174  0.6721771   0.6389542   0.14903322  0.37687466  0.273282
  1.4994891   1.4992224   0.41933012  0.30817157  0.32550508  0.25364834
  0.91542524  1.2427411   0.35208136  0.40802664  0.16581272  0.35208136
  0.30986038  0.5276563   0.44738087  0.45587382  0.2714704   0.6687014
  0.8438288   1.0498269   0.667082    0.27328178  1.1897392   1.000404
  0.24270484  0.42571148  0.48798254  0.46333906  0.35208136  0.7440129
  0.24270502  0.37687466  0.45202923  1.0002675   0.50940835  0.5746543
  0.7695512   0.7149409   0.6559748   0.22463861  0.27646157  5.620208
  0.71360075  1.2888062   0.5738288   0.4163179   0.42274943  0.42274955
  0.27362642  0.93031687  0.21022834  0.9891178   1.2223977   0.5992977
  0.12620243  0.4303144   0.274983    0.21016106  0.64342684  0.63652265
  0.33409965  0.30191907  0.91543084  0.31040534  1.6991171   0.24308659
  0.98117644  0.15166514  0.16581878  0.24270481  1.0010003   0.7242353
  0.75337106  0.72573566  0.4566654   1.6762662   0.17660488  0.6326673
  0.39420846  0.41884366  0.38929114  0.5693388   0.61724     0.14225344
  0.6865242   0.44738087  0.5073439   0.30191907  0.9987881   0.12620243
  0.2161635   0.38929114  0.24270481  0.6767288   1.0020723   0.34318316
  0.5980024   0.784131    0.7183543   0.58253723  0.7187205   0.44738072
  0.4473809   0.3307048   0.5355282   0.2161635   0.24270487  0.21980277
  1.0160131   0.56734174  0.29374477  0.7570442   0.28966203  0.757044
  0.38635197  0.45114443  0.29374477  0.256763    0.27646157  0.2742735
  0.50734353  0.5588254   0.46633556  0.49411055  0.21016106  0.11285032
  0.12725626  0.42274937  0.5499119   1.081857    0.3325163   0.3472936
  0.6430325   0.21889766  0.6596623   3.4315493   0.6596623   0.3805984
  1.0114069   0.9692137   0.55600864  0.38158485  0.44237274  0.42274967
  0.16896114  0.66476625  0.27362636  0.63359016  1.5745443   0.19648837
  0.5398265   0.39088807  0.6472927   0.2666036   1.4428958   0.7561578
  0.9303157   1.1301701   0.2545916   0.19057174  0.25234094  0.28966203
  1.338939    0.09439539  0.53592616  0.42274958  0.31040528  0.94222426
  0.5218254   0.15442637  0.39044034  0.62699157  0.1544263   0.15442637
  0.1544263   0.42111626  0.12584953  0.1544263   0.1544263   1.2640741
  0.1544263   0.19208702  0.769355    0.55335635  0.4060183   0.79354465
  0.35066283  0.29947338  0.630405    0.24018171  0.65595615  0.39044073
  0.7458717   0.97530425  0.16132529  0.47390726  0.61031544  0.61031556
  0.64365065  0.29280567  0.1544263   0.4423725   0.15442637  0.4211162
  0.35784036  0.21482208  0.16132529  0.1613252   0.15442637  0.22749923
  0.16132529  0.64914775  0.6641561   0.6200914   0.39044052  0.23176894
  0.6984182   0.56998473  0.15442632  0.36917627  0.98702437  0.4453082
  0.1887558   0.21016112  0.09109572  0.1544263   0.19676085  2.5498877
  0.3942085   0.20457156  0.2750196   0.5687029   0.39044043  5.158341
  0.13996269  1.353492    0.370145    0.33577746  0.5235169   0.5660432
  0.6247049   1.0510734   0.6613766   0.44530913  0.17063935  0.2574535
  0.5654749   0.1544263   0.3904405   0.6120847   0.19506092  0.51954526
  0.6209914   0.65541804  0.3805772   0.904567    0.4578646   0.15442634
  0.54949343  0.47523326  0.33993122  1.2164437   0.41405183  0.41405165
  0.41405183  2.5830855   0.12677136  2.5927165   0.1886025   0.39530978
  0.41405183  0.12677136  0.34857443  0.3399312   0.6609027   0.19122547
  0.3399312   0.68569714  0.41405168  0.3399313   0.12677129  0.41405183
  0.41405168  0.10209925  0.18325819  0.41405183  0.17064074  0.19795635
  0.19329715  0.21811745  0.32403105  0.19075277  1.0695134   0.25994158
  0.27658176  0.38352382  0.7442289   0.7585389   0.6100398   0.2537968
  0.37150905  0.37987593  0.41405165  0.41405168  0.1886025   0.58783823
  1.0378634   0.13412969  0.2001784   0.23124461  0.38564196  0.09570606
  0.10153817  1.2982389   1.4598218   0.21040423  0.30277035  0.20000002
  0.64165175  0.12353224  0.20636828  0.11382459  0.12353228  0.26486242
  0.1907526   0.19643731  0.1583078   0.4506207   0.33756244  0.209308
  0.19262831  0.88462925  0.19262828  0.20930809  0.13986424  0.4087669
  0.6792129   0.29110354  0.13986424  0.33756235  0.5863982   1.3787943
  0.68191224  0.3240312   0.40876678  0.33756235  0.10668915  0.21998182
  0.18219307  1.162752    0.1613091   0.21040441  1.173421    0.11638498
  0.12353228  0.626559    0.24674238  1.3787946   0.33995506  0.1066892
  0.5436395   0.09968066  0.31539378  0.19643712  0.32124248  2.619058
  0.11382455  0.21998174  0.3186981   0.09968062  0.31869844  0.13745546
  0.12435427  0.7099896   0.09902371  1.4262624   0.28433883  0.12353233
  0.7058828   0.22003809  0.22003809  0.10153817  0.3668788   0.1642138
  0.09902371  0.33618554  0.29064623  0.51531047  0.33618551  0.23124456
  0.09902371  0.31830528  0.12435424  0.32124248  0.32386264  0.6715634
  0.3361856   0.584066    0.1642138   0.11382455  0.11382455  0.21998176
  0.32124248  0.3228888   0.52795476  0.5625323   0.11382459  0.37965775
  0.11382455  0.37965775  0.2526964   0.33618537  0.23014359  3.045114
  0.68609905  0.11589665  2.225003    0.11589665  0.11589665  0.11589672
  0.11589665  0.11589665  0.11589665  0.11589672  0.3417668   0.2671668
  0.24741648  0.11589665  0.11589665  0.11589665  0.11589665  0.11589665
  0.11589665  0.11589665  0.11589667  0.11589665  0.33322477  0.11589665
  0.11589665  1.1108501   0.11589665  0.6421763   0.20713194  0.11382455
  0.35819536  0.4813721   2.0126565   2.0126565   0.58904064  0.35819536
  0.11382459  0.09902371  0.09902366  0.11382459  0.09902371  0.1741594
  0.2869926   0.11589665  0.23124461  0.11382455  0.22003822  0.11382455
  0.11382516  0.2519748   0.11382455  0.09902371  0.11382455  0.11382459
  0.3361855   0.09902366  0.11382455  0.09902371  0.11382455  0.11382459
  0.11382459  0.5734139   0.48137215  0.3153938   0.11589665  0.29182437
  0.23747167  0.11382455  0.09902371  0.59259516  0.11589672  0.21253896
  0.61027455  0.09170387  0.11382459  0.11382455  0.36116225  0.5829811
  0.34456044  0.11382459  0.3417669   0.09945752  0.09902366  0.65854144
  0.11589665  0.36622208  0.44614115  0.11589665  0.11589667  0.34176683
  0.09945749  0.11382455  0.3611643   0.37905195  0.6482439   0.582981
  0.21339108  0.3753128   0.3753128   0.19862826  0.14792491  0.11589665
  0.23537602  0.41093704  0.582981    0.3232239   0.17560346  0.13575982
  0.1323006   0.13230067  0.13230066  0.13230032  0.1323004   0.3460198
  0.4525795   0.1323004   0.13230032  0.11589665  0.12835763  0.11589672
  0.3753128   0.57458127  0.4829816   0.13860519  0.3753128   0.5885112
  0.33322483  0.19420679  0.3332248   0.11589665  0.3753128   0.12410817
  0.10781936  0.10781931  0.1323004   0.12410827  0.56099355  0.15265104
  0.11589665  0.11589665  0.13230066  0.16822992  0.10781936  0.1140766
  0.13575982  0.15143435  0.34601983  1.5714498   0.15143435  1.4330794
  0.3617768   0.13575982  0.29126903  0.13831447  0.16359824  0.22341864
  0.4000307   0.16274524  0.37973532  0.13575982  0.13575988  0.13575982
  0.13260688  0.13575988  0.13575982  0.16359815  0.13575982  0.13575988
  0.13575982  0.38271526  0.16670474  0.62717944  0.6484953   0.3980324
  0.32563734  0.17835015  0.6511603   2.5827098   0.20572771  0.209208
  0.293457    0.4290295   0.4290296   0.16359824  1.3150485   0.75374216
  0.20573197  0.20714778  0.33803734  1.4499478   0.2661806   0.2661806
  0.2661806   0.26566118  0.27988717  0.8193281   0.5686891   0.4571351
  0.28864008  0.25996807  0.3726106   0.20714776  0.39757285  0.46724072
  0.21621296  0.42737767  0.205732    0.75374204  0.20714776  0.46724063
  0.25996807  0.2859016   0.2661806   0.26566118  0.21621306  0.3562418
  0.49657667  0.26566118  0.26566112  0.26566118  0.4476223   0.47807133
  3.5779963   0.2661806   0.72086823  0.265662    0.4860131   0.507352
  2.8075728   0.5073522   0.26566118  0.33931282  0.537164    0.2623065
  0.33931264  0.5073522   5.932503    0.41977108  0.6146225   0.507352
  0.55274796  0.5786065   0.44345543  0.78283924  0.55237234  0.33428994
  0.33428994  0.78283924  0.6740516   0.33931282  0.50735205  0.4434554
  0.507352    0.42149338  0.42149338  0.4214935   0.35929728  0.87277144
  0.4214935   0.4214935   0.4535733   0.6444157   0.4214935   0.4214932
  0.42809004  0.6645683   0.8963265   0.8828522   0.42149338  0.6364359
  0.6444157   0.4214932   0.52349496  0.57037365  0.4214932   0.4214932
  0.895236    0.5703736   0.4214935   0.57037365  0.60547847  0.9857585
  0.77230763  0.4214935   0.8204396   0.6054783   0.6054782   0.664568
  0.53158444  0.6054782   0.52349496  0.52349496  0.5234949   0.7864269
  0.678092    0.7864269   0.96002835  0.523495    0.67809224]
2025-06-02 15:27:24,068 - DEBUG - Edge reconstruction errors: [  5.2628675   5.2628007  44.25845   ...  13.358429  535.2589
  13.358429 ]
2025-06-02 15:27:24,071 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152724_update_35.json
2025-06-02 15:27:24,072 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:27:24,120 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152724_update_35.pth
2025-06-02 15:27:24,120 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870145.dot): 0.9004
2025-06-02 15:27:24,120 - WARNING - Detected 13 anomalous nodes (reconstruction-based):
2025-06-02 15:27:24,121 - WARNING -   Node ID: 192.168.239.101, Recon Error: 5.4247, MLP Score: 0.4434
2025-06-02 15:27:24,121 - WARNING -   Node ID: 192.168.27.13, Recon Error: 13.8382, MLP Score: 0.4168
2025-06-02 15:27:24,121 - WARNING -   Node ID: 192.168.27.12, Recon Error: 13.1092, MLP Score: 0.4094
2025-06-02 15:27:24,121 - WARNING -   Node ID: 192.168.27.10, Recon Error: 18.1175, MLP Score: 0.4111
2025-06-02 15:27:24,121 - WARNING -   Node ID: 199.232.214.172, Recon Error: 3.6531, MLP Score: 0.4694
2025-06-02 15:27:24,122 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:27:24,122 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2584, MLP Score: 0.0000
2025-06-02 15:27:24,122 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9603, MLP Score: 0.0000
2025-06-02 15:27:24,122 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0610, MLP Score: 0.0000
2025-06-02 15:27:24,123 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7595, MLP Score: 0.0000
2025-06-02 15:27:24,123 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7589, MLP Score: 0.0000
2025-06-02 15:27:24,123 - INFO - 
--- Processing file: nw_graph_encoded_1748870175.dot (Timestamp: 2025-06-02 15:16:15) ---
2025-06-02 15:27:24,123 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870175.dot
2025-06-02 15:27:24,124 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870175.dot'.
2025-06-02 15:27:24,124 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870175.dot
2025-06-02 15:27:24,156 - INFO - Parsed 866 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870175.dot'.
2025-06-02 15:27:24,260 - INFO - Parsed 1848 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870175.dot'.
2025-06-02 15:27:24,260 - INFO - Processing node updates/additions.
2025-06-02 15:27:24,312 - INFO - Processing edge updates/additions.
2025-06-02 15:27:24,500 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:27:24,509 - INFO - Finished updating NetworkX graph.
2025-06-02 15:27:24,514 - DEBUG - Updated graph - Nodes: 866, Edges: 1848
2025-06-02 15:27:24,514 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:27:24,523 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:27:24,698 - DEBUG - Initial node features tensor shape: torch.Size([866, 30])
2025-06-02 15:27:24,701 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:27:24,702 - DEBUG - Node features tensor shape after scaling: torch.Size([866, 30])
2025-06-02 15:27:24,708 - DEBUG - Edge index tensor shape: torch.Size([2, 1848])
2025-06-02 15:27:24,719 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:27:24,804 - DEBUG - Initial edge attributes tensor shape: torch.Size([1848, 10])
2025-06-02 15:27:24,808 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:27:24,808 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1848, 10])
2025-06-02 15:27:24,809 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:27:24,810 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:27:24,814 - INFO - Updated main graph to 866 nodes and 1848 edges.
2025-06-02 15:27:24,814 - INFO - Performing online update...
2025-06-02 15:27:24,815 - INFO - Starting online update for 25 steps.
2025-06-02 15:27:24,816 - DEBUG - Updated RunningStats: new_mean=0.9437220506251973, new_var=20400000000161.473, new_n=2070
2025-06-02 15:27:24,816 - DEBUG - Updated RunningStats: new_mean=0.940823358502129, new_var=20700000000018.105, new_n=2100
2025-06-02 15:27:24,817 - DEBUG - Updated RunningStats: new_mean=44.35958148517441, new_var=6800000190305.406, new_n=690
2025-06-02 15:27:24,817 - DEBUG - Updated RunningStats: new_mean=44.41303840466879, new_var=6900000201696.47, new_n=700
2025-06-02 15:27:24,818 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:27:24,818 - DEBUG - Online update step: 1/25
2025-06-02 15:27:24,826 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:24,917 - DEBUG - Node anomaly scores shape: torch.Size([14998, 1])
2025-06-02 15:27:24,927 - DEBUG - Edge anomaly scores shape: torch.Size([30828, 1])
2025-06-02 15:27:24,928 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:25,149 - DEBUG - Step 1: Loss=1.1363
2025-06-02 15:27:25,150 - DEBUG - Online update step: 2/25
2025-06-02 15:27:25,159 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:25,258 - DEBUG - Node anomaly scores shape: torch.Size([15638, 1])
2025-06-02 15:27:25,262 - DEBUG - Edge anomaly scores shape: torch.Size([32177, 1])
2025-06-02 15:27:25,263 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:25,472 - DEBUG - Step 2: Loss=1.1183
2025-06-02 15:27:25,473 - DEBUG - Online update step: 3/25
2025-06-02 15:27:25,484 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:25,662 - DEBUG - Node anomaly scores shape: torch.Size([15896, 1])
2025-06-02 15:27:25,670 - DEBUG - Edge anomaly scores shape: torch.Size([32778, 1])
2025-06-02 15:27:25,674 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:25,891 - DEBUG - Step 3: Loss=1.1145
2025-06-02 15:27:25,892 - DEBUG - Online update step: 4/25
2025-06-02 15:27:25,901 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:25,983 - DEBUG - Node anomaly scores shape: torch.Size([14725, 1])
2025-06-02 15:27:25,986 - DEBUG - Edge anomaly scores shape: torch.Size([30198, 1])
2025-06-02 15:27:25,987 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:26,145 - DEBUG - Step 4: Loss=1.1137
2025-06-02 15:27:26,146 - DEBUG - Online update step: 5/25
2025-06-02 15:27:26,157 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:26,273 - DEBUG - Node anomaly scores shape: torch.Size([15542, 1])
2025-06-02 15:27:26,279 - DEBUG - Edge anomaly scores shape: torch.Size([32136, 1])
2025-06-02 15:27:26,281 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:26,481 - DEBUG - Step 5: Loss=1.0903
2025-06-02 15:27:26,481 - DEBUG - Online update step: 6/25
2025-06-02 15:27:26,490 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:26,569 - DEBUG - Node anomaly scores shape: torch.Size([15069, 1])
2025-06-02 15:27:26,572 - DEBUG - Edge anomaly scores shape: torch.Size([30892, 1])
2025-06-02 15:27:26,573 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:26,744 - DEBUG - Step 6: Loss=1.0992
2025-06-02 15:27:26,745 - DEBUG - Online update step: 7/25
2025-06-02 15:27:26,759 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:26,858 - DEBUG - Node anomaly scores shape: torch.Size([16053, 1])
2025-06-02 15:27:26,863 - DEBUG - Edge anomaly scores shape: torch.Size([33005, 1])
2025-06-02 15:27:26,865 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:27,052 - DEBUG - Step 7: Loss=1.0845
2025-06-02 15:27:27,053 - DEBUG - Online update step: 8/25
2025-06-02 15:27:27,062 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:27,160 - DEBUG - Node anomaly scores shape: torch.Size([16341, 1])
2025-06-02 15:27:27,165 - DEBUG - Edge anomaly scores shape: torch.Size([33745, 1])
2025-06-02 15:27:27,167 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:27,364 - DEBUG - Step 8: Loss=1.0778
2025-06-02 15:27:27,365 - DEBUG - Online update step: 9/25
2025-06-02 15:27:27,376 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:27,469 - DEBUG - Node anomaly scores shape: torch.Size([15777, 1])
2025-06-02 15:27:27,474 - DEBUG - Edge anomaly scores shape: torch.Size([32509, 1])
2025-06-02 15:27:27,475 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:27,650 - DEBUG - Step 9: Loss=1.0767
2025-06-02 15:27:27,650 - DEBUG - Online update step: 10/25
2025-06-02 15:27:27,660 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:27,790 - DEBUG - Node anomaly scores shape: torch.Size([15935, 1])
2025-06-02 15:27:27,795 - DEBUG - Edge anomaly scores shape: torch.Size([32836, 1])
2025-06-02 15:27:27,797 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:28,010 - DEBUG - Step 10: Loss=1.0590
2025-06-02 15:27:28,011 - DEBUG - Online update step: 11/25
2025-06-02 15:27:28,019 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:28,104 - DEBUG - Node anomaly scores shape: torch.Size([15357, 1])
2025-06-02 15:27:28,107 - DEBUG - Edge anomaly scores shape: torch.Size([31506, 1])
2025-06-02 15:27:28,110 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:28,295 - DEBUG - Step 11: Loss=1.0638
2025-06-02 15:27:28,297 - DEBUG - Online update step: 12/25
2025-06-02 15:27:28,308 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:28,448 - DEBUG - Node anomaly scores shape: torch.Size([15473, 1])
2025-06-02 15:27:28,455 - DEBUG - Edge anomaly scores shape: torch.Size([31993, 1])
2025-06-02 15:27:28,460 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:28,690 - DEBUG - Step 12: Loss=1.0479
2025-06-02 15:27:28,691 - DEBUG - Online update step: 13/25
2025-06-02 15:27:28,703 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:28,798 - DEBUG - Node anomaly scores shape: torch.Size([15635, 1])
2025-06-02 15:27:28,802 - DEBUG - Edge anomaly scores shape: torch.Size([32181, 1])
2025-06-02 15:27:28,803 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:29,131 - DEBUG - Step 13: Loss=1.0502
2025-06-02 15:27:29,132 - DEBUG - Online update step: 14/25
2025-06-02 15:27:29,144 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:29,503 - DEBUG - Node anomaly scores shape: torch.Size([15475, 1])
2025-06-02 15:27:29,507 - DEBUG - Edge anomaly scores shape: torch.Size([31876, 1])
2025-06-02 15:27:29,508 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:29,666 - DEBUG - Step 14: Loss=1.0402
2025-06-02 15:27:29,666 - DEBUG - Online update step: 15/25
2025-06-02 15:27:29,675 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:29,834 - DEBUG - Node anomaly scores shape: torch.Size([15362, 1])
2025-06-02 15:27:29,840 - DEBUG - Edge anomaly scores shape: torch.Size([31556, 1])
2025-06-02 15:27:29,842 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:30,133 - DEBUG - Step 15: Loss=1.0387
2025-06-02 15:27:30,134 - DEBUG - Online update step: 16/25
2025-06-02 15:27:30,145 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:30,248 - DEBUG - Node anomaly scores shape: torch.Size([14499, 1])
2025-06-02 15:27:30,252 - DEBUG - Edge anomaly scores shape: torch.Size([29650, 1])
2025-06-02 15:27:30,254 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:30,445 - DEBUG - Step 16: Loss=1.0332
2025-06-02 15:27:30,446 - DEBUG - Online update step: 17/25
2025-06-02 15:27:30,463 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:30,573 - DEBUG - Node anomaly scores shape: torch.Size([15267, 1])
2025-06-02 15:27:30,578 - DEBUG - Edge anomaly scores shape: torch.Size([31314, 1])
2025-06-02 15:27:30,580 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:30,827 - DEBUG - Step 17: Loss=1.0292
2025-06-02 15:27:30,827 - DEBUG - Online update step: 18/25
2025-06-02 15:27:30,836 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:30,958 - DEBUG - Node anomaly scores shape: torch.Size([15880, 1])
2025-06-02 15:27:30,962 - DEBUG - Edge anomaly scores shape: torch.Size([32719, 1])
2025-06-02 15:27:30,964 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:31,160 - DEBUG - Step 18: Loss=1.0199
2025-06-02 15:27:31,160 - DEBUG - Online update step: 19/25
2025-06-02 15:27:31,169 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:31,253 - DEBUG - Node anomaly scores shape: torch.Size([15455, 1])
2025-06-02 15:27:31,256 - DEBUG - Edge anomaly scores shape: torch.Size([31933, 1])
2025-06-02 15:27:31,257 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:31,441 - DEBUG - Step 19: Loss=1.0171
2025-06-02 15:27:31,442 - DEBUG - Online update step: 20/25
2025-06-02 15:27:31,453 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:31,564 - DEBUG - Node anomaly scores shape: torch.Size([16064, 1])
2025-06-02 15:27:31,568 - DEBUG - Edge anomaly scores shape: torch.Size([33171, 1])
2025-06-02 15:27:31,570 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:31,778 - DEBUG - Step 20: Loss=1.0053
2025-06-02 15:27:31,778 - DEBUG - Online update step: 21/25
2025-06-02 15:27:31,787 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:31,878 - DEBUG - Node anomaly scores shape: torch.Size([15849, 1])
2025-06-02 15:27:31,882 - DEBUG - Edge anomaly scores shape: torch.Size([32645, 1])
2025-06-02 15:27:31,884 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:32,113 - DEBUG - Step 21: Loss=1.0062
2025-06-02 15:27:32,114 - DEBUG - Online update step: 22/25
2025-06-02 15:27:32,123 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:32,418 - DEBUG - Node anomaly scores shape: torch.Size([16442, 1])
2025-06-02 15:27:32,498 - DEBUG - Edge anomaly scores shape: torch.Size([34041, 1])
2025-06-02 15:27:32,553 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:33,866 - DEBUG - Step 22: Loss=0.9943
2025-06-02 15:27:33,867 - DEBUG - Online update step: 23/25
2025-06-02 15:27:33,875 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:34,602 - DEBUG - Node anomaly scores shape: torch.Size([15588, 1])
2025-06-02 15:27:34,677 - DEBUG - Edge anomaly scores shape: torch.Size([32210, 1])
2025-06-02 15:27:34,730 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:35,803 - DEBUG - Step 23: Loss=0.9964
2025-06-02 15:27:35,803 - DEBUG - Online update step: 24/25
2025-06-02 15:27:35,815 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:35,897 - DEBUG - Node anomaly scores shape: torch.Size([14849, 1])
2025-06-02 15:27:35,907 - DEBUG - Edge anomaly scores shape: torch.Size([30458, 1])
2025-06-02 15:27:35,912 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:36,183 - DEBUG - Step 24: Loss=0.9863
2025-06-02 15:27:36,184 - DEBUG - Online update step: 25/25
2025-06-02 15:27:36,191 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:36,284 - DEBUG - Node anomaly scores shape: torch.Size([15719, 1])
2025-06-02 15:27:36,290 - DEBUG - Edge anomaly scores shape: torch.Size([32394, 1])
2025-06-02 15:27:36,292 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:36,508 - DEBUG - Step 25: Loss=0.9874
2025-06-02 15:27:36,509 - INFO - Online update finished. Average loss: 1.0515, Learning rate: 0.001000
2025-06-02 15:27:36,511 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  1.7344538e-08  5.7815130e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.8081635e-08
  1.3214887e-08 -5.5062026e-09  9.9111652e-09  1.1012405e-09
  2.3048499e+00  2.9584296e+00  1.4434180e-01  4.4006929e+00
  5.5062026e-09  3.3418014e+00  5.8198614e+00  7.6073904e+00
  1.4434180e-01  7.9919167e+00 -3.7992798e-08  3.1935976e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.6074435e-09  3.3037217e-09], current edge mean: [-2.0642301e-09  4.5980521e+02  0.0000000e+00  0.0000000e+00
 -1.0321151e-09  0.0000000e+00  3.0963452e-09 -6.1926904e-09
  4.1284602e-09 -2.0642301e-09]
2025-06-02 15:27:36,512 - DEBUG - Node drift difference: 0.0150, Edge drift difference: 0.0018
2025-06-02 15:27:36,515 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  1.7344538e-08  5.7815130e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.8081635e-08
  1.3214887e-08 -5.5062026e-09  9.9111652e-09  1.1012405e-09
  2.3048499e+00  2.9584296e+00  1.4434180e-01  4.4006929e+00
  5.5062026e-09  3.3418014e+00  5.8198614e+00  7.6073904e+00
  1.4434180e-01  7.9919167e+00 -3.7992798e-08  3.1935976e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.6074435e-09  3.3037217e-09], edge=[-2.0642301e-09  4.5980521e+02  0.0000000e+00  0.0000000e+00
 -1.0321151e-09  0.0000000e+00  3.0963452e-09 -6.1926904e-09
  4.1284602e-09 -2.0642301e-09]
2025-06-02 15:27:36,517 - DEBUG - Updated reference std: node=[0.         0.         1.0005779  1.0005779  0.         0.
 0.         1.0005778  1.0005778  1.0005779  1.0005779  1.0005779
 0.99914396 0.28549412 0.3677101  0.5709333  1.0005779  2.9968822
 2.89626    1.4954702  0.3677101  0.23786968 1.0005778  1.0005778
 0.         0.         0.         0.         1.0005778  1.0005778 ], edge=[  1.0002707 474.01376     0.          0.          1.0002707   1.0002707
   1.0002707   1.0002707   1.0002707   1.0002707]
2025-06-02 15:27:36,517 - INFO - Online update complete. Loss: 1.0515
2025-06-02 15:27:36,518 - INFO - Running anomaly detection...
2025-06-02 15:27:36,519 - INFO - Starting anomaly detection.
2025-06-02 15:27:36,555 - DEBUG - Node reconstruction errors: [ 0.85656774  4.6391115  12.26084     0.64980114  0.7545288   0.5140158
 11.667725    0.71082884  0.71082884  0.8060991   0.71082896  1.3042699
 16.513046    1.5887418   0.5042842   0.6303752   1.3283411   0.6303751
  3.103469    0.5253764   0.4129282   0.50428426  0.42441607  0.8672961
  0.44914457  0.61506206  0.44914448  1.0596057   0.614517    0.44914448
  3.3339624   0.6717662   1.0273067   0.54056627  0.61585844  0.39870578
  0.56274736  0.5253764   1.004686    0.8922663   0.53844494  0.41004276
  0.5253764   0.38292474  1.5347059   0.8123782   0.75765735  0.81345975
  0.5297951   1.1952752   4.8880987   0.5393212   0.5265081   2.5982049
  0.32928866  0.7226241   8.671612    0.35168523  2.7508597   2.4739258
  0.9560665   0.33596137  0.3276568   0.7348035   0.339562    0.32928866
  0.2574511   0.32928842  0.3276568   0.3359614   0.31752804  0.4284421
  0.23032261  0.53298634  0.44356176  0.46919233  0.33474323  0.37805638
  0.31322855  0.38914087  0.29234034  0.31695122  1.6763066   2.3811262
  0.34090537  1.1777884   0.23915361  0.34857506  0.42887536  0.3095185
  0.2252443   1.0160104   0.7203636   0.30600214  0.21016264  4.7606053
  0.23939428  0.37248808  0.16435857  0.25839654  0.30347654  0.23939428
  0.2788888   0.34819314  0.78474915  0.24634704  0.72924966  0.58682764
  0.7852174   0.949066    0.64634526  0.22152309  0.90839213  0.66391075
  0.30146858  0.18946372  0.2652417   0.6278505   0.37292728  0.19431986
  0.14326206  0.68029994  0.6225823   0.6281611   0.39643827  0.1943178
  0.6839698   0.58004504  0.31233418  0.13502422  0.29117805  0.2028212
  1.3951144   1.1118624   0.2359834   0.23891436  0.24100468  0.1977062
  0.7801228   1.402454    0.30046695  0.20886037  0.12211134  0.30046707
  0.2613024   0.28266495  0.26524177  0.40690944  0.21758686  0.3415524
  0.736575    0.85252833  0.3686522   0.2028212   0.8605597   0.6732626
  0.18545437  0.20651144  0.30347633  0.33754775  0.30046695  0.58566755
  0.18545437  0.29117805  0.26778442  0.9826042   0.307497    0.28293636
  0.610496    0.3787484   0.3600579   0.19593947  0.2052212   4.9082947
  0.37292725  1.6520234   0.2799794   0.18804717  0.23868462  0.23868461
  0.21965091  0.7685336   0.15889972  0.62879455  0.91561127  0.2780026
  0.09032908  0.2472504   0.21149038  0.16030765  0.30703068  0.30473012
  0.27200112  0.22968511  0.78012264  0.23553354  1.5342194   0.21964169
  0.6255606   0.31050825  0.1429904   0.18545437  0.9705364   0.3759037
  0.41412345  0.58701605  0.3637713   1.2630163   0.1373988   0.3342575
  0.208563    0.2367601   0.29247025  0.27533287  0.28724924  0.1128373
  0.33403644  0.26524165  0.3367764   0.22968508  0.6845948   0.09032912
  0.1571489   0.29247025  0.18545438  0.32848498  0.6656272   0.26154625
  0.30432045  0.65402085  0.6087964   0.2791246   0.3675728   0.2652417
  0.2652417   0.28311244  0.24704956  0.1571489   0.18545437  0.18392451
  0.69225466  0.2667996   0.21861115  0.37874815  0.22051018  0.40279168
  0.19576277  0.20899081  0.21861115  0.22444744  0.20522122  0.21001074
  0.33677644  0.2620832   0.22062649  0.3041048   0.16030765  0.08417814
  0.11438913  0.23868458  0.24740423  0.9149983   0.20139854  0.3150117
  0.37692225  0.18697844  0.3521958   3.1630175   0.3521956   0.16753043
  0.6632042   0.6192391   0.26591396  0.31769595  0.24223852  0.23868458
  0.14311244  0.35663164  0.21965098  0.30427617  1.2741792   0.164816
  0.24394755  0.28325498  0.30369037  0.1804703   1.4735374   0.64281934
  0.7685348   1.4462577   0.40168703  0.1339202   0.21200968  0.22051018
  1.6903393   0.07242375  0.2372578   0.23868488  0.23553354  0.74621767
  0.22637802  0.11300456  0.18889092  0.27182445  0.11300456  0.11300456
  0.11300454  0.22134003  0.09003222  0.11300458  0.11300464  1.007325
  0.11300456  0.14654365  0.5989344   0.2624626   0.24816486  0.6439127
  0.26373005  0.22954147  0.32110584  0.21903636  0.34843367  0.18889089
  0.5634553   0.6206242   0.12164541  0.20361288  0.31367823  0.31367835
  0.40339705  0.22297314  0.11300456  0.24223837  0.11300456  0.22133999
  0.35653728  0.16243592  0.12164534  0.12164534  0.11300454  0.16025457
  0.12164534  0.29576987  0.30869395  0.28173104  0.18889086  0.15376253
  0.38146892  0.27736726  0.11300458  0.16758813  0.6734237   0.18054318
  0.13083509  0.1603077   0.06354698  0.11300464  0.14963059  2.2108116
  0.20856293  0.16427644  0.24596158  0.25118393  0.18889101  4.6139994
  0.09737597  1.049066    0.1858022   0.14417885  0.22308855  0.24685268
  0.27484956  0.73201257  0.3080657   0.18054383  0.12076788  0.20415823
  0.24286239  0.11300464  0.18889104  0.4970498   0.14447722  0.21864705
  0.49709746  0.30764762  0.31273335  0.74240565  0.25200328  0.11300458
  0.33983973  0.3690593   0.14770773  0.8698345   0.20312217  0.20312212
  0.20312217  2.3778234   0.08751834  2.3836038   0.14402366  0.19189866
  0.20312212  0.08751834  0.1512227   0.14770764  0.29468334  0.1585398
  0.14770764  0.51489073  0.20312212  0.14770773  0.0875183   0.20312217
  0.2031221   0.05880836  0.1258023   0.20312212  0.12077583  0.16488709
  0.15845872  0.17441735  0.1284429   0.14226124  0.73272306  0.2191035
  0.22768775  0.16890357  0.637015    0.5883612   0.29262218  0.20006213
  0.1416805   0.17613526  0.20312214  0.20312217  0.14402363  0.27176762
  0.70168716  0.10366123  0.16104037  0.18352999  0.3464104   0.06291673
  0.06945617  1.0461566   1.1222711   0.16153304  0.23256741  0.14971119
  0.2723065   0.08221848  0.15333825  0.07373343  0.08221844  0.20169774
  0.14226124  0.14524657  0.10561703  0.18999913  0.14686131  0.15452416
  0.14578111  0.73649514  0.14578111  0.15452416  0.10206701  0.16118759
  0.51898104  0.2203866   0.10206702  0.14686136  0.24770193  1.191731
  0.3310498   0.12844278  0.16118756  0.14686137  0.06942321  0.16354553
  0.1159567   0.8200962   0.13107906  0.16153304  0.83358294  0.08982287
  0.08221844  0.49056423  0.13622893  1.1917312   0.12019175  0.06942321
  0.21627764  0.06614163  0.10745598  0.14524652  0.11993491  2.3611228
  0.07373341  0.16354537  0.26540494  0.06614163  0.26540485  0.11400558
  0.08878993  0.5849331   0.06174274  1.311567    0.22838098  0.08221844
  0.5686058   0.1748352   0.1748352   0.06945618  0.13156864  0.12832226
  0.06174274  0.12219093  0.21404399  0.20887272  0.12219096  0.18352996
  0.06174274  0.2387945   0.08878989  0.11993491  0.24855818  0.59281325
  0.12219083  0.2666849   0.1283223   0.07373343  0.07373343  0.16354553
  0.11993493  0.12097362  0.2198961   0.24413435  0.07373343  0.16878588
  0.07373343  0.16878588  0.20649119  0.12219088  0.18574724  2.7429101
  0.53092724  0.07179747  1.9959569   0.07179748  0.07179747  0.07179746
  0.07179747  0.07179744  0.07179744  0.07179746  0.12125405  0.21493511
  0.13889231  0.07179748  0.07179748  0.07179746  0.07179747  0.07179747
  0.07179748  0.07179748  0.07179748  0.07179742  0.10675355  0.07179747
  0.07179748  0.7774021   0.07179747  0.52240115  0.14082865  0.07373343
  0.20029831  0.1867414   1.6973536   1.6973536   0.26797917  0.20029831
  0.07373343  0.06174274  0.06174274  0.07373343  0.06174274  0.1065823
  0.23589954  0.07179744  0.18353002  0.07373343  0.17483526  0.07373343
  0.07373343  0.20706993  0.07373343  0.06174273  0.07373343  0.07373343
  0.12219095  0.06174274  0.07373341  0.06174274  0.07373343  0.07373343
  0.07373345  0.24686664  0.34480655  0.10745595  0.07179747  0.2289482
  0.14771356  0.07373343  0.06174274  0.2334892   0.07179748  0.17273317
  0.25770319  0.05629625  0.07373343  0.07373343  0.11552083  0.2508749
  0.11115023  0.07373343  0.12125423  0.06470655  0.06174274  0.567439
  0.07179748  0.30358204  0.16673438  0.07179746  0.07179748  0.12125416
  0.06470655  0.07373342  0.3108066   0.1679563   0.26550558  0.2508749
  0.17256859  0.1419268   0.1419268   0.13480787  0.10772955  0.07179744
  0.18757349  0.12970217  0.2508749   0.09976988  0.1328715   0.08848555
  0.08166232  0.08166231  0.08166232  0.08166222  0.08166225  0.10352166
  0.14358862  0.08166222  0.08166222  0.07179747  0.08475331  0.07179747
  0.14192666  0.23736617  0.17403337  0.0825549   0.14192669  0.23393808
  0.10675362  0.15014611  0.10675354  0.07179748  0.14192669  0.08658276
  0.06537347  0.06537352  0.08166232  0.08658271  0.22786032  0.0924032
  0.16237639  0.07179744  0.08166232  0.120271    0.06537347  0.07184871
  0.08848564  0.10961589  0.10352172  1.3829008   0.10961584  1.094065
  0.11028874  0.08848557  0.22988312  0.0954105   0.10917868  0.16334482
  0.12854998  0.1032225   0.12907787  0.08848562  0.08848561  0.08848561
  0.08668348  0.08848562  0.08848561  0.10917874  0.08848561  0.08848561
  0.08848561  0.12030997  0.11584182  0.29853263  0.2627235   0.13314162
  0.2557243   0.12318958  0.26995793  2.3376055   0.14153354  0.14800613
  0.21829572  0.33464515  0.33464515  0.10917868  0.9905383   0.3878373
  0.14153503  0.13646132  0.21435581  1.1129626   0.1921311   0.19213113
  0.1921311   0.18141314  0.2007935   0.6272561   0.45365632  0.37458622
  0.20163141  0.18927407  0.2979676   0.13646136  0.31458607  0.1646464
  0.15086375  0.33916885  0.14153497  0.38783747  0.13646136  0.16464646
  0.18927407  0.7587184   0.19213113  0.18141302  0.1508638   0.2849693
  0.38836518  0.1814131   0.1814131   0.18141302  0.35885197  0.16605446
  3.1787858   0.19213113  0.3175321   0.18141302  0.17143904  0.4072697
  2.462852    0.40726975  0.18141302  0.23821995  0.49762022  0.18575396
  0.63055164  0.40726957  5.468534    0.28359762  0.23141815  0.4072697
  0.19902784  0.45395508  0.2906305   0.34691668  0.21062693  0.24181703
  0.24181709  0.34691682  0.63055164  0.23821995  0.4072697   0.2906306
  0.4072697   0.30961615  0.30961615  0.3096162   0.26256645  0.42975464
  0.30961615  0.3096162   0.33635172  0.4658237   0.30961612  0.30961612
  0.30668956  0.53846955  0.4133485   0.423291    0.30961612  0.27619255
  0.46582374  0.30961612  0.3906639   0.45499536  0.36974317  0.33635172
  0.6872724   0.4549952   0.3096162   0.45499536  0.48402712  0.49378455
  0.62098736  0.30961615  0.67128575  0.48402712  0.48402712  0.53846955
  0.38768587  0.4840271   0.39066398  0.44772926  0.42323828  0.62100047
  0.54400903  0.62100035  0.7940835   0.390664    0.54400903  0.48091194
  0.480912    2.6487324   0.48091194  0.47848004  0.38768572  0.65439767
  0.6104738   0.4232385   0.6104738   0.7258044   0.390664    0.80419147
  0.480912    0.543181    0.44772926  0.48091194  0.57480466  0.42323828
  0.5431811   0.4232382 ]
2025-06-02 15:27:36,557 - DEBUG - Edge reconstruction errors: [  5.2639637   5.2631726  44.259083  ...  13.359064  535.25946
  13.359064 ]
2025-06-02 15:27:36,564 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152736_update_36.json
2025-06-02 15:27:36,565 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:27:36,623 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152736_update_36.pth
2025-06-02 15:27:36,623 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870175.dot): 0.8998
2025-06-02 15:27:36,624 - WARNING - Detected 14 anomalous nodes (reconstruction-based):
2025-06-02 15:27:36,624 - WARNING -   Node ID: 192.168.239.101, Recon Error: 4.6391, MLP Score: 0.4048
2025-06-02 15:27:36,624 - WARNING -   Node ID: 192.168.27.13, Recon Error: 12.2608, MLP Score: 0.4651
2025-06-02 15:27:36,624 - WARNING -   Node ID: 192.168.27.12, Recon Error: 11.6677, MLP Score: 0.5315
2025-06-02 15:27:36,624 - WARNING -   Node ID: 192.168.27.10, Recon Error: 16.5130, MLP Score: 0.5628
2025-06-02 15:27:36,625 - WARNING -   Node ID: 43.132.85.151, Recon Error: 3.1035, MLP Score: 0.5365
2025-06-02 15:27:36,625 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:27:36,625 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2591, MLP Score: 0.0000
2025-06-02 15:27:36,625 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9608, MLP Score: 0.0000
2025-06-02 15:27:36,626 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0615, MLP Score: 0.0000
2025-06-02 15:27:36,626 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7601, MLP Score: 0.0000
2025-06-02 15:27:36,626 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7594, MLP Score: 0.0000
2025-06-02 15:27:36,642 - DEBUG - Embedding standard deviations before t-SNE: [0.95564944 0.         0.         1.2719915  0.         0.32033417
 0.6205489  0.0057979  0.         2.1435122  2.221975   1.3056512
 0.38347185 0.88983727 0.83092254 0.8746262  0.         0.88840806
 0.         1.1908231  0.         1.5970777  0.         0.
 0.         0.6074479  0.12503308 0.7012186  2.0791097  0.
 1.1588156  0.8441379 ]
2025-06-02 15:27:37,653 - INFO - Embeddings visualization saved to vis/embeddings_36_updates_20250602_152736.png
2025-06-02 15:27:37,653 - INFO - Performing visualization of node and edge features.
2025-06-02 15:27:37,659 - INFO - Starting visualization of node features.
2025-06-02 15:27:37,660 - INFO - Graph has 866 nodes and 30 features.
2025-06-02 15:27:37,660 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:27:37,660 - INFO - Calculating feature statistics:
2025-06-02 15:27:37,661 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:27:37,661 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:27:37,661 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 19, 'mean': np.float32(-3.5239697e-08), 'std': np.float32(1.0), 'min': np.float32(-2.0430336), 'max': np.float32(2.4478908)}
2025-06-02 15:27:37,662 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 19, 'mean': np.float32(-7.0479395e-08), 'std': np.float32(1.0), 'min': np.float32(-2.36622), 'max': np.float32(2.1294224)}
2025-06-02 15:27:37,662 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:27:37,662 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:27:37,663 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:27:37,663 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(1.7619849e-08), 'std': np.float32(1.0), 'min': np.float32(-0.45955282), 'max': np.float32(2.1760283)}
2025-06-02 15:27:37,663 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-1.1335609), 'max': np.float32(0.88217574)}
2025-06-02 15:27:37,664 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 4, 'mean': np.float32(-1.7619849e-08), 'std': np.float32(1.0), 'min': np.float32(-9.6710415), 'max': np.float32(0.106151916)}
2025-06-02 15:27:37,664 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 19, 'mean': np.float32(1.7619849e-08), 'std': np.float32(1.0), 'min': np.float32(-2.6916394), 'max': np.float32(1.5956728)}
2025-06-02 15:27:37,664 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 19, 'mean': np.float32(1.7619849e-08), 'std': np.float32(1.0), 'min': np.float32(-1.5623697), 'max': np.float32(2.8000467)}
2025-06-02 15:27:37,665 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 8, 'mean': np.float32(2.3048499), 'std': np.float32(0.9985669), 'min': np.float32(0.0), 'max': np.float32(11.0)}
2025-06-02 15:27:37,665 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.9584296), 'std': np.float32(0.28532922), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:27:37,665 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.1443418), 'std': np.float32(0.3674977), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:27:37,665 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.400693), 'std': np.float32(0.57060355), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:27:37,666 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 4, 'mean': np.float32(1.7619849e-08), 'std': np.float32(1.0), 'min': np.float32(-0.106151916), 'max': np.float32(9.6710415)}
2025-06-02 15:27:37,666 - INFO - - service_1: {'name': 'service_1', 'unique': 5, 'mean': np.float32(3.3418014), 'std': np.float32(2.995151), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 15:27:37,666 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.8198614), 'std': np.float32(2.8945873), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:27:37,667 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.6073904), 'std': np.float32(1.4946064), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:27:37,668 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.1443418), 'std': np.float32(0.3674977), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:27:37,668 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 2, 'mean': np.float32(7.9919167), 'std': np.float32(0.23773229), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:27:37,668 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(-1.982233e-08), 'std': np.float32(1.0), 'min': np.float32(-0.133326), 'max': np.float32(15.61126)}
2025-06-02 15:27:37,669 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(2.4227292e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.14569288), 'max': np.float32(6.8637533)}
2025-06-02 15:27:37,669 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:27:37,669 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:27:37,670 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:27:37,670 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:27:37,670 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(8.809924e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.9807018), 'max': np.float32(8.856608)}
2025-06-02 15:27:37,671 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(2.6429774e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.0817144), 'max': np.float32(4.494266)}
2025-06-02 15:27:37,742 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7f927d3e46e0>
2025-06-02 15:27:38,553 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:27:38,950 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:27:39,136 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:27:44,199 - INFO - Node feature visualization saved to vis/node_features_20250602_152739.png
2025-06-02 15:27:44,200 - INFO - Finished visualization of node features.
2025-06-02 15:27:44,200 - INFO - Performing additional feature analysis:
2025-06-02 15:27:44,200 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:27:44,213 - INFO - Starting visualization of edge features.
2025-06-02 15:27:44,213 - INFO - Graph has 1848 edges and 10 edge features.
2025-06-02 15:27:44,213 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:27:44,214 - INFO - Calculating edge feature statistics:
2025-06-02 15:27:44,215 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:27:44,216 - INFO - - count: {'name': 'count', 'unique': 32, 'mean': np.float32(-2.0642301e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.036982697), 'max': np.float32(35.559486)}
2025-06-02 15:27:44,216 - INFO - - dst_port: {'name': 'dst_port', 'unique': 18, 'mean': np.float32(459.8052), 'std': np.float32(473.8855), 'min': np.float32(0.0), 'max': np.float32(8898.0)}
2025-06-02 15:27:44,216 - INFO - - protocol: {'name': 'protocol', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:27:44,216 - INFO - - service: {'name': 'service', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:27:44,216 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 1235, 'mean': np.float32(-2.0642301e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.05767335), 'max': np.float32(34.11734)}
2025-06-02 15:27:44,217 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 1316, 'mean': np.float32(2.0642301e-09), 'std': np.float32(1.0), 'min': np.float32(-0.05346426), 'max': np.float32(34.90347)}
2025-06-02 15:27:44,217 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 421, 'mean': np.float32(1.0321151e-09), 'std': np.float32(1.0), 'min': np.float32(-0.045245994), 'max': np.float32(35.391674)}
2025-06-02 15:27:44,217 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 1284, 'mean': np.float32(-4.1284602e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.08053714), 'max': np.float32(28.465456)}
2025-06-02 15:27:44,217 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 1305, 'mean': np.float32(3.0963452e-09), 'std': np.float32(1.0), 'min': np.float32(-0.081029944), 'max': np.float32(27.663826)}
2025-06-02 15:27:44,217 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 468, 'mean': np.float32(1.0321151e-09), 'std': np.float32(1.0), 'min': np.float32(-0.05446046), 'max': np.float32(34.686768)}
2025-06-02 15:27:44,289 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7f92901b0860>
2025-06-02 15:27:44,764 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:27:44,839 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7f9291511f40>
2025-06-02 15:27:45,261 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:27:45,854 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:27:46,299 - DEBUG - Plotted boxplots of the first 8 non-constant edge features.
2025-06-02 15:27:46,391 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:27:46,424 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:27:50,245 - INFO - Edge feature visualization saved to vis/edge_features_20250602_152746.png
2025-06-02 15:27:50,245 - INFO - Finished visualization of edge features.
2025-06-02 15:27:50,245 - INFO - Performing additional edge feature analysis:
2025-06-02 15:27:50,246 - INFO - - 2 out of 10 edge features are constant.
2025-06-02 15:27:50,246 - INFO - - Highest correlation (1.00) between features: 'total_resp_bytes' and 'total_resp_ip_bytes'.
2025-06-02 15:27:50,258 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:27:50,258 - INFO - Graph has 1848 edges and 10 edge features.
2025-06-02 15:27:50,258 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:27:51,782 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_152750_summary.png
2025-06-02 15:27:52,759 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_152750_pca_3d.png
2025-06-02 15:27:53,278 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_152750_pca_variance.png
2025-06-02 15:27:53,279 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:27:53,279 - INFO - 
--- Processing file: nw_graph_encoded_1748870205.dot (Timestamp: 2025-06-02 15:16:45) ---
2025-06-02 15:27:53,279 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870205.dot
2025-06-02 15:27:53,279 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870205.dot'.
2025-06-02 15:27:53,280 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870205.dot
2025-06-02 15:27:53,313 - INFO - Parsed 894 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870205.dot'.
2025-06-02 15:27:53,419 - INFO - Parsed 1887 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870205.dot'.
2025-06-02 15:27:53,420 - INFO - Processing node updates/additions.
2025-06-02 15:27:53,457 - INFO - Processing edge updates/additions.
2025-06-02 15:27:53,613 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:27:53,619 - INFO - Finished updating NetworkX graph.
2025-06-02 15:27:53,622 - DEBUG - Updated graph - Nodes: 894, Edges: 1887
2025-06-02 15:27:53,622 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:27:53,629 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:27:53,806 - DEBUG - Initial node features tensor shape: torch.Size([894, 30])
2025-06-02 15:27:53,815 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:27:53,818 - DEBUG - Node features tensor shape after scaling: torch.Size([894, 30])
2025-06-02 15:27:53,825 - DEBUG - Edge index tensor shape: torch.Size([2, 1887])
2025-06-02 15:27:53,844 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:27:53,940 - DEBUG - Initial edge attributes tensor shape: torch.Size([1887, 10])
2025-06-02 15:27:53,943 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:27:53,944 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1887, 10])
2025-06-02 15:27:53,944 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:27:53,945 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:27:53,949 - INFO - Updated main graph to 894 nodes and 1887 edges.
2025-06-02 15:27:53,949 - INFO - Performing online update...
2025-06-02 15:27:53,950 - INFO - Starting online update for 25 steps.
2025-06-02 15:27:53,951 - DEBUG - Updated RunningStats: new_mean=0.9438908178123014, new_var=21000000000162.062, new_n=2130
2025-06-02 15:27:53,951 - DEBUG - Updated RunningStats: new_mean=0.9410268868966298, new_var=21300000000017.93, new_n=2160
2025-06-02 15:27:53,952 - DEBUG - Updated RunningStats: new_mean=44.43380237466284, new_var=7000000189529.252, new_n=710
2025-06-02 15:27:53,952 - DEBUG - Updated RunningStats: new_mean=44.47826031662791, new_var=7100000197702.887, new_n=720
2025-06-02 15:27:53,953 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:27:53,953 - DEBUG - Online update step: 1/25
2025-06-02 15:27:53,961 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:54,061 - DEBUG - Node anomaly scores shape: torch.Size([16147, 1])
2025-06-02 15:27:54,075 - DEBUG - Edge anomaly scores shape: torch.Size([33224, 1])
2025-06-02 15:27:54,080 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:54,308 - DEBUG - Step 1: Loss=0.9748
2025-06-02 15:27:54,309 - DEBUG - Online update step: 2/25
2025-06-02 15:27:54,320 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:54,428 - DEBUG - Node anomaly scores shape: torch.Size([16461, 1])
2025-06-02 15:27:54,434 - DEBUG - Edge anomaly scores shape: torch.Size([34072, 1])
2025-06-02 15:27:54,435 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:54,638 - DEBUG - Step 2: Loss=0.9785
2025-06-02 15:27:54,639 - DEBUG - Online update step: 3/25
2025-06-02 15:27:54,648 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:54,730 - DEBUG - Node anomaly scores shape: torch.Size([15335, 1])
2025-06-02 15:27:54,734 - DEBUG - Edge anomaly scores shape: torch.Size([31442, 1])
2025-06-02 15:27:54,735 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:54,932 - DEBUG - Step 3: Loss=0.9671
2025-06-02 15:27:54,933 - DEBUG - Online update step: 4/25
2025-06-02 15:27:54,941 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:55,029 - DEBUG - Node anomaly scores shape: torch.Size([16042, 1])
2025-06-02 15:27:55,033 - DEBUG - Edge anomaly scores shape: torch.Size([33122, 1])
2025-06-02 15:27:55,035 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:55,228 - DEBUG - Step 4: Loss=0.9754
2025-06-02 15:27:55,229 - DEBUG - Online update step: 5/25
2025-06-02 15:27:55,237 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:55,331 - DEBUG - Node anomaly scores shape: torch.Size([15540, 1])
2025-06-02 15:27:55,336 - DEBUG - Edge anomaly scores shape: torch.Size([32037, 1])
2025-06-02 15:27:55,337 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:55,532 - DEBUG - Step 5: Loss=0.9693
2025-06-02 15:27:55,532 - DEBUG - Online update step: 6/25
2025-06-02 15:27:55,540 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:55,654 - DEBUG - Node anomaly scores shape: torch.Size([15991, 1])
2025-06-02 15:27:55,658 - DEBUG - Edge anomaly scores shape: torch.Size([32870, 1])
2025-06-02 15:27:55,659 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:55,851 - DEBUG - Step 6: Loss=0.9563
2025-06-02 15:27:55,852 - DEBUG - Online update step: 7/25
2025-06-02 15:27:55,860 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:55,948 - DEBUG - Node anomaly scores shape: torch.Size([16476, 1])
2025-06-02 15:27:55,952 - DEBUG - Edge anomaly scores shape: torch.Size([34020, 1])
2025-06-02 15:27:55,953 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:56,241 - DEBUG - Step 7: Loss=0.9523
2025-06-02 15:27:56,241 - DEBUG - Online update step: 8/25
2025-06-02 15:27:56,251 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:56,365 - DEBUG - Node anomaly scores shape: torch.Size([17014, 1])
2025-06-02 15:27:56,369 - DEBUG - Edge anomaly scores shape: torch.Size([35282, 1])
2025-06-02 15:27:56,371 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:56,580 - DEBUG - Step 8: Loss=0.9498
2025-06-02 15:27:56,581 - DEBUG - Online update step: 9/25
2025-06-02 15:27:56,595 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:56,684 - DEBUG - Node anomaly scores shape: torch.Size([14870, 1])
2025-06-02 15:27:56,689 - DEBUG - Edge anomaly scores shape: torch.Size([30421, 1])
2025-06-02 15:27:56,691 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:56,888 - DEBUG - Step 9: Loss=0.9436
2025-06-02 15:27:56,889 - DEBUG - Online update step: 10/25
2025-06-02 15:27:56,902 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:56,999 - DEBUG - Node anomaly scores shape: torch.Size([16309, 1])
2025-06-02 15:27:57,004 - DEBUG - Edge anomaly scores shape: torch.Size([33583, 1])
2025-06-02 15:27:57,005 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:57,203 - DEBUG - Step 10: Loss=0.9469
2025-06-02 15:27:57,204 - DEBUG - Online update step: 11/25
2025-06-02 15:27:57,217 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:57,309 - DEBUG - Node anomaly scores shape: torch.Size([14574, 1])
2025-06-02 15:27:57,314 - DEBUG - Edge anomaly scores shape: torch.Size([29733, 1])
2025-06-02 15:27:57,316 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:57,520 - DEBUG - Step 11: Loss=0.9395
2025-06-02 15:27:57,521 - DEBUG - Online update step: 12/25
2025-06-02 15:27:57,529 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:57,707 - DEBUG - Node anomaly scores shape: torch.Size([15469, 1])
2025-06-02 15:27:57,710 - DEBUG - Edge anomaly scores shape: torch.Size([31748, 1])
2025-06-02 15:27:57,711 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:57,908 - DEBUG - Step 12: Loss=0.9432
2025-06-02 15:27:57,908 - DEBUG - Online update step: 13/25
2025-06-02 15:27:57,916 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:57,997 - DEBUG - Node anomaly scores shape: torch.Size([15449, 1])
2025-06-02 15:27:58,001 - DEBUG - Edge anomaly scores shape: torch.Size([31850, 1])
2025-06-02 15:27:58,002 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:58,159 - DEBUG - Step 13: Loss=0.9367
2025-06-02 15:27:58,159 - DEBUG - Online update step: 14/25
2025-06-02 15:27:58,167 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:58,291 - DEBUG - Node anomaly scores shape: torch.Size([16468, 1])
2025-06-02 15:27:58,295 - DEBUG - Edge anomaly scores shape: torch.Size([33940, 1])
2025-06-02 15:27:58,297 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:58,596 - DEBUG - Step 14: Loss=0.9268
2025-06-02 15:27:58,597 - DEBUG - Online update step: 15/25
2025-06-02 15:27:58,608 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:58,744 - DEBUG - Node anomaly scores shape: torch.Size([15255, 1])
2025-06-02 15:27:58,749 - DEBUG - Edge anomaly scores shape: torch.Size([31386, 1])
2025-06-02 15:27:58,750 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:58,940 - DEBUG - Step 15: Loss=0.9223
2025-06-02 15:27:58,941 - DEBUG - Online update step: 16/25
2025-06-02 15:27:58,954 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:59,043 - DEBUG - Node anomaly scores shape: torch.Size([15799, 1])
2025-06-02 15:27:59,047 - DEBUG - Edge anomaly scores shape: torch.Size([32522, 1])
2025-06-02 15:27:59,049 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:59,298 - DEBUG - Step 16: Loss=0.9251
2025-06-02 15:27:59,299 - DEBUG - Online update step: 17/25
2025-06-02 15:27:59,308 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:59,394 - DEBUG - Node anomaly scores shape: torch.Size([15503, 1])
2025-06-02 15:27:59,398 - DEBUG - Edge anomaly scores shape: torch.Size([32004, 1])
2025-06-02 15:27:59,399 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:59,544 - DEBUG - Step 17: Loss=0.9162
2025-06-02 15:27:59,544 - DEBUG - Online update step: 18/25
2025-06-02 15:27:59,553 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:59,651 - DEBUG - Node anomaly scores shape: torch.Size([15868, 1])
2025-06-02 15:27:59,654 - DEBUG - Edge anomaly scores shape: torch.Size([32666, 1])
2025-06-02 15:27:59,656 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:27:59,842 - DEBUG - Step 18: Loss=0.9205
2025-06-02 15:27:59,842 - DEBUG - Online update step: 19/25
2025-06-02 15:27:59,851 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:27:59,946 - DEBUG - Node anomaly scores shape: torch.Size([16010, 1])
2025-06-02 15:27:59,950 - DEBUG - Edge anomaly scores shape: torch.Size([33032, 1])
2025-06-02 15:27:59,951 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:00,133 - DEBUG - Step 19: Loss=0.9140
2025-06-02 15:28:00,133 - DEBUG - Online update step: 20/25
2025-06-02 15:28:00,142 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:00,231 - DEBUG - Node anomaly scores shape: torch.Size([14694, 1])
2025-06-02 15:28:00,237 - DEBUG - Edge anomaly scores shape: torch.Size([30093, 1])
2025-06-02 15:28:00,239 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:00,390 - DEBUG - Step 20: Loss=0.9097
2025-06-02 15:28:00,390 - DEBUG - Online update step: 21/25
2025-06-02 15:28:00,408 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:00,521 - DEBUG - Node anomaly scores shape: torch.Size([15373, 1])
2025-06-02 15:28:00,525 - DEBUG - Edge anomaly scores shape: torch.Size([31519, 1])
2025-06-02 15:28:00,527 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:00,740 - DEBUG - Step 21: Loss=0.9071
2025-06-02 15:28:00,741 - DEBUG - Online update step: 22/25
2025-06-02 15:28:00,753 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:00,853 - DEBUG - Node anomaly scores shape: torch.Size([16207, 1])
2025-06-02 15:28:00,859 - DEBUG - Edge anomaly scores shape: torch.Size([33409, 1])
2025-06-02 15:28:00,861 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:01,069 - DEBUG - Step 22: Loss=0.8986
2025-06-02 15:28:01,070 - DEBUG - Online update step: 23/25
2025-06-02 15:28:01,079 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:01,166 - DEBUG - Node anomaly scores shape: torch.Size([15964, 1])
2025-06-02 15:28:01,169 - DEBUG - Edge anomaly scores shape: torch.Size([32864, 1])
2025-06-02 15:28:01,170 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:01,360 - DEBUG - Step 23: Loss=0.8942
2025-06-02 15:28:01,362 - DEBUG - Online update step: 24/25
2025-06-02 15:28:01,375 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:01,544 - DEBUG - Node anomaly scores shape: torch.Size([16316, 1])
2025-06-02 15:28:01,549 - DEBUG - Edge anomaly scores shape: torch.Size([33663, 1])
2025-06-02 15:28:01,551 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:01,781 - DEBUG - Step 24: Loss=0.8985
2025-06-02 15:28:01,782 - DEBUG - Online update step: 25/25
2025-06-02 15:28:01,792 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:01,881 - DEBUG - Node anomaly scores shape: torch.Size([16103, 1])
2025-06-02 15:28:01,886 - DEBUG - Edge anomaly scores shape: torch.Size([33113, 1])
2025-06-02 15:28:01,888 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:02,139 - DEBUG - Step 25: Loss=0.8893
2025-06-02 15:28:02,140 - INFO - Online update finished. Average loss: 0.9342, Learning rate: 0.001000
2025-06-02 15:28:02,144 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -4.2669992e-09 -2.7202120e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.6001247e-08
  4.2669992e-09 -6.9338735e-09  1.3867747e-08 -7.4672482e-09
  2.2941835e+00  2.9597316e+00  1.4541388e-01  4.4116330e+00
 -2.1334996e-09  3.3221476e+00  5.8680091e+00  7.6196866e+00
  1.4541388e-01  7.9921699e+00  1.8134747e-08  1.1734247e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -7.4672482e-09  8.1072983e-08], current edge mean: [-2.0215671e-09  4.5887280e+02  0.0000000e+00  0.0000000e+00
  2.0215671e-09  5.0539177e-09  0.0000000e+00 -3.5377425e-09
  3.5377425e-09  3.0323508e-09]
2025-06-02 15:28:02,145 - DEBUG - Node drift difference: 0.0192, Edge drift difference: 0.0020
2025-06-02 15:28:02,149 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -4.2669992e-09 -2.7202120e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.6001247e-08
  4.2669992e-09 -6.9338735e-09  1.3867747e-08 -7.4672482e-09
  2.2941835e+00  2.9597316e+00  1.4541388e-01  4.4116330e+00
 -2.1334996e-09  3.3221476e+00  5.8680091e+00  7.6196866e+00
  1.4541388e-01  7.9921699e+00  1.8134747e-08  1.1734247e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -7.4672482e-09  8.1072983e-08], edge=[-2.0215671e-09  4.5887280e+02  0.0000000e+00  0.0000000e+00
  2.0215671e-09  5.0539177e-09  0.0000000e+00 -3.5377425e-09
  3.5377425e-09  3.0323508e-09]
2025-06-02 15:28:02,152 - DEBUG - Updated reference std: node=[0.         0.         1.0005598  1.0005598  0.         0.
 0.         1.0005598  1.0005598  1.0005598  1.0005598  1.0005598
 0.97541434 0.28107604 0.36824727 0.5703764  1.0005598  2.9711607
 2.8818514  1.4734278  0.36824727 0.23411502 1.0005598  1.0005598
 0.         0.         0.         0.         1.0005598  1.0005597 ], edge=[  1.0002651 469.3459      0.          0.          1.0002651   1.0002651
   1.0002651   1.000265    1.0002651   1.0002651]
2025-06-02 15:28:02,153 - INFO - Online update complete. Loss: 0.9342
2025-06-02 15:28:02,153 - INFO - Running anomaly detection...
2025-06-02 15:28:02,156 - INFO - Starting anomaly detection.
2025-06-02 15:28:02,206 - DEBUG - Node reconstruction errors: [ 0.9345097   3.6016963  10.63498     0.46673977  0.42776144  0.27409002
  9.956238    0.5681375   0.56813747  0.647986    0.5681375   1.1080316
 14.527436    1.9645488   0.3729275   0.5466623   1.1338874   0.5466539
  3.0132437   0.46933708  0.35124886  0.37292746  0.56971973  0.7604489
  0.33538482  0.47839102  0.33538482  0.76790035  0.49725857  0.33538482
  3.1134493   0.54421556  0.68451023  0.38827482  0.48520198  0.36849502
  0.32970056  0.46933672  1.0322874   0.8333085   0.40742323  0.30869925
  0.46933672  0.32791653  2.068145    0.65524197  0.6996516   0.71180165
  0.43441564  1.1245639   3.3779383   0.43502888  0.41738796  2.5523605
  0.31242657  0.43799767  6.966754    0.33834726  2.6907198   2.4095433
  0.86390597  0.32064006  0.25185102  0.6558125   0.26119757  0.31242245
  0.23307492  0.31242278  0.25185096  0.3206403   0.30269077  0.2932301
  0.19846816  0.31861156  0.24791294  0.3181935   0.31389138  0.2581038
  0.12890318  0.18914674  0.2234056   0.21038125  1.7481842   2.1906574
  0.15992954  0.9638313   0.15836501  0.15988144  0.23182675  0.29997668
  0.18061917  0.72382164  0.62207663  0.12951016  0.34634927  3.5309472
  0.18268703  0.18413313  0.13418584  0.231402    0.20003454  0.18268703
  0.22727858  0.3411159   0.6320667   0.22430854  0.62302333  0.47592193
  0.6872803   0.9454008   0.68367803  0.17249759  0.66045964  0.39876997
  0.19447899  0.11148997  0.17038825  0.35694975  0.18572578  0.18923236
  0.11998343  0.57320154  0.36493298  0.5564522   0.24987644  0.18922964
  0.6167352   0.50939614  0.22055957  0.14748082  0.265212    0.17947651
  0.80110836  0.7404056   0.146875    0.21531652  0.20747092  0.15911846
  0.6778627   1.126725    0.2597594   0.1347767   0.10432212  0.2597595
  0.22851929  0.19106153  0.17038828  0.34907955  0.31479332  0.1701944
  0.851164    0.6675232   0.18207099  0.17947651  0.54088116  0.38722122
  0.1614845   0.13443701  0.20003457  0.26775154  0.2597594   0.47502387
  0.1614845   0.265212    0.17114247  0.6464557   0.20124969  0.11111645
  0.48622617  0.23944601  0.17305358  0.19047266  0.16668491  3.140415
  0.18572544  1.7656286   0.10736235  0.11971103  0.15412459  0.15412459
  0.20076694  0.6752819   0.2546235   0.37846375  0.5899458   0.11112528
  0.07728774  0.16313928  0.19211994  0.1404232   0.13468236  0.13351183
  0.24796532  0.19421025  0.6778604   0.21302687  1.6930796   0.2017149
  0.35501233  0.28804472  0.14214605  0.16148452  0.7320232   0.18616527
  0.22320728  0.48141527  0.33480385  0.8496641   0.11467597  0.15397964
  0.12944144  0.15381807  0.25563136  0.10674669  0.13309616  0.09806515
  0.1622731   0.17038839  0.24992557  0.19421025  0.42942983  0.07728763
  0.12847403  0.25563136  0.16148452  0.1605805   0.39665672  0.21781506
  0.13540934  0.5577007   0.52393425  0.1249145   0.18345016  0.17038836
  0.17038824  0.23961715  0.08687301  0.12847403  0.16148452  0.1701939
  0.40520105  0.09993605  0.19307238  0.26110154  0.1877828   0.26110172
  0.12220336  0.12894426  0.19307238  0.20442687  0.16668488  0.16838822
  0.24992546  0.09342783  0.13703507  0.21150589  0.1404232   0.07373095
  0.1051217   0.15412457  0.08902156  0.7715909   0.19968995  0.28805017
  0.19740926  0.3207256   0.18041815  2.8617184   0.1804182   0.10239264
  0.411137    0.3666364   0.10700858  0.4019102   0.1548896   0.15412457
  0.13561645  0.23268077  0.20076685  0.13682991  0.8442441   0.15278031
  0.08607514  0.22961818  0.13969164  0.13970691  1.1583767   0.56063503
  0.6752819   1.7711232   0.354977    0.10766613  0.20009252  0.1877828
  2.0155525   0.06772521  0.08070083  0.15412451  0.21302687  0.59237
  0.07698826  0.09159435  0.11865424  0.12299118  0.09159435  0.09159435
  0.09159443  0.14589185  0.18829651  0.09159443  0.09159435  0.6667847
  0.09159443  0.1267067   0.47865614  0.10704383  0.24739888  0.5575149
  0.23458347  0.20908676  0.1551535   0.21847627  0.18332194  0.11865415
  0.44041148  0.3695957   0.21231331  0.15638599  0.14264546  0.14264533
  0.3018709   0.20187625  0.09159443  0.15488942  0.09159443  0.14589185
  0.3012849   0.13028662  0.10020769  0.10020771  0.09159464  0.1520269
  0.10020765  0.13735598  0.14753273  0.12371059  0.11865436  0.12105168
  0.20894483  0.11349965  0.09159443  0.09647591  0.40689108  0.10760055
  0.1284484   0.1404232   0.05544245  0.09159443  0.12110293  1.9974875
  0.12944135  0.14561503  0.21609282  0.10794137  0.11865424  3.2602403
  0.07995873  0.7531805   0.1164858   0.08107813  0.07708792  0.10462805
  0.12390123  0.44818097  0.14912559  0.10760065  0.09843577  0.1835766
  0.09865195  0.09159435  0.11865412  0.41998294  0.1311786   0.07150165
  0.41192478  0.14736122  0.2561069   0.6103445   0.17873813  0.09159443
  0.34412763  0.19697252  0.08851071  0.55496997  0.14155212  0.14155212
  0.14155214  2.2992973   0.07023279  2.3005865   0.12018249  0.18629812
  0.14155212  0.07023282  0.09098691  0.08851074  0.1417884   0.14376746
  0.08851074  0.40174308  0.14155212  0.08851071  0.07023279  0.14155214
  0.14155212  0.05225734  0.12107717  0.14155212  0.09843495  0.13603787
  0.13915594  0.13952084  0.07157277  0.12486038  0.45075238  0.17825267
  0.17872897  0.13937168  0.56624776  0.47137508  0.15090099  0.17485683
  0.08494802  0.1164731   0.14155212  0.14155212  0.12018246  0.13499454
  0.4285873   0.09052803  0.1257176   0.15641004  0.30916837  0.04677853
  0.05181624  0.6995987   0.78392273  0.13122247  0.21263483  0.12767579
  0.12483485  0.06343956  0.1337554   0.05711388  0.06343956  0.16745545
  0.12486055  0.23842539  0.08818407  0.11355452  0.08798631  0.13939977
  0.12549493  0.6480246   0.12549505  0.13939977  0.07798002  0.09059978
  0.40639487  0.20604418  0.07798002  0.08798635  0.10765631  1.0183825
  0.17133975  0.07157267  0.0905997   0.08798637  0.05263208  0.14515206
  0.09144294  0.5115367   0.10819297  0.13122244  0.5328255   0.06687259
  0.06343956  0.39558524  0.12205771  1.0184394   0.07027803  0.0526321
  0.08100557  0.05278697  0.05545259  0.12949307  0.06782611  2.2223878
  0.05711388  0.14515205  0.21905635  0.05278697  0.21905652  0.10338528
  0.06449722  0.50200003  0.04742661  1.1218832   0.17518122  0.06343956
  0.47230676  0.14582263  0.14582263  0.05181624  0.07864857  0.0992858
  0.04742661  0.07084453  0.18352574  0.08224998  0.07084443  0.15641011
  0.04742661  0.22368166  0.06449728  0.06782615  0.22692081  0.53543186
  0.07084457  0.13581374  0.0992858   0.05711388  0.05711389  0.14515205
  0.06782614  0.06799988  0.08619574  0.11552044  0.05711389  0.11581343
  0.05711388  0.11581343  0.20080765  0.07084416  0.14539582  2.1477613
  0.40444976  0.0521787   1.760832    0.05217867  0.05217867  0.05217867
  0.0521787   0.0521787   0.0521787   0.0521787   0.07393207  0.15898174
  0.11743382  0.0521787   0.0521787   0.0521787   0.05217867  0.05217867
  0.0521787   0.0521787   0.0521787   0.0521787   0.0591979   0.0521787
  0.0521787   0.6183378   0.0521787   0.43444672  0.10433909  0.05711388
  0.14838213  0.10377932  1.4721414   1.4721414   0.13888934  0.14838213
  0.05711388  0.04742661  0.04742661  0.05711388  0.04742661  0.0911814
  0.18552777  0.05217867  0.15641004  0.05711388  0.14582258  0.05711388
  0.05711388  0.16932458  0.05711388  0.04742661  0.05711388  0.05711388
  0.07084446  0.04742661  0.05711388  0.04742661  0.05711388  0.05711384
  0.05711389  0.11768327  0.1838841   0.05545259  0.0521787   0.19417085
  0.11352416  0.05711388  0.04742665  0.10517491  0.0521787   0.14200231
  0.11764529  0.04282083  0.05711388  0.05711389  0.0583458   0.12706111
  0.05183669  0.05711388  0.07393216  0.04933438  0.04742663  0.49261284
  0.05217867  0.23597135  0.17337653  0.0521787   0.0521787   0.07393204
  0.0493344   0.05711388  0.2726382   0.11489708  0.12615982  0.12706111
  0.12638819  0.09163249  0.09163249  0.09955919  0.07637226  0.05217867
  0.14828423  0.06319042  0.12706111  0.04798725  0.09605329  0.15114455
  0.05544906  0.05544906  0.05544906  0.05544906  0.05544906  0.05619438
  0.07221135  0.05544909  0.05544909  0.05217867  0.05951766  0.0521787
  0.09163252  0.11348086  0.09248968  0.0624036   0.09163252  0.10337508
  0.05919787  0.11648498  0.05919797  0.0521787   0.09163252  0.05892316
  0.04621186  0.04621186  0.05544906  0.0589231   0.09922529  0.06322829
  0.12058303  0.0521787   0.05544906  0.08060861  0.0462119   0.04981572
  0.06123201  0.07015811  0.05619428  1.1720054   0.07015812  0.7495831
  0.05175104  0.06123206  0.16341548  0.06145597  0.07233214  0.10725583
  0.07413816  0.06675622  0.07838443  0.06123206  0.06123201  0.06123201
  0.0580766   0.06123206  0.06123206  0.07233213  0.06123206  0.06123206
  0.06123203  0.06022041  0.07199993  0.14800027  0.12729208  0.07388286
  0.182648    0.07917961  0.12736414  2.1748755   0.09166881  0.09081522
  0.14252637  0.24417289  0.24417289  0.07233213  0.6739881   0.2312404
  0.09167381  0.08622754  0.15104952  0.7584842   0.11780249  0.11780251
  0.11780246  0.11389328  0.1276825   0.47157794  0.36179203  0.28984123
  0.14920217  0.12145935  0.20625238  0.08622753  0.21871789  0.08951847
  0.09636529  0.28557304  0.09167375  0.2312404   0.08622753  0.08951843
  0.12145935  0.5152797   0.11780246  0.11389326  0.0963653   0.20157166
  0.27496493  0.11389328  0.11389336  0.11389336  0.24389601  0.09907664
  2.9248774   0.11780246  0.1800779   0.11389328  0.09360375  0.27675915
  2.2114832   0.27675912  0.11389328  0.14961386  0.3322036   0.11923686
  0.4539364   0.27675912  3.9330552   0.2064851   0.24166746  0.27675915
  0.11343896  0.3155494   0.20054045  0.20390414  0.13026835  0.15491518
  0.15491518  0.20390414  0.45393685  0.14961395  0.27675912  0.2005404
  0.27675912  0.1999628   0.1999628   0.19996281  0.1680153   0.273718
  0.1999628   0.1999628   0.23984654  0.36409765  0.1999629   0.1999629
  0.19467887  0.4190688   0.2679376   0.28208315  0.19996281  0.1719964
  0.36409765  0.1999628   0.25347653  0.3145046   0.23984654  0.21718346
  0.47681534  0.3145046   0.1999629   0.3145046   0.33136082  0.30290785
  0.4755977   0.1999628   0.5431378   0.33136094  0.33136082  0.41906893
  0.24823405  0.33136094  0.25347653  0.3202303   0.27519882  0.42372996
  0.37342957  0.42372978  0.6187221   0.25347653  0.37342945  0.31117943
  0.3111795   2.3105567   0.31117952  0.30661553  0.24823405  0.44450074
  0.40797046  0.27519876  0.40797046  0.49028015  0.25347653  0.5791148
  0.31117943  0.38732803  0.3202303   0.31117943  0.36125743  0.27519882
  0.38732803  0.27519876  0.31117952  0.31117943  0.31117943  0.31117952
  0.31117952  0.31669     0.45459396  0.31668985  0.45459396  0.31669
  0.24122801  0.2412282   0.2412282   0.31117943  0.31117943  0.31117943
  0.31117952  4.9296417   0.45459396  0.31669     0.3111795   0.31117943
  0.31117952  0.3055834   0.31117943  0.31117943  0.31117943  0.45459396]
2025-06-02 15:28:02,207 - DEBUG - Edge reconstruction errors: [  5.2637067   5.2629204  44.25883   ... 535.2592     13.358812
   2.1598384]
2025-06-02 15:28:02,235 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152802_update_37.json
2025-06-02 15:28:02,237 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:28:02,287 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152802_update_37.pth
2025-06-02 15:28:02,287 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870205.dot): 0.9031
2025-06-02 15:28:02,288 - WARNING - Detected 17 anomalous nodes (reconstruction-based):
2025-06-02 15:28:02,288 - WARNING -   Node ID: 192.168.239.101, Recon Error: 3.6017, MLP Score: 0.3540
2025-06-02 15:28:02,288 - WARNING -   Node ID: 192.168.27.13, Recon Error: 10.6350, MLP Score: 0.5203
2025-06-02 15:28:02,288 - WARNING -   Node ID: 192.168.27.12, Recon Error: 9.9562, MLP Score: 0.5730
2025-06-02 15:28:02,288 - WARNING -   Node ID: 192.168.27.10, Recon Error: 14.5274, MLP Score: 0.5984
2025-06-02 15:28:02,289 - WARNING -   Node ID: 43.132.85.151, Recon Error: 3.0132, MLP Score: 0.5582
2025-06-02 15:28:02,289 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:28:02,289 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2588, MLP Score: 0.0000
2025-06-02 15:28:02,289 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9605, MLP Score: 0.0000
2025-06-02 15:28:02,290 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0612, MLP Score: 0.0000
2025-06-02 15:28:02,290 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7599, MLP Score: 0.0000
2025-06-02 15:28:02,290 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7591, MLP Score: 0.0000
2025-06-02 15:28:02,290 - INFO - 
--- Processing file: nw_graph_encoded_1748870235.dot (Timestamp: 2025-06-02 15:17:15) ---
2025-06-02 15:28:02,291 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870235.dot
2025-06-02 15:28:02,291 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870235.dot'.
2025-06-02 15:28:02,291 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870235.dot
2025-06-02 15:28:02,325 - INFO - Parsed 901 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870235.dot'.
2025-06-02 15:28:02,432 - INFO - Parsed 1907 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870235.dot'.
2025-06-02 15:28:02,433 - INFO - Processing node updates/additions.
2025-06-02 15:28:02,474 - INFO - Processing edge updates/additions.
2025-06-02 15:28:02,632 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:28:02,638 - INFO - Finished updating NetworkX graph.
2025-06-02 15:28:02,642 - DEBUG - Updated graph - Nodes: 901, Edges: 1907
2025-06-02 15:28:02,642 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:28:02,648 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:28:02,830 - DEBUG - Initial node features tensor shape: torch.Size([901, 30])
2025-06-02 15:28:02,844 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:28:02,848 - DEBUG - Node features tensor shape after scaling: torch.Size([901, 30])
2025-06-02 15:28:02,861 - DEBUG - Edge index tensor shape: torch.Size([2, 1907])
2025-06-02 15:28:02,887 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:28:02,998 - DEBUG - Initial edge attributes tensor shape: torch.Size([1907, 10])
2025-06-02 15:28:03,001 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:28:03,002 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1907, 10])
2025-06-02 15:28:03,002 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:28:03,003 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:28:03,007 - INFO - Updated main graph to 901 nodes and 1907 edges.
2025-06-02 15:28:03,007 - INFO - Performing online update...
2025-06-02 15:28:03,007 - INFO - Starting online update for 25 steps.
2025-06-02 15:28:03,009 - DEBUG - Updated RunningStats: new_mean=0.944007361581552, new_var=21600000000162.066, new_n=2190
2025-06-02 15:28:03,009 - DEBUG - Updated RunningStats: new_mean=0.9412247215304804, new_var=21900000000017.934, new_n=2220
2025-06-02 15:28:03,010 - DEBUG - Updated RunningStats: new_mean=44.49685123472331, new_var=7200000189097.694, new_n=730
2025-06-02 15:28:03,010 - DEBUG - Updated RunningStats: new_mean=44.53611131325915, new_var=7300000195727.552, new_n=740
2025-06-02 15:28:03,010 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:28:03,011 - DEBUG - Online update step: 1/25
2025-06-02 15:28:03,019 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:03,149 - DEBUG - Node anomaly scores shape: torch.Size([15447, 1])
2025-06-02 15:28:03,159 - DEBUG - Edge anomaly scores shape: torch.Size([31804, 1])
2025-06-02 15:28:03,167 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:03,449 - DEBUG - Step 1: Loss=0.8945
2025-06-02 15:28:03,451 - DEBUG - Online update step: 2/25
2025-06-02 15:28:03,465 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:03,648 - DEBUG - Node anomaly scores shape: torch.Size([17058, 1])
2025-06-02 15:28:03,659 - DEBUG - Edge anomaly scores shape: torch.Size([35387, 1])
2025-06-02 15:28:03,661 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:04,050 - DEBUG - Step 2: Loss=0.8861
2025-06-02 15:28:04,051 - DEBUG - Online update step: 3/25
2025-06-02 15:28:04,062 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:04,199 - DEBUG - Node anomaly scores shape: torch.Size([17230, 1])
2025-06-02 15:28:04,206 - DEBUG - Edge anomaly scores shape: torch.Size([35692, 1])
2025-06-02 15:28:04,208 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:04,548 - DEBUG - Step 3: Loss=0.8840
2025-06-02 15:28:04,549 - DEBUG - Online update step: 4/25
2025-06-02 15:28:04,561 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:04,651 - DEBUG - Node anomaly scores shape: torch.Size([16055, 1])
2025-06-02 15:28:04,657 - DEBUG - Edge anomaly scores shape: torch.Size([33108, 1])
2025-06-02 15:28:04,660 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:04,947 - DEBUG - Step 4: Loss=0.8804
2025-06-02 15:28:04,947 - DEBUG - Online update step: 5/25
2025-06-02 15:28:04,959 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:05,102 - DEBUG - Node anomaly scores shape: torch.Size([16324, 1])
2025-06-02 15:28:05,107 - DEBUG - Edge anomaly scores shape: torch.Size([33552, 1])
2025-06-02 15:28:05,109 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:05,344 - DEBUG - Step 5: Loss=0.8786
2025-06-02 15:28:05,344 - DEBUG - Online update step: 6/25
2025-06-02 15:28:05,353 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:05,805 - DEBUG - Node anomaly scores shape: torch.Size([17034, 1])
2025-06-02 15:28:05,810 - DEBUG - Edge anomaly scores shape: torch.Size([35188, 1])
2025-06-02 15:28:05,812 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:05,994 - DEBUG - Step 6: Loss=0.8699
2025-06-02 15:28:05,995 - DEBUG - Online update step: 7/25
2025-06-02 15:28:06,002 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:06,172 - DEBUG - Node anomaly scores shape: torch.Size([15564, 1])
2025-06-02 15:28:06,178 - DEBUG - Edge anomaly scores shape: torch.Size([31984, 1])
2025-06-02 15:28:06,180 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:06,333 - DEBUG - Step 7: Loss=0.8755
2025-06-02 15:28:06,334 - DEBUG - Online update step: 8/25
2025-06-02 15:28:06,343 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:06,476 - DEBUG - Node anomaly scores shape: torch.Size([16133, 1])
2025-06-02 15:28:06,483 - DEBUG - Edge anomaly scores shape: torch.Size([33199, 1])
2025-06-02 15:28:06,485 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:06,655 - DEBUG - Step 8: Loss=0.8664
2025-06-02 15:28:06,656 - DEBUG - Online update step: 9/25
2025-06-02 15:28:06,666 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:06,778 - DEBUG - Node anomaly scores shape: torch.Size([14894, 1])
2025-06-02 15:28:06,782 - DEBUG - Edge anomaly scores shape: torch.Size([30498, 1])
2025-06-02 15:28:06,784 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:06,938 - DEBUG - Step 9: Loss=0.8654
2025-06-02 15:28:06,939 - DEBUG - Online update step: 10/25
2025-06-02 15:28:06,948 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:07,086 - DEBUG - Node anomaly scores shape: torch.Size([16341, 1])
2025-06-02 15:28:07,091 - DEBUG - Edge anomaly scores shape: torch.Size([33735, 1])
2025-06-02 15:28:07,092 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:07,246 - DEBUG - Step 10: Loss=0.8576
2025-06-02 15:28:07,247 - DEBUG - Online update step: 11/25
2025-06-02 15:28:07,255 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:07,364 - DEBUG - Node anomaly scores shape: torch.Size([16169, 1])
2025-06-02 15:28:07,377 - DEBUG - Edge anomaly scores shape: torch.Size([33259, 1])
2025-06-02 15:28:07,379 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:07,542 - DEBUG - Step 11: Loss=0.8550
2025-06-02 15:28:07,543 - DEBUG - Online update step: 12/25
2025-06-02 15:28:07,551 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:07,687 - DEBUG - Node anomaly scores shape: torch.Size([16086, 1])
2025-06-02 15:28:07,692 - DEBUG - Edge anomaly scores shape: torch.Size([33065, 1])
2025-06-02 15:28:07,693 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:07,843 - DEBUG - Step 12: Loss=0.8775
2025-06-02 15:28:07,844 - DEBUG - Online update step: 13/25
2025-06-02 15:28:07,851 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:07,984 - DEBUG - Node anomaly scores shape: torch.Size([15770, 1])
2025-06-02 15:28:07,989 - DEBUG - Edge anomaly scores shape: torch.Size([32478, 1])
2025-06-02 15:28:07,991 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:08,152 - DEBUG - Step 13: Loss=0.8674
2025-06-02 15:28:08,153 - DEBUG - Online update step: 14/25
2025-06-02 15:28:08,162 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:08,313 - DEBUG - Node anomaly scores shape: torch.Size([15642, 1])
2025-06-02 15:28:08,319 - DEBUG - Edge anomaly scores shape: torch.Size([32072, 1])
2025-06-02 15:28:08,321 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:08,486 - DEBUG - Step 14: Loss=0.8581
2025-06-02 15:28:08,487 - DEBUG - Online update step: 15/25
2025-06-02 15:28:08,497 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:08,620 - DEBUG - Node anomaly scores shape: torch.Size([16295, 1])
2025-06-02 15:28:08,624 - DEBUG - Edge anomaly scores shape: torch.Size([33479, 1])
2025-06-02 15:28:08,626 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:08,804 - DEBUG - Step 15: Loss=0.8530
2025-06-02 15:28:08,804 - DEBUG - Online update step: 16/25
2025-06-02 15:28:08,816 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:08,952 - DEBUG - Node anomaly scores shape: torch.Size([15711, 1])
2025-06-02 15:28:08,956 - DEBUG - Edge anomaly scores shape: torch.Size([32340, 1])
2025-06-02 15:28:08,957 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:09,112 - DEBUG - Step 16: Loss=0.8482
2025-06-02 15:28:09,113 - DEBUG - Online update step: 17/25
2025-06-02 15:28:09,124 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:09,255 - DEBUG - Node anomaly scores shape: torch.Size([15048, 1])
2025-06-02 15:28:09,259 - DEBUG - Edge anomaly scores shape: torch.Size([30853, 1])
2025-06-02 15:28:09,261 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:09,415 - DEBUG - Step 17: Loss=0.8444
2025-06-02 15:28:09,415 - DEBUG - Online update step: 18/25
2025-06-02 15:28:09,426 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:09,552 - DEBUG - Node anomaly scores shape: torch.Size([16344, 1])
2025-06-02 15:28:09,559 - DEBUG - Edge anomaly scores shape: torch.Size([33711, 1])
2025-06-02 15:28:09,560 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:09,726 - DEBUG - Step 18: Loss=0.8491
2025-06-02 15:28:09,727 - DEBUG - Online update step: 19/25
2025-06-02 15:28:09,737 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:09,868 - DEBUG - Node anomaly scores shape: torch.Size([15721, 1])
2025-06-02 15:28:09,874 - DEBUG - Edge anomaly scores shape: torch.Size([32256, 1])
2025-06-02 15:28:09,876 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:10,110 - DEBUG - Step 19: Loss=0.8405
2025-06-02 15:28:10,118 - DEBUG - Online update step: 20/25
2025-06-02 15:28:10,135 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:10,314 - DEBUG - Node anomaly scores shape: torch.Size([15938, 1])
2025-06-02 15:28:10,335 - DEBUG - Edge anomaly scores shape: torch.Size([32785, 1])
2025-06-02 15:28:10,336 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:10,892 - DEBUG - Step 20: Loss=0.8319
2025-06-02 15:28:10,897 - DEBUG - Online update step: 21/25
2025-06-02 15:28:10,912 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:11,155 - DEBUG - Node anomaly scores shape: torch.Size([15631, 1])
2025-06-02 15:28:11,170 - DEBUG - Edge anomaly scores shape: torch.Size([32076, 1])
2025-06-02 15:28:11,174 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:11,446 - DEBUG - Step 21: Loss=0.8309
2025-06-02 15:28:11,447 - DEBUG - Online update step: 22/25
2025-06-02 15:28:11,461 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:11,599 - DEBUG - Node anomaly scores shape: torch.Size([16872, 1])
2025-06-02 15:28:11,606 - DEBUG - Edge anomaly scores shape: torch.Size([34811, 1])
2025-06-02 15:28:11,609 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:11,839 - DEBUG - Step 22: Loss=0.8317
2025-06-02 15:28:11,839 - DEBUG - Online update step: 23/25
2025-06-02 15:28:11,852 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:11,949 - DEBUG - Node anomaly scores shape: torch.Size([16453, 1])
2025-06-02 15:28:11,956 - DEBUG - Edge anomaly scores shape: torch.Size([33959, 1])
2025-06-02 15:28:11,958 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:12,180 - DEBUG - Step 23: Loss=0.8238
2025-06-02 15:28:12,181 - DEBUG - Online update step: 24/25
2025-06-02 15:28:12,193 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:12,280 - DEBUG - Node anomaly scores shape: torch.Size([15845, 1])
2025-06-02 15:28:12,284 - DEBUG - Edge anomaly scores shape: torch.Size([32630, 1])
2025-06-02 15:28:12,286 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:12,697 - DEBUG - Step 24: Loss=0.8214
2025-06-02 15:28:12,698 - DEBUG - Online update step: 25/25
2025-06-02 15:28:12,711 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:12,811 - DEBUG - Node anomaly scores shape: torch.Size([16385, 1])
2025-06-02 15:28:12,816 - DEBUG - Edge anomaly scores shape: torch.Size([33839, 1])
2025-06-02 15:28:12,818 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:12,996 - DEBUG - Step 25: Loss=0.8220
2025-06-02 15:28:12,997 - INFO - Online update finished. Average loss: 0.8565, Learning rate: 0.001000
2025-06-02 15:28:13,000 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  2.2756934e-08  4.4984638e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.2227704e-08
  2.1169242e-09 -1.0452313e-08 -8.9969276e-09 -4.2338481e-08
  2.2941177e+00  2.9600444e+00  1.4428413e-01  4.4139843e+00
  1.0452313e-08  3.3218646e+00  5.8712540e+00  7.6159821e+00
  1.4428413e-01  7.9922309e+00 -1.0055389e-08  1.1643083e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.9747715e-08  9.5261585e-09], current edge mean: [-1.0001828e-09  4.5835397e+02  0.0000000e+00  0.0000000e+00
 -1.0001828e-09  1.0001828e-09 -9.0016457e-09 -2.2504114e-09
 -1.5002742e-09  1.0001828e-09]
2025-06-02 15:28:13,000 - DEBUG - Node drift difference: 0.0041, Edge drift difference: 0.0011
2025-06-02 15:28:13,003 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  2.2756934e-08  4.4984638e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.2227704e-08
  2.1169242e-09 -1.0452313e-08 -8.9969276e-09 -4.2338481e-08
  2.2941177e+00  2.9600444e+00  1.4428413e-01  4.4139843e+00
  1.0452313e-08  3.3218646e+00  5.8712540e+00  7.6159821e+00
  1.4428413e-01  7.9922309e+00 -1.0055389e-08  1.1643083e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.9747715e-08  9.5261585e-09], edge=[-1.0001828e-09  4.5835397e+02  0.0000000e+00  0.0000000e+00
 -1.0001828e-09  1.0001828e-09 -9.0016457e-09 -2.2504114e-09
 -1.5002742e-09  1.0001828e-09]
2025-06-02 15:28:13,005 - DEBUG - Updated reference std: node=[0.         0.         1.0005554  1.0005554  0.         0.
 0.         1.0005554  1.0005554  1.0005554  1.0005554  1.0005554
 0.9781268  0.28000316 0.37004966 0.57211477 1.0005554  2.9718418
 2.880792   1.4799136  0.37004966 0.23320381 1.0005554  1.0005554
 0.         0.         0.         0.         1.0005554  1.0005554 ], edge=[  1.0002623 467.01913     0.          0.          1.0002623   1.0002624
   1.0002623   1.0002623   1.0002623   1.0002623]
2025-06-02 15:28:13,023 - INFO - Online update complete. Loss: 0.8565
2025-06-02 15:28:13,023 - INFO - Running anomaly detection...
2025-06-02 15:28:13,024 - INFO - Starting anomaly detection.
2025-06-02 15:28:13,041 - DEBUG - Node reconstruction errors: [ 0.95932317  2.7374415   9.384898    0.27428234  0.2792777   0.22828108
  8.555503    0.43376815  0.43376815  0.5048805   0.43376806  0.911828
 13.056189    1.5533117   0.22718562  0.41309246  0.9245935   0.4153191
  2.821729    0.36585218  0.29627845  0.2271854   0.5442354   0.6784699
  0.20345023  0.36124802  0.20345034  0.488993    0.38586807  0.20345025
  2.8015616   0.5436743   0.4281969   0.23793015  0.5611161   0.352827
  0.31438982  0.36585224  0.45548657  0.7821577   0.26275727  0.18727067
  0.36585224  0.25396678  1.5117415   0.5875298   0.58318716  0.7414363
  0.3453171   1.3331645   1.76092     0.3348414   0.31901944  2.439414
  0.3006194   0.3336991   5.227901    0.28062615  2.5646548   2.3084538
  0.89917207  0.32285532  0.15449038  0.5778206   0.3695637   0.30061924
  0.2283086   0.30061787  0.15449032  0.32285517  0.29259786  0.21963911
  0.17333688  0.2909659   0.23856698  0.24063149  0.28628534  0.2109037
  0.09417884  0.13628528  0.13984184  0.16140105  1.6321342   1.8579327
  0.13833135  0.8150453   0.14267501  0.14146264  0.19124381  0.3151112
  0.12421687  0.4573407   0.5273084   0.09885337  0.3181244   2.212773
  0.11243964  0.16601983  0.0898051   0.20779969  0.14837179  0.1124396
  0.17574492  0.34424913  0.5445259   0.19676568  0.53701645  0.44041502
  0.5803993   1.2949393   0.6716844   0.11541919  0.38817114  0.32434866
  0.14709823  0.09454861  0.12998223  0.22644545  0.16287087  0.19290705
  0.09226017  0.51180667  0.27146512  0.51534265  0.23105335  0.19290899
  0.53616065  0.4855652   0.20536207  0.14422964  0.2338874   0.16678101
  0.5134576   0.52678245  0.11397806  0.19559854  0.17473586  0.10274836
  0.56951696  0.5198335   0.25322133  0.11499939  0.08613025  0.25322133
  0.22739376  0.23997183  0.12998213  0.3002449   0.29641864  0.15292637
  0.8755455   0.5837185   0.12619366  0.16678101  0.3020474   0.23941821
  0.14435336  0.12408941  0.14837196  0.19429804  0.25322133  0.42468366
  0.14435337  0.2338874   0.12792231  0.3864854   0.1504906   0.07901161
  0.45821717  0.25850576  0.12338439  0.19352727  0.11719684  1.6828277
  0.2327782   2.00254     0.07927915  0.10575614  0.11632513  0.11632511
  0.17933388  0.5774939   0.23367229  0.30707213  0.3717149   0.09714518
  0.07305261  0.12682809  0.1788341   0.12946443  0.12871495  0.11785345
  0.22754349  0.16584346  0.569517    0.19514751  1.4986441   0.20524491
  0.23357885  0.31029886  0.13300963  0.14435336  0.46596757  0.21155411
  0.19594075  0.4237426   0.29958194  0.5303816   0.08127502  0.10589824
  0.09878004  0.11817067  0.22289887  0.1007279   0.13407013  0.0770217
  0.21165131  0.12998213  0.2230156   0.1658435   0.3729466   0.07305258
  0.09814074  0.22289874  0.14435336  0.15163346  0.24702649  0.18307215
  0.09604745  0.46890986  0.44798085  0.11476294  0.23467956  0.12998211
  0.12998214  0.2165852   0.06713999  0.09814071  0.14435337  0.14752916
  0.23756212  0.07776599  0.17671636  0.24963133  0.16273409  0.28598708
  0.09876156  0.1296819   0.17671637  0.20268883  0.11719684  0.10899643
  0.22301553  0.06891537  0.12435056  0.1719646   0.1294644   0.0649659
  0.10176149  0.11632519  0.06226788  0.6597475   0.17329977  0.27952665
  0.17889711  0.28807715  0.14871113  2.5485182   0.14871113  0.08454303
  0.32036152  0.27973372  0.08125041  0.37396652  0.11676478  0.11632511
  0.12081037  0.21152902  0.17933388  0.11849754  0.6224379   0.13138762
  0.06660962  0.17734693  0.14570536  0.09953023  0.698333    0.50993234
  0.5774942   1.1892678   0.3313832   0.08031094  0.18122193  0.16273414
  1.6620173   0.07027881  0.06078211  0.11632502  0.19514751  0.5238577
  0.05639856  0.0702716   0.08990725  0.12529713  0.0702716   0.0702716
  0.0702716   0.11012238  0.21603186  0.0702716   0.0702716   0.4189975
  0.0702716   0.11845598  0.4060116   0.07851156  0.37781715  0.46969807
  0.21098937  0.19382757  0.1298587   0.2305101   0.15392743  0.08990724
  0.3988794   0.2910252   0.2095681   0.15116528  0.0985327   0.09853261
  0.3088722   0.18826284  0.0702716   0.11676475  0.0702716   0.11012246
  0.2634038   0.08924825  0.07347514  0.0734751   0.0702716   0.11685297
  0.0734751   0.13881053  0.1318117   0.21165271  0.0899072   0.09109249
  0.17970084  0.07985094  0.0702716   0.08138043  0.316672    0.10414052
  0.10150341  0.1294644   0.05355224  0.0702716   0.08423445  1.65589
  0.20878701  0.13492003  0.1890246   0.10632396  0.08990718  2.0549624
  0.07294159  0.47660396  0.09286545  0.06848424  0.06546079  0.10162382
  0.12208532  0.31811416  0.1366269   0.1041391   0.08352927  0.16053405
  0.09572312  0.0702716   0.0899072   0.39322406  0.13208963  0.05910753
  0.4085599   0.14391679  0.2311695   0.52853477  0.15482733  0.0702716
  0.3391699   0.1833525   0.07107677  0.3604828   0.12831143  0.12831143
  0.12831147  2.177278    0.05877719  2.1812673   0.11170603  0.19004127
  0.12831144  0.05877715  0.07402851  0.07107677  0.22788525  0.14752378
  0.07107676  0.356873    0.12831143  0.07107672  0.0587772   0.12831143
  0.12831144  0.05099445  0.09807105  0.12831144  0.08354501  0.13134822
  0.25571996  0.12508273  0.06223337  0.12538613  0.29911387  0.16167974
  0.15430078  0.13052127  0.52406865  0.3821956   0.14026819  0.15685076
  0.08275758  0.10690551  0.12831143  0.12831137  0.11170604  0.12637036
  0.29037476  0.08409632  0.11687069  0.14098135  0.24025778  0.05227019
  0.17269592  0.4010325   0.5650953   0.12442475  0.2039471   0.12495091
  0.12617294  0.06363621  0.13116594  0.04866612  0.06363614  0.15308814
  0.12538613  0.21244287  0.08110026  0.11234147  0.07385036  0.13697217
  0.12542109  0.5413562   0.12542109  0.13697217  0.06212163  0.09086292
  0.35016644  0.20179237  0.06212163  0.07385041  0.11416396  0.6602346
  0.16223341  0.0622326   0.09086297  0.07385033  0.05540673  0.1412623
  0.0823172   0.323397    0.10816602  0.12442476  0.35257623  0.05751175
  0.06363622  0.3528238   0.12308717  0.61623377  0.05806381  0.05540673
  0.07816264  0.05738755  0.05242591  0.12917346  0.06107908  2.016363
  0.04866615  0.14126234  0.18175207  0.05738756  0.29269648  0.09535801
  0.05265569  0.41594127  0.0425244   0.60552603  0.15429404  0.06363622
  0.387026    0.13165066  0.13165063  0.05708054  0.07876241  0.09551398
  0.0425244   0.05698421  0.15904091  0.07404259  0.05698421  0.14098136
  0.04252435  0.3075349   0.05265577  0.0610791   0.21173213  0.4593829
  0.05698429  0.12435081  0.09551402  0.04866622  0.04866613  0.14126228
  0.06107911  0.05785271  0.06921808  0.11830386  0.04866615  0.10018509
  0.04866621  0.10018513  0.20718886  0.05698429  0.12815008  1.8253071
  0.36094978  0.04413078  1.3252131   0.04413078  0.04413078  0.04413078
  0.04413078  0.04413078  0.04413078  0.04413078  0.06140608  0.13186567
  0.11859766  0.04413078  0.04413076  0.04413078  0.04413078  0.04413078
  0.04413078  0.04413078  0.04413076  0.04413076  0.05024154  0.04413078
  0.04413078  0.3909753   0.04413078  0.36274317  0.15052475  0.04866622
  0.19934873  0.1076917   1.367772    1.367772    0.1329434   0.19934873
  0.04866615  0.04252435  0.04252436  0.04866615  0.0425244   0.08233295
  0.16312367  0.04413076  0.1409813   0.04866613  0.13165073  0.04866613
  0.04866615  0.14762738  0.04866612  0.04252436  0.04866615  0.04866621
  0.0569843   0.0425244   0.04866621  0.04252442  0.04866615  0.04866615
  0.04866622  0.11909812  0.18028961  0.05242583  0.04413078  0.1745118
  0.13727044  0.04866621  0.0425244   0.11033428  0.04413078  0.12530337
  0.11184625  0.04072595  0.04866621  0.04866615  0.0555485   0.1304223
  0.05252849  0.04866615  0.06140609  0.04943034  0.0425244   0.42880136
  0.04413076  0.1978681   0.17275834  0.04413078  0.04413076  0.06140616
  0.04943044  0.04866615  0.23417935  0.10396354  0.12996574  0.1304223
  0.10091008  0.09378144  0.09378144  0.14469188  0.07212618  0.04413078
  0.12951536  0.07609823  0.13042225  0.04549949  0.08746977  0.12433656
  0.04518209  0.04518205  0.04518205  0.04518209  0.04518205  0.05001466
  0.0777706   0.04518205  0.04518205  0.04413078  0.05398265  0.04413076
  0.09378144  0.12025954  0.09350745  0.05573789  0.09378144  0.10718506
  0.05024149  0.09910638  0.05024154  0.04413078  0.09378145  0.04763665
  0.04043487  0.04043487  0.04518205  0.04763662  0.10015213  0.05347337
  0.10362749  0.04413076  0.04518205  0.07044547  0.04043492  0.04560601
  0.0580491   0.05293802  0.05001468  0.70836616  0.05293801  0.48432645
  0.04994389  0.05804916  0.1257404   0.0480098   0.06336236  0.08546391
  0.08113316  0.05164556  0.08457678  0.05804907  0.05804916  0.05804907
  0.05485146  0.15111735  0.05804916  0.06336237  0.0580491   0.05804916
  0.05804907  0.05674643  0.05400585  0.12764756  0.12535156  0.0736694
  0.14492676  0.06622276  0.12412866  2.00217     0.07411086  0.06536588
  0.10624855  0.19253609  0.1925358   0.06336236  0.50342613  0.21631081
  0.07412711  0.06349764  0.34487507  0.46496943  0.08201448  0.08201448
  0.08201448  0.08055472  0.09464208  0.3640685   0.3423363   0.22854242
  0.11882437  0.09175486  0.15420085  0.06349758  0.16551107  0.08245276
  0.07584532  0.24892016  0.07412707  0.21631177  0.06349758  0.08245274
  0.09175487  0.35191125  0.08201448  0.08055479  0.07584539  0.15470426
  0.20914218  0.08055479  0.08055476  0.08055479  0.17364319  0.08757894
  2.7866082   0.08201448  0.18300673  0.08055476  0.09474848  0.1943905
  1.9542615   0.1943905   0.08055472  0.10305525  0.22284308  0.09037457
  0.3262623   0.19439048  2.2845929   0.16296588  0.2275581   0.1943905
  0.10919169  0.23136106  0.16092952  0.20165625  0.11331012  0.11218337
  0.11218335  0.20165603  0.30651686  0.10305525  0.1943905   0.16092958
  0.19439043  0.16284968  0.13938372  0.13938372  0.11878523  0.23372081
  0.13938372  0.13938372  0.16284972  0.30041122  0.13938372  0.13938372
  0.13098839  0.32940456  0.24331827  0.24189     0.13938372  0.1442336
  0.30041134  0.13938372  0.17221697  0.22364649  0.16284968  0.14860366
  0.3329492   0.22364648  0.13938372  0.22364648  0.24549934  0.27327216
  0.37609583  0.13938372  0.48649985  0.23211288  0.23211288  0.32940474
  0.16467342  0.23211288  0.1722169   0.23519053  0.18483397  0.2955822
  0.2591099   0.2955822   0.48381862  0.1722169   0.2591099   0.2041993
  0.2041993   2.0495074   0.20419937  0.22935781  0.16467337  0.3062546
  0.26873404  0.18483396  0.26873404  0.31164655  0.19898872  0.4249765
  0.2041993   0.28049865  0.23519035  0.20419937  0.3270346   0.22951587
  0.2804988   0.18483396  0.20419937  0.44470972  0.2041993   0.20419937
  0.2041993   0.21174213  0.2989106   0.21174213  0.29891062  0.21174213
  0.20632306  0.20632286  0.20632306  0.20419937  0.20419937  0.20419937
  0.20419928  3.1982949   0.29891062  0.21174213  0.20419931  0.20419928
  0.20419928  0.2001004   0.20419937  0.20419934  0.2041993   0.29891062
  0.25839096  2.4745264   0.22041906  0.20419937  0.20419937  0.19278927
  0.20419931]
2025-06-02 15:28:13,042 - DEBUG - Edge reconstruction errors: [ 5.2638965  5.262715  44.258614  ... 13.358597   2.159627  13.358597 ]
2025-06-02 15:28:13,045 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152813_update_38.json
2025-06-02 15:28:13,046 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:28:13,090 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152813_update_38.pth
2025-06-02 15:28:13,091 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870235.dot): 0.9156
2025-06-02 15:28:13,091 - WARNING - Detected 18 anomalous nodes (reconstruction-based):
2025-06-02 15:28:13,091 - WARNING -   Node ID: 192.168.239.101, Recon Error: 2.7374, MLP Score: 0.3218
2025-06-02 15:28:13,091 - WARNING -   Node ID: 192.168.27.13, Recon Error: 9.3849, MLP Score: 0.5121
2025-06-02 15:28:13,092 - WARNING -   Node ID: 192.168.27.12, Recon Error: 8.5555, MLP Score: 0.5589
2025-06-02 15:28:13,092 - WARNING -   Node ID: 192.168.27.10, Recon Error: 13.0562, MLP Score: 0.5759
2025-06-02 15:28:13,092 - WARNING -   Node ID: 43.132.85.151, Recon Error: 2.8217, MLP Score: 0.5406
2025-06-02 15:28:13,092 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:28:13,093 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2585, MLP Score: 0.3378
2025-06-02 15:28:13,093 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9603, MLP Score: 0.2818
2025-06-02 15:28:13,093 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0610, MLP Score: 0.2818
2025-06-02 15:28:13,094 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7596, MLP Score: 0.3128
2025-06-02 15:28:13,094 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7589, MLP Score: 0.2834
2025-06-02 15:28:13,094 - INFO - 
--- Processing file: nw_graph_encoded_1748870265.dot (Timestamp: 2025-06-02 15:17:45) ---
2025-06-02 15:28:13,094 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870265.dot
2025-06-02 15:28:13,094 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870265.dot'.
2025-06-02 15:28:13,095 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870265.dot
2025-06-02 15:28:13,130 - INFO - Parsed 914 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870265.dot'.
2025-06-02 15:28:13,234 - INFO - Parsed 1945 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870265.dot'.
2025-06-02 15:28:13,235 - INFO - Processing node updates/additions.
2025-06-02 15:28:13,275 - INFO - Processing edge updates/additions.
2025-06-02 15:28:13,437 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:28:13,444 - INFO - Finished updating NetworkX graph.
2025-06-02 15:28:13,447 - DEBUG - Updated graph - Nodes: 914, Edges: 1945
2025-06-02 15:28:13,448 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:28:13,454 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:28:13,635 - DEBUG - Initial node features tensor shape: torch.Size([914, 30])
2025-06-02 15:28:13,642 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:28:13,645 - DEBUG - Node features tensor shape after scaling: torch.Size([914, 30])
2025-06-02 15:28:13,655 - DEBUG - Edge index tensor shape: torch.Size([2, 1945])
2025-06-02 15:28:13,667 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:28:13,755 - DEBUG - Initial edge attributes tensor shape: torch.Size([1945, 10])
2025-06-02 15:28:13,759 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:28:13,759 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1945, 10])
2025-06-02 15:28:13,760 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:28:13,760 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:28:13,764 - INFO - Updated main graph to 914 nodes and 1945 edges.
2025-06-02 15:28:13,764 - INFO - Performing online update...
2025-06-02 15:28:13,765 - INFO - Starting online update for 25 steps.
2025-06-02 15:28:13,766 - DEBUG - Updated RunningStats: new_mean=0.9441289852880805, new_var=22200000000161.926, new_n=2250
2025-06-02 15:28:13,766 - DEBUG - Updated RunningStats: new_mean=0.9414485711235131, new_var=22500000000018.0, new_n=2280
2025-06-02 15:28:13,767 - DEBUG - Updated RunningStats: new_mean=44.553035143202116, new_var=7400000188848.005, new_n=750
2025-06-02 15:28:13,767 - DEBUG - Updated RunningStats: new_mean=44.58449360350399, new_var=7500000191874.098, new_n=760
2025-06-02 15:28:13,768 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:28:13,768 - DEBUG - Online update step: 1/25
2025-06-02 15:28:13,776 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:13,983 - DEBUG - Node anomaly scores shape: torch.Size([17022, 1])
2025-06-02 15:28:13,998 - DEBUG - Edge anomaly scores shape: torch.Size([35349, 1])
2025-06-02 15:28:14,000 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:14,234 - DEBUG - Step 1: Loss=0.8151
2025-06-02 15:28:14,235 - DEBUG - Online update step: 2/25
2025-06-02 15:28:14,247 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:14,342 - DEBUG - Node anomaly scores shape: torch.Size([16335, 1])
2025-06-02 15:28:14,347 - DEBUG - Edge anomaly scores shape: torch.Size([33713, 1])
2025-06-02 15:28:14,349 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:14,542 - DEBUG - Step 2: Loss=0.8097
2025-06-02 15:28:14,543 - DEBUG - Online update step: 3/25
2025-06-02 15:28:14,555 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:14,642 - DEBUG - Node anomaly scores shape: torch.Size([15837, 1])
2025-06-02 15:28:14,646 - DEBUG - Edge anomaly scores shape: torch.Size([32599, 1])
2025-06-02 15:28:14,648 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:14,859 - DEBUG - Step 3: Loss=0.8109
2025-06-02 15:28:14,860 - DEBUG - Online update step: 4/25
2025-06-02 15:28:14,872 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:14,960 - DEBUG - Node anomaly scores shape: torch.Size([16504, 1])
2025-06-02 15:28:14,967 - DEBUG - Edge anomaly scores shape: torch.Size([33936, 1])
2025-06-02 15:28:14,970 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:15,484 - DEBUG - Step 4: Loss=0.8070
2025-06-02 15:28:15,488 - DEBUG - Online update step: 5/25
2025-06-02 15:28:15,515 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:15,853 - DEBUG - Node anomaly scores shape: torch.Size([16621, 1])
2025-06-02 15:28:15,863 - DEBUG - Edge anomaly scores shape: torch.Size([34418, 1])
2025-06-02 15:28:15,865 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:16,389 - DEBUG - Step 5: Loss=0.8024
2025-06-02 15:28:16,390 - DEBUG - Online update step: 6/25
2025-06-02 15:28:16,403 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:16,521 - DEBUG - Node anomaly scores shape: torch.Size([17009, 1])
2025-06-02 15:28:16,525 - DEBUG - Edge anomaly scores shape: torch.Size([35115, 1])
2025-06-02 15:28:16,528 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:16,733 - DEBUG - Step 6: Loss=0.7989
2025-06-02 15:28:16,733 - DEBUG - Online update step: 7/25
2025-06-02 15:28:16,745 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:16,842 - DEBUG - Node anomaly scores shape: torch.Size([16230, 1])
2025-06-02 15:28:16,846 - DEBUG - Edge anomaly scores shape: torch.Size([33506, 1])
2025-06-02 15:28:16,849 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:17,056 - DEBUG - Step 7: Loss=0.7990
2025-06-02 15:28:17,057 - DEBUG - Online update step: 8/25
2025-06-02 15:28:17,069 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:17,167 - DEBUG - Node anomaly scores shape: torch.Size([16903, 1])
2025-06-02 15:28:17,171 - DEBUG - Edge anomaly scores shape: torch.Size([35001, 1])
2025-06-02 15:28:17,173 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:17,408 - DEBUG - Step 8: Loss=0.7980
2025-06-02 15:28:17,409 - DEBUG - Online update step: 9/25
2025-06-02 15:28:17,422 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:17,521 - DEBUG - Node anomaly scores shape: torch.Size([16862, 1])
2025-06-02 15:28:17,527 - DEBUG - Edge anomaly scores shape: torch.Size([34917, 1])
2025-06-02 15:28:17,529 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:17,732 - DEBUG - Step 9: Loss=0.7985
2025-06-02 15:28:17,732 - DEBUG - Online update step: 10/25
2025-06-02 15:28:17,744 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:17,831 - DEBUG - Node anomaly scores shape: torch.Size([15192, 1])
2025-06-02 15:28:17,835 - DEBUG - Edge anomaly scores shape: torch.Size([31135, 1])
2025-06-02 15:28:17,837 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:18,049 - DEBUG - Step 10: Loss=0.7983
2025-06-02 15:28:18,050 - DEBUG - Online update step: 11/25
2025-06-02 15:28:18,063 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:18,181 - DEBUG - Node anomaly scores shape: torch.Size([17731, 1])
2025-06-02 15:28:18,187 - DEBUG - Edge anomaly scores shape: torch.Size([36801, 1])
2025-06-02 15:28:18,189 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:18,457 - DEBUG - Step 11: Loss=0.7898
2025-06-02 15:28:18,457 - DEBUG - Online update step: 12/25
2025-06-02 15:28:18,471 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:18,569 - DEBUG - Node anomaly scores shape: torch.Size([16618, 1])
2025-06-02 15:28:18,573 - DEBUG - Edge anomaly scores shape: torch.Size([34263, 1])
2025-06-02 15:28:18,575 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:18,808 - DEBUG - Step 12: Loss=0.7893
2025-06-02 15:28:18,808 - DEBUG - Online update step: 13/25
2025-06-02 15:28:18,818 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:18,952 - DEBUG - Node anomaly scores shape: torch.Size([16067, 1])
2025-06-02 15:28:18,961 - DEBUG - Edge anomaly scores shape: torch.Size([33074, 1])
2025-06-02 15:28:18,963 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:19,199 - DEBUG - Step 13: Loss=0.7876
2025-06-02 15:28:19,200 - DEBUG - Online update step: 14/25
2025-06-02 15:28:19,213 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:19,328 - DEBUG - Node anomaly scores shape: torch.Size([14671, 1])
2025-06-02 15:28:19,332 - DEBUG - Edge anomaly scores shape: torch.Size([29943, 1])
2025-06-02 15:28:19,334 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:19,528 - DEBUG - Step 14: Loss=0.7882
2025-06-02 15:28:19,528 - DEBUG - Online update step: 15/25
2025-06-02 15:28:19,537 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:19,627 - DEBUG - Node anomaly scores shape: torch.Size([15606, 1])
2025-06-02 15:28:19,632 - DEBUG - Edge anomaly scores shape: torch.Size([32028, 1])
2025-06-02 15:28:19,633 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:19,802 - DEBUG - Step 15: Loss=0.7852
2025-06-02 15:28:19,803 - DEBUG - Online update step: 16/25
2025-06-02 15:28:19,812 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:19,902 - DEBUG - Node anomaly scores shape: torch.Size([16040, 1])
2025-06-02 15:28:19,907 - DEBUG - Edge anomaly scores shape: torch.Size([32970, 1])
2025-06-02 15:28:19,909 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:20,077 - DEBUG - Step 16: Loss=0.7817
2025-06-02 15:28:20,078 - DEBUG - Online update step: 17/25
2025-06-02 15:28:20,087 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:20,187 - DEBUG - Node anomaly scores shape: torch.Size([16334, 1])
2025-06-02 15:28:20,191 - DEBUG - Edge anomaly scores shape: torch.Size([33674, 1])
2025-06-02 15:28:20,193 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:20,391 - DEBUG - Step 17: Loss=0.7792
2025-06-02 15:28:20,391 - DEBUG - Online update step: 18/25
2025-06-02 15:28:20,400 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:20,511 - DEBUG - Node anomaly scores shape: torch.Size([16423, 1])
2025-06-02 15:28:20,517 - DEBUG - Edge anomaly scores shape: torch.Size([33977, 1])
2025-06-02 15:28:20,519 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:20,699 - DEBUG - Step 18: Loss=0.7815
2025-06-02 15:28:20,700 - DEBUG - Online update step: 19/25
2025-06-02 15:28:20,708 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:20,841 - DEBUG - Node anomaly scores shape: torch.Size([18127, 1])
2025-06-02 15:28:20,846 - DEBUG - Edge anomaly scores shape: torch.Size([37769, 1])
2025-06-02 15:28:20,847 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:21,046 - DEBUG - Step 19: Loss=0.7738
2025-06-02 15:28:21,046 - DEBUG - Online update step: 20/25
2025-06-02 15:28:21,054 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:21,135 - DEBUG - Node anomaly scores shape: torch.Size([16264, 1])
2025-06-02 15:28:21,141 - DEBUG - Edge anomaly scores shape: torch.Size([33611, 1])
2025-06-02 15:28:21,142 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:21,325 - DEBUG - Step 20: Loss=0.7754
2025-06-02 15:28:21,325 - DEBUG - Online update step: 21/25
2025-06-02 15:28:21,333 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:21,433 - DEBUG - Node anomaly scores shape: torch.Size([15556, 1])
2025-06-02 15:28:21,436 - DEBUG - Edge anomaly scores shape: torch.Size([31981, 1])
2025-06-02 15:28:21,439 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:21,665 - DEBUG - Step 21: Loss=0.7752
2025-06-02 15:28:21,665 - DEBUG - Online update step: 22/25
2025-06-02 15:28:21,673 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:21,800 - DEBUG - Node anomaly scores shape: torch.Size([16418, 1])
2025-06-02 15:28:21,803 - DEBUG - Edge anomaly scores shape: torch.Size([33867, 1])
2025-06-02 15:28:21,805 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:21,965 - DEBUG - Step 22: Loss=0.7721
2025-06-02 15:28:21,966 - DEBUG - Online update step: 23/25
2025-06-02 15:28:21,973 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:22,058 - DEBUG - Node anomaly scores shape: torch.Size([16795, 1])
2025-06-02 15:28:22,062 - DEBUG - Edge anomaly scores shape: torch.Size([34700, 1])
2025-06-02 15:28:22,063 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:22,240 - DEBUG - Step 23: Loss=0.7663
2025-06-02 15:28:22,241 - DEBUG - Online update step: 24/25
2025-06-02 15:28:22,249 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:22,342 - DEBUG - Node anomaly scores shape: torch.Size([17733, 1])
2025-06-02 15:28:22,346 - DEBUG - Edge anomaly scores shape: torch.Size([36878, 1])
2025-06-02 15:28:22,348 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:22,523 - DEBUG - Step 24: Loss=0.7665
2025-06-02 15:28:22,523 - DEBUG - Online update step: 25/25
2025-06-02 15:28:22,531 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:22,612 - DEBUG - Node anomaly scores shape: torch.Size([16394, 1])
2025-06-02 15:28:22,616 - DEBUG - Edge anomaly scores shape: torch.Size([33936, 1])
2025-06-02 15:28:22,617 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:22,780 - DEBUG - Step 25: Loss=0.7673
2025-06-02 15:28:22,781 - INFO - Online update finished. Average loss: 0.7887, Learning rate: 0.001000
2025-06-02 15:28:22,782 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  3.6519257e-09  3.4954144e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.7128591e-08
 -3.9649478e-08 -2.2694110e-08 -2.6085183e-09 -6.7821477e-09
  2.3085339e+00  2.9606128e+00  1.4770241e-01  4.4059081e+00
  2.2694110e-08  3.3380744e+00  5.8621445e+00  7.6083150e+00
  1.4770241e-01  7.9923415e+00  3.1302221e-09  3.7301813e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  3.0780516e-08 -2.2954962e-08], current edge mean: [-3.9225680e-09  4.5805399e+02  0.0000000e+00  0.0000000e+00
 -5.8838516e-09 -3.9225680e-09 -9.8064201e-10  9.8064201e-10
  2.9419258e-09  4.9032098e-09]
2025-06-02 15:28:22,783 - DEBUG - Node drift difference: 0.0147, Edge drift difference: 0.0006
2025-06-02 15:28:22,784 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  3.6519257e-09  3.4954144e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.7128591e-08
 -3.9649478e-08 -2.2694110e-08 -2.6085183e-09 -6.7821477e-09
  2.3085339e+00  2.9606128e+00  1.4770241e-01  4.4059081e+00
  2.2694110e-08  3.3380744e+00  5.8621445e+00  7.6083150e+00
  1.4770241e-01  7.9923415e+00  3.1302221e-09  3.7301813e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  3.0780516e-08 -2.2954962e-08], edge=[-3.9225680e-09  4.5805399e+02  0.0000000e+00  0.0000000e+00
 -5.8838516e-09 -3.9225680e-09 -9.8064201e-10  9.8064201e-10
  2.9419258e-09  4.9032098e-09]
2025-06-02 15:28:22,785 - DEBUG - Updated reference std: node=[0.         0.         1.0005475  1.0005475  0.         0.
 0.         1.0005475  1.0005475  1.0005475  1.0005475  1.0005475
 1.0195211  0.27804288 0.37305197 0.5736149  1.0005475  2.9805017
 2.883391   1.4932402  0.37305197 0.23153941 1.0005475  1.0005474
 0.         0.         0.         0.         1.0005475  1.0005475 ], edge=[  1.0002571 462.43698     0.          0.          1.0002571   1.0002571
   1.0002571   1.0002571   1.0002571   1.0002573]
2025-06-02 15:28:22,786 - INFO - Online update complete. Loss: 0.7887
2025-06-02 15:28:22,786 - INFO - Running anomaly detection...
2025-06-02 15:28:22,786 - INFO - Starting anomaly detection.
2025-06-02 15:28:22,815 - DEBUG - Node reconstruction errors: [0.9334136  1.9715283  6.603795   0.14591548 0.19054392 0.17103615
 5.8246293  0.3092307  0.3092307  0.38190854 0.30923054 0.66683304
 9.707648   1.5636724  0.10816986 0.23618487 0.70455176 0.23618387
 2.3159256  0.21363252 0.22793515 0.10816996 0.46457133 0.4922439
 0.09753104 0.2741721  0.09753104 0.40450314 0.27924252 0.09753101
 2.261604   0.4422448  0.38637078 0.13647005 0.46548727 0.29869968
 0.25740898 0.21363252 0.40428722 0.6343478  0.18776155 0.08992289
 0.21363252 0.22475867 1.6525971  0.47186238 0.49317953 0.52215815
 0.25566787 1.3978629  1.0977519  0.26544753 0.2501749  2.1269183
 0.2505284  0.21615988 3.6827576  0.17412983 2.2196567  2.0513108
 0.71775556 0.29051694 0.07567648 0.4707761  0.26667675 0.25052682
 0.18063821 0.2505271  0.07567649 0.29051694 0.24910767 0.15599571
 0.13763347 0.2931473  0.29604414 0.16659805 0.27624705 0.15281759
 0.07479727 0.09997728 0.09760519 0.11406129 1.5050677  1.5131583
 0.12191102 0.6462773  0.11670278 0.12124752 0.1415871  0.2729072
 0.06589687 0.33643192 0.38120207 0.07505921 0.25798315 1.6282636
 0.079483   0.14671892 0.0458771  0.3125206  0.11029426 0.07948325
 0.15895107 0.3046838  0.45417354 0.16435263 0.4372755  0.34608757
 0.4188496  1.0125419  0.5683065  0.08601916 0.24745338 0.22655627
 0.10221291 0.07080908 0.09175899 0.17816249 0.20728804 0.16558181
 0.05183714 0.3588576  0.19436583 0.3701202  0.21092845 0.1655847
 0.38940728 0.38094196 0.20762426 0.09615342 0.20349173 0.1304303
 0.47233477 0.35271353 0.0808615  0.16395083 0.16600184 0.05196466
 0.47130135 0.39342895 0.205133   0.08539432 0.05094616 0.205133
 0.1856108  0.20403722 0.091759   0.32907972 0.26981986 0.22331922
 0.8038595  0.4415903  0.1041591  0.1304303  0.26285362 0.16242154
 0.11660635 0.07999713 0.11029437 0.16825278 0.2051331  0.3251465
 0.11660638 0.20349176 0.09577847 0.26872888 0.11392988 0.06820979
 0.35527962 0.22331923 0.09691593 0.16683064 0.0631917  1.0937514
 0.20728861 3.3834388  0.06637453 0.08478267 0.08928885 0.08928881
 0.15281172 0.42531216 0.20009682 0.23946336 0.24977562 0.08926798
 0.04535416 0.09285472 0.1525665  0.1066856  0.11119878 0.10725927
 0.291774   0.13148244 0.47129896 0.1708951  1.5373608  0.2441961
 0.18716235 0.25625253 0.07842018 0.11660638 0.30609927 0.17709456
 0.208217   0.32555348 0.26099613 0.36640298 0.04310995 0.08859181
 0.07662327 0.08579675 0.19357215 0.07159724 0.11793163 0.04678384
 0.18636449 0.09175902 0.18611054 0.13148244 0.25526002 0.0453542
 0.05468393 0.19357215 0.11660638 0.21397823 0.19741073 0.14363822
 0.08447253 0.33023664 0.3969997  0.10670529 0.2065662  0.091759
 0.091759   0.17381173 0.05960639 0.05468393 0.11660638 0.26998803
 0.16702883 0.06434365 0.13883005 0.21912558 0.13153766 0.25074023
 0.07105802 0.09963938 0.13883005 0.16944982 0.0631917  0.05677282
 0.18611068 0.06102553 0.1009555  0.11971477 0.10668563 0.03848518
 0.20799825 0.0892888  0.05866629 0.49774647 0.1277577  0.23445076
 0.15750459 0.23022239 0.13463642 2.1009648  0.1346364  0.06106048
 0.25196424 0.20793231 0.06849015 0.31920874 0.0906306  0.2814149
 0.06725467 0.18217872 0.15281172 0.1070554  0.39589027 0.0715722
 0.05986759 0.16273718 0.12773417 0.07927988 0.50810486 0.39657503
 0.42531216 1.2096189  0.26946595 0.067636   0.14845806 0.13153766
 1.6284145  0.05104797 0.0569871  0.08928829 0.1708951  0.38046798
 0.05900638 0.03831159 0.07258878 0.11054759 0.03831159 0.03831159
 0.03831159 0.0886234  0.18370953 0.03831159 0.03831159 0.2580194
 0.03831158 0.09886266 0.3089404  0.07625306 0.3206007  0.3373693
 0.18662812 0.1693062  0.1192209  0.2046096  0.21299511 0.07258867
 0.30928755 0.22167332 0.18271565 0.12459861 0.08782146 0.08782162
 0.25736636 0.16503216 0.03831158 0.09063069 0.03831159 0.0886234
 0.20712921 0.04777794 0.03889338 0.03889338 0.03831159 0.07101489
 0.03889338 0.21346188 0.11918232 0.18636537 0.07258876 0.0753573
 0.14370185 0.07237027 0.03831159 0.05933749 0.2114888  0.08671219
 0.06250391 0.1066856  0.03556705 0.03831159 0.0440327  1.3462257
 0.17756629 0.11046483 0.18248005 0.10173202 0.07258878 1.545118
 0.04310501 0.31757584 0.06987141 0.05175779 0.05988927 0.09813003
 0.11669083 0.20243736 0.1703996  0.08671092 0.04854686 0.13024707
 0.32807252 0.03831159 0.07258873 0.29801187 0.10631523 0.0574549
 0.30201226 0.12826481 0.18518604 0.38036102 0.11409365 0.03831159
 0.26115933 0.1693649  0.06021991 0.22594005 0.09661321 0.09661314
 0.0966131  1.9554809  0.03479827 1.9617429  0.09323976 0.14258745
 0.0966131  0.03479826 0.05995971 0.06021994 0.19531709 0.12660569
 0.06021989 0.27674276 0.09661321 0.06021988 0.03479827 0.09661314
 0.0966131  0.03937049 0.06286749 0.0966131  0.04854421 0.11108891
 0.19147085 0.10025772 0.04880323 0.10024898 0.19714819 0.19147347
 0.12112501 0.10713603 0.421117   0.26550293 0.12261917 0.1362895
 0.06712206 0.07855161 0.09661314 0.09661322 0.09323976 0.11295421
 0.1973898  0.05462724 0.09535299 0.11798724 0.23947169 0.04085635
 0.14093661 0.26801243 0.39746428 0.09736557 0.17466286 0.09972142
 0.12390552 0.04261756 0.10575283 0.03343649 0.04261758 0.13147476
 0.10024904 0.1591534  0.08574544 0.0927057  0.05793809 0.11077495
 0.09991691 0.39970464 0.09991693 0.11077499 0.03735313 0.07474103
 0.26142567 0.17580566 0.03735315 0.05793806 0.10150685 0.4744794
 0.15050782 0.04880064 0.07474098 0.05793808 0.03916289 0.11502232
 0.07703282 0.24765632 0.09164116 0.09736548 0.22679509 0.04588913
 0.04261758 0.2672871  0.10625633 0.4745033  0.0468008  0.03916289
 0.07190754 0.0388554  0.12462695 0.10390034 0.05007701 1.7613075
 0.03343649 0.11502235 0.17480119 0.0388554  0.24951795 0.05670941
 0.0352986  0.28949454 0.03101942 0.49843878 0.113504   0.04261756
 0.2865526  0.10968814 0.10968814 0.04513947 0.06647629 0.07776394
 0.03101942 0.05074318 0.1635321  0.07532083 0.05074322 0.11798724
 0.03101942 0.23948605 0.03529861 0.05007698 0.18706699 0.32854426
 0.0507432  0.11651622 0.07776471 0.03343649 0.03343649 0.11502235
 0.05007697 0.05172772 0.07371929 0.10941528 0.03343649 0.07949373
 0.03343649 0.07949365 0.158256   0.05074322 0.10347598 1.4642414
 0.25852022 0.03328861 1.1704339  0.03328858 0.03328861 0.03328861
 0.03328858 0.03328864 0.03328864 0.03328864 0.05749245 0.10438388
 0.10766505 0.03328864 0.03328864 0.03328864 0.03328858 0.03328858
 0.03328864 0.03328858 0.03328864 0.03328864 0.04714996 0.03328858
 0.03328858 0.22888024 0.03328864 0.2669023  0.07822253 0.03343649
 0.142811   0.08228341 1.2430865  1.2430865  0.12082073 0.142811
 0.03343649 0.0310194  0.03101941 0.03343649 0.03101942 0.08609141
 0.13192719 0.03328858 0.11798724 0.03343649 0.10968819 0.03343649
 0.03343649 0.15491842 0.03343649 0.03101942 0.03343649 0.03343649
 0.05074317 0.03101941 0.03343649 0.03101941 0.03343649 0.03343649
 0.03343649 0.10658399 0.17970304 0.04279656 0.03328858 0.15301879
 0.09742814 0.03343649 0.03101941 0.10273903 0.03328858 0.09246282
 0.14682747 0.03116032 0.03343649 0.03343649 0.04496195 0.11940919
 0.04450755 0.03343649 0.05749238 0.03894956 0.03101945 0.30091673
 0.03328864 0.15212277 0.1479008  0.03328864 0.03328864 0.05749234
 0.03894957 0.03343649 0.23802885 0.07970949 0.11514711 0.11940915
 0.07911251 0.07117316 0.07117315 0.07873297 0.05583296 0.03328858
 0.10763793 0.05057852 0.11940919 0.04198124 0.06801569 0.09355522
 0.03310672 0.03310672 0.03310677 0.03310672 0.03310672 0.04766408
 0.05865897 0.03310672 0.03310677 0.03328864 0.04099351 0.03328864
 0.0711732  0.10906169 0.10972814 0.04518001 0.07117312 0.11259542
 0.0471499  0.06982207 0.0471499  0.03328864 0.07117312 0.03536483
 0.0300508  0.0300508  0.03310672 0.03536485 0.09609392 0.0442518
 0.08044371 0.03328858 0.03310672 0.05158693 0.0300508  0.0339958
 0.04246761 0.11022607 0.0476641  0.5308882  0.03820553 0.33490807
 0.04369903 0.04246761 0.09260908 0.03576551 0.04488055 0.05986531
 0.06057055 0.10271034 0.0637871  0.04246761 0.04246761 0.04246761
 0.03957776 0.11430336 0.04246754 0.04488047 0.04246761 0.04246754
 0.04246754 0.0487351  0.03914344 0.1129503  0.12774883 0.05807824
 0.0978118  0.10658797 0.11268087 1.7954457  0.0508553  0.04628452
 0.07161874 0.15905024 0.15905024 0.04488055 0.34224847 0.18126336
 0.05086267 0.04430807 0.23089266 0.3104124  0.05691611 0.05691607
 0.05691611 0.05538333 0.06163539 0.2521145  0.25643846 0.21047227
 0.10337979 0.06126831 0.11840626 0.04430807 0.10445238 0.06260286
 0.05077413 0.20467444 0.05086267 0.18126313 0.04430807 0.06260284
 0.0612682  0.23196654 0.05691612 0.05538333 0.05077413 0.12280115
 0.16564852 0.05538333 0.05538336 0.05538333 0.12762597 2.3285391
 2.7515295  0.05691607 0.15609385 0.05538333 0.06682139 0.14249445
 1.7121042  0.14249445 0.05538333 0.06988185 0.1436363  0.06018401
 0.2547527  0.14249445 1.5974051  0.13462277 0.179759   0.14249437
 0.07671285 0.17632988 0.13164127 0.16984752 0.08999615 0.07314627
 0.07314627 0.16984756 0.24685344 0.06988185 0.14249445 0.13164118
 0.14249445 0.09540073 0.08692882 0.08692881 0.07594435 0.2196277
 0.08692891 0.08692891 0.09540073 0.25309217 0.08692889 0.08692899
 0.08712395 0.23596856 0.22093652 0.20029186 0.08692891 0.10791408
 0.25309217 0.08692878 0.10118663 0.13835125 0.09540073 0.08896931
 0.22904183 0.14887196 0.08692876 0.14887196 0.14127891 0.22581391
 0.2829141  0.08692889 0.42943972 0.1378513  0.14887196 0.23596856
 0.10255916 0.1378513  0.10118666 0.16695099 0.1056343  0.20802607
 0.15494646 0.20802607 0.3891879  0.11441699 0.15494642 0.12081061
 0.12081067 1.8377451  0.12081067 0.18385077 0.10255916 0.20814368
 0.1715423  0.11441695 0.1715423  0.19446632 0.14348182 0.280446
 0.12081067 0.19000335 0.25835353 0.12081067 0.2570317  0.16990909
 0.19000332 0.11441691 0.12081067 0.34082273 0.12081067 0.12081067
 0.12081067 0.11959391 0.17255755 0.11959391 0.19143686 0.11959391
 0.13381936 0.13381936 0.13381936 0.12081067 0.12081067 0.12081067
 0.12081067 2.3069093  0.19143686 0.11959391 0.12081067 0.12081067
 0.12081067 0.1399117  0.12081067 0.12081061 0.12702456 0.19143686
 0.14247282 1.7585518  0.12702449 0.12081067 0.12081067 0.12702444
 0.17255773 0.16513275 0.16513275 0.14327332 0.24023099 0.30107465
 0.3010747  0.240231   0.16513279 0.14247285 0.16513275 0.21569675
 0.20052747 0.16513297]
2025-06-02 15:28:22,816 - DEBUG - Edge reconstruction errors: [ 5.2639666  5.2628474 44.2589    ... 13.358881   2.1598752 13.358881 ]
2025-06-02 15:28:22,819 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152822_update_39.json
2025-06-02 15:28:22,819 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:28:22,860 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152822_update_39.pth
2025-06-02 15:28:22,860 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870265.dot): 0.9225
2025-06-02 15:28:22,860 - WARNING - Detected 23 anomalous nodes (reconstruction-based):
2025-06-02 15:28:22,860 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.9715, MLP Score: 0.3256
2025-06-02 15:28:22,861 - WARNING -   Node ID: 192.168.27.13, Recon Error: 6.6038, MLP Score: 0.5084
2025-06-02 15:28:22,861 - WARNING -   Node ID: 192.168.27.12, Recon Error: 5.8246, MLP Score: 0.5346
2025-06-02 15:28:22,861 - WARNING -   Node ID: 192.168.27.10, Recon Error: 9.7076, MLP Score: 0.5353
2025-06-02 15:28:22,861 - WARNING -   Node ID: 43.132.85.151, Recon Error: 2.3159, MLP Score: 0.6027
2025-06-02 15:28:22,862 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:28:22,862 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2589, MLP Score: 0.6294
2025-06-02 15:28:22,863 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9606, MLP Score: 0.6253
2025-06-02 15:28:22,863 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0613, MLP Score: 0.6254
2025-06-02 15:28:22,863 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7599, MLP Score: 0.7181
2025-06-02 15:28:22,863 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7592, MLP Score: 0.7198
2025-06-02 15:28:22,864 - INFO - 
--- Processing file: nw_graph_encoded_1748870295.dot (Timestamp: 2025-06-02 15:18:15) ---
2025-06-02 15:28:22,864 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870295.dot
2025-06-02 15:28:22,864 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870295.dot'.
2025-06-02 15:28:22,864 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870295.dot
2025-06-02 15:28:22,900 - INFO - Parsed 918 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870295.dot'.
2025-06-02 15:28:23,007 - INFO - Parsed 1958 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870295.dot'.
2025-06-02 15:28:23,007 - INFO - Processing node updates/additions.
2025-06-02 15:28:23,050 - INFO - Processing edge updates/additions.
2025-06-02 15:28:23,213 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:28:23,220 - INFO - Finished updating NetworkX graph.
2025-06-02 15:28:23,224 - DEBUG - Updated graph - Nodes: 918, Edges: 1958
2025-06-02 15:28:23,224 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:28:23,231 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:28:23,416 - DEBUG - Initial node features tensor shape: torch.Size([918, 30])
2025-06-02 15:28:23,422 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:28:23,435 - DEBUG - Node features tensor shape after scaling: torch.Size([918, 30])
2025-06-02 15:28:23,445 - DEBUG - Edge index tensor shape: torch.Size([2, 1958])
2025-06-02 15:28:23,469 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:28:23,558 - DEBUG - Initial edge attributes tensor shape: torch.Size([1958, 10])
2025-06-02 15:28:23,566 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:28:23,571 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1958, 10])
2025-06-02 15:28:23,572 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:28:23,573 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:28:23,577 - INFO - Updated main graph to 918 nodes and 1958 edges.
2025-06-02 15:28:23,577 - INFO - Performing online update...
2025-06-02 15:28:23,578 - INFO - Starting online update for 25 steps.
2025-06-02 15:28:23,580 - DEBUG - Updated RunningStats: new_mean=0.9442654921479535, new_var=22800000000161.9, new_n=2310
2025-06-02 15:28:23,580 - DEBUG - Updated RunningStats: new_mean=0.9416475316370125, new_var=23100000000017.992, new_n=2340
2025-06-02 15:28:23,581 - DEBUG - Updated RunningStats: new_mean=44.60021971324374, new_var=7600000188764.186, new_n=770
2025-06-02 15:28:23,581 - DEBUG - Updated RunningStats: new_mean=44.628296260798756, new_var=7700000190590.046, new_n=780
2025-06-02 15:28:23,582 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:28:23,582 - DEBUG - Online update step: 1/25
2025-06-02 15:28:23,590 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:24,500 - DEBUG - Node anomaly scores shape: torch.Size([16164, 1])
2025-06-02 15:28:24,578 - DEBUG - Edge anomaly scores shape: torch.Size([33239, 1])
2025-06-02 15:28:24,631 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:27,181 - DEBUG - Step 1: Loss=0.7631
2025-06-02 15:28:27,181 - DEBUG - Online update step: 2/25
2025-06-02 15:28:27,242 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:29,417 - DEBUG - Node anomaly scores shape: torch.Size([17063, 1])
2025-06-02 15:28:29,516 - DEBUG - Edge anomaly scores shape: torch.Size([35207, 1])
2025-06-02 15:28:29,585 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:32,304 - DEBUG - Step 2: Loss=0.7591
2025-06-02 15:28:32,304 - DEBUG - Online update step: 3/25
2025-06-02 15:28:32,314 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:33,209 - DEBUG - Node anomaly scores shape: torch.Size([17360, 1])
2025-06-02 15:28:33,301 - DEBUG - Edge anomaly scores shape: torch.Size([35939, 1])
2025-06-02 15:28:33,354 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:34,737 - DEBUG - Step 3: Loss=0.7592
2025-06-02 15:28:34,738 - DEBUG - Online update step: 4/25
2025-06-02 15:28:34,749 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:36,083 - DEBUG - Node anomaly scores shape: torch.Size([17550, 1])
2025-06-02 15:28:36,174 - DEBUG - Edge anomaly scores shape: torch.Size([36318, 1])
2025-06-02 15:28:36,240 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:37,999 - DEBUG - Step 4: Loss=0.7578
2025-06-02 15:28:38,000 - DEBUG - Online update step: 5/25
2025-06-02 15:28:38,029 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:38,256 - DEBUG - Node anomaly scores shape: torch.Size([17428, 1])
2025-06-02 15:28:38,276 - DEBUG - Edge anomaly scores shape: torch.Size([36235, 1])
2025-06-02 15:28:38,279 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:38,538 - DEBUG - Step 5: Loss=0.7557
2025-06-02 15:28:38,539 - DEBUG - Online update step: 6/25
2025-06-02 15:28:38,554 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:38,672 - DEBUG - Node anomaly scores shape: torch.Size([17642, 1])
2025-06-02 15:28:38,681 - DEBUG - Edge anomaly scores shape: torch.Size([36614, 1])
2025-06-02 15:28:38,683 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:39,238 - DEBUG - Step 6: Loss=0.7528
2025-06-02 15:28:39,240 - DEBUG - Online update step: 7/25
2025-06-02 15:28:39,260 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:40,719 - DEBUG - Node anomaly scores shape: torch.Size([17212, 1])
2025-06-02 15:28:40,815 - DEBUG - Edge anomaly scores shape: torch.Size([35583, 1])
2025-06-02 15:28:40,868 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:42,749 - DEBUG - Step 7: Loss=0.7526
2025-06-02 15:28:42,750 - DEBUG - Online update step: 8/25
2025-06-02 15:28:42,764 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:44,108 - DEBUG - Node anomaly scores shape: torch.Size([17894, 1])
2025-06-02 15:28:44,200 - DEBUG - Edge anomaly scores shape: torch.Size([37304, 1])
2025-06-02 15:28:44,251 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:45,079 - DEBUG - Step 8: Loss=0.7476
2025-06-02 15:28:45,079 - DEBUG - Online update step: 9/25
2025-06-02 15:28:45,088 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:45,756 - DEBUG - Node anomaly scores shape: torch.Size([15887, 1])
2025-06-02 15:28:45,784 - DEBUG - Edge anomaly scores shape: torch.Size([32673, 1])
2025-06-02 15:28:45,800 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:46,161 - DEBUG - Step 9: Loss=0.7505
2025-06-02 15:28:46,161 - DEBUG - Online update step: 10/25
2025-06-02 15:28:46,174 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:46,300 - DEBUG - Node anomaly scores shape: torch.Size([16208, 1])
2025-06-02 15:28:46,308 - DEBUG - Edge anomaly scores shape: torch.Size([33411, 1])
2025-06-02 15:28:46,310 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:46,641 - DEBUG - Step 10: Loss=0.7482
2025-06-02 15:28:46,641 - DEBUG - Online update step: 11/25
2025-06-02 15:28:46,654 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:47,525 - DEBUG - Node anomaly scores shape: torch.Size([16548, 1])
2025-06-02 15:28:47,548 - DEBUG - Edge anomaly scores shape: torch.Size([34249, 1])
2025-06-02 15:28:47,554 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:48,035 - DEBUG - Step 11: Loss=0.7443
2025-06-02 15:28:48,036 - DEBUG - Online update step: 12/25
2025-06-02 15:28:48,048 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:48,148 - DEBUG - Node anomaly scores shape: torch.Size([18286, 1])
2025-06-02 15:28:48,153 - DEBUG - Edge anomaly scores shape: torch.Size([37977, 1])
2025-06-02 15:28:48,155 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:48,382 - DEBUG - Step 12: Loss=0.7410
2025-06-02 15:28:48,383 - DEBUG - Online update step: 13/25
2025-06-02 15:28:48,391 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:48,502 - DEBUG - Node anomaly scores shape: torch.Size([16978, 1])
2025-06-02 15:28:48,507 - DEBUG - Edge anomaly scores shape: torch.Size([35087, 1])
2025-06-02 15:28:48,508 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:48,721 - DEBUG - Step 13: Loss=0.7410
2025-06-02 15:28:48,721 - DEBUG - Online update step: 14/25
2025-06-02 15:28:48,729 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:48,826 - DEBUG - Node anomaly scores shape: torch.Size([17722, 1])
2025-06-02 15:28:48,830 - DEBUG - Edge anomaly scores shape: torch.Size([37071, 1])
2025-06-02 15:28:48,832 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:49,053 - DEBUG - Step 14: Loss=0.7400
2025-06-02 15:28:49,054 - DEBUG - Online update step: 15/25
2025-06-02 15:28:49,066 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:49,165 - DEBUG - Node anomaly scores shape: torch.Size([17489, 1])
2025-06-02 15:28:49,169 - DEBUG - Edge anomaly scores shape: torch.Size([36211, 1])
2025-06-02 15:28:49,171 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:49,378 - DEBUG - Step 15: Loss=0.7365
2025-06-02 15:28:49,380 - DEBUG - Online update step: 16/25
2025-06-02 15:28:49,395 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:49,497 - DEBUG - Node anomaly scores shape: torch.Size([18077, 1])
2025-06-02 15:28:49,501 - DEBUG - Edge anomaly scores shape: torch.Size([37503, 1])
2025-06-02 15:28:49,503 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:49,714 - DEBUG - Step 16: Loss=0.7356
2025-06-02 15:28:49,714 - DEBUG - Online update step: 17/25
2025-06-02 15:28:49,727 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:49,822 - DEBUG - Node anomaly scores shape: torch.Size([16922, 1])
2025-06-02 15:28:49,827 - DEBUG - Edge anomaly scores shape: torch.Size([34891, 1])
2025-06-02 15:28:49,829 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:50,065 - DEBUG - Step 17: Loss=0.7338
2025-06-02 15:28:50,065 - DEBUG - Online update step: 18/25
2025-06-02 15:28:50,074 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:50,173 - DEBUG - Node anomaly scores shape: torch.Size([17663, 1])
2025-06-02 15:28:50,178 - DEBUG - Edge anomaly scores shape: torch.Size([36673, 1])
2025-06-02 15:28:50,180 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:50,411 - DEBUG - Step 18: Loss=0.7324
2025-06-02 15:28:50,411 - DEBUG - Online update step: 19/25
2025-06-02 15:28:50,423 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:50,526 - DEBUG - Node anomaly scores shape: torch.Size([18378, 1])
2025-06-02 15:28:50,531 - DEBUG - Edge anomaly scores shape: torch.Size([38388, 1])
2025-06-02 15:28:50,532 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:50,759 - DEBUG - Step 19: Loss=0.7303
2025-06-02 15:28:50,760 - DEBUG - Online update step: 20/25
2025-06-02 15:28:50,772 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:50,870 - DEBUG - Node anomaly scores shape: torch.Size([16806, 1])
2025-06-02 15:28:50,874 - DEBUG - Edge anomaly scores shape: torch.Size([34828, 1])
2025-06-02 15:28:50,876 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:51,078 - DEBUG - Step 20: Loss=0.7299
2025-06-02 15:28:51,079 - DEBUG - Online update step: 21/25
2025-06-02 15:28:51,088 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:51,174 - DEBUG - Node anomaly scores shape: torch.Size([17091, 1])
2025-06-02 15:28:51,178 - DEBUG - Edge anomaly scores shape: torch.Size([35366, 1])
2025-06-02 15:28:51,179 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:51,415 - DEBUG - Step 21: Loss=0.7270
2025-06-02 15:28:51,416 - DEBUG - Online update step: 22/25
2025-06-02 15:28:51,424 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:51,509 - DEBUG - Node anomaly scores shape: torch.Size([15643, 1])
2025-06-02 15:28:51,513 - DEBUG - Edge anomaly scores shape: torch.Size([32235, 1])
2025-06-02 15:28:51,514 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:51,685 - DEBUG - Step 22: Loss=0.7263
2025-06-02 15:28:51,686 - DEBUG - Online update step: 23/25
2025-06-02 15:28:51,695 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:51,812 - DEBUG - Node anomaly scores shape: torch.Size([16903, 1])
2025-06-02 15:28:51,816 - DEBUG - Edge anomaly scores shape: torch.Size([34998, 1])
2025-06-02 15:28:51,818 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:52,067 - DEBUG - Step 23: Loss=0.7251
2025-06-02 15:28:52,068 - DEBUG - Online update step: 24/25
2025-06-02 15:28:52,077 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:52,157 - DEBUG - Node anomaly scores shape: torch.Size([16178, 1])
2025-06-02 15:28:52,161 - DEBUG - Edge anomaly scores shape: torch.Size([33469, 1])
2025-06-02 15:28:52,162 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:52,339 - DEBUG - Step 24: Loss=0.7253
2025-06-02 15:28:52,340 - DEBUG - Online update step: 25/25
2025-06-02 15:28:52,351 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:52,462 - DEBUG - Node anomaly scores shape: torch.Size([16621, 1])
2025-06-02 15:28:52,466 - DEBUG - Edge anomaly scores shape: torch.Size([34423, 1])
2025-06-02 15:28:52,468 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:52,669 - DEBUG - Step 25: Loss=0.7209
2025-06-02 15:28:52,669 - INFO - Online update finished. Average loss: 0.7414, Learning rate: 0.001000
2025-06-02 15:28:52,671 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  5.4540198e-08 -1.7141206e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.6750669e-08
  4.8826461e-08 -1.6102344e-08 -1.4544053e-08  7.2720265e-09
  2.3082788e+00  2.9607842e+00  1.4270152e-01  4.4074073e+00
  1.1946900e-08  3.3213508e+00  5.8714595e+00  7.6034861e+00
  1.4270152e-01  7.9923749e+00  1.2985761e-09  9.0900327e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.4024622e-08  4.9865324e-08], current edge mean: [-9.7413111e-10  4.5795404e+02  0.0000000e+00  0.0000000e+00
 -2.4353277e-09  6.3318519e-09 -4.8706555e-10  9.7413111e-10
  2.9223932e-09  9.7413111e-10]
2025-06-02 15:28:52,671 - DEBUG - Node drift difference: 0.0134, Edge drift difference: 0.0002
2025-06-02 15:28:52,673 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  5.4540198e-08 -1.7141206e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.6750669e-08
  4.8826461e-08 -1.6102344e-08 -1.4544053e-08  7.2720265e-09
  2.3082788e+00  2.9607842e+00  1.4270152e-01  4.4074073e+00
  1.1946900e-08  3.3213508e+00  5.8714595e+00  7.6034861e+00
  1.4270152e-01  7.9923749e+00  1.2985761e-09  9.0900327e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.4024622e-08  4.9865324e-08], edge=[-9.7413111e-10  4.5795404e+02  0.0000000e+00  0.0000000e+00
 -2.4353277e-09  6.3318519e-09 -4.8706555e-10  9.7413111e-10
  2.9223932e-09  9.7413111e-10]
2025-06-02 15:28:52,674 - DEBUG - Updated reference std: node=[0.         0.         1.0005451  1.0005451  0.         0.
 0.         1.0005451  1.0005451  1.0005451  1.0005451  1.0005451
 1.0198451  0.27744794 0.36818114 0.57352495 1.000545   2.9750328
 2.8805428  1.5016054  0.36818114 0.23103443 1.0005451  1.0005451
 0.         0.         0.         0.         1.0005451  1.000545  ], edge=[  1.0002555 460.90012     0.          0.          1.0002555   1.0002555
   1.0002555   1.0002555   1.0002555   1.0002555]
2025-06-02 15:28:52,675 - INFO - Online update complete. Loss: 0.7414
2025-06-02 15:28:52,675 - INFO - Running anomaly detection...
2025-06-02 15:28:52,675 - INFO - Starting anomaly detection.
2025-06-02 15:28:52,701 - DEBUG - Node reconstruction errors: [0.8671866  1.6230391  4.2565536  0.08471806 0.13957    0.11477076
 3.482005   0.20648046 0.20648046 0.2663085  0.20648032 0.41744137
 6.590219   1.5330878  0.06472342 0.14888364 0.44903532 0.14888424
 1.6769208  0.13718577 0.16235909 0.06472339 0.38087082 0.29965755
 0.06213672 0.18009014 0.06213665 0.29041016 0.1901557  0.06213665
 1.7206194  0.38879374 0.27478498 0.0880712  0.37485477 0.23926394
 0.24065176 0.13718587 0.3456106  0.47891527 0.14756118 0.05853004
 0.13718587 0.203784   1.6061467  0.37029442 0.41695464 0.5724743
 0.17808501 1.4065429  0.80859154 0.18826291 0.16656712 1.5414345
 0.18939342 0.16786923 2.4212859  0.11963888 1.6699836  1.7116334
 0.5961956  0.26825312 0.05132017 0.32972616 0.23195224 0.18939543
 0.13530248 0.18939127 0.0513202  0.26825312 0.19799829 0.12588607
 0.10027065 0.25514418 0.2603235  0.13060865 0.40536514 0.12392377
 0.04793561 0.06409853 0.07972376 0.09949913 1.4560249  1.1431158
 0.09902252 0.45405474 0.11202303 0.09925698 0.10275491 0.26732272
 0.05043676 0.21494102 0.20907699 0.06031496 0.20437883 1.0964849
 0.06572313 0.12101615 0.03675119 0.24962643 0.0931594  0.06572313
 0.142725   0.30981532 0.29157975 0.12025847 0.3186595  0.2587925
 0.23315793 0.98923    0.48451707 0.07431553 0.1539407  0.20110473
 0.08565512 0.0653289  0.07965932 0.15073664 0.17223006 0.12917604
 0.04335625 0.20118204 0.16465573 0.21708684 0.1813456  0.12917703
 0.22621234 0.26991448 0.17178856 0.0726147  0.15195355 0.0983142
 0.32767707 0.31526342 0.07136127 0.1209057  0.15428892 0.03998006
 0.36839867 0.25456062 0.15509388 0.08394429 0.04323659 0.1550938
 0.19453876 0.19878097 0.07965934 0.27965647 0.21197681 0.19174398
 0.76222044 0.3081877  0.07215087 0.0983142  0.16220114 0.1203198
 0.08645234 0.07877254 0.09315939 0.14812848 0.15509386 0.28288236
 0.08645234 0.15195355 0.08207133 0.18283507 0.09506065 0.04724012
 0.27770007 0.19174394 0.06657609 0.12958151 0.04902844 0.83736736
 0.17222983 5.034326   0.04654407 0.0833556  0.08003365 0.08003356
 0.11445223 0.24608475 0.1650292  0.21860774 0.1674647  0.07290629
 0.03778614 0.08589813 0.11453781 0.08065954 0.0905283  0.08770864
 0.21506009 0.0972812  0.36839893 0.12286521 1.5059631  0.23177451
 0.16314985 0.22103113 0.05595355 0.08645234 0.18590745 0.14650366
 0.17354837 0.23787394 0.19648282 0.27700737 0.03617884 0.06106965
 0.06996641 0.07842883 0.14145377 0.0596041  0.10073075 0.04162098
 0.15153153 0.07965934 0.1815832  0.0972812  0.23318456 0.03778614
 0.04463548 0.1414538  0.08645234 0.1802546  0.1662805  0.106427
 0.06150337 0.17945863 0.2580342  0.09622934 0.1701363  0.07965939
 0.07965936 0.12691875 0.04937409 0.04463548 0.08645234 0.25160262
 0.12463895 0.05201746 0.10710337 0.19063684 0.10031077 0.21851234
 0.0706992  0.08809071 0.10710336 0.13254622 0.0490284  0.04222703
 0.1815833  0.04541004 0.08978701 0.09995367 0.08065954 0.033333
 0.19098537 0.08003359 0.04472366 0.29480425 0.10929901 0.23447615
 0.12824427 0.18035075 0.11159249 1.6500837  0.11159233 0.06190252
 0.23198467 0.18297747 0.05833011 0.29062593 0.07933863 0.22460453
 0.04954803 0.16658701 0.11445223 0.08884706 0.25559276 0.05204679
 0.04612464 0.15189515 0.11258687 0.07522912 0.39082974 0.2736555
 0.24608484 1.1255648  0.21739502 0.06080511 0.1335344  0.10031065
 1.5734427  0.04501389 0.04513422 0.08003309 0.12286513 0.21997675
 0.04798218 0.03256128 0.06718011 0.09905156 0.03256128 0.03256134
 0.03256134 0.08073529 0.16752705 0.03256128 0.03256134 0.16979955
 0.03256134 0.07559773 0.22737938 0.06079173 0.28760546 0.18482259
 0.13869403 0.12173804 0.1536025  0.17112327 0.18086304 0.06717994
 0.22849101 0.1990318  0.16987129 0.10395117 0.06553344 0.06553317
 0.24206029 0.12047087 0.03256128 0.07933857 0.03256128 0.08073536
 0.15993817 0.03813989 0.03346216 0.03346211 0.03256128 0.05585945
 0.03346216 0.18439004 0.09538651 0.15153223 0.06718011 0.07287179
 0.11398642 0.05285408 0.03256128 0.06032437 0.18379077 0.08066797
 0.05050086 0.08065954 0.02993005 0.03256128 0.03628455 1.0110742
 0.15064496 0.08763756 0.16248001 0.09477758 0.06718019 1.2083557
 0.03384116 0.21333823 0.06808762 0.05219203 0.05220862 0.09094774
 0.16489668 0.15835379 0.13794176 0.08066584 0.03820264 0.10431636
 0.20899385 0.03256128 0.06718008 0.21126266 0.08089214 0.0477459
 0.21519867 0.11225663 0.14017047 0.22101845 0.09966101 0.03256134
 0.23976366 0.13637762 0.06097984 0.15683118 0.08914649 0.08914647
 0.08914649 1.6292619  0.02827848 1.6481847  0.07019555 0.1331058
 0.08914647 0.02827848 0.06117928 0.06097973 0.16618238 0.10189369
 0.06097984 0.20261675 0.08914649 0.06097986 0.02827848 0.08914647
 0.08914649 0.03127968 0.0532754  0.08914649 0.03820569 0.10247318
 0.14243878 0.06985832 0.05158898 0.07452068 0.15228505 0.14243743
 0.08229796 0.0895002  0.30109644 0.13882755 0.10894806 0.10453144
 0.06408449 0.07380702 0.08914649 0.08914647 0.07019552 0.10229436
 0.1577813  0.1475889  0.08443599 0.09829936 0.20566615 0.0330491
 0.12404177 0.15839669 0.30287555 0.06752995 0.12845714 0.07462288
 0.10703008 0.03175683 0.08207819 0.02599615 0.03175684 0.09975982
 0.07452071 0.11214896 0.07705178 0.10954364 0.06013177 0.08731558
 0.07192625 0.23908602 0.07192625 0.08731569 0.03010271 0.06671871
 0.18260394 0.13023497 0.03010272 0.06013175 0.08942618 0.38932034
 0.12520194 0.05158425 0.06671856 0.06013175 0.029293   0.09197748
 0.06826153 0.22354542 0.08505996 0.06752995 0.16437599 0.03783836
 0.03175684 0.18596245 0.09658775 0.3893782  0.05278916 0.02929304
 0.06058917 0.03019463 0.10207166 0.07974228 0.05462394 1.5015699
 0.02599615 0.09197748 0.15524831 0.0301946  0.20891972 0.0470196
 0.02694194 0.1586872  0.02407415 0.43380204 0.0779186  0.03175683
 0.15941    0.0903903  0.09039042 0.03880383 0.11154841 0.06868079
 0.02407415 0.05264199 0.14713393 0.07014603 0.052642   0.09829943
 0.02407415 0.18761282 0.02694194 0.05462396 0.14848112 0.19761474
 0.05264192 0.10877656 0.06868077 0.02599619 0.02599619 0.09197748
 0.05462395 0.05498382 0.06685369 0.10011404 0.02599615 0.07766826
 0.02599619 0.0776683  0.15158089 0.05264198 0.07748207 1.1146857
 0.18552926 0.02572865 1.103534   0.02572865 0.02572871 0.02572871
 0.02572865 0.02572864 0.02572865 0.02572865 0.06016408 0.07423056
 0.09472318 0.02572865 0.02572865 0.02572865 0.02572864 0.02572865
 0.02572864 0.02572865 0.02572865 0.02572865 0.04952623 0.02572865
 0.02572862 0.15160872 0.02572865 0.15026067 0.0677811  0.02599619
 0.129027   0.06720459 1.1104443  1.1104443  0.11212328 0.129027
 0.02599615 0.02407413 0.02407417 0.02599619 0.02407414 0.08090419
 0.10444093 0.02572865 0.0982994  0.02599619 0.0903903  0.02599619
 0.02599615 0.12437098 0.02599619 0.02407413 0.02599615 0.02599619
 0.05264199 0.02407417 0.02599615 0.02407417 0.02599619 0.02599617
 0.02599619 0.10192572 0.1493766  0.04712241 0.02572864 0.12124046
 0.0854562  0.02599619 0.02407414 0.09361496 0.02572862 0.07161061
 0.11115278 0.02501575 0.02599619 0.02599619 0.04847921 0.11373914
 0.04357165 0.02599615 0.06016413 0.03426063 0.02407417 0.17462079
 0.02572865 0.13723305 0.12329585 0.02572864 0.02572865 0.0601641
 0.03426064 0.02599619 0.21155481 0.07802822 0.09880182 0.11373914
 0.06240577 0.07034378 0.07034384 0.06623333 0.04484396 0.02572865
 0.08715248 0.04497276 0.11373913 0.04501848 0.05580271 0.07326853
 0.02555498 0.02555497 0.02555498 0.02555498 0.02555497 0.0486513
 0.04855265 0.02555498 0.02555498 0.02572865 0.03319284 0.02572864
 0.07034384 0.10321644 0.08415915 0.034814   0.07034384 0.10183441
 0.04952622 0.05168681 0.04952624 0.02572865 0.07034384 0.02563331
 0.02453592 0.02453595 0.02555497 0.02563333 0.08902979 0.07227532
 0.06637807 0.02572865 0.02555498 0.09077958 0.02453595 0.02763314
 0.03221465 0.08449846 0.04865141 0.42374393 0.02525509 0.24009351
 0.04233781 0.03221466 0.06038729 0.02556091 0.03106242 0.04047542
 0.06095301 0.07501454 0.06462775 0.03221465 0.03221465 0.03221465
 0.02911279 0.09077956 0.03221463 0.03106248 0.03221466 0.03221466
 0.03221466 0.04684985 0.02539345 0.08725789 0.11221027 0.06144767
 0.06774802 0.07917344 0.09999759 1.5419172  0.03221604 0.02731516
 0.0460605  0.12614822 0.12614825 0.03106241 0.24603412 0.15769647
 0.03222383 0.0285069  0.11976047 0.21920261 0.03158913 0.03158913
 0.03158915 0.03256521 0.03583458 0.15326259 0.2041206  0.19482116
 0.08569063 0.03801173 0.08505642 0.02850688 0.07152238 0.05183582
 0.03120118 0.15665594 0.03222383 0.15769394 0.0285069  0.05183586
 0.0380117  0.1314525  0.03158915 0.03256521 0.03120118 0.09257143
 0.12968881 0.03256521 0.03256521 0.03256521 0.15047589 2.1124697
 2.7798574  0.03158913 0.14277029 0.03256523 0.06452569 0.10162316
 1.4686893  0.1016232  0.03256523 0.03851506 0.0930516  0.03581579
 0.20710188 0.10162309 1.1924996  0.10498197 0.14623538 0.10162316
 0.06539738 0.1376102  0.1008311  0.15001473 0.06909069 0.04160821
 0.04160821 0.34493288 0.20426063 0.03851503 0.1016232  0.10083114
 0.1016232  0.05650444 0.04975081 0.04975081 0.04252954 0.17048326
 0.07579426 0.04975079 0.0565045  0.20665418 0.04975079 0.04975079
 0.04674268 0.18241765 0.17459328 0.15457381 0.04975079 0.08279216
 0.2066542  0.04975079 0.06009163 0.0989043  0.06453788 0.06453787
 0.17509246 0.0989043  0.04975079 0.0989043  0.09579927 0.17442799
 0.23564781 0.04975079 0.33057633 0.09621596 0.0989043  0.18241765
 0.05717381 0.09621596 0.06009156 0.1289154  0.06286433 0.16000895
 0.11013447 0.16000895 0.35241127 0.06875454 0.11013447 0.06970371
 0.06970371 1.5772667  0.06970371 0.1324672  0.05717381 0.15654163
 0.11366374 0.06875454 0.11366376 0.11138241 0.10189851 0.20954123
 0.06970371 0.14511171 0.18889318 0.06970374 0.20784841 0.1317041
 0.15541038 0.06875454 0.06970371 0.2906484  0.06970371 0.06970371
 0.06970371 0.072582   0.12094846 0.07258201 0.12875704 0.072582
 0.12196732 0.09963549 0.12196732 0.06970371 0.06970371 0.06970377
 0.06970371 1.5678674  0.12875693 0.07258201 0.06970371 0.06970377
 0.06970374 0.07872713 0.06970377 0.06970371 0.07272913 0.12875703
 0.08671779 1.297107   0.07272913 0.06970371 0.06970371 0.07064756
 0.10998616 0.11850104 0.11850104 0.08376721 0.1867329  0.22421737
 0.13708399 0.18794748 0.11850104 0.08671779 0.11850096 0.16838764
 0.13708399 0.11850096 0.09995375 0.08671779 0.15155488 0.08376723]
2025-06-02 15:28:52,702 - DEBUG - Edge reconstruction errors: [ 5.264626   5.2628064 44.25904   ... 13.359026   2.1599758 13.359026 ]
2025-06-02 15:28:52,705 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152852_update_40.json
2025-06-02 15:28:52,706 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:28:52,744 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152852_update_40.pth
2025-06-02 15:28:52,744 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870295.dot): 0.9308
2025-06-02 15:28:52,745 - WARNING - Detected 28 anomalous nodes (reconstruction-based):
2025-06-02 15:28:52,745 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.6230, MLP Score: 0.3839
2025-06-02 15:28:52,745 - WARNING -   Node ID: 192.168.27.13, Recon Error: 4.2566, MLP Score: 0.5145
2025-06-02 15:28:52,745 - WARNING -   Node ID: 192.168.27.12, Recon Error: 3.4820, MLP Score: 0.5237
2025-06-02 15:28:52,746 - WARNING -   Node ID: 192.168.27.10, Recon Error: 6.5902, MLP Score: 0.5248
2025-06-02 15:28:52,746 - WARNING -   Node ID: 8.8.8.8, Recon Error: 1.5331, MLP Score: 0.5409
2025-06-02 15:28:52,746 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:28:52,746 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2590, MLP Score: 0.2064
2025-06-02 15:28:52,747 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9618, MLP Score: 0.1036
2025-06-02 15:28:52,747 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0613, MLP Score: 0.1035
2025-06-02 15:28:52,747 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7599, MLP Score: 0.1191
2025-06-02 15:28:52,747 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7594, MLP Score: 0.1090
2025-06-02 15:28:52,748 - INFO - 
--- Processing file: nw_graph_encoded_1748870325.dot (Timestamp: 2025-06-02 15:18:45) ---
2025-06-02 15:28:52,748 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870325.dot
2025-06-02 15:28:52,748 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870325.dot'.
2025-06-02 15:28:52,748 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870325.dot
2025-06-02 15:28:52,784 - INFO - Parsed 922 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870325.dot'.
2025-06-02 15:28:52,893 - INFO - Parsed 1981 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870325.dot'.
2025-06-02 15:28:52,894 - INFO - Processing node updates/additions.
2025-06-02 15:28:52,935 - INFO - Processing edge updates/additions.
2025-06-02 15:28:53,099 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:28:53,105 - INFO - Finished updating NetworkX graph.
2025-06-02 15:28:53,109 - DEBUG - Updated graph - Nodes: 922, Edges: 1981
2025-06-02 15:28:53,109 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:28:53,116 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:28:53,296 - DEBUG - Initial node features tensor shape: torch.Size([922, 30])
2025-06-02 15:28:53,303 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:28:53,308 - DEBUG - Node features tensor shape after scaling: torch.Size([922, 30])
2025-06-02 15:28:53,314 - DEBUG - Edge index tensor shape: torch.Size([2, 1981])
2025-06-02 15:28:53,327 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:28:53,420 - DEBUG - Initial edge attributes tensor shape: torch.Size([1981, 10])
2025-06-02 15:28:53,428 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:28:53,432 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1981, 10])
2025-06-02 15:28:53,433 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:28:53,434 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:28:53,438 - INFO - Updated main graph to 922 nodes and 1981 edges.
2025-06-02 15:28:53,438 - INFO - Performing online update...
2025-06-02 15:28:53,439 - INFO - Starting online update for 25 steps.
2025-06-02 15:28:53,440 - DEBUG - Updated RunningStats: new_mean=0.9443832966486937, new_var=23400000000161.7, new_n=2370
2025-06-02 15:28:53,441 - DEBUG - Updated RunningStats: new_mean=0.9418362403986674, new_var=23700000000018.027, new_n=2400
2025-06-02 15:28:53,441 - DEBUG - Updated RunningStats: new_mean=44.64285001193961, new_var=7800000188619.679, new_n=790
2025-06-02 15:28:53,442 - DEBUG - Updated RunningStats: new_mean=44.66633927059707, new_var=7900000188362.781, new_n=800
2025-06-02 15:28:53,442 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:28:53,442 - DEBUG - Online update step: 1/25
2025-06-02 15:28:53,451 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:53,643 - DEBUG - Node anomaly scores shape: torch.Size([16811, 1])
2025-06-02 15:28:53,686 - DEBUG - Edge anomaly scores shape: torch.Size([34799, 1])
2025-06-02 15:28:53,688 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:53,888 - DEBUG - Step 1: Loss=0.7193
2025-06-02 15:28:53,889 - DEBUG - Online update step: 2/25
2025-06-02 15:28:53,902 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:54,026 - DEBUG - Node anomaly scores shape: torch.Size([17497, 1])
2025-06-02 15:28:54,031 - DEBUG - Edge anomaly scores shape: torch.Size([36340, 1])
2025-06-02 15:28:54,032 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:54,287 - DEBUG - Step 2: Loss=0.7166
2025-06-02 15:28:54,288 - DEBUG - Online update step: 3/25
2025-06-02 15:28:54,296 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:54,395 - DEBUG - Node anomaly scores shape: torch.Size([17459, 1])
2025-06-02 15:28:54,400 - DEBUG - Edge anomaly scores shape: torch.Size([36322, 1])
2025-06-02 15:28:54,403 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:54,634 - DEBUG - Step 3: Loss=0.7185
2025-06-02 15:28:54,634 - DEBUG - Online update step: 4/25
2025-06-02 15:28:54,643 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:54,721 - DEBUG - Node anomaly scores shape: torch.Size([16425, 1])
2025-06-02 15:28:54,724 - DEBUG - Edge anomaly scores shape: torch.Size([33837, 1])
2025-06-02 15:28:54,725 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:54,898 - DEBUG - Step 4: Loss=0.7179
2025-06-02 15:28:54,898 - DEBUG - Online update step: 5/25
2025-06-02 15:28:54,910 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:55,024 - DEBUG - Node anomaly scores shape: torch.Size([16960, 1])
2025-06-02 15:28:55,028 - DEBUG - Edge anomaly scores shape: torch.Size([35218, 1])
2025-06-02 15:28:55,030 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:55,233 - DEBUG - Step 5: Loss=0.7132
2025-06-02 15:28:55,234 - DEBUG - Online update step: 6/25
2025-06-02 15:28:55,242 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:55,329 - DEBUG - Node anomaly scores shape: torch.Size([17387, 1])
2025-06-02 15:28:55,333 - DEBUG - Edge anomaly scores shape: torch.Size([35917, 1])
2025-06-02 15:28:55,334 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:55,598 - DEBUG - Step 6: Loss=0.7104
2025-06-02 15:28:55,599 - DEBUG - Online update step: 7/25
2025-06-02 15:28:55,607 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:55,701 - DEBUG - Node anomaly scores shape: torch.Size([18505, 1])
2025-06-02 15:28:55,705 - DEBUG - Edge anomaly scores shape: torch.Size([38652, 1])
2025-06-02 15:28:55,706 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:55,922 - DEBUG - Step 7: Loss=0.7097
2025-06-02 15:28:55,923 - DEBUG - Online update step: 8/25
2025-06-02 15:28:55,931 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:56,027 - DEBUG - Node anomaly scores shape: torch.Size([18554, 1])
2025-06-02 15:28:56,031 - DEBUG - Edge anomaly scores shape: torch.Size([38578, 1])
2025-06-02 15:28:56,032 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:56,276 - DEBUG - Step 8: Loss=0.7113
2025-06-02 15:28:56,277 - DEBUG - Online update step: 9/25
2025-06-02 15:28:56,285 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:56,383 - DEBUG - Node anomaly scores shape: torch.Size([18075, 1])
2025-06-02 15:28:56,387 - DEBUG - Edge anomaly scores shape: torch.Size([37480, 1])
2025-06-02 15:28:56,388 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:56,600 - DEBUG - Step 9: Loss=0.7083
2025-06-02 15:28:56,600 - DEBUG - Online update step: 10/25
2025-06-02 15:28:56,608 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:56,698 - DEBUG - Node anomaly scores shape: torch.Size([17988, 1])
2025-06-02 15:28:56,702 - DEBUG - Edge anomaly scores shape: torch.Size([37471, 1])
2025-06-02 15:28:56,703 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:56,924 - DEBUG - Step 10: Loss=0.7049
2025-06-02 15:28:56,924 - DEBUG - Online update step: 11/25
2025-06-02 15:28:56,932 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:57,020 - DEBUG - Node anomaly scores shape: torch.Size([18124, 1])
2025-06-02 15:28:57,024 - DEBUG - Edge anomaly scores shape: torch.Size([37657, 1])
2025-06-02 15:28:57,025 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:57,241 - DEBUG - Step 11: Loss=0.7067
2025-06-02 15:28:57,242 - DEBUG - Online update step: 12/25
2025-06-02 15:28:57,250 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:57,340 - DEBUG - Node anomaly scores shape: torch.Size([17938, 1])
2025-06-02 15:28:57,348 - DEBUG - Edge anomaly scores shape: torch.Size([37294, 1])
2025-06-02 15:28:57,350 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:57,571 - DEBUG - Step 12: Loss=0.7037
2025-06-02 15:28:57,572 - DEBUG - Online update step: 13/25
2025-06-02 15:28:57,584 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:57,676 - DEBUG - Node anomaly scores shape: torch.Size([16369, 1])
2025-06-02 15:28:57,680 - DEBUG - Edge anomaly scores shape: torch.Size([33791, 1])
2025-06-02 15:28:57,682 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:57,899 - DEBUG - Step 13: Loss=0.7019
2025-06-02 15:28:57,900 - DEBUG - Online update step: 14/25
2025-06-02 15:28:57,914 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:58,011 - DEBUG - Node anomaly scores shape: torch.Size([17525, 1])
2025-06-02 15:28:58,016 - DEBUG - Edge anomaly scores shape: torch.Size([36285, 1])
2025-06-02 15:28:58,017 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:58,232 - DEBUG - Step 14: Loss=0.7001
2025-06-02 15:28:58,233 - DEBUG - Online update step: 15/25
2025-06-02 15:28:58,246 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:58,342 - DEBUG - Node anomaly scores shape: torch.Size([17219, 1])
2025-06-02 15:28:58,349 - DEBUG - Edge anomaly scores shape: torch.Size([35642, 1])
2025-06-02 15:28:58,351 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:58,559 - DEBUG - Step 15: Loss=0.7033
2025-06-02 15:28:58,560 - DEBUG - Online update step: 16/25
2025-06-02 15:28:58,572 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:58,663 - DEBUG - Node anomaly scores shape: torch.Size([16486, 1])
2025-06-02 15:28:58,667 - DEBUG - Edge anomaly scores shape: torch.Size([34052, 1])
2025-06-02 15:28:58,669 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:58,858 - DEBUG - Step 16: Loss=0.6983
2025-06-02 15:28:58,858 - DEBUG - Online update step: 17/25
2025-06-02 15:28:58,871 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:58,963 - DEBUG - Node anomaly scores shape: torch.Size([16585, 1])
2025-06-02 15:28:58,967 - DEBUG - Edge anomaly scores shape: torch.Size([34172, 1])
2025-06-02 15:28:58,968 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:59,138 - DEBUG - Step 17: Loss=0.6964
2025-06-02 15:28:59,139 - DEBUG - Online update step: 18/25
2025-06-02 15:28:59,147 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:59,263 - DEBUG - Node anomaly scores shape: torch.Size([16905, 1])
2025-06-02 15:28:59,267 - DEBUG - Edge anomaly scores shape: torch.Size([34998, 1])
2025-06-02 15:28:59,269 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:59,490 - DEBUG - Step 18: Loss=0.6961
2025-06-02 15:28:59,491 - DEBUG - Online update step: 19/25
2025-06-02 15:28:59,499 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:59,588 - DEBUG - Node anomaly scores shape: torch.Size([17296, 1])
2025-06-02 15:28:59,592 - DEBUG - Edge anomaly scores shape: torch.Size([35649, 1])
2025-06-02 15:28:59,593 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:28:59,821 - DEBUG - Step 19: Loss=0.6978
2025-06-02 15:28:59,821 - DEBUG - Online update step: 20/25
2025-06-02 15:28:59,836 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:28:59,931 - DEBUG - Node anomaly scores shape: torch.Size([16463, 1])
2025-06-02 15:28:59,936 - DEBUG - Edge anomaly scores shape: torch.Size([33944, 1])
2025-06-02 15:28:59,937 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:00,135 - DEBUG - Step 20: Loss=0.6919
2025-06-02 15:29:00,135 - DEBUG - Online update step: 21/25
2025-06-02 15:29:00,144 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:00,234 - DEBUG - Node anomaly scores shape: torch.Size([16219, 1])
2025-06-02 15:29:00,238 - DEBUG - Edge anomaly scores shape: torch.Size([33359, 1])
2025-06-02 15:29:00,239 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:00,443 - DEBUG - Step 21: Loss=0.6900
2025-06-02 15:29:00,443 - DEBUG - Online update step: 22/25
2025-06-02 15:29:00,451 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:00,548 - DEBUG - Node anomaly scores shape: torch.Size([17680, 1])
2025-06-02 15:29:00,552 - DEBUG - Edge anomaly scores shape: torch.Size([36675, 1])
2025-06-02 15:29:00,554 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:00,780 - DEBUG - Step 22: Loss=0.6900
2025-06-02 15:29:00,781 - DEBUG - Online update step: 23/25
2025-06-02 15:29:00,790 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:00,887 - DEBUG - Node anomaly scores shape: torch.Size([17384, 1])
2025-06-02 15:29:00,892 - DEBUG - Edge anomaly scores shape: torch.Size([35986, 1])
2025-06-02 15:29:00,894 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:01,086 - DEBUG - Step 23: Loss=0.6945
2025-06-02 15:29:01,087 - DEBUG - Online update step: 24/25
2025-06-02 15:29:01,096 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:01,185 - DEBUG - Node anomaly scores shape: torch.Size([16572, 1])
2025-06-02 15:29:01,189 - DEBUG - Edge anomaly scores shape: torch.Size([34323, 1])
2025-06-02 15:29:01,190 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:01,392 - DEBUG - Step 24: Loss=0.6865
2025-06-02 15:29:01,393 - DEBUG - Online update step: 25/25
2025-06-02 15:29:01,402 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:01,509 - DEBUG - Node anomaly scores shape: torch.Size([18613, 1])
2025-06-02 15:29:01,514 - DEBUG - Edge anomaly scores shape: torch.Size([38788, 1])
2025-06-02 15:29:01,515 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:01,800 - DEBUG - Step 25: Loss=0.6824
2025-06-02 15:29:01,801 - INFO - Online update finished. Average loss: 0.7028, Learning rate: 0.001000
2025-06-02 15:29:01,802 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  2.7927555e-08  3.6202388e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.7584016e-08
  7.2404774e-08 -3.7236742e-08 -1.0343539e-09  8.2748315e-09
  2.3080261e+00  2.9609544e+00  1.4425163e-01  4.4078093e+00
  3.7236742e-08  3.3156183e+00  5.8611712e+00  7.5986986e+00
  1.4425163e-01  7.9924078e+00 -6.2061236e-09 -2.5858848e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.7066840e-08 -3.2064971e-08], current edge mean: [ 0.0000000e+00  4.5778043e+02  0.0000000e+00  0.0000000e+00
 -3.3698739e-09 -9.6282116e-10 -2.8884632e-09 -2.6477580e-09
 -3.3698739e-09 -2.8884632e-09]
2025-06-02 15:29:01,802 - DEBUG - Node drift difference: 0.0042, Edge drift difference: 0.0004
2025-06-02 15:29:01,804 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  2.7927555e-08  3.6202388e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.7584016e-08
  7.2404774e-08 -3.7236742e-08 -1.0343539e-09  8.2748315e-09
  2.3080261e+00  2.9609544e+00  1.4425163e-01  4.4078093e+00
  3.7236742e-08  3.3156183e+00  5.8611712e+00  7.5986986e+00
  1.4425163e-01  7.9924078e+00 -6.2061236e-09 -2.5858848e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.7066840e-08 -3.2064971e-08], edge=[ 0.0000000e+00  4.5778043e+02  0.0000000e+00  0.0000000e+00
 -3.3698739e-09 -9.6282116e-10 -2.8884632e-09 -2.6477580e-09
 -3.3698739e-09 -2.8884632e-09]
2025-06-02 15:29:01,805 - DEBUG - Updated reference std: node=[0.         0.         1.0005428  1.0005428  0.         0.
 0.         1.0005426  1.0005426  1.0005428  1.0005428  1.0005428
 1.0201662  0.2768568  0.3696031  0.5732584  1.0005428  2.978598
 2.8835957  1.5098369  0.3696031  0.23053272 1.0005428  1.0005428
 0.         0.         0.         0.         1.0005428  1.0005428 ], edge=[  1.0002525 458.21814     0.          0.          1.0002525   1.0002525
   1.0002525   1.0002525   1.0002525   1.0002525]
2025-06-02 15:29:01,805 - INFO - Online update complete. Loss: 0.7028
2025-06-02 15:29:01,806 - INFO - Running anomaly detection...
2025-06-02 15:29:01,806 - INFO - Starting anomaly detection.
2025-06-02 15:29:01,826 - DEBUG - Node reconstruction errors: [0.7803309  1.5859802  2.5354588  0.04594674 0.10912046 0.09317303
 1.8203601  0.13537373 0.13537379 0.16228566 0.13537376 0.17265391
 4.225394   1.4087632  0.04098018 0.1174982  0.1900854  0.11749844
 1.0886887  0.11427759 0.1084696  0.04098018 0.31827882 0.16018912
 0.03950122 0.09868534 0.03950123 0.19842416 0.12810136 0.03950123
 1.2584735  0.35778242 0.18961072 0.05138458 0.30152658 0.18145102
 0.2333724  0.11427767 0.29073998 0.38720518 0.10320833 0.03454007
 0.11427767 0.16728787 1.4838434  0.28570968 0.29280853 0.4847848
 0.12230065 1.2206607  0.5619555  0.10932279 0.09336926 1.0275241
 0.1422811  0.14017805 1.521937   0.10333963 1.1363503  1.168933
 0.50194186 0.2510085  0.02913857 0.22778504 0.2074153  0.14227659
 0.10014532 0.14227763 0.02913852 0.2510085  0.15303163 0.09918173
 0.06727117 0.25660115 0.2653708  0.1001416  0.3664924  0.10125802
 0.03940402 0.04767717 0.05223754 0.08509741 1.277749   0.6991878
 0.08886299 0.27298215 0.09734964 0.2003372  0.08142257 0.24886248
 0.02939125 0.13718511 0.0700049  0.1753063  0.16108374 0.6463756
 0.04490733 0.10791365 0.02020432 0.2237899  0.07668658 0.04490733
 0.11059547 0.297115   0.18755415 0.08329907 0.22234298 0.17968564
 0.07930633 0.8948858  0.4206955  0.05250261 0.1239249  0.16064139
 0.068751   0.05590719 0.06599775 0.13356987 0.14934282 0.09977344
 0.02685702 0.07613552 0.14819661 0.11194614 0.1600551  0.09977474
 0.11871007 0.19946857 0.15282637 0.06551312 0.09144323 0.061891
 0.18197717 0.26313096 0.05952699 0.08126917 0.12490936 0.02101178
 0.28224576 0.16252929 0.1784907  0.0728974  0.0304582  0.11778709
 0.1784907  0.17473723 0.06599765 0.2574851  0.16405511 0.16690445
 0.68498343 0.19583291 0.06270457 0.061891   0.10367865 0.09446554
 0.05609665 0.07709184 0.07668658 0.10874055 0.17849068 0.21250014
 0.05609668 0.09144323 0.06796117 0.13300961 0.08012421 0.03917661
 0.21012655 0.16690448 0.05321688 0.10024289 0.0268116  0.6233013
 0.14934298 6.8710337  0.04197389 0.07767306 0.06870132 0.0687013
 0.0785323  0.09939799 0.14383577 0.20487739 0.09523637 0.06594535
 0.02802715 0.07657436 0.07636306 0.05083644 0.10034202 0.15442482
 0.16272876 0.06617845 0.28224725 0.07195517 1.3498205  0.21269117
 0.1471726  0.20147572 0.04895604 0.05609668 0.11772265 0.17906114
 0.15004238 0.1717311  0.13040496 0.2470713  0.02180348 0.0537743
 0.06027532 0.06735177 0.08750091 0.06253396 0.09015339 0.03144789
 0.13261284 0.0659977  0.1630769  0.06617845 0.21540993 0.02802716
 0.02385176 0.08750095 0.05609665 0.16160345 0.14350922 0.07391383
 0.05281021 0.15963958 0.16926874 0.09340587 0.17612179 0.06599763
 0.06599765 0.09368635 0.04922383 0.02385176 0.05609668 0.23445438
 0.0995997  0.05245476 0.07056116 0.1692132  0.06980982 0.1931594
 0.06491329 0.0790528  0.07056116 0.09792073 0.02681108 0.02378327
 0.16307709 0.04088684 0.17597339 0.08331268 0.05083644 0.02345893
 0.17730202 0.06870142 0.04201462 0.12169424 0.07433595 0.19603767
 0.11387258 0.13930787 0.10129009 1.24148    0.10128985 0.05962455
 0.21611007 0.16865192 0.06078692 0.26327434 0.06964758 0.20356221
 0.04174059 0.1503986  0.07853229 0.07758842 0.18826078 0.04365836
 0.04115735 0.11568813 0.18372637 0.05148164 0.2912531  0.15878655
 0.0993981  1.0508214  0.18251018 0.04834874 0.10351072 0.06980982
 1.45336    0.03823953 0.0447225  0.06870098 0.07195513 0.1145934
 0.04394954 0.01637347 0.06140111 0.09308203 0.01637347 0.01637347
 0.01637345 0.07310261 0.15634952 0.01637347 0.01637345 0.09736514
 0.01637347 0.04672256 0.16430734 0.0576201  0.26680997 0.06535283
 0.08825625 0.07120357 0.13373396 0.14928912 0.1604635  0.06140114
 0.16225176 0.18571688 0.15964726 0.09035127 0.06046457 0.06046462
 0.23536308 0.07290792 0.01637347 0.06964744 0.01637347 0.0731025
 0.12072524 0.02051749 0.01762155 0.01762155 0.01637347 0.03341169
 0.01762155 0.18801767 0.08475077 0.13261333 0.06140114 0.05082683
 0.10116562 0.04595099 0.01637345 0.05526505 0.16275524 0.07834205
 0.02935005 0.05083644 0.02165073 0.01637347 0.01824824 0.6326101
 0.13070187 0.05391557 0.159657   0.09668561 0.06140115 1.0413563
 0.02108377 0.12222791 0.06091047 0.04682759 0.05402036 0.08957006
 0.14658432 0.10613228 0.13784224 0.07834031 0.02192425 0.07158477
 0.12514701 0.01637345 0.06140114 0.16710101 0.04837342 0.04343734
 0.15638791 0.09963609 0.10285623 0.11698549 0.08981071 0.01637347
 0.19660856 0.11561606 0.05653666 0.12792431 0.08294606 0.08294607
 0.08294605 1.1259869  0.01520268 1.13588    0.04340998 0.11852751
 0.08294608 0.01520271 0.0573526  0.05653661 0.14744492 0.07521482
 0.05653666 0.14350717 0.08294607 0.05653668 0.01520268 0.08294606
 0.08294607 0.02054148 0.03056926 0.08294605 0.02192173 0.09413202
 0.10394751 0.04332429 0.04781302 0.04523882 0.1253489  0.11816801
 0.05478333 0.07431071 0.19480173 0.04782255 0.10437735 0.07130446
 0.06079012 0.06814418 0.08294607 0.08294606 0.04341    0.09276044
 0.13413261 0.1285446  0.07546254 0.06447534 0.20062158 0.02375935
 0.11007709 0.08984072 0.24347334 0.0415603  0.08107856 0.04658846
 0.1000139  0.02042553 0.05246807 0.12690744 0.02042552 0.06722796
 0.04523883 0.0795656  0.06766632 0.09041576 0.05579692 0.05462192
 0.04387286 0.09846766 0.04387289 0.05462193 0.0166225  0.05618591
 0.13276936 0.08066141 0.0166225  0.05579693 0.08074    0.3058448
 0.11040667 0.04781011 0.05618596 0.05579691 0.01942519 0.06035197
 0.0556079  0.22692105 0.07621457 0.04156028 0.12485281 0.03198709
 0.02042552 0.14265983 0.07209239 0.30588704 0.05158775 0.01942519
 0.05297863 0.0215552  0.12083409 0.04898041 0.0519979  1.0293603
 0.01468396 0.06035197 0.15378386 0.0215552  0.19413161 0.03923027
 0.01587846 0.06077162 0.01427537 0.37765557 0.04967366 0.02042554
 0.07087732 0.05676425 0.05676428 0.02928841 0.08941734 0.06074487
 0.01427532 0.05106708 0.12667328 0.07124203 0.05106699 0.06447538
 0.01427534 0.1401806  0.01587848 0.05199797 0.09764265 0.11663435
 0.05106704 0.10062766 0.06074492 0.11442474 0.01468396 0.06035197
 0.05199795 0.05248522 0.06409429 0.09382255 0.01468396 0.07541857
 0.01468396 0.07541849 0.13394168 0.05106698 0.04679079 0.7292331
 0.13466902 0.01485314 1.0004629  0.01485314 0.01485314 0.01485315
 0.01485314 0.01485316 0.01485316 0.01485319 0.05843341 0.04508876
 0.07450541 0.01485314 0.01485314 0.01485314 0.01485314 0.01485315
 0.01485315 0.01485314 0.01485314 0.01485315 0.04793458 0.01485314
 0.01485316 0.11133339 0.01485314 0.08143894 0.05434374 0.01468395
 0.10746769 0.0587935  0.8884298  0.8884298  0.10284311 0.10746769
 0.01468396 0.01427532 0.01427534 0.01468396 0.01427534 0.06954196
 0.07379993 0.01485316 0.06447536 0.01468396 0.05676428 0.01468396
 0.01468396 0.10833653 0.01468395 0.01427535 0.01468396 0.01468395
 0.05106695 0.01427532 0.01468395 0.01427537 0.01468396 0.01468396
 0.01468396 0.09733168 0.1443505  0.04444473 0.01485314 0.08307378
 0.06916447 0.01468396 0.01427537 0.08751842 0.01485314 0.06314463
 0.09007303 0.01609846 0.01468396 0.01468396 0.04607556 0.10778896
 0.03814589 0.01468395 0.05843347 0.02645068 0.01427534 0.09938586
 0.01485314 0.09821354 0.10850789 0.01485314 0.01485314 0.05843345
 0.02645068 0.01468396 0.20332415 0.07493903 0.08953922 0.10778895
 0.05362072 0.06975014 0.06975015 0.05445656 0.03728988 0.01485314
 0.05485437 0.04335131 0.10778903 0.0427199  0.04688499 0.05762188
 0.0152077  0.01520772 0.01520772 0.01520772 0.01520771 0.04570104
 0.04204869 0.01520773 0.01520773 0.01485314 0.02592943 0.01485314
 0.06975015 0.09781978 0.07343702 0.02240149 0.06975015 0.13305461
 0.04793461 0.0459862  0.04793457 0.01485314 0.06975015 0.01576226
 0.0144032  0.0144032  0.01520772 0.01576228 0.08370251 0.05887681
 0.05439161 0.01485316 0.01520772 0.07247055 0.0144032  0.01983629
 0.01992639 0.0685109  0.04570113 0.32627028 0.01881571 0.1655393
 0.03745549 0.01992639 0.03649471 0.01582995 0.02069494 0.02733643
 0.06090603 0.05486759 0.06482475 0.01992639 0.01992641 0.01992639
 0.01892117 0.07247056 0.01992639 0.02069547 0.01992641 0.01992644
 0.01992647 0.04139875 0.0167034  0.07009672 0.10460242 0.0621439
 0.04046591 0.05856289 0.08950298 1.1012728  0.02030368 0.01693222
 0.02844244 0.09120603 0.09120603 0.02069551 0.17978941 0.14539999
 0.02030368 0.01503668 0.05153801 0.15531935 0.01849716 0.01849719
 0.01849719 0.01633318 0.01964579 0.08822109 0.1528966  0.1903192
 0.07334423 0.02254791 0.05314539 0.01503673 0.04106847 0.04073198
 0.01863594 0.11000384 0.02030367 0.14539805 0.01503673 0.040732
 0.02254785 0.08552802 0.01849719 0.01633318 0.01863591 0.06078203
 0.09411167 0.01633318 0.01633317 0.01633317 0.1230868  1.8800657
 2.6292405  0.0184972  0.12796998 0.01633317 0.06243859 0.06363302
 1.0674452  0.0636331  0.01633318 0.01954589 0.05032434 0.02080201
 0.19155124 0.06363305 0.7388538  0.08310517 0.11587407 0.06363303
 0.05712802 0.09765415 0.08436266 0.13308707 0.05325137 0.02317927
 0.0231793  0.2477796  0.29270267 0.09970985 0.06363298 0.08436268
 0.06363302 0.03006382 0.0273709  0.02737088 0.0226175  0.14714354
 0.04311003 0.02737087 0.03006378 0.17162932 0.02737088 0.02737087
 0.02459329 0.1289862  0.14454861 0.11971126 0.02737088 0.06253435
 0.17162932 0.0273709  0.03363579 0.05308953 0.03529987 0.03529987
 0.15960786 0.05308952 0.0273709  0.05308951 0.05379691 0.13699315
 0.18026096 0.0273709  0.29709426 0.05519601 0.05519611 0.1289862
 0.03161334 0.05693826 0.03363578 0.10325036 0.03422055 0.11133654
 0.0684416  0.11133637 0.31805712 0.03735824 0.06844159 0.04059774
 0.04059774 1.2167742  0.04059779 0.11571594 0.03161335 0.10551753
 0.0670881  0.03735823 0.06708804 0.08257351 0.13078175 0.1705514
 0.04059777 0.11578818 0.12602925 0.04059779 0.1742361  0.10168643
 0.1207503  0.03735825 0.04059779 0.26469404 0.04059779 0.04059775
 0.04059777 0.04185772 0.07979012 0.04185778 0.08030713 0.04185776
 0.08237827 0.08064692 0.1625665  0.04059779 0.04059779 0.04059777
 0.04059776 0.6449353  0.08030716 0.04185778 0.04059779 0.04059774
 0.04059777 0.06038876 0.04059779 0.04059774 0.04186685 0.0803072
 0.05368171 0.7929546  0.04186685 0.04059774 0.04059779 0.04803101
 0.07745706 0.08610375 0.08610374 0.05170993 0.12867819 0.15881827
 0.08360399 0.30470863 0.08610374 0.05204884 0.08610375 0.13283883
 0.083604   0.08610375 0.06547398 0.05368172 0.09906082 0.05364306
 0.06443182 0.06547441 0.17474517 0.06830654]
2025-06-02 15:29:01,827 - DEBUG - Edge reconstruction errors: [ 5.264904   5.262679  44.258915  ... 13.358897   2.1598492 13.358897 ]
2025-06-02 15:29:01,830 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152901_update_41.json
2025-06-02 15:29:01,830 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:29:01,869 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152901_update_41.pth
2025-06-02 15:29:01,869 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870325.dot): 0.9363
2025-06-02 15:29:01,869 - WARNING - Detected 25 anomalous nodes (reconstruction-based):
2025-06-02 15:29:01,869 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.5860, MLP Score: 0.4276
2025-06-02 15:29:01,870 - WARNING -   Node ID: 192.168.27.13, Recon Error: 2.5355, MLP Score: 0.5157
2025-06-02 15:29:01,870 - WARNING -   Node ID: 192.168.27.12, Recon Error: 1.8204, MLP Score: 0.5258
2025-06-02 15:29:01,870 - WARNING -   Node ID: 192.168.27.10, Recon Error: 4.2254, MLP Score: 0.5238
2025-06-02 15:29:01,870 - WARNING -   Node ID: 8.8.8.8, Recon Error: 1.4088, MLP Score: 0.5524
2025-06-02 15:29:01,870 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:29:01,871 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2589, MLP Score: 0.5493
2025-06-02 15:29:01,871 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9615, MLP Score: 0.6205
2025-06-02 15:29:01,871 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0612, MLP Score: 0.6205
2025-06-02 15:29:01,872 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7598, MLP Score: 0.6119
2025-06-02 15:29:01,872 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7592, MLP Score: 0.5985
2025-06-02 15:29:01,879 - DEBUG - Embedding standard deviations before t-SNE: [1.0469854  0.         0.5810302  1.4411343  0.         0.56618583
 0.9120905  0.2712122  0.         2.48657    2.3831313  1.8950692
 1.0855207  0.7348772  1.0947139  1.1263192  0.         0.8539577
 0.         1.3428941  0.19300172 1.8279724  0.         0.
 0.26384676 1.0243407  0.02054529 1.246632   2.0271692  0.
 1.2297953  1.1566201 ]
2025-06-02 15:29:02,876 - INFO - Embeddings visualization saved to vis/embeddings_41_updates_20250602_152901.png
2025-06-02 15:29:02,876 - INFO - Performing visualization of node and edge features.
2025-06-02 15:29:02,883 - INFO - Starting visualization of node features.
2025-06-02 15:29:02,883 - INFO - Graph has 922 nodes and 30 features.
2025-06-02 15:29:02,884 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:29:02,884 - INFO - Calculating feature statistics:
2025-06-02 15:29:02,884 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:29:02,885 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:29:02,885 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 21, 'mean': np.float32(3.3099326e-08), 'std': np.float32(1.0), 'min': np.float32(-1.9147569), 'max': np.float32(2.4391384)}
2025-06-02 15:29:02,885 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 21, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.352639), 'max': np.float32(2.006021)}
2025-06-02 15:29:02,886 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:29:02,886 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:29:02,886 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:29:02,887 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(-1.6549663e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.46169025), 'max': np.float32(2.165954)}
2025-06-02 15:29:02,887 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(6.619865e-08), 'std': np.float32(1.0), 'min': np.float32(-1.1199458), 'max': np.float32(0.8929003)}
2025-06-02 15:29:02,887 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 4, 'mean': np.float32(-2.896191e-08), 'std': np.float32(1.0), 'min': np.float32(-9.039497), 'max': np.float32(0.11300867)}
2025-06-02 15:29:02,887 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 21, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.4760993), 'max': np.float32(1.4725882)}
2025-06-02 15:29:02,888 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 21, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.4442264), 'max': np.float32(2.5885324)}
2025-06-02 15:29:02,888 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 9, 'mean': np.float32(2.308026), 'std': np.float32(1.0196128), 'min': np.float32(0.0), 'max': np.float32(11.0)}
2025-06-02 15:29:02,888 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.9609544), 'std': np.float32(0.27670658), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:29:02,889 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.14425163), 'std': np.float32(0.3694026), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:29:02,889 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.4078093), 'std': np.float32(0.5729474), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:29:02,889 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 4, 'mean': np.float32(2.896191e-08), 'std': np.float32(1.0), 'min': np.float32(-0.11300867), 'max': np.float32(9.039497)}
2025-06-02 15:29:02,890 - INFO - - service_1: {'name': 'service_1', 'unique': 6, 'mean': np.float32(3.3156183), 'std': np.float32(2.9769824), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 15:29:02,890 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.8611712), 'std': np.float32(2.8820314), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:29:02,890 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.5986986), 'std': np.float32(1.5090178), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:29:02,890 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.14425163), 'std': np.float32(0.3694026), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:29:02,891 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 2, 'mean': np.float32(7.992408), 'std': np.float32(0.23040767), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:29:02,891 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(-4.1374157e-09), 'std': np.float32(1.0000001), 'min': np.float32(-0.12914392), 'max': np.float32(16.107769)}
2025-06-02 15:29:02,891 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(-6.2061236e-09), 'std': np.float32(1.0), 'min': np.float32(-0.14110813), 'max': np.float32(7.086764)}
2025-06-02 15:29:02,892 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:29:02,892 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:29:02,892 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:29:02,893 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:29:02,893 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(8.2748315e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.974236), 'max': np.float32(8.896596)}
2025-06-02 15:29:02,893 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(-1.6549663e-08), 'std': np.float32(1.0), 'min': np.float32(-1.0681784), 'max': np.float32(4.4855456)}
2025-06-02 15:29:02,963 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7f927d570e00>
2025-06-02 15:29:03,749 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:29:04,128 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:29:04,307 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:29:09,060 - INFO - Node feature visualization saved to vis/node_features_20250602_152904.png
2025-06-02 15:29:09,061 - INFO - Finished visualization of node features.
2025-06-02 15:29:09,061 - INFO - Performing additional feature analysis:
2025-06-02 15:29:09,062 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:29:09,075 - INFO - Starting visualization of edge features.
2025-06-02 15:29:09,075 - INFO - Graph has 1981 edges and 10 edge features.
2025-06-02 15:29:09,075 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:29:09,076 - INFO - Calculating edge feature statistics:
2025-06-02 15:29:09,077 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:29:09,077 - INFO - - count: {'name': 'count', 'unique': 34, 'mean': np.float32(0.0), 'std': np.float32(1.0000001), 'min': np.float32(-0.03646034), 'max': np.float32(34.218254)}
2025-06-02 15:29:09,077 - INFO - - dst_port: {'name': 'dst_port', 'unique': 19, 'mean': np.float32(457.78043), 'std': np.float32(458.10248), 'min': np.float32(0.0), 'max': np.float32(8898.0)}
2025-06-02 15:29:09,078 - INFO - - protocol: {'name': 'protocol', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:29:09,078 - INFO - - service: {'name': 'service', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:29:09,078 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 1323, 'mean': np.float32(-1.9256423e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.058690593), 'max': np.float32(31.43086)}
2025-06-02 15:29:09,078 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 1409, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.05430731), 'max': np.float32(33.032013)}
2025-06-02 15:29:09,078 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 468, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.044447273), 'max': np.float32(34.08441)}
2025-06-02 15:29:09,078 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 1380, 'mean': np.float32(-1.4442316e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.0819718), 'max': np.float32(28.840654)}
2025-06-02 15:29:09,079 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 1404, 'mean': np.float32(-2.8884632e-09), 'std': np.float32(1.0), 'min': np.float32(-0.082216784), 'max': np.float32(27.85083)}
2025-06-02 15:29:09,079 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 509, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.052967753), 'max': np.float32(33.503876)}
2025-06-02 15:29:09,151 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7f929014e510>
2025-06-02 15:29:09,611 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:29:09,677 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7f9290aa8440>
2025-06-02 15:29:10,056 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:29:10,501 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:29:10,916 - DEBUG - Plotted boxplots of the first 8 non-constant edge features.
2025-06-02 15:29:10,996 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:29:11,027 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:29:14,984 - INFO - Edge feature visualization saved to vis/edge_features_20250602_152911.png
2025-06-02 15:29:14,985 - INFO - Finished visualization of edge features.
2025-06-02 15:29:14,985 - INFO - Performing additional edge feature analysis:
2025-06-02 15:29:14,985 - INFO - - 2 out of 10 edge features are constant.
2025-06-02 15:29:14,986 - INFO - - Highest correlation (1.00) between features: 'total_resp_bytes' and 'total_resp_ip_bytes'.
2025-06-02 15:29:14,998 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:29:14,998 - INFO - Graph has 1981 edges and 10 edge features.
2025-06-02 15:29:14,999 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:29:16,193 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_152914_summary.png
2025-06-02 15:29:17,184 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_152914_pca_3d.png
2025-06-02 15:29:17,693 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_152914_pca_variance.png
2025-06-02 15:29:17,693 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:29:17,693 - INFO - 
--- Processing file: nw_graph_encoded_1748870355.dot (Timestamp: 2025-06-02 15:19:15) ---
2025-06-02 15:29:17,693 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870355.dot
2025-06-02 15:29:17,694 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870355.dot'.
2025-06-02 15:29:17,694 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870355.dot
2025-06-02 15:29:17,730 - INFO - Parsed 934 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870355.dot'.
2025-06-02 15:29:17,834 - INFO - Parsed 2007 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870355.dot'.
2025-06-02 15:29:17,834 - INFO - Processing node updates/additions.
2025-06-02 15:29:17,873 - INFO - Processing edge updates/additions.
2025-06-02 15:29:18,037 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:29:18,044 - INFO - Finished updating NetworkX graph.
2025-06-02 15:29:18,048 - DEBUG - Updated graph - Nodes: 934, Edges: 2007
2025-06-02 15:29:18,048 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:29:18,055 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:29:18,240 - DEBUG - Initial node features tensor shape: torch.Size([934, 30])
2025-06-02 15:29:18,244 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:29:18,245 - DEBUG - Node features tensor shape after scaling: torch.Size([934, 30])
2025-06-02 15:29:18,253 - DEBUG - Edge index tensor shape: torch.Size([2, 2007])
2025-06-02 15:29:18,266 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:29:18,358 - DEBUG - Initial edge attributes tensor shape: torch.Size([2007, 10])
2025-06-02 15:29:18,361 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:29:18,362 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2007, 10])
2025-06-02 15:29:18,363 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:29:18,363 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:29:18,367 - INFO - Updated main graph to 934 nodes and 2007 edges.
2025-06-02 15:29:18,367 - INFO - Performing online update...
2025-06-02 15:29:18,368 - INFO - Starting online update for 25 steps.
2025-06-02 15:29:18,369 - DEBUG - Updated RunningStats: new_mean=0.9445000116300595, new_var=24000000000161.836, new_n=2430
2025-06-02 15:29:18,369 - DEBUG - Updated RunningStats: new_mean=0.942001057574944, new_var=24300000000017.97, new_n=2460
2025-06-02 15:29:18,370 - DEBUG - Updated RunningStats: new_mean=44.679570484884216, new_var=8000000188288.719, new_n=810
2025-06-02 15:29:18,370 - DEBUG - Updated RunningStats: new_mean=44.698534313194855, new_var=8100000185992.935, new_n=820
2025-06-02 15:29:18,371 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:29:18,371 - DEBUG - Online update step: 1/25
2025-06-02 15:29:18,379 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:18,547 - DEBUG - Node anomaly scores shape: torch.Size([18054, 1])
2025-06-02 15:29:18,569 - DEBUG - Edge anomaly scores shape: torch.Size([37456, 1])
2025-06-02 15:29:18,576 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:18,775 - DEBUG - Step 1: Loss=0.6840
2025-06-02 15:29:18,775 - DEBUG - Online update step: 2/25
2025-06-02 15:29:18,784 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:18,908 - DEBUG - Node anomaly scores shape: torch.Size([17126, 1])
2025-06-02 15:29:18,912 - DEBUG - Edge anomaly scores shape: torch.Size([35339, 1])
2025-06-02 15:29:18,914 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:19,137 - DEBUG - Step 2: Loss=0.6919
2025-06-02 15:29:19,138 - DEBUG - Online update step: 3/25
2025-06-02 15:29:19,146 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:19,231 - DEBUG - Node anomaly scores shape: torch.Size([15768, 1])
2025-06-02 15:29:19,235 - DEBUG - Edge anomaly scores shape: torch.Size([32354, 1])
2025-06-02 15:29:19,236 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:19,411 - DEBUG - Step 3: Loss=0.6807
2025-06-02 15:29:19,412 - DEBUG - Online update step: 4/25
2025-06-02 15:29:19,422 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:19,530 - DEBUG - Node anomaly scores shape: torch.Size([17210, 1])
2025-06-02 15:29:19,534 - DEBUG - Edge anomaly scores shape: torch.Size([35691, 1])
2025-06-02 15:29:19,535 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:19,750 - DEBUG - Step 4: Loss=0.6794
2025-06-02 15:29:19,750 - DEBUG - Online update step: 5/25
2025-06-02 15:29:19,759 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:19,855 - DEBUG - Node anomaly scores shape: torch.Size([17759, 1])
2025-06-02 15:29:19,860 - DEBUG - Edge anomaly scores shape: torch.Size([36837, 1])
2025-06-02 15:29:19,861 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:20,073 - DEBUG - Step 5: Loss=0.6928
2025-06-02 15:29:20,074 - DEBUG - Online update step: 6/25
2025-06-02 15:29:20,083 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:20,177 - DEBUG - Node anomaly scores shape: torch.Size([17379, 1])
2025-06-02 15:29:20,181 - DEBUG - Edge anomaly scores shape: torch.Size([36101, 1])
2025-06-02 15:29:20,183 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:20,388 - DEBUG - Step 6: Loss=0.6774
2025-06-02 15:29:20,388 - DEBUG - Online update step: 7/25
2025-06-02 15:29:20,397 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:20,487 - DEBUG - Node anomaly scores shape: torch.Size([16651, 1])
2025-06-02 15:29:20,492 - DEBUG - Edge anomaly scores shape: torch.Size([34374, 1])
2025-06-02 15:29:20,493 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:20,696 - DEBUG - Step 7: Loss=0.6926
2025-06-02 15:29:20,696 - DEBUG - Online update step: 8/25
2025-06-02 15:29:20,706 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:20,810 - DEBUG - Node anomaly scores shape: torch.Size([18205, 1])
2025-06-02 15:29:20,817 - DEBUG - Edge anomaly scores shape: torch.Size([37987, 1])
2025-06-02 15:29:20,819 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:21,032 - DEBUG - Step 8: Loss=0.6773
2025-06-02 15:29:21,033 - DEBUG - Online update step: 9/25
2025-06-02 15:29:21,042 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:21,128 - DEBUG - Node anomaly scores shape: torch.Size([16351, 1])
2025-06-02 15:29:21,132 - DEBUG - Edge anomaly scores shape: torch.Size([33761, 1])
2025-06-02 15:29:21,133 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:21,332 - DEBUG - Step 9: Loss=0.6880
2025-06-02 15:29:21,333 - DEBUG - Online update step: 10/25
2025-06-02 15:29:21,341 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:21,439 - DEBUG - Node anomaly scores shape: torch.Size([17129, 1])
2025-06-02 15:29:21,444 - DEBUG - Edge anomaly scores shape: torch.Size([35633, 1])
2025-06-02 15:29:21,446 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:21,660 - DEBUG - Step 10: Loss=0.6827
2025-06-02 15:29:21,660 - DEBUG - Online update step: 11/25
2025-06-02 15:29:21,669 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:21,769 - DEBUG - Node anomaly scores shape: torch.Size([19291, 1])
2025-06-02 15:29:21,773 - DEBUG - Edge anomaly scores shape: torch.Size([40244, 1])
2025-06-02 15:29:21,775 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:22,019 - DEBUG - Step 11: Loss=0.6730
2025-06-02 15:29:22,020 - DEBUG - Online update step: 12/25
2025-06-02 15:29:22,028 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:22,119 - DEBUG - Node anomaly scores shape: torch.Size([17962, 1])
2025-06-02 15:29:22,123 - DEBUG - Edge anomaly scores shape: torch.Size([37306, 1])
2025-06-02 15:29:22,125 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:22,353 - DEBUG - Step 12: Loss=0.6693
2025-06-02 15:29:22,353 - DEBUG - Online update step: 13/25
2025-06-02 15:29:22,362 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:22,461 - DEBUG - Node anomaly scores shape: torch.Size([16678, 1])
2025-06-02 15:29:22,467 - DEBUG - Edge anomaly scores shape: torch.Size([34444, 1])
2025-06-02 15:29:22,468 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:22,667 - DEBUG - Step 13: Loss=0.6685
2025-06-02 15:29:22,667 - DEBUG - Online update step: 14/25
2025-06-02 15:29:22,675 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:22,768 - DEBUG - Node anomaly scores shape: torch.Size([17523, 1])
2025-06-02 15:29:22,772 - DEBUG - Edge anomaly scores shape: torch.Size([36397, 1])
2025-06-02 15:29:22,774 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:22,978 - DEBUG - Step 14: Loss=0.6697
2025-06-02 15:29:22,979 - DEBUG - Online update step: 15/25
2025-06-02 15:29:22,988 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:23,087 - DEBUG - Node anomaly scores shape: torch.Size([17952, 1])
2025-06-02 15:29:23,092 - DEBUG - Edge anomaly scores shape: torch.Size([37291, 1])
2025-06-02 15:29:23,094 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:23,307 - DEBUG - Step 15: Loss=0.6733
2025-06-02 15:29:23,307 - DEBUG - Online update step: 16/25
2025-06-02 15:29:23,316 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:23,403 - DEBUG - Node anomaly scores shape: torch.Size([16421, 1])
2025-06-02 15:29:23,408 - DEBUG - Edge anomaly scores shape: torch.Size([33967, 1])
2025-06-02 15:29:23,409 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:23,613 - DEBUG - Step 16: Loss=0.6857
2025-06-02 15:29:23,614 - DEBUG - Online update step: 17/25
2025-06-02 15:29:23,623 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:23,723 - DEBUG - Node anomaly scores shape: torch.Size([17213, 1])
2025-06-02 15:29:23,727 - DEBUG - Edge anomaly scores shape: torch.Size([35832, 1])
2025-06-02 15:29:23,728 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:23,896 - DEBUG - Step 17: Loss=0.6656
2025-06-02 15:29:23,897 - DEBUG - Online update step: 18/25
2025-06-02 15:29:23,906 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:24,005 - DEBUG - Node anomaly scores shape: torch.Size([15656, 1])
2025-06-02 15:29:24,009 - DEBUG - Edge anomaly scores shape: torch.Size([32193, 1])
2025-06-02 15:29:24,010 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:24,203 - DEBUG - Step 18: Loss=0.6947
2025-06-02 15:29:24,203 - DEBUG - Online update step: 19/25
2025-06-02 15:29:24,212 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:24,513 - DEBUG - Node anomaly scores shape: torch.Size([18127, 1])
2025-06-02 15:29:24,522 - DEBUG - Edge anomaly scores shape: torch.Size([37768, 1])
2025-06-02 15:29:24,530 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:24,926 - DEBUG - Step 19: Loss=0.6732
2025-06-02 15:29:24,931 - DEBUG - Online update step: 20/25
2025-06-02 15:29:24,949 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:25,626 - DEBUG - Node anomaly scores shape: torch.Size([17387, 1])
2025-06-02 15:29:25,631 - DEBUG - Edge anomaly scores shape: torch.Size([35955, 1])
2025-06-02 15:29:25,632 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:25,782 - DEBUG - Step 20: Loss=0.7106
2025-06-02 15:29:25,783 - DEBUG - Online update step: 21/25
2025-06-02 15:29:25,791 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:25,910 - DEBUG - Node anomaly scores shape: torch.Size([16342, 1])
2025-06-02 15:29:25,925 - DEBUG - Edge anomaly scores shape: torch.Size([33797, 1])
2025-06-02 15:29:25,930 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:26,087 - DEBUG - Step 21: Loss=0.7176
2025-06-02 15:29:26,087 - DEBUG - Online update step: 22/25
2025-06-02 15:29:26,095 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:26,232 - DEBUG - Node anomaly scores shape: torch.Size([17269, 1])
2025-06-02 15:29:26,236 - DEBUG - Edge anomaly scores shape: torch.Size([35907, 1])
2025-06-02 15:29:26,238 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:26,391 - DEBUG - Step 22: Loss=0.6730
2025-06-02 15:29:26,392 - DEBUG - Online update step: 23/25
2025-06-02 15:29:26,400 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:26,535 - DEBUG - Node anomaly scores shape: torch.Size([16237, 1])
2025-06-02 15:29:26,544 - DEBUG - Edge anomaly scores shape: torch.Size([33536, 1])
2025-06-02 15:29:26,548 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:26,696 - DEBUG - Step 23: Loss=0.7274
2025-06-02 15:29:26,697 - DEBUG - Online update step: 24/25
2025-06-02 15:29:26,704 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:26,841 - DEBUG - Node anomaly scores shape: torch.Size([15488, 1])
2025-06-02 15:29:26,847 - DEBUG - Edge anomaly scores shape: torch.Size([31815, 1])
2025-06-02 15:29:26,848 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:27,004 - DEBUG - Step 24: Loss=0.7480
2025-06-02 15:29:27,005 - DEBUG - Online update step: 25/25
2025-06-02 15:29:27,013 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:27,159 - DEBUG - Node anomaly scores shape: torch.Size([17090, 1])
2025-06-02 15:29:27,163 - DEBUG - Edge anomaly scores shape: torch.Size([35447, 1])
2025-06-02 15:29:27,164 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:27,340 - DEBUG - Step 25: Loss=0.7248
2025-06-02 15:29:27,340 - INFO - Online update finished. Average loss: 0.6889, Learning rate: 0.001000
2025-06-02 15:29:27,342 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -6.6369199e-09 -9.7001136e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  3.3184598e-08
 -2.2463421e-08 -4.2118913e-09  8.1685165e-09  4.5947908e-09
  2.3062098e+00  2.9614561e+00  1.4025696e-01  4.4132762e+00
 -1.9144961e-09  3.2944326e+00  5.8822269e+00  7.5974302e+00
  1.4025696e-01  7.9925056e+00 -1.0465912e-08  3.0631937e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.6247794e-08  1.2252775e-08], current edge mean: [ 3.8013925e-09  4.5738068e+02  0.0000000e+00  0.0000000e+00
 -2.3758702e-09  1.9006963e-09 -9.5034813e-10  1.9006963e-09
  1.9006963e-09  2.8510443e-09]
2025-06-02 15:29:27,342 - DEBUG - Node drift difference: 0.0108, Edge drift difference: 0.0009
2025-06-02 15:29:27,344 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -6.6369199e-09 -9.7001136e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  3.3184598e-08
 -2.2463421e-08 -4.2118913e-09  8.1685165e-09  4.5947908e-09
  2.3062098e+00  2.9614561e+00  1.4025696e-01  4.4132762e+00
 -1.9144961e-09  3.2944326e+00  5.8822269e+00  7.5974302e+00
  1.4025696e-01  7.9925056e+00 -1.0465912e-08  3.0631937e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.6247794e-08  1.2252775e-08], edge=[ 3.8013925e-09  4.5738068e+02  0.0000000e+00  0.0000000e+00
 -2.3758702e-09  1.9006963e-09 -9.5034813e-10  1.9006963e-09
  1.9006963e-09  2.8510443e-09]
2025-06-02 15:29:27,345 - DEBUG - Updated reference std: node=[0.         0.         1.0005357  1.0005357  0.         0.
 0.         1.0005357  1.0005357  1.0005358  1.0005357  1.0005357
 1.0156461  0.27510577 0.3654804  0.5750021  1.0005357  2.9664128
 2.87709    1.51188    0.3654804  0.229047   1.0005357  1.0005357
 0.         0.         0.         0.         1.0005357  1.0005357 ], edge=[  1.0002493 455.3443      0.          0.          1.0002491   1.0002493
   1.0002493   1.0002493   1.0002493   1.0002493]
2025-06-02 15:29:27,346 - INFO - Online update complete. Loss: 0.6889
2025-06-02 15:29:27,346 - INFO - Running anomaly detection...
2025-06-02 15:29:27,346 - INFO - Starting anomaly detection.
2025-06-02 15:29:27,370 - DEBUG - Node reconstruction errors: [0.7497307  1.1866482  1.6355512  0.03217214 0.08652163 0.07622466
 0.92515534 0.09547277 0.09547278 0.09863173 0.09547277 0.08579622
 2.58427    1.2342603  0.0376634  0.07193858 0.24768578 0.07193852
 0.74326694 0.06779414 0.08062436 0.03766339 0.3457674  0.0994718
 0.03751209 0.06223486 0.03751209 0.1501319  0.09330903 0.03751209
 0.93451065 0.3356063  0.12741445 0.0425553  0.24000984 0.14612569
 0.23152798 0.06779417 0.27624422 0.31973615 0.07892892 0.03272823
 0.06779413 0.14151682 1.3675444  0.21258502 0.1638125  0.44103545
 0.08959833 0.94357836 0.4175931  0.07072689 0.06171123 0.6798598
 0.09929015 0.13575204 1.1377422  0.0608263  0.7705298  0.74285036
 0.44575644 0.22906558 0.02842654 0.16144167 0.20082338 0.0992906
 0.07074221 0.09928903 0.02842655 0.31788418 0.11582141 0.08466958
 0.05278799 0.22515255 0.23382217 0.08372378 0.3171023  0.08805361
 0.03563993 0.0414602  0.04336184 0.07867798 1.0522296  0.38555717
 0.08171228 0.16230844 0.08343819 0.18026392 0.07236982 0.23377076
 0.02878916 0.0814109  0.02764927 0.15387267 0.12236788 0.38357517
 0.03699268 0.09992918 0.02241817 0.19906738 0.06719353 0.03699268
 0.09133229 0.28576407 0.12853688 0.0546398  0.17976622 0.13336214
 0.03160761 0.8095496  0.3572065  0.04547402 0.08443005 0.13925846
 0.05879496 0.04882945 0.05817562 0.12124397 0.13202366 0.06500443
 0.02755254 0.0321089  0.14535145 0.0752455  0.13957974 0.0650053
 0.08017003 0.1681247  0.14115518 0.05269678 0.05962064 0.0485244
 0.12687097 0.26359588 0.05259541 0.05627206 0.10244937 0.02239411
 0.20450129 0.13689032 0.1562766  0.063984   0.03056887 0.10254922
 0.1562766  0.14711829 0.05817558 0.22099699 0.13859035 0.14200853
 0.59886634 0.1320128  0.05944661 0.04852429 0.07083996 0.08757867
 0.04264785 0.07844109 0.06719355 0.08871983 0.15627661 0.1580994
 0.04264783 0.05962063 0.05969621 0.09827532 0.07134392 0.03489918
 0.15677865 0.14200845 0.04803903 0.06536923 0.02624567 0.50605327
 0.13202344 8.460122   0.0399176  0.07534156 0.06205166 0.06205166
 0.05179569 0.05851727 0.11814278 0.20247415 0.06052808 0.06229524
 0.02669306 0.0741661  0.05380686 0.03867993 0.06464715 0.13524184
 0.12732513 0.04865122 0.20450395 0.04645915 1.147932   0.19362812
 0.13602695 0.17553662 0.03747827 0.04264783 0.07962468 0.16410853
 0.13076717 0.13205312 0.08770394 0.24556123 0.02443663 0.0514069
 0.05450571 0.14375487 0.06032792 0.06908361 0.08098674 0.02937114
 0.12202584 0.05817556 0.1632747  0.04865123 0.21932627 0.026694
 0.02388294 0.06032792 0.04264783 0.14797682 0.12839565 0.05461536
 0.04930985 0.09388094 0.11926305 0.09062139 0.15881883 0.05817561
 0.05817561 0.07923769 0.05115038 0.02388294 0.04264786 0.21384335
 0.08935779 0.18262643 0.05492868 0.14597921 0.05115217 0.16610071
 0.06491351 0.0673159  0.05492871 0.07018922 0.02624567 0.02074922
 0.16327469 0.03898873 0.15621461 0.07163378 0.03867994 0.02475714
 0.15802643 0.06205166 0.04204028 0.06977507 0.04176068 0.15688916
 0.10765069 0.15162311 0.09385283 0.94177336 0.09385277 0.0609609
 0.21239682 0.16684778 0.06584637 0.22796823 0.06389957 0.16838296
 0.02871853 0.13606676 0.05179569 0.06801733 0.1723018  0.02917053
 0.03738203 0.0943034  0.16754046 0.04607457 0.2649826  0.10979047
 0.05851723 0.9663278  0.18752989 0.04322222 0.09098066 0.05115217
 1.3400501  0.03667741 0.04785878 0.0620523  0.04645914 0.07175409
 0.04102671 0.1855927  0.05818779 0.08741871 0.01870879 0.01870877
 0.01870879 0.06876262 0.13865958 0.1855927  0.01870879 0.06237411
 0.01870879 0.03495568 0.12531921 0.058181   0.23006386 0.03311179
 0.05990611 0.04545765 0.11932654 0.11384901 0.14205246 0.05818776
 0.12252886 0.1835165  0.24980217 0.07408667 0.05895193 0.05895214
 0.24131076 0.04533509 0.01870879 0.06389971 0.01870877 0.06876256
 0.08657079 0.01850468 0.21439447 0.02028568 0.1855926  0.01859105
 0.02028568 0.16492352 0.08249242 0.12202699 0.0581877  0.04582536
 0.09262762 0.04283102 0.01870877 0.05446602 0.16460256 0.07525484
 0.01614919 0.03867994 0.1855927  0.01870879 0.02034811 0.36954197
 0.10705668 0.04165111 0.13348196 0.09801291 0.05818795 0.789422
 0.01956024 0.06893075 0.05679435 0.04328547 0.06045813 0.08867315
 0.13480905 0.07140584 0.12168574 0.0752527  0.02067797 0.05494666
 0.07138909 0.01870879 0.05818773 0.12662454 0.03899876 0.04002986
 0.1210325  0.08699568 0.08747016 0.08287396 0.08169606 0.01870879
 0.16103414 0.10200518 0.05376817 0.11024984 0.07672261 0.07672254
 0.07672259 0.73618984 0.01588003 0.74368536 0.03185293 0.09878888
 0.07672261 0.01588003 0.05788492 0.05376812 0.1308621  0.05000532
 0.0537681  0.11523781 0.07672261 0.05376812 0.01587998 0.07672261
 0.07672261 0.01322436 0.01722175 0.07672257 0.02067427 0.08090938
 0.07606925 0.03249363 0.04539738 0.03582526 0.12105047 0.08843793
 0.0425738  0.06178312 0.15591042 0.01692158 0.09753849 0.04916276
 0.05845117 0.06328999 0.10330927 0.07672258 0.0318529  0.08381943
 0.13082935 0.11148743 0.06367359 0.05025835 0.16822733 0.01863157
 0.09600195 0.05984979 0.20295112 0.03165843 0.05233042 0.03645809
 0.1007057  0.01616542 0.04104303 0.13504505 0.01616542 0.05068975
 0.03582526 0.06512535 0.05964618 0.08913419 0.05332198 0.04326434
 0.03432751 0.0565264  0.0343275  0.04326429 0.01335728 0.04633135
 0.10978965 0.05212192 0.01335727 0.05332197 0.07350074 0.28579247
 0.10234482 0.0453953  0.04633132 0.05332201 0.01497073 0.0474898
 0.04913817 0.24226417 0.06571767 0.03165843 0.11657963 0.02449688
 0.01616542 0.12203778 0.04456865 0.2857978  0.05447832 0.01497071
 0.04769364 0.01785581 0.09857991 0.03880786 0.05043095 0.65929115
 0.01363216 0.0474898  0.13251747 0.01785581 0.16583389 0.02680258
 0.01153419 0.03654299 0.01241606 0.39800027 0.03829719 0.01616542
 0.03191347 0.04372422 0.04372422 0.02336798 0.07201505 0.05040031
 0.01241605 0.05175529 0.10405049 0.07920872 0.05175536 0.05025834
 0.01241598 0.10650635 0.01153422 0.05043094 0.06263022 0.09518536
 0.08640648 0.09053817 0.05040133 0.11615019 0.01363214 0.04748986
 0.05043092 0.0508685  0.06587028 0.08811457 0.01363216 0.06942966
 0.01363216 0.07808491 0.13464764 0.05175535 0.035407   0.42213503
 0.11033919 0.01213581 0.9515316  0.01213589 0.01213581 0.01213581
 0.01213581 0.01213582 0.01213589 0.01213581 0.05986182 0.03312352
 0.04740515 0.01213581 0.01213581 0.01213581 0.01213582 0.01213582
 0.01213581 0.01213582 0.01213585 0.01213582 0.04967694 0.01213582
 0.01213581 0.09783039 0.01213581 0.05557777 0.04761517 0.01363216
 0.10855734 0.04781246 0.617518   0.617518   0.09341499 0.10855734
 0.01363216 0.01241598 0.01241606 0.01363216 0.01241606 0.06002764
 0.04714828 0.01213587 0.05025834 0.01363216 0.04372422 0.01363216
 0.01363214 0.09423433 0.01363216 0.01241606 0.01363214 0.01363216
 0.05175533 0.01241606 0.01363216 0.01241598 0.01363216 0.01363216
 0.01363216 0.0921309  0.12109623 0.04266785 0.01213585 0.06167459
 0.06645652 0.01363216 0.01241606 0.08586875 0.01213589 0.05391102
 0.08038045 0.01335681 0.01363216 0.01363216 0.04754011 0.10287631
 0.0337146  0.01363214 0.05986186 0.02153506 0.01241606 0.08049674
 0.01213582 0.06869581 0.09871431 0.01213581 0.01213581 0.05986165
 0.02153419 0.01363214 0.16663073 0.07010613 0.08549264 0.10287628
 0.04300635 0.0669319  0.06693186 0.04709144 0.02857656 0.01213581
 0.04196387 0.03877558 0.10287631 0.04157307 0.03769286 0.04886142
 0.01129431 0.0112943  0.01129431 0.01129431 0.01129431 0.04753342
 0.03850963 0.01129431 0.0112943  0.01213581 0.01995752 0.01213582
 0.06693187 0.09363977 0.06554209 0.01396997 0.06693186 0.12323745
 0.04967679 0.03681024 0.04967697 0.01213581 0.06693181 0.01028778
 0.01096587 0.01096585 0.01129431 0.0102878  0.07961348 0.04626415
 0.04770289 0.01213581 0.0112943  0.06215201 0.01096585 0.0150072
 0.01393408 0.05586888 0.04753343 0.3000557  0.01094177 0.11919594
 0.03522618 0.01393404 0.02377436 0.00951113 0.01346164 0.02087897
 0.05923392 0.04604902 0.06290917 0.01393408 0.01393408 0.01393408
 0.01262264 0.06215201 0.01393404 0.01346163 0.01393404 0.01393408
 0.01393403 0.03940384 0.00919239 0.06340404 0.10563294 0.0588552
 0.02819102 0.04796215 0.07779811 0.72862697 0.01362905 0.00950784
 0.02128888 0.0705227  0.0705227  0.01346163 0.14161189 0.15535624
 0.01362168 0.0117497  0.02808094 0.11437751 0.01025022 0.01025024
 0.01025022 0.0123943  0.01283781 0.07444268 0.10977483 0.16618016
 0.06616259 0.01615605 0.03932271 0.01174966 0.0275558  0.0350767
 0.01231076 0.07623845 0.01362171 0.15535356 0.0117497  0.03507672
 0.01615605 0.07644133 0.01025024 0.01239425 0.01231076 0.04588462
 0.07245104 0.01239428 0.01239428 0.01239428 0.11600046 1.5146134
 2.3209443  0.01025022 0.17655538 0.01239427 0.05759936 0.03729371
 0.7336385  0.04641523 0.01239428 0.01303754 0.03168098 0.01413096
 0.36723092 0.04641517 0.55214095 0.07229317 0.11674592 0.04641511
 0.05182324 0.07443285 0.0632495  0.12357428 0.04817144 0.01479031
 0.01479031 0.18382505 0.24427912 0.08533016 0.04641516 0.06324951
 0.04641511 0.01424338 0.01478991 0.01478986 0.01281378 0.13750824
 0.02256835 0.01478991 0.01424338 0.14423405 0.01478991 0.01478991
 0.01374712 0.09023921 0.1371542  0.1033035  0.01478991 0.05329154
 0.14423397 0.01478991 0.01658277 0.03000608 0.0172688  0.0172688
 0.1311542  0.03000607 0.01478991 0.030006   0.03206518 0.12020617
 0.1338219  0.01478991 0.22815281 0.03043244 0.03043245 0.09024002
 0.01611591 0.03646786 0.01658276 0.08739131 0.01571517 0.07942923
 0.04486013 0.07942919 0.2675986  0.01713881 0.04486013 0.02030366
 0.02030375 0.8314102  0.0203037  0.08157703 0.01611591 0.07271934
 0.0417383  0.01713879 0.04173831 0.08479093 0.11038716 0.12913711
 0.02030366 0.09651807 0.08338811 0.02030366 0.13464403 0.07957099
 0.09651814 0.01713879 0.0203037  0.21869782 0.0203037  0.0203037
 0.02030366 0.02018384 0.06136414 0.02018384 0.04091546 0.02018348
 0.05898509 0.06317568 0.1455463  0.0203037  0.02030375 0.02642213
 0.02030366 0.4263894  0.05157883 0.02018389 0.02030375 0.02030366
 0.0203037  0.02818997 0.0203037  0.0203037  0.0199941  0.05157883
 0.02588362 0.58797    0.01999408 0.0203037  0.0203037  0.02165035
 0.06063402 0.06605942 0.06605942 0.02645114 0.0866797  0.10874417
 0.04788331 0.2624727  0.06605945 0.02578252 0.06605942 0.10592204
 0.04788331 0.06605943 0.03552475 0.02588362 0.05727718 0.02972717
 0.03351795 0.03676045 0.11703517 0.03368946 0.04747375 0.04747375
 0.03368945 0.04747375 0.04747364 0.04747375 0.04747375 0.08880266
 0.04747362 0.04747359 0.04747363 0.04747375]
2025-06-02 15:29:27,371 - DEBUG - Edge reconstruction errors: [ 5.264985   5.2623563 44.258606  ... 13.358591   2.159541  13.358591 ]
2025-06-02 15:29:27,376 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152927_update_42.json
2025-06-02 15:29:27,377 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:29:27,420 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152927_update_42.pth
2025-06-02 15:29:27,421 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870355.dot): 0.9353
2025-06-02 15:29:27,421 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-02 15:29:27,421 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.1866, MLP Score: 0.3788
2025-06-02 15:29:27,422 - WARNING -   Node ID: 192.168.27.13, Recon Error: 1.6356, MLP Score: 0.5075
2025-06-02 15:29:27,422 - WARNING -   Node ID: 192.168.27.10, Recon Error: 2.5843, MLP Score: 0.4886
2025-06-02 15:29:27,423 - WARNING -   Node ID: 8.8.8.8, Recon Error: 1.2343, MLP Score: 0.5267
2025-06-02 15:29:27,423 - WARNING -   Node ID: 113.171.234.51, Recon Error: 1.3675, MLP Score: 0.5152
2025-06-02 15:29:27,423 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:29:27,423 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2586, MLP Score: 0.4879
2025-06-02 15:29:27,424 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9613, MLP Score: 0.6008
2025-06-02 15:29:27,424 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0609, MLP Score: 0.6008
2025-06-02 15:29:27,425 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7596, MLP Score: 0.5197
2025-06-02 15:29:27,425 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7589, MLP Score: 0.5041
2025-06-02 15:29:27,426 - INFO - 
--- Processing file: nw_graph_encoded_1748870385.dot (Timestamp: 2025-06-02 15:19:45) ---
2025-06-02 15:29:27,426 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870385.dot
2025-06-02 15:29:27,426 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870385.dot'.
2025-06-02 15:29:27,426 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870385.dot
2025-06-02 15:29:27,465 - INFO - Parsed 944 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870385.dot'.
2025-06-02 15:29:27,573 - INFO - Parsed 2034 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870385.dot'.
2025-06-02 15:29:27,574 - INFO - Processing node updates/additions.
2025-06-02 15:29:27,616 - INFO - Processing edge updates/additions.
2025-06-02 15:29:27,784 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:29:27,791 - INFO - Finished updating NetworkX graph.
2025-06-02 15:29:27,795 - DEBUG - Updated graph - Nodes: 944, Edges: 2034
2025-06-02 15:29:27,795 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:29:27,801 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:29:27,998 - DEBUG - Initial node features tensor shape: torch.Size([944, 30])
2025-06-02 15:29:28,001 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:29:28,002 - DEBUG - Node features tensor shape after scaling: torch.Size([944, 30])
2025-06-02 15:29:28,010 - DEBUG - Edge index tensor shape: torch.Size([2, 2034])
2025-06-02 15:29:28,028 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:29:28,117 - DEBUG - Initial edge attributes tensor shape: torch.Size([2034, 10])
2025-06-02 15:29:28,120 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:29:28,121 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2034, 10])
2025-06-02 15:29:28,121 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:29:28,122 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:29:28,125 - INFO - Updated main graph to 944 nodes and 2034 edges.
2025-06-02 15:29:28,126 - INFO - Performing online update...
2025-06-02 15:29:28,126 - INFO - Starting online update for 25 steps.
2025-06-02 15:29:28,127 - DEBUG - Updated RunningStats: new_mean=0.9445968346702539, new_var=24600000000161.99, new_n=2490
2025-06-02 15:29:28,128 - DEBUG - Updated RunningStats: new_mean=0.9421383733471721, new_var=24900000000017.93, new_n=2520
2025-06-02 15:29:28,128 - DEBUG - Updated RunningStats: new_mean=44.71039878558435, new_var=8200000187836.212, new_n=830
2025-06-02 15:29:28,129 - DEBUG - Updated RunningStats: new_mean=44.72511970001074, new_var=8300000183638.025, new_n=840
2025-06-02 15:29:28,129 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:29:28,129 - DEBUG - Online update step: 1/25
2025-06-02 15:29:28,137 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:28,263 - DEBUG - Node anomaly scores shape: torch.Size([18125, 1])
2025-06-02 15:29:28,292 - DEBUG - Edge anomaly scores shape: torch.Size([37806, 1])
2025-06-02 15:29:28,293 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:28,546 - DEBUG - Step 1: Loss=0.6604
2025-06-02 15:29:28,546 - DEBUG - Online update step: 2/25
2025-06-02 15:29:28,555 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:28,646 - DEBUG - Node anomaly scores shape: torch.Size([17571, 1])
2025-06-02 15:29:28,651 - DEBUG - Edge anomaly scores shape: torch.Size([36576, 1])
2025-06-02 15:29:28,652 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:28,848 - DEBUG - Step 2: Loss=0.7093
2025-06-02 15:29:28,849 - DEBUG - Online update step: 3/25
2025-06-02 15:29:28,857 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:28,947 - DEBUG - Node anomaly scores shape: torch.Size([16909, 1])
2025-06-02 15:29:28,951 - DEBUG - Edge anomaly scores shape: torch.Size([34936, 1])
2025-06-02 15:29:28,952 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:29,191 - DEBUG - Step 3: Loss=0.7098
2025-06-02 15:29:29,192 - DEBUG - Online update step: 4/25
2025-06-02 15:29:29,200 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:29,289 - DEBUG - Node anomaly scores shape: torch.Size([17285, 1])
2025-06-02 15:29:29,294 - DEBUG - Edge anomaly scores shape: torch.Size([35896, 1])
2025-06-02 15:29:29,295 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:29,503 - DEBUG - Step 4: Loss=0.6602
2025-06-02 15:29:29,504 - DEBUG - Online update step: 5/25
2025-06-02 15:29:29,517 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:29,615 - DEBUG - Node anomaly scores shape: torch.Size([18811, 1])
2025-06-02 15:29:29,619 - DEBUG - Edge anomaly scores shape: torch.Size([39258, 1])
2025-06-02 15:29:29,620 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:29,852 - DEBUG - Step 5: Loss=0.7198
2025-06-02 15:29:29,853 - DEBUG - Online update step: 6/25
2025-06-02 15:29:29,866 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:29,966 - DEBUG - Node anomaly scores shape: torch.Size([16943, 1])
2025-06-02 15:29:29,971 - DEBUG - Edge anomaly scores shape: torch.Size([35066, 1])
2025-06-02 15:29:29,973 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:30,198 - DEBUG - Step 6: Loss=0.7378
2025-06-02 15:29:30,199 - DEBUG - Online update step: 7/25
2025-06-02 15:29:30,213 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:30,326 - DEBUG - Node anomaly scores shape: torch.Size([19023, 1])
2025-06-02 15:29:30,332 - DEBUG - Edge anomaly scores shape: torch.Size([39596, 1])
2025-06-02 15:29:30,333 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:30,577 - DEBUG - Step 7: Loss=0.7062
2025-06-02 15:29:30,578 - DEBUG - Online update step: 8/25
2025-06-02 15:29:30,590 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:30,695 - DEBUG - Node anomaly scores shape: torch.Size([18597, 1])
2025-06-02 15:29:30,700 - DEBUG - Edge anomaly scores shape: torch.Size([38687, 1])
2025-06-02 15:29:30,702 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:30,922 - DEBUG - Step 8: Loss=0.6680
2025-06-02 15:29:30,923 - DEBUG - Online update step: 9/25
2025-06-02 15:29:30,932 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:31,030 - DEBUG - Node anomaly scores shape: torch.Size([17711, 1])
2025-06-02 15:29:31,034 - DEBUG - Edge anomaly scores shape: torch.Size([36845, 1])
2025-06-02 15:29:31,035 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:31,245 - DEBUG - Step 9: Loss=0.6818
2025-06-02 15:29:31,246 - DEBUG - Online update step: 10/25
2025-06-02 15:29:31,254 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:31,348 - DEBUG - Node anomaly scores shape: torch.Size([17498, 1])
2025-06-02 15:29:31,352 - DEBUG - Edge anomaly scores shape: torch.Size([36314, 1])
2025-06-02 15:29:31,354 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:31,567 - DEBUG - Step 10: Loss=0.6537
2025-06-02 15:29:31,568 - DEBUG - Online update step: 11/25
2025-06-02 15:29:31,576 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:31,665 - DEBUG - Node anomaly scores shape: torch.Size([16550, 1])
2025-06-02 15:29:31,669 - DEBUG - Edge anomaly scores shape: torch.Size([34285, 1])
2025-06-02 15:29:31,671 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:31,866 - DEBUG - Step 11: Loss=0.7056
2025-06-02 15:29:31,867 - DEBUG - Online update step: 12/25
2025-06-02 15:29:31,885 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:31,984 - DEBUG - Node anomaly scores shape: torch.Size([16475, 1])
2025-06-02 15:29:31,988 - DEBUG - Edge anomaly scores shape: torch.Size([34024, 1])
2025-06-02 15:29:31,990 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:32,204 - DEBUG - Step 12: Loss=0.7204
2025-06-02 15:29:32,205 - DEBUG - Online update step: 13/25
2025-06-02 15:29:32,214 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:32,310 - DEBUG - Node anomaly scores shape: torch.Size([17499, 1])
2025-06-02 15:29:32,314 - DEBUG - Edge anomaly scores shape: torch.Size([36435, 1])
2025-06-02 15:29:32,316 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:32,546 - DEBUG - Step 13: Loss=0.6868
2025-06-02 15:29:32,547 - DEBUG - Online update step: 14/25
2025-06-02 15:29:32,556 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:32,649 - DEBUG - Node anomaly scores shape: torch.Size([17091, 1])
2025-06-02 15:29:32,654 - DEBUG - Edge anomaly scores shape: torch.Size([35478, 1])
2025-06-02 15:29:32,655 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:32,880 - DEBUG - Step 14: Loss=0.6834
2025-06-02 15:29:32,881 - DEBUG - Online update step: 15/25
2025-06-02 15:29:32,894 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:33,004 - DEBUG - Node anomaly scores shape: torch.Size([18179, 1])
2025-06-02 15:29:33,008 - DEBUG - Edge anomaly scores shape: torch.Size([37607, 1])
2025-06-02 15:29:33,010 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:33,208 - DEBUG - Step 15: Loss=0.7075
2025-06-02 15:29:33,208 - DEBUG - Online update step: 16/25
2025-06-02 15:29:33,216 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:33,310 - DEBUG - Node anomaly scores shape: torch.Size([17231, 1])
2025-06-02 15:29:33,314 - DEBUG - Edge anomaly scores shape: torch.Size([35648, 1])
2025-06-02 15:29:33,316 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:33,521 - DEBUG - Step 16: Loss=0.6837
2025-06-02 15:29:33,522 - DEBUG - Online update step: 17/25
2025-06-02 15:29:33,533 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:33,627 - DEBUG - Node anomaly scores shape: torch.Size([17293, 1])
2025-06-02 15:29:33,631 - DEBUG - Edge anomaly scores shape: torch.Size([35791, 1])
2025-06-02 15:29:33,632 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:33,813 - DEBUG - Step 17: Loss=0.6884
2025-06-02 15:29:33,814 - DEBUG - Online update step: 18/25
2025-06-02 15:29:33,822 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:33,912 - DEBUG - Node anomaly scores shape: torch.Size([16879, 1])
2025-06-02 15:29:33,918 - DEBUG - Edge anomaly scores shape: torch.Size([34945, 1])
2025-06-02 15:29:33,919 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:34,130 - DEBUG - Step 18: Loss=0.7043
2025-06-02 15:29:34,131 - DEBUG - Online update step: 19/25
2025-06-02 15:29:34,144 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:34,243 - DEBUG - Node anomaly scores shape: torch.Size([17975, 1])
2025-06-02 15:29:34,247 - DEBUG - Edge anomaly scores shape: torch.Size([37338, 1])
2025-06-02 15:29:34,249 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:34,476 - DEBUG - Step 19: Loss=0.6740
2025-06-02 15:29:34,476 - DEBUG - Online update step: 20/25
2025-06-02 15:29:34,484 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:34,566 - DEBUG - Node anomaly scores shape: torch.Size([16430, 1])
2025-06-02 15:29:34,570 - DEBUG - Edge anomaly scores shape: torch.Size([33871, 1])
2025-06-02 15:29:34,571 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:34,764 - DEBUG - Step 20: Loss=0.6948
2025-06-02 15:29:34,765 - DEBUG - Online update step: 21/25
2025-06-02 15:29:34,773 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:34,871 - DEBUG - Node anomaly scores shape: torch.Size([17390, 1])
2025-06-02 15:29:34,875 - DEBUG - Edge anomaly scores shape: torch.Size([36324, 1])
2025-06-02 15:29:34,877 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:35,103 - DEBUG - Step 21: Loss=0.7126
2025-06-02 15:29:35,103 - DEBUG - Online update step: 22/25
2025-06-02 15:29:35,111 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:35,212 - DEBUG - Node anomaly scores shape: torch.Size([18368, 1])
2025-06-02 15:29:35,216 - DEBUG - Edge anomaly scores shape: torch.Size([38250, 1])
2025-06-02 15:29:35,218 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:35,445 - DEBUG - Step 22: Loss=0.6874
2025-06-02 15:29:35,445 - DEBUG - Online update step: 23/25
2025-06-02 15:29:35,454 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:35,548 - DEBUG - Node anomaly scores shape: torch.Size([18082, 1])
2025-06-02 15:29:35,553 - DEBUG - Edge anomaly scores shape: torch.Size([37784, 1])
2025-06-02 15:29:35,554 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:35,767 - DEBUG - Step 23: Loss=0.6782
2025-06-02 15:29:35,768 - DEBUG - Online update step: 24/25
2025-06-02 15:29:35,780 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:35,879 - DEBUG - Node anomaly scores shape: torch.Size([17261, 1])
2025-06-02 15:29:35,883 - DEBUG - Edge anomaly scores shape: torch.Size([35755, 1])
2025-06-02 15:29:35,884 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:36,085 - DEBUG - Step 24: Loss=0.6879
2025-06-02 15:29:36,086 - DEBUG - Online update step: 25/25
2025-06-02 15:29:36,098 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:36,197 - DEBUG - Node anomaly scores shape: torch.Size([18687, 1])
2025-06-02 15:29:36,202 - DEBUG - Edge anomaly scores shape: torch.Size([38991, 1])
2025-06-02 15:29:36,203 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:36,407 - DEBUG - Step 25: Loss=0.6589
2025-06-02 15:29:36,408 - INFO - Online update finished. Average loss: 0.6912, Learning rate: 0.001000
2025-06-02 15:29:36,409 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -2.0204965e-08 -2.0204965e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.5658847e-08
 -1.2122978e-08  2.3993396e-09 -1.9194717e-08 -3.0307445e-09
  2.3029661e+00  2.9618645e+00  1.3559322e-01  4.4152541e+00
 -3.7884307e-10  3.2870762e+00  5.8845339e+00  7.6080508e+00
  1.3559322e-01  7.9925847e+00 -2.2225461e-08 -6.0614891e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  8.0819857e-09 -2.0204965e-08], current edge mean: [-3.7509316e-09  4.5683286e+02  0.0000000e+00  0.0000000e+00
  1.8754658e-09 -9.3773289e-10 -4.6886641e-09 -4.6886641e-09
  0.0000000e+00  2.8131986e-09]
2025-06-02 15:29:36,410 - DEBUG - Node drift difference: 0.0128, Edge drift difference: 0.0012
2025-06-02 15:29:36,412 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -2.0204965e-08 -2.0204965e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.5658847e-08
 -1.2122978e-08  2.3993396e-09 -1.9194717e-08 -3.0307445e-09
  2.3029661e+00  2.9618645e+00  1.3559322e-01  4.4152541e+00
 -3.7884307e-10  3.2870762e+00  5.8845339e+00  7.6080508e+00
  1.3559322e-01  7.9925847e+00 -2.2225461e-08 -6.0614891e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  8.0819857e-09 -2.0204965e-08], edge=[-3.7509316e-09  4.5683286e+02  0.0000000e+00  0.0000000e+00
  1.8754658e-09 -9.3773289e-10 -4.6886641e-09 -4.6886641e-09
  0.0000000e+00  2.8131986e-09]
2025-06-02 15:29:36,413 - DEBUG - Updated reference std: node=[0.         0.         1.0005301  1.0005301  0.         0.
 0.         1.0005301  1.0005301  1.0005301  1.0005301  1.0005301
 1.0107334  0.27367172 0.36063462 0.5744843  1.0005301  2.9573143
 2.8775678  1.49335    0.36063462 0.22783059 1.0005301  1.0005301
 0.         0.         0.         0.         1.00053    1.00053   ], edge=[  1.0002459 452.46783     0.          0.          1.0002459   1.0002459
   1.0002459   1.0002459   1.0002459   1.0002459]
2025-06-02 15:29:36,426 - INFO - Online update complete. Loss: 0.6912
2025-06-02 15:29:36,427 - INFO - Running anomaly detection...
2025-06-02 15:29:36,428 - INFO - Starting anomaly detection.
2025-06-02 15:29:36,445 - DEBUG - Node reconstruction errors: [0.58238894 1.3957831  1.436802   0.04814867 0.07750694 0.07010148
 0.7084134  0.08086074 0.08086074 0.10831229 0.080862   0.05617006
 1.9794288  1.065507   0.05426188 0.05344307 0.18618642 0.05344306
 0.49457222 0.05009192 0.07141027 0.05426185 0.302172   0.06817015
 0.05393235 0.06814857 0.05393235 0.1451307  0.07898991 0.05393235
 0.6975165  0.3119752  0.10808022 0.05812709 0.21504833 0.14353205
 0.2244291  0.05009188 0.26325262 0.26301947 0.08081564 0.05028438
 0.05009188 0.13569674 1.147295   0.17751248 0.10910334 0.412261
 0.07679489 0.79516196 0.33610716 0.07691009 0.06525323 0.43491998
 0.05994928 0.1431031  1.0590042  0.04467384 0.5158541  0.5037234
 0.3992448  0.23353413 0.04694251 0.13429016 0.20814773 0.05994962
 0.0442431  0.05994942 0.04694251 0.31601852 0.0862176  0.07205324
 0.04884674 0.23169155 0.21393558 0.06928533 0.2808822  0.19737515
 0.03721318 0.04211217 0.05913186 0.07458623 0.88899046 0.19969998
 0.07564361 0.11325251 0.06981944 0.16724916 0.07052848 0.22349147
 0.04419089 0.07340697 0.02952248 0.1436155  0.10175269 0.28256252
 0.04804835 0.09445595 0.04187383 0.19712883 0.05855881 0.04804826
 0.08796423 0.35697317 0.13086279 0.05001822 0.15546209 0.10372837
 0.03063557 0.68891114 0.32079452 0.06107501 0.07337671 0.1439107
 0.04955108 0.04244602 0.05064528 0.11435863 0.12407205 0.04184592
 0.04349692 0.02759494 0.15127261 0.06062484 0.1297794  0.04184844
 0.06322674 0.13821496 0.13196273 0.04667173 0.06285404 0.04783335
 1.2017248  0.27149767 0.04581715 0.05722477 0.09194439 0.0415649
 0.17064361 0.15765645 0.15526313 0.05698753 0.04711912 0.10412422
 0.15526313 0.13732843 0.05064534 0.20636824 0.1421469  0.1292141
 0.56792575 0.11910231 0.06009695 0.04783335 0.06088176 0.08120234
 0.04006469 0.07256664 0.05855883 0.08645257 0.15526302 0.12136824
 0.04006469 0.06285404 0.05201193 0.09146591 0.0616149  0.03441564
 0.12811063 0.12921423 0.04895119 0.04276727 0.04149573 0.30597228
 0.12407253 9.19837    0.04376055 0.07260077 0.05578477 0.05578484
 0.04890118 0.06010145 0.10345158 0.20444146 0.05591332 0.06112513
 0.04454759 0.07145714 0.05602225 0.03859009 0.05748253 0.12745182
 0.12629355 0.04273362 0.17064281 0.04936101 0.97804695 0.20318721
 0.12815131 0.16907732 0.03411391 0.04006469 0.07162283 0.15298384
 0.12299853 0.0996069  0.08746503 0.24010691 0.0437658  0.05227283
 0.04909646 0.13391396 0.05974966 0.06944135 0.07705404 0.04287098
 0.11412302 0.0506453  0.15559348 0.04273362 0.21787192 0.04454759
 0.03943121 0.05974961 0.04006466 0.1380167  0.12417543 0.04675207
 0.05036989 0.08074093 0.10124771 0.08711836 0.14743015 0.05064525
 0.05064526 0.08017197 0.05272352 0.03943127 0.04006469 0.20676877
 0.08471169 0.16931874 0.05327801 0.13457423 0.04578489 0.15277123
 0.06514605 0.06382656 0.0532779  0.05376572 0.04149556 0.03175259
 0.1555934  0.03894915 0.14492936 0.06495256 0.0385901  0.04390559
 0.16665484 0.0557848  0.04223448 0.06301929 0.02568169 0.11612929
 0.10128808 0.13149418 0.09125015 0.7255482  0.0912502  0.05598018
 0.21976103 0.17095207 0.06582404 0.18500918 0.05629209 0.16118088
 0.02428338 0.1394995  0.04890118 0.06411762 0.19022815 0.02382311
 0.03911434 0.0842937  0.15422629 0.05792112 0.29282174 0.09009325
 0.06010139 0.8113912  0.14688243 0.05412134 0.08775428 0.04578489
 1.1463029  0.05629675 0.04747476 0.05578616 0.04936082 1.175852
 0.04153823 0.19598423 0.05224803 0.08138714 0.03695289 0.03695297
 0.03695289 0.06190738 0.15327477 0.19598415 0.03695293 0.05213309
 0.03695289 0.03731567 0.09787378 0.06030033 0.2161773  0.03888969
 0.05968357 0.04935847 0.10987232 0.06728949 0.13133769 0.05224774
 0.09633183 0.18665235 0.2207799  0.06595867 0.05988225 0.05988254
 0.23648405 0.04906872 0.03695289 0.05629197 0.03695289 0.0619075
 0.06968974 0.02988028 0.2232396  0.03914076 0.19598402 0.0197646
 0.03914066 0.15105537 0.07844024 0.11412354 0.05224782 0.05750512
 0.08686657 0.04356461 0.03695297 0.05404593 0.06569126 0.07059208
 0.01827417 0.0385901  0.19598415 0.03695289 0.03942987 0.21082337
 0.09974781 0.04515257 0.12550308 0.09348873 0.05224813 0.5815002
 0.03727771 0.06186764 0.05244087 0.04000309 0.06046657 0.0844952
 0.1262141  0.06355632 0.11509994 0.07059003 0.03751026 0.05346946
 0.06244164 0.03695297 0.05224787 0.09665219 0.0444458  0.04174668
 0.09197164 0.08094499 0.09121078 0.06555859 0.071156   0.03695297
 0.14556633 0.09850921 0.05093108 0.1178953  0.06710267 0.0671026
 0.06710267 0.49821314 0.03482251 0.50923735 0.03581387 0.08959468
 0.09264253 0.03482236 0.05678326 0.05093109 0.12033426 0.03493936
 0.05093113 0.09239414 0.06710266 0.05093109 0.03482251 0.06710272
 0.06710269 0.02541926 0.01899253 0.06710257 0.03750714 0.09924032
 0.06408637 0.03719461 0.0431029  0.04315157 0.1273368  0.07603728
 0.04692114 0.06074698 0.13667701 0.0218125  0.09151399 0.04745426
 0.05433819 0.06142085 0.11495576 0.06710258 0.03581386 0.07901285
 0.13683192 0.10891284 0.08278311 0.05205202 0.13947122 0.03857655
 0.11253975 0.04928097 0.1705914  0.04005804 0.05913908 0.04354695
 0.09666618 0.0345219  0.04685605 0.14844976 0.0345219  0.05506989
 0.04315156 0.07160633 0.0695553  0.11805744 0.05056379 0.04771645
 0.04208133 0.05681777 0.04208134 0.04771639 0.02684117 0.04326961
 0.0893546  0.05872792 0.02684132 0.05056371 0.07160328 0.30083627
 0.09651545 0.04310285 0.04326956 0.05056381 0.0340062  0.05194331
 0.06235067 0.24020578 0.08496189 0.0400581  0.12734339 0.04109106
 0.0345219  0.10369169 0.03387581 0.30083308 0.0520114  0.03400616
 0.04771237 0.0371539  0.09209469 0.0445482  0.04881001 0.4686514
 0.03285581 0.05194326 0.12533818 0.0371539  0.15314911 0.0223984
 0.02543897 0.04363891 0.0321087  0.4235019  0.04649992 0.03452189
 0.02908753 0.04716982 0.04716982 0.04341428 0.06606085 0.07016185
 0.03210861 0.04861294 0.0937978  0.07854895 0.0771127  0.05205197
 0.0321085  0.0871365  0.02543899 0.04881    0.06363395 0.08764365
 0.07711267 0.08425138 0.07016185 0.12127019 0.03285589 0.05194331
 0.04880999 0.04907827 0.06472874 0.08860215 0.03285579 0.06259914
 0.03285585 0.08613696 0.12322661 0.04861295 0.04294922 0.2443847
 0.08947828 0.03127215 0.94399035 0.0312723  0.03127215 0.03127215
 0.03127218 0.03127226 0.03127215 0.0312723  0.05674429 0.04146665
 0.03650202 0.0312723  0.0312723  0.03127217 0.03127226 0.03127217
 0.03127215 0.0312723  0.03127215 0.03127215 0.04708297 0.03127226
 0.03127218 0.09453355 0.03127218 0.04953853 0.04086296 0.03285589
 0.08936416 0.04735911 0.40730378 0.40730378 0.0887448  0.08936416
 0.03285589 0.0321087  0.03210864 0.03285581 0.03210864 0.06733339
 0.03651289 0.03127215 0.05205197 0.03285589 0.0471699  0.03285581
 0.03285581 0.0925811  0.03285589 0.0321085  0.03285589 0.03285581
 0.04861285 0.03210864 0.03285589 0.03210864 0.03285581 0.03285581
 0.03285581 0.08506663 0.11323051 0.04136218 0.03127215 0.0638914
 0.05799848 0.03285589 0.0321087  0.08037648 0.03127215 0.05396622
 0.07846092 0.03352301 0.03285589 0.03285589 0.04836262 0.09525526
 0.03245347 0.03285581 0.05674422 0.04230778 0.03210864 0.07228108
 0.03127218 0.05900472 0.09055292 0.03127215 0.03127215 0.05674421
 0.04230778 0.03285589 0.14702865 0.08595084 0.07884403 0.09525526
 0.05946966 0.06017112 0.06017115 0.04035757 0.04871391 0.03127215
 0.04663397 0.0345566  0.09525518 0.04080103 0.05767498 0.06683502
 0.03061949 0.03061949 0.03061944 0.03061941 0.03061953 0.04531377
 0.03622474 0.03061953 0.03061949 0.03127218 0.0409066  0.0312723
 0.0601711  0.08652217 0.06221842 0.02553023 0.06386637 0.11451172
 0.04708311 0.03591166 0.04708309 0.03127218 0.06017115 0.02425964
 0.03089165 0.03089164 0.03061941 0.02425962 0.0771931  0.05639978
 0.06838377 0.03127215 0.03061941 0.0791686  0.03089165 0.03575397
 0.03226723 0.07021572 0.0453138  0.31377855 0.02682224 0.10890396
 0.0350945  0.03226723 0.03045151 0.02357216 0.03138598 0.03976484
 0.05339052 0.0670073  0.05678032 0.03226722 0.03226722 0.03226716
 0.0314144  0.0791686  0.03226722 0.03138605 0.03226722 0.03226723
 0.03226722 0.03935928 0.02297605 0.06193559 0.09851482 0.05508548
 0.03775375 0.09206515 0.07187346 0.5045329  0.03078888 0.02283962
 0.03956206 0.07334127 0.07334127 0.03138605 0.1285977  0.16195753
 0.03078472 0.02967798 0.02275619 0.10071569 0.02286535 0.02286535
 0.02286534 0.02980084 0.02988387 0.07448391 0.09985656 0.15381102
 0.07158734 0.03449082 0.04579015 0.02967798 0.03746108 0.03529095
 0.02981142 0.07867294 0.03078472 0.16195644 0.02967798 0.03529102
 0.03449076 0.05543858 0.02286534 0.02980084 0.02981142 0.05099193
 0.0748122  0.02980084 0.02980084 0.02980077 0.09877388 1.0880623
 2.0407546  0.02286538 0.16956295 0.02980084 0.05527166 0.04653158
 0.5408442  0.05220466 0.02980084 0.02981173 0.04084005 0.03059615
 0.25341743 0.05220456 0.3457235  0.07003828 0.10217243 0.05220457
 0.04638118 0.07666314 0.04758378 0.11076815 0.04349386 0.03071821
 0.03071821 0.16354337 0.19395778 0.06986643 0.05220457 0.04758378
 0.05220457 0.03096185 0.03126798 0.03126798 0.03014447 0.11950783
 0.03554929 0.03126798 0.03096186 0.1108539  0.03126799 0.03126798
 0.03024534 0.08550905 0.12003116 0.09519196 0.03126799 0.05097516
 0.1108539  0.03126798 0.03092211 0.04057074 0.03222591 0.03222591
 0.10416088 0.04057084 0.03126798 0.04057084 0.04461514 0.10987074
 0.12353824 0.031268   0.17618455 0.04150151 0.04150146 0.08550908
 0.02953686 0.04534921 0.03092211 0.08191779 0.0288489  0.08146226
 0.05165255 0.08146238 0.2427472  0.02858716 0.05165272 0.02821806
 0.02821794 0.6039007  0.02821902 0.04590875 0.02953688 0.07577377
 0.04802007 0.02858721 0.04802013 0.07115984 0.09937426 0.09158525
 0.02821914 0.08150253 0.07718392 0.02821794 0.11725985 0.0717874
 0.08150268 0.02858732 0.02821902 0.17199306 0.02821907 0.02821794
 0.02821907 0.02956696 0.05277178 0.02956696 0.04305148 0.02956696
 0.05150849 0.05975623 0.12502332 0.02821914 0.02821914 0.02948654
 0.02821794 0.3805458  0.0430512  0.0295669  0.02948662 0.02821903
 0.02821806 0.01932097 0.02948658 0.02821914 0.02662617 0.0549323
 0.02830444 0.35650092 0.02662621 0.02821907 0.02821794 0.02027419
 0.04999819 0.05314992 0.05314982 0.0285507  0.08331351 0.0940458
 0.04817    0.24929483 0.05314985 0.02965441 0.05314982 0.08564217
 0.04817001 0.05314984 0.03034324 0.02830444 0.04934334 0.02828464
 0.03115118 0.02989734 0.09052335 0.02581028 0.03450034 0.03450033
 0.07107226 0.03450033 0.03450034 0.03450034 0.03450033 0.07339695
 0.03450035 0.03450033 0.03450033 0.03450033 0.03450035 0.03450035
 0.03450033 0.03450033 0.03450035 0.06128121 0.03450034 0.03450033
 0.03450035 0.03450035]
2025-06-02 15:29:36,447 - DEBUG - Edge reconstruction errors: [ 5.264819   5.262197  44.258453  ... 13.358432   2.1593838 13.358432 ]
2025-06-02 15:29:36,450 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152936_update_43.json
2025-06-02 15:29:36,451 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:29:36,494 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152936_update_43.pth
2025-06-02 15:29:36,494 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870385.dot): 0.9319
2025-06-02 15:29:36,495 - WARNING - Detected 13 anomalous nodes (reconstruction-based):
2025-06-02 15:29:36,495 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.3958, MLP Score: 0.4315
2025-06-02 15:29:36,495 - WARNING -   Node ID: 192.168.27.13, Recon Error: 1.4368, MLP Score: 0.5052
2025-06-02 15:29:36,496 - WARNING -   Node ID: 192.168.27.10, Recon Error: 1.9794, MLP Score: 0.5056
2025-06-02 15:29:36,496 - WARNING -   Node ID: 8.8.8.8, Recon Error: 1.0655, MLP Score: 0.5369
2025-06-02 15:29:36,496 - WARNING -   Node ID: 113.171.234.51, Recon Error: 1.1473, MLP Score: 0.5241
2025-06-02 15:29:36,497 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:29:36,497 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2584, MLP Score: 0.0062
2025-06-02 15:29:36,498 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9611, MLP Score: 0.0008
2025-06-02 15:29:36,498 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0607, MLP Score: 0.0008
2025-06-02 15:29:36,499 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7593, MLP Score: 0.0003
2025-06-02 15:29:36,499 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7588, MLP Score: 0.0003
2025-06-02 15:29:36,499 - INFO - 
--- Processing file: nw_graph_encoded_1748870415.dot (Timestamp: 2025-06-02 15:20:15) ---
2025-06-02 15:29:36,500 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870415.dot
2025-06-02 15:29:36,500 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870415.dot'.
2025-06-02 15:29:36,500 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870415.dot
2025-06-02 15:29:36,541 - INFO - Parsed 957 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870415.dot'.
2025-06-02 15:29:36,652 - INFO - Parsed 2059 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870415.dot'.
2025-06-02 15:29:36,653 - INFO - Processing node updates/additions.
2025-06-02 15:29:36,697 - INFO - Processing edge updates/additions.
2025-06-02 15:29:36,866 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:29:36,873 - INFO - Finished updating NetworkX graph.
2025-06-02 15:29:36,877 - DEBUG - Updated graph - Nodes: 957, Edges: 2059
2025-06-02 15:29:36,877 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:29:36,884 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:29:37,074 - DEBUG - Initial node features tensor shape: torch.Size([957, 30])
2025-06-02 15:29:37,082 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:29:37,085 - DEBUG - Node features tensor shape after scaling: torch.Size([957, 30])
2025-06-02 15:29:37,096 - DEBUG - Edge index tensor shape: torch.Size([2, 2059])
2025-06-02 15:29:37,114 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:29:37,210 - DEBUG - Initial edge attributes tensor shape: torch.Size([2059, 10])
2025-06-02 15:29:37,217 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:29:37,221 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2059, 10])
2025-06-02 15:29:37,222 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:29:37,223 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:29:37,227 - INFO - Updated main graph to 957 nodes and 2059 edges.
2025-06-02 15:29:37,227 - INFO - Performing online update...
2025-06-02 15:29:37,228 - INFO - Starting online update for 25 steps.
2025-06-02 15:29:37,230 - DEBUG - Updated RunningStats: new_mean=0.944677028690125, new_var=25200000000162.082, new_n=2550
2025-06-02 15:29:37,230 - DEBUG - Updated RunningStats: new_mean=0.9422583820159048, new_var=25500000000017.926, new_n=2580
2025-06-02 15:29:37,231 - DEBUG - Updated RunningStats: new_mean=44.73619462878942, new_var=8400000187697.295, new_n=850
2025-06-02 15:29:37,231 - DEBUG - Updated RunningStats: new_mean=44.74707082630964, new_var=8500000181399.229, new_n=860
2025-06-02 15:29:37,232 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:29:37,232 - DEBUG - Online update step: 1/25
2025-06-02 15:29:37,245 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:37,400 - DEBUG - Node anomaly scores shape: torch.Size([17074, 1])
2025-06-02 15:29:37,419 - DEBUG - Edge anomaly scores shape: torch.Size([35295, 1])
2025-06-02 15:29:37,422 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:37,687 - DEBUG - Step 1: Loss=0.7023
2025-06-02 15:29:37,687 - DEBUG - Online update step: 2/25
2025-06-02 15:29:37,699 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:37,808 - DEBUG - Node anomaly scores shape: torch.Size([18476, 1])
2025-06-02 15:29:37,814 - DEBUG - Edge anomaly scores shape: torch.Size([38415, 1])
2025-06-02 15:29:37,816 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:38,053 - DEBUG - Step 2: Loss=0.7121
2025-06-02 15:29:38,054 - DEBUG - Online update step: 3/25
2025-06-02 15:29:38,067 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:38,187 - DEBUG - Node anomaly scores shape: torch.Size([20371, 1])
2025-06-02 15:29:38,192 - DEBUG - Edge anomaly scores shape: torch.Size([42700, 1])
2025-06-02 15:29:38,194 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:38,467 - DEBUG - Step 3: Loss=0.6806
2025-06-02 15:29:38,467 - DEBUG - Online update step: 4/25
2025-06-02 15:29:38,482 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:38,575 - DEBUG - Node anomaly scores shape: torch.Size([17149, 1])
2025-06-02 15:29:38,580 - DEBUG - Edge anomaly scores shape: torch.Size([35613, 1])
2025-06-02 15:29:38,581 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:38,779 - DEBUG - Step 4: Loss=0.6753
2025-06-02 15:29:38,780 - DEBUG - Online update step: 5/25
2025-06-02 15:29:38,794 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:38,892 - DEBUG - Node anomaly scores shape: torch.Size([16022, 1])
2025-06-02 15:29:38,897 - DEBUG - Edge anomaly scores shape: torch.Size([33017, 1])
2025-06-02 15:29:38,898 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:39,100 - DEBUG - Step 5: Loss=0.6882
2025-06-02 15:29:39,100 - DEBUG - Online update step: 6/25
2025-06-02 15:29:39,110 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:39,236 - DEBUG - Node anomaly scores shape: torch.Size([17695, 1])
2025-06-02 15:29:39,242 - DEBUG - Edge anomaly scores shape: torch.Size([36793, 1])
2025-06-02 15:29:39,243 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:39,473 - DEBUG - Step 6: Loss=0.6566
2025-06-02 15:29:39,473 - DEBUG - Online update step: 7/25
2025-06-02 15:29:39,484 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:39,580 - DEBUG - Node anomaly scores shape: torch.Size([18748, 1])
2025-06-02 15:29:39,586 - DEBUG - Edge anomaly scores shape: torch.Size([39111, 1])
2025-06-02 15:29:39,587 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:39,824 - DEBUG - Step 7: Loss=0.6908
2025-06-02 15:29:39,825 - DEBUG - Online update step: 8/25
2025-06-02 15:29:39,833 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:39,944 - DEBUG - Node anomaly scores shape: torch.Size([18451, 1])
2025-06-02 15:29:39,951 - DEBUG - Edge anomaly scores shape: torch.Size([38434, 1])
2025-06-02 15:29:39,953 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:40,179 - DEBUG - Step 8: Loss=0.7041
2025-06-02 15:29:40,179 - DEBUG - Online update step: 9/25
2025-06-02 15:29:40,188 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:40,287 - DEBUG - Node anomaly scores shape: torch.Size([17357, 1])
2025-06-02 15:29:40,292 - DEBUG - Edge anomaly scores shape: torch.Size([35945, 1])
2025-06-02 15:29:40,293 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:40,486 - DEBUG - Step 9: Loss=0.6663
2025-06-02 15:29:40,487 - DEBUG - Online update step: 10/25
2025-06-02 15:29:40,496 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:40,617 - DEBUG - Node anomaly scores shape: torch.Size([18347, 1])
2025-06-02 15:29:40,622 - DEBUG - Edge anomaly scores shape: torch.Size([38229, 1])
2025-06-02 15:29:40,623 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:40,877 - DEBUG - Step 10: Loss=0.6717
2025-06-02 15:29:40,877 - DEBUG - Online update step: 11/25
2025-06-02 15:29:40,885 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:41,016 - DEBUG - Node anomaly scores shape: torch.Size([16673, 1])
2025-06-02 15:29:41,022 - DEBUG - Edge anomaly scores shape: torch.Size([34382, 1])
2025-06-02 15:29:41,023 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:41,290 - DEBUG - Step 11: Loss=0.6916
2025-06-02 15:29:41,290 - DEBUG - Online update step: 12/25
2025-06-02 15:29:41,298 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:41,435 - DEBUG - Node anomaly scores shape: torch.Size([17217, 1])
2025-06-02 15:29:41,443 - DEBUG - Edge anomaly scores shape: torch.Size([35679, 1])
2025-06-02 15:29:41,444 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:41,756 - DEBUG - Step 12: Loss=0.6581
2025-06-02 15:29:41,757 - DEBUG - Online update step: 13/25
2025-06-02 15:29:41,765 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:41,877 - DEBUG - Node anomaly scores shape: torch.Size([17686, 1])
2025-06-02 15:29:41,881 - DEBUG - Edge anomaly scores shape: torch.Size([36714, 1])
2025-06-02 15:29:41,883 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:42,157 - DEBUG - Step 13: Loss=0.6786
2025-06-02 15:29:42,158 - DEBUG - Online update step: 14/25
2025-06-02 15:29:42,167 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:42,262 - DEBUG - Node anomaly scores shape: torch.Size([17876, 1])
2025-06-02 15:29:42,266 - DEBUG - Edge anomaly scores shape: torch.Size([37066, 1])
2025-06-02 15:29:42,268 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:42,460 - DEBUG - Step 14: Loss=0.6990
2025-06-02 15:29:42,461 - DEBUG - Online update step: 15/25
2025-06-02 15:29:42,470 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:42,598 - DEBUG - Node anomaly scores shape: torch.Size([17804, 1])
2025-06-02 15:29:42,603 - DEBUG - Edge anomaly scores shape: torch.Size([37165, 1])
2025-06-02 15:29:42,605 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:42,866 - DEBUG - Step 15: Loss=0.6661
2025-06-02 15:29:42,866 - DEBUG - Online update step: 16/25
2025-06-02 15:29:42,876 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:42,980 - DEBUG - Node anomaly scores shape: torch.Size([17950, 1])
2025-06-02 15:29:42,986 - DEBUG - Edge anomaly scores shape: torch.Size([37372, 1])
2025-06-02 15:29:42,988 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:43,252 - DEBUG - Step 16: Loss=0.6691
2025-06-02 15:29:43,253 - DEBUG - Online update step: 17/25
2025-06-02 15:29:43,265 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:43,361 - DEBUG - Node anomaly scores shape: torch.Size([17476, 1])
2025-06-02 15:29:43,366 - DEBUG - Edge anomaly scores shape: torch.Size([36100, 1])
2025-06-02 15:29:43,368 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:43,654 - DEBUG - Step 17: Loss=0.6912
2025-06-02 15:29:43,655 - DEBUG - Online update step: 18/25
2025-06-02 15:29:43,667 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:43,756 - DEBUG - Node anomaly scores shape: torch.Size([16604, 1])
2025-06-02 15:29:43,759 - DEBUG - Edge anomaly scores shape: torch.Size([34378, 1])
2025-06-02 15:29:43,761 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:43,960 - DEBUG - Step 18: Loss=0.6635
2025-06-02 15:29:43,961 - DEBUG - Online update step: 19/25
2025-06-02 15:29:43,975 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:44,085 - DEBUG - Node anomaly scores shape: torch.Size([17158, 1])
2025-06-02 15:29:44,090 - DEBUG - Edge anomaly scores shape: torch.Size([35685, 1])
2025-06-02 15:29:44,091 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:44,363 - DEBUG - Step 19: Loss=0.6715
2025-06-02 15:29:44,364 - DEBUG - Online update step: 20/25
2025-06-02 15:29:44,376 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:44,480 - DEBUG - Node anomaly scores shape: torch.Size([17941, 1])
2025-06-02 15:29:44,485 - DEBUG - Edge anomaly scores shape: torch.Size([37323, 1])
2025-06-02 15:29:44,487 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:44,702 - DEBUG - Step 20: Loss=0.6900
2025-06-02 15:29:44,703 - DEBUG - Online update step: 21/25
2025-06-02 15:29:44,711 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:44,818 - DEBUG - Node anomaly scores shape: torch.Size([17165, 1])
2025-06-02 15:29:44,823 - DEBUG - Edge anomaly scores shape: torch.Size([35698, 1])
2025-06-02 15:29:44,824 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:45,058 - DEBUG - Step 21: Loss=0.6619
2025-06-02 15:29:45,058 - DEBUG - Online update step: 22/25
2025-06-02 15:29:45,070 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:45,178 - DEBUG - Node anomaly scores shape: torch.Size([18128, 1])
2025-06-02 15:29:45,183 - DEBUG - Edge anomaly scores shape: torch.Size([37711, 1])
2025-06-02 15:29:45,185 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:45,424 - DEBUG - Step 22: Loss=0.6727
2025-06-02 15:29:45,424 - DEBUG - Online update step: 23/25
2025-06-02 15:29:45,433 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:45,536 - DEBUG - Node anomaly scores shape: torch.Size([18828, 1])
2025-06-02 15:29:45,541 - DEBUG - Edge anomaly scores shape: torch.Size([39336, 1])
2025-06-02 15:29:45,543 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:45,758 - DEBUG - Step 23: Loss=0.6881
2025-06-02 15:29:45,759 - DEBUG - Online update step: 24/25
2025-06-02 15:29:45,768 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:45,873 - DEBUG - Node anomaly scores shape: torch.Size([18934, 1])
2025-06-02 15:29:45,877 - DEBUG - Edge anomaly scores shape: torch.Size([39506, 1])
2025-06-02 15:29:45,879 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:46,129 - DEBUG - Step 24: Loss=0.6592
2025-06-02 15:29:46,130 - DEBUG - Online update step: 25/25
2025-06-02 15:29:46,138 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:46,251 - DEBUG - Node anomaly scores shape: torch.Size([19421, 1])
2025-06-02 15:29:46,257 - DEBUG - Edge anomaly scores shape: torch.Size([40674, 1])
2025-06-02 15:29:46,260 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:46,508 - DEBUG - Step 25: Loss=0.6667
2025-06-02 15:29:46,509 - INFO - Online update finished. Average loss: 0.6790, Learning rate: 0.001000
2025-06-02 15:29:46,512 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  3.4130977e-08  7.4739365e-10
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.9860995e-09
 -5.9791492e-09  4.6089275e-09 -9.9652486e-10  1.4449611e-08
  2.2967608e+00  2.9623826e+00  1.3688610e-01  4.4158831e+00
 -1.6193530e-09  3.3009405e+00  5.8819227e+00  7.6133752e+00
  1.3688610e-01  7.9926853e+00 -1.1709168e-08 -2.1923547e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -4.9826244e-08], current edge mean: [-2.7790412e-09  4.5666489e+02  0.0000000e+00  0.0000000e+00
 -4.6317354e-09  0.0000000e+00  9.2634705e-10 -4.6317353e-10
 -6.6002230e-09  9.2634705e-10]
2025-06-02 15:29:46,512 - DEBUG - Node drift difference: 0.0061, Edge drift difference: 0.0004
2025-06-02 15:29:46,515 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  3.4130977e-08  7.4739365e-10
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.9860995e-09
 -5.9791492e-09  4.6089275e-09 -9.9652486e-10  1.4449611e-08
  2.2967608e+00  2.9623826e+00  1.3688610e-01  4.4158831e+00
 -1.6193530e-09  3.3009405e+00  5.8819227e+00  7.6133752e+00
  1.3688610e-01  7.9926853e+00 -1.1709168e-08 -2.1923547e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -4.9826244e-08], edge=[-2.7790412e-09  4.5666489e+02  0.0000000e+00  0.0000000e+00
 -4.6317354e-09  0.0000000e+00  9.2634705e-10 -4.6317353e-10
 -6.6002230e-09  9.2634705e-10]
2025-06-02 15:29:46,517 - DEBUG - Updated reference std: node=[0.         0.         1.0005229  1.0005229  0.         0.
 0.         1.0005229  1.0005229  1.0005229  1.0005229  1.0005229
 0.97763693 0.27184048 0.36169627 0.5735438  1.0005229  2.9591587
 2.8782218  1.4838562  0.36169627 0.22627786 1.0005229  1.0005229
 0.         0.         0.         0.         1.0005229  1.0005229 ], edge=[  1.000243  449.71378     0.          0.          1.0002428   1.000243
   1.000243    1.000243    1.000243    1.000243 ]
2025-06-02 15:29:46,517 - INFO - Online update complete. Loss: 0.6790
2025-06-02 15:29:46,518 - INFO - Running anomaly detection...
2025-06-02 15:29:46,519 - INFO - Starting anomaly detection.
2025-06-02 15:29:46,556 - DEBUG - Node reconstruction errors: [5.72987676e-01 1.83995128e+00 1.50695503e+00 1.41070951e-02
 6.60031289e-02 5.74212633e-02 6.86439931e-01 4.21019606e-02
 4.21018265e-02 5.16046211e-02 4.21019197e-02 5.94277643e-02
 1.86892760e+00 1.07422280e+00 1.12831863e-02 4.82168905e-02
 1.42176956e-01 4.82168123e-02 3.34760725e-01 4.71808501e-02
 3.35232839e-02 1.12832086e-02 2.96411037e-01 4.70577553e-02
 1.16213113e-02 2.15890650e-02 1.16213113e-02 1.48721322e-01
 4.23034541e-02 1.16213113e-02 5.37401974e-01 3.42225075e-01
 1.39300242e-01 1.61010660e-02 1.71492592e-01 2.42145792e-01
 1.96194619e-01 4.71809134e-02 2.40356579e-01 1.82493687e-01
 2.88667455e-02 9.41687822e-03 4.71809134e-02 7.47892857e-02
 1.13524067e+00 1.22050501e-01 5.98745532e-02 3.64656180e-01
 4.22640964e-02 6.82420194e-01 2.19293535e-01 2.58315578e-02
 2.19190381e-02 2.79420644e-01 4.94915359e-02 1.23422667e-01
 9.38890278e-01 4.57020812e-02 3.33751380e-01 3.18976015e-01
 3.24605376e-01 2.67757028e-01 7.73628987e-03 1.14442781e-01
 1.82833165e-01 4.94915172e-02 2.86560785e-02 4.94919457e-02
 7.73628987e-03 2.41130754e-01 7.44890794e-02 6.11278489e-02
 1.54187139e-02 1.98226660e-01 1.99222356e-01 5.79927452e-02
 2.03636199e-01 1.82837561e-01 2.96421815e-02 3.62979062e-02
 1.48046967e-02 5.72453476e-02 8.25764537e-01 7.00687990e-02
 6.60262480e-02 7.47913793e-02 6.83479160e-02 1.42914489e-01
 6.39891773e-02 1.90564662e-01 7.40044750e-03 5.34385517e-02
 2.26335172e-02 1.41980127e-01 7.78220519e-02 2.22484261e-01
 1.36881294e-02 7.96328560e-02 5.16904006e-03 1.45743668e-01
 5.02015352e-02 1.36881294e-02 3.39357369e-02 3.29379082e-01
 9.55516919e-02 2.58500539e-02 1.16541773e-01 7.86249340e-02
 2.52203867e-02 7.10770547e-01 2.63747990e-01 1.63913574e-02
 5.90760149e-02 1.20908566e-01 4.24436331e-02 3.78479771e-02
 4.35135700e-02 1.03524670e-01 1.05582528e-01 2.85609253e-02
 7.46229570e-03 2.21776776e-02 1.30581081e-01 3.98980528e-02
 1.16370246e-01 2.85614524e-02 4.73456010e-02 1.07327566e-01
 1.12941615e-01 4.05976288e-02 1.75339282e-02 1.51419444e-02
 1.18473971e+00 2.33807534e-01 3.93570624e-02 2.49104407e-02
 3.79555635e-02 5.15634893e-03 1.58323899e-01 1.37326211e-01
 1.05203398e-01 5.29579595e-02 1.06011042e-02 5.94328232e-02
 1.05203360e-01 1.36615813e-01 4.35135402e-02 1.93911523e-01
 8.75969827e-02 1.15622833e-01 4.78830010e-01 8.51526260e-02
 4.94027883e-02 1.51419435e-02 4.88027371e-02 7.86236376e-02
 1.32113807e-02 5.64659126e-02 5.02015240e-02 3.31531167e-02
 1.05203353e-01 7.88538754e-02 1.32113807e-02 1.75340101e-02
 4.44729961e-02 7.07449391e-02 5.03466055e-02 3.06022167e-02
 8.25482756e-02 1.15622878e-01 4.28922586e-02 2.87659261e-02
 6.22372562e-03 2.56342143e-01 1.05583049e-01 9.19692898e+00
 3.41686718e-02 6.32947981e-02 4.76257354e-02 4.76257317e-02
 2.49996874e-02 5.29924221e-02 8.77257735e-02 1.81075484e-01
 5.07700555e-02 4.96094488e-02 9.28114913e-03 5.75438179e-02
 2.48274915e-02 1.21128084e-02 4.80174683e-02 1.26398727e-01
 7.71009102e-02 2.01052632e-02 1.58321694e-01 1.35053927e-02
 9.19160187e-01 1.42356858e-01 6.44411892e-02 1.33505195e-01
 2.89703347e-02 1.32113807e-02 5.18409498e-02 1.30920723e-01
 1.05518304e-01 6.40939325e-02 4.70941626e-02 2.26666600e-01
 6.79147663e-03 4.24689054e-02 4.19235826e-02 1.16566196e-01
 2.48031076e-02 5.29813543e-02 7.07494244e-02 1.46791656e-02
 9.80288237e-02 4.35135812e-02 1.33222267e-01 2.01052632e-02
 2.05866277e-01 9.28114913e-03 5.15470887e-03 2.48031151e-02
 1.32113807e-02 1.21559925e-01 1.10326886e-01 2.56996173e-02
 4.45484780e-02 5.49716912e-02 6.07210398e-02 7.66826347e-02
 1.28191203e-01 4.35136035e-02 4.35136296e-02 4.51404899e-02
 4.12369631e-02 5.15470002e-03 1.32113807e-02 1.46216482e-01
 7.66143352e-02 1.47182733e-01 2.37150546e-02 1.22756146e-01
 2.49801669e-02 1.38935566e-01 5.08591607e-02 6.07041530e-02
 2.37150546e-02 3.59043069e-02 6.22373028e-03 5.49217546e-03
 1.33222371e-01 3.18532363e-02 1.26178101e-01 5.94419166e-02
 1.21128149e-02 8.75286944e-03 1.18649721e-01 4.76257876e-02
 3.53611372e-02 6.63972721e-02 2.33182311e-02 1.02060743e-01
 8.55421349e-02 1.04576066e-01 7.94394016e-02 5.58174074e-01
 7.94396624e-02 4.49314155e-02 1.98577568e-01 1.49858415e-01
 5.05271517e-02 1.41139403e-01 4.68368307e-02 1.38186887e-01
 2.14686077e-02 1.29183933e-01 2.49996427e-02 5.47391362e-02
 1.69111878e-01 2.16618683e-02 3.39017250e-02 3.14973071e-02
 1.38013825e-01 1.39836473e-02 2.66322672e-01 7.24383295e-02
 5.29924594e-02 8.00443351e-01 1.29698753e-01 1.79445576e-02
 6.83237538e-02 2.49801669e-02 1.16437936e+00 1.98550299e-02
 3.73557582e-02 4.76260036e-02 1.35053862e-02 1.16278541e+00
 3.68223935e-02 1.37394726e-01 4.47992235e-02 7.60004669e-02
 3.42079997e-03 3.42077110e-03 3.42077110e-03 5.24897501e-02
 1.01719983e-01 1.37394726e-01 3.42077622e-03 4.18374278e-02
 3.42079997e-03 1.12029621e-02 5.91787286e-02 5.07911295e-02
 1.89533770e-01 2.88208406e-02 2.58454941e-02 1.27695864e-02
 1.00211732e-01 6.11018650e-02 1.19019762e-01 4.47991937e-02
 7.16743469e-02 1.64852828e-01 1.78605303e-01 6.02865368e-02
 4.94465008e-02 4.94463816e-02 2.14477673e-01 1.41253034e-02
 3.42077622e-03 4.68368270e-02 3.42077622e-03 5.24897836e-02
 5.14791794e-02 4.49173944e-03 1.60375863e-01 4.07305127e-03
 1.37394771e-01 1.36622181e-02 4.07303683e-03 1.77985191e-01
 6.49912059e-02 9.80288163e-02 4.47991528e-02 1.37399081e-02
 8.09220448e-02 3.85574289e-02 3.42077622e-03 4.26744260e-02
 4.66842800e-02 6.26377091e-02 1.21713895e-02 1.21128149e-02
 1.57610819e-01 3.42077622e-03 4.19279700e-03 1.01564981e-01
 8.62529650e-02 1.41126625e-02 1.30269170e-01 8.00029933e-02
 4.47992571e-02 4.96528566e-01 3.97343142e-03 4.68345657e-02
 4.49528620e-02 3.47923450e-02 4.66081388e-02 7.48143718e-02
 1.10556081e-01 4.51690741e-02 9.88899767e-02 6.26362413e-02
 4.26074304e-03 2.78698131e-02 4.95501421e-02 3.42077622e-03
 4.47992608e-02 6.01983033e-02 1.09377373e-02 3.61201912e-02
 5.64606376e-02 7.40480796e-02 5.29716015e-02 5.80537245e-02
 6.89369440e-02 3.42077622e-03 1.30807564e-01 8.28181282e-02
 4.39997539e-02 9.38737169e-02 6.45078197e-02 6.45078197e-02
 6.45078048e-02 3.25171560e-01 2.86980299e-03 3.33925813e-01
 1.06541254e-02 7.80895427e-02 8.25204179e-02 2.86980020e-03
 4.61617783e-02 4.39997427e-02 1.11857399e-01 2.37166975e-02
 4.39997390e-02 7.04122335e-02 6.45078123e-02 4.39996980e-02
 2.86980020e-03 6.45078197e-02 6.45078197e-02 1.10141495e-02
 1.36310663e-02 6.45078123e-02 4.35615284e-03 5.71180955e-02
 4.67790142e-02 1.05511555e-02 3.73838730e-02 1.03011979e-02
 1.08665422e-01 5.73988780e-02 1.83702484e-02 4.96415831e-02
 1.18978813e-01 6.48899935e-03 8.62991810e-02 2.49073468e-02
 4.93526831e-02 5.44049591e-02 9.68917087e-02 6.45078197e-02
 1.06541319e-02 7.34959617e-02 1.17978379e-01 8.12161639e-02
 4.41251621e-02 2.60440651e-02 1.55405357e-01 6.62816549e-03
 6.78607896e-02 4.22206186e-02 1.42970383e-01 8.34857766e-03
 1.80279743e-02 1.29185701e-02 8.21521655e-02 3.33223073e-03
 1.71173103e-02 9.71265063e-02 3.33224679e-03 2.59581022e-02
 1.03012165e-02 3.40271145e-02 2.26893760e-02 1.01158760e-01
 4.33997363e-02 1.72304511e-02 8.83347820e-03 3.96836624e-02
 8.83344654e-03 1.72304511e-02 3.29435198e-03 3.79893743e-02
 5.79098910e-02 1.69202015e-02 3.29435198e-03 4.33997326e-02
 6.45664036e-02 2.74164051e-01 8.32892731e-02 3.73830870e-02
 3.79893854e-02 4.33997363e-02 2.76606577e-03 2.28277761e-02
 1.61953680e-02 2.18286201e-01 4.54203859e-02 8.34859442e-03
 1.01243272e-01 1.65679995e-02 3.33223864e-03 7.25164339e-02
 2.41880920e-02 2.74121612e-01 4.03726026e-02 2.76606577e-03
 4.10386734e-02 4.43096878e-03 8.07155892e-02 1.30495261e-02
 4.22014147e-02 3.53992552e-01 2.55800015e-03 2.28277761e-02
 1.25270456e-01 4.43095621e-03 1.48425773e-01 2.09468920e-02
 3.06801824e-03 2.95534767e-02 2.16404372e-03 4.04597580e-01
 1.34932650e-02 3.33222165e-03 1.67468898e-02 1.99407637e-02
 1.99407227e-02 1.10009182e-02 5.51559180e-02 3.34974304e-02
 2.16406630e-03 4.18144539e-02 3.71653065e-02 6.23476915e-02
 6.76666275e-02 2.60439869e-02 2.16404977e-03 5.95073365e-02
 3.06801824e-03 4.22014408e-02 2.43056305e-02 7.14199543e-02
 6.76665381e-02 7.86189139e-02 3.34974565e-02 1.07879944e-01
 2.55800015e-03 2.28277761e-02 4.22014445e-02 4.25871536e-02
 5.56922182e-02 7.92694315e-02 2.55801226e-03 6.15856722e-02
 2.55800015e-03 7.53950775e-02 1.23635873e-01 4.18144278e-02
 1.04712881e-02 1.03433877e-01 5.59784696e-02 2.48809764e-03
 9.11243439e-01 2.48809764e-03 2.48811604e-03 2.48811115e-03
 2.48811604e-03 2.48809764e-03 2.48811604e-03 2.48811115e-03
 4.83266450e-02 9.68068000e-03 2.55446229e-02 2.48809764e-03
 2.48809764e-03 2.48809764e-03 2.48809764e-03 2.48809764e-03
 2.48811115e-03 2.48811836e-03 2.48811604e-03 2.48809764e-03
 4.02514227e-02 2.48809764e-03 2.48809764e-03 9.24425423e-02
 2.48811115e-03 2.63074990e-02 4.34621125e-02 2.55800015e-03
 8.18046704e-02 4.44666743e-02 2.23665610e-01 2.23665610e-01
 8.16235542e-02 8.18046704e-02 2.55800015e-03 2.16406141e-03
 2.16406630e-03 2.55801226e-03 2.16406630e-03 2.19934043e-02
 2.30126325e-02 2.48811604e-03 2.60440726e-02 2.55800015e-03
 1.99407600e-02 2.55801226e-03 2.55801226e-03 6.84165731e-02
 2.55801226e-03 2.16404977e-03 2.55801226e-03 2.55800015e-03
 4.18144092e-02 2.16406630e-03 2.55801226e-03 2.16406630e-03
 2.55801226e-03 2.55801226e-03 2.55801226e-03 7.96986744e-02
 1.00495242e-01 3.59676667e-02 2.48809764e-03 3.53004374e-02
 6.89363182e-02 2.55801226e-03 2.16406141e-03 7.23065585e-02
 2.48809764e-03 3.98573093e-02 6.46528080e-02 3.39928409e-03
 2.55801226e-03 2.55801226e-03 3.84141132e-02 8.82358253e-02
 2.85969060e-02 2.55801226e-03 4.83266264e-02 1.06900753e-02
 2.16404372e-03 5.84765039e-02 2.48811115e-03 4.00251709e-02
 8.37360099e-02 2.48809764e-03 2.48811115e-03 4.83266115e-02
 1.06900912e-02 2.55800015e-03 1.58374622e-01 1.24137491e-01
 7.19880611e-02 8.82358029e-02 3.19040157e-02 5.75726554e-02
 5.75726591e-02 4.28894274e-02 1.60627700e-02 2.48811836e-03
 1.95224248e-02 3.70148905e-02 8.82357582e-02 3.54212262e-02
 2.34722085e-02 3.12524736e-02 2.58505554e-03 2.58504483e-03
 2.58504483e-03 2.58504483e-03 2.58504483e-03 3.88841368e-02
 3.33007202e-02 2.58504483e-03 2.58504483e-03 2.48811115e-03
 1.01212347e-02 2.48809764e-03 5.75726219e-02 1.08311959e-01
 5.36729358e-02 1.21608283e-02 5.52277938e-02 9.89188254e-02
 4.02513705e-02 2.74473503e-02 4.02513891e-02 2.48809764e-03
 5.75726591e-02 3.17016104e-03 1.99447968e-03 1.99446618e-03
 2.58504483e-03 3.17016826e-03 6.98596165e-02 3.13178934e-02
 3.22593562e-02 2.48811115e-03 2.58505554e-03 4.13733944e-02
 1.99447968e-03 5.79240220e-03 3.31235793e-03 4.02621962e-02
 3.88841219e-02 2.83093959e-01 5.94540220e-03 8.83271024e-02
 3.03196423e-02 3.31235793e-03 7.95689411e-03 3.46924784e-03
 3.65057122e-03 9.31706652e-03 5.16171828e-02 3.05782594e-02
 5.43761849e-02 3.31235793e-03 3.31235793e-03 3.31235793e-03
 2.60934443e-03 4.13733684e-02 3.31235793e-03 3.65057122e-03
 3.31235793e-03 3.31235793e-03 3.31235793e-03 3.39284167e-02
 3.94061301e-03 5.08826636e-02 8.33001807e-02 5.28439358e-02
 4.57721911e-02 5.13957702e-02 8.32788497e-02 3.45230430e-01
 4.04771278e-03 4.54923604e-03 8.89662933e-03 4.54570986e-02
 4.54570986e-02 3.65057122e-03 1.03215724e-01 1.42209783e-01
 4.02710401e-03 3.15017207e-03 1.57794319e-02 7.96218216e-02
 4.91139479e-03 4.91142087e-03 4.91141621e-03 3.54363187e-03
 2.82053626e-03 6.14527576e-02 6.12291917e-02 1.52396709e-01
 2.28643175e-02 5.25426213e-03 1.90094132e-02 3.15017207e-03
 1.03689777e-02 2.89054029e-02 2.75575905e-03 3.71307172e-02
 4.02710121e-03 1.42209023e-01 3.15017207e-03 2.89054438e-02
 5.25424629e-03 5.62345982e-02 4.91141621e-03 3.54363187e-03
 2.75576464e-03 2.55068224e-02 4.74649109e-02 3.54361581e-03
 3.54361581e-03 3.54363187e-03 7.99757987e-02 8.04183424e-01
 1.81880462e+00 4.91142087e-03 1.52231142e-01 3.54363397e-03
 4.98821102e-02 1.30605586e-02 4.21529174e-01 2.63607278e-02
 3.54361581e-03 3.84380831e-03 1.09801386e-02 4.24659252e-03
 2.38646835e-01 2.63607241e-02 2.21017674e-01 2.40199361e-02
 8.80423412e-02 2.63607502e-02 4.45556268e-02 4.94600683e-02
 2.26130616e-02 9.77231413e-02 3.51222754e-02 4.52408660e-03
 4.52407636e-03 1.46592408e-01 1.89494759e-01 5.88628501e-02
 2.63607390e-02 2.26130690e-02 2.63607875e-02 3.34061612e-03
 4.88953944e-03 4.88953944e-03 3.05763748e-03 1.02388196e-01
 8.55435710e-03 4.88953944e-03 3.34062451e-03 4.25176769e-02
 4.88953944e-03 4.88953944e-03 4.15443815e-03 4.53622080e-02
 1.03696994e-01 7.87990838e-02 4.88953944e-03 4.14795838e-02
 4.25176769e-02 4.88953944e-03 5.22572361e-03 1.33941453e-02
 5.07484609e-03 5.07481443e-03 7.93835670e-02 1.33941453e-02
 4.88953944e-03 1.33941704e-02 1.46477353e-02 9.11723152e-02
 7.77489170e-02 4.88953944e-03 1.78930581e-01 1.30386716e-02
 1.30386716e-02 4.53622080e-02 4.46718000e-03 1.99170280e-02
 5.22571290e-03 3.01101636e-02 3.55344662e-03 5.32577895e-02
 2.69199610e-02 5.32577895e-02 2.27650985e-01 3.56746907e-03
 2.69199610e-02 4.85286256e-03 4.85285465e-03 4.71330464e-01
 4.85285465e-03 4.13014740e-02 4.46719816e-03 4.77307625e-02
 1.98779888e-02 3.56748374e-03 1.98779944e-02 6.55791387e-02
 8.22788700e-02 7.51048401e-02 4.85285465e-03 2.79367622e-02
 3.34126465e-02 4.85285465e-03 9.95929986e-02 6.26562461e-02
 2.79367324e-02 3.56746675e-03 4.85285465e-03 1.74331382e-01
 4.85286256e-03 4.85285465e-03 4.85285465e-03 5.59537765e-03
 3.95137407e-02 5.59537765e-03 1.42401420e-02 5.59537718e-03
 3.91705558e-02 4.93967757e-02 1.07182436e-01 4.85285465e-03
 4.85285465e-03 6.39555277e-03 4.85286256e-03 2.52672404e-01
 1.42401317e-02 5.59537765e-03 6.39552576e-03 4.85285465e-03
 4.85285465e-03 1.54408626e-02 6.39555277e-03 4.85285465e-03
 3.45697696e-03 2.68852636e-02 4.78569325e-03 2.27492437e-01
 3.45696253e-03 4.85285465e-03 4.85286256e-03 1.00595783e-02
 3.86323556e-02 4.40125316e-02 4.40125316e-02 6.06671395e-03
 6.05831183e-02 4.91634235e-02 2.43864320e-02 2.13428274e-01
 4.40125540e-02 6.10692753e-03 4.40125354e-02 3.06312833e-02
 2.43864227e-02 4.40125316e-02 8.70932732e-03 4.78571327e-03
 3.02818771e-02 9.15665552e-03 7.87579920e-03 8.30056146e-03
 5.07398807e-02 8.93824361e-03 1.26839150e-02 1.26839411e-02
 5.41781075e-02 5.96828349e-02 1.26839411e-02 1.26839411e-02
 6.41405880e-02 5.31436205e-02 1.26839150e-02 1.26838861e-02
 1.26839411e-02 1.26838926e-02 1.26839150e-02 1.26839411e-02
 1.26839411e-02 1.26839150e-02 1.27109233e-02 3.21986340e-02
 1.26839336e-02 1.26839150e-02 1.26838861e-02 1.26839150e-02
 1.91314220e-01 5.49367107e-02 1.17598269e-02 3.21986228e-02
 1.04776090e-02 1.81052294e-02 1.81052294e-02 1.26839411e-02
 1.81052294e-02 1.81052294e-02 6.91906959e-02 6.03953600e-02
 6.03953600e-02]
2025-06-02 15:29:46,557 - DEBUG - Edge reconstruction errors: [ 5.2641516  5.2615385 44.25781   ... 13.357794   2.15874   13.357794 ]
2025-06-02 15:29:46,562 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152946_update_44.json
2025-06-02 15:29:46,562 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:29:46,603 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152946_update_44.pth
2025-06-02 15:29:46,603 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870415.dot): 0.9373
2025-06-02 15:29:46,604 - WARNING - Detected 11 anomalous nodes (reconstruction-based):
2025-06-02 15:29:46,604 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.8400, MLP Score: 0.5329
2025-06-02 15:29:46,604 - WARNING -   Node ID: 192.168.27.13, Recon Error: 1.5070, MLP Score: 0.5130
2025-06-02 15:29:46,604 - WARNING -   Node ID: 192.168.27.10, Recon Error: 1.8689, MLP Score: 0.4962
2025-06-02 15:29:46,604 - WARNING -   Node ID: 8.8.8.8, Recon Error: 1.0742, MLP Score: 0.5418
2025-06-02 15:29:46,605 - WARNING -   Node ID: 113.171.234.51, Recon Error: 1.1352, MLP Score: 0.5257
2025-06-02 15:29:46,605 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:29:46,605 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2578, MLP Score: 0.0042
2025-06-02 15:29:46,605 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9604, MLP Score: 0.0004
2025-06-02 15:29:46,606 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0601, MLP Score: 0.0004
2025-06-02 15:29:46,606 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7588, MLP Score: 0.0002
2025-06-02 15:29:46,606 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7580, MLP Score: 0.0002
2025-06-02 15:29:46,606 - INFO - 
--- Processing file: nw_graph_encoded_1748870445.dot (Timestamp: 2025-06-02 15:20:45) ---
2025-06-02 15:29:46,606 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870445.dot
2025-06-02 15:29:46,607 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870445.dot'.
2025-06-02 15:29:46,607 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870445.dot
2025-06-02 15:29:46,643 - INFO - Parsed 962 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870445.dot'.
2025-06-02 15:29:46,753 - INFO - Parsed 2098 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870445.dot'.
2025-06-02 15:29:46,753 - INFO - Processing node updates/additions.
2025-06-02 15:29:46,797 - INFO - Processing edge updates/additions.
2025-06-02 15:29:46,968 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:29:46,975 - INFO - Finished updating NetworkX graph.
2025-06-02 15:29:46,979 - DEBUG - Updated graph - Nodes: 962, Edges: 2098
2025-06-02 15:29:46,979 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:29:46,986 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:29:47,179 - DEBUG - Initial node features tensor shape: torch.Size([962, 30])
2025-06-02 15:29:47,184 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:29:47,185 - DEBUG - Node features tensor shape after scaling: torch.Size([962, 30])
2025-06-02 15:29:47,190 - DEBUG - Edge index tensor shape: torch.Size([2, 2098])
2025-06-02 15:29:47,203 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:29:47,299 - DEBUG - Initial edge attributes tensor shape: torch.Size([2098, 10])
2025-06-02 15:29:47,302 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:29:47,303 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2098, 10])
2025-06-02 15:29:47,304 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:29:47,304 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:29:47,308 - INFO - Updated main graph to 962 nodes and 2098 edges.
2025-06-02 15:29:47,309 - INFO - Performing online update...
2025-06-02 15:29:47,309 - INFO - Starting online update for 25 steps.
2025-06-02 15:29:47,310 - DEBUG - Updated RunningStats: new_mean=0.9447302528549198, new_var=25800000000161.633, new_n=2610
2025-06-02 15:29:47,311 - DEBUG - Updated RunningStats: new_mean=0.9423829119140225, new_var=26100000000018.145, new_n=2640
2025-06-02 15:29:47,311 - DEBUG - Updated RunningStats: new_mean=44.757305784704556, new_var=8600000187458.265, new_n=870
2025-06-02 15:29:47,312 - DEBUG - Updated RunningStats: new_mean=44.76303132361939, new_var=8700000178091.943, new_n=880
2025-06-02 15:29:47,312 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:29:47,312 - DEBUG - Online update step: 1/25
2025-06-02 15:29:47,320 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:47,456 - DEBUG - Node anomaly scores shape: torch.Size([20173, 1])
2025-06-02 15:29:47,472 - DEBUG - Edge anomaly scores shape: torch.Size([42303, 1])
2025-06-02 15:29:47,481 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:47,793 - DEBUG - Step 1: Loss=0.6838
2025-06-02 15:29:47,793 - DEBUG - Online update step: 2/25
2025-06-02 15:29:47,806 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:47,913 - DEBUG - Node anomaly scores shape: torch.Size([18015, 1])
2025-06-02 15:29:47,918 - DEBUG - Edge anomaly scores shape: torch.Size([37468, 1])
2025-06-02 15:29:47,920 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:48,145 - DEBUG - Step 2: Loss=0.6559
2025-06-02 15:29:48,146 - DEBUG - Online update step: 3/25
2025-06-02 15:29:48,158 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:48,260 - DEBUG - Node anomaly scores shape: torch.Size([18292, 1])
2025-06-02 15:29:48,264 - DEBUG - Edge anomaly scores shape: torch.Size([38056, 1])
2025-06-02 15:29:48,266 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:48,502 - DEBUG - Step 3: Loss=0.6681
2025-06-02 15:29:48,503 - DEBUG - Online update step: 4/25
2025-06-02 15:29:48,525 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:48,622 - DEBUG - Node anomaly scores shape: torch.Size([18804, 1])
2025-06-02 15:29:48,627 - DEBUG - Edge anomaly scores shape: torch.Size([39317, 1])
2025-06-02 15:29:48,629 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:48,843 - DEBUG - Step 4: Loss=0.6848
2025-06-02 15:29:48,844 - DEBUG - Online update step: 5/25
2025-06-02 15:29:48,856 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:48,961 - DEBUG - Node anomaly scores shape: torch.Size([17587, 1])
2025-06-02 15:29:48,965 - DEBUG - Edge anomaly scores shape: torch.Size([36454, 1])
2025-06-02 15:29:48,967 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:49,215 - DEBUG - Step 5: Loss=0.6573
2025-06-02 15:29:49,216 - DEBUG - Online update step: 6/25
2025-06-02 15:29:49,230 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:49,333 - DEBUG - Node anomaly scores shape: torch.Size([18012, 1])
2025-06-02 15:29:49,337 - DEBUG - Edge anomaly scores shape: torch.Size([37542, 1])
2025-06-02 15:29:49,339 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:49,596 - DEBUG - Step 6: Loss=0.6644
2025-06-02 15:29:49,597 - DEBUG - Online update step: 7/25
2025-06-02 15:29:49,610 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:49,716 - DEBUG - Node anomaly scores shape: torch.Size([18539, 1])
2025-06-02 15:29:49,722 - DEBUG - Edge anomaly scores shape: torch.Size([38761, 1])
2025-06-02 15:29:49,724 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:49,997 - DEBUG - Step 7: Loss=0.6812
2025-06-02 15:29:49,997 - DEBUG - Online update step: 8/25
2025-06-02 15:29:50,011 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:50,112 - DEBUG - Node anomaly scores shape: torch.Size([17951, 1])
2025-06-02 15:29:50,119 - DEBUG - Edge anomaly scores shape: torch.Size([37424, 1])
2025-06-02 15:29:50,120 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:50,401 - DEBUG - Step 8: Loss=0.6530
2025-06-02 15:29:50,401 - DEBUG - Online update step: 9/25
2025-06-02 15:29:50,413 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:50,521 - DEBUG - Node anomaly scores shape: torch.Size([18281, 1])
2025-06-02 15:29:50,526 - DEBUG - Edge anomaly scores shape: torch.Size([38054, 1])
2025-06-02 15:29:50,528 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:50,765 - DEBUG - Step 9: Loss=0.6642
2025-06-02 15:29:50,766 - DEBUG - Online update step: 10/25
2025-06-02 15:29:50,775 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:50,870 - DEBUG - Node anomaly scores shape: torch.Size([18625, 1])
2025-06-02 15:29:50,875 - DEBUG - Edge anomaly scores shape: torch.Size([38897, 1])
2025-06-02 15:29:50,876 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:51,094 - DEBUG - Step 10: Loss=0.6813
2025-06-02 15:29:51,095 - DEBUG - Online update step: 11/25
2025-06-02 15:29:51,104 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:51,213 - DEBUG - Node anomaly scores shape: torch.Size([16917, 1])
2025-06-02 15:29:51,219 - DEBUG - Edge anomaly scores shape: torch.Size([34969, 1])
2025-06-02 15:29:51,220 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:51,465 - DEBUG - Step 11: Loss=0.6534
2025-06-02 15:29:51,465 - DEBUG - Online update step: 12/25
2025-06-02 15:29:51,475 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:51,569 - DEBUG - Node anomaly scores shape: torch.Size([18383, 1])
2025-06-02 15:29:51,575 - DEBUG - Edge anomaly scores shape: torch.Size([38234, 1])
2025-06-02 15:29:51,576 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:51,832 - DEBUG - Step 12: Loss=0.6636
2025-06-02 15:29:51,832 - DEBUG - Online update step: 13/25
2025-06-02 15:29:51,841 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:51,937 - DEBUG - Node anomaly scores shape: torch.Size([17675, 1])
2025-06-02 15:29:51,941 - DEBUG - Edge anomaly scores shape: torch.Size([36811, 1])
2025-06-02 15:29:51,943 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:52,153 - DEBUG - Step 13: Loss=0.6812
2025-06-02 15:29:52,154 - DEBUG - Online update step: 14/25
2025-06-02 15:29:52,163 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:52,300 - DEBUG - Node anomaly scores shape: torch.Size([18824, 1])
2025-06-02 15:29:52,304 - DEBUG - Edge anomaly scores shape: torch.Size([39285, 1])
2025-06-02 15:29:52,305 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:52,555 - DEBUG - Step 14: Loss=0.6508
2025-06-02 15:29:52,556 - DEBUG - Online update step: 15/25
2025-06-02 15:29:52,568 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:52,658 - DEBUG - Node anomaly scores shape: torch.Size([17853, 1])
2025-06-02 15:29:52,663 - DEBUG - Edge anomaly scores shape: torch.Size([37095, 1])
2025-06-02 15:29:52,664 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:52,875 - DEBUG - Step 15: Loss=0.6606
2025-06-02 15:29:52,876 - DEBUG - Online update step: 16/25
2025-06-02 15:29:52,897 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:53,008 - DEBUG - Node anomaly scores shape: torch.Size([18978, 1])
2025-06-02 15:29:53,012 - DEBUG - Edge anomaly scores shape: torch.Size([39556, 1])
2025-06-02 15:29:53,014 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:53,257 - DEBUG - Step 16: Loss=0.6777
2025-06-02 15:29:53,257 - DEBUG - Online update step: 17/25
2025-06-02 15:29:53,266 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:53,360 - DEBUG - Node anomaly scores shape: torch.Size([17735, 1])
2025-06-02 15:29:53,365 - DEBUG - Edge anomaly scores shape: torch.Size([36988, 1])
2025-06-02 15:29:53,367 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:53,553 - DEBUG - Step 17: Loss=0.6523
2025-06-02 15:29:53,554 - DEBUG - Online update step: 18/25
2025-06-02 15:29:53,562 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:53,681 - DEBUG - Node anomaly scores shape: torch.Size([18739, 1])
2025-06-02 15:29:53,686 - DEBUG - Edge anomaly scores shape: torch.Size([38935, 1])
2025-06-02 15:29:53,687 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:53,902 - DEBUG - Step 18: Loss=0.6620
2025-06-02 15:29:53,902 - DEBUG - Online update step: 19/25
2025-06-02 15:29:53,911 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:54,017 - DEBUG - Node anomaly scores shape: torch.Size([18480, 1])
2025-06-02 15:29:54,022 - DEBUG - Edge anomaly scores shape: torch.Size([38842, 1])
2025-06-02 15:29:54,024 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:54,262 - DEBUG - Step 19: Loss=0.6778
2025-06-02 15:29:54,262 - DEBUG - Online update step: 20/25
2025-06-02 15:29:54,271 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:54,371 - DEBUG - Node anomaly scores shape: torch.Size([18798, 1])
2025-06-02 15:29:54,375 - DEBUG - Edge anomaly scores shape: torch.Size([39096, 1])
2025-06-02 15:29:54,377 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:54,605 - DEBUG - Step 20: Loss=0.6505
2025-06-02 15:29:54,605 - DEBUG - Online update step: 21/25
2025-06-02 15:29:54,626 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:54,719 - DEBUG - Node anomaly scores shape: torch.Size([17474, 1])
2025-06-02 15:29:54,724 - DEBUG - Edge anomaly scores shape: torch.Size([36414, 1])
2025-06-02 15:29:54,726 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:54,990 - DEBUG - Step 21: Loss=0.6597
2025-06-02 15:29:54,991 - DEBUG - Online update step: 22/25
2025-06-02 15:29:55,004 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:55,117 - DEBUG - Node anomaly scores shape: torch.Size([18579, 1])
2025-06-02 15:29:55,122 - DEBUG - Edge anomaly scores shape: torch.Size([38635, 1])
2025-06-02 15:29:55,123 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:55,581 - DEBUG - Step 22: Loss=0.6769
2025-06-02 15:29:55,582 - DEBUG - Online update step: 23/25
2025-06-02 15:29:55,603 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:56,080 - DEBUG - Node anomaly scores shape: torch.Size([19030, 1])
2025-06-02 15:29:56,156 - DEBUG - Edge anomaly scores shape: torch.Size([39716, 1])
2025-06-02 15:29:56,211 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:56,757 - DEBUG - Step 23: Loss=0.6490
2025-06-02 15:29:56,758 - DEBUG - Online update step: 24/25
2025-06-02 15:29:56,767 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:56,929 - DEBUG - Node anomaly scores shape: torch.Size([18881, 1])
2025-06-02 15:29:56,933 - DEBUG - Edge anomaly scores shape: torch.Size([39337, 1])
2025-06-02 15:29:56,935 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:57,196 - DEBUG - Step 24: Loss=0.6612
2025-06-02 15:29:57,197 - DEBUG - Online update step: 25/25
2025-06-02 15:29:57,205 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:57,298 - DEBUG - Node anomaly scores shape: torch.Size([18220, 1])
2025-06-02 15:29:57,302 - DEBUG - Edge anomaly scores shape: torch.Size([38130, 1])
2025-06-02 15:29:57,304 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:57,485 - DEBUG - Step 25: Loss=0.6782
2025-06-02 15:29:57,486 - INFO - Online update finished. Average loss: 0.6660, Learning rate: 0.001000
2025-06-02 15:29:57,488 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  1.0409127e-08  1.5861527e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -8.4264364e-09
 -6.7411492e-08  1.3383164e-08 -1.7844219e-08  4.9567270e-09
  2.2827442e+00  2.9625781e+00  1.4033264e-01  4.4064450e+00
 -1.7348546e-08  3.3607068e+00  5.8243241e+00  7.6091475e+00
  1.4033264e-01  7.9927235e+00  3.2218725e-08 -2.0322581e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -1.8835564e-08 -5.9480726e-08], current edge mean: [-3.6365084e-09  4.5637512e+02  0.0000000e+00  0.0000000e+00
  9.0912711e-10  2.7273812e-09  0.0000000e+00  9.0912711e-10
 -3.6365084e-09 -9.0912711e-10]
2025-06-02 15:29:57,489 - DEBUG - Node drift difference: 0.0202, Edge drift difference: 0.0006
2025-06-02 15:29:57,493 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  1.0409127e-08  1.5861527e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -8.4264364e-09
 -6.7411492e-08  1.3383164e-08 -1.7844219e-08  4.9567270e-09
  2.2827442e+00  2.9625781e+00  1.4033264e-01  4.4064450e+00
 -1.7348546e-08  3.3607068e+00  5.8243241e+00  7.6091475e+00
  1.4033264e-01  7.9927235e+00  3.2218725e-08 -2.0322581e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -1.8835564e-08 -5.9480726e-08], edge=[-3.6365084e-09  4.5637512e+02  0.0000000e+00  0.0000000e+00
  9.0912711e-10  2.7273812e-09  0.0000000e+00  9.0912711e-10
 -3.6365084e-09 -9.0912711e-10]
2025-06-02 15:29:57,495 - DEBUG - Updated reference std: node=[0.         0.         1.0005201  1.0005201  0.         0.
 0.         1.0005201  1.0005201  1.0005202  1.0005201  1.0005201
 0.96617806 0.27114588 0.36217502 0.5716872  1.0005202  2.9931998
 2.895206   1.4912298  0.36217502 0.22568905 1.0005201  1.0005201
 0.         0.         0.         0.         1.0005202  1.0005201 ], edge=[  1.0002384 445.60986     0.          0.          1.0002384   1.0002384
   1.0002384   1.0002384   1.0002384   1.0002383]
2025-06-02 15:29:57,496 - INFO - Online update complete. Loss: 0.6660
2025-06-02 15:29:57,497 - INFO - Running anomaly detection...
2025-06-02 15:29:57,498 - INFO - Starting anomaly detection.
2025-06-02 15:29:57,559 - DEBUG - Node reconstruction errors: [5.04176021e-01 1.46644032e+00 1.33658195e+00 1.53245246e-02
 5.50820902e-02 5.06578051e-02 5.65876305e-01 3.29637043e-02
 3.29637043e-02 4.25248221e-02 3.29637267e-02 5.08353896e-02
 1.49927771e+00 9.70281243e-01 9.26509593e-03 3.73760127e-02
 1.17522836e-01 3.73761430e-02 2.21063718e-01 3.67195047e-02
 2.67070178e-02 9.26545449e-03 2.58249104e-01 2.78959144e-02
 1.02376668e-02 1.65459700e-02 1.02376724e-02 1.28938183e-01
 3.36334184e-02 1.02376537e-02 4.22722816e-01 2.92694062e-01
 1.18965678e-01 1.73838083e-02 1.50445297e-01 2.16027871e-01
 1.84645370e-01 3.67195047e-02 2.35601217e-01 1.26503408e-01
 2.37553082e-02 7.65554560e-03 3.67195047e-02 7.01671615e-02
 1.01514196e+00 9.49795544e-02 3.59371640e-02 3.21417242e-01
 3.44928429e-02 5.25203347e-01 2.07614973e-01 2.15374492e-02
 1.70229487e-02 1.81756571e-01 3.62745374e-02 1.03661805e-01
 9.45473075e-01 3.58535759e-02 2.20604792e-01 2.22618893e-01
 2.98611522e-01 2.46400669e-01 6.33713603e-03 6.72259778e-02
 1.68474585e-01 3.62748578e-02 2.03466993e-02 3.62750664e-02
 6.33712905e-03 2.23068148e-01 1.74041942e-01 5.20587936e-02
 1.08084958e-02 1.60093784e-01 1.53220549e-01 4.95753512e-02
 1.88102037e-01 1.76456973e-01 2.59807669e-02 3.20400186e-02
 1.56906936e-02 4.79079299e-02 8.07905018e-01 1.27478331e-01
 5.39258122e-02 6.80280551e-02 6.51223809e-02 1.21014372e-01
 6.05414473e-02 1.83286294e-01 6.58194721e-03 6.25269562e-02
 2.40896996e-02 1.21645309e-01 6.41594678e-02 2.14736924e-01
 1.25384023e-02 6.61162138e-02 4.79513966e-03 1.28383294e-01
 4.28997017e-02 1.25383493e-02 2.31571924e-02 2.99439132e-01
 5.07239103e-02 2.13329718e-02 6.89108819e-02 6.13200180e-02
 2.54778676e-02 6.12704158e-01 3.10900688e-01 1.78577024e-02
 4.91009951e-02 1.01085171e-01 3.73055935e-02 1.56048775e-01
 3.75453793e-02 9.85666588e-02 8.95760432e-02 2.22568437e-02
 7.09254248e-03 2.71021705e-02 1.14062510e-01 3.11912540e-02
 8.78676549e-02 2.22574826e-02 3.83152962e-02 8.98790658e-02
 9.25649777e-02 3.51175740e-02 1.54597126e-02 1.05322581e-02
 1.07739091e+00 2.04661399e-01 3.41746323e-02 2.19416674e-02
 2.87203863e-02 4.40208567e-03 1.35681435e-01 1.45768180e-01
 9.34476629e-02 4.88459021e-02 1.02736754e-02 5.22312708e-02
 1.30135968e-01 1.28218561e-01 3.75454240e-02 2.16468111e-01
 7.75728077e-02 9.52091962e-02 5.56669176e-01 4.85094972e-02
 4.33860198e-02 1.05322497e-02 4.18909192e-02 7.50982091e-02
 8.53338372e-03 4.93065044e-02 4.28997017e-02 2.20463201e-02
 9.34476033e-02 6.53998032e-02 8.53338372e-03 1.54596986e-02
 3.81946675e-02 6.26921430e-02 4.27448414e-02 2.71460582e-02
 5.73625453e-02 9.52089205e-02 3.83126847e-02 2.22589895e-02
 5.19357715e-03 4.22378331e-01 8.95761773e-02 9.68566513e+00
 2.99262572e-02 5.99305741e-02 4.07657251e-02 4.07657586e-02
 2.12854482e-02 5.18868230e-02 7.45686218e-02 1.59247175e-01
 5.26967458e-02 4.31556553e-02 9.04397108e-03 4.90884446e-02
 2.19003484e-02 7.83022400e-03 4.10113968e-02 1.07367031e-01
 6.47365972e-02 1.40857361e-02 1.35680005e-01 1.05193341e-02
 8.98594141e-01 1.32207081e-01 5.44549935e-02 1.76595196e-01
 2.47883089e-02 8.53338558e-03 4.32165824e-02 1.09172992e-01
 1.40724719e-01 4.27968726e-02 3.98065187e-02 2.07143977e-01
 6.63535018e-03 3.74543034e-02 3.59823518e-02 1.07867271e-01
 1.97839215e-02 4.60385755e-02 5.64103723e-02 1.38704339e-02
 1.24975592e-01 3.75453681e-02 1.24706939e-01 1.40857594e-02
 1.85944393e-01 9.04397108e-03 4.38216375e-03 1.97839215e-02
 8.53338372e-03 1.27214521e-01 1.04304999e-01 1.88808143e-02
 4.01684269e-02 3.77342813e-02 2.87407562e-02 6.56411201e-02
 1.04623415e-01 3.75453942e-02 3.75453383e-02 3.88936214e-02
 3.82064357e-02 4.38216375e-03 8.53337999e-03 1.36181265e-01
 7.34905750e-02 1.21601425e-01 1.81011315e-02 9.39349160e-02
 1.86555386e-02 1.05990566e-01 4.37887758e-02 6.00784793e-02
 1.81011315e-02 2.70881280e-02 5.19357575e-03 3.89731280e-03
 1.24706775e-01 2.73300298e-02 1.04022779e-01 5.58829382e-02
 7.83018302e-03 8.82739015e-03 1.10021815e-01 4.07656915e-02
 3.18300575e-02 6.24736622e-02 1.85120814e-02 7.84652159e-02
 6.90777227e-02 8.81662741e-02 7.43685961e-02 4.11225587e-01
 7.43687227e-02 3.94026525e-02 1.81441888e-01 1.31828174e-01
 4.43606265e-02 1.15459017e-01 4.00033556e-02 1.26497298e-01
 1.62915271e-02 1.21457614e-01 2.12855022e-02 4.68813516e-02
 1.72139749e-01 1.58319138e-02 2.97725014e-02 1.91877056e-02
 1.00877650e-01 1.20361261e-02 2.74713129e-01 6.37887493e-02
 5.18866703e-02 7.10189760e-01 1.03498198e-01 1.59037914e-02
 6.12295382e-02 1.86555386e-02 9.90329206e-01 1.96474791e-02
 3.26327048e-02 4.07683253e-02 1.05193574e-02 1.04622841e+00
 3.30921933e-02 1.27650097e-01 3.85356322e-02 5.99444360e-02
 3.03255348e-03 3.03255813e-03 3.03255813e-03 4.50094715e-02
 9.43625793e-02 1.27649531e-01 3.03255813e-03 3.77570465e-02
 3.03255348e-03 9.23973322e-02 3.97795215e-02 4.58227843e-02
 1.85170069e-01 3.06333527e-02 2.02518683e-02 9.80282202e-03
 8.02084357e-02 4.21097428e-02 8.77983272e-02 3.85356583e-02
 5.56387194e-02 1.44790813e-01 1.63452774e-01 5.74620739e-02
 4.40270975e-02 4.40271534e-02 2.06487194e-01 9.77600738e-03
 3.03255813e-03 4.00033444e-02 3.03255813e-03 4.50093932e-02
 5.76219112e-02 3.20690987e-03 1.48822859e-01 3.90185136e-03
 1.27649844e-01 8.39876942e-03 3.90185136e-03 1.34469986e-01
 5.25026992e-02 7.89027438e-02 3.85355949e-02 1.22310566e-02
 7.56451637e-02 3.47535610e-02 3.03255883e-03 3.73190120e-02
 4.08954136e-02 1.08418673e-01 7.56678265e-03 7.83017185e-03
 1.46391764e-01 3.03255813e-03 3.67331249e-03 6.36130273e-02
 7.99453631e-02 1.12420451e-02 1.17817707e-01 6.75150380e-02
 3.85369211e-02 3.96182120e-01 3.65347764e-03 4.74225394e-02
 3.86386663e-02 3.00466605e-02 4.05603014e-02 6.34353235e-02
 8.04262683e-02 5.05569056e-02 8.04765224e-02 6.13247789e-02
 3.61984759e-03 2.25817505e-02 4.82195392e-02 3.03255348e-03
 3.85356173e-02 3.92551310e-02 7.39386678e-03 3.16842906e-02
 3.71270515e-02 5.84380664e-02 4.58878353e-02 4.68680710e-02
 6.44721091e-02 3.03255348e-03 1.23269334e-01 1.10752814e-01
 3.77718955e-02 8.61107558e-02 6.04309328e-02 6.04303293e-02
 6.04297332e-02 2.19421953e-01 2.57316907e-03 2.25392893e-01
 6.83062105e-03 7.12561384e-02 1.04941353e-01 2.57316907e-03
 4.00632359e-02 3.77725028e-02 8.36977735e-02 1.72907207e-02
 3.77718695e-02 5.81522137e-02 6.04301468e-02 3.77718844e-02
 2.57316907e-03 6.04305454e-02 6.04301840e-02 8.27154610e-03
 8.46423022e-03 6.04296960e-02 3.73746152e-03 5.30166849e-02
 3.65764424e-02 7.11833127e-03 3.21326628e-02 6.99470285e-03
 1.01476811e-01 7.18970001e-02 1.42084900e-02 4.56738696e-02
 1.08371302e-01 8.06574430e-03 7.94850066e-02 2.13612057e-02
 4.68006842e-02 5.09108827e-02 5.57437018e-02 6.04303814e-02
 6.83062384e-03 6.85741082e-02 1.09187037e-01 7.32048005e-02
 4.09037098e-02 2.18156204e-02 1.40593573e-01 6.48664730e-03
 6.36017695e-02 4.49140146e-02 1.28153056e-01 5.74685726e-03
 9.97109711e-03 9.42166056e-03 6.30606934e-02 2.90190149e-03
 1.31861437e-02 9.03837606e-02 2.90189520e-03 2.30893511e-02
 6.99471263e-03 2.81847008e-02 1.85574722e-02 9.87925902e-02
 3.72786112e-02 1.31157199e-02 5.90041932e-03 3.84749807e-02
 5.90037880e-03 1.31157534e-02 2.39345129e-03 3.47123817e-02
 4.44563441e-02 1.04397712e-02 2.39342893e-03 3.72795500e-02
 5.36727831e-02 2.79516518e-01 6.20074309e-02 3.21376324e-02
 3.47123072e-02 3.72785814e-02 2.57642870e-03 1.83086526e-02
 1.21778483e-02 2.02287808e-01 4.21858206e-02 5.74683398e-03
 9.62629169e-02 1.60905626e-02 2.90188566e-03 5.93668558e-02
 1.92997325e-02 2.79465675e-01 3.61842550e-02 2.57643429e-03
 3.52717489e-02 4.39766562e-03 8.94562528e-02 9.40513518e-03
 3.62707451e-02 2.65671283e-01 2.27686018e-03 1.83086656e-02
 1.13636948e-01 4.39768331e-03 1.28750071e-01 1.53925726e-02
 2.17426429e-03 3.17985639e-02 2.13674805e-03 4.07755554e-01
 9.80046112e-03 2.90190149e-03 1.09127788e-02 1.64966006e-02
 1.64965950e-02 1.07389782e-02 5.11297211e-02 3.16054411e-02
 2.13674223e-03 3.61646786e-02 1.97589491e-02 5.55555485e-02
 7.58380145e-02 2.18156558e-02 2.13674596e-03 4.77399230e-02
 2.17426429e-03 3.62707339e-02 1.82786323e-02 6.78815097e-02
 7.58382902e-02 7.29236752e-02 3.16055231e-02 8.90445858e-02
 2.27686018e-03 1.83086395e-02 3.62709276e-02 3.68584618e-02
 5.07551357e-02 7.40445554e-02 2.27686018e-03 5.69540001e-02
 2.27686018e-03 6.83111399e-02 1.09003536e-01 3.61648053e-02
 8.21025018e-03 5.15842289e-02 4.29023691e-02 2.14480772e-03
 9.17282462e-01 2.14480772e-03 2.14482099e-03 2.14482099e-03
 2.14480772e-03 2.14482099e-03 2.14479258e-03 2.14480772e-03
 4.17988636e-02 7.51494057e-03 2.01578047e-02 2.14479258e-03
 2.14480772e-03 2.14482099e-03 2.14479258e-03 2.14481074e-03
 2.14482099e-03 2.14482099e-03 2.14480772e-03 2.14480772e-03
 3.50549556e-02 2.14481005e-03 2.14480772e-03 9.49363261e-02
 2.14481074e-03 1.40952067e-02 3.75378244e-02 2.27686018e-03
 7.85380080e-02 4.38633151e-02 9.59893167e-02 9.59893167e-02
 7.57393762e-02 7.85377547e-02 2.27686018e-03 2.13673851e-03
 2.13675341e-03 1.00771472e-01 2.13674596e-03 1.69308484e-02
 1.63657032e-02 2.14481610e-03 2.18156651e-02 2.27686018e-03
 1.64965987e-02 2.27686018e-03 2.27686018e-03 6.15931526e-02
 2.27686018e-03 2.13674805e-03 2.27686018e-03 2.27686018e-03
 3.61646488e-02 2.13673851e-03 2.27687298e-03 2.13674596e-03
 2.27687298e-03 2.27686018e-03 2.27686018e-03 7.35260174e-02
 7.57796690e-02 3.10655758e-02 2.14481074e-03 3.13845761e-02
 6.41571656e-02 2.27687298e-03 2.13674596e-03 6.40075281e-02
 2.14480772e-03 3.52439135e-02 5.29753752e-02 3.46626737e-03
 2.27687298e-03 2.27686018e-03 3.48928347e-02 8.10776278e-02
 2.51589399e-02 2.27686018e-03 4.17989269e-02 1.05856890e-02
 2.13673851e-03 5.48485368e-02 2.14480772e-03 3.08619905e-02
 6.44612536e-02 2.14480772e-03 2.14480772e-03 4.17988449e-02
 1.05856899e-02 2.27687298e-03 1.47163674e-01 9.19857919e-02
 5.94652966e-02 8.10776576e-02 2.98507325e-02 5.32343797e-02
 5.32343052e-02 3.70316356e-02 1.55997407e-02 2.14480772e-03
 1.60263702e-02 3.68055627e-02 8.10777321e-02 3.07505056e-02
 2.25318242e-02 2.92260591e-02 2.16343789e-03 2.16343789e-03
 2.16343789e-03 2.16343789e-03 2.16343789e-03 3.41848955e-02
 3.38433944e-02 2.16343789e-03 2.16343347e-03 2.14481074e-03
 9.90216993e-03 2.14482099e-03 5.32343350e-02 8.88186172e-02
 5.28676398e-02 8.55243020e-03 7.34377801e-02 8.96616280e-02
 3.50549445e-02 2.29353942e-02 3.50549333e-02 2.14482099e-03
 5.32343127e-02 2.06880504e-03 1.89670851e-03 1.89671293e-03
 2.16343789e-03 2.06880504e-03 6.51046038e-02 2.69426908e-02
 3.08823418e-02 2.14482099e-03 2.16343789e-03 3.81675139e-02
 1.89671293e-03 5.80250658e-03 2.60470551e-03 3.73136662e-02
 3.41849476e-02 2.91137218e-01 5.35474531e-03 8.88627395e-02
 2.64107045e-02 2.60472205e-03 4.97611379e-03 2.16728589e-03
 2.74276617e-03 9.01333895e-03 4.73896638e-02 2.83129290e-02
 5.01013659e-02 2.60470551e-03 2.60471832e-03 2.60471832e-03
 2.12099100e-03 3.81675139e-02 2.60470551e-03 2.74274498e-03
 2.60470551e-03 2.60471832e-03 2.60472461e-03 2.95781028e-02
 2.36063683e-03 6.57805502e-02 7.21665844e-02 4.74754684e-02
 4.09254357e-02 4.71967459e-02 6.42755181e-02 2.43968621e-01
 2.95999018e-03 2.66486104e-03 8.71431828e-03 3.94412614e-02
 3.94413099e-02 2.74274754e-03 1.02278151e-01 1.41523376e-01
 3.00415116e-03 2.28376617e-03 1.80899184e-02 7.81540945e-02
 3.05436575e-03 3.05436575e-03 3.05436575e-03 2.47181929e-03
 2.40870775e-03 5.66411689e-02 4.14373800e-02 1.43092051e-01
 1.13413567e-02 5.02385898e-03 1.59336217e-02 2.28376663e-03
 7.65082007e-03 2.50137877e-02 2.27097562e-03 2.27387734e-02
 3.00415116e-03 1.41545340e-01 2.28376663e-03 2.50139795e-02
 5.02383988e-03 5.37739024e-02 3.05433688e-03 2.47180997e-03
 2.27097562e-03 2.15699319e-02 4.07788195e-02 2.47181952e-03
 2.47180997e-03 2.47181952e-03 7.28445798e-02 6.54885411e-01
 1.63212359e+00 3.05433688e-03 1.38141915e-01 2.47181929e-03
 4.53865081e-02 1.03205955e-02 3.21719676e-01 2.23342497e-02
 2.47181859e-03 2.75247754e-03 8.62436276e-03 3.32337175e-03
 2.22158447e-01 2.23343614e-02 1.75406322e-01 1.03831002e-02
 7.08835945e-02 2.23342460e-02 4.19127345e-02 4.20613214e-02
 1.28279272e-02 8.78875107e-02 3.20136994e-02 3.67350783e-03
 3.67352064e-03 1.49766520e-01 1.72094747e-01 4.70727198e-02
 2.23342460e-02 1.28279487e-02 2.23342218e-02 2.72285845e-03
 4.01580101e-03 4.01581544e-03 2.53805844e-03 8.73779356e-02
 7.61837047e-03 4.01581544e-03 2.72285845e-03 1.70082226e-02
 4.01583547e-03 4.01583547e-03 3.12399329e-03 1.40058314e-02
 9.01216716e-02 6.97294101e-02 4.01583547e-03 3.63585129e-02
 1.70082226e-02 4.01583547e-03 4.18114197e-03 1.40058277e-02
 4.41347808e-03 4.41346597e-03 6.90576658e-02 1.03524234e-02
 4.01581638e-03 1.03524234e-02 1.09694647e-02 8.15350488e-02
 5.60303479e-02 4.01580101e-03 1.58517107e-01 9.75421630e-03
 9.75424703e-03 2.65063308e-02 3.53520992e-03 1.68431923e-02
 4.18114197e-03 1.41758900e-02 2.64545227e-03 4.62055616e-02
 2.34083906e-02 4.62055616e-02 1.81915969e-01 2.66597653e-03
 2.34083906e-02 3.74179101e-03 3.74179101e-03 3.38743359e-01
 3.74180358e-03 3.77979539e-02 3.53521248e-03 4.12526652e-02
 1.68568958e-02 2.66597653e-03 1.68568995e-02 5.95772974e-02
 7.13099465e-02 7.43354857e-02 3.74178565e-03 1.32523077e-02
 1.32175209e-02 3.74180358e-03 8.61783698e-02 5.56032695e-02
 1.32523188e-02 2.66598095e-03 3.74179101e-03 1.61392003e-01
 3.74179101e-03 3.74179007e-03 3.74179101e-03 4.34786081e-03
 3.36883627e-02 4.34786081e-03 1.16093215e-02 4.34787059e-03
 3.29929143e-02 4.36023660e-02 9.13299844e-02 3.74179101e-03
 3.74180009e-03 4.05466324e-03 3.74180358e-03 1.99307173e-01
 1.16093326e-02 4.34786081e-03 4.05466324e-03 3.74180009e-03
 3.74179101e-03 1.31667359e-02 4.05466324e-03 3.74179101e-03
 2.25411262e-03 2.33060513e-02 2.79060309e-03 1.83775261e-01
 2.25411449e-03 3.74180358e-03 3.74180009e-03 9.68023855e-03
 3.57055441e-02 3.87862399e-02 3.87862474e-02 4.00465587e-03
 5.44430800e-02 1.93775836e-02 2.02610958e-02 2.02765226e-01
 3.87862585e-02 4.53616073e-03 3.87862697e-02 1.39181176e-02
 2.02610809e-02 3.87862884e-02 4.96056350e-03 2.79060309e-03
 2.55528092e-02 5.32453088e-03 4.72689327e-03 4.04829253e-03
 3.12087964e-02 4.55601374e-03 6.96137408e-03 6.96137408e-03
 4.40505333e-02 4.78870794e-02 6.96138246e-03 6.96137408e-03
 5.24906479e-02 4.15722542e-02 6.96136011e-03 6.96137408e-03
 6.96137408e-03 6.96137408e-03 4.78883423e-02 4.78870310e-02
 4.78870161e-02 4.78870161e-02 4.78870198e-02 2.69700661e-02
 4.78869639e-02 4.78870161e-02 6.96137408e-03 6.96137408e-03
 1.85155436e-01 3.32798436e-02 5.99851506e-03 4.78871427e-02
 5.96587500e-03 1.03903590e-02 3.01562417e-02 6.96136011e-03
 1.03903655e-02 1.03903590e-02 4.43412997e-02 4.85513248e-02
 4.85513173e-02 9.05473065e-03 4.85513248e-02 4.85512987e-02
 8.82288162e-03 4.85569015e-02]
2025-06-02 15:29:57,561 - DEBUG - Edge reconstruction errors: [ 5.264825   5.262098  44.25805   ... 13.35803    2.1589825 13.35803  ]
2025-06-02 15:29:57,566 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_152957_update_45.json
2025-06-02 15:29:57,567 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:29:57,614 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_152957_update_45.pth
2025-06-02 15:29:57,615 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870445.dot): 0.9367
2025-06-02 15:29:57,615 - WARNING - Detected 11 anomalous nodes (reconstruction-based):
2025-06-02 15:29:57,615 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.4664, MLP Score: 0.4852
2025-06-02 15:29:57,616 - WARNING -   Node ID: 192.168.27.13, Recon Error: 1.3366, MLP Score: 0.5140
2025-06-02 15:29:57,616 - WARNING -   Node ID: 192.168.27.10, Recon Error: 1.4993, MLP Score: 0.5032
2025-06-02 15:29:57,616 - WARNING -   Node ID: 8.8.8.8, Recon Error: 0.9703, MLP Score: 0.5451
2025-06-02 15:29:57,616 - WARNING -   Node ID: 113.171.234.51, Recon Error: 1.0151, MLP Score: 0.5301
2025-06-02 15:29:57,617 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:29:57,617 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2581, MLP Score: 0.0265
2025-06-02 15:29:57,617 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9607, MLP Score: 0.0083
2025-06-02 15:29:57,618 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0602, MLP Score: 0.0083
2025-06-02 15:29:57,618 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7590, MLP Score: 0.0042
2025-06-02 15:29:57,618 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7583, MLP Score: 0.0035
2025-06-02 15:29:57,618 - INFO - 
--- Processing file: nw_graph_encoded_1748870475.dot (Timestamp: 2025-06-02 15:21:15) ---
2025-06-02 15:29:57,619 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870475.dot
2025-06-02 15:29:57,619 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870475.dot'.
2025-06-02 15:29:57,619 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870475.dot
2025-06-02 15:29:57,656 - INFO - Parsed 985 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870475.dot'.
2025-06-02 15:29:57,770 - INFO - Parsed 2150 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870475.dot'.
2025-06-02 15:29:57,771 - INFO - Processing node updates/additions.
2025-06-02 15:29:57,815 - INFO - Processing edge updates/additions.
2025-06-02 15:29:57,991 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:29:57,998 - INFO - Finished updating NetworkX graph.
2025-06-02 15:29:58,002 - DEBUG - Updated graph - Nodes: 985, Edges: 2150
2025-06-02 15:29:58,002 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:29:58,010 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:29:58,203 - DEBUG - Initial node features tensor shape: torch.Size([985, 30])
2025-06-02 15:29:58,207 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:29:58,211 - DEBUG - Node features tensor shape after scaling: torch.Size([985, 30])
2025-06-02 15:29:58,217 - DEBUG - Edge index tensor shape: torch.Size([2, 2150])
2025-06-02 15:29:58,230 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:29:58,328 - DEBUG - Initial edge attributes tensor shape: torch.Size([2150, 10])
2025-06-02 15:29:58,334 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:29:58,335 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2150, 10])
2025-06-02 15:29:58,336 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:29:58,337 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:29:58,341 - INFO - Updated main graph to 985 nodes and 2150 edges.
2025-06-02 15:29:58,341 - INFO - Performing online update...
2025-06-02 15:29:58,342 - INFO - Starting online update for 25 steps.
2025-06-02 15:29:58,343 - DEBUG - Updated RunningStats: new_mean=0.9448048532339003, new_var=26400000000161.727, new_n=2670
2025-06-02 15:29:58,343 - DEBUG - Updated RunningStats: new_mean=0.9425044059362168, new_var=26700000000018.18, new_n=2700
2025-06-02 15:29:58,344 - DEBUG - Updated RunningStats: new_mean=44.772114071386206, new_var=8800000186914.152, new_n=890
2025-06-02 15:29:58,345 - DEBUG - Updated RunningStats: new_mean=44.77169187834093, new_var=8900000173894.514, new_n=900
2025-06-02 15:29:58,345 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:29:58,345 - DEBUG - Online update step: 1/25
2025-06-02 15:29:58,353 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:58,486 - DEBUG - Node anomaly scores shape: torch.Size([18590, 1])
2025-06-02 15:29:58,495 - DEBUG - Edge anomaly scores shape: torch.Size([38669, 1])
2025-06-02 15:29:58,501 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:58,790 - DEBUG - Step 1: Loss=0.6505
2025-06-02 15:29:58,791 - DEBUG - Online update step: 2/25
2025-06-02 15:29:58,805 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:58,919 - DEBUG - Node anomaly scores shape: torch.Size([19910, 1])
2025-06-02 15:29:58,925 - DEBUG - Edge anomaly scores shape: torch.Size([41562, 1])
2025-06-02 15:29:58,927 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:59,166 - DEBUG - Step 2: Loss=0.6572
2025-06-02 15:29:59,167 - DEBUG - Online update step: 3/25
2025-06-02 15:29:59,175 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:59,277 - DEBUG - Node anomaly scores shape: torch.Size([18882, 1])
2025-06-02 15:29:59,281 - DEBUG - Edge anomaly scores shape: torch.Size([39556, 1])
2025-06-02 15:29:59,283 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:59,550 - DEBUG - Step 3: Loss=0.6733
2025-06-02 15:29:59,551 - DEBUG - Online update step: 4/25
2025-06-02 15:29:59,573 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:29:59,672 - DEBUG - Node anomaly scores shape: torch.Size([18142, 1])
2025-06-02 15:29:59,677 - DEBUG - Edge anomaly scores shape: torch.Size([37867, 1])
2025-06-02 15:29:59,678 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:29:59,928 - DEBUG - Step 4: Loss=0.6477
2025-06-02 15:29:59,929 - DEBUG - Online update step: 5/25
2025-06-02 15:29:59,942 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:00,049 - DEBUG - Node anomaly scores shape: torch.Size([17907, 1])
2025-06-02 15:30:00,054 - DEBUG - Edge anomaly scores shape: torch.Size([37228, 1])
2025-06-02 15:30:00,055 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:00,289 - DEBUG - Step 5: Loss=0.6607
2025-06-02 15:30:00,290 - DEBUG - Online update step: 6/25
2025-06-02 15:30:00,303 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:00,412 - DEBUG - Node anomaly scores shape: torch.Size([17256, 1])
2025-06-02 15:30:00,416 - DEBUG - Edge anomaly scores shape: torch.Size([35857, 1])
2025-06-02 15:30:00,418 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:00,661 - DEBUG - Step 6: Loss=0.6784
2025-06-02 15:30:00,662 - DEBUG - Online update step: 7/25
2025-06-02 15:30:00,675 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:00,784 - DEBUG - Node anomaly scores shape: torch.Size([18073, 1])
2025-06-02 15:30:00,789 - DEBUG - Edge anomaly scores shape: torch.Size([37590, 1])
2025-06-02 15:30:00,791 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:01,051 - DEBUG - Step 7: Loss=0.6518
2025-06-02 15:30:01,052 - DEBUG - Online update step: 8/25
2025-06-02 15:30:01,065 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:01,178 - DEBUG - Node anomaly scores shape: torch.Size([19134, 1])
2025-06-02 15:30:01,184 - DEBUG - Edge anomaly scores shape: torch.Size([40241, 1])
2025-06-02 15:30:01,186 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:01,448 - DEBUG - Step 8: Loss=0.6514
2025-06-02 15:30:01,449 - DEBUG - Online update step: 9/25
2025-06-02 15:30:01,462 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:01,568 - DEBUG - Node anomaly scores shape: torch.Size([18552, 1])
2025-06-02 15:30:01,573 - DEBUG - Edge anomaly scores shape: torch.Size([38508, 1])
2025-06-02 15:30:01,575 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:01,855 - DEBUG - Step 9: Loss=0.6705
2025-06-02 15:30:01,856 - DEBUG - Online update step: 10/25
2025-06-02 15:30:01,868 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:01,972 - DEBUG - Node anomaly scores shape: torch.Size([16642, 1])
2025-06-02 15:30:01,980 - DEBUG - Edge anomaly scores shape: torch.Size([34650, 1])
2025-06-02 15:30:01,982 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:02,195 - DEBUG - Step 10: Loss=0.6424
2025-06-02 15:30:02,196 - DEBUG - Online update step: 11/25
2025-06-02 15:30:02,209 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:02,316 - DEBUG - Node anomaly scores shape: torch.Size([18237, 1])
2025-06-02 15:30:02,320 - DEBUG - Edge anomaly scores shape: torch.Size([37957, 1])
2025-06-02 15:30:02,323 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:02,558 - DEBUG - Step 11: Loss=0.6616
2025-06-02 15:30:02,559 - DEBUG - Online update step: 12/25
2025-06-02 15:30:02,572 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:02,690 - DEBUG - Node anomaly scores shape: torch.Size([18557, 1])
2025-06-02 15:30:02,695 - DEBUG - Edge anomaly scores shape: torch.Size([38736, 1])
2025-06-02 15:30:02,697 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:02,941 - DEBUG - Step 12: Loss=0.6783
2025-06-02 15:30:02,942 - DEBUG - Online update step: 13/25
2025-06-02 15:30:02,955 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:03,055 - DEBUG - Node anomaly scores shape: torch.Size([16493, 1])
2025-06-02 15:30:03,059 - DEBUG - Edge anomaly scores shape: torch.Size([34093, 1])
2025-06-02 15:30:03,061 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:03,278 - DEBUG - Step 13: Loss=0.6505
2025-06-02 15:30:03,279 - DEBUG - Online update step: 14/25
2025-06-02 15:30:03,293 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:03,416 - DEBUG - Node anomaly scores shape: torch.Size([20258, 1])
2025-06-02 15:30:03,421 - DEBUG - Edge anomaly scores shape: torch.Size([42431, 1])
2025-06-02 15:30:03,423 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:03,718 - DEBUG - Step 14: Loss=0.6493
2025-06-02 15:30:03,719 - DEBUG - Online update step: 15/25
2025-06-02 15:30:03,732 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:03,844 - DEBUG - Node anomaly scores shape: torch.Size([19029, 1])
2025-06-02 15:30:03,848 - DEBUG - Edge anomaly scores shape: torch.Size([39780, 1])
2025-06-02 15:30:03,850 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:04,101 - DEBUG - Step 15: Loss=0.6671
2025-06-02 15:30:04,102 - DEBUG - Online update step: 16/25
2025-06-02 15:30:04,115 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:04,225 - DEBUG - Node anomaly scores shape: torch.Size([19250, 1])
2025-06-02 15:30:04,230 - DEBUG - Edge anomaly scores shape: torch.Size([40334, 1])
2025-06-02 15:30:04,232 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:04,485 - DEBUG - Step 16: Loss=0.6394
2025-06-02 15:30:04,486 - DEBUG - Online update step: 17/25
2025-06-02 15:30:04,499 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:04,604 - DEBUG - Node anomaly scores shape: torch.Size([18346, 1])
2025-06-02 15:30:04,608 - DEBUG - Edge anomaly scores shape: torch.Size([38141, 1])
2025-06-02 15:30:04,610 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:04,869 - DEBUG - Step 17: Loss=0.6581
2025-06-02 15:30:04,870 - DEBUG - Online update step: 18/25
2025-06-02 15:30:04,879 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:04,985 - DEBUG - Node anomaly scores shape: torch.Size([19432, 1])
2025-06-02 15:30:04,990 - DEBUG - Edge anomaly scores shape: torch.Size([40527, 1])
2025-06-02 15:30:04,991 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:05,237 - DEBUG - Step 18: Loss=0.6748
2025-06-02 15:30:05,237 - DEBUG - Online update step: 19/25
2025-06-02 15:30:05,246 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:05,352 - DEBUG - Node anomaly scores shape: torch.Size([18959, 1])
2025-06-02 15:30:05,357 - DEBUG - Edge anomaly scores shape: torch.Size([39530, 1])
2025-06-02 15:30:05,359 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:05,620 - DEBUG - Step 19: Loss=0.6464
2025-06-02 15:30:05,621 - DEBUG - Online update step: 20/25
2025-06-02 15:30:05,634 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:05,736 - DEBUG - Node anomaly scores shape: torch.Size([19158, 1])
2025-06-02 15:30:05,742 - DEBUG - Edge anomaly scores shape: torch.Size([40016, 1])
2025-06-02 15:30:05,743 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:05,984 - DEBUG - Step 20: Loss=0.6495
2025-06-02 15:30:05,985 - DEBUG - Online update step: 21/25
2025-06-02 15:30:05,993 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:06,088 - DEBUG - Node anomaly scores shape: torch.Size([16788, 1])
2025-06-02 15:30:06,092 - DEBUG - Edge anomaly scores shape: torch.Size([34801, 1])
2025-06-02 15:30:06,094 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:06,293 - DEBUG - Step 21: Loss=0.6669
2025-06-02 15:30:06,293 - DEBUG - Online update step: 22/25
2025-06-02 15:30:06,303 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:06,432 - DEBUG - Node anomaly scores shape: torch.Size([19559, 1])
2025-06-02 15:30:06,438 - DEBUG - Edge anomaly scores shape: torch.Size([41062, 1])
2025-06-02 15:30:06,440 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:06,679 - DEBUG - Step 22: Loss=0.6388
2025-06-02 15:30:06,680 - DEBUG - Online update step: 23/25
2025-06-02 15:30:06,687 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:06,781 - DEBUG - Node anomaly scores shape: torch.Size([18207, 1])
2025-06-02 15:30:06,785 - DEBUG - Edge anomaly scores shape: torch.Size([38056, 1])
2025-06-02 15:30:06,787 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:06,997 - DEBUG - Step 23: Loss=0.6545
2025-06-02 15:30:06,998 - DEBUG - Online update step: 24/25
2025-06-02 15:30:07,007 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:07,124 - DEBUG - Node anomaly scores shape: torch.Size([19822, 1])
2025-06-02 15:30:07,130 - DEBUG - Edge anomaly scores shape: torch.Size([41762, 1])
2025-06-02 15:30:07,132 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:07,432 - DEBUG - Step 24: Loss=0.6713
2025-06-02 15:30:07,432 - DEBUG - Online update step: 25/25
2025-06-02 15:30:07,441 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:07,542 - DEBUG - Node anomaly scores shape: torch.Size([18918, 1])
2025-06-02 15:30:07,547 - DEBUG - Edge anomaly scores shape: torch.Size([39569, 1])
2025-06-02 15:30:07,549 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:07,769 - DEBUG - Step 25: Loss=0.6433
2025-06-02 15:30:07,770 - INFO - Online update finished. Average loss: 0.6573, Learning rate: 0.001000
2025-06-02 15:30:07,771 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  7.2614794e-09  4.0664286e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  9.9240225e-09
  5.8091838e-09  2.7714647e-08  1.4522960e-09  1.3554762e-08
  2.2720811e+00  2.9614213e+00  1.4213198e-01  4.4060912e+00
 -2.9651041e-08  3.3949239e+00  5.8081217e+00  7.6182742e+00
  1.4213198e-01  7.9928932e+00 -4.8409865e-10 -3.3886906e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.3070664e-08  1.8879847e-08], current edge mean: [ 3.1049860e-09  4.5571396e+02  0.0000000e+00  0.0000000e+00
  3.5485557e-09  5.7664029e-09 -3.9921249e-09  3.5485557e-09
 -1.7742778e-09 -1.7742778e-09]
2025-06-02 15:30:07,772 - DEBUG - Node drift difference: 0.0114, Edge drift difference: 0.0015
2025-06-02 15:30:07,774 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  7.2614794e-09  4.0664286e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  9.9240225e-09
  5.8091838e-09  2.7714647e-08  1.4522960e-09  1.3554762e-08
  2.2720811e+00  2.9614213e+00  1.4213198e-01  4.4060912e+00
 -2.9651041e-08  3.3949239e+00  5.8081217e+00  7.6182742e+00
  1.4213198e-01  7.9928932e+00 -4.8409865e-10 -3.3886906e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.3070664e-08  1.8879847e-08], edge=[ 3.1049860e-09  4.5571396e+02  0.0000000e+00  0.0000000e+00
  3.5485557e-09  5.7664029e-09 -3.9921249e-09  3.5485557e-09
 -1.7742778e-09 -1.7742778e-09]
2025-06-02 15:30:07,775 - DEBUG - Updated reference std: node=[0.         0.         1.000508   1.000508   0.         0.
 0.         1.0005081  1.0005081  1.0005081  1.000508   1.000508
 0.9526825  0.2752198  0.36361656 0.57165736 1.000508   3.002603
 2.8995261  1.4748815  0.36361656 0.22303854 1.000508   1.0005081
 0.         0.         0.         0.         1.000508   1.000508  ], edge=[  1.0002327 440.33954     0.          0.          1.0002327   1.0002327
   1.0002326   1.0002326   1.0002326   1.0002326]
2025-06-02 15:30:07,775 - INFO - Online update complete. Loss: 0.6573
2025-06-02 15:30:07,775 - INFO - Running anomaly detection...
2025-06-02 15:30:07,776 - INFO - Starting anomaly detection.
2025-06-02 15:30:07,807 - DEBUG - Node reconstruction errors: [3.81661445e-01 1.21871269e+00 1.41651309e+00 9.72771086e-03
 4.64874692e-02 4.36877161e-02 5.76966643e-01 2.60687713e-02
 2.60687694e-02 2.91250385e-02 2.60687694e-02 4.47661690e-02
 1.62488830e+00 7.41334975e-01 5.44777606e-03 3.18627581e-02
 8.34678635e-02 3.18627767e-02 1.39991716e-01 3.21156867e-02
 2.25566030e-02 5.44779887e-03 1.87468693e-01 2.56029367e-02
 5.83676761e-03 9.30960383e-03 5.83676947e-03 1.18716083e-01
 2.62533799e-02 5.83676761e-03 3.20033282e-01 2.72965580e-01
 1.00876212e-01 1.00480579e-02 1.10587858e-01 1.52579576e-01
 1.65281802e-01 3.21156532e-02 2.83006489e-01 9.14834812e-02
 1.02287512e-02 4.43970412e-03 3.21156532e-02 6.17791340e-02
 8.12875688e-01 6.61471784e-02 4.02920507e-02 3.21234405e-01
 2.66044233e-02 4.27162260e-01 1.81168988e-01 1.32997353e-02
 9.36026312e-03 1.15627065e-01 2.96773147e-02 1.05801038e-01
 1.03925943e+00 3.37327532e-02 1.40613258e-01 1.60311386e-01
 2.74825752e-01 1.58946902e-01 3.62133980e-03 3.59539241e-02
 1.49724960e-01 2.96769459e-02 1.57288276e-02 2.96765286e-02
 3.62133980e-03 1.42606035e-01 1.27271399e-01 4.28891629e-02
 6.79175463e-03 1.35040298e-01 1.70065954e-01 4.15238515e-02
 1.52560204e-01 1.60341516e-01 1.54764682e-01 2.91520711e-02
 6.73903991e-03 4.01318818e-02 7.93434441e-01 1.11809626e-01
 4.55461629e-02 8.20745230e-02 5.88633865e-02 1.01326399e-01
 5.65928072e-02 1.63518324e-01 3.37432651e-03 4.97438572e-02
 2.53041424e-02 1.02557853e-01 8.66877586e-02 1.59798965e-01
 4.67961235e-03 5.57370633e-02 2.72419234e-03 9.08050984e-02
 3.52113880e-02 4.67963610e-03 1.32369613e-02 2.70548850e-01
 3.64308804e-02 1.77213270e-02 4.71887551e-02 4.74872515e-02
 2.66928151e-02 4.10012126e-01 2.01210111e-01 1.10355821e-02
 3.67257856e-02 1.00266092e-01 3.26488502e-02 1.33012772e-01
 3.18838619e-02 9.11968946e-02 7.57302493e-02 1.66139472e-02
 3.95436864e-03 2.04352308e-02 1.10704049e-01 4.27818559e-02
 7.35812709e-02 1.66146420e-02 3.66714485e-02 8.30055699e-02
 7.67488256e-02 2.33255345e-02 7.75152119e-03 8.95556528e-03
 9.23183560e-01 2.00447083e-01 2.94710491e-02 1.77388471e-02
 2.14131400e-02 2.50332966e-03 1.28745094e-01 1.62422732e-01
 5.52725233e-02 4.56580557e-02 6.12167129e-03 3.00542358e-02
 7.86175504e-02 1.16108984e-01 3.18838842e-02 1.74641848e-01
 4.70347740e-02 7.91966245e-02 4.46553230e-01 3.31409238e-02
 3.80713418e-02 8.95558577e-03 3.39217186e-02 7.14619458e-02
 7.33036641e-03 4.11098562e-02 3.52113582e-02 8.58809892e-03
 5.52725233e-02 3.68422419e-02 7.33031798e-03 7.75151188e-03
 3.18529494e-02 5.44351563e-02 3.52576412e-02 2.43909769e-02
 3.45731862e-02 7.91967064e-02 3.45365480e-02 1.61549598e-02
 2.74720648e-03 3.05856079e-01 7.57303089e-02 9.40280533e+00
 2.69869901e-02 5.81560880e-02 3.34035829e-02 3.34036574e-02
 1.76217761e-02 4.74464409e-02 4.60743271e-02 1.47763282e-01
 5.48043661e-02 3.68309245e-02 5.57564246e-03 4.01909500e-02
 1.78927947e-02 6.54070303e-02 3.96421812e-02 1.21434934e-01
 4.93440293e-02 1.25327585e-02 1.28742382e-01 3.85202211e-03
 8.71158838e-01 8.40330496e-02 4.09624018e-02 1.17077306e-01
 1.75221171e-02 7.33030727e-03 3.23719345e-02 9.07957926e-02
 1.19002432e-01 3.12103275e-02 2.73407977e-02 1.96538270e-01
 3.91049217e-03 3.30922268e-02 2.99810413e-02 9.96810347e-02
 9.57020745e-03 3.77499945e-02 4.65263389e-02 8.90774094e-03
 1.05140544e-01 3.18838507e-02 1.16031215e-01 7.64906108e-02
 1.83171570e-01 5.57564199e-03 2.40832311e-03 9.57020745e-03
 7.33034220e-03 1.05781078e-01 9.48120505e-02 1.64690390e-02
 1.21247582e-01 2.12325267e-02 1.58945043e-02 5.65115735e-02
 8.79791528e-02 3.18838134e-02 3.18838805e-02 2.24065520e-02
 3.27831618e-02 2.40832521e-03 7.33036641e-03 1.01788513e-01
 6.90627322e-02 1.02363423e-01 1.50389243e-02 7.21791759e-02
 1.61519311e-02 8.09964687e-02 3.66510861e-02 5.65017127e-02
 1.50389243e-02 1.63760502e-02 2.74717133e-03 2.28080992e-03
 1.16031125e-01 2.42017042e-02 8.81967172e-02 5.22070341e-02
 7.01183965e-03 5.57033019e-03 6.98324963e-02 3.34036499e-02
 2.70988587e-02 5.80767468e-02 2.70315334e-02 5.21991476e-02
 1.21550396e-01 7.41900504e-02 7.07620308e-02 2.94832975e-01
 7.07620606e-02 3.02630346e-02 1.73335955e-01 1.25021651e-01
 3.69605608e-02 9.26572904e-02 3.31408419e-02 1.18330844e-01
 1.35908881e-02 1.13235287e-01 1.76217854e-02 4.06797193e-02
 1.62552610e-01 1.43047702e-02 2.63753422e-02 6.70481799e-03
 8.33743289e-02 4.53636562e-03 2.68064082e-01 6.21470846e-02
 4.74463888e-02 6.13784730e-01 9.01036337e-02 1.15904631e-02
 6.13522083e-02 1.61519218e-02 8.63410532e-01 1.32597871e-02
 2.71226168e-02 3.34034674e-02 3.85204260e-03 9.11766469e-01
 2.89281923e-02 8.31953138e-02 3.08833160e-02 5.14282212e-02
 1.78039586e-03 1.78039586e-03 1.78039586e-03 3.60061750e-02
 6.17884025e-02 8.31953064e-02 1.78039586e-03 2.92738285e-02
 1.78039586e-03 5.55284135e-02 2.74372939e-02 3.98051254e-02
 1.72907338e-01 3.11857723e-02 9.71582532e-03 4.09577508e-03
 6.92616478e-02 3.35639566e-02 7.46374279e-02 3.08833141e-02
 4.34696041e-02 1.35325193e-01 1.41287819e-01 5.47324903e-02
 3.93750779e-02 3.93750146e-02 1.82418391e-01 3.45702213e-03
 1.78039586e-03 3.31408642e-02 1.78037840e-03 3.60061899e-02
 3.53976563e-02 1.97765278e-03 9.62707698e-02 2.20565475e-03
 8.31953064e-02 8.90041981e-03 2.20577931e-03 1.12527601e-01
 4.29253317e-02 6.60852343e-02 3.08833029e-02 6.00201217e-03
 7.41825402e-02 3.06490697e-02 1.78037840e-03 3.16367783e-02
 2.80565955e-02 9.62192193e-02 7.95658585e-03 7.01182568e-03
 9.55859497e-02 1.78037840e-03 2.12174118e-03 5.16556837e-02
 7.48943537e-02 1.07411230e-02 1.15175270e-01 5.76345921e-02
 3.08832824e-02 3.03179234e-01 2.04790873e-03 4.87311371e-02
 3.16473246e-02 2.55885720e-02 3.37418988e-02 5.48638776e-02
 6.73281103e-02 3.71996127e-02 6.79811090e-02 5.58506176e-02
 2.10927380e-03 1.78475436e-02 4.37816493e-02 1.78039586e-03
 3.08833048e-02 2.54225973e-02 6.32630521e-03 2.79064495e-02
 2.57728770e-02 4.74976897e-02 3.44357155e-02 4.81214188e-02
 5.80765605e-02 1.78039586e-03 9.59062427e-02 9.30106565e-02
 3.08596585e-02 8.21640193e-02 5.44318929e-02 5.44318445e-02
 5.44318706e-02 1.39227390e-01 1.57088821e-03 2.67078817e-01
 5.75016998e-02 6.39065802e-02 9.73443240e-02 1.57088821e-03
 3.22793350e-02 3.08597069e-02 7.15884119e-02 1.50951482e-02
 3.08596920e-02 5.00878729e-02 5.44318967e-02 3.08596957e-02
 1.57088821e-03 5.44319339e-02 5.44319600e-02 6.66451734e-03
 9.27156862e-03 5.44318967e-02 1.05074987e-01 3.46100815e-02
 2.09007487e-02 5.32172807e-03 2.65382621e-02 6.11468544e-03
 9.88264903e-02 4.19142023e-02 9.00563598e-03 4.34384868e-02
 9.87355188e-02 1.07639832e-02 7.50105232e-02 1.75452828e-02
 4.44844104e-02 4.58970107e-02 5.00246845e-02 5.44319339e-02
 6.46798639e-03 6.48315251e-02 1.05702832e-01 5.26928939e-02
 2.65941508e-02 1.71397347e-02 1.33817092e-01 4.39909520e-03
 4.18052897e-02 3.37737873e-02 1.15659520e-01 4.89051174e-03
 3.40747740e-03 8.11761618e-03 5.16449958e-02 1.80101942e-03
 1.08457180e-02 6.02327324e-02 1.80101942e-03 1.86357424e-02
 6.11468358e-03 1.71493217e-02 1.43266888e-02 8.28476921e-02
 3.03075351e-02 1.11167869e-02 4.95046284e-03 3.68217416e-02
 4.95046284e-03 1.11167869e-02 1.58310123e-03 3.35990824e-02
 3.89126688e-02 3.52479657e-03 1.58310123e-03 3.03075630e-02
 4.55891937e-02 2.81545430e-01 8.77308547e-02 2.65368111e-02
 3.35990340e-02 3.03075667e-02 1.64421322e-03 1.45527953e-02
 5.20722428e-03 1.85887054e-01 2.73129940e-02 4.89048893e-03
 9.33515131e-02 1.08038168e-02 1.80103153e-03 5.42457663e-02
 2.58605201e-02 2.81497896e-01 2.78743263e-02 1.64418586e-03
 3.06448657e-02 2.81318952e-03 7.54707158e-02 8.26333277e-03
 2.93244608e-02 1.93570584e-01 1.45869027e-03 1.45527888e-02
 1.11833319e-01 2.81319371e-03 1.16552845e-01 1.39461495e-02
 1.52208598e-03 3.29457112e-02 1.39505265e-03 4.37039644e-01
 6.72337180e-03 1.80101942e-03 9.17232968e-03 1.35693047e-02
 1.35693336e-02 7.29327369e-03 6.79463819e-02 2.02278420e-02
 1.39504636e-03 2.82140486e-02 1.06168063e-02 4.62900959e-02
 7.16513246e-02 1.71397347e-02 1.39505265e-03 3.60474437e-02
 1.52209715e-03 2.93244477e-02 8.28950014e-03 6.42799214e-02
 7.16511533e-02 6.76493570e-02 2.02278420e-02 7.39050210e-02
 1.45868526e-03 1.45527832e-02 2.93244738e-02 3.00694089e-02
 4.37052809e-02 6.50050715e-02 1.45867502e-03 4.97036763e-02
 1.45868212e-03 6.51689544e-02 8.16314444e-02 2.82140560e-02
 8.07917118e-03 4.39758115e-02 3.49090025e-02 1.36607687e-03
 8.88931215e-01 1.36606046e-03 1.36606791e-03 1.36608316e-03
 1.36608444e-03 1.36607687e-03 1.36607687e-03 1.36607583e-03
 3.26483585e-02 7.65153579e-03 2.63602324e-02 1.36606256e-03
 1.36607687e-03 1.36606256e-03 1.36606791e-03 1.36607687e-03
 1.36606256e-03 1.36607687e-03 1.36607687e-03 1.36606791e-03
 2.74014343e-02 1.36606372e-03 1.36608316e-03 9.44234207e-02
 1.36606791e-03 2.94358414e-02 3.17500234e-02 1.45868445e-03
 7.39201605e-02 4.40761819e-02 4.80831526e-02 4.80831526e-02
 6.99602142e-02 7.39201605e-02 1.45869027e-03 1.39505265e-03
 1.39505265e-03 6.98759332e-02 1.39505265e-03 1.41603230e-02
 3.65642905e-02 1.36606791e-03 1.71397347e-02 1.45868317e-03
 1.35693494e-02 1.45868317e-03 1.45868526e-03 4.55520600e-02
 1.45868212e-03 1.39504636e-03 1.45868445e-03 1.45868526e-03
 8.45575184e-02 1.39505265e-03 1.45867502e-03 1.39504636e-03
 1.45867502e-03 1.45868526e-03 1.45868526e-03 6.94704056e-02
 6.11449406e-02 2.55532842e-02 1.36606372e-03 2.44334899e-02
 5.77081554e-02 1.45868212e-03 1.39504636e-03 5.47851250e-02
 1.36606046e-03 2.63072364e-02 4.40885499e-02 2.46772077e-03
 1.45867502e-03 1.45867502e-03 2.81792190e-02 7.53748044e-02
 2.31541321e-02 1.45869027e-03 3.26483324e-02 7.62174372e-03
 1.39504636e-03 5.18853106e-02 1.36606046e-03 1.90304127e-02
 5.50114475e-02 1.36606256e-03 1.36606791e-03 3.26484106e-02
 7.62173673e-03 1.45868526e-03 1.38723239e-01 7.70991892e-02
 5.05882539e-02 7.53748044e-02 1.94467716e-02 4.77184318e-02
 4.77185063e-02 3.16126384e-02 1.02344872e-02 1.36606046e-03
 1.28489584e-02 3.78216878e-02 7.53748268e-02 2.58911643e-02
 1.42957149e-02 1.88802909e-02 1.32246024e-03 1.32245908e-03
 1.32246024e-03 1.32246024e-03 1.32246024e-03 2.68262792e-02
 3.49896811e-02 1.32245186e-03 1.32245908e-03 1.36606256e-03
 7.23991077e-03 1.36606046e-03 4.77184318e-02 7.13904873e-02
 4.94869240e-02 9.56210680e-03 7.25524202e-02 7.21721649e-02
 2.74014659e-02 1.80011466e-02 2.74014287e-02 1.36608316e-03
 4.77185249e-02 1.49920559e-03 1.32934994e-03 1.32927520e-03
 1.32246024e-03 1.49920559e-03 5.63456938e-02 1.60796698e-02
 2.05764975e-02 1.36608316e-03 1.32245908e-03 2.51616258e-02
 1.32926961e-03 5.98511435e-02 1.54181640e-03 2.48895418e-02
 2.68262941e-02 2.92105973e-01 4.02754731e-03 8.61748755e-02
 2.29667947e-02 1.54180988e-03 4.81184106e-03 1.58546446e-03
 1.49496796e-03 5.99060301e-03 4.23867144e-02 1.92738194e-02
 4.48645614e-02 1.54182536e-03 1.54180988e-03 1.54180988e-03
 1.28433888e-03 2.51615867e-02 1.54182536e-03 1.49497250e-03
 1.54182536e-03 1.54182024e-03 1.54182536e-03 2.50335224e-02
 1.58945203e-03 6.43220395e-02 5.94029054e-02 4.10292298e-02
 3.99769358e-02 3.19539867e-02 5.17832637e-02 1.55269250e-01
 1.50162191e-03 1.60928594e-03 5.59681002e-03 4.90476526e-02
 3.02833524e-02 1.49496796e-03 9.33912471e-02 1.32485226e-01
 1.50172983e-03 1.24305557e-03 1.73095744e-02 6.94257542e-02
 1.67385931e-03 1.67385931e-03 1.67386059e-03 1.29829592e-03
 1.03319692e-03 5.17837964e-02 4.01154943e-02 1.38188064e-01
 4.61287703e-03 3.15299234e-03 1.16250496e-02 1.24305557e-03
 5.91004826e-03 2.13845205e-02 1.08929235e-03 1.26401568e-02
 1.50172983e-03 1.32484317e-01 1.24305091e-03 2.13845298e-02
 3.15299234e-03 5.75372726e-02 1.67385489e-03 1.29827939e-03
 1.08929235e-03 1.56993959e-02 3.14429663e-02 1.29829941e-03
 1.29829161e-03 1.29829941e-03 6.27116114e-02 5.49264133e-01
 1.49293756e+00 1.67385931e-03 1.27764493e-01 1.29829370e-03
 3.81440446e-02 1.00457314e-02 2.17865214e-01 1.58552807e-02
 1.29829370e-03 1.40031718e-03 6.95763808e-03 1.54539268e-03
 1.90151185e-01 1.58552770e-02 1.58597022e-01 4.06439370e-03
 5.61393276e-02 1.58552770e-02 3.70569937e-02 3.27356271e-02
 1.05820922e-02 5.54765873e-02 2.61081234e-02 1.60671934e-03
 1.60673284e-03 1.46333277e-01 1.34263650e-01 4.29924987e-02
 1.58552807e-02 1.05820922e-02 1.58552676e-02 1.44839310e-03
 1.69670640e-03 1.69670617e-03 1.01612485e-03 7.21938387e-02
 5.09195356e-03 1.69670838e-03 1.44839741e-03 6.32547261e-03
 1.69670640e-03 1.69670838e-03 1.54641725e-03 1.51864607e-02
 7.31014311e-02 5.84367849e-02 1.69670838e-03 2.92046051e-02
 6.32543722e-03 1.69670838e-03 1.83143339e-03 1.13546997e-02
 2.91205314e-03 2.91204592e-03 5.20803817e-02 7.25032669e-03
 1.69670640e-03 7.25032669e-03 8.65118764e-03 6.81096837e-02
 4.04533483e-02 1.69670617e-03 1.41015247e-01 7.31722405e-03
 7.31721567e-03 1.19379470e-02 1.73204939e-03 1.14497226e-02
 1.83143956e-03 5.92040597e-03 1.20112742e-03 3.61649655e-02
 1.61826219e-02 3.61650325e-02 1.55772015e-01 1.60723412e-03
 1.61826201e-02 1.91970996e-03 1.91972603e-03 2.31942311e-01
 1.91971764e-03 3.08257658e-02 1.73204939e-03 3.23987529e-02
 1.20571703e-02 1.60723983e-03 1.20571824e-02 5.89433461e-02
 5.93777634e-02 6.20860904e-02 1.91971764e-03 1.32277803e-02
 1.40899504e-02 1.91972009e-03 7.31162876e-02 4.79553938e-02
 6.90961163e-03 1.60723820e-03 1.91970996e-03 1.47439182e-01
 8.74383748e-03 1.11587048e-02 1.91972009e-03 2.09741248e-03
 2.57732738e-02 2.09741271e-03 1.11587048e-02 2.09740596e-03
 2.72544734e-02 3.49659063e-02 7.34407827e-02 1.91970996e-03
 8.74385517e-03 8.74383748e-03 1.91971764e-03 1.90183148e-01
 1.11587048e-02 2.09740596e-03 8.74385238e-03 1.91972009e-03
 8.74378998e-03 1.37848873e-02 8.74377508e-03 1.91970996e-03
 1.37454597e-03 1.11587085e-02 1.80104375e-03 1.65690035e-01
 1.37454038e-03 8.74385238e-03 1.91972009e-03 1.01615796e-02
 3.36686522e-02 3.27189751e-02 3.27189900e-02 2.01440346e-03
 4.10090424e-02 8.03251099e-03 1.37940785e-02 1.82807907e-01
 3.27189751e-02 2.43234262e-03 3.27189639e-02 1.21613247e-02
 1.37940887e-02 3.27189751e-02 2.17582379e-03 1.80105073e-03
 1.80947576e-02 3.41601763e-03 2.82859174e-03 1.70999824e-03
 1.65382046e-02 2.71942024e-03 2.57339771e-03 2.57340679e-03
 3.40845585e-02 3.02342754e-02 2.57341145e-03 2.57337233e-03
 3.49948891e-02 3.11800130e-02 2.57341145e-03 2.57339329e-03
 2.57337419e-03 2.57338001e-03 3.02342866e-02 3.02342959e-02
 3.02343089e-02 3.02342810e-02 2.74538565e-02 1.89795550e-02
 3.02342642e-02 3.02343015e-02 3.02342772e-02 2.57340679e-03
 1.72389284e-01 3.02343778e-02 2.99068610e-03 3.02342419e-02
 3.01340339e-03 3.94093711e-03 1.08148456e-01 2.57340679e-03
 1.15388878e-01 3.94093711e-03 2.27063671e-02 3.39543335e-02
 3.39543335e-02 4.06476995e-03 3.39543335e-02 3.39543633e-02
 3.92134953e-03 3.90927568e-02 3.74834165e-02 6.42504636e-03
 6.42503519e-03 6.42503519e-03 6.42504310e-03 6.42503519e-03
 6.42504636e-03 2.74645805e-01 3.74834165e-02 4.06478671e-03
 1.03640556e-01 6.42503519e-03 1.89027730e-02 6.42503519e-03
 3.74834016e-02 6.35208050e-03 2.70905327e-02 5.60072139e-02
 3.74834016e-02 3.74834016e-02 2.26882920e-02 6.42503519e-03
 3.74833681e-02]
2025-06-02 15:30:07,807 - DEBUG - Edge reconstruction errors: [ 5.264422   5.261725  44.25771   ... 13.357691   2.1586356 13.357691 ]
2025-06-02 15:30:07,810 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_153007_update_46.json
2025-06-02 15:30:07,811 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:30:07,850 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_153007_update_46.pth
2025-06-02 15:30:07,851 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870475.dot): 0.9381
2025-06-02 15:30:07,851 - WARNING - Detected 9 anomalous nodes (reconstruction-based):
2025-06-02 15:30:07,851 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.2187, MLP Score: 0.4856
2025-06-02 15:30:07,851 - WARNING -   Node ID: 192.168.27.13, Recon Error: 1.4165, MLP Score: 0.5067
2025-06-02 15:30:07,852 - WARNING -   Node ID: 192.168.27.10, Recon Error: 1.6249, MLP Score: 0.5187
2025-06-02 15:30:07,852 - WARNING -   Node ID: 192.168.209.130, Recon Error: 1.0393, MLP Score: 0.4874
2025-06-02 15:30:07,852 - WARNING -   Node ID: 142.250.199.67, Recon Error: 0.9232, MLP Score: 0.5563
2025-06-02 15:30:07,852 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:30:07,852 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2577, MLP Score: 0.8331
2025-06-02 15:30:07,853 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9603, MLP Score: 0.9544
2025-06-02 15:30:07,853 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0600, MLP Score: 0.9544
2025-06-02 15:30:07,853 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7585, MLP Score: 0.9470
2025-06-02 15:30:07,854 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7581, MLP Score: 0.9487
2025-06-02 15:30:07,866 - DEBUG - Embedding standard deviations before t-SNE: [1.3944354  0.         0.797973   1.5614612  0.00372477 0.5839018
 1.0167092  0.39645186 0.32660624 2.6227648  2.110521   1.9809198
 1.2456812  0.69648844 1.2115774  1.1553553  0.04879647 0.7758285
 0.         1.3653158  0.30834833 1.7718982  0.         0.10392723
 0.5389366  0.95621    0.02808597 1.4283704  2.0325155  0.
 1.232711   1.173651  ]
2025-06-02 15:30:09,087 - INFO - Embeddings visualization saved to vis/embeddings_46_updates_20250602_153007.png
2025-06-02 15:30:09,088 - INFO - Performing visualization of node and edge features.
2025-06-02 15:30:09,095 - INFO - Starting visualization of node features.
2025-06-02 15:30:09,095 - INFO - Graph has 985 nodes and 30 features.
2025-06-02 15:30:09,095 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:30:09,096 - INFO - Calculating feature statistics:
2025-06-02 15:30:09,096 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:30:09,096 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:30:09,097 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 24, 'mean': np.float32(3.0982314e-08), 'std': np.float32(1.0), 'min': np.float32(-1.7551239), 'max': np.float32(2.4481673)}
2025-06-02 15:30:09,097 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 24, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.3552341), 'max': np.float32(1.85407)}
2025-06-02 15:30:09,097 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:30:09,098 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:30:09,098 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:30:09,098 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(1.5491157e-08), 'std': np.float32(1.0), 'min': np.float32(-0.45509103), 'max': np.float32(2.1973627)}
2025-06-02 15:30:09,099 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.1244411), 'max': np.float32(0.8893307)}
2025-06-02 15:30:09,099 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 4, 'mean': np.float32(3.4855102e-08), 'std': np.float32(0.99999994), 'min': np.float32(-9.349739), 'max': np.float32(0.10923729)}
2025-06-02 15:30:09,099 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 24, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.3229966), 'max': np.float32(1.4913315)}
2025-06-02 15:30:09,099 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 24, 'mean': np.float32(1.5491157e-08), 'std': np.float32(1.0), 'min': np.float32(-1.4571143), 'max': np.float32(2.4393346)}
2025-06-02 15:30:09,100 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 9, 'mean': np.float32(2.2720811), 'std': np.float32(0.95219874), 'min': np.float32(0.0), 'max': np.float32(11.0)}
2025-06-02 15:30:09,100 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.9614213), 'std': np.float32(0.27508003), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:30:09,100 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.14213198), 'std': np.float32(0.36343193), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:30:09,101 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.406091), 'std': np.float32(0.57136714), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:30:09,101 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 4, 'mean': np.float32(-3.4855102e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.10923729), 'max': np.float32(9.349739)}
2025-06-02 15:30:09,101 - INFO - - service_1: {'name': 'service_1', 'unique': 6, 'mean': np.float32(3.394924), 'std': np.float32(3.0010784), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 15:30:09,102 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.8081217), 'std': np.float32(2.8980536), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:30:09,102 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.618274), 'std': np.float32(1.4741325), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:30:09,102 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.14213198), 'std': np.float32(0.36343193), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:30:09,102 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 2, 'mean': np.float32(7.992893), 'std': np.float32(0.22292528), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:30:09,103 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(3.872789e-09), 'std': np.float32(1.0), 'min': np.float32(-0.12862214), 'max': np.float32(16.396528)}
2025-06-02 15:30:09,103 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(-2.9045918e-08), 'std': np.float32(1.0), 'min': np.float32(-0.14024527), 'max': np.float32(7.1303654)}
2025-06-02 15:30:09,103 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:30:09,104 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:30:09,104 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:30:09,104 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:30:09,104 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 6, 'mean': np.float32(7.745578e-09), 'std': np.float32(1.0), 'min': np.float32(-0.9681856), 'max': np.float32(10.4042845)}
2025-06-02 15:30:09,105 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(1.5491157e-08), 'std': np.float32(1.0), 'min': np.float32(-1.0705417), 'max': np.float32(4.459967)}
2025-06-02 15:30:09,176 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7f929029dc10>
2025-06-02 15:30:09,963 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:30:10,340 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:30:10,517 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:30:15,289 - INFO - Node feature visualization saved to vis/node_features_20250602_153011.png
2025-06-02 15:30:15,289 - INFO - Finished visualization of node features.
2025-06-02 15:30:15,290 - INFO - Performing additional feature analysis:
2025-06-02 15:30:15,290 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:30:15,303 - INFO - Starting visualization of edge features.
2025-06-02 15:30:15,303 - INFO - Graph has 2150 edges and 10 edge features.
2025-06-02 15:30:15,304 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:30:15,304 - INFO - Calculating edge feature statistics:
2025-06-02 15:30:15,305 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:30:15,305 - INFO - - count: {'name': 'count', 'unique': 38, 'mean': np.float32(3.5485557e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.035350062), 'max': np.float32(35.62755)}
2025-06-02 15:30:15,306 - INFO - - dst_port: {'name': 'dst_port', 'unique': 19, 'mean': np.float32(455.71396), 'std': np.float32(440.23712), 'min': np.float32(0.0), 'max': np.float32(8898.0)}
2025-06-02 15:30:15,306 - INFO - - protocol: {'name': 'protocol', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:30:15,306 - INFO - - service: {'name': 'service', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:30:15,306 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 1444, 'mean': np.float32(-8.871389e-10), 'std': np.float32(1.0), 'min': np.float32(-0.05988589), 'max': np.float32(29.227173)}
2025-06-02 15:30:15,306 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 1519, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.056591857), 'max': np.float32(32.76064)}
2025-06-02 15:30:15,307 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 500, 'mean': np.float32(-3.5485557e-09), 'std': np.float32(1.0), 'min': np.float32(-0.0443943), 'max': np.float32(35.470356)}
2025-06-02 15:30:15,307 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 1493, 'mean': np.float32(2.6614166e-09), 'std': np.float32(1.0), 'min': np.float32(-0.08654886), 'max': np.float32(29.027)}
2025-06-02 15:30:15,307 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 1521, 'mean': np.float32(2.6614166e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.086640574), 'max': np.float32(28.039663)}
2025-06-02 15:30:15,307 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 547, 'mean': np.float32(-1.7742778e-09), 'std': np.float32(1.0), 'min': np.float32(-0.053714637), 'max': np.float32(34.84866)}
2025-06-02 15:30:15,377 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7f9290db5460>
2025-06-02 15:30:15,837 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:30:15,903 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7f92a0129df0>
2025-06-02 15:30:16,287 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:30:16,741 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:30:17,162 - DEBUG - Plotted boxplots of the first 8 non-constant edge features.
2025-06-02 15:30:17,533 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:30:17,564 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:30:21,338 - INFO - Edge feature visualization saved to vis/edge_features_20250602_153017.png
2025-06-02 15:30:21,338 - INFO - Finished visualization of edge features.
2025-06-02 15:30:21,338 - INFO - Performing additional edge feature analysis:
2025-06-02 15:30:21,339 - INFO - - 2 out of 10 edge features are constant.
2025-06-02 15:30:21,339 - INFO - - Highest correlation (1.00) between features: 'total_resp_bytes' and 'total_resp_ip_bytes'.
2025-06-02 15:30:21,352 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:30:21,353 - INFO - Graph has 2150 edges and 10 edge features.
2025-06-02 15:30:21,353 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:30:22,550 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_153021_summary.png
2025-06-02 15:30:23,616 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_153021_pca_3d.png
2025-06-02 15:30:24,130 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_153021_pca_variance.png
2025-06-02 15:30:24,130 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:30:24,130 - INFO - 
--- Processing file: nw_graph_encoded_1748870505.dot (Timestamp: 2025-06-02 15:21:45) ---
2025-06-02 15:30:24,131 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870505.dot
2025-06-02 15:30:24,131 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870505.dot'.
2025-06-02 15:30:24,131 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870505.dot
2025-06-02 15:30:24,169 - INFO - Parsed 994 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870505.dot'.
2025-06-02 15:30:24,286 - INFO - Parsed 2170 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870505.dot'.
2025-06-02 15:30:24,286 - INFO - Processing node updates/additions.
2025-06-02 15:30:24,328 - INFO - Processing edge updates/additions.
2025-06-02 15:30:24,510 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:30:24,518 - INFO - Finished updating NetworkX graph.
2025-06-02 15:30:24,522 - DEBUG - Updated graph - Nodes: 994, Edges: 2170
2025-06-02 15:30:24,523 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:30:24,530 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:30:24,729 - DEBUG - Initial node features tensor shape: torch.Size([994, 30])
2025-06-02 15:30:24,738 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:30:24,753 - DEBUG - Node features tensor shape after scaling: torch.Size([994, 30])
2025-06-02 15:30:24,765 - DEBUG - Edge index tensor shape: torch.Size([2, 2170])
2025-06-02 15:30:24,784 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:30:24,883 - DEBUG - Initial edge attributes tensor shape: torch.Size([2170, 10])
2025-06-02 15:30:24,886 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:30:24,887 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2170, 10])
2025-06-02 15:30:24,887 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:30:24,888 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:30:24,892 - INFO - Updated main graph to 994 nodes and 2170 edges.
2025-06-02 15:30:24,892 - INFO - Performing online update...
2025-06-02 15:30:24,893 - INFO - Starting online update for 25 steps.
2025-06-02 15:30:24,894 - DEBUG - Updated RunningStats: new_mean=0.944865281087555, new_var=27000000000161.66, new_n=2730
2025-06-02 15:30:24,894 - DEBUG - Updated RunningStats: new_mean=0.9426092598686419, new_var=27300000000018.19, new_n=2760
2025-06-02 15:30:24,895 - DEBUG - Updated RunningStats: new_mean=44.78016724714231, new_var=9000000186680.312, new_n=910
2025-06-02 15:30:24,895 - DEBUG - Updated RunningStats: new_mean=44.7775372179632, new_var=9100000172348.469, new_n=920
2025-06-02 15:30:24,896 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:30:24,896 - DEBUG - Online update step: 1/25
2025-06-02 15:30:24,904 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:25,051 - DEBUG - Node anomaly scores shape: torch.Size([17919, 1])
2025-06-02 15:30:25,076 - DEBUG - Edge anomaly scores shape: torch.Size([37532, 1])
2025-06-02 15:30:25,078 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:25,335 - DEBUG - Step 1: Loss=0.6489
2025-06-02 15:30:25,335 - DEBUG - Online update step: 2/25
2025-06-02 15:30:25,352 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:25,713 - DEBUG - Node anomaly scores shape: torch.Size([17407, 1])
2025-06-02 15:30:25,723 - DEBUG - Edge anomaly scores shape: torch.Size([36214, 1])
2025-06-02 15:30:25,724 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:25,951 - DEBUG - Step 2: Loss=0.6659
2025-06-02 15:30:25,952 - DEBUG - Online update step: 3/25
2025-06-02 15:30:25,960 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:26,105 - DEBUG - Node anomaly scores shape: torch.Size([18991, 1])
2025-06-02 15:30:26,114 - DEBUG - Edge anomaly scores shape: torch.Size([39918, 1])
2025-06-02 15:30:26,117 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:26,365 - DEBUG - Step 3: Loss=0.6384
2025-06-02 15:30:26,365 - DEBUG - Online update step: 4/25
2025-06-02 15:30:26,374 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:26,486 - DEBUG - Node anomaly scores shape: torch.Size([19021, 1])
2025-06-02 15:30:26,492 - DEBUG - Edge anomaly scores shape: torch.Size([39548, 1])
2025-06-02 15:30:26,494 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:26,752 - DEBUG - Step 4: Loss=0.6522
2025-06-02 15:30:26,752 - DEBUG - Online update step: 5/25
2025-06-02 15:30:26,761 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:26,853 - DEBUG - Node anomaly scores shape: torch.Size([18590, 1])
2025-06-02 15:30:26,857 - DEBUG - Edge anomaly scores shape: torch.Size([38830, 1])
2025-06-02 15:30:26,859 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:27,065 - DEBUG - Step 5: Loss=0.6694
2025-06-02 15:30:27,066 - DEBUG - Online update step: 6/25
2025-06-02 15:30:27,076 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:27,208 - DEBUG - Node anomaly scores shape: torch.Size([18207, 1])
2025-06-02 15:30:27,212 - DEBUG - Edge anomaly scores shape: torch.Size([37932, 1])
2025-06-02 15:30:27,213 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:27,462 - DEBUG - Step 6: Loss=0.6419
2025-06-02 15:30:27,463 - DEBUG - Online update step: 7/25
2025-06-02 15:30:27,472 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:27,570 - DEBUG - Node anomaly scores shape: torch.Size([18685, 1])
2025-06-02 15:30:27,576 - DEBUG - Edge anomaly scores shape: torch.Size([39139, 1])
2025-06-02 15:30:27,578 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:27,851 - DEBUG - Step 7: Loss=0.6481
2025-06-02 15:30:27,852 - DEBUG - Online update step: 8/25
2025-06-02 15:30:27,861 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:27,954 - DEBUG - Node anomaly scores shape: torch.Size([18422, 1])
2025-06-02 15:30:27,960 - DEBUG - Edge anomaly scores shape: torch.Size([38535, 1])
2025-06-02 15:30:27,961 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:28,209 - DEBUG - Step 8: Loss=0.6637
2025-06-02 15:30:28,210 - DEBUG - Online update step: 9/25
2025-06-02 15:30:28,223 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:28,333 - DEBUG - Node anomaly scores shape: torch.Size([19996, 1])
2025-06-02 15:30:28,338 - DEBUG - Edge anomaly scores shape: torch.Size([41986, 1])
2025-06-02 15:30:28,340 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:28,618 - DEBUG - Step 9: Loss=0.6376
2025-06-02 15:30:28,618 - DEBUG - Online update step: 10/25
2025-06-02 15:30:28,627 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:28,724 - DEBUG - Node anomaly scores shape: torch.Size([19245, 1])
2025-06-02 15:30:28,728 - DEBUG - Edge anomaly scores shape: torch.Size([40249, 1])
2025-06-02 15:30:28,730 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:28,964 - DEBUG - Step 10: Loss=0.6510
2025-06-02 15:30:28,964 - DEBUG - Online update step: 11/25
2025-06-02 15:30:28,972 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:29,076 - DEBUG - Node anomaly scores shape: torch.Size([18293, 1])
2025-06-02 15:30:29,080 - DEBUG - Edge anomaly scores shape: torch.Size([38047, 1])
2025-06-02 15:30:29,082 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:29,339 - DEBUG - Step 11: Loss=0.6689
2025-06-02 15:30:29,340 - DEBUG - Online update step: 12/25
2025-06-02 15:30:29,353 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:29,465 - DEBUG - Node anomaly scores shape: torch.Size([20411, 1])
2025-06-02 15:30:29,471 - DEBUG - Edge anomaly scores shape: torch.Size([42968, 1])
2025-06-02 15:30:29,473 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:29,779 - DEBUG - Step 12: Loss=0.6415
2025-06-02 15:30:29,780 - DEBUG - Online update step: 13/25
2025-06-02 15:30:29,789 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:29,900 - DEBUG - Node anomaly scores shape: torch.Size([20071, 1])
2025-06-02 15:30:29,905 - DEBUG - Edge anomaly scores shape: torch.Size([42422, 1])
2025-06-02 15:30:29,907 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:30,119 - DEBUG - Step 13: Loss=0.6450
2025-06-02 15:30:30,120 - DEBUG - Online update step: 14/25
2025-06-02 15:30:30,128 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:30,223 - DEBUG - Node anomaly scores shape: torch.Size([18879, 1])
2025-06-02 15:30:30,228 - DEBUG - Edge anomaly scores shape: torch.Size([39316, 1])
2025-06-02 15:30:30,230 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:30,507 - DEBUG - Step 14: Loss=0.6638
2025-06-02 15:30:30,508 - DEBUG - Online update step: 15/25
2025-06-02 15:30:30,517 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:30,623 - DEBUG - Node anomaly scores shape: torch.Size([20323, 1])
2025-06-02 15:30:30,627 - DEBUG - Edge anomaly scores shape: torch.Size([42505, 1])
2025-06-02 15:30:30,629 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:30,921 - DEBUG - Step 15: Loss=0.6375
2025-06-02 15:30:30,922 - DEBUG - Online update step: 16/25
2025-06-02 15:30:30,930 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:31,021 - DEBUG - Node anomaly scores shape: torch.Size([16762, 1])
2025-06-02 15:30:31,025 - DEBUG - Edge anomaly scores shape: torch.Size([34654, 1])
2025-06-02 15:30:31,026 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:31,217 - DEBUG - Step 16: Loss=0.6518
2025-06-02 15:30:31,218 - DEBUG - Online update step: 17/25
2025-06-02 15:30:31,227 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:31,364 - DEBUG - Node anomaly scores shape: torch.Size([20141, 1])
2025-06-02 15:30:31,368 - DEBUG - Edge anomaly scores shape: torch.Size([42291, 1])
2025-06-02 15:30:31,369 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:31,609 - DEBUG - Step 17: Loss=0.6714
2025-06-02 15:30:31,610 - DEBUG - Online update step: 18/25
2025-06-02 15:30:31,617 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:31,719 - DEBUG - Node anomaly scores shape: torch.Size([17991, 1])
2025-06-02 15:30:31,724 - DEBUG - Edge anomaly scores shape: torch.Size([37628, 1])
2025-06-02 15:30:31,726 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:31,906 - DEBUG - Step 18: Loss=0.6486
2025-06-02 15:30:31,907 - DEBUG - Online update step: 19/25
2025-06-02 15:30:31,915 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:32,010 - DEBUG - Node anomaly scores shape: torch.Size([18442, 1])
2025-06-02 15:30:32,015 - DEBUG - Edge anomaly scores shape: torch.Size([38417, 1])
2025-06-02 15:30:32,017 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:32,269 - DEBUG - Step 19: Loss=0.6548
2025-06-02 15:30:32,270 - DEBUG - Online update step: 20/25
2025-06-02 15:30:32,278 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:32,373 - DEBUG - Node anomaly scores shape: torch.Size([18442, 1])
2025-06-02 15:30:32,377 - DEBUG - Edge anomaly scores shape: torch.Size([38418, 1])
2025-06-02 15:30:32,378 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:32,580 - DEBUG - Step 20: Loss=0.6602
2025-06-02 15:30:32,580 - DEBUG - Online update step: 21/25
2025-06-02 15:30:32,596 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:32,728 - DEBUG - Node anomaly scores shape: torch.Size([18143, 1])
2025-06-02 15:30:32,734 - DEBUG - Edge anomaly scores shape: torch.Size([37937, 1])
2025-06-02 15:30:32,735 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:33,117 - DEBUG - Step 21: Loss=0.6395
2025-06-02 15:30:33,118 - DEBUG - Online update step: 22/25
2025-06-02 15:30:33,131 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:33,374 - DEBUG - Node anomaly scores shape: torch.Size([19228, 1])
2025-06-02 15:30:33,383 - DEBUG - Edge anomaly scores shape: torch.Size([40324, 1])
2025-06-02 15:30:33,388 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:33,659 - DEBUG - Step 22: Loss=0.6561
2025-06-02 15:30:33,659 - DEBUG - Online update step: 23/25
2025-06-02 15:30:33,681 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:33,811 - DEBUG - Node anomaly scores shape: torch.Size([18148, 1])
2025-06-02 15:30:33,816 - DEBUG - Edge anomaly scores shape: torch.Size([37930, 1])
2025-06-02 15:30:33,818 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:34,070 - DEBUG - Step 23: Loss=0.6633
2025-06-02 15:30:34,071 - DEBUG - Online update step: 24/25
2025-06-02 15:30:34,085 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:34,206 - DEBUG - Node anomaly scores shape: torch.Size([18224, 1])
2025-06-02 15:30:34,211 - DEBUG - Edge anomaly scores shape: torch.Size([38070, 1])
2025-06-02 15:30:34,213 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:34,492 - DEBUG - Step 24: Loss=0.6419
2025-06-02 15:30:34,493 - DEBUG - Online update step: 25/25
2025-06-02 15:30:34,503 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:34,611 - DEBUG - Node anomaly scores shape: torch.Size([19102, 1])
2025-06-02 15:30:34,615 - DEBUG - Edge anomaly scores shape: torch.Size([40008, 1])
2025-06-02 15:30:34,617 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:34,913 - DEBUG - Step 25: Loss=0.6513
2025-06-02 15:30:34,914 - INFO - Online update finished. Average loss: 0.6525, Learning rate: 0.001000
2025-06-02 15:30:34,916 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  4.4613536e-08 -5.2288986e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.7989329e-08
 -3.8377237e-08  2.6864065e-08  3.8377237e-08 -1.8229187e-08
  2.2676055e+00  2.9617705e+00  1.3883300e-01  4.3963780e+00
 -3.0701788e-08  3.3983903e+00  5.8098593e+00  7.6156940e+00
  1.3883300e-01  7.9929576e+00  1.4391464e-09  1.6909970e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  3.5498942e-08  7.6754469e-09], current edge mean: [ 4.3948126e-10  4.5542950e+02  0.0000000e+00  0.0000000e+00
  4.7244235e-09 -2.1974063e-09 -4.3948125e-09  1.7579250e-09
 -2.1974063e-09  0.0000000e+00]
2025-06-02 15:30:34,916 - DEBUG - Node drift difference: 0.0170, Edge drift difference: 0.0006
2025-06-02 15:30:34,919 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  4.4613536e-08 -5.2288986e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.7989329e-08
 -3.8377237e-08  2.6864065e-08  3.8377237e-08 -1.8229187e-08
  2.2676055e+00  2.9617705e+00  1.3883300e-01  4.3963780e+00
 -3.0701788e-08  3.3983903e+00  5.8098593e+00  7.6156940e+00
  1.3883300e-01  7.9929576e+00  1.4391464e-09  1.6909970e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  3.5498942e-08  7.6754469e-09], edge=[ 4.3948126e-10  4.5542950e+02  0.0000000e+00  0.0000000e+00
  4.7244235e-09 -2.1974063e-09 -4.3948125e-09  1.7579250e-09
 -2.1974063e-09  0.0000000e+00]
2025-06-02 15:30:34,920 - DEBUG - Updated reference std: node=[0.         0.         1.0005034  1.0005034  0.         0.
 0.         1.0005034  1.0005034  1.0005034  1.0005034  1.0005034
 0.9407508  0.27399415 0.3602073  0.5745763  1.0005034  3.003227
 2.8989465  1.479363   0.3602073  0.22202651 1.0005034  1.0005034
 0.         0.         0.         0.         1.0005034  1.0005034 ], edge=[  1.0002304 438.38043     0.          0.          1.0002304   1.0002306
   1.0002306   1.0002306   1.0002304   1.0002306]
2025-06-02 15:30:34,920 - INFO - Online update complete. Loss: 0.6525
2025-06-02 15:30:34,921 - INFO - Running anomaly detection...
2025-06-02 15:30:34,922 - INFO - Starting anomaly detection.
2025-06-02 15:30:34,959 - DEBUG - Node reconstruction errors: [3.06273669e-01 1.06238115e+00 1.43447733e+00 1.03461286e-02
 4.36603948e-02 3.42262238e-02 5.66763878e-01 2.24227495e-02
 2.24227440e-02 2.29203515e-02 2.24227495e-02 4.02350873e-02
 1.53628266e+00 5.39722323e-01 4.25754348e-03 2.92714015e-02
 5.22403792e-02 2.92713121e-02 9.16908756e-02 2.98081599e-02
 1.98128019e-02 4.25754348e-03 1.31992042e-01 2.40763910e-02
 4.72624879e-03 7.71765690e-03 4.72621573e-03 9.45553109e-02
 2.26697549e-02 4.72624879e-03 2.72473603e-01 2.20773682e-01
 8.55807513e-02 9.62727889e-03 7.93953836e-02 1.05391480e-01
 1.43455192e-01 2.98080835e-02 2.43125573e-01 8.26216489e-02
 1.19321141e-02 3.48194456e-03 2.98080835e-02 4.60337475e-02
 6.19984031e-01 4.68330197e-02 3.34708169e-02 2.81933427e-01
 2.28881426e-02 3.57549667e-01 1.50799334e-01 1.07731121e-02
 7.50058191e-03 8.04635584e-02 2.61192359e-02 9.51898172e-02
 1.05733526e+00 3.18780094e-02 8.81430581e-02 1.28812477e-01
 2.53475219e-01 1.02062471e-01 2.81996676e-03 2.41315942e-02
 1.19493023e-01 2.61188354e-02 1.47266695e-02 2.61193570e-02
 2.81997654e-03 9.22384039e-02 1.02036901e-01 3.51345055e-02
 7.95423985e-03 9.03813168e-02 1.10094182e-01 3.48155089e-02
 1.04519449e-01 1.10360302e-01 1.12241484e-01 2.78997160e-02
 6.51533995e-03 3.15185748e-02 7.75294602e-01 9.64685157e-02
 3.57104540e-02 5.78052551e-02 5.19280061e-02 8.44424069e-02
 5.49526289e-02 1.50287613e-01 3.08198575e-03 4.69254963e-02
 2.16952879e-02 1.06391184e-01 5.38346209e-02 1.33171305e-01
 5.42817079e-03 4.65397947e-02 2.26089265e-03 9.47548449e-02
 2.87469625e-02 5.42815914e-03 1.42158652e-02 2.54763931e-01
 3.57926153e-02 1.58853158e-02 3.39651667e-02 4.89810072e-02
 2.33260375e-02 3.40486884e-01 1.37265414e-01 9.61606763e-03
 3.51694375e-02 9.25184414e-02 2.80368999e-02 9.75869969e-02
 2.67218649e-02 8.65620896e-02 6.02875687e-02 1.50138047e-02
 3.50128720e-03 1.89997815e-02 1.00842670e-01 3.32724079e-02
 4.97718491e-02 1.50136808e-02 3.06525845e-02 7.29714260e-02
 6.51881024e-02 1.93111338e-02 8.24643299e-03 8.65322724e-03
 7.19369352e-01 1.81355029e-01 2.51920428e-02 1.55550940e-02
 2.00040508e-02 1.97054679e-03 1.13476388e-01 1.55799061e-01
 3.50420065e-02 3.98188494e-02 5.12852101e-03 2.03129333e-02
 4.87104878e-02 9.36935693e-02 2.67219469e-02 1.51436955e-01
 2.93407924e-02 5.65082319e-02 3.47303331e-01 3.24819945e-02
 3.48674096e-02 8.65324121e-03 3.29083577e-02 6.48076758e-02
 7.99906813e-03 3.27980258e-02 2.87470557e-02 8.97295307e-03
 3.50420065e-02 1.13478042e-01 7.99908675e-03 8.24641250e-03
 2.64047869e-02 5.18019870e-02 3.00072189e-02 2.30738483e-02
 2.15567145e-02 5.65082543e-02 3.27686556e-02 1.40016200e-02
 2.47227820e-03 2.21739992e-01 6.02877140e-02 9.38069725e+00
 2.34016739e-02 5.42543456e-02 2.70602629e-02 2.70602908e-02
 1.62245445e-02 3.68118100e-02 3.20582241e-02 1.27451628e-01
 5.62908500e-02 3.01222745e-02 7.89414346e-02 3.10694147e-02
 1.57974679e-02 4.08351570e-02 3.60081643e-02 1.00793861e-01
 4.85765673e-02 1.17974384e-02 1.13475241e-01 4.94483765e-03
 8.39047492e-01 8.98908749e-02 3.76182199e-02 7.70810843e-02
 1.55076841e-02 7.99906813e-03 3.04923132e-02 7.73669705e-02
 9.07528102e-02 2.51389574e-02 2.32593976e-02 1.84265986e-01
 3.26018198e-03 3.04574203e-02 2.47554090e-02 7.64965937e-02
 6.90258713e-03 3.01064830e-02 3.80185805e-02 7.74323754e-03
 8.70453790e-02 2.67219134e-02 1.06598116e-01 5.64673282e-02
 1.63425520e-01 4.69909701e-03 2.21184688e-03 6.90258387e-03
 7.99908675e-03 8.03866610e-02 8.72551948e-02 1.45940483e-02
 9.20591429e-02 1.30718024e-02 3.07926033e-02 5.23119047e-02
 7.20073283e-02 2.67220102e-02 2.67218240e-02 4.85765822e-02
 2.66426764e-02 2.21184688e-03 7.99913518e-03 1.25050828e-01
 6.14811145e-02 8.33173543e-02 1.29727386e-02 4.95452136e-02
 1.43197039e-02 5.47199287e-02 2.82406788e-02 4.55554277e-02
 1.29727516e-02 1.29473945e-02 8.59410465e-02 2.43198173e-03
 1.06598206e-01 2.07852535e-02 6.94083124e-02 4.82524969e-02
 7.60057569e-03 4.52753622e-03 7.76970088e-02 2.70602778e-02
 2.51206849e-02 4.45546918e-02 2.59729140e-02 3.32919806e-02
 1.02629818e-01 4.57075387e-02 6.77015036e-02 2.40094155e-01
 6.77015111e-02 2.41203066e-02 1.60074517e-01 1.11384951e-01
 2.95950659e-02 7.46154711e-02 2.76836678e-02 1.15173064e-01
 1.45387966e-02 1.09690875e-01 1.62245557e-02 9.13485810e-02
 1.53186083e-01 1.40959918e-02 2.46224236e-02 7.85442535e-03
 6.49847239e-02 5.47672808e-03 2.58808315e-01 5.37986346e-02
 3.68117355e-02 4.92437214e-01 5.46294861e-02 1.01842927e-02
 5.95414191e-02 1.43197039e-02 6.94218755e-01 9.97742917e-03
 2.23948881e-02 2.70599369e-02 4.94483765e-03 7.05364466e-01
 2.69386768e-02 5.27815931e-02 2.55540032e-02 4.05672938e-02
 1.54988607e-03 1.54989539e-03 1.54989539e-03 2.93451715e-02
 3.96716408e-02 5.27815931e-02 1.54989539e-03 2.88237985e-02
 1.54989539e-03 3.43242437e-02 2.12654043e-02 3.48036513e-02
 1.63373008e-01 2.54370440e-02 6.89786253e-03 5.06755523e-03
 5.26308455e-02 2.92519554e-02 5.05395420e-02 2.55540293e-02
 3.31874937e-02 1.18963644e-01 1.16936944e-01 4.43400666e-02
 3.55587155e-02 3.55587862e-02 1.68896511e-01 4.41584969e-03
 1.54988607e-03 2.76836436e-02 1.54988607e-03 2.93452032e-02
 2.34714616e-02 2.23077182e-03 6.13631643e-02 1.92757696e-03
 5.27815931e-02 9.41670779e-03 1.92758080e-03 7.26133287e-02
 3.58200297e-02 5.57719059e-02 2.55540349e-02 6.63803518e-03
 7.76246488e-02 2.91313194e-02 1.54989539e-03 2.55221315e-02
 2.66191848e-02 8.55080187e-02 9.07780789e-03 7.60057569e-03
 6.02374785e-02 1.54989539e-03 1.71522819e-03 3.45159918e-02
 5.93066551e-02 8.84813070e-03 1.16188116e-01 5.20022325e-02
 2.55539883e-02 2.42454439e-01 6.88783228e-02 5.19871227e-02
 2.55510714e-02 2.16871202e-02 2.76401397e-02 5.06229363e-02
 5.13304844e-02 3.39131393e-02 5.59893623e-02 5.11483029e-02
 2.02469947e-03 1.62335578e-02 4.70608398e-02 1.54989539e-03
 2.55540125e-02 1.83428582e-02 6.13656919e-03 2.56477669e-02
 1.97224133e-02 3.61256860e-02 2.65631452e-02 4.26952839e-02
 5.38609736e-02 1.54990377e-03 7.25570023e-02 7.59076849e-02
 2.48853080e-02 7.23802745e-02 5.02889827e-02 5.02890311e-02
 5.02889939e-02 8.87678713e-02 1.51734950e-03 2.28163302e-01
 3.48517075e-02 4.91601974e-02 6.37940466e-02 1.51734950e-03
 2.53573172e-02 2.48853192e-02 4.84783165e-02 1.51214683e-02
 2.48853154e-02 4.08608988e-02 5.02889939e-02 2.48852894e-02
 1.51734450e-03 5.02889827e-02 5.02889939e-02 8.24214052e-03
 9.70300380e-03 5.02890348e-02 6.62143528e-02 2.27770712e-02
 1.37064019e-02 5.47215529e-03 2.18151826e-02 5.68575552e-03
 9.07142609e-02 3.12517285e-02 7.24448962e-03 3.86593491e-02
 8.36416408e-02 1.11631891e-02 7.70727620e-02 1.62229557e-02
 4.19116206e-02 4.25442681e-02 5.40006869e-02 5.02890348e-02
 6.63792575e-03 6.58369511e-02 9.63941813e-02 3.39862518e-02
 5.13743535e-02 1.49783092e-02 1.41728252e-01 4.01927996e-03
 3.00959907e-02 3.21123116e-02 1.15091994e-01 4.46750876e-03
 3.45976301e-03 6.93702558e-03 4.51253131e-02 1.93160924e-03
 9.19860601e-03 3.76782529e-02 1.93162891e-03 1.66075267e-02
 5.68575552e-03 1.10094678e-02 1.11467941e-02 7.97187611e-02
 2.44164839e-02 9.52616334e-03 4.74896561e-03 2.90300809e-02
 4.74896794e-03 9.52616334e-03 2.05513951e-03 2.78082155e-02
 3.44916694e-02 3.71489767e-03 2.05511926e-03 2.44165491e-02
 4.01595421e-02 2.74743497e-01 6.67620823e-02 2.18126755e-02
 2.78082304e-02 2.44164951e-02 1.89552491e-03 1.22216754e-02
 5.22238808e-03 1.67240590e-01 1.86722521e-02 4.46750876e-03
 8.54058415e-02 9.07651242e-03 1.93163229e-03 4.83535267e-02
 2.46049445e-02 2.74606615e-01 2.09713168e-02 1.89553353e-03
 2.68268716e-02 2.72368104e-03 1.63919941e-01 7.30558205e-03
 2.35929806e-02 1.63062304e-01 1.57658930e-03 1.22216754e-02
 1.10965505e-01 2.72368104e-03 1.06837496e-01 1.43356258e-02
 2.10859557e-03 2.76316293e-02 1.65311492e-03 3.84770095e-01
 4.97266231e-03 1.93162658e-03 9.07142088e-03 1.17421905e-02
 1.17422128e-02 6.12300867e-03 5.79321496e-02 1.42959561e-02
 1.65310630e-03 2.32292134e-02 1.11430520e-02 3.90087962e-02
 5.67766018e-02 1.49783082e-02 1.65310630e-03 3.08565889e-02
 2.10859557e-03 2.35929526e-02 7.05740461e-03 5.24381921e-02
 5.67766018e-02 7.01485202e-02 1.42959561e-02 5.10357358e-02
 1.57658942e-03 1.22216465e-02 2.35929769e-02 2.42205672e-02
 3.93132046e-02 6.22877739e-02 1.57658942e-03 4.55844775e-02
 1.57658942e-03 5.03287949e-02 5.66093922e-02 2.32291911e-02
 6.08953228e-03 2.99175307e-02 3.09154987e-02 1.64668262e-03
 8.52787435e-01 1.64669892e-03 1.64668891e-03 1.64668262e-03
 1.64668891e-03 1.64668867e-03 1.64668262e-03 1.64668390e-03
 2.66170781e-02 5.54100517e-03 2.48965267e-02 1.64669577e-03
 1.64669123e-03 1.64669892e-03 1.64668891e-03 1.64668891e-03
 1.64668262e-03 1.64669892e-03 1.64668891e-03 1.64668891e-03
 2.26532388e-02 1.64668867e-03 1.64668390e-03 8.67691413e-02
 1.64669577e-03 2.96483357e-02 3.08931749e-02 1.57658942e-03
 7.54437074e-02 3.62467505e-02 4.37826291e-02 4.37826291e-02
 7.17251599e-02 7.54437074e-02 1.57658942e-03 1.65312097e-03
 1.65312469e-03 4.38105799e-02 1.65311492e-03 1.14095891e-02
 2.22104825e-02 1.64668867e-03 1.49783045e-02 1.57658942e-03
 1.17421784e-02 1.57658942e-03 1.57658942e-03 2.99513303e-02
 1.57659349e-03 1.65311492e-03 1.57659349e-03 1.57658930e-03
 6.56088889e-02 1.65310630e-03 1.57659349e-03 1.65310630e-03
 1.57659349e-03 1.57658942e-03 1.57658942e-03 7.09021762e-02
 4.29638848e-02 2.08946150e-02 1.64668891e-03 2.05369461e-02
 5.98170273e-02 1.57658942e-03 1.65312469e-03 4.99844812e-02
 1.64668262e-03 1.97601281e-02 3.68100852e-02 2.45178607e-03
 1.57658942e-03 1.57658942e-03 2.11803615e-02 7.59716704e-02
 2.01936122e-02 1.57658942e-03 2.66170800e-02 6.05933694e-03
 1.65310630e-03 4.29214202e-02 1.64668891e-03 1.33642601e-02
 6.19406030e-02 1.64669123e-03 1.64668262e-03 2.66170688e-02
 6.05935464e-03 1.57658942e-03 1.34984434e-01 5.39470278e-02
 4.34067138e-02 7.59716481e-02 1.40422313e-02 4.41256054e-02
 4.41256389e-02 3.10402010e-02 7.86378887e-03 1.64668891e-03
 1.11002112e-02 3.41516323e-02 7.59716704e-02 2.10612211e-02
 1.03566702e-02 1.28552755e-02 1.69578812e-03 1.69579615e-03
 1.69578812e-03 1.69579615e-03 1.69578812e-03 2.22464763e-02
 3.33727337e-02 1.69578812e-03 1.69578812e-03 1.64667412e-03
 5.72962500e-03 1.64669577e-03 4.41256054e-02 5.16448952e-02
 4.49731611e-02 9.86999273e-03 4.95855622e-02 6.16836995e-02
 2.26532463e-02 1.48283523e-02 2.26532333e-02 1.64667412e-03
 4.41256054e-02 2.20763800e-03 1.68433215e-03 1.68433343e-03
 1.69578812e-03 2.20763800e-03 5.35607226e-02 1.01526780e-02
 1.41660403e-02 1.64668390e-03 1.69578812e-03 1.67587437e-02
 1.68432132e-03 3.69580984e-02 1.85772649e-03 3.61881889e-02
 2.22464744e-02 2.75422305e-01 4.17392375e-03 8.76157656e-02
 1.91502590e-02 1.85772649e-03 4.78975289e-03 2.29323562e-03
 1.85494451e-03 5.00968611e-03 3.91713642e-02 1.27010634e-02
 4.14951295e-02 1.85772649e-03 1.85772823e-03 1.85772649e-03
 1.68431387e-03 1.67587381e-02 1.85772823e-03 1.85494230e-03
 1.85771764e-03 1.85772649e-03 1.85772649e-03 2.04222761e-02
 2.28396524e-03 5.35527356e-02 5.27952276e-02 3.77266929e-02
 3.49994674e-02 3.08139641e-02 5.16974330e-02 1.03008844e-01
 1.88651867e-03 2.30060564e-03 4.57549049e-03 8.71475413e-02
 2.40584258e-02 1.85494451e-03 8.55864957e-02 1.22447513e-01
 1.88511983e-03 1.63491012e-03 1.67581905e-02 6.43630326e-02
 2.39859079e-03 2.39858124e-03 2.39858124e-03 1.65310677e-03
 1.65163155e-03 4.20538373e-02 3.53356265e-02 1.32783383e-01
 4.71558142e-03 3.07196658e-03 9.78760235e-03 1.63490768e-03
 4.98989271e-03 1.78670362e-02 1.60914962e-03 8.48961528e-03
 1.88511738e-03 1.22446895e-01 1.63490768e-03 1.78670790e-02
 2.54373066e-02 6.01969324e-02 2.39859079e-03 1.65311538e-03
 1.60915835e-03 1.31517947e-02 2.50646304e-02 1.65310327e-03
 1.65311538e-03 1.65310723e-03 5.53779677e-02 4.21137244e-01
 1.42179382e+00 2.39858124e-03 1.20373182e-01 1.65311538e-03
 3.47474925e-02 5.92818204e-03 1.70126781e-01 1.26931481e-02
 1.65310723e-03 1.70843257e-03 5.77481929e-03 1.97334564e-03
 1.75976828e-01 1.26931407e-02 1.34880990e-01 3.94376414e-03
 4.77052554e-02 1.26931518e-02 3.37564945e-02 2.61880867e-02
 1.04110884e-02 4.76011224e-02 2.15116180e-02 2.09995476e-03
 2.09995476e-03 8.24464485e-02 1.26082897e-01 3.98602262e-02
 1.26931481e-02 1.04110884e-02 1.26931369e-02 1.98121835e-03
 2.24853726e-03 2.24854262e-03 1.68702623e-03 6.25378788e-02
 4.12210217e-03 2.24853540e-03 1.98121835e-03 4.80744988e-03
 2.24854262e-03 2.24853470e-03 1.82445918e-03 9.11610853e-03
 6.39141351e-02 5.08818850e-02 2.24853470e-03 2.35917997e-02
 4.80749924e-03 2.24853470e-03 2.40499922e-03 7.11875269e-03
 2.89476011e-03 2.89475708e-03 4.60448340e-02 5.88589208e-03
 2.24853726e-03 5.88590233e-03 5.95426653e-03 5.96975572e-02
 3.20923775e-02 2.24854262e-03 1.36446282e-01 5.60774002e-03
 5.60772186e-03 1.23180598e-02 1.20065948e-02 9.03368555e-03
 2.40499922e-03 4.35738824e-03 1.87867426e-03 2.89615002e-02
 1.22431386e-02 2.89615113e-02 1.39046475e-01 2.04768311e-03
 1.22431191e-02 2.11125007e-03 2.11124658e-03 1.67951763e-01
 2.11124355e-03 2.72133872e-02 1.95109646e-03 2.62737591e-02
 1.01509290e-02 2.04768311e-03 1.01509094e-02 5.15290461e-02
 5.12981080e-02 5.43745905e-02 2.11124099e-03 9.68917739e-03
 9.34094191e-03 2.11124099e-03 6.46776184e-02 4.33819145e-02
 6.67096442e-03 2.04768311e-03 2.11123424e-03 1.40017524e-01
 5.64061757e-03 8.84913467e-03 2.11123424e-03 2.59558088e-03
 2.10833717e-02 2.59558088e-03 8.84917937e-03 2.59561604e-03
 2.18319260e-02 3.11163329e-02 6.45945892e-02 2.11124658e-03
 3.09899803e-02 8.84917937e-03 2.11124099e-03 1.59638092e-01
 8.84917937e-03 2.59561604e-03 8.84917285e-03 5.64060546e-03
 5.64062269e-03 1.18678650e-02 5.64061757e-03 2.11124355e-03
 1.54489174e-03 8.84913467e-03 9.42580309e-03 1.45641908e-01
 1.54488930e-03 5.64060546e-03 2.11124658e-03 9.68412496e-03
 3.06581166e-02 2.95917690e-02 2.95918342e-02 2.26641330e-03
 3.29808928e-02 5.38329175e-03 1.12831863e-02 1.68562189e-01
 2.95918006e-02 2.80863582e-03 2.95918006e-02 9.53093823e-03
 1.12831863e-02 2.95918379e-02 2.38596345e-03 4.56962781e-03
 1.43342102e-02 2.52210745e-03 3.07134492e-03 1.70652266e-03
 5.98202040e-03 3.29053309e-03 2.47546379e-03 2.47546379e-03
 2.74922363e-02 2.38540899e-02 2.47547310e-03 2.47547310e-03
 2.81665549e-02 2.75729075e-02 2.47546588e-03 2.47547310e-03
 2.47546937e-03 2.47546379e-03 2.38540713e-02 2.38540396e-02
 2.38540843e-02 2.38540340e-02 2.12089214e-02 1.55446650e-02
 2.38540489e-02 2.38540340e-02 2.12089848e-02 2.47546984e-03
 1.70084491e-01 2.12089773e-02 3.27893673e-03 2.38540731e-02
 3.13249021e-03 2.70439032e-02 8.87299851e-02 2.47546588e-03
 9.53822955e-02 2.70435940e-02 6.77519366e-02 2.94216163e-02
 2.94216163e-02 3.64602124e-03 2.94216163e-02 2.94216052e-02
 3.38346371e-03 3.04989126e-02 3.14921699e-02 4.69850097e-03
 4.69849724e-03 4.69849259e-03 1.83550511e-02 4.53762785e-02
 4.69850097e-03 2.06397593e-01 3.14921550e-02 3.64602124e-03
 9.08355340e-02 4.69850097e-03 1.05740745e-02 4.69850469e-03
 3.14921215e-02 5.21085644e-03 1.83550697e-02 4.53762896e-02
 3.14921029e-02 3.14921588e-02 1.83550660e-02 4.69847722e-03
 3.14921439e-02 3.14921439e-02 4.69849259e-03 5.21085365e-03
 5.34586534e-02 4.69849259e-03 1.89575255e-02 4.84999409e-03
 5.21085365e-03 4.84998664e-03]
2025-06-02 15:30:34,960 - DEBUG - Edge reconstruction errors: [ 5.2639923  5.261503  44.257763  ... 13.357752   2.158632  13.357752 ]
2025-06-02 15:30:35,140 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_153035_update_47.json
2025-06-02 15:30:35,141 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:30:35,196 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_153035_update_47.pth
2025-06-02 15:30:35,196 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870505.dot): 0.9389
2025-06-02 15:30:35,197 - WARNING - Detected 6 anomalous nodes (reconstruction-based):
2025-06-02 15:30:35,197 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.0624, MLP Score: 0.4807
2025-06-02 15:30:35,198 - WARNING -   Node ID: 192.168.27.13, Recon Error: 1.4345, MLP Score: 0.4965
2025-06-02 15:30:35,198 - WARNING -   Node ID: 192.168.27.10, Recon Error: 1.5363, MLP Score: 0.5088
2025-06-02 15:30:35,198 - WARNING -   Node ID: 192.168.209.130, Recon Error: 1.0573, MLP Score: 0.4864
2025-06-02 15:30:35,198 - WARNING -   Node ID: 183.81.34.26, Recon Error: 9.3807, MLP Score: 0.4965
2025-06-02 15:30:35,198 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:30:35,199 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2578, MLP Score: 0.9513
2025-06-02 15:30:35,199 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9603, MLP Score: 0.9947
2025-06-02 15:30:35,199 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0599, MLP Score: 0.9947
2025-06-02 15:30:35,200 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7587, MLP Score: 0.9943
2025-06-02 15:30:35,200 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7580, MLP Score: 0.9949
2025-06-02 15:30:35,200 - INFO - 
--- Processing file: nw_graph_encoded_1748870535.dot (Timestamp: 2025-06-02 15:22:15) ---
2025-06-02 15:30:35,200 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870535.dot
2025-06-02 15:30:35,200 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870535.dot'.
2025-06-02 15:30:35,201 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870535.dot
2025-06-02 15:30:35,241 - INFO - Parsed 996 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870535.dot'.
2025-06-02 15:30:35,360 - INFO - Parsed 2181 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870535.dot'.
2025-06-02 15:30:35,361 - INFO - Processing node updates/additions.
2025-06-02 15:30:35,407 - INFO - Processing edge updates/additions.
2025-06-02 15:30:35,591 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:30:35,598 - INFO - Finished updating NetworkX graph.
2025-06-02 15:30:35,602 - DEBUG - Updated graph - Nodes: 996, Edges: 2181
2025-06-02 15:30:35,603 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:30:35,610 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:30:35,806 - DEBUG - Initial node features tensor shape: torch.Size([996, 30])
2025-06-02 15:30:35,813 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:30:35,818 - DEBUG - Node features tensor shape after scaling: torch.Size([996, 30])
2025-06-02 15:30:35,825 - DEBUG - Edge index tensor shape: torch.Size([2, 2181])
2025-06-02 15:30:35,839 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:30:35,945 - DEBUG - Initial edge attributes tensor shape: torch.Size([2181, 10])
2025-06-02 15:30:35,953 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:30:35,957 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2181, 10])
2025-06-02 15:30:35,958 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:30:35,959 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:30:35,963 - INFO - Updated main graph to 996 nodes and 2181 edges.
2025-06-02 15:30:35,964 - INFO - Performing online update...
2025-06-02 15:30:35,964 - INFO - Starting online update for 25 steps.
2025-06-02 15:30:35,965 - DEBUG - Updated RunningStats: new_mean=0.9449173580080591, new_var=27600000000161.516, new_n=2790
2025-06-02 15:30:35,966 - DEBUG - Updated RunningStats: new_mean=0.9427162085269993, new_var=27900000000018.227, new_n=2820
2025-06-02 15:30:35,967 - DEBUG - Updated RunningStats: new_mean=44.785700033647366, new_var=9200000186628.725, new_n=930
2025-06-02 15:30:35,967 - DEBUG - Updated RunningStats: new_mean=44.781889960195755, new_var=9300000171478.684, new_n=940
2025-06-02 15:30:35,967 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:30:35,967 - DEBUG - Online update step: 1/25
2025-06-02 15:30:35,975 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:36,159 - DEBUG - Node anomaly scores shape: torch.Size([20199, 1])
2025-06-02 15:30:36,183 - DEBUG - Edge anomaly scores shape: torch.Size([42519, 1])
2025-06-02 15:30:36,185 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:36,526 - DEBUG - Step 1: Loss=0.6609
2025-06-02 15:30:36,527 - DEBUG - Online update step: 2/25
2025-06-02 15:30:36,536 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:36,644 - DEBUG - Node anomaly scores shape: torch.Size([19095, 1])
2025-06-02 15:30:36,650 - DEBUG - Edge anomaly scores shape: torch.Size([39946, 1])
2025-06-02 15:30:36,652 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:36,908 - DEBUG - Step 2: Loss=0.6388
2025-06-02 15:30:36,908 - DEBUG - Online update step: 3/25
2025-06-02 15:30:36,917 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:37,029 - DEBUG - Node anomaly scores shape: torch.Size([20306, 1])
2025-06-02 15:30:37,035 - DEBUG - Edge anomaly scores shape: torch.Size([42790, 1])
2025-06-02 15:30:37,037 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:37,305 - DEBUG - Step 3: Loss=0.6512
2025-06-02 15:30:37,306 - DEBUG - Online update step: 4/25
2025-06-02 15:30:37,319 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:37,431 - DEBUG - Node anomaly scores shape: torch.Size([19634, 1])
2025-06-02 15:30:37,437 - DEBUG - Edge anomaly scores shape: torch.Size([41004, 1])
2025-06-02 15:30:37,439 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:37,720 - DEBUG - Step 4: Loss=0.6626
2025-06-02 15:30:37,721 - DEBUG - Online update step: 5/25
2025-06-02 15:30:37,733 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:37,841 - DEBUG - Node anomaly scores shape: torch.Size([19451, 1])
2025-06-02 15:30:37,846 - DEBUG - Edge anomaly scores shape: torch.Size([40741, 1])
2025-06-02 15:30:37,848 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:38,135 - DEBUG - Step 5: Loss=0.6399
2025-06-02 15:30:38,135 - DEBUG - Online update step: 6/25
2025-06-02 15:30:38,143 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:38,235 - DEBUG - Node anomaly scores shape: torch.Size([17713, 1])
2025-06-02 15:30:38,240 - DEBUG - Edge anomaly scores shape: torch.Size([36742, 1])
2025-06-02 15:30:38,242 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:38,481 - DEBUG - Step 6: Loss=0.6516
2025-06-02 15:30:38,482 - DEBUG - Online update step: 7/25
2025-06-02 15:30:38,492 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:38,601 - DEBUG - Node anomaly scores shape: torch.Size([19617, 1])
2025-06-02 15:30:38,607 - DEBUG - Edge anomaly scores shape: torch.Size([41211, 1])
2025-06-02 15:30:38,608 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:38,864 - DEBUG - Step 7: Loss=0.6600
2025-06-02 15:30:38,864 - DEBUG - Online update step: 8/25
2025-06-02 15:30:38,877 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:38,979 - DEBUG - Node anomaly scores shape: torch.Size([17532, 1])
2025-06-02 15:30:38,985 - DEBUG - Edge anomaly scores shape: torch.Size([36400, 1])
2025-06-02 15:30:38,986 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:39,232 - DEBUG - Step 8: Loss=0.6361
2025-06-02 15:30:39,233 - DEBUG - Online update step: 9/25
2025-06-02 15:30:39,248 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:39,365 - DEBUG - Node anomaly scores shape: torch.Size([19600, 1])
2025-06-02 15:30:39,370 - DEBUG - Edge anomaly scores shape: torch.Size([41021, 1])
2025-06-02 15:30:39,372 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:39,631 - DEBUG - Step 9: Loss=0.6538
2025-06-02 15:30:39,632 - DEBUG - Online update step: 10/25
2025-06-02 15:30:39,644 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:39,752 - DEBUG - Node anomaly scores shape: torch.Size([19234, 1])
2025-06-02 15:30:39,757 - DEBUG - Edge anomaly scores shape: torch.Size([40163, 1])
2025-06-02 15:30:39,758 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:39,993 - DEBUG - Step 10: Loss=0.6625
2025-06-02 15:30:39,994 - DEBUG - Online update step: 11/25
2025-06-02 15:30:40,003 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:40,100 - DEBUG - Node anomaly scores shape: torch.Size([18503, 1])
2025-06-02 15:30:40,105 - DEBUG - Edge anomaly scores shape: torch.Size([38864, 1])
2025-06-02 15:30:40,106 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:40,323 - DEBUG - Step 11: Loss=0.6368
2025-06-02 15:30:40,324 - DEBUG - Online update step: 12/25
2025-06-02 15:30:40,341 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:40,461 - DEBUG - Node anomaly scores shape: torch.Size([20230, 1])
2025-06-02 15:30:40,466 - DEBUG - Edge anomaly scores shape: torch.Size([42483, 1])
2025-06-02 15:30:40,467 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:40,709 - DEBUG - Step 12: Loss=0.6474
2025-06-02 15:30:40,710 - DEBUG - Online update step: 13/25
2025-06-02 15:30:40,719 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:40,822 - DEBUG - Node anomaly scores shape: torch.Size([18856, 1])
2025-06-02 15:30:40,826 - DEBUG - Edge anomaly scores shape: torch.Size([39528, 1])
2025-06-02 15:30:40,828 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:41,059 - DEBUG - Step 13: Loss=0.6597
2025-06-02 15:30:41,060 - DEBUG - Online update step: 14/25
2025-06-02 15:30:41,069 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:41,179 - DEBUG - Node anomaly scores shape: torch.Size([20280, 1])
2025-06-02 15:30:41,184 - DEBUG - Edge anomaly scores shape: torch.Size([42733, 1])
2025-06-02 15:30:41,185 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:41,438 - DEBUG - Step 14: Loss=0.6344
2025-06-02 15:30:41,439 - DEBUG - Online update step: 15/25
2025-06-02 15:30:41,451 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:41,554 - DEBUG - Node anomaly scores shape: torch.Size([19550, 1])
2025-06-02 15:30:41,559 - DEBUG - Edge anomaly scores shape: torch.Size([40858, 1])
2025-06-02 15:30:41,560 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:41,774 - DEBUG - Step 15: Loss=0.6455
2025-06-02 15:30:41,774 - DEBUG - Online update step: 16/25
2025-06-02 15:30:41,782 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:41,898 - DEBUG - Node anomaly scores shape: torch.Size([19498, 1])
2025-06-02 15:30:41,909 - DEBUG - Edge anomaly scores shape: torch.Size([40876, 1])
2025-06-02 15:30:41,911 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:42,135 - DEBUG - Step 16: Loss=0.6604
2025-06-02 15:30:42,136 - DEBUG - Online update step: 17/25
2025-06-02 15:30:42,144 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:42,233 - DEBUG - Node anomaly scores shape: torch.Size([18638, 1])
2025-06-02 15:30:42,237 - DEBUG - Edge anomaly scores shape: torch.Size([38952, 1])
2025-06-02 15:30:42,238 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:42,430 - DEBUG - Step 17: Loss=0.6375
2025-06-02 15:30:42,431 - DEBUG - Online update step: 18/25
2025-06-02 15:30:42,439 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:42,561 - DEBUG - Node anomaly scores shape: torch.Size([18470, 1])
2025-06-02 15:30:42,567 - DEBUG - Edge anomaly scores shape: torch.Size([38559, 1])
2025-06-02 15:30:42,568 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:42,807 - DEBUG - Step 18: Loss=0.6432
2025-06-02 15:30:42,807 - DEBUG - Online update step: 19/25
2025-06-02 15:30:42,820 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:42,936 - DEBUG - Node anomaly scores shape: torch.Size([19405, 1])
2025-06-02 15:30:42,942 - DEBUG - Edge anomaly scores shape: torch.Size([40748, 1])
2025-06-02 15:30:42,944 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:43,193 - DEBUG - Step 19: Loss=0.6535
2025-06-02 15:30:43,193 - DEBUG - Online update step: 20/25
2025-06-02 15:30:43,207 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:43,312 - DEBUG - Node anomaly scores shape: torch.Size([18947, 1])
2025-06-02 15:30:43,317 - DEBUG - Edge anomaly scores shape: torch.Size([39759, 1])
2025-06-02 15:30:43,319 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:43,588 - DEBUG - Step 20: Loss=0.6315
2025-06-02 15:30:43,589 - DEBUG - Online update step: 21/25
2025-06-02 15:30:43,603 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:43,717 - DEBUG - Node anomaly scores shape: torch.Size([18618, 1])
2025-06-02 15:30:43,722 - DEBUG - Edge anomaly scores shape: torch.Size([38737, 1])
2025-06-02 15:30:43,724 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:43,988 - DEBUG - Step 21: Loss=0.6483
2025-06-02 15:30:43,988 - DEBUG - Online update step: 22/25
2025-06-02 15:30:44,002 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:44,101 - DEBUG - Node anomaly scores shape: torch.Size([17856, 1])
2025-06-02 15:30:44,107 - DEBUG - Edge anomaly scores shape: torch.Size([37252, 1])
2025-06-02 15:30:44,109 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:44,339 - DEBUG - Step 22: Loss=0.6579
2025-06-02 15:30:44,340 - DEBUG - Online update step: 23/25
2025-06-02 15:30:44,348 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:44,461 - DEBUG - Node anomaly scores shape: torch.Size([19077, 1])
2025-06-02 15:30:44,466 - DEBUG - Edge anomaly scores shape: torch.Size([39790, 1])
2025-06-02 15:30:44,468 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:44,695 - DEBUG - Step 23: Loss=0.6355
2025-06-02 15:30:44,695 - DEBUG - Online update step: 24/25
2025-06-02 15:30:44,704 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:44,801 - DEBUG - Node anomaly scores shape: torch.Size([18677, 1])
2025-06-02 15:30:44,805 - DEBUG - Edge anomaly scores shape: torch.Size([39204, 1])
2025-06-02 15:30:44,806 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:45,028 - DEBUG - Step 24: Loss=0.6435
2025-06-02 15:30:45,028 - DEBUG - Online update step: 25/25
2025-06-02 15:30:45,037 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:45,153 - DEBUG - Node anomaly scores shape: torch.Size([21044, 1])
2025-06-02 15:30:45,159 - DEBUG - Edge anomaly scores shape: torch.Size([44383, 1])
2025-06-02 15:30:45,161 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:45,385 - DEBUG - Step 25: Loss=0.6526
2025-06-02 15:30:45,386 - INFO - Online update finished. Average loss: 0.6482, Learning rate: 0.001000
2025-06-02 15:30:45,387 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -5.7450258e-09  1.3405061e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.8725129e-09
  1.4362564e-09 -1.9150086e-08  2.0107590e-08  9.5750430e-09
  2.2650602e+00  2.9618473e+00  1.4257029e-01  4.3945785e+00
  2.2980103e-08  3.4056225e+00  5.8022089e+00  7.6104417e+00
  1.4257029e-01  7.9929719e+00 -2.3937607e-09  1.1370364e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.2848320e-08  2.0586343e-08], current edge mean: [-8.7452939e-10  4.5536679e+02  0.0000000e+00  0.0000000e+00
  6.5589706e-10 -4.3726470e-10 -2.6235882e-09  1.6397427e-09
 -3.0608529e-09 -8.7452939e-10]
2025-06-02 15:30:45,388 - DEBUG - Node drift difference: 0.0104, Edge drift difference: 0.0001
2025-06-02 15:30:45,390 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -5.7450258e-09  1.3405061e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.8725129e-09
  1.4362564e-09 -1.9150086e-08  2.0107590e-08  9.5750430e-09
  2.2650602e+00  2.9618473e+00  1.4257029e-01  4.3945785e+00
  2.2980103e-08  3.4056225e+00  5.8022089e+00  7.6104417e+00
  1.4257029e-01  7.9929719e+00 -2.3937607e-09  1.1370364e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.2848320e-08  2.0586343e-08], edge=[-8.7452939e-10  4.5536679e+02  0.0000000e+00  0.0000000e+00
  6.5589706e-10 -4.3726470e-10 -2.6235882e-09  1.6397427e-09
 -3.0608529e-09 -8.7452939e-10]
2025-06-02 15:30:45,391 - DEBUG - Updated reference std: node=[0.         0.         1.0005023  1.0005023  0.         0.
 0.         1.0005023  1.0005023  1.0005023  1.0005023  1.0005023
 0.9383103  0.273724   0.3638916  0.5740894  1.0005023  3.008886
 2.9010541  1.4886004  0.3638916  0.22180349 1.0005023  1.0005023
 0.         0.         0.         0.         1.0005023  1.0005023 ], edge=[  1.0002294 437.27393     0.          0.          1.0002294   1.0002294
   1.0002294   1.0002294   1.0002294   1.0002294]
2025-06-02 15:30:45,392 - INFO - Online update complete. Loss: 0.6482
2025-06-02 15:30:45,392 - INFO - Running anomaly detection...
2025-06-02 15:30:45,392 - INFO - Starting anomaly detection.
2025-06-02 15:30:45,425 - DEBUG - Node reconstruction errors: [1.72613323e-01 9.16134655e-01 1.47015345e+00 1.34269865e-02
 4.36912440e-02 2.61858087e-02 5.48948944e-01 1.88418459e-02
 1.88418459e-02 2.33222451e-02 1.88418459e-02 3.93389501e-02
 1.47223735e+00 2.64596790e-01 5.36330603e-03 2.56967712e-02
 4.79054302e-02 2.56965086e-02 6.93285540e-02 2.55208332e-02
 1.99283492e-02 5.36330603e-03 1.14833593e-01 2.34000105e-02
 5.92795061e-03 9.30547342e-03 5.92795061e-03 8.69707689e-02
 1.90616138e-02 5.92795061e-03 2.17504442e-01 1.81410968e-01
 7.75297955e-02 1.15848649e-02 6.93700463e-02 8.85950774e-02
 1.28459647e-01 2.55208611e-02 2.20632643e-01 7.47276545e-02
 1.36385318e-02 4.69200779e-03 2.55208611e-02 3.69633473e-02
 3.82831007e-01 3.78704704e-02 2.24931240e-02 2.55365461e-01
 1.95313506e-02 3.36606234e-01 1.49736017e-01 1.27600031e-02
 9.27860383e-03 6.40705824e-02 2.54340060e-02 1.07135750e-01
 9.72518206e-01 2.68331245e-02 6.37048483e-02 1.11006364e-01
 2.33813688e-01 7.75803104e-02 4.27620625e-03 2.57057473e-02
 1.00275345e-01 2.54342854e-02 1.38126463e-02 2.54341289e-02
 4.27620625e-03 7.03371763e-02 8.97920877e-02 2.92456709e-02
 8.30671284e-03 6.12028688e-02 7.79384896e-02 2.91344747e-02
 7.95970634e-02 8.35335478e-02 8.29750970e-02 2.69117262e-02
 8.88959412e-03 2.78054848e-02 7.66382039e-01 8.91970322e-02
 2.76941340e-02 6.37084618e-02 4.40985747e-02 6.02762848e-02
 5.29173762e-02 1.43734798e-01 5.74171776e-03 4.98461798e-02
 1.84882656e-02 7.87705109e-02 4.34787646e-02 1.74894869e-01
 8.33160244e-03 3.45231295e-02 3.82839493e-03 8.01629201e-02
 2.38606762e-02 8.33159778e-03 1.38587095e-02 2.18516037e-01
 3.87291051e-02 1.80516895e-02 3.23080458e-02 4.44933027e-02
 2.01917198e-02 3.02562505e-01 1.23469099e-01 1.13155646e-02
 3.42831127e-02 7.90781304e-02 2.30178349e-02 7.95114860e-02
 2.19991524e-02 8.07927921e-02 4.45879065e-02 1.45894075e-02
 5.88713493e-03 1.97994076e-02 8.18937644e-02 3.14295888e-02
 3.60538177e-02 1.45895323e-02 2.52959374e-02 6.10896796e-02
 4.73144166e-02 1.92731712e-02 1.05728768e-02 8.05026479e-03
 4.01523143e-01 1.67595044e-01 2.07221117e-02 1.74995326e-02
 1.75591838e-02 3.79422284e-03 1.03463158e-01 1.53567344e-01
 2.84805410e-02 3.40159349e-02 7.03061465e-03 1.76132936e-02
 3.75009850e-02 7.36537501e-02 2.19992008e-02 1.28856227e-01
 2.33719051e-02 4.33756672e-02 2.96603113e-01 3.72692756e-02
 3.44199650e-02 8.05028901e-03 3.30401883e-02 5.94633669e-02
 7.92863406e-03 2.82026269e-02 2.38606501e-02 1.09125134e-02
 2.84805652e-02 1.03463508e-01 7.92860053e-03 1.05729066e-02
 2.19601076e-02 5.08455709e-02 2.51220893e-02 2.17558090e-02
 1.57517213e-02 4.33756635e-02 3.15383337e-02 1.37622599e-02
 5.43946726e-03 1.61842018e-01 4.45880033e-02 9.30087852e+00
 2.26980336e-02 5.14505990e-02 2.24737711e-02 2.24737581e-02
 1.85405370e-02 2.95959916e-02 2.71832179e-02 1.07952781e-01
 6.36777654e-02 2.51272861e-02 6.10265918e-02 2.55424883e-02
 1.79014467e-02 3.20366621e-02 3.61987352e-02 7.40008801e-02
 3.73163410e-02 1.06507801e-02 1.03462085e-01 6.94322912e-03
 7.81448305e-01 6.93630129e-02 3.64313200e-02 6.21653832e-02
 1.70706287e-02 7.92863406e-03 2.89292168e-02 5.70161529e-02
 6.73897937e-02 1.92706063e-02 2.53545232e-02 1.95020974e-01
 4.47334768e-03 3.02297994e-02 2.07556449e-02 6.07391037e-02
 8.46172031e-03 2.55256053e-02 3.36598270e-02 8.72889813e-03
 6.35305867e-02 2.19992064e-02 1.02272108e-01 4.30209376e-02
 1.44655511e-01 6.68870658e-03 5.21649700e-03 8.46169516e-03
 7.92861450e-03 5.38342483e-02 8.07357877e-02 1.25891007e-02
 6.93969950e-02 1.56313293e-02 2.96522845e-02 5.15717156e-02
 5.19226044e-02 2.19991561e-02 2.19991598e-02 3.73163149e-02
 2.43927967e-02 5.21647464e-03 7.92861450e-03 9.72868353e-02
 5.54866083e-02 6.02717437e-02 1.08307842e-02 3.65939401e-02
 1.23105608e-02 3.94092873e-02 2.28465833e-02 3.97431441e-02
 1.08307842e-02 1.29317027e-02 6.80688322e-02 5.09219058e-03
 1.02272227e-01 1.89807899e-02 5.08289784e-02 4.59926985e-02
 7.54880346e-03 5.36255958e-03 6.06300831e-02 2.24737320e-02
 2.43955925e-02 3.81128080e-02 2.50921585e-02 2.75367275e-02
 7.45256022e-02 3.71718667e-02 6.63876757e-02 2.08579883e-01
 6.63877875e-02 1.97686758e-02 1.39541864e-01 9.24733505e-02
 2.57848147e-02 6.69675544e-02 2.27407087e-02 9.79710370e-02
 1.64117031e-02 9.61811244e-02 1.85405370e-02 6.91574663e-02
 1.59819290e-01 1.57015827e-02 2.35085525e-02 9.92567558e-03
 4.42325845e-02 7.49417627e-03 2.47382388e-01 4.40168530e-02
 2.95959543e-02 2.97011703e-01 4.29781564e-02 1.14933653e-02
 5.22795133e-02 1.23105645e-02 4.17200953e-01 9.34943464e-03
 2.05318592e-02 2.24733558e-02 6.94322912e-03 4.02835757e-01
 2.56241728e-02 4.05461565e-02 2.09346507e-02 3.68071534e-02
 3.55850928e-03 3.55850556e-03 3.55850556e-03 2.34860610e-02
 3.08438409e-02 4.05461565e-02 3.55850556e-03 3.02678328e-02
 3.55851301e-03 2.70625073e-02 1.75623503e-02 3.35938856e-02
 1.46920845e-01 2.02094987e-02 8.15513078e-03 7.16980780e-03
 4.05597091e-02 2.73588374e-02 3.69433165e-02 2.09345799e-02
 3.20015028e-02 9.98588726e-02 1.11812599e-01 3.52326594e-02
 3.48289758e-02 3.48290242e-02 1.65252715e-01 6.44267024e-03
 3.55850556e-03 2.27406137e-02 3.55850556e-03 2.34860610e-02
 1.84064154e-02 4.88724280e-03 4.70364429e-02 3.62615869e-03
 4.05461714e-02 9.33516584e-03 3.62614868e-03 5.26879877e-02
 2.85174567e-02 4.06293869e-02 2.09345501e-02 8.36509466e-03
 7.65844509e-02 2.81268246e-02 3.55850556e-03 2.14891955e-02
 2.96285469e-02 6.46094382e-02 9.31609701e-03 7.54883280e-03
 4.60197814e-02 3.55850928e-03 3.63370241e-03 3.32732797e-02
 4.81045581e-02 7.11454870e-03 1.14702657e-01 5.02855740e-02
 2.09345743e-02 1.90518096e-01 5.34642264e-02 6.06801361e-02
 2.10558828e-02 1.81552209e-02 2.40504835e-02 4.93994281e-02
 3.70107293e-02 3.18162553e-02 4.19286899e-02 4.46651988e-02
 5.05402405e-03 1.21889235e-02 5.89994080e-02 3.55850556e-03
 2.09345743e-02 1.35918502e-02 5.89525281e-03 2.42857244e-02
 1.49813564e-02 3.02020218e-02 2.82281283e-02 3.52809504e-02
 5.01268059e-02 3.55849881e-03 5.85400723e-02 5.68125173e-02
 2.06697471e-02 5.92092983e-02 4.70889993e-02 4.70890366e-02
 4.70890366e-02 6.37484565e-02 3.59940762e-03 2.02662215e-01
 2.70459522e-02 3.43703888e-02 5.07627986e-02 3.59941134e-03
 2.04384122e-02 2.06696708e-02 3.77984419e-02 1.45849232e-02
 2.06696969e-02 3.68663818e-02 4.70890366e-02 2.06696764e-02
 3.59940762e-03 4.70890366e-02 4.70889993e-02 8.09011888e-03
 9.40758642e-03 4.70890366e-02 5.26679084e-02 1.92837976e-02
 1.41760148e-02 5.97521150e-03 1.83015075e-02 5.36581455e-03
 7.28065148e-02 2.64208820e-02 7.40996189e-03 3.13076340e-02
 6.76611811e-02 1.10768247e-02 7.36649930e-02 1.86639708e-02
 4.17707674e-02 4.17042784e-02 5.92767857e-02 4.70890366e-02
 6.57303678e-03 6.02293201e-02 7.78103694e-02 2.80516725e-02
 4.03777510e-02 1.11434180e-02 1.34774789e-01 6.32319739e-03
 2.28886083e-02 3.37187722e-02 1.25084847e-01 4.41969745e-03
 5.53346239e-03 6.02492597e-03 3.84629779e-02 5.19003393e-03
 7.59130018e-03 2.92142443e-02 5.19002462e-03 1.84490047e-02
 5.36582712e-03 9.70203523e-03 1.20181357e-02 6.01917915e-02
 2.01342311e-02 8.06784164e-03 4.74528875e-03 2.39939969e-02
 4.74528875e-03 8.06784164e-03 4.75859735e-03 2.33961549e-02
 2.78405491e-02 5.77550521e-03 4.75859735e-03 2.01341547e-02
 3.76918539e-02 2.50487149e-01 4.54901122e-02 1.82986148e-02
 2.33962294e-02 2.01342124e-02 4.91717365e-03 9.72770061e-03
 7.56263640e-03 1.55886859e-01 1.63179021e-02 4.41969745e-03
 6.94745481e-02 9.70528461e-03 5.19002462e-03 3.97592299e-02
 2.34869923e-02 2.49455273e-01 1.67688765e-02 4.91717365e-03
 2.53908318e-02 5.43666631e-03 1.41067907e-01 6.46944065e-03
 1.94197856e-02 1.53981462e-01 3.70003586e-03 9.72772855e-03
 1.10203102e-01 5.43665746e-03 1.04370721e-01 1.63621828e-02
 4.92439745e-03 2.15722639e-02 3.60991596e-03 3.57758820e-01
 4.86799516e-03 5.19001763e-03 1.15440348e-02 8.85953661e-03
 8.85953661e-03 7.90805556e-03 4.54447195e-02 1.31029459e-02
 3.60991596e-03 1.90216191e-02 1.22300209e-02 3.23176011e-02
 4.62409183e-02 1.11434180e-02 3.60993249e-03 3.57043594e-02
 4.92442353e-03 1.94198210e-02 9.25394893e-03 4.31001857e-02
 4.62408885e-02 6.73402473e-02 1.31029533e-02 3.68590988e-02
 3.70003190e-03 9.72772855e-03 1.94198061e-02 2.00831685e-02
 3.68974544e-02 6.08055666e-02 3.70004424e-03 4.19641957e-02
 3.70004727e-03 4.20598574e-02 5.77687807e-02 1.90215949e-02
 4.85779345e-03 2.25108396e-02 2.65463274e-02 3.76552204e-03
 8.29288125e-01 3.76553694e-03 3.76553694e-03 3.76553694e-03
 3.76553694e-03 3.76552204e-03 3.76552250e-03 3.76553694e-03
 2.08478346e-02 4.38253861e-03 2.36338638e-02 3.76553205e-03
 3.76552250e-03 3.76552250e-03 3.76552204e-03 3.76553694e-03
 3.76552250e-03 3.76552204e-03 3.76553694e-03 3.76553205e-03
 1.83534790e-02 3.76553694e-03 3.76552250e-03 7.31110722e-02
 3.76553694e-03 2.94535644e-02 3.49960662e-02 3.70004727e-03
 7.91988224e-02 3.28265019e-02 5.01425751e-02 5.01425751e-02
 6.62981495e-02 7.91988224e-02 3.70004727e-03 3.60991550e-03
 3.60993249e-03 3.52202654e-02 3.60991550e-03 1.09866913e-02
 1.93898883e-02 3.76552250e-03 1.11434180e-02 3.70003190e-03
 8.85952637e-03 3.70004424e-03 3.70004727e-03 2.50422712e-02
 3.70004727e-03 3.60991550e-03 3.70004727e-03 3.70004424e-03
 5.35855033e-02 3.60991596e-03 3.70003190e-03 3.60991550e-03
 3.70003190e-03 3.70004727e-03 3.70004424e-03 6.50976375e-02
 3.31210084e-02 1.75764095e-02 3.76552204e-03 2.01791339e-02
 6.33078590e-02 3.70004727e-03 3.60992644e-03 4.81422618e-02
 3.76552250e-03 1.79627668e-02 3.13003920e-02 4.06439789e-03
 3.70004727e-03 3.70003190e-03 1.74820106e-02 7.17556924e-02
 1.73449162e-02 3.70004727e-03 2.08478440e-02 6.58156257e-03
 3.60993249e-03 3.66973951e-02 3.76552204e-03 1.34493774e-02
 4.62003723e-02 3.76552250e-03 3.76552250e-03 2.08478235e-02
 6.58157328e-03 3.70003586e-03 1.34982169e-01 3.90758105e-02
 4.05722596e-02 7.17556700e-02 1.28116198e-02 4.20684330e-02
 4.20683995e-02 3.53759341e-02 8.64874013e-03 3.76553694e-03
 8.26163590e-03 3.32520008e-02 7.17556700e-02 1.78693961e-02
 1.02692684e-02 1.21726431e-02 3.79690784e-03 3.79690272e-03
 3.79690784e-03 3.79690272e-03 3.79690272e-03 1.78513620e-02
 3.34466919e-02 3.79690272e-03 3.79690272e-03 3.76553694e-03
 6.31514890e-03 3.76553694e-03 4.20684330e-02 4.08182219e-02
 3.71469222e-02 9.64844599e-03 3.99922766e-02 4.37355824e-02
 1.83534864e-02 1.46887284e-02 1.83534827e-02 3.76553694e-03
 4.20683585e-02 5.05673792e-03 3.58317536e-03 3.58316419e-03
 3.79690272e-03 5.05673094e-03 5.23132272e-02 8.60206317e-03
 1.16683431e-02 3.76552250e-03 3.79690272e-03 1.50355510e-02
 3.58317746e-03 2.84483749e-02 5.18229790e-03 2.91801915e-02
 1.78513601e-02 2.44340554e-01 6.39758399e-03 9.02290493e-02
 1.68540683e-02 5.18229418e-03 4.69297078e-03 5.13616996e-03
 5.27426274e-03 6.73583383e-03 3.78996246e-02 1.07127493e-02
 3.98914926e-02 5.18228952e-03 5.18228952e-03 5.18229790e-03
 4.89121396e-03 1.50355278e-02 5.18229790e-03 5.27426507e-03
 5.18228952e-03 5.18228952e-03 5.18229790e-03 1.73285883e-02
 5.25950082e-03 4.44224738e-02 5.00793979e-02 3.52706946e-02
 2.94184294e-02 2.46216096e-02 4.33956012e-02 7.54733533e-02
 5.35245007e-03 5.32946037e-03 6.57607429e-03 8.66420269e-02
 2.28256192e-02 5.27426088e-03 7.77486265e-02 1.18459344e-01
 5.35266940e-03 3.88931623e-03 1.51049988e-02 5.85974567e-02
 5.38763916e-03 5.38763916e-03 5.38763916e-03 3.98960197e-03
 5.04144421e-03 3.46452631e-02 3.59381959e-02 1.30785719e-01
 7.25853723e-03 5.81718143e-03 7.11702695e-03 3.88933625e-03
 3.87467374e-03 1.56226419e-02 4.93718497e-03 7.13799801e-03
 5.35267452e-03 1.18459374e-01 3.88931180e-03 1.56226791e-02
 2.04687342e-02 5.56873940e-02 5.38763916e-03 3.98958893e-03
 4.93718637e-03 9.46534239e-03 2.35046074e-02 3.98960523e-03
 3.98958893e-03 3.98960849e-03 4.74762768e-02 4.35935795e-01
 1.38196051e+00 5.38764242e-03 1.06411763e-01 3.98961874e-03
 3.27511802e-02 3.74903297e-03 1.51534051e-01 9.14933719e-03
 3.98960523e-03 4.17363178e-03 3.61708715e-03 5.41638397e-03
 1.61940306e-01 9.14931297e-03 1.31973058e-01 6.03016233e-03
 4.14724275e-02 9.14929900e-03 3.28279622e-02 2.41857842e-02
 9.91600379e-03 4.14037332e-02 1.64973009e-02 5.56949526e-03
 5.56949526e-03 7.70037025e-02 1.12490334e-01 3.59662808e-02
 9.14932508e-03 9.91599727e-03 9.14933719e-03 5.11298282e-03
 5.68532338e-03 5.68532338e-03 5.20336907e-03 5.53172491e-02
 6.05200510e-03 5.68532338e-03 5.11298049e-03 7.76297832e-03
 5.68529870e-03 5.68532338e-03 4.37087798e-03 6.19408069e-03
 5.75816371e-02 4.51866128e-02 5.68532338e-03 1.85749773e-02
 7.76296761e-03 5.68529870e-03 5.74122882e-03 4.65666736e-03
 5.60318446e-03 5.60316909e-03 4.04467359e-02 3.53858480e-03
 5.68532338e-03 3.53858480e-03 3.69772734e-03 5.14847450e-02
 2.82378197e-02 5.68529870e-03 1.22483023e-01 3.32653266e-03
 3.32652917e-03 1.09148528e-02 1.17488252e-02 5.91834122e-03
 5.74122882e-03 7.03239860e-03 4.97585954e-03 2.57583689e-02
 8.03975202e-03 2.57583689e-02 1.46991193e-01 4.87985043e-03
 8.03978369e-03 4.15861513e-03 4.15865378e-03 1.33020177e-01
 4.15861467e-03 2.40104683e-02 4.24028188e-03 2.43046973e-02
 6.32594246e-03 4.87984531e-03 6.32592337e-03 4.35102768e-02
 4.56494614e-02 4.75071892e-02 4.15865006e-03 9.79740731e-03
 7.75461411e-03 4.15865378e-03 5.86411804e-02 3.91667336e-02
 8.74205027e-03 4.87985043e-03 4.15864820e-03 1.42339572e-01
 5.81118185e-03 5.28253755e-03 4.15865006e-03 5.50092338e-03
 1.56804658e-02 5.50092338e-03 5.28253755e-03 5.50092664e-03
 1.69551000e-02 2.90739611e-02 5.69144711e-02 4.15861467e-03
 2.93791033e-02 5.28250355e-03 4.15865378e-03 1.50888219e-01
 5.28253755e-03 5.50092943e-03 5.28252451e-03 5.81116462e-03
 5.81117626e-03 7.97229540e-03 5.81117626e-03 4.15861467e-03
 3.50766769e-03 5.28250355e-03 6.07109489e-03 1.42967939e-01
 3.50766769e-03 5.81114693e-03 4.15861467e-03 8.27229489e-03
 2.12462638e-02 2.73504667e-02 2.73504667e-02 4.06193035e-03
 2.89335195e-02 6.30726572e-03 6.99984143e-03 1.58520311e-01
 2.73504294e-02 5.39329229e-03 2.73504667e-02 9.65233333e-03
 6.99984143e-03 2.73504294e-02 3.98144126e-03 6.03716262e-03
 9.54758655e-03 3.89072928e-03 5.37771685e-03 3.32003948e-03
 6.57560909e-03 5.47476718e-03 3.96215916e-03 3.96215916e-03
 2.02817116e-02 1.71207972e-02 3.96213355e-03 3.96213355e-03
 1.98115762e-02 2.64863987e-02 3.96215916e-03 3.96213355e-03
 3.96217685e-03 3.96214612e-03 1.71207823e-02 1.71207655e-02
 1.71207692e-02 1.71208028e-02 1.59481857e-02 1.05159869e-02
 1.71207841e-02 1.71208214e-02 1.59481857e-02 3.96213355e-03
 1.71518132e-01 1.59481987e-02 5.32886107e-03 1.71207692e-02
 5.30488743e-03 1.95254944e-02 7.76742324e-02 3.96215916e-03
 8.60446393e-02 1.95252318e-02 4.87568192e-02 2.64833234e-02
 2.64833197e-02 5.10698557e-03 2.64833253e-02 2.64833234e-02
 5.11270296e-03 2.59565916e-02 2.79610157e-02 4.76282649e-03
 4.76281065e-03 2.41950843e-02 1.32563626e-02 3.83709595e-02
 4.76282649e-03 1.67068422e-01 2.79610157e-02 5.10696881e-03
 7.35548958e-02 4.76281065e-03 8.82938690e-03 4.76282742e-03
 2.79610157e-02 5.88896172e-03 1.32563356e-02 3.83709595e-02
 2.79610157e-02 2.79610157e-02 1.32563626e-02 4.76281065e-03
 2.79610157e-02 2.79610325e-02 4.76282649e-03 5.88896172e-03
 4.04088497e-02 4.76281065e-03 1.29919490e-02 5.81420632e-03
 5.88896172e-03 5.81420632e-03 3.12322807e-02 3.12322564e-02]
2025-06-02 15:30:45,426 - DEBUG - Edge reconstruction errors: [ 5.2639847  5.2614956 44.25776   ... 13.35774    2.1586237 13.35774  ]
2025-06-02 15:30:45,429 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_153045_update_48.json
2025-06-02 15:30:45,429 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:30:45,467 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_153045_update_48.pth
2025-06-02 15:30:45,468 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870535.dot): 0.9400
2025-06-02 15:30:45,468 - WARNING - Detected 6 anomalous nodes (reconstruction-based):
2025-06-02 15:30:45,468 - WARNING -   Node ID: 192.168.239.101, Recon Error: 0.9161, MLP Score: 0.4333
2025-06-02 15:30:45,468 - WARNING -   Node ID: 192.168.27.13, Recon Error: 1.4702, MLP Score: 0.4990
2025-06-02 15:30:45,469 - WARNING -   Node ID: 192.168.27.10, Recon Error: 1.4722, MLP Score: 0.5176
2025-06-02 15:30:45,469 - WARNING -   Node ID: 192.168.209.130, Recon Error: 0.9725, MLP Score: 0.4971
2025-06-02 15:30:45,469 - WARNING -   Node ID: 183.81.34.26, Recon Error: 9.3009, MLP Score: 0.4990
2025-06-02 15:30:45,469 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:30:45,469 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2578, MLP Score: 0.6231
2025-06-02 15:30:45,470 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9603, MLP Score: 0.8166
2025-06-02 15:30:45,470 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0599, MLP Score: 0.8166
2025-06-02 15:30:45,470 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7587, MLP Score: 0.7610
2025-06-02 15:30:45,471 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7581, MLP Score: 0.7638
2025-06-02 15:30:45,471 - INFO - 
--- Processing file: nw_graph_encoded_1748870565.dot (Timestamp: 2025-06-02 15:22:45) ---
2025-06-02 15:30:45,471 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870565.dot
2025-06-02 15:30:45,471 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870565.dot'.
2025-06-02 15:30:45,471 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870565.dot
2025-06-02 15:30:45,508 - INFO - Parsed 1002 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870565.dot'.
2025-06-02 15:30:45,626 - INFO - Parsed 2201 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870565.dot'.
2025-06-02 15:30:45,626 - INFO - Processing node updates/additions.
2025-06-02 15:30:45,673 - INFO - Processing edge updates/additions.
2025-06-02 15:30:45,855 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:30:45,862 - INFO - Finished updating NetworkX graph.
2025-06-02 15:30:45,866 - DEBUG - Updated graph - Nodes: 1002, Edges: 2201
2025-06-02 15:30:45,867 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:30:45,874 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:30:46,075 - DEBUG - Initial node features tensor shape: torch.Size([1002, 30])
2025-06-02 15:30:46,081 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:30:46,081 - DEBUG - Node features tensor shape after scaling: torch.Size([1002, 30])
2025-06-02 15:30:46,087 - DEBUG - Edge index tensor shape: torch.Size([2, 2201])
2025-06-02 15:30:46,101 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:30:46,205 - DEBUG - Initial edge attributes tensor shape: torch.Size([2201, 10])
2025-06-02 15:30:46,208 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:30:46,209 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2201, 10])
2025-06-02 15:30:46,209 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:30:46,210 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:30:46,214 - INFO - Updated main graph to 1002 nodes and 2201 edges.
2025-06-02 15:30:46,214 - INFO - Performing online update...
2025-06-02 15:30:46,215 - INFO - Starting online update for 25 steps.
2025-06-02 15:30:46,216 - DEBUG - Updated RunningStats: new_mean=0.94498078497351, new_var=28200000000161.395, new_n=2850
2025-06-02 15:30:46,217 - DEBUG - Updated RunningStats: new_mean=0.9428342472347508, new_var=28500000000018.305, new_n=2880
2025-06-02 15:30:46,217 - DEBUG - Updated RunningStats: new_mean=44.78971682909302, new_var=9400000186536.402, new_n=950
2025-06-02 15:30:46,218 - DEBUG - Updated RunningStats: new_mean=44.78387076441833, new_var=9500000169920.123, new_n=960
2025-06-02 15:30:46,218 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:30:46,218 - DEBUG - Online update step: 1/25
2025-06-02 15:30:46,226 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:46,359 - DEBUG - Node anomaly scores shape: torch.Size([18868, 1])
2025-06-02 15:30:46,395 - DEBUG - Edge anomaly scores shape: torch.Size([39415, 1])
2025-06-02 15:30:46,398 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:46,684 - DEBUG - Step 1: Loss=0.6316
2025-06-02 15:30:46,685 - DEBUG - Online update step: 2/25
2025-06-02 15:30:46,700 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:46,821 - DEBUG - Node anomaly scores shape: torch.Size([18249, 1])
2025-06-02 15:30:46,825 - DEBUG - Edge anomaly scores shape: torch.Size([38020, 1])
2025-06-02 15:30:46,828 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:47,080 - DEBUG - Step 2: Loss=0.6503
2025-06-02 15:30:47,081 - DEBUG - Online update step: 3/25
2025-06-02 15:30:47,090 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:47,191 - DEBUG - Node anomaly scores shape: torch.Size([18711, 1])
2025-06-02 15:30:47,195 - DEBUG - Edge anomaly scores shape: torch.Size([39258, 1])
2025-06-02 15:30:47,197 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:47,450 - DEBUG - Step 3: Loss=0.6579
2025-06-02 15:30:47,451 - DEBUG - Online update step: 4/25
2025-06-02 15:30:47,460 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:47,571 - DEBUG - Node anomaly scores shape: torch.Size([20061, 1])
2025-06-02 15:30:47,577 - DEBUG - Edge anomaly scores shape: torch.Size([42034, 1])
2025-06-02 15:30:47,579 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:47,862 - DEBUG - Step 4: Loss=0.6362
2025-06-02 15:30:47,863 - DEBUG - Online update step: 5/25
2025-06-02 15:30:47,871 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:47,966 - DEBUG - Node anomaly scores shape: torch.Size([17288, 1])
2025-06-02 15:30:47,970 - DEBUG - Edge anomaly scores shape: torch.Size([35973, 1])
2025-06-02 15:30:47,971 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:48,170 - DEBUG - Step 5: Loss=0.6510
2025-06-02 15:30:48,170 - DEBUG - Online update step: 6/25
2025-06-02 15:30:48,180 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:48,307 - DEBUG - Node anomaly scores shape: torch.Size([19732, 1])
2025-06-02 15:30:48,312 - DEBUG - Edge anomaly scores shape: torch.Size([41333, 1])
2025-06-02 15:30:48,313 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:48,619 - DEBUG - Step 6: Loss=0.6597
2025-06-02 15:30:48,620 - DEBUG - Online update step: 7/25
2025-06-02 15:30:48,629 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:48,744 - DEBUG - Node anomaly scores shape: torch.Size([20820, 1])
2025-06-02 15:30:48,749 - DEBUG - Edge anomaly scores shape: torch.Size([43910, 1])
2025-06-02 15:30:48,751 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:49,058 - DEBUG - Step 7: Loss=0.6260
2025-06-02 15:30:49,059 - DEBUG - Online update step: 8/25
2025-06-02 15:30:49,069 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:49,169 - DEBUG - Node anomaly scores shape: torch.Size([19101, 1])
2025-06-02 15:30:49,173 - DEBUG - Edge anomaly scores shape: torch.Size([40116, 1])
2025-06-02 15:30:49,174 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:49,422 - DEBUG - Step 8: Loss=0.6527
2025-06-02 15:30:49,422 - DEBUG - Online update step: 9/25
2025-06-02 15:30:49,432 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:49,546 - DEBUG - Node anomaly scores shape: torch.Size([21500, 1])
2025-06-02 15:30:49,551 - DEBUG - Edge anomaly scores shape: torch.Size([45316, 1])
2025-06-02 15:30:49,553 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:49,812 - DEBUG - Step 9: Loss=0.6641
2025-06-02 15:30:49,812 - DEBUG - Online update step: 10/25
2025-06-02 15:30:49,822 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:49,931 - DEBUG - Node anomaly scores shape: torch.Size([20245, 1])
2025-06-02 15:30:49,936 - DEBUG - Edge anomaly scores shape: torch.Size([42587, 1])
2025-06-02 15:30:49,938 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:50,234 - DEBUG - Step 10: Loss=0.6309
2025-06-02 15:30:50,235 - DEBUG - Online update step: 11/25
2025-06-02 15:30:50,248 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:50,354 - DEBUG - Node anomaly scores shape: torch.Size([18787, 1])
2025-06-02 15:30:50,359 - DEBUG - Edge anomaly scores shape: torch.Size([39335, 1])
2025-06-02 15:30:50,361 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:50,590 - DEBUG - Step 11: Loss=0.6442
2025-06-02 15:30:50,591 - DEBUG - Online update step: 12/25
2025-06-02 15:30:50,602 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:50,712 - DEBUG - Node anomaly scores shape: torch.Size([21741, 1])
2025-06-02 15:30:50,717 - DEBUG - Edge anomaly scores shape: torch.Size([45878, 1])
2025-06-02 15:30:50,719 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:50,984 - DEBUG - Step 12: Loss=0.6565
2025-06-02 15:30:50,985 - DEBUG - Online update step: 13/25
2025-06-02 15:30:50,994 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:51,089 - DEBUG - Node anomaly scores shape: torch.Size([18109, 1])
2025-06-02 15:30:51,094 - DEBUG - Edge anomaly scores shape: torch.Size([37728, 1])
2025-06-02 15:30:51,095 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:51,328 - DEBUG - Step 13: Loss=0.6245
2025-06-02 15:30:51,329 - DEBUG - Online update step: 14/25
2025-06-02 15:30:51,344 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:51,451 - DEBUG - Node anomaly scores shape: torch.Size([17623, 1])
2025-06-02 15:30:51,456 - DEBUG - Edge anomaly scores shape: torch.Size([36821, 1])
2025-06-02 15:30:51,458 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:51,662 - DEBUG - Step 14: Loss=0.6474
2025-06-02 15:30:51,663 - DEBUG - Online update step: 15/25
2025-06-02 15:30:51,672 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:51,816 - DEBUG - Node anomaly scores shape: torch.Size([20388, 1])
2025-06-02 15:30:51,822 - DEBUG - Edge anomaly scores shape: torch.Size([43059, 1])
2025-06-02 15:30:51,824 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:52,078 - DEBUG - Step 15: Loss=0.6591
2025-06-02 15:30:52,079 - DEBUG - Online update step: 16/25
2025-06-02 15:30:52,087 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:52,192 - DEBUG - Node anomaly scores shape: torch.Size([21236, 1])
2025-06-02 15:30:52,198 - DEBUG - Edge anomaly scores shape: torch.Size([44562, 1])
2025-06-02 15:30:52,199 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:52,460 - DEBUG - Step 16: Loss=0.6269
2025-06-02 15:30:52,460 - DEBUG - Online update step: 17/25
2025-06-02 15:30:52,468 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:52,575 - DEBUG - Node anomaly scores shape: torch.Size([19799, 1])
2025-06-02 15:30:52,580 - DEBUG - Edge anomaly scores shape: torch.Size([41527, 1])
2025-06-02 15:30:52,581 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:52,820 - DEBUG - Step 17: Loss=0.6423
2025-06-02 15:30:52,821 - DEBUG - Online update step: 18/25
2025-06-02 15:30:52,829 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:52,931 - DEBUG - Node anomaly scores shape: torch.Size([19958, 1])
2025-06-02 15:30:52,937 - DEBUG - Edge anomaly scores shape: torch.Size([42020, 1])
2025-06-02 15:30:52,938 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:53,178 - DEBUG - Step 18: Loss=0.6551
2025-06-02 15:30:53,178 - DEBUG - Online update step: 19/25
2025-06-02 15:30:53,186 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:53,281 - DEBUG - Node anomaly scores shape: torch.Size([18431, 1])
2025-06-02 15:30:53,285 - DEBUG - Edge anomaly scores shape: torch.Size([38626, 1])
2025-06-02 15:30:53,287 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:53,487 - DEBUG - Step 19: Loss=0.6230
2025-06-02 15:30:53,488 - DEBUG - Online update step: 20/25
2025-06-02 15:30:53,496 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:53,623 - DEBUG - Node anomaly scores shape: torch.Size([20172, 1])
2025-06-02 15:30:53,627 - DEBUG - Edge anomaly scores shape: torch.Size([42360, 1])
2025-06-02 15:30:53,629 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:53,890 - DEBUG - Step 20: Loss=0.6432
2025-06-02 15:30:53,891 - DEBUG - Online update step: 21/25
2025-06-02 15:30:53,899 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:54,007 - DEBUG - Node anomaly scores shape: torch.Size([21981, 1])
2025-06-02 15:30:54,012 - DEBUG - Edge anomaly scores shape: torch.Size([46442, 1])
2025-06-02 15:30:54,014 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:54,310 - DEBUG - Step 21: Loss=0.6558
2025-06-02 15:30:54,311 - DEBUG - Online update step: 22/25
2025-06-02 15:30:54,319 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:54,412 - DEBUG - Node anomaly scores shape: torch.Size([18802, 1])
2025-06-02 15:30:54,416 - DEBUG - Edge anomaly scores shape: torch.Size([39494, 1])
2025-06-02 15:30:54,418 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:54,631 - DEBUG - Step 22: Loss=0.6262
2025-06-02 15:30:54,632 - DEBUG - Online update step: 23/25
2025-06-02 15:30:54,641 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:54,784 - DEBUG - Node anomaly scores shape: torch.Size([20807, 1])
2025-06-02 15:30:54,790 - DEBUG - Edge anomaly scores shape: torch.Size([43953, 1])
2025-06-02 15:30:54,792 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:55,085 - DEBUG - Step 23: Loss=0.6393
2025-06-02 15:30:55,085 - DEBUG - Online update step: 24/25
2025-06-02 15:30:55,095 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:55,211 - DEBUG - Node anomaly scores shape: torch.Size([21273, 1])
2025-06-02 15:30:55,216 - DEBUG - Edge anomaly scores shape: torch.Size([44987, 1])
2025-06-02 15:30:55,218 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:55,504 - DEBUG - Step 24: Loss=0.6512
2025-06-02 15:30:55,504 - DEBUG - Online update step: 25/25
2025-06-02 15:30:55,516 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:55,616 - DEBUG - Node anomaly scores shape: torch.Size([17676, 1])
2025-06-02 15:30:55,621 - DEBUG - Edge anomaly scores shape: torch.Size([36856, 1])
2025-06-02 15:30:55,623 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:55,816 - DEBUG - Step 25: Loss=0.6235
2025-06-02 15:30:55,817 - INFO - Online update finished. Average loss: 0.6431, Learning rate: 0.001000
2025-06-02 15:30:55,818 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -4.1402028e-08 -1.1897135e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.4746040e-08
 -2.0463071e-08 -1.6299074e-08  3.4263749e-08 -4.7588538e-09
  2.2634730e+00  2.9620759e+00  1.4970060e-01  4.3922157e+00
  1.6299074e-08  3.4391217e+00  5.7734532e+00  7.6127744e+00
  1.4970060e-01  7.9930139e+00 -2.3318384e-08  3.9379515e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.8791066e-08  8.0900513e-09], current edge mean: [-8.6658275e-10  4.5525443e+02  0.0000000e+00  0.0000000e+00
  1.5165198e-09 -3.0330396e-09  6.4993708e-09 -4.4412367e-09
  2.8163940e-09  3.0330396e-09]
2025-06-02 15:30:55,819 - DEBUG - Node drift difference: 0.0196, Edge drift difference: 0.0003
2025-06-02 15:30:55,821 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -4.1402028e-08 -1.1897135e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.4746040e-08
 -2.0463071e-08 -1.6299074e-08  3.4263749e-08 -4.7588538e-09
  2.2634730e+00  2.9620759e+00  1.4970060e-01  4.3922157e+00
  1.6299074e-08  3.4391217e+00  5.7734532e+00  7.6127744e+00
  1.4970060e-01  7.9930139e+00 -2.3318384e-08  3.9379515e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.8791066e-08  8.0900513e-09], edge=[-8.6658275e-10  4.5525443e+02  0.0000000e+00  0.0000000e+00
  1.5165198e-09 -3.0330396e-09  6.4993708e-09 -4.4412367e-09
  2.8163940e-09  3.0330396e-09]
2025-06-02 15:30:55,822 - DEBUG - Updated reference std: node=[0.         0.         1.0004994  1.0004994  0.         0.
 0.         1.0004994  1.0004994  1.0004994  1.0004994  1.0004994
 0.93571764 0.27291828 0.3706852  0.573176   1.0004994  3.0238457
 2.9087992  1.4844369  0.3706852  0.2211384  1.0004994  1.0004994
 0.         0.         0.         0.         1.0004994  1.0004994 ], edge=[  1.0002272 435.28336     0.          0.          1.0002272   1.0002272
   1.0002272   1.0002272   1.0002272   1.0002272]
2025-06-02 15:30:55,823 - INFO - Online update complete. Loss: 0.6431
2025-06-02 15:30:55,823 - INFO - Running anomaly detection...
2025-06-02 15:30:55,824 - INFO - Starting anomaly detection.
2025-06-02 15:30:55,855 - DEBUG - Node reconstruction errors: [0.117345   0.8406359  1.5525187  ... 0.0658894  0.02621703 0.02733582]
2025-06-02 15:30:55,856 - DEBUG - Edge reconstruction errors: [ 5.2641025  5.2616005 44.257847  ... 13.357831   2.158717  13.357831 ]
2025-06-02 15:30:55,868 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_153055_update_49.json
2025-06-02 15:30:55,869 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:30:55,911 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_153055_update_49.pth
2025-06-02 15:30:55,912 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870565.dot): 0.9394
2025-06-02 15:30:55,912 - WARNING - Detected 6 anomalous nodes (reconstruction-based):
2025-06-02 15:30:55,912 - WARNING -   Node ID: 192.168.239.101, Recon Error: 0.8406, MLP Score: 0.4181
2025-06-02 15:30:55,913 - WARNING -   Node ID: 192.168.27.13, Recon Error: 1.5525, MLP Score: 0.4875
2025-06-02 15:30:55,913 - WARNING -   Node ID: 192.168.27.10, Recon Error: 1.3754, MLP Score: 0.4872
2025-06-02 15:30:55,913 - WARNING -   Node ID: 192.168.209.130, Recon Error: 0.8655, MLP Score: 0.5011
2025-06-02 15:30:55,913 - WARNING -   Node ID: 183.81.34.26, Recon Error: 9.1416, MLP Score: 0.4875
2025-06-02 15:30:55,913 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:30:55,914 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2579, MLP Score: 0.0087
2025-06-02 15:30:55,914 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9603, MLP Score: 0.0018
2025-06-02 15:30:55,914 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0600, MLP Score: 0.0018
2025-06-02 15:30:55,915 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7587, MLP Score: 0.0007
2025-06-02 15:30:55,915 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7582, MLP Score: 0.0006
2025-06-02 15:30:55,915 - INFO - 
--- Processing file: nw_graph_encoded_1748870595.dot (Timestamp: 2025-06-02 15:23:15) ---
2025-06-02 15:30:55,915 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870595.dot
2025-06-02 15:30:55,916 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870595.dot'.
2025-06-02 15:30:55,916 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870595.dot
2025-06-02 15:30:55,957 - INFO - Parsed 1003 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870595.dot'.
2025-06-02 15:30:56,074 - INFO - Parsed 2202 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870595.dot'.
2025-06-02 15:30:56,074 - INFO - Processing node updates/additions.
2025-06-02 15:30:56,120 - INFO - Processing edge updates/additions.
2025-06-02 15:30:56,300 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:30:56,307 - INFO - Finished updating NetworkX graph.
2025-06-02 15:30:56,311 - DEBUG - Updated graph - Nodes: 1003, Edges: 2202
2025-06-02 15:30:56,311 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:30:56,319 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:30:56,515 - DEBUG - Initial node features tensor shape: torch.Size([1003, 30])
2025-06-02 15:30:56,524 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:30:56,537 - DEBUG - Node features tensor shape after scaling: torch.Size([1003, 30])
2025-06-02 15:30:56,553 - DEBUG - Edge index tensor shape: torch.Size([2, 2202])
2025-06-02 15:30:56,567 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:30:56,668 - DEBUG - Initial edge attributes tensor shape: torch.Size([2202, 10])
2025-06-02 15:30:56,675 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:30:56,676 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2202, 10])
2025-06-02 15:30:56,676 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:30:56,677 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:30:56,681 - INFO - Updated main graph to 1003 nodes and 2202 edges.
2025-06-02 15:30:56,682 - INFO - Performing online update...
2025-06-02 15:30:56,682 - INFO - Starting online update for 25 steps.
2025-06-02 15:30:56,683 - DEBUG - Updated RunningStats: new_mean=0.9450520328433731, new_var=28800000000161.414, new_n=2910
2025-06-02 15:30:56,684 - DEBUG - Updated RunningStats: new_mean=0.942950469417523, new_var=29100000000018.3, new_n=2940
2025-06-02 15:30:56,684 - DEBUG - Updated RunningStats: new_mean=44.79151010792172, new_var=9600000186531.814, new_n=970
2025-06-02 15:30:56,685 - DEBUG - Updated RunningStats: new_mean=44.785664218748245, new_var=9700000169842.979, new_n=980
2025-06-02 15:30:56,686 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:30:56,687 - DEBUG - Online update step: 1/25
2025-06-02 15:30:56,699 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:56,902 - DEBUG - Node anomaly scores shape: torch.Size([18195, 1])
2025-06-02 15:30:56,919 - DEBUG - Edge anomaly scores shape: torch.Size([37909, 1])
2025-06-02 15:30:56,921 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:57,139 - DEBUG - Step 1: Loss=0.6432
2025-06-02 15:30:57,139 - DEBUG - Online update step: 2/25
2025-06-02 15:30:57,162 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:57,308 - DEBUG - Node anomaly scores shape: torch.Size([19925, 1])
2025-06-02 15:30:57,315 - DEBUG - Edge anomaly scores shape: torch.Size([42192, 1])
2025-06-02 15:30:57,317 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:57,625 - DEBUG - Step 2: Loss=0.6534
2025-06-02 15:30:57,626 - DEBUG - Online update step: 3/25
2025-06-02 15:30:57,639 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:57,735 - DEBUG - Node anomaly scores shape: torch.Size([18363, 1])
2025-06-02 15:30:57,739 - DEBUG - Edge anomaly scores shape: torch.Size([38432, 1])
2025-06-02 15:30:57,741 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:57,996 - DEBUG - Step 3: Loss=0.6270
2025-06-02 15:30:57,997 - DEBUG - Online update step: 4/25
2025-06-02 15:30:58,011 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:58,126 - DEBUG - Node anomaly scores shape: torch.Size([19312, 1])
2025-06-02 15:30:58,131 - DEBUG - Edge anomaly scores shape: torch.Size([40620, 1])
2025-06-02 15:30:58,133 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:58,431 - DEBUG - Step 4: Loss=0.6390
2025-06-02 15:30:58,431 - DEBUG - Online update step: 5/25
2025-06-02 15:30:58,440 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:58,543 - DEBUG - Node anomaly scores shape: torch.Size([19450, 1])
2025-06-02 15:30:58,547 - DEBUG - Edge anomaly scores shape: torch.Size([40900, 1])
2025-06-02 15:30:58,549 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:58,835 - DEBUG - Step 5: Loss=0.6499
2025-06-02 15:30:58,836 - DEBUG - Online update step: 6/25
2025-06-02 15:30:58,855 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:58,973 - DEBUG - Node anomaly scores shape: torch.Size([20576, 1])
2025-06-02 15:30:58,978 - DEBUG - Edge anomaly scores shape: torch.Size([43393, 1])
2025-06-02 15:30:58,980 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:59,241 - DEBUG - Step 6: Loss=0.6214
2025-06-02 15:30:59,241 - DEBUG - Online update step: 7/25
2025-06-02 15:30:59,252 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:59,350 - DEBUG - Node anomaly scores shape: torch.Size([18259, 1])
2025-06-02 15:30:59,354 - DEBUG - Edge anomaly scores shape: torch.Size([38066, 1])
2025-06-02 15:30:59,356 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:59,592 - DEBUG - Step 7: Loss=0.6436
2025-06-02 15:30:59,593 - DEBUG - Online update step: 8/25
2025-06-02 15:30:59,608 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:30:59,718 - DEBUG - Node anomaly scores shape: torch.Size([19580, 1])
2025-06-02 15:30:59,724 - DEBUG - Edge anomaly scores shape: torch.Size([41153, 1])
2025-06-02 15:30:59,726 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:30:59,956 - DEBUG - Step 8: Loss=0.6539
2025-06-02 15:30:59,957 - DEBUG - Online update step: 9/25
2025-06-02 15:30:59,965 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:00,071 - DEBUG - Node anomaly scores shape: torch.Size([18363, 1])
2025-06-02 15:31:00,075 - DEBUG - Edge anomaly scores shape: torch.Size([38427, 1])
2025-06-02 15:31:00,076 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:00,323 - DEBUG - Step 9: Loss=0.6249
2025-06-02 15:31:00,324 - DEBUG - Online update step: 10/25
2025-06-02 15:31:00,332 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:00,431 - DEBUG - Node anomaly scores shape: torch.Size([19687, 1])
2025-06-02 15:31:00,435 - DEBUG - Edge anomaly scores shape: torch.Size([41297, 1])
2025-06-02 15:31:00,437 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:00,729 - DEBUG - Step 10: Loss=0.6392
2025-06-02 15:31:00,730 - DEBUG - Online update step: 11/25
2025-06-02 15:31:00,739 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:00,827 - DEBUG - Node anomaly scores shape: torch.Size([18341, 1])
2025-06-02 15:31:00,832 - DEBUG - Edge anomaly scores shape: torch.Size([38477, 1])
2025-06-02 15:31:00,833 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:01,025 - DEBUG - Step 11: Loss=0.6510
2025-06-02 15:31:01,026 - DEBUG - Online update step: 12/25
2025-06-02 15:31:01,036 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:01,138 - DEBUG - Node anomaly scores shape: torch.Size([18311, 1])
2025-06-02 15:31:01,142 - DEBUG - Edge anomaly scores shape: torch.Size([38158, 1])
2025-06-02 15:31:01,143 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:01,350 - DEBUG - Step 12: Loss=0.6221
2025-06-02 15:31:01,350 - DEBUG - Online update step: 13/25
2025-06-02 15:31:01,359 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:01,471 - DEBUG - Node anomaly scores shape: torch.Size([22315, 1])
2025-06-02 15:31:01,478 - DEBUG - Edge anomaly scores shape: torch.Size([47219, 1])
2025-06-02 15:31:01,479 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:01,884 - DEBUG - Step 13: Loss=0.6397
2025-06-02 15:31:01,885 - DEBUG - Online update step: 14/25
2025-06-02 15:31:01,896 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:02,373 - DEBUG - Node anomaly scores shape: torch.Size([19970, 1])
2025-06-02 15:31:02,386 - DEBUG - Edge anomaly scores shape: torch.Size([42093, 1])
2025-06-02 15:31:02,387 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:03,010 - DEBUG - Step 14: Loss=0.6517
2025-06-02 15:31:03,010 - DEBUG - Online update step: 15/25
2025-06-02 15:31:03,020 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:03,307 - DEBUG - Node anomaly scores shape: torch.Size([18291, 1])
2025-06-02 15:31:03,323 - DEBUG - Edge anomaly scores shape: torch.Size([38208, 1])
2025-06-02 15:31:03,325 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:03,520 - DEBUG - Step 15: Loss=0.6228
2025-06-02 15:31:03,521 - DEBUG - Online update step: 16/25
2025-06-02 15:31:03,530 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:03,671 - DEBUG - Node anomaly scores shape: torch.Size([21563, 1])
2025-06-02 15:31:03,678 - DEBUG - Edge anomaly scores shape: torch.Size([45505, 1])
2025-06-02 15:31:03,679 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:03,931 - DEBUG - Step 16: Loss=0.6377
2025-06-02 15:31:03,932 - DEBUG - Online update step: 17/25
2025-06-02 15:31:03,941 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:04,036 - DEBUG - Node anomaly scores shape: torch.Size([19232, 1])
2025-06-02 15:31:04,041 - DEBUG - Edge anomaly scores shape: torch.Size([40274, 1])
2025-06-02 15:31:04,042 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:04,262 - DEBUG - Step 17: Loss=0.6501
2025-06-02 15:31:04,262 - DEBUG - Online update step: 18/25
2025-06-02 15:31:04,271 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:04,381 - DEBUG - Node anomaly scores shape: torch.Size([18877, 1])
2025-06-02 15:31:04,386 - DEBUG - Edge anomaly scores shape: torch.Size([39539, 1])
2025-06-02 15:31:04,388 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:04,674 - DEBUG - Step 18: Loss=0.6211
2025-06-02 15:31:04,675 - DEBUG - Online update step: 19/25
2025-06-02 15:31:04,684 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:04,794 - DEBUG - Node anomaly scores shape: torch.Size([20182, 1])
2025-06-02 15:31:04,798 - DEBUG - Edge anomaly scores shape: torch.Size([42520, 1])
2025-06-02 15:31:04,800 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:05,084 - DEBUG - Step 19: Loss=0.6383
2025-06-02 15:31:05,085 - DEBUG - Online update step: 20/25
2025-06-02 15:31:05,094 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:05,208 - DEBUG - Node anomaly scores shape: torch.Size([20752, 1])
2025-06-02 15:31:05,214 - DEBUG - Edge anomaly scores shape: torch.Size([43687, 1])
2025-06-02 15:31:05,216 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:05,469 - DEBUG - Step 20: Loss=0.6508
2025-06-02 15:31:05,470 - DEBUG - Online update step: 21/25
2025-06-02 15:31:05,479 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:05,582 - DEBUG - Node anomaly scores shape: torch.Size([19420, 1])
2025-06-02 15:31:05,588 - DEBUG - Edge anomaly scores shape: torch.Size([40795, 1])
2025-06-02 15:31:05,590 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:05,871 - DEBUG - Step 21: Loss=0.6221
2025-06-02 15:31:05,872 - DEBUG - Online update step: 22/25
2025-06-02 15:31:05,880 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:06,001 - DEBUG - Node anomaly scores shape: torch.Size([21140, 1])
2025-06-02 15:31:06,008 - DEBUG - Edge anomaly scores shape: torch.Size([44485, 1])
2025-06-02 15:31:06,009 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:06,294 - DEBUG - Step 22: Loss=0.6371
2025-06-02 15:31:06,295 - DEBUG - Online update step: 23/25
2025-06-02 15:31:06,307 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:06,428 - DEBUG - Node anomaly scores shape: torch.Size([19690, 1])
2025-06-02 15:31:06,434 - DEBUG - Edge anomaly scores shape: torch.Size([41176, 1])
2025-06-02 15:31:06,436 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:06,748 - DEBUG - Step 23: Loss=0.6490
2025-06-02 15:31:06,748 - DEBUG - Online update step: 24/25
2025-06-02 15:31:06,761 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:06,873 - DEBUG - Node anomaly scores shape: torch.Size([19832, 1])
2025-06-02 15:31:06,878 - DEBUG - Edge anomaly scores shape: torch.Size([41591, 1])
2025-06-02 15:31:06,880 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:07,181 - DEBUG - Step 24: Loss=0.6195
2025-06-02 15:31:07,182 - DEBUG - Online update step: 25/25
2025-06-02 15:31:07,194 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:07,301 - DEBUG - Node anomaly scores shape: torch.Size([18210, 1])
2025-06-02 15:31:07,306 - DEBUG - Edge anomaly scores shape: torch.Size([38252, 1])
2025-06-02 15:31:07,308 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:07,533 - DEBUG - Step 25: Loss=0.6386
2025-06-02 15:31:07,533 - INFO - Online update finished. Average loss: 0.6379, Learning rate: 0.001000
2025-06-02 15:31:07,538 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00  2.28197248e-08 -1.90164373e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  1.33115057e-08
  3.09017101e-09 -3.68443476e-09 -1.23606840e-08 -1.90164373e-09
  2.26719832e+00  2.96211362e+00  1.49551347e-01  4.39282131e+00
  3.68443476e-09  3.43569303e+00  5.77567291e+00  7.61316061e+00
  1.49551347e-01  7.99302101e+00 -1.37869165e-08 -7.96313326e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -4.51640370e-09  3.28033529e-08], current edge mean: [-1.7323785e-09  4.5524887e+02  0.0000000e+00  0.0000000e+00
  3.2482095e-09 -2.1654731e-10 -6.9295139e-09 -2.5985676e-09
 -2.3820204e-09  3.4647569e-09]
2025-06-02 15:31:07,540 - DEBUG - Node drift difference: 0.0040, Edge drift difference: 0.0000
2025-06-02 15:31:07,543 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00  2.28197248e-08 -1.90164373e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  1.33115057e-08
  3.09017101e-09 -3.68443476e-09 -1.23606840e-08 -1.90164373e-09
  2.26719832e+00  2.96211362e+00  1.49551347e-01  4.39282131e+00
  3.68443476e-09  3.43569303e+00  5.77567291e+00  7.61316061e+00
  1.49551347e-01  7.99302101e+00 -1.37869165e-08 -7.96313326e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -4.51640370e-09  3.28033529e-08], edge=[-1.7323785e-09  4.5524887e+02  0.0000000e+00  0.0000000e+00
  3.2482095e-09 -2.1654731e-10 -6.9295139e-09 -2.5985676e-09
 -2.3820204e-09  3.4647569e-09]
2025-06-02 15:31:07,545 - DEBUG - Updated reference std: node=[0.         0.         1.0004989  1.0004989  0.         0.
 0.         1.0004989  1.0004989  1.0004989  1.0004989  1.0004989
 0.942663   0.2727847  0.3705303  0.57321125 1.0004989  3.0242865
 2.9081972  1.4837464  0.3705303  0.22102815 1.0004989  1.0004989
 0.         0.         0.         0.         1.0004989  1.0004989 ], edge=[  1.0002271 435.18454     0.          0.          1.0002272   1.0002272
   1.0002271   1.0002271   1.0002271   1.0002271]
2025-06-02 15:31:07,546 - INFO - Online update complete. Loss: 0.6379
2025-06-02 15:31:07,546 - INFO - Running anomaly detection...
2025-06-02 15:31:07,547 - INFO - Starting anomaly detection.
2025-06-02 15:31:07,574 - DEBUG - Node reconstruction errors: [0.1766345  0.74817985 1.5704615  ... 0.02351832 0.02610696 0.01217255]
2025-06-02 15:31:07,575 - DEBUG - Edge reconstruction errors: [ 5.2641134  5.261611  44.257854  ... 13.357839   2.1587267 13.357839 ]
2025-06-02 15:31:07,578 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_153107_update_50.json
2025-06-02 15:31:07,578 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:31:07,621 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_153107_update_50.pth
2025-06-02 15:31:07,621 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870595.dot): 0.9395
2025-06-02 15:31:07,621 - WARNING - Detected 4 anomalous nodes (reconstruction-based):
2025-06-02 15:31:07,622 - WARNING -   Node ID: 192.168.27.13, Recon Error: 1.5705, MLP Score: 0.4946
2025-06-02 15:31:07,622 - WARNING -   Node ID: 192.168.27.10, Recon Error: 1.1650, MLP Score: 0.4879
2025-06-02 15:31:07,622 - WARNING -   Node ID: 183.81.34.26, Recon Error: 9.1055, MLP Score: 0.4946
2025-06-02 15:31:07,622 - WARNING -   Node ID: 142.250.76.14, Recon Error: 1.2719, MLP Score: 0.4916
2025-06-02 15:31:07,622 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:31:07,623 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2579, MLP Score: 0.0023
2025-06-02 15:31:07,623 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9603, MLP Score: 0.0003
2025-06-02 15:31:07,623 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0600, MLP Score: 0.0003
2025-06-02 15:31:07,624 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7587, MLP Score: 0.0001
2025-06-02 15:31:07,624 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7582, MLP Score: 0.0001
2025-06-02 15:31:07,624 - INFO - 
--- Processing file: nw_graph_encoded_1748870625.dot (Timestamp: 2025-06-02 15:23:45) ---
2025-06-02 15:31:07,624 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870625.dot
2025-06-02 15:31:07,624 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870625.dot'.
2025-06-02 15:31:07,625 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870625.dot
2025-06-02 15:31:07,662 - INFO - Parsed 1003 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870625.dot'.
2025-06-02 15:31:07,783 - INFO - Parsed 2202 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870625.dot'.
2025-06-02 15:31:07,783 - INFO - Processing node updates/additions.
2025-06-02 15:31:07,828 - INFO - Processing edge updates/additions.
2025-06-02 15:31:08,011 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:31:08,018 - INFO - Finished updating NetworkX graph.
2025-06-02 15:31:08,022 - DEBUG - Updated graph - Nodes: 1003, Edges: 2202
2025-06-02 15:31:08,022 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:31:08,030 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:31:08,229 - DEBUG - Initial node features tensor shape: torch.Size([1003, 30])
2025-06-02 15:31:08,236 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:31:08,236 - DEBUG - Node features tensor shape after scaling: torch.Size([1003, 30])
2025-06-02 15:31:08,242 - DEBUG - Edge index tensor shape: torch.Size([2, 2202])
2025-06-02 15:31:08,256 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:31:08,357 - DEBUG - Initial edge attributes tensor shape: torch.Size([2202, 10])
2025-06-02 15:31:08,360 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:31:08,361 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2202, 10])
2025-06-02 15:31:08,362 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:31:08,362 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:31:08,366 - INFO - Updated main graph to 1003 nodes and 2202 edges.
2025-06-02 15:31:08,367 - INFO - Performing online update...
2025-06-02 15:31:08,367 - INFO - Starting online update for 25 steps.
2025-06-02 15:31:08,368 - DEBUG - Updated RunningStats: new_mean=0.9451222773150341, new_var=29400000000161.41, new_n=2970
2025-06-02 15:31:08,369 - DEBUG - Updated RunningStats: new_mean=0.9430620427129843, new_var=29700000000018.305, new_n=3000
2025-06-02 15:31:08,369 - DEBUG - Updated RunningStats: new_mean=44.79313111637954, new_var=9800000186531.791, new_n=990
2025-06-02 15:31:08,370 - DEBUG - Updated RunningStats: new_mean=44.78738593490496, new_var=9900000169842.998, new_n=1000
2025-06-02 15:31:08,370 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:31:08,370 - DEBUG - Online update step: 1/25
2025-06-02 15:31:08,378 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:08,528 - DEBUG - Node anomaly scores shape: torch.Size([19170, 1])
2025-06-02 15:31:08,562 - DEBUG - Edge anomaly scores shape: torch.Size([40282, 1])
2025-06-02 15:31:08,567 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:08,807 - DEBUG - Step 1: Loss=0.6504
2025-06-02 15:31:08,808 - DEBUG - Online update step: 2/25
2025-06-02 15:31:08,817 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:08,951 - DEBUG - Node anomaly scores shape: torch.Size([20739, 1])
2025-06-02 15:31:08,958 - DEBUG - Edge anomaly scores shape: torch.Size([43681, 1])
2025-06-02 15:31:08,959 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:09,211 - DEBUG - Step 2: Loss=0.6209
2025-06-02 15:31:09,211 - DEBUG - Online update step: 3/25
2025-06-02 15:31:09,227 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:09,339 - DEBUG - Node anomaly scores shape: torch.Size([20564, 1])
2025-06-02 15:31:09,344 - DEBUG - Edge anomaly scores shape: torch.Size([43438, 1])
2025-06-02 15:31:09,346 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:09,608 - DEBUG - Step 3: Loss=0.6361
2025-06-02 15:31:09,609 - DEBUG - Online update step: 4/25
2025-06-02 15:31:09,618 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:09,723 - DEBUG - Node anomaly scores shape: torch.Size([20094, 1])
2025-06-02 15:31:09,728 - DEBUG - Edge anomaly scores shape: torch.Size([42398, 1])
2025-06-02 15:31:09,730 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:09,972 - DEBUG - Step 4: Loss=0.6483
2025-06-02 15:31:09,972 - DEBUG - Online update step: 5/25
2025-06-02 15:31:09,985 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:10,104 - DEBUG - Node anomaly scores shape: torch.Size([21180, 1])
2025-06-02 15:31:10,110 - DEBUG - Edge anomaly scores shape: torch.Size([44644, 1])
2025-06-02 15:31:10,112 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:10,381 - DEBUG - Step 5: Loss=0.6190
2025-06-02 15:31:10,381 - DEBUG - Online update step: 6/25
2025-06-02 15:31:10,394 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:10,520 - DEBUG - Node anomaly scores shape: torch.Size([20290, 1])
2025-06-02 15:31:10,526 - DEBUG - Edge anomaly scores shape: torch.Size([42670, 1])
2025-06-02 15:31:10,527 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:10,796 - DEBUG - Step 6: Loss=0.6366
2025-06-02 15:31:10,797 - DEBUG - Online update step: 7/25
2025-06-02 15:31:10,810 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:10,930 - DEBUG - Node anomaly scores shape: torch.Size([19935, 1])
2025-06-02 15:31:10,936 - DEBUG - Edge anomaly scores shape: torch.Size([42008, 1])
2025-06-02 15:31:10,939 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:11,159 - DEBUG - Step 7: Loss=0.6483
2025-06-02 15:31:11,160 - DEBUG - Online update step: 8/25
2025-06-02 15:31:11,168 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:11,263 - DEBUG - Node anomaly scores shape: torch.Size([18580, 1])
2025-06-02 15:31:11,267 - DEBUG - Edge anomaly scores shape: torch.Size([38867, 1])
2025-06-02 15:31:11,269 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:11,511 - DEBUG - Step 8: Loss=0.6201
2025-06-02 15:31:11,511 - DEBUG - Online update step: 9/25
2025-06-02 15:31:11,526 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:11,667 - DEBUG - Node anomaly scores shape: torch.Size([22834, 1])
2025-06-02 15:31:11,673 - DEBUG - Edge anomaly scores shape: torch.Size([48339, 1])
2025-06-02 15:31:11,675 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:12,034 - DEBUG - Step 9: Loss=0.6346
2025-06-02 15:31:12,035 - DEBUG - Online update step: 10/25
2025-06-02 15:31:12,047 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:12,153 - DEBUG - Node anomaly scores shape: torch.Size([19355, 1])
2025-06-02 15:31:12,158 - DEBUG - Edge anomaly scores shape: torch.Size([40926, 1])
2025-06-02 15:31:12,160 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:12,438 - DEBUG - Step 10: Loss=0.6473
2025-06-02 15:31:12,438 - DEBUG - Online update step: 11/25
2025-06-02 15:31:12,447 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:12,564 - DEBUG - Node anomaly scores shape: torch.Size([19740, 1])
2025-06-02 15:31:12,569 - DEBUG - Edge anomaly scores shape: torch.Size([41475, 1])
2025-06-02 15:31:12,570 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:12,871 - DEBUG - Step 11: Loss=0.6177
2025-06-02 15:31:12,871 - DEBUG - Online update step: 12/25
2025-06-02 15:31:12,882 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:12,994 - DEBUG - Node anomaly scores shape: torch.Size([19561, 1])
2025-06-02 15:31:13,000 - DEBUG - Edge anomaly scores shape: torch.Size([41053, 1])
2025-06-02 15:31:13,002 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:13,260 - DEBUG - Step 12: Loss=0.6363
2025-06-02 15:31:13,261 - DEBUG - Online update step: 13/25
2025-06-02 15:31:13,270 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:13,374 - DEBUG - Node anomaly scores shape: torch.Size([18460, 1])
2025-06-02 15:31:13,378 - DEBUG - Edge anomaly scores shape: torch.Size([38736, 1])
2025-06-02 15:31:13,383 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:13,684 - DEBUG - Step 13: Loss=0.6481
2025-06-02 15:31:13,685 - DEBUG - Online update step: 14/25
2025-06-02 15:31:13,698 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:13,818 - DEBUG - Node anomaly scores shape: torch.Size([21124, 1])
2025-06-02 15:31:13,824 - DEBUG - Edge anomaly scores shape: torch.Size([44834, 1])
2025-06-02 15:31:13,826 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:14,118 - DEBUG - Step 14: Loss=0.6190
2025-06-02 15:31:14,118 - DEBUG - Online update step: 15/25
2025-06-02 15:31:14,127 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:14,231 - DEBUG - Node anomaly scores shape: torch.Size([19675, 1])
2025-06-02 15:31:14,237 - DEBUG - Edge anomaly scores shape: torch.Size([41200, 1])
2025-06-02 15:31:14,239 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:14,540 - DEBUG - Step 15: Loss=0.6342
2025-06-02 15:31:14,541 - DEBUG - Online update step: 16/25
2025-06-02 15:31:14,554 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:14,664 - DEBUG - Node anomaly scores shape: torch.Size([20221, 1])
2025-06-02 15:31:14,669 - DEBUG - Edge anomaly scores shape: torch.Size([42557, 1])
2025-06-02 15:31:14,671 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:14,961 - DEBUG - Step 16: Loss=0.6459
2025-06-02 15:31:14,961 - DEBUG - Online update step: 17/25
2025-06-02 15:31:14,972 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:15,071 - DEBUG - Node anomaly scores shape: torch.Size([18374, 1])
2025-06-02 15:31:15,075 - DEBUG - Edge anomaly scores shape: torch.Size([38463, 1])
2025-06-02 15:31:15,077 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:15,346 - DEBUG - Step 17: Loss=0.6183
2025-06-02 15:31:15,347 - DEBUG - Online update step: 18/25
2025-06-02 15:31:15,357 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:15,471 - DEBUG - Node anomaly scores shape: torch.Size([20862, 1])
2025-06-02 15:31:15,477 - DEBUG - Edge anomaly scores shape: torch.Size([44095, 1])
2025-06-02 15:31:15,479 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:15,784 - DEBUG - Step 18: Loss=0.6346
2025-06-02 15:31:15,785 - DEBUG - Online update step: 19/25
2025-06-02 15:31:15,795 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:15,903 - DEBUG - Node anomaly scores shape: torch.Size([20333, 1])
2025-06-02 15:31:15,908 - DEBUG - Edge anomaly scores shape: torch.Size([42823, 1])
2025-06-02 15:31:15,910 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:16,177 - DEBUG - Step 19: Loss=0.6476
2025-06-02 15:31:16,178 - DEBUG - Online update step: 20/25
2025-06-02 15:31:16,188 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:16,288 - DEBUG - Node anomaly scores shape: torch.Size([18326, 1])
2025-06-02 15:31:16,292 - DEBUG - Edge anomaly scores shape: torch.Size([38425, 1])
2025-06-02 15:31:16,294 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:16,550 - DEBUG - Step 20: Loss=0.6194
2025-06-02 15:31:16,550 - DEBUG - Online update step: 21/25
2025-06-02 15:31:16,561 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:16,685 - DEBUG - Node anomaly scores shape: torch.Size([21972, 1])
2025-06-02 15:31:16,691 - DEBUG - Edge anomaly scores shape: torch.Size([46575, 1])
2025-06-02 15:31:16,692 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:17,036 - DEBUG - Step 21: Loss=0.6338
2025-06-02 15:31:17,037 - DEBUG - Online update step: 22/25
2025-06-02 15:31:17,047 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:17,144 - DEBUG - Node anomaly scores shape: torch.Size([19242, 1])
2025-06-02 15:31:17,149 - DEBUG - Edge anomaly scores shape: torch.Size([40385, 1])
2025-06-02 15:31:17,151 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:17,417 - DEBUG - Step 22: Loss=0.6467
2025-06-02 15:31:17,418 - DEBUG - Online update step: 23/25
2025-06-02 15:31:17,429 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:17,547 - DEBUG - Node anomaly scores shape: torch.Size([21448, 1])
2025-06-02 15:31:17,553 - DEBUG - Edge anomaly scores shape: torch.Size([45431, 1])
2025-06-02 15:31:17,555 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:17,811 - DEBUG - Step 23: Loss=0.6173
2025-06-02 15:31:17,812 - DEBUG - Online update step: 24/25
2025-06-02 15:31:17,822 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:17,938 - DEBUG - Node anomaly scores shape: torch.Size([20443, 1])
2025-06-02 15:31:17,943 - DEBUG - Edge anomaly scores shape: torch.Size([43255, 1])
2025-06-02 15:31:17,945 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:18,214 - DEBUG - Step 24: Loss=0.6337
2025-06-02 15:31:18,214 - DEBUG - Online update step: 25/25
2025-06-02 15:31:18,225 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:18,341 - DEBUG - Node anomaly scores shape: torch.Size([19868, 1])
2025-06-02 15:31:18,345 - DEBUG - Edge anomaly scores shape: torch.Size([41766, 1])
2025-06-02 15:31:18,347 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:18,657 - DEBUG - Step 25: Loss=0.6466
2025-06-02 15:31:18,658 - INFO - Online update finished. Average loss: 0.6344, Learning rate: 0.001000
2025-06-02 15:31:18,660 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00  2.28197248e-08 -1.90164373e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  1.33115057e-08
  3.09017101e-09 -3.68443476e-09 -1.23606840e-08 -1.90164373e-09
  2.26719832e+00  2.96211362e+00  1.49551347e-01  4.39282131e+00
  3.68443476e-09  3.43569303e+00  5.77567291e+00  7.61316061e+00
  1.49551347e-01  7.99302101e+00 -1.37869165e-08 -7.96313326e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -4.51640370e-09  3.28033529e-08], current edge mean: [-1.7323785e-09  4.5524887e+02  0.0000000e+00  0.0000000e+00
  3.2482095e-09 -2.1654731e-10 -6.9295139e-09 -2.5985676e-09
 -2.3820204e-09  3.4647569e-09]
2025-06-02 15:31:18,660 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0000
2025-06-02 15:31:18,663 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00  2.28197248e-08 -1.90164373e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  1.33115057e-08
  3.09017101e-09 -3.68443476e-09 -1.23606840e-08 -1.90164373e-09
  2.26719832e+00  2.96211362e+00  1.49551347e-01  4.39282131e+00
  3.68443476e-09  3.43569303e+00  5.77567291e+00  7.61316061e+00
  1.49551347e-01  7.99302101e+00 -1.37869165e-08 -7.96313326e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -4.51640370e-09  3.28033529e-08], edge=[-1.7323785e-09  4.5524887e+02  0.0000000e+00  0.0000000e+00
  3.2482095e-09 -2.1654731e-10 -6.9295139e-09 -2.5985676e-09
 -2.3820204e-09  3.4647569e-09]
2025-06-02 15:31:18,665 - DEBUG - Updated reference std: node=[0.         0.         1.0004989  1.0004989  0.         0.
 0.         1.0004989  1.0004989  1.0004989  1.0004989  1.0004989
 0.942663   0.2727847  0.3705303  0.57321125 1.0004989  3.0242865
 2.9081972  1.4837464  0.3705303  0.22102815 1.0004989  1.0004989
 0.         0.         0.         0.         1.0004989  1.0004989 ], edge=[  1.0002271 435.18454     0.          0.          1.0002272   1.0002272
   1.0002271   1.0002271   1.0002271   1.0002271]
2025-06-02 15:31:18,665 - INFO - Online update complete. Loss: 0.6344
2025-06-02 15:31:18,666 - INFO - Running anomaly detection...
2025-06-02 15:31:18,666 - INFO - Starting anomaly detection.
2025-06-02 15:31:18,695 - DEBUG - Node reconstruction errors: [0.13822705 0.7879022  1.6355051  ... 0.02059794 0.02384651 0.01276158]
2025-06-02 15:31:18,696 - DEBUG - Edge reconstruction errors: [ 5.2641134  5.261611  44.257854  ... 13.357839   2.1587267 13.357839 ]
2025-06-02 15:31:18,700 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_153118_update_51.json
2025-06-02 15:31:18,701 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:31:18,757 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_153118_update_51.pth
2025-06-02 15:31:18,757 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870625.dot): 0.9399
2025-06-02 15:31:18,758 - WARNING - Detected 5 anomalous nodes (reconstruction-based):
2025-06-02 15:31:18,758 - WARNING -   Node ID: 192.168.239.101, Recon Error: 0.7879, MLP Score: 0.4730
2025-06-02 15:31:18,758 - WARNING -   Node ID: 192.168.27.13, Recon Error: 1.6355, MLP Score: 0.5076
2025-06-02 15:31:18,758 - WARNING -   Node ID: 192.168.27.10, Recon Error: 1.0157, MLP Score: 0.5066
2025-06-02 15:31:18,759 - WARNING -   Node ID: 183.81.34.26, Recon Error: 8.9648, MLP Score: 0.5076
2025-06-02 15:31:18,759 - WARNING -   Node ID: 142.250.76.14, Recon Error: 1.2218, MLP Score: 0.5164
2025-06-02 15:31:18,759 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:31:18,759 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2579, MLP Score: 0.0207
2025-06-02 15:31:18,760 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9603, MLP Score: 0.0066
2025-06-02 15:31:18,760 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0600, MLP Score: 0.0066
2025-06-02 15:31:18,760 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7587, MLP Score: 0.0029
2025-06-02 15:31:18,760 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7582, MLP Score: 0.0026
2025-06-02 15:31:18,779 - DEBUG - Embedding standard deviations before t-SNE: [1.4153439  0.04083703 0.8728139  1.5470902  0.04888743 0.619245
 0.9824566  0.51058733 0.74194217 2.6217682  1.9699156  2.0108564
 1.2330768  0.68813205 1.2666138  1.1290535  0.13877212 0.77392375
 0.         1.3231499  0.3193687  1.66606    0.         0.33237085
 0.62206274 0.9168068  0.02389228 1.4498196  2.0216255  0.
 1.2443604  1.2425874 ]
2025-06-02 15:31:19,898 - INFO - Embeddings visualization saved to vis/embeddings_51_updates_20250602_153118.png
2025-06-02 15:31:19,899 - INFO - Performing visualization of node and edge features.
2025-06-02 15:31:19,906 - INFO - Starting visualization of node features.
2025-06-02 15:31:19,906 - INFO - Graph has 1003 nodes and 30 features.
2025-06-02 15:31:19,906 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:31:19,906 - INFO - Calculating feature statistics:
2025-06-02 15:31:19,907 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:31:19,907 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:31:19,908 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 25, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.7199986), 'max': np.float32(2.4740193)}
2025-06-02 15:31:19,908 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 25, 'mean': np.float32(-6.08526e-08), 'std': np.float32(1.0), 'min': np.float32(-2.3749828), 'max': np.float32(1.8203772)}
2025-06-02 15:31:19,908 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:31:19,908 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:31:19,909 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:31:19,909 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(7.606575e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.45654544), 'max': np.float32(2.1903625)}
2025-06-02 15:31:19,909 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(1.521315e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.1496779), 'max': np.float32(0.86980885)}
2025-06-02 15:31:19,910 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 4, 'mean': np.float32(-7.606575e-09), 'std': np.float32(0.99999994), 'min': np.float32(-9.436405), 'max': np.float32(0.108228795)}
2025-06-02 15:31:19,910 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 25, 'mean': np.float32(3.04263e-08), 'std': np.float32(1.0), 'min': np.float32(-2.2683976), 'max': np.float32(1.4923526)}
2025-06-02 15:31:19,910 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 25, 'mean': np.float32(1.521315e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.4565239), 'max': np.float32(2.385281)}
2025-06-02 15:31:19,911 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 8, 'mean': np.float32(2.2671983), 'std': np.float32(0.94219303), 'min': np.float32(0.0), 'max': np.float32(10.0)}
2025-06-02 15:31:19,911 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.9621136), 'std': np.float32(0.27264866), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:31:19,911 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.14955135), 'std': np.float32(0.37034556), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:31:19,911 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.3928213), 'std': np.float32(0.5729255), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:31:19,912 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 4, 'mean': np.float32(7.606575e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.108228795), 'max': np.float32(9.436405)}
2025-06-02 15:31:19,912 - INFO - - service_1: {'name': 'service_1', 'unique': 6, 'mean': np.float32(3.435693), 'std': np.float32(3.0227787), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 15:31:19,912 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.775673), 'std': np.float32(2.906747), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:31:19,913 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.6131606), 'std': np.float32(1.4830064), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:31:19,913 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.14955135), 'std': np.float32(0.37034556), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:31:19,913 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 2, 'mean': np.float32(7.993021), 'std': np.float32(0.22091796), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:31:19,914 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(-1.1409862e-08), 'std': np.float32(0.9999998), 'min': np.float32(-0.12744388), 'max': np.float32(16.54554)}
2025-06-02 15:31:19,914 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.13895662), 'max': np.float32(7.1964903)}
2025-06-02 15:31:19,914 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:31:19,914 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:31:19,915 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:31:19,915 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:31:19,915 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 6, 'mean': np.float32(1.521315e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.9900672), 'max': np.float32(10.424156)}
2025-06-02 15:31:19,916 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(3.04263e-08), 'std': np.float32(1.0), 'min': np.float32(-1.0934536), 'max': np.float32(4.4456067)}
2025-06-02 15:31:19,988 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7f927cc63b90>
2025-06-02 15:31:20,774 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:31:21,150 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:31:21,327 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:31:26,067 - INFO - Node feature visualization saved to vis/node_features_20250602_153121.png
2025-06-02 15:31:26,068 - INFO - Finished visualization of node features.
2025-06-02 15:31:26,068 - INFO - Performing additional feature analysis:
2025-06-02 15:31:26,068 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:31:26,082 - INFO - Starting visualization of edge features.
2025-06-02 15:31:26,082 - INFO - Graph has 2202 edges and 10 edge features.
2025-06-02 15:31:26,082 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:31:26,082 - INFO - Calculating edge feature statistics:
2025-06-02 15:31:26,084 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:31:26,084 - INFO - - count: {'name': 'count', 'unique': 39, 'mean': np.float32(3.464757e-09), 'std': np.float32(1.0), 'min': np.float32(-0.03478463), 'max': np.float32(33.15622)}
2025-06-02 15:31:26,084 - INFO - - dst_port: {'name': 'dst_port', 'unique': 19, 'mean': np.float32(455.24887), 'std': np.float32(435.08572), 'min': np.float32(0.0), 'max': np.float32(8898.0)}
2025-06-02 15:31:26,085 - INFO - - protocol: {'name': 'protocol', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:31:26,085 - INFO - - service: {'name': 'service', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:31:26,085 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 1480, 'mean': np.float32(4.330946e-09), 'std': np.float32(1.0), 'min': np.float32(-0.059619874), 'max': np.float32(27.69297)}
2025-06-02 15:31:26,086 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 1552, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.05574151), 'max': np.float32(30.763014)}
2025-06-02 15:31:26,086 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 513, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.043342285), 'max': np.float32(33.037327)}
2025-06-02 15:31:26,086 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 1525, 'mean': np.float32(-5.197135e-09), 'std': np.float32(1.0), 'min': np.float32(-0.088083506), 'max': np.float32(28.738836)}
2025-06-02 15:31:26,086 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 1555, 'mean': np.float32(-8.6618923e-10), 'std': np.float32(0.99999994), 'min': np.float32(-0.08783306), 'max': np.float32(27.616936)}
2025-06-02 15:31:26,086 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 567, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.052230973), 'max': np.float32(32.468086)}
2025-06-02 15:31:26,155 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7f927d8de840>
2025-06-02 15:31:26,618 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:31:26,684 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7f92917b0110>
2025-06-02 15:31:27,067 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:31:27,716 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:31:28,440 - DEBUG - Plotted boxplots of the first 8 non-constant edge features.
2025-06-02 15:31:28,522 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:31:28,553 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:31:32,309 - INFO - Edge feature visualization saved to vis/edge_features_20250602_153128.png
2025-06-02 15:31:32,310 - INFO - Finished visualization of edge features.
2025-06-02 15:31:32,310 - INFO - Performing additional edge feature analysis:
2025-06-02 15:31:32,310 - INFO - - 2 out of 10 edge features are constant.
2025-06-02 15:31:32,311 - INFO - - Highest correlation (1.00) between features: 'total_resp_ip_bytes' and 'total_resp_bytes'.
2025-06-02 15:31:32,325 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:31:32,325 - INFO - Graph has 2202 edges and 10 edge features.
2025-06-02 15:31:32,325 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:31:33,527 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_153132_summary.png
2025-06-02 15:31:34,571 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_153132_pca_3d.png
2025-06-02 15:31:35,078 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_153132_pca_variance.png
2025-06-02 15:31:35,079 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:31:35,079 - INFO - 
--- Processing file: nw_graph_encoded_1748870655.dot (Timestamp: 2025-06-02 15:24:15) ---
2025-06-02 15:31:35,079 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870655.dot
2025-06-02 15:31:35,079 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870655.dot'.
2025-06-02 15:31:35,080 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870655.dot
2025-06-02 15:31:35,118 - INFO - Parsed 1003 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870655.dot'.
2025-06-02 15:31:35,233 - INFO - Parsed 2202 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870655.dot'.
2025-06-02 15:31:35,234 - INFO - Processing node updates/additions.
2025-06-02 15:31:35,278 - INFO - Processing edge updates/additions.
2025-06-02 15:31:35,462 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:31:35,469 - INFO - Finished updating NetworkX graph.
2025-06-02 15:31:35,473 - DEBUG - Updated graph - Nodes: 1003, Edges: 2202
2025-06-02 15:31:35,474 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:31:35,481 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:31:35,680 - DEBUG - Initial node features tensor shape: torch.Size([1003, 30])
2025-06-02 15:31:35,688 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:31:35,699 - DEBUG - Node features tensor shape after scaling: torch.Size([1003, 30])
2025-06-02 15:31:35,710 - DEBUG - Edge index tensor shape: torch.Size([2, 2202])
2025-06-02 15:31:35,733 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:31:35,842 - DEBUG - Initial edge attributes tensor shape: torch.Size([2202, 10])
2025-06-02 15:31:35,847 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:31:35,848 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2202, 10])
2025-06-02 15:31:35,849 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:31:35,850 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:31:35,856 - INFO - Updated main graph to 1003 nodes and 2202 edges.
2025-06-02 15:31:35,856 - INFO - Performing online update...
2025-06-02 15:31:35,857 - INFO - Starting online update for 25 steps.
2025-06-02 15:31:35,859 - DEBUG - Updated RunningStats: new_mean=0.9451897398274213, new_var=30000000000161.41, new_n=3030
2025-06-02 15:31:35,859 - DEBUG - Updated RunningStats: new_mean=0.9431692405850942, new_var=30300000000018.305, new_n=3060
2025-06-02 15:31:35,861 - DEBUG - Updated RunningStats: new_mean=44.794687926482595, new_var=10000000186531.766, new_n=1010
2025-06-02 15:31:35,861 - DEBUG - Updated RunningStats: new_mean=44.78904013278102, new_var=10100000169843.016, new_n=1020
2025-06-02 15:31:35,862 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:31:35,862 - DEBUG - Online update step: 1/25
2025-06-02 15:31:35,875 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:36,079 - DEBUG - Node anomaly scores shape: torch.Size([20327, 1])
2025-06-02 15:31:36,087 - DEBUG - Edge anomaly scores shape: torch.Size([42967, 1])
2025-06-02 15:31:36,089 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:36,282 - DEBUG - Step 1: Loss=0.6181
2025-06-02 15:31:36,283 - DEBUG - Online update step: 2/25
2025-06-02 15:31:36,291 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:36,466 - DEBUG - Node anomaly scores shape: torch.Size([21738, 1])
2025-06-02 15:31:36,472 - DEBUG - Edge anomaly scores shape: torch.Size([46036, 1])
2025-06-02 15:31:36,474 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:36,736 - DEBUG - Step 2: Loss=0.6327
2025-06-02 15:31:36,736 - DEBUG - Online update step: 3/25
2025-06-02 15:31:36,745 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:36,888 - DEBUG - Node anomaly scores shape: torch.Size([20026, 1])
2025-06-02 15:31:36,893 - DEBUG - Edge anomaly scores shape: torch.Size([42429, 1])
2025-06-02 15:31:36,894 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:37,151 - DEBUG - Step 3: Loss=0.6445
2025-06-02 15:31:37,151 - DEBUG - Online update step: 4/25
2025-06-02 15:31:37,160 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:37,276 - DEBUG - Node anomaly scores shape: torch.Size([20581, 1])
2025-06-02 15:31:37,282 - DEBUG - Edge anomaly scores shape: torch.Size([43641, 1])
2025-06-02 15:31:37,283 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:37,532 - DEBUG - Step 4: Loss=0.6152
2025-06-02 15:31:37,532 - DEBUG - Online update step: 5/25
2025-06-02 15:31:37,541 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:37,650 - DEBUG - Node anomaly scores shape: torch.Size([20168, 1])
2025-06-02 15:31:37,655 - DEBUG - Edge anomaly scores shape: torch.Size([42650, 1])
2025-06-02 15:31:37,656 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:37,912 - DEBUG - Step 5: Loss=0.6338
2025-06-02 15:31:37,913 - DEBUG - Online update step: 6/25
2025-06-02 15:31:37,922 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:38,036 - DEBUG - Node anomaly scores shape: torch.Size([20544, 1])
2025-06-02 15:31:38,040 - DEBUG - Edge anomaly scores shape: torch.Size([43406, 1])
2025-06-02 15:31:38,042 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:38,340 - DEBUG - Step 6: Loss=0.6462
2025-06-02 15:31:38,340 - DEBUG - Online update step: 7/25
2025-06-02 15:31:38,349 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:38,459 - DEBUG - Node anomaly scores shape: torch.Size([20153, 1])
2025-06-02 15:31:38,467 - DEBUG - Edge anomaly scores shape: torch.Size([42643, 1])
2025-06-02 15:31:38,469 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:38,714 - DEBUG - Step 7: Loss=0.6179
2025-06-02 15:31:38,715 - DEBUG - Online update step: 8/25
2025-06-02 15:31:38,724 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:38,838 - DEBUG - Node anomaly scores shape: torch.Size([20998, 1])
2025-06-02 15:31:38,843 - DEBUG - Edge anomaly scores shape: torch.Size([44274, 1])
2025-06-02 15:31:38,845 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:39,108 - DEBUG - Step 8: Loss=0.6316
2025-06-02 15:31:39,109 - DEBUG - Online update step: 9/25
2025-06-02 15:31:39,117 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:39,219 - DEBUG - Node anomaly scores shape: torch.Size([19935, 1])
2025-06-02 15:31:39,224 - DEBUG - Edge anomaly scores shape: torch.Size([42051, 1])
2025-06-02 15:31:39,226 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:39,477 - DEBUG - Step 9: Loss=0.6438
2025-06-02 15:31:39,478 - DEBUG - Online update step: 10/25
2025-06-02 15:31:39,487 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:39,580 - DEBUG - Node anomaly scores shape: torch.Size([18171, 1])
2025-06-02 15:31:39,584 - DEBUG - Edge anomaly scores shape: torch.Size([38016, 1])
2025-06-02 15:31:39,586 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:39,806 - DEBUG - Step 10: Loss=0.6163
2025-06-02 15:31:39,806 - DEBUG - Online update step: 11/25
2025-06-02 15:31:39,815 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:39,965 - DEBUG - Node anomaly scores shape: torch.Size([23375, 1])
2025-06-02 15:31:39,970 - DEBUG - Edge anomaly scores shape: torch.Size([49619, 1])
2025-06-02 15:31:39,972 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:40,286 - DEBUG - Step 11: Loss=0.6327
2025-06-02 15:31:40,287 - DEBUG - Online update step: 12/25
2025-06-02 15:31:40,295 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:40,402 - DEBUG - Node anomaly scores shape: torch.Size([21201, 1])
2025-06-02 15:31:40,407 - DEBUG - Edge anomaly scores shape: torch.Size([44895, 1])
2025-06-02 15:31:40,409 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:40,665 - DEBUG - Step 12: Loss=0.6446
2025-06-02 15:31:40,666 - DEBUG - Online update step: 13/25
2025-06-02 15:31:40,674 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:40,794 - DEBUG - Node anomaly scores shape: torch.Size([21904, 1])
2025-06-02 15:31:40,799 - DEBUG - Edge anomaly scores shape: torch.Size([46551, 1])
2025-06-02 15:31:40,801 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:41,062 - DEBUG - Step 13: Loss=0.6163
2025-06-02 15:31:41,062 - DEBUG - Online update step: 14/25
2025-06-02 15:31:41,071 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:41,180 - DEBUG - Node anomaly scores shape: torch.Size([20294, 1])
2025-06-02 15:31:41,185 - DEBUG - Edge anomaly scores shape: torch.Size([43049, 1])
2025-06-02 15:31:41,187 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:41,434 - DEBUG - Step 14: Loss=0.6325
2025-06-02 15:31:41,435 - DEBUG - Online update step: 15/25
2025-06-02 15:31:41,443 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:41,548 - DEBUG - Node anomaly scores shape: torch.Size([19255, 1])
2025-06-02 15:31:41,553 - DEBUG - Edge anomaly scores shape: torch.Size([40514, 1])
2025-06-02 15:31:41,554 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:41,761 - DEBUG - Step 15: Loss=0.6454
2025-06-02 15:31:41,762 - DEBUG - Online update step: 16/25
2025-06-02 15:31:41,771 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:41,874 - DEBUG - Node anomaly scores shape: torch.Size([18257, 1])
2025-06-02 15:31:41,879 - DEBUG - Edge anomaly scores shape: torch.Size([38246, 1])
2025-06-02 15:31:41,880 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:42,124 - DEBUG - Step 16: Loss=0.6173
2025-06-02 15:31:42,124 - DEBUG - Online update step: 17/25
2025-06-02 15:31:42,134 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:42,258 - DEBUG - Node anomaly scores shape: torch.Size([21554, 1])
2025-06-02 15:31:42,264 - DEBUG - Edge anomaly scores shape: torch.Size([45673, 1])
2025-06-02 15:31:42,266 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:42,552 - DEBUG - Step 17: Loss=0.6312
2025-06-02 15:31:42,553 - DEBUG - Online update step: 18/25
2025-06-02 15:31:42,562 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:42,665 - DEBUG - Node anomaly scores shape: torch.Size([19553, 1])
2025-06-02 15:31:42,670 - DEBUG - Edge anomaly scores shape: torch.Size([41155, 1])
2025-06-02 15:31:42,672 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:42,910 - DEBUG - Step 18: Loss=0.6441
2025-06-02 15:31:42,910 - DEBUG - Online update step: 19/25
2025-06-02 15:31:42,920 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:43,027 - DEBUG - Node anomaly scores shape: torch.Size([20307, 1])
2025-06-02 15:31:43,033 - DEBUG - Edge anomaly scores shape: torch.Size([42789, 1])
2025-06-02 15:31:43,034 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:43,290 - DEBUG - Step 19: Loss=0.6158
2025-06-02 15:31:43,291 - DEBUG - Online update step: 20/25
2025-06-02 15:31:43,300 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:43,414 - DEBUG - Node anomaly scores shape: torch.Size([20188, 1])
2025-06-02 15:31:43,419 - DEBUG - Edge anomaly scores shape: torch.Size([42679, 1])
2025-06-02 15:31:43,420 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:43,758 - DEBUG - Step 20: Loss=0.6323
2025-06-02 15:31:43,758 - DEBUG - Online update step: 21/25
2025-06-02 15:31:43,768 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:44,320 - DEBUG - Node anomaly scores shape: torch.Size([19829, 1])
2025-06-02 15:31:44,334 - DEBUG - Edge anomaly scores shape: torch.Size([41883, 1])
2025-06-02 15:31:44,336 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:44,878 - DEBUG - Step 21: Loss=0.6437
2025-06-02 15:31:44,879 - DEBUG - Online update step: 22/25
2025-06-02 15:31:44,892 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:45,375 - DEBUG - Node anomaly scores shape: torch.Size([22987, 1])
2025-06-02 15:31:45,380 - DEBUG - Edge anomaly scores shape: torch.Size([48984, 1])
2025-06-02 15:31:45,382 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:45,632 - DEBUG - Step 22: Loss=0.6155
2025-06-02 15:31:45,633 - DEBUG - Online update step: 23/25
2025-06-02 15:31:45,641 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:45,760 - DEBUG - Node anomaly scores shape: torch.Size([19540, 1])
2025-06-02 15:31:45,765 - DEBUG - Edge anomaly scores shape: torch.Size([40854, 1])
2025-06-02 15:31:45,766 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:46,043 - DEBUG - Step 23: Loss=0.6326
2025-06-02 15:31:46,043 - DEBUG - Online update step: 24/25
2025-06-02 15:31:46,052 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:46,173 - DEBUG - Node anomaly scores shape: torch.Size([19280, 1])
2025-06-02 15:31:46,181 - DEBUG - Edge anomaly scores shape: torch.Size([40588, 1])
2025-06-02 15:31:46,182 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:46,483 - DEBUG - Step 24: Loss=0.6437
2025-06-02 15:31:46,483 - DEBUG - Online update step: 25/25
2025-06-02 15:31:46,492 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:31:46,602 - DEBUG - Node anomaly scores shape: torch.Size([20505, 1])
2025-06-02 15:31:46,608 - DEBUG - Edge anomaly scores shape: torch.Size([42958, 1])
2025-06-02 15:31:46,610 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:31:46,919 - DEBUG - Step 25: Loss=0.6178
2025-06-02 15:31:46,919 - INFO - Online update finished. Average loss: 0.6306, Learning rate: 0.001000
2025-06-02 15:31:46,921 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00  2.28197248e-08 -1.90164373e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  1.33115057e-08
  3.09017101e-09 -3.68443476e-09 -1.23606840e-08 -1.90164373e-09
  2.26719832e+00  2.96211362e+00  1.49551347e-01  4.39282131e+00
  3.68443476e-09  3.43569303e+00  5.77567291e+00  7.61316061e+00
  1.49551347e-01  7.99302101e+00 -1.37869165e-08 -7.96313326e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -4.51640370e-09  3.28033529e-08], current edge mean: [-1.7323785e-09  4.5524887e+02  0.0000000e+00  0.0000000e+00
  3.2482095e-09 -2.1654731e-10 -6.9295139e-09 -2.5985676e-09
 -2.3820204e-09  3.4647569e-09]
2025-06-02 15:31:46,921 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0000
2025-06-02 15:31:46,923 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00  2.28197248e-08 -1.90164373e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  1.33115057e-08
  3.09017101e-09 -3.68443476e-09 -1.23606840e-08 -1.90164373e-09
  2.26719832e+00  2.96211362e+00  1.49551347e-01  4.39282131e+00
  3.68443476e-09  3.43569303e+00  5.77567291e+00  7.61316061e+00
  1.49551347e-01  7.99302101e+00 -1.37869165e-08 -7.96313326e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -4.51640370e-09  3.28033529e-08], edge=[-1.7323785e-09  4.5524887e+02  0.0000000e+00  0.0000000e+00
  3.2482095e-09 -2.1654731e-10 -6.9295139e-09 -2.5985676e-09
 -2.3820204e-09  3.4647569e-09]
2025-06-02 15:31:46,924 - DEBUG - Updated reference std: node=[0.         0.         1.0004989  1.0004989  0.         0.
 0.         1.0004989  1.0004989  1.0004989  1.0004989  1.0004989
 0.942663   0.2727847  0.3705303  0.57321125 1.0004989  3.0242865
 2.9081972  1.4837464  0.3705303  0.22102815 1.0004989  1.0004989
 0.         0.         0.         0.         1.0004989  1.0004989 ], edge=[  1.0002271 435.18454     0.          0.          1.0002272   1.0002272
   1.0002271   1.0002271   1.0002271   1.0002271]
2025-06-02 15:31:46,934 - INFO - Online update complete. Loss: 0.6306
2025-06-02 15:31:46,934 - INFO - Running anomaly detection...
2025-06-02 15:31:46,935 - INFO - Starting anomaly detection.
2025-06-02 15:31:46,942 - DEBUG - Node reconstruction errors: [0.11337394 0.88417417 1.7879281  ... 0.01864669 0.02129584 0.01635852]
2025-06-02 15:31:46,943 - DEBUG - Edge reconstruction errors: [ 5.2641134  5.2616105 44.257854  ... 13.357839   2.1587267 13.357839 ]
2025-06-02 15:31:46,945 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_153146_update_52.json
2025-06-02 15:31:46,946 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:31:46,985 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_153146_update_52.pth
2025-06-02 15:31:46,986 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870655.dot): 0.9389
2025-06-02 15:31:46,986 - WARNING - Detected 5 anomalous nodes (reconstruction-based):
2025-06-02 15:31:46,986 - WARNING -   Node ID: 192.168.239.101, Recon Error: 0.8842, MLP Score: 0.5017
2025-06-02 15:31:46,986 - WARNING -   Node ID: 192.168.27.13, Recon Error: 1.7879, MLP Score: 0.5230
2025-06-02 15:31:46,987 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.9054, MLP Score: 0.5239
2025-06-02 15:31:46,987 - WARNING -   Node ID: 183.81.34.26, Recon Error: 8.6469, MLP Score: 0.5230
2025-06-02 15:31:46,987 - WARNING -   Node ID: 142.250.76.14, Recon Error: 1.1744, MLP Score: 0.5171
2025-06-02 15:31:46,988 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:31:46,988 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2579, MLP Score: 0.7605
2025-06-02 15:31:46,988 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9603, MLP Score: 0.9176
2025-06-02 15:31:46,989 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0600, MLP Score: 0.9176
2025-06-02 15:31:46,989 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7587, MLP Score: 0.8986
2025-06-02 15:31:46,989 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7582, MLP Score: 0.9037
2025-06-02 15:31:46,990 - INFO - Finished processing all files in the directory.
