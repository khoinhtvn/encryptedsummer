\doxysection{main.\+cpp File Reference}
\hypertarget{main_8cpp}{}\label{main_8cpp}\index{main.cpp@{main.cpp}}


Main entry point for the Zeek log analysis and anomaly detection application.  


{\ttfamily \#include $<$iostream$>$}\newline
{\ttfamily \#include $<$thread$>$}\newline
{\ttfamily \#include $<$filesystem$>$}\newline
{\ttfamily \#include "{}includes/\+Graph\+Builder.\+h"{}}\newline
{\ttfamily \#include "{}includes/\+Graph\+Exporter.\+h"{}}\newline
{\ttfamily \#include "{}includes/\+Log\+Monitor.\+h"{}}\newline
{\ttfamily \#include "{}includes/\+Real\+Time\+Anomaly\+Detector.\+h"{}}\newline
Include dependency graph for main.\+cpp\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{main_8cpp__incl}
\end{center}
\end{figure}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{main_8cpp_a0ddf1224851353fc92bfbff6f499fa97}{main}} (int argc, char \texorpdfstring{$\ast$}{*}argv\mbox{[}$\,$\mbox{]})
\begin{DoxyCompactList}\small\item\em Main function of the application. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Main entry point for the Zeek log analysis and anomaly detection application. 

This application monitors Zeek logs from a specified directory, builds a graph representation of the network traffic and visualizes the graph periodically. 

\doxysubsection{Function Documentation}
\Hypertarget{main_8cpp_a0ddf1224851353fc92bfbff6f499fa97}\index{main.cpp@{main.cpp}!main@{main}}
\index{main@{main}!main.cpp@{main.cpp}}
\doxysubsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily \label{main_8cpp_a0ddf1224851353fc92bfbff6f499fa97} 
int main (\begin{DoxyParamCaption}\item[{int}]{argc}{, }\item[{char \texorpdfstring{$\ast$}{*}}]{argv}{\mbox{[}$\,$\mbox{]}}\end{DoxyParamCaption})}



Main function of the application. 

This function parses command-\/line arguments, initializes the log monitor, anomaly detector, and graph exporter, and then enters a main loop for continuous monitoring and analysis.


\begin{DoxyParams}{Parameters}
{\em argc} & Number of command-\/line arguments. \\
\hline
{\em argv} & Array of command-\/line arguments. The first argument should be the path to the Zeek log directory. An optional --export-\/path argument specifies the export directory. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if the application runs successfully, 1 otherwise. 
\end{DoxyReturn}
Instance of the graph exporter.

This object is responsible for exporting the graph data in various formats, such as DOT files for visualization.

Instance of the log monitor, responsible for reading and processing Zeek logs.

The monitor is initialized with the directory containing the Zeek log files provided as a command-\/line argument. It continuously reads new log entries and makes them available for graph building.

Starts the log monitoring process in a separate thread.

This allows the application to process logs in the background without blocking the main execution thread, enabling continuous monitoring.

Get the current UTC timestamp for filename generation.

Get a reference to the singleton instance of the \doxylink{classGraphBuilder}{Graph\+Builder} and its current graph.

Export the encoded incremental updates of the network graph to a DOT file.

This call retrieves the latest changes to the graph since the last export and saves them in an encoded format to a DOT file. The filename includes the UTC timestamp to differentiate between exports. The output file is created in the specified {\ttfamily export\+\_\+path}.

Stops the log monitoring process.

This ensures that the log monitoring thread is properly terminated before the application exits, releasing any resources it might be holding.