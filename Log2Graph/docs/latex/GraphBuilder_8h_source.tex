\doxysection{Graph\+Builder.\+h}
\hypertarget{GraphBuilder_8h_source}{}\label{GraphBuilder_8h_source}\index{includes/GraphBuilder.h@{includes/GraphBuilder.h}}
\mbox{\hyperlink{GraphBuilder_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{comment}{//\ Created\ by\ lu\ on\ 4/25/25.}}
\DoxyCodeLine{00011\ \textcolor{comment}{//}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#ifndef\ GRAPHBUILDER\_H}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#define\ GRAPHBUILDER\_H}}
\DoxyCodeLine{00015\ \textcolor{comment}{//}}
\DoxyCodeLine{00016\ \textcolor{comment}{//\ Created\ by\ lu\ on\ 4/25/25.}}
\DoxyCodeLine{00017\ \textcolor{comment}{//\ \ -\/-\/>\ Redundant\ include}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ <memory>}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ <mutex>}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{FeatureEncoder_8h}{FeatureEncoder.h}}"{}}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{GraphUpdateQueue_8h}{GraphUpdateQueue.h}}"{}}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{TrafficGraph_8h}{TrafficGraph.h}}"{}}}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00036\ \textcolor{keyword}{class\ }GraphBuilder\ \{}
\DoxyCodeLine{00037\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00041\ \ \ \ \ \textcolor{keyword}{static}\ std::unique\_ptr<GraphBuilder>\ instance;}
\DoxyCodeLine{00045\ \ \ \ \ \textcolor{keyword}{static}\ std::mutex\ instance\_mutex;}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00050\ \ \ \ \ \mbox{\hyperlink{classTrafficGraph}{TrafficGraph}}\ graph;}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00055\ \ \ \ \ GraphBuilder()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00060\ \ \ \ \ \mbox{\hyperlink{classGraphUpdateQueue}{GraphUpdateQueue}}\ update\_queue;}
\DoxyCodeLine{00064\ \ \ \ \ \mbox{\hyperlink{classFeatureEncoder}{FeatureEncoder}}\ feature\_encoder;}
\DoxyCodeLine{00065\ \ \ \ \ std::atomic<bool>\ save\_pending\{\textcolor{keyword}{false}\};}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00071\ \ \ \ \ \mbox{\hyperlink{classGraphBuilder_a3af3213174c72b1eda8f3a0e21bba54b}{GraphBuilder}}(\textcolor{keyword}{const}\ GraphBuilder\ \&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00077\ \ \ \ \ GraphBuilder\ \&\mbox{\hyperlink{classGraphBuilder_acbd5f45fa3be1fa61975e8fefedd3278}{operator=}}(\textcolor{keyword}{const}\ GraphBuilder\ \&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00087\ \ \ \ \ \textcolor{keyword}{static}\ GraphBuilder\ \&\mbox{\hyperlink{classGraphBuilder_adbe9d786ed3fbcd471f83e3ec9ac9efa}{get\_instance}}()\ \{}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ std::lock\_guard\ lock(instance\_mutex);}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!instance)\ \{}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \ \ \ \ instance\ =\ std::unique\_ptr<GraphBuilder>(\textcolor{keyword}{new}\ GraphBuilder());}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *instance;}
\DoxyCodeLine{00093\ \ \ \ \ \}}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00102\ \ \ \ \ std::vector<GraphUpdate>\ \mbox{\hyperlink{classGraphBuilder_a88d61bc652bfa5a60a8cd1aa8509d27c}{get\_last\_updates}}()\ \{}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::move(update\_queue.popAll());}
\DoxyCodeLine{00104\ \ \ \ \ \}}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00155\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphBuilder_a022b58b16ad42721ed0a55c4e5ee2ea1}{add\_connection}}(\textcolor{keyword}{const}\ std::string\ \&src\_ip,\ \textcolor{keyword}{const}\ std::string\ \&dst\_ip,}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&proto,\ \textcolor{keyword}{const}\ std::string\ \&service,\ \textcolor{keyword}{const}\ std::string\ \&timestamp,}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ src\_port,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ dst\_port,}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ orig\_bytes,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ resp\_bytes,}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&conn\_state,}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ local\_orig,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ local\_resp,}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&history,}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ orig\_pkts,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ resp\_pkts,}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ orig\_ip\_bytes,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ resp\_ip\_bytes,}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&version\ =\ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&cipher\ =\ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&curve\ =\ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&server\_name\ =\ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ resumed\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&last\_alert\ =\ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&next\_protocol\ =\ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ established\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&ssl\_history\ =\ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&cert\_chain\_fps\ =\ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&client\_cert\_chain\_fps\ =\ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ sni\_matches\_cert\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&http\_method\ =\ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&http\_host\ =\ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&http\_uri\ =\ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&http\_referrer\ =\ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&http\_version\ =\ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&http\_user\_agent\ =\ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&http\_origin\ =\ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&http\_status\_code\ =\ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&http\_username\ =\ \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00185\ }
\DoxyCodeLine{00193\ \ \ \ \ \mbox{\hyperlink{classTrafficGraph}{TrafficGraph}}\ \&\mbox{\hyperlink{classGraphBuilder_a791f0173bacd48ce1071e6d87cd8bfaf}{get\_graph}}();}
\DoxyCodeLine{00194\ }
\DoxyCodeLine{00199\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classGraphBuilder_a5bd30a82778691790ebf82f364494a41}{get\_feature\_dimension}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ This\ should\ match\ your\ encoder's\ output\ size}}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ feature\_encoder.get\_feature\_dimension();}
\DoxyCodeLine{00202\ \ \ \ \ \}}
\DoxyCodeLine{00203\ \};}
\DoxyCodeLine{00204\ }
\DoxyCodeLine{00205\ }
\DoxyCodeLine{00206\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//GRAPHBUILDER\_H}}

\end{DoxyCode}
