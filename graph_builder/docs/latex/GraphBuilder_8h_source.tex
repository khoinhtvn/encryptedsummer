\doxysection{Graph\+Builder.\+h}
\hypertarget{GraphBuilder_8h_source}{}\label{GraphBuilder_8h_source}\index{includes/GraphBuilder.h@{includes/GraphBuilder.h}}
\mbox{\hyperlink{GraphBuilder_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{comment}{//\ Created\ by\ lu\ on\ 4/25/25.}}
\DoxyCodeLine{00011\ \textcolor{comment}{//}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#ifndef\ GRAPHBUILDER\_H}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#define\ GRAPHBUILDER\_H}}
\DoxyCodeLine{00015\ \textcolor{comment}{//}}
\DoxyCodeLine{00016\ \textcolor{comment}{//\ Created\ by\ lu\ on\ 4/25/25.}}
\DoxyCodeLine{00017\ \textcolor{comment}{//\ \ -\/-\/>\ Redundant\ include}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ <memory>}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ <mutex>}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{GraphUpdateQueue_8h}{GraphUpdateQueue.h}}"{}}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{TrafficGraph_8h}{TrafficGraph.h}}"{}}}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00035\ \textcolor{keyword}{class\ }GraphBuilder\ \{}
\DoxyCodeLine{00036\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00040\ \ \ \ \ \textcolor{keyword}{static}\ std::unique\_ptr<GraphBuilder>\ instance;}
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{keyword}{static}\ std::mutex\ instance\_mutex;}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00049\ \ \ \ \ \mbox{\hyperlink{classTrafficGraph}{TrafficGraph}}\ graph;}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00054\ \ \ \ \ GraphBuilder()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00059\ \ \ \ \ \mbox{\hyperlink{classGraphUpdateQueue}{GraphUpdateQueue}}\ update\_queue;}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00062\ \ \ \ \ std::atomic<bool>\ save\_pending\{\textcolor{keyword}{false}\};}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00068\ \ \ \ \ \mbox{\hyperlink{classGraphBuilder_a3af3213174c72b1eda8f3a0e21bba54b}{GraphBuilder}}(\textcolor{keyword}{const}\ GraphBuilder\ \&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00074\ \ \ \ \ GraphBuilder\ \&\mbox{\hyperlink{classGraphBuilder_acbd5f45fa3be1fa61975e8fefedd3278}{operator=}}(\textcolor{keyword}{const}\ GraphBuilder\ \&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{keyword}{static}\ GraphBuilder\ \&\mbox{\hyperlink{classGraphBuilder_adbe9d786ed3fbcd471f83e3ec9ac9efa}{get\_instance}}()\ \{}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ std::lock\_guard\ lock(instance\_mutex);}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!instance)\ \{}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \ \ \ \ instance\ =\ std::unique\_ptr<GraphBuilder>(\textcolor{keyword}{new}\ GraphBuilder());}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *instance;}
\DoxyCodeLine{00090\ \ \ \ \ \}}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00099\ \ \ \ \ std::vector<GraphUpdate>\ \mbox{\hyperlink{classGraphBuilder_a88d61bc652bfa5a60a8cd1aa8509d27c}{get\_last\_updates}}()\ \{}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::move(update\_queue.popAll());}
\DoxyCodeLine{00101\ \ \ \ \ \}}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00129\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphBuilder_a493a2fd26390adb3f4426e130d14160c}{add\_connection}}(\textcolor{keyword}{const}\ std::string\ \&src\_ip,\ \textcolor{keyword}{const}\ std::string\ \&dst\_ip,}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&proto,\ \textcolor{keyword}{const}\ std::string\ \&timestamp,}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ src\_port,\ \textcolor{keywordtype}{int}\ dst\_port,\ \textcolor{keyword}{const}\ std::string\ \&method\ =\ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&host\ =\ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&uri\ =\ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&version\ =\ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&user\_agent\ =\ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ request\_body\_len\ =\ 0,}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ response\_body\_len\ =\ 0,}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ status\_code\ =\ 0,}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&status\_msg\ =\ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<std::string>\ \&tags\ =\ \{\},}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<std::string>\ \&resp\_fuids\ =\ \{\},}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<std::string>\ \&resp\_mime\_types\ =\ \{\});}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00151\ \ \ \ \ TrafficGraph\ \&\mbox{\hyperlink{classGraphBuilder_a791f0173bacd48ce1071e6d87cd8bfaf}{get\_graph}}();}
\DoxyCodeLine{00152\ \};}
\DoxyCodeLine{00153\ }
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00155\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//GRAPHBUILDER\_H}}

\end{DoxyCode}
